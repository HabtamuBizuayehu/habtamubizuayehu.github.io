<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.57">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Habtamu Bizuayehu">

<title>Automating Publication-Ready Tables in R ‚Äì H. Mellie B</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<link href="../site_libs/tabwid-1.1.3/tabwid.css" rel="stylesheet">

<script src="../site_libs/tabwid-1.1.3/tabwid.js"></script>

<link href="../site_libs/htmltools-fill-0.5.8.1/fill.css" rel="stylesheet">

<script src="../site_libs/htmlwidgets-1.6.4/htmlwidgets.js"></script>

<link href="../site_libs/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet">

<script src="../site_libs/datatables-binding-0.33/datatables.js"></script>

<script src="../site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>

<link href="../site_libs/dt-core-1.13.6/css/jquery.dataTables.min.css" rel="stylesheet">

<link href="../site_libs/dt-core-1.13.6/css/jquery.dataTables.extra.css" rel="stylesheet">

<script src="../site_libs/dt-core-1.13.6/js/jquery.dataTables.min.js"></script>

<script src="../site_libs/jszip-1.13.6/jszip.min.js"></script>

<script src="../site_libs/pdfmake-1.13.6/pdfmake.js"></script>

<script src="../site_libs/pdfmake-1.13.6/vfs_fonts.js"></script>

<link href="../site_libs/dt-ext-buttons-1.13.6/css/buttons.dataTables.min.css" rel="stylesheet">

<script src="../site_libs/dt-ext-buttons-1.13.6/js/dataTables.buttons.min.js"></script>

<script src="../site_libs/dt-ext-buttons-1.13.6/js/buttons.html5.min.js"></script>

<script src="../site_libs/dt-ext-buttons-1.13.6/js/buttons.colVis.min.js"></script>

<script src="../site_libs/dt-ext-buttons-1.13.6/js/buttons.print.min.js"></script>

<link href="../site_libs/crosstalk-1.2.1/css/crosstalk.min.css" rel="stylesheet">

<script src="../site_libs/crosstalk-1.2.1/js/crosstalk.min.js"></script>



<link rel="stylesheet" href="../styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../index.html">
    <span class="navbar-title">H. Mellie B</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../index.html"> 
<span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../about.html"> 
<span class="menu-text">About Me</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../Skillsets.html"> 
<span class="menu-text">Skills and Expertise</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../CV.html"> 
<span class="menu-text">Resume/CV</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../Publication_report.html"> 
<span class="menu-text">Publication and Reports</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../Podcast_Blog.html"> 
<span class="menu-text">Blog and Podcast</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../contact.html"> 
<span class="menu-text">Contact</span></a>
  </li>  
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="https://github.com/" target="_blank"> <i class="bi bi-github" role="img">
</i> 
<span class="menu-text">GitHub</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="https://twitter.com" target="_blank"> <i class="bi bi-twitter" role="img">
</i> 
<span class="menu-text">Twitter</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="https://www.linkedin.com/in/dr-habtamu-mellie-bizuayehu-94285980/" target="_blank"> <i class="bi bi-linkedin" role="img">
</i> 
<span class="menu-text">LinkedIn</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="mailto:hmba2003@gmail.com" target="_blank"> <i class="bi bi-envelope" role="img">
</i> 
<span class="menu-text">Email</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul class="collapse">
  <li><a href="#overview-creating-a-publication-ready-table-in-r-with-flextable" id="toc-overview-creating-a-publication-ready-table-in-r-with-flextable" class="nav-link active" data-scroll-target="#overview-creating-a-publication-ready-table-in-r-with-flextable"><span class="header-section-number">1</span> üìã Overview: Creating a Publication-Ready Table in R with <code>flextable</code></a>
  <ul class="collapse">
  <li><a href="#table-without-title-and-footer" id="toc-table-without-title-and-footer" class="nav-link" data-scroll-target="#table-without-title-and-footer"><span class="header-section-number">1.1</span> <strong>1. Table Without Title and Footer</strong></a></li>
  <li><a href="#table-with-title-and-footer" id="toc-table-with-title-and-footer" class="nav-link" data-scroll-target="#table-with-title-and-footer"><span class="header-section-number">1.2</span> <strong>2 Table With Title and Footer</strong></a></li>
  <li><a href="#missing-values-with-n" id="toc-missing-values-with-n" class="nav-link" data-scroll-target="#missing-values-with-n"><span class="header-section-number">1.3</span> <strong>3. Missing Values with n(%)</strong></a></li>
  <li><a href="#missing-values-with-only-counts" id="toc-missing-values-with-only-counts" class="nav-link" data-scroll-target="#missing-values-with-only-counts"><span class="header-section-number">1.4</span> <strong>4. Missing Values with Only Counts</strong></a></li>
  <li><a href="#remove-all-lines" id="toc-remove-all-lines" class="nav-link" data-scroll-target="#remove-all-lines"><span class="header-section-number">1.5</span> <strong>5. Remove All Lines</strong></a></li>
  <li><a href="#only-horizontal-lines" id="toc-only-horizontal-lines" class="nav-link" data-scroll-target="#only-horizontal-lines"><span class="header-section-number">1.6</span> <strong>6 . Only Horizontal Lines</strong></a></li>
  <li><a href="#all-lines-visible" id="toc-all-lines-visible" class="nav-link" data-scroll-target="#all-lines-visible"><span class="header-section-number">1.7</span> <strong>7. All Lines Visible</strong></a></li>
  <li><a href="#font-formatting-colour-and-font-options" id="toc-font-formatting-colour-and-font-options" class="nav-link" data-scroll-target="#font-formatting-colour-and-font-options"><span class="header-section-number">1.8</span> <strong>8. Font Formatting: Colour and Font Options</strong></a></li>
  <li><a href="#rowwise-tables-summary" id="toc-rowwise-tables-summary" class="nav-link" data-scroll-target="#rowwise-tables-summary"><span class="header-section-number">1.9</span> <strong>9. Rowwise Tables (Summary)</strong></a></li>
  <li><a href="#columnwise-tables" id="toc-columnwise-tables" class="nav-link" data-scroll-target="#columnwise-tables"><span class="header-section-number">1.10</span> <strong>10. Columnwise Tables</strong></a></li>
  <li><a href="#columnwise-tables-with-na-values" id="toc-columnwise-tables-with-na-values" class="nav-link" data-scroll-target="#columnwise-tables-with-na-values"><span class="header-section-number">1.11</span> <strong>11. Columnwise Tables with NA values</strong></a></li>
  <li><a href="#both-row-wise-and-column-wise-tables" id="toc-both-row-wise-and-column-wise-tables" class="nav-link" data-scroll-target="#both-row-wise-and-column-wise-tables"><span class="header-section-number">1.12</span> <strong>12. Both Row wise and Column wise Tables</strong></a></li>
  <li><a href="#multiple-response-tables-rowwise-percentage" id="toc-multiple-response-tables-rowwise-percentage" class="nav-link" data-scroll-target="#multiple-response-tables-rowwise-percentage"><span class="header-section-number">1.13</span> <strong>13. Multiple Response Tables ‚Äì Rowwise Percentage</strong></a></li>
  <li><a href="#multiple-response-tables-columnwise-percentages" id="toc-multiple-response-tables-columnwise-percentages" class="nav-link" data-scroll-target="#multiple-response-tables-columnwise-percentages"><span class="header-section-number">1.14</span> <strong>14. Multiple Response Tables ‚Äì Columnwise Percentages</strong></a></li>
  <li><a href="#interactive-and-print-ready-table" id="toc-interactive-and-print-ready-table" class="nav-link" data-scroll-target="#interactive-and-print-ready-table"><span class="header-section-number">1.15</span> <strong>15. Interactive and Print-Ready Table</strong></a></li>
  </ul></li>
  <li><a href="#brief-summary" id="toc-brief-summary" class="nav-link" data-scroll-target="#brief-summary"><span class="header-section-number">2</span> Brief summary</a></li>
  <li><a href="#key-takeaways" id="toc-key-takeaways" class="nav-link" data-scroll-target="#key-takeaways"><span class="header-section-number">3</span> Key Takeaways</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">
<!-- logo.Rhtml -->

<div style="display: flex; align-items: center; justify-content: left; padding: 10px; position: fixed; top: 10px; left: 10px; z-index: 1000;">

  <img src="top_logo.jpg" alt="Logo" style="height: 50px; width: auto; margin-right: 10px;">

  <h1 style="margin: 0;">H. Mellie B</h1>

</div>




<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title">Automating Publication-Ready Tables in R</h1><button type="button" class="btn code-tools-button" id="quarto-code-tools-source"><i class="bi"></i> Code</button></div></div>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Habtamu Bizuayehu </p>
          </div>
  </div>
    
  
    
  </div>
  


</header>


<section id="overview-creating-a-publication-ready-table-in-r-with-flextable" class="level1" data-number="1">
<h1 data-number="1"><span class="header-section-number">1</span> üìã Overview: Creating a Publication-Ready Table in R with <code>flextable</code></h1>
<p>This section presents a walkthrough of generating a publication-ready table. The aim is to summarize and format data in a professional way. The key steps include:</p>
<ul>
<li><p>Cleaning and preparing data for consistency.</p></li>
<li><p>Creating summary tables for different variables.</p></li>
<li><p>Combining and styling tables for clear visual presentation.</p></li>
<li><p>Automating the process using <code>flextable</code>.</p></li>
</ul>
<p>The code below demonstrates how to achieve these steps. I will demonstrate how to generate a <strong>clean, publication-ready summary table</strong> using R. The approach combines data manipulation with <code>dplyr</code>, summary tabulation with <code>janitor</code>, and elegant styling via the <code>flextable</code> package.</p>
<p>This process is especially useful for public health datasets with categorical variables like age, gender, or service dates and includes options for handling missing data, calculating row percentages, column percentages and customizing formatting such as font type, table width, and color.</p>
<p>By automating these steps, we can save time, reduce manual formatting errors, and ensure consistency across tables.</p>
<p>üîπ Step 1: Load Required Libraries</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Clear environment and console</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>()) </span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\014</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div style="page-break-after: always;"></div>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load required packages</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="co">#gc() #garbage collector to clean up the workspace.</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="at">repos =</span> <span class="fu">c</span>(<span class="at">CRAN =</span> <span class="st">"https://cran.rstudio.com"</span>))</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="co"># List of required packages for Date and Time Data Analysis</span></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>packages <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>  <span class="st">"lubridate"</span>, <span class="st">"dplyr"</span>, <span class="st">"stringr"</span>, <span class="st">"zoo"</span>, <span class="st">"tsibble"</span>, <span class="st">"ggplot2"</span>, <span class="st">"plotly"</span>, </span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>  <span class="st">"readr"</span>, <span class="st">"forecast"</span>, <span class="st">"prettydoc"</span>, <span class="st">"janitor"</span>, <span class="st">"knitr"</span>, <span class="st">"rmarkdown"</span>, <span class="st">"yaml"</span>, </span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>  <span class="st">"flextable"</span>, <span class="st">"scales"</span>, <span class="st">"gt"</span>, <span class="st">"reactable"</span>, <span class="st">"tidyverse"</span>, <span class="st">"tidyr"</span>, <span class="st">"officer"</span></span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Install and load packages with descriptions</span></span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (pkg <span class="cf">in</span> packages) {</span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="sc">!</span><span class="fu">require</span>(pkg, <span class="at">character.only =</span> <span class="cn">TRUE</span>)) {</span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">install.packages</span>(pkg)</span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Install quarto if not already installed</span></span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">requireNamespace</span>(<span class="st">"quarto"</span>, <span class="at">quietly =</span> <span class="cn">TRUE</span>)) <span class="fu">install.packages</span>(<span class="st">"quarto"</span>)</span>
<span id="cb2-21"><a href="#cb2-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-22"><a href="#cb2-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-23"><a href="#cb2-23" aria-hidden="true" tabindex="-1"></a><span class="co"># **Load required libraries**</span></span>
<span id="cb2-24"><a href="#cb2-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-25"><a href="#cb2-25" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lubridate) <span class="co"># Simplifies the manipulation of dates and times in R (e.g., formatting, extracting components)</span></span>
<span id="cb2-26"><a href="#cb2-26" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr) <span class="co"># Provides tools for data manipulation, helpful for filtering and summarizing date-based data</span></span>
<span id="cb2-27"><a href="#cb2-27" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(stringr) <span class="co"># Simplifies string manipulation</span></span>
<span id="cb2-28"><a href="#cb2-28" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyr)   <span class="co"># Reshaping and tidying data</span></span>
<span id="cb2-29"><a href="#cb2-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-30"><a href="#cb2-30" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(zoo) <span class="co"># For working with time series data, including rolling calculations and handling missing data in time series</span></span>
<span id="cb2-31"><a href="#cb2-31" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tsibble) <span class="co"># Provides tools for handling time series data, including date-time indexes and features for forecasting</span></span>
<span id="cb2-32"><a href="#cb2-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-33"><a href="#cb2-33" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readr) <span class="co"># For reading date-time data from CSV</span></span>
<span id="cb2-34"><a href="#cb2-34" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(haven) <span class="co">#  data from other statistical software formats (SPSS, SAS, Stata)</span></span>
<span id="cb2-35"><a href="#cb2-35" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(forecast) <span class="co"># Useful for time series forecasting, especially when working with seasonal or trend-based data</span></span>
<span id="cb2-36"><a href="#cb2-36" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2) <span class="co"># For visualizing date-time trends in data (e.g., time series plots)</span></span>
<span id="cb2-37"><a href="#cb2-37" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(janitor) <span class="co"># Tabulation, cleaning column names, adding totals and proportions</span></span>
<span id="cb2-38"><a href="#cb2-38" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span> (plotly)     <span class="co"># Interactive visualizations</span></span>
<span id="cb2-39"><a href="#cb2-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-40"><a href="#cb2-40" aria-hidden="true" tabindex="-1"></a><span class="co"># Documentation/reporting</span></span>
<span id="cb2-41"><a href="#cb2-41" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(prettydoc)  <span class="co"># Pretty document templates</span></span>
<span id="cb2-42"><a href="#cb2-42" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(flexdashboard)<span class="co"># Interactive dashboards</span></span>
<span id="cb2-43"><a href="#cb2-43" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(quarto)  <span class="co"># For rendering and publishing documents with the Quarto framework</span></span>
<span id="cb2-44"><a href="#cb2-44" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(yaml)       <span class="co"># YAML document processing</span></span>
<span id="cb2-45"><a href="#cb2-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-46"><a href="#cb2-46" aria-hidden="true" tabindex="-1"></a><span class="co"># Tabulation</span></span>
<span id="cb2-47"><a href="#cb2-47" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(flextable)  <span class="co"># for creating styled, publication-ready tables</span></span>
<span id="cb2-48"><a href="#cb2-48" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gt)         <span class="co"># Grammar of tables</span></span>
<span id="cb2-49"><a href="#cb2-49" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(reactable)  <span class="co"># Interactive tables</span></span>
<span id="cb2-50"><a href="#cb2-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-51"><a href="#cb2-51" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(scales) <span class="co"># for number formatting (e.g., commas)</span></span>
<span id="cb2-52"><a href="#cb2-52" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(officer)  <span class="co">#  For exporting tables/reports to Word or PowerPoint</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">setwd</span>(<span class="st">"C:/Users/User/Desktop/Materials_ Course and proposals/Course Related/DataCamp/Data/"</span>)</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="fu">load</span>(<span class="st">"Vaccination_uptake.RDATA"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>üîπ Step 2: Convert Grouping Variables to Character</p>
<p>Before we tabulate values, we need to ensure all grouping variables have a consistent format. The table-generating function later in this workflow expects character values. If a mix of numeric and character types is used, the output may fail or be misaligned.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>vacc_1524 <span class="ot">&lt;-</span> vacc_1524 <span class="sc">%&gt;%</span>   <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">c</span>(age_group, gender, marital_status,                   vacc_service_year, vacc_quarter, vacc_weekday), as.character))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>üí° <em>Why this matters</em>: If one variable like <code>gender</code> is stored as a character and another like <code>age_group</code> is numeric, the table creation function won‚Äôt process them uniformly. This step ensures compatibility and consistency.</p>
<p>üîπ Step 3: Define a Table Generation Function</p>
<p>This section defines a reusable function that creates a summary table for any categorical variable of interest.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>create_tab <span class="ot">&lt;-</span> <span class="cf">function</span>(data, var, label) {</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Step 1: Generate counts for non-missing values</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>  tab_main <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>({{ var }})) <span class="sc">%&gt;%</span>          <span class="co"># Exclude missing values</span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tabyl</span>({{ var }}, vacc_group3) <span class="sc">%&gt;%</span>      <span class="co"># Cross-tabulate (var √ó vaccine groups)</span></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">Category =</span> label, <span class="at">.before =</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span>  <span class="co"># Add category label (e.g., "Gender")</span></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rename</span>(<span class="at">Label =</span> {{ var }}) <span class="sc">%&gt;%</span>           <span class="co"># Rename variable column for consistency</span></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">Label =</span> <span class="fu">as.character</span>(Label))     <span class="co"># Ensure labels are text</span></span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Step 2: Check for and append missing values (if any)</span></span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a>  na_count <span class="ot">&lt;-</span> <span class="fu">sum</span>(<span class="fu">is.na</span>(<span class="fu">pull</span>(data, {{ var }})))</span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (na_count <span class="sc">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a>    missing_row <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a>      <span class="at">Category =</span> label,</span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a>      <span class="at">Label =</span> <span class="st">"Missing"</span>,</span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a>      <span class="st">`</span><span class="at">Respiratory vaccines</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">sum</span>(data<span class="sc">$</span>vacc_group3 <span class="sc">==</span> <span class="st">"Respiratory vaccines"</span> <span class="sc">&amp;</span> <span class="fu">is.na</span>(<span class="fu">pull</span>(data, {{ var }})), <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true" tabindex="-1"></a>      ...  <span class="co"># Similar for other vaccine groups</span></span>
<span id="cb5-18"><a href="#cb5-18" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb5-19"><a href="#cb5-19" aria-hidden="true" tabindex="-1"></a>    tab_final <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(tab_main, missing_row)  <span class="co"># Combine with main table</span></span>
<span id="cb5-20"><a href="#cb5-20" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb5-21"><a href="#cb5-21" aria-hidden="true" tabindex="-1"></a>    tab_final <span class="ot">&lt;-</span> tab_main</span>
<span id="cb5-22"><a href="#cb5-22" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb5-23"><a href="#cb5-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(tab_final)</span>
<span id="cb5-24"><a href="#cb5-24" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Let‚Äôs break it down:</p>
<ul>
<li><p><strong><code>data</code></strong>: The full dataset (<code>vacc_1524</code>) you are analyzing.</p></li>
<li><p><strong><code>var</code></strong>: A single categorical variable (e.g., <code>age_group</code>) whose values will appear as rows.</p></li>
<li><p><strong><code>label</code></strong>: A string label that describes the variable for the final table (e.g., <code>"Age"</code>).</p></li>
</ul>
<p>Inside the function:</p>
<ul>
<li><p>We filter out missing values temporarily to generate the main table using tabyl().</p></li>
<li><p>We count and append missing entries separately, if any.</p></li>
<li><p>We return a single tibble containing counts across vaccine groups by value of the selected variable.</p></li>
</ul>
<p>This abstraction allows us to apply one function to multiple variables.</p>
<p>üîπ Step 4: Generate Summary Tables for Each Variable</p>
<p>The code below creates summary tables for several key variables: age, gender, marital status, service year, quarter, and weekday.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>tab_age            <span class="ot">&lt;-</span> <span class="fu">create_tab</span>(vacc_1524, age_group, <span class="st">"Age"</span>)</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>tab_sex            <span class="ot">&lt;-</span> <span class="fu">create_tab</span>(vacc_1524, gender, <span class="st">"Gender"</span>)</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>tab_marital_status <span class="ot">&lt;-</span> <span class="fu">create_tab</span>(vacc_1524, marital_status, <span class="st">"Marital status"</span>)</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>tab_year           <span class="ot">&lt;-</span> <span class="fu">create_tab</span>(vacc_1524, vacc_service_year, <span class="st">"Year"</span>)</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>tab_quarter        <span class="ot">&lt;-</span> <span class="fu">create_tab</span>(vacc_1524, vacc_quarter, <span class="st">"Quarter"</span>)</span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>tab_weekday        <span class="ot">&lt;-</span> <span class="fu">create_tab</span>(vacc_1524, vacc_weekday, <span class="st">"Weekday"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Each result is a well-structured table of vaccine uptake by subgroup.</p>
<p>üîπ Step 5: Combine All Summary Tables</p>
<p>Here, we merge the results into one combined table that can be styled and displayed together.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>tab_combined <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(tab_sex, tab_age, tab_marital_status, tab_year, tab_quarter, tab_weekday)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We are now working with one long-format table that contains all the variables of interest.</p>
<p>üîπ Step 6: Calculate Row-Wise Percentages and Format Counts</p>
<p>Next, I add percentages for each vaccine type within a row (e.g., among all women aged 20‚Äì29, what percent received respiratory vaccines?). I also format the counts with commas for easier reading.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>tab_combined <span class="ot">&lt;-</span> tab_combined <span class="sc">%&gt;%</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rowwise</span>() <span class="sc">%&gt;%</span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">Total =</span> <span class="fu">sum</span>(<span class="st">`</span><span class="at">Respiratory vaccines</span><span class="st">`</span>, <span class="st">`</span><span class="at">Childhood vaccines</span><span class="st">`</span>, Other, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">is_missing =</span> <span class="fu">trimws</span>(<span class="fu">tolower</span>(Label)) <span class="sc">==</span> <span class="st">"missing"</span>,</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">Respiratory =</span> <span class="fu">ifelse</span>(is_missing,</span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>                         <span class="fu">comma</span>(<span class="st">`</span><span class="at">Respiratory vaccines</span><span class="st">`</span>),</span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a>                         <span class="fu">paste0</span>(<span class="fu">comma</span>(<span class="st">`</span><span class="at">Respiratory vaccines</span><span class="st">`</span>), <span class="st">" ("</span>, <span class="fu">round</span>(<span class="dv">100</span> <span class="sc">*</span> <span class="st">`</span><span class="at">Respiratory vaccines</span><span class="st">`</span> <span class="sc">/</span> Total, <span class="dv">1</span>), <span class="st">")"</span>)),</span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">Childhood =</span> <span class="fu">ifelse</span>(is_missing,</span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a>                       <span class="fu">comma</span>(<span class="st">`</span><span class="at">Childhood vaccines</span><span class="st">`</span>),</span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a>                       <span class="fu">paste0</span>(<span class="fu">comma</span>(<span class="st">`</span><span class="at">Childhood vaccines</span><span class="st">`</span>), <span class="st">" ("</span>, <span class="fu">round</span>(<span class="dv">100</span> <span class="sc">*</span> <span class="st">`</span><span class="at">Childhood vaccines</span><span class="st">`</span> <span class="sc">/</span> Total, <span class="dv">1</span>), <span class="st">")"</span>)),</span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb8-15"><a href="#cb8-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">Other_grp =</span> <span class="fu">ifelse</span>(is_missing,</span>
<span id="cb8-16"><a href="#cb8-16" aria-hidden="true" tabindex="-1"></a>                       <span class="fu">comma</span>(Other),</span>
<span id="cb8-17"><a href="#cb8-17" aria-hidden="true" tabindex="-1"></a>                       <span class="fu">paste0</span>(<span class="fu">comma</span>(Other), <span class="st">" ("</span>, <span class="fu">round</span>(<span class="dv">100</span> <span class="sc">*</span> Other <span class="sc">/</span> Total, <span class="dv">1</span>), <span class="st">")"</span>))</span>
<span id="cb8-18"><a href="#cb8-18" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb8-19"><a href="#cb8-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb8-20"><a href="#cb8-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Category, Label, Respiratory, Childhood, Other_grp)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>üëâ Note: We skip calculating percentages for ‚ÄúMissing‚Äù rows to avoid misleading results.</p>
<p>üîπ Step 7: Show Category Name Once per Block</p>
<p>To improve readability, I only show the category name (like ‚ÄúAge‚Äù or ‚ÄúGender‚Äù) once per group.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>tab_combined <span class="ot">&lt;-</span> tab_combined <span class="sc">%&gt;%</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Category) <span class="sc">%&gt;%</span></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Category =</span> <span class="fu">ifelse</span>(<span class="fu">row_number</span>() <span class="sc">==</span> <span class="dv">1</span>, Category, <span class="st">""</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>üîπ Step 8: Count Total Vaccine Recipients (for Header Labels)</p>
<p>We calculate the total number of people who received each type of vaccine to include in the header row.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>totals <span class="ot">&lt;-</span> vacc_1524 <span class="sc">%&gt;%</span>   <span class="fu">count</span>(vacc_group3) <span class="sc">%&gt;%</span>   <span class="fu">deframe</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>üîπ Step 9: Style the Table Using <code>{flextable}</code></p>
<p>Now comes the fun part! We format and stylize the table with headers, font choices, alternating colors, and footnotes. This creates a visually appealing table suitable for publication.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ft_vacc_summary &lt;- tab_combined %&gt;%   flextable() %&gt;%   set_header_labels(...) %&gt;%   add_header_row(...) %&gt;%   add_header_row(...) %&gt;%   theme_box() %&gt;%   set_table_properties(layout = "autofit", width = 1) %&gt;%   width(...) %&gt;%   align(align = "justify", part = "all") %&gt;%   border_remove() %&gt;%   set_caption(...) %&gt;%   fontsize(...) %&gt;%   font(part = "all", fontname = "Times New Roman") %&gt;%   bg(part = "header", bg = "lightblue") %&gt;%   bg(j = 1:5, i = seq(1, nrow(tab_combined), 2), bg = "lightgray") %&gt;%   bg(j = 1:5, i = seq(2, nrow(tab_combined), 2), bg = "red") %&gt;%   footnote(...)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><strong>Key Steps</strong>:</p>
<ol type="1">
<li><p><strong>Set Headers</strong>: Labels columns appropriately such as including multi-row headers that describe each vaccine group with sample size (N)</p></li>
<li><p><strong>Add Header Rows</strong>: Includes multi-level headers for clarity.</p></li>
<li><p><strong>Themes and Layout</strong>: Applies a boxed theme, adjusts column widths, and aligns text.</p></li>
<li><p><strong>Font and Colors</strong>: Uses ‚ÄúTimes New Roman‚Äù and alternates row colors (e.g., gray and red) for better visuals.</p></li>
<li><p><strong>Add Captions, Superscripts and Footnotes</strong>: Provides context to the table.</p></li>
</ol>
<p>üîπ Step 10: Display the Table</p>
<p>üîπ Step 11: Clean Up Temporary Objects</p>
<p>To keep your R environment tidy, we remove the temporary tables and variables created along the way.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(tab_age, tab_sex, tab_marital_status, tab_year, tab_quarter, tab_weekday,     tab_combined, ft_vacc_summary, totals, create_tab)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="table-without-title-and-footer" class="level2" data-number="1.1">
<h2 data-number="1.1" class="anchored" data-anchor-id="table-without-title-and-footer"><span class="header-section-number">1.1</span> <strong>1. Table Without Title and Footer</strong></h2>
<p>This section introduces a basic version of the automated table‚Äîminimal and clean without captions or footnotes.</p>
<ul>
<li><p><strong>Why it matters</strong>: A stripped-down table is great for quick previews or inline summaries.</p></li>
<li><p><strong>When to use</strong>: Internal drafts, early analysis stages, or dashboards.</p></li>
<li><p>Ensure grouping variables are characters to avoid formatting issues.</p></li>
<li><p>Build one reusable function (<code>create_tab</code>) to apply across multiple variables.</p></li>
<li><p>Bind all summary tables into a combined format.</p></li>
<li><p>Add row-wise percentages directly to the table.</p></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ------------1. Table without title and footer -------------------------------------------+</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="co">#.......................Ensure grouping variables are characters............................</span></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>vacc_1524 <span class="ot">&lt;-</span> vacc_1524 <span class="sc">%&gt;%</span></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">c</span>(vacc_service_year, vacc_quarter, vacc_weekday), as.character))</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a><span class="co"># ---------------- Table generation function ....................</span></span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>create_tab <span class="ot">&lt;-</span> <span class="cf">function</span>(data, var, label) {</span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>  data <span class="sc">%&gt;%</span></span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>({{ var }})) <span class="sc">%&gt;%</span></span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tabyl</span>({{ var }}, vacc_group3) <span class="sc">%&gt;%</span></span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">Category =</span> label, <span class="at">.before =</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rename</span>(<span class="at">Label =</span> {{ var }}) <span class="sc">%&gt;%</span></span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">Label =</span> <span class="fu">as.character</span>(Label))</span>
<span id="cb13-14"><a href="#cb13-14" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb13-15"><a href="#cb13-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-16"><a href="#cb13-16" aria-hidden="true" tabindex="-1"></a><span class="co"># .................... Create summary tables ....................</span></span>
<span id="cb13-17"><a href="#cb13-17" aria-hidden="true" tabindex="-1"></a>tab_age <span class="ot">&lt;-</span> <span class="fu">create_tab</span>(vacc_1524, age_group, <span class="st">"Age"</span>)</span>
<span id="cb13-18"><a href="#cb13-18" aria-hidden="true" tabindex="-1"></a>tab_sex <span class="ot">&lt;-</span> <span class="fu">create_tab</span>(vacc_1524, gender, <span class="st">"Gender"</span>)</span>
<span id="cb13-19"><a href="#cb13-19" aria-hidden="true" tabindex="-1"></a>tab_marital_status <span class="ot">&lt;-</span> <span class="fu">create_tab</span>(vacc_1524, marital_status, <span class="st">"Marital status"</span>)</span>
<span id="cb13-20"><a href="#cb13-20" aria-hidden="true" tabindex="-1"></a>tab_year    <span class="ot">&lt;-</span> <span class="fu">create_tab</span>(vacc_1524, vacc_service_year, <span class="st">"Year"</span>)</span>
<span id="cb13-21"><a href="#cb13-21" aria-hidden="true" tabindex="-1"></a>tab_quarter <span class="ot">&lt;-</span> <span class="fu">create_tab</span>(vacc_1524, vacc_quarter, <span class="st">"Quarter"</span>)</span>
<span id="cb13-22"><a href="#cb13-22" aria-hidden="true" tabindex="-1"></a>tab_weekday <span class="ot">&lt;-</span> <span class="fu">create_tab</span>(vacc_1524, vacc_weekday, <span class="st">"Weekday"</span>)</span>
<span id="cb13-23"><a href="#cb13-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-24"><a href="#cb13-24" aria-hidden="true" tabindex="-1"></a><span class="co"># ......................Combine all tabs ....................</span></span>
<span id="cb13-25"><a href="#cb13-25" aria-hidden="true" tabindex="-1"></a>tab_combined <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(tab_sex, tab_age, tab_marital_status, tab_year, tab_quarter, tab_weekday)</span>
<span id="cb13-26"><a href="#cb13-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-27"><a href="#cb13-27" aria-hidden="true" tabindex="-1"></a><span class="co"># ....................... Create row % and format as text ....................</span></span>
<span id="cb13-28"><a href="#cb13-28" aria-hidden="true" tabindex="-1"></a>tab_combined <span class="ot">&lt;-</span> tab_combined <span class="sc">%&gt;%</span></span>
<span id="cb13-29"><a href="#cb13-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rowwise</span>() <span class="sc">%&gt;%</span></span>
<span id="cb13-30"><a href="#cb13-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb13-31"><a href="#cb13-31" aria-hidden="true" tabindex="-1"></a>    <span class="at">Total =</span> <span class="fu">sum</span>(<span class="st">`</span><span class="at">Respiratory vaccines</span><span class="st">`</span>, <span class="st">`</span><span class="at">Childhood vaccines</span><span class="st">`</span>, Other, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb13-32"><a href="#cb13-32" aria-hidden="true" tabindex="-1"></a>    <span class="at">Respiratory =</span> <span class="fu">paste0</span>(<span class="fu">comma</span>(<span class="st">`</span><span class="at">Respiratory vaccines</span><span class="st">`</span>), <span class="st">" ("</span>, <span class="fu">round</span>(<span class="dv">100</span> <span class="sc">*</span> <span class="st">`</span><span class="at">Respiratory vaccines</span><span class="st">`</span> <span class="sc">/</span> Total, <span class="dv">1</span>), <span class="st">")"</span>),</span>
<span id="cb13-33"><a href="#cb13-33" aria-hidden="true" tabindex="-1"></a>    <span class="at">Childhood   =</span> <span class="fu">paste0</span>(<span class="fu">comma</span>(<span class="st">`</span><span class="at">Childhood vaccines</span><span class="st">`</span>), <span class="st">" ("</span>, <span class="fu">round</span>(<span class="dv">100</span> <span class="sc">*</span> <span class="st">`</span><span class="at">Childhood vaccines</span><span class="st">`</span> <span class="sc">/</span> Total, <span class="dv">1</span>), <span class="st">")"</span>),</span>
<span id="cb13-34"><a href="#cb13-34" aria-hidden="true" tabindex="-1"></a>    <span class="at">Other_grp   =</span> <span class="fu">paste0</span>(<span class="fu">comma</span>(Other), <span class="st">" ("</span>, <span class="fu">round</span>(<span class="dv">100</span> <span class="sc">*</span> Other <span class="sc">/</span> Total, <span class="dv">1</span>), <span class="st">")"</span>)</span>
<span id="cb13-35"><a href="#cb13-35" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb13-36"><a href="#cb13-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb13-37"><a href="#cb13-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-38"><a href="#cb13-38" aria-hidden="true" tabindex="-1"></a><span class="co"># ............................. Remove repeated variable names ....................</span></span>
<span id="cb13-39"><a href="#cb13-39" aria-hidden="true" tabindex="-1"></a>tab_combined <span class="ot">&lt;-</span> tab_combined <span class="sc">%&gt;%</span></span>
<span id="cb13-40"><a href="#cb13-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Category) <span class="sc">%&gt;%</span></span>
<span id="cb13-41"><a href="#cb13-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Category =</span> <span class="fu">ifelse</span>(<span class="fu">row_number</span>() <span class="sc">==</span> <span class="dv">1</span>, Category, <span class="st">""</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb13-42"><a href="#cb13-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb13-43"><a href="#cb13-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-44"><a href="#cb13-44" aria-hidden="true" tabindex="-1"></a><span class="co"># ........................... Get total counts per vaccine group ....................</span></span>
<span id="cb13-45"><a href="#cb13-45" aria-hidden="true" tabindex="-1"></a>totals <span class="ot">&lt;-</span> vacc_1524 <span class="sc">%&gt;%</span></span>
<span id="cb13-46"><a href="#cb13-46" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(vacc_group3) <span class="sc">%&gt;%</span></span>
<span id="cb13-47"><a href="#cb13-47" aria-hidden="true" tabindex="-1"></a>  <span class="fu">deframe</span>()</span>
<span id="cb13-48"><a href="#cb13-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-49"><a href="#cb13-49" aria-hidden="true" tabindex="-1"></a><span class="co"># .................... Create flextable ....................</span></span>
<span id="cb13-50"><a href="#cb13-50" aria-hidden="true" tabindex="-1"></a>ft_vacc_summary <span class="ot">&lt;-</span> tab_combined <span class="sc">%&gt;%</span></span>
<span id="cb13-51"><a href="#cb13-51" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Category, Label, Respiratory, Childhood, Other_grp) <span class="sc">%&gt;%</span></span>
<span id="cb13-52"><a href="#cb13-52" aria-hidden="true" tabindex="-1"></a>  <span class="fu">flextable</span>() <span class="sc">%&gt;%</span></span>
<span id="cb13-53"><a href="#cb13-53" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_header_labels</span>(</span>
<span id="cb13-54"><a href="#cb13-54" aria-hidden="true" tabindex="-1"></a>    <span class="at">Category =</span> <span class="st">"Variable type"</span>,</span>
<span id="cb13-55"><a href="#cb13-55" aria-hidden="true" tabindex="-1"></a>    <span class="at">Label =</span> <span class="st">"Values"</span>,</span>
<span id="cb13-56"><a href="#cb13-56" aria-hidden="true" tabindex="-1"></a>    <span class="at">Respiratory =</span> <span class="st">"Number (%)·µÉ"</span>,</span>
<span id="cb13-57"><a href="#cb13-57" aria-hidden="true" tabindex="-1"></a>    <span class="at">Childhood =</span> <span class="st">"Number (%)·µÉ"</span>,</span>
<span id="cb13-58"><a href="#cb13-58" aria-hidden="true" tabindex="-1"></a>    <span class="at">Other_grp =</span> <span class="st">"Number (%)·µÉ"</span></span>
<span id="cb13-59"><a href="#cb13-59" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb13-60"><a href="#cb13-60" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_header_row</span>( <span class="co"># Second row</span></span>
<span id="cb13-61"><a href="#cb13-61" aria-hidden="true" tabindex="-1"></a>    <span class="at">values =</span> <span class="fu">c</span>(</span>
<span id="cb13-62"><a href="#cb13-62" aria-hidden="true" tabindex="-1"></a>      <span class="st">""</span>, <span class="st">""</span>,</span>
<span id="cb13-63"><a href="#cb13-63" aria-hidden="true" tabindex="-1"></a>      <span class="fu">paste0</span>(<span class="st">"Respiratory vaccines (N = "</span>, <span class="fu">format</span>(totals[<span class="st">"Respiratory vaccines"</span>], <span class="at">big.mark =</span> <span class="st">","</span>), <span class="st">")"</span>),</span>
<span id="cb13-64"><a href="#cb13-64" aria-hidden="true" tabindex="-1"></a>      <span class="fu">paste0</span>(<span class="st">"Childhood vaccines (N = "</span>, <span class="fu">format</span>(totals[<span class="st">"Childhood vaccines"</span>], <span class="at">big.mark =</span> <span class="st">","</span>), <span class="st">")"</span>),</span>
<span id="cb13-65"><a href="#cb13-65" aria-hidden="true" tabindex="-1"></a>      <span class="fu">paste0</span>(<span class="st">"Other (N = "</span>, <span class="fu">format</span>(totals[<span class="st">"Other"</span>], <span class="at">big.mark =</span> <span class="st">","</span>), <span class="st">")"</span>)</span>
<span id="cb13-66"><a href="#cb13-66" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb13-67"><a href="#cb13-67" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb13-68"><a href="#cb13-68" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_header_row</span>( <span class="co"># First row (merged header)</span></span>
<span id="cb13-69"><a href="#cb13-69" aria-hidden="true" tabindex="-1"></a>    <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"Description"</span>, <span class="st">"Vaccination uptake"</span>),</span>
<span id="cb13-70"><a href="#cb13-70" aria-hidden="true" tabindex="-1"></a>    <span class="at">colwidths =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">3</span>)</span>
<span id="cb13-71"><a href="#cb13-71" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb13-72"><a href="#cb13-72" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_box</span>() <span class="sc">%&gt;%</span></span>
<span id="cb13-73"><a href="#cb13-73" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_table_properties</span>(<span class="at">layout =</span> <span class="st">"autofit"</span>, <span class="at">width =</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb13-74"><a href="#cb13-74" aria-hidden="true" tabindex="-1"></a>  <span class="fu">width</span>(<span class="at">j =</span> <span class="dv">1</span>, <span class="at">width =</span> <span class="fl">1.5</span>) <span class="sc">%&gt;%</span></span>
<span id="cb13-75"><a href="#cb13-75" aria-hidden="true" tabindex="-1"></a>  <span class="fu">width</span>(<span class="at">j =</span> <span class="dv">2</span>, <span class="at">width =</span> <span class="fl">2.5</span>) <span class="sc">%&gt;%</span></span>
<span id="cb13-76"><a href="#cb13-76" aria-hidden="true" tabindex="-1"></a>  <span class="fu">width</span>(<span class="at">j =</span> <span class="dv">3</span><span class="sc">:</span><span class="dv">4</span>, <span class="at">width =</span> <span class="fl">1.5</span>) <span class="sc">%&gt;%</span></span>
<span id="cb13-77"><a href="#cb13-77" aria-hidden="true" tabindex="-1"></a>  <span class="fu">align</span>(<span class="at">align =</span> <span class="st">"justify"</span>, <span class="at">part =</span> <span class="st">"all"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb13-78"><a href="#cb13-78" aria-hidden="true" tabindex="-1"></a>  <span class="fu">border_remove</span>() <span class="sc">%&gt;%</span></span>
<span id="cb13-79"><a href="#cb13-79" aria-hidden="true" tabindex="-1"></a>  <span class="fu">border</span>(<span class="at">part =</span> <span class="st">"header"</span>, <span class="at">i =</span> <span class="dv">1</span>, <span class="at">border.top =</span> <span class="fu">fp_border</span>(<span class="at">color =</span> <span class="st">"black"</span>, <span class="at">width =</span> <span class="dv">1</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb13-80"><a href="#cb13-80" aria-hidden="true" tabindex="-1"></a>  <span class="fu">border</span>(<span class="at">part =</span> <span class="st">"header"</span>, <span class="at">i =</span> <span class="dv">3</span>, <span class="at">border.bottom =</span> <span class="fu">fp_border</span>(<span class="at">color =</span> <span class="st">"black"</span>, <span class="at">width =</span> <span class="dv">1</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb13-81"><a href="#cb13-81" aria-hidden="true" tabindex="-1"></a>  <span class="fu">border_inner_h</span>(<span class="at">part =</span> <span class="st">"header"</span>, <span class="at">border =</span> <span class="fu">fp_border</span>(<span class="at">color =</span> <span class="st">"black"</span>, <span class="at">width =</span> <span class="fl">0.8</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb13-82"><a href="#cb13-82" aria-hidden="true" tabindex="-1"></a>  <span class="fu">border_inner_h</span>(<span class="at">part =</span> <span class="st">"body"</span>, <span class="at">border =</span> <span class="fu">fp_border</span>(<span class="at">color =</span> <span class="st">"black"</span>, <span class="at">width =</span> <span class="fl">0.8</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb13-83"><a href="#cb13-83" aria-hidden="true" tabindex="-1"></a>  <span class="fu">border</span>(<span class="at">part =</span> <span class="st">"body"</span>, <span class="at">i =</span> <span class="fu">nrow</span>(tab_combined), <span class="at">border.bottom =</span> <span class="fu">fp_border</span>(<span class="at">color =</span> <span class="st">"black"</span>, <span class="at">width =</span> <span class="dv">1</span>)) </span>
<span id="cb13-84"><a href="#cb13-84" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb13-85"><a href="#cb13-85" aria-hidden="true" tabindex="-1"></a><span class="co"># --- Display the table ---</span></span>
<span id="cb13-86"><a href="#cb13-86" aria-hidden="true" tabindex="-1"></a>ft_vacc_summary</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="tabwid"><style>.cl-fb7cc574{table-layout:auto;width:100%;}.cl-fb72bb38{font-family:'Arial';font-size:11pt;font-weight:bold;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-fb72bb42{font-family:'Arial';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-fb763e8e{margin:0;text-align:justify;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-fb766166{background-color:transparent;vertical-align: middle;border-bottom: 0.8pt solid rgba(0, 0, 0, 1.00);border-top: 1pt solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-fb766167{background-color:transparent;vertical-align: middle;border-bottom: 0.8pt solid rgba(0, 0, 0, 1.00);border-top: 1pt solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-fb766170{background-color:transparent;vertical-align: middle;border-bottom: 0.8pt solid rgba(0, 0, 0, 1.00);border-top: 1pt solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-fb766171{background-color:transparent;vertical-align: middle;border-bottom: 0.8pt solid rgba(0, 0, 0, 1.00);border-top: 0.8pt solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-fb766172{background-color:transparent;vertical-align: middle;border-bottom: 0.8pt solid rgba(0, 0, 0, 1.00);border-top: 0.8pt solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-fb76617a{background-color:transparent;vertical-align: middle;border-bottom: 0.8pt solid rgba(0, 0, 0, 1.00);border-top: 0.8pt solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-fb76617b{background-color:transparent;vertical-align: middle;border-bottom: 1pt solid rgba(0, 0, 0, 1.00);border-top: 0.8pt solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-fb76617c{background-color:transparent;vertical-align: middle;border-bottom: 1pt solid rgba(0, 0, 0, 1.00);border-top: 0.8pt solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-fb76617d{background-color:transparent;vertical-align: middle;border-bottom: 1pt solid rgba(0, 0, 0, 1.00);border-top: 0.8pt solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-fb766184{background-color:transparent;vertical-align: middle;border-bottom: 0.8pt solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-fb766185{background-color:transparent;vertical-align: middle;border-bottom: 0.8pt solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-fb766186{background-color:transparent;vertical-align: middle;border-bottom: 0.8pt solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table data-quarto-disable-processing="true" class="cl-fb7cc574"><thead><tr style="overflow-wrap:break-word;"><th colspan="2" class="cl-fb766166"><p class="cl-fb763e8e"><span class="cl-fb72bb38">Description</span></p></th><th colspan="3" class="cl-fb766166"><p class="cl-fb763e8e"><span class="cl-fb72bb38">Vaccination uptake</span></p></th></tr><tr style="overflow-wrap:break-word;"><th class="cl-fb766171"><p class="cl-fb763e8e"><span class="cl-fb72bb38"></span></p></th><th class="cl-fb766172"><p class="cl-fb763e8e"><span class="cl-fb72bb38"></span></p></th><th class="cl-fb766171"><p class="cl-fb763e8e"><span class="cl-fb72bb38">Respiratory vaccines (N = 955)</span></p></th><th class="cl-fb766171"><p class="cl-fb763e8e"><span class="cl-fb72bb38">Childhood vaccines (N = 472)</span></p></th><th class="cl-fb76617a"><p class="cl-fb763e8e"><span class="cl-fb72bb38">Other (N = 126)</span></p></th></tr><tr style="overflow-wrap:break-word;"><th class="cl-fb76617b"><p class="cl-fb763e8e"><span class="cl-fb72bb38">Variable type</span></p></th><th class="cl-fb76617c"><p class="cl-fb763e8e"><span class="cl-fb72bb38">Values</span></p></th><th class="cl-fb76617b"><p class="cl-fb763e8e"><span class="cl-fb72bb38">Number (%)·µÉ</span></p></th><th class="cl-fb76617b"><p class="cl-fb763e8e"><span class="cl-fb72bb38">Number (%)·µÉ</span></p></th><th class="cl-fb76617d"><p class="cl-fb763e8e"><span class="cl-fb72bb38">Number (%)·µÉ</span></p></th></tr></thead><tbody><tr style="overflow-wrap:break-word;"><td class="cl-fb766184"><p class="cl-fb763e8e"><span class="cl-fb72bb42">Gender</span></p></td><td class="cl-fb766185"><p class="cl-fb763e8e"><span class="cl-fb72bb42">Female</span></p></td><td class="cl-fb766184"><p class="cl-fb763e8e"><span class="cl-fb72bb42">511 (64)</span></p></td><td class="cl-fb766184"><p class="cl-fb763e8e"><span class="cl-fb72bb42">233 (29.2)</span></p></td><td class="cl-fb766186"><p class="cl-fb763e8e"><span class="cl-fb72bb42">54 (6.8)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-fb766171"><p class="cl-fb763e8e"><span class="cl-fb72bb42"></span></p></td><td class="cl-fb766172"><p class="cl-fb763e8e"><span class="cl-fb72bb42">Male</span></p></td><td class="cl-fb766171"><p class="cl-fb763e8e"><span class="cl-fb72bb42">444 (58.8)</span></p></td><td class="cl-fb766171"><p class="cl-fb763e8e"><span class="cl-fb72bb42">239 (31.7)</span></p></td><td class="cl-fb76617a"><p class="cl-fb763e8e"><span class="cl-fb72bb42">72 (9.5)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-fb766171"><p class="cl-fb763e8e"><span class="cl-fb72bb42">Age</span></p></td><td class="cl-fb766172"><p class="cl-fb763e8e"><span class="cl-fb72bb42">0-19</span></p></td><td class="cl-fb766171"><p class="cl-fb763e8e"><span class="cl-fb72bb42">250 (38.9)</span></p></td><td class="cl-fb766171"><p class="cl-fb763e8e"><span class="cl-fb72bb42">302 (47)</span></p></td><td class="cl-fb76617a"><p class="cl-fb763e8e"><span class="cl-fb72bb42">90 (14)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-fb766171"><p class="cl-fb763e8e"><span class="cl-fb72bb42"></span></p></td><td class="cl-fb766172"><p class="cl-fb763e8e"><span class="cl-fb72bb42">20-29</span></p></td><td class="cl-fb766171"><p class="cl-fb763e8e"><span class="cl-fb72bb42">150 (68.2)</span></p></td><td class="cl-fb766171"><p class="cl-fb763e8e"><span class="cl-fb72bb42">70 (31.8)</span></p></td><td class="cl-fb76617a"><p class="cl-fb763e8e"><span class="cl-fb72bb42">0 (0)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-fb766171"><p class="cl-fb763e8e"><span class="cl-fb72bb42"></span></p></td><td class="cl-fb766172"><p class="cl-fb763e8e"><span class="cl-fb72bb42">30-39</span></p></td><td class="cl-fb766171"><p class="cl-fb763e8e"><span class="cl-fb72bb42">47 (71.2)</span></p></td><td class="cl-fb766171"><p class="cl-fb763e8e"><span class="cl-fb72bb42">19 (28.8)</span></p></td><td class="cl-fb76617a"><p class="cl-fb763e8e"><span class="cl-fb72bb42">0 (0)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-fb766171"><p class="cl-fb763e8e"><span class="cl-fb72bb42"></span></p></td><td class="cl-fb766172"><p class="cl-fb763e8e"><span class="cl-fb72bb42">40-49</span></p></td><td class="cl-fb766171"><p class="cl-fb763e8e"><span class="cl-fb72bb42">142 (75.9)</span></p></td><td class="cl-fb766171"><p class="cl-fb763e8e"><span class="cl-fb72bb42">45 (24.1)</span></p></td><td class="cl-fb76617a"><p class="cl-fb763e8e"><span class="cl-fb72bb42">0 (0)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-fb766171"><p class="cl-fb763e8e"><span class="cl-fb72bb42"></span></p></td><td class="cl-fb766172"><p class="cl-fb763e8e"><span class="cl-fb72bb42">50-59</span></p></td><td class="cl-fb766171"><p class="cl-fb763e8e"><span class="cl-fb72bb42">112 (77.8)</span></p></td><td class="cl-fb766171"><p class="cl-fb763e8e"><span class="cl-fb72bb42">14 (9.7)</span></p></td><td class="cl-fb76617a"><p class="cl-fb763e8e"><span class="cl-fb72bb42">18 (12.5)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-fb766171"><p class="cl-fb763e8e"><span class="cl-fb72bb42"></span></p></td><td class="cl-fb766172"><p class="cl-fb763e8e"><span class="cl-fb72bb42">60-69</span></p></td><td class="cl-fb766171"><p class="cl-fb763e8e"><span class="cl-fb72bb42">149 (87.6)</span></p></td><td class="cl-fb766171"><p class="cl-fb763e8e"><span class="cl-fb72bb42">13 (7.6)</span></p></td><td class="cl-fb76617a"><p class="cl-fb763e8e"><span class="cl-fb72bb42">8 (4.7)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-fb766171"><p class="cl-fb763e8e"><span class="cl-fb72bb42"></span></p></td><td class="cl-fb766172"><p class="cl-fb763e8e"><span class="cl-fb72bb42">70+</span></p></td><td class="cl-fb766171"><p class="cl-fb763e8e"><span class="cl-fb72bb42">105 (84.7)</span></p></td><td class="cl-fb766171"><p class="cl-fb763e8e"><span class="cl-fb72bb42">9 (7.3)</span></p></td><td class="cl-fb76617a"><p class="cl-fb763e8e"><span class="cl-fb72bb42">10 (8.1)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-fb766171"><p class="cl-fb763e8e"><span class="cl-fb72bb42">Marital status</span></p></td><td class="cl-fb766172"><p class="cl-fb763e8e"><span class="cl-fb72bb42">Divorced</span></p></td><td class="cl-fb766171"><p class="cl-fb763e8e"><span class="cl-fb72bb42">136 (83.4)</span></p></td><td class="cl-fb766171"><p class="cl-fb763e8e"><span class="cl-fb72bb42">15 (9.2)</span></p></td><td class="cl-fb76617a"><p class="cl-fb763e8e"><span class="cl-fb72bb42">12 (7.4)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-fb766171"><p class="cl-fb763e8e"><span class="cl-fb72bb42"></span></p></td><td class="cl-fb766172"><p class="cl-fb763e8e"><span class="cl-fb72bb42">Married</span></p></td><td class="cl-fb766171"><p class="cl-fb763e8e"><span class="cl-fb72bb42">289 (79)</span></p></td><td class="cl-fb766171"><p class="cl-fb763e8e"><span class="cl-fb72bb42">59 (16.1)</span></p></td><td class="cl-fb76617a"><p class="cl-fb763e8e"><span class="cl-fb72bb42">18 (4.9)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-fb766171"><p class="cl-fb763e8e"><span class="cl-fb72bb42"></span></p></td><td class="cl-fb766172"><p class="cl-fb763e8e"><span class="cl-fb72bb42">Single/widowed</span></p></td><td class="cl-fb766171"><p class="cl-fb763e8e"><span class="cl-fb72bb42">150 (79.4)</span></p></td><td class="cl-fb766171"><p class="cl-fb763e8e"><span class="cl-fb72bb42">33 (17.5)</span></p></td><td class="cl-fb76617a"><p class="cl-fb763e8e"><span class="cl-fb72bb42">6 (3.2)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-fb766171"><p class="cl-fb763e8e"><span class="cl-fb72bb42">Year</span></p></td><td class="cl-fb766172"><p class="cl-fb763e8e"><span class="cl-fb72bb42">2015</span></p></td><td class="cl-fb766171"><p class="cl-fb763e8e"><span class="cl-fb72bb42">78 (51)</span></p></td><td class="cl-fb766171"><p class="cl-fb763e8e"><span class="cl-fb72bb42">56 (36.6)</span></p></td><td class="cl-fb76617a"><p class="cl-fb763e8e"><span class="cl-fb72bb42">19 (12.4)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-fb766171"><p class="cl-fb763e8e"><span class="cl-fb72bb42"></span></p></td><td class="cl-fb766172"><p class="cl-fb763e8e"><span class="cl-fb72bb42">2016</span></p></td><td class="cl-fb766171"><p class="cl-fb763e8e"><span class="cl-fb72bb42">84 (60.4)</span></p></td><td class="cl-fb766171"><p class="cl-fb763e8e"><span class="cl-fb72bb42">47 (33.8)</span></p></td><td class="cl-fb76617a"><p class="cl-fb763e8e"><span class="cl-fb72bb42">8 (5.8)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-fb766171"><p class="cl-fb763e8e"><span class="cl-fb72bb42"></span></p></td><td class="cl-fb766172"><p class="cl-fb763e8e"><span class="cl-fb72bb42">2017</span></p></td><td class="cl-fb766171"><p class="cl-fb763e8e"><span class="cl-fb72bb42">75 (54.7)</span></p></td><td class="cl-fb766171"><p class="cl-fb763e8e"><span class="cl-fb72bb42">52 (38)</span></p></td><td class="cl-fb76617a"><p class="cl-fb763e8e"><span class="cl-fb72bb42">10 (7.3)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-fb766171"><p class="cl-fb763e8e"><span class="cl-fb72bb42"></span></p></td><td class="cl-fb766172"><p class="cl-fb763e8e"><span class="cl-fb72bb42">2018</span></p></td><td class="cl-fb766171"><p class="cl-fb763e8e"><span class="cl-fb72bb42">81 (53.6)</span></p></td><td class="cl-fb766171"><p class="cl-fb763e8e"><span class="cl-fb72bb42">52 (34.4)</span></p></td><td class="cl-fb76617a"><p class="cl-fb763e8e"><span class="cl-fb72bb42">18 (11.9)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-fb766171"><p class="cl-fb763e8e"><span class="cl-fb72bb42"></span></p></td><td class="cl-fb766172"><p class="cl-fb763e8e"><span class="cl-fb72bb42">2019</span></p></td><td class="cl-fb766171"><p class="cl-fb763e8e"><span class="cl-fb72bb42">83 (51.6)</span></p></td><td class="cl-fb766171"><p class="cl-fb763e8e"><span class="cl-fb72bb42">60 (37.3)</span></p></td><td class="cl-fb76617a"><p class="cl-fb763e8e"><span class="cl-fb72bb42">18 (11.2)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-fb766171"><p class="cl-fb763e8e"><span class="cl-fb72bb42"></span></p></td><td class="cl-fb766172"><p class="cl-fb763e8e"><span class="cl-fb72bb42">2020</span></p></td><td class="cl-fb766171"><p class="cl-fb763e8e"><span class="cl-fb72bb42">82 (59.9)</span></p></td><td class="cl-fb766171"><p class="cl-fb763e8e"><span class="cl-fb72bb42">44 (32.1)</span></p></td><td class="cl-fb76617a"><p class="cl-fb763e8e"><span class="cl-fb72bb42">11 (8)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-fb766171"><p class="cl-fb763e8e"><span class="cl-fb72bb42"></span></p></td><td class="cl-fb766172"><p class="cl-fb763e8e"><span class="cl-fb72bb42">2021</span></p></td><td class="cl-fb766171"><p class="cl-fb763e8e"><span class="cl-fb72bb42">223 (84.8)</span></p></td><td class="cl-fb766171"><p class="cl-fb763e8e"><span class="cl-fb72bb42">34 (12.9)</span></p></td><td class="cl-fb76617a"><p class="cl-fb763e8e"><span class="cl-fb72bb42">6 (2.3)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-fb766171"><p class="cl-fb763e8e"><span class="cl-fb72bb42"></span></p></td><td class="cl-fb766172"><p class="cl-fb763e8e"><span class="cl-fb72bb42">2022</span></p></td><td class="cl-fb766171"><p class="cl-fb763e8e"><span class="cl-fb72bb42">88 (73.3)</span></p></td><td class="cl-fb766171"><p class="cl-fb763e8e"><span class="cl-fb72bb42">25 (20.8)</span></p></td><td class="cl-fb76617a"><p class="cl-fb763e8e"><span class="cl-fb72bb42">7 (5.8)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-fb766171"><p class="cl-fb763e8e"><span class="cl-fb72bb42"></span></p></td><td class="cl-fb766172"><p class="cl-fb763e8e"><span class="cl-fb72bb42">2023</span></p></td><td class="cl-fb766171"><p class="cl-fb763e8e"><span class="cl-fb72bb42">87 (51.2)</span></p></td><td class="cl-fb766171"><p class="cl-fb763e8e"><span class="cl-fb72bb42">63 (37.1)</span></p></td><td class="cl-fb76617a"><p class="cl-fb763e8e"><span class="cl-fb72bb42">20 (11.8)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-fb766171"><p class="cl-fb763e8e"><span class="cl-fb72bb42"></span></p></td><td class="cl-fb766172"><p class="cl-fb763e8e"><span class="cl-fb72bb42">2024</span></p></td><td class="cl-fb766171"><p class="cl-fb763e8e"><span class="cl-fb72bb42">74 (60.7)</span></p></td><td class="cl-fb766171"><p class="cl-fb763e8e"><span class="cl-fb72bb42">39 (32)</span></p></td><td class="cl-fb76617a"><p class="cl-fb763e8e"><span class="cl-fb72bb42">9 (7.4)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-fb766171"><p class="cl-fb763e8e"><span class="cl-fb72bb42">Quarter</span></p></td><td class="cl-fb766172"><p class="cl-fb763e8e"><span class="cl-fb72bb42">1</span></p></td><td class="cl-fb766171"><p class="cl-fb763e8e"><span class="cl-fb72bb42">253 (62.8)</span></p></td><td class="cl-fb766171"><p class="cl-fb763e8e"><span class="cl-fb72bb42">120 (29.8)</span></p></td><td class="cl-fb76617a"><p class="cl-fb763e8e"><span class="cl-fb72bb42">30 (7.4)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-fb766171"><p class="cl-fb763e8e"><span class="cl-fb72bb42"></span></p></td><td class="cl-fb766172"><p class="cl-fb763e8e"><span class="cl-fb72bb42">2</span></p></td><td class="cl-fb766171"><p class="cl-fb763e8e"><span class="cl-fb72bb42">220 (58.5)</span></p></td><td class="cl-fb766171"><p class="cl-fb763e8e"><span class="cl-fb72bb42">117 (31.1)</span></p></td><td class="cl-fb76617a"><p class="cl-fb763e8e"><span class="cl-fb72bb42">39 (10.4)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-fb766171"><p class="cl-fb763e8e"><span class="cl-fb72bb42"></span></p></td><td class="cl-fb766172"><p class="cl-fb763e8e"><span class="cl-fb72bb42">3</span></p></td><td class="cl-fb766171"><p class="cl-fb763e8e"><span class="cl-fb72bb42">295 (63.2)</span></p></td><td class="cl-fb766171"><p class="cl-fb763e8e"><span class="cl-fb72bb42">139 (29.8)</span></p></td><td class="cl-fb76617a"><p class="cl-fb763e8e"><span class="cl-fb72bb42">33 (7.1)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-fb766171"><p class="cl-fb763e8e"><span class="cl-fb72bb42"></span></p></td><td class="cl-fb766172"><p class="cl-fb763e8e"><span class="cl-fb72bb42">4</span></p></td><td class="cl-fb766171"><p class="cl-fb763e8e"><span class="cl-fb72bb42">187 (60.9)</span></p></td><td class="cl-fb766171"><p class="cl-fb763e8e"><span class="cl-fb72bb42">96 (31.3)</span></p></td><td class="cl-fb76617a"><p class="cl-fb763e8e"><span class="cl-fb72bb42">24 (7.8)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-fb766171"><p class="cl-fb763e8e"><span class="cl-fb72bb42">Weekday</span></p></td><td class="cl-fb766172"><p class="cl-fb763e8e"><span class="cl-fb72bb42">Friday</span></p></td><td class="cl-fb766171"><p class="cl-fb763e8e"><span class="cl-fb72bb42">141 (78.3)</span></p></td><td class="cl-fb766171"><p class="cl-fb763e8e"><span class="cl-fb72bb42">31 (17.2)</span></p></td><td class="cl-fb76617a"><p class="cl-fb763e8e"><span class="cl-fb72bb42">8 (4.4)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-fb766171"><p class="cl-fb763e8e"><span class="cl-fb72bb42"></span></p></td><td class="cl-fb766172"><p class="cl-fb763e8e"><span class="cl-fb72bb42">Monday</span></p></td><td class="cl-fb766171"><p class="cl-fb763e8e"><span class="cl-fb72bb42">114 (64.4)</span></p></td><td class="cl-fb766171"><p class="cl-fb763e8e"><span class="cl-fb72bb42">49 (27.7)</span></p></td><td class="cl-fb76617a"><p class="cl-fb763e8e"><span class="cl-fb72bb42">14 (7.9)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-fb766171"><p class="cl-fb763e8e"><span class="cl-fb72bb42"></span></p></td><td class="cl-fb766172"><p class="cl-fb763e8e"><span class="cl-fb72bb42">Saturday</span></p></td><td class="cl-fb766171"><p class="cl-fb763e8e"><span class="cl-fb72bb42">160 (63.2)</span></p></td><td class="cl-fb766171"><p class="cl-fb763e8e"><span class="cl-fb72bb42">81 (32)</span></p></td><td class="cl-fb76617a"><p class="cl-fb763e8e"><span class="cl-fb72bb42">12 (4.7)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-fb766171"><p class="cl-fb763e8e"><span class="cl-fb72bb42"></span></p></td><td class="cl-fb766172"><p class="cl-fb763e8e"><span class="cl-fb72bb42">Sunday</span></p></td><td class="cl-fb766171"><p class="cl-fb763e8e"><span class="cl-fb72bb42">156 (56.3)</span></p></td><td class="cl-fb766171"><p class="cl-fb763e8e"><span class="cl-fb72bb42">100 (36.1)</span></p></td><td class="cl-fb76617a"><p class="cl-fb763e8e"><span class="cl-fb72bb42">21 (7.6)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-fb766171"><p class="cl-fb763e8e"><span class="cl-fb72bb42"></span></p></td><td class="cl-fb766172"><p class="cl-fb763e8e"><span class="cl-fb72bb42">Thursday</span></p></td><td class="cl-fb766171"><p class="cl-fb763e8e"><span class="cl-fb72bb42">167 (66)</span></p></td><td class="cl-fb766171"><p class="cl-fb763e8e"><span class="cl-fb72bb42">66 (26.1)</span></p></td><td class="cl-fb76617a"><p class="cl-fb763e8e"><span class="cl-fb72bb42">20 (7.9)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-fb766171"><p class="cl-fb763e8e"><span class="cl-fb72bb42"></span></p></td><td class="cl-fb766172"><p class="cl-fb763e8e"><span class="cl-fb72bb42">Tuesday</span></p></td><td class="cl-fb766171"><p class="cl-fb763e8e"><span class="cl-fb72bb42">108 (65.5)</span></p></td><td class="cl-fb766171"><p class="cl-fb763e8e"><span class="cl-fb72bb42">43 (26.1)</span></p></td><td class="cl-fb76617a"><p class="cl-fb763e8e"><span class="cl-fb72bb42">14 (8.5)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-fb76617b"><p class="cl-fb763e8e"><span class="cl-fb72bb42"></span></p></td><td class="cl-fb76617c"><p class="cl-fb763e8e"><span class="cl-fb72bb42">Wednesday</span></p></td><td class="cl-fb76617b"><p class="cl-fb763e8e"><span class="cl-fb72bb42">109 (44)</span></p></td><td class="cl-fb76617b"><p class="cl-fb763e8e"><span class="cl-fb72bb42">102 (41.1)</span></p></td><td class="cl-fb76617d"><p class="cl-fb763e8e"><span class="cl-fb72bb42">37 (14.9)</span></p></td></tr></tbody></table></div>
</div>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co"># --- Clean up environment ---</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(tab_year, tab_quarter, tab_weekday, tab_combined, totals, create_tab, ft_vacc_summary)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="table-with-title-and-footer" class="level2" data-number="1.2">
<h2 data-number="1.2" class="anchored" data-anchor-id="table-with-title-and-footer"><span class="header-section-number">1.2</span> <strong>2 Table With Title and Footer</strong></h2>
<p>This extends the previous section by including a clear <strong>table caption</strong> and an explanatory <strong>footnote</strong>.</p>
<p>üßæ <em>Why this is important</em>:</p>
<ul>
<li><p>Captions add context‚Äîespecially in reports.</p></li>
<li><p>Footnotes help clarify how metrics are calculated (e.g., row percentages).</p></li>
</ul>
<p>üìò <em>Best used when</em>: Preparing for publication, stakeholder presentations, or final reports.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ------------2. Table with Title and Footer -------------------------------------------</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a><span class="co">#.......................Ensure grouping variables are characters............................</span></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>vacc_1524 <span class="ot">&lt;-</span> vacc_1524 <span class="sc">%&gt;%</span></span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">c</span>(vacc_service_year, vacc_quarter, vacc_weekday), as.character))</span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a><span class="co"># ---------------- Table generation function ....................</span></span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a>create_tab <span class="ot">&lt;-</span> <span class="cf">function</span>(data, var, label) {</span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a>  data <span class="sc">%&gt;%</span></span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>({{ var }})) <span class="sc">%&gt;%</span></span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tabyl</span>({{ var }}, vacc_group3) <span class="sc">%&gt;%</span></span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">Category =</span> label, <span class="at">.before =</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rename</span>(<span class="at">Label =</span> {{ var }}) <span class="sc">%&gt;%</span></span>
<span id="cb15-14"><a href="#cb15-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">Label =</span> <span class="fu">as.character</span>(Label))</span>
<span id="cb15-15"><a href="#cb15-15" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb15-16"><a href="#cb15-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-17"><a href="#cb15-17" aria-hidden="true" tabindex="-1"></a><span class="co"># .................... Create summary tables ....................</span></span>
<span id="cb15-18"><a href="#cb15-18" aria-hidden="true" tabindex="-1"></a>tab_age <span class="ot">&lt;-</span> <span class="fu">create_tab</span>(vacc_1524, age_group, <span class="st">"Age"</span>)</span>
<span id="cb15-19"><a href="#cb15-19" aria-hidden="true" tabindex="-1"></a>tab_sex <span class="ot">&lt;-</span> <span class="fu">create_tab</span>(vacc_1524, gender, <span class="st">"Gender"</span>)</span>
<span id="cb15-20"><a href="#cb15-20" aria-hidden="true" tabindex="-1"></a>tab_marital_status <span class="ot">&lt;-</span> <span class="fu">create_tab</span>(vacc_1524, marital_status, <span class="st">"Marital status"</span>)</span>
<span id="cb15-21"><a href="#cb15-21" aria-hidden="true" tabindex="-1"></a>tab_year    <span class="ot">&lt;-</span> <span class="fu">create_tab</span>(vacc_1524, vacc_service_year, <span class="st">"Year"</span>)</span>
<span id="cb15-22"><a href="#cb15-22" aria-hidden="true" tabindex="-1"></a>tab_quarter <span class="ot">&lt;-</span> <span class="fu">create_tab</span>(vacc_1524, vacc_quarter, <span class="st">"Quarter"</span>)</span>
<span id="cb15-23"><a href="#cb15-23" aria-hidden="true" tabindex="-1"></a>tab_weekday <span class="ot">&lt;-</span> <span class="fu">create_tab</span>(vacc_1524, vacc_weekday, <span class="st">"Weekday"</span>)</span>
<span id="cb15-24"><a href="#cb15-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-25"><a href="#cb15-25" aria-hidden="true" tabindex="-1"></a><span class="co"># ......................Combine all tabs ....................</span></span>
<span id="cb15-26"><a href="#cb15-26" aria-hidden="true" tabindex="-1"></a>tab_combined <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(tab_sex, tab_age, tab_marital_status, tab_year, tab_quarter, tab_weekday)</span>
<span id="cb15-27"><a href="#cb15-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-28"><a href="#cb15-28" aria-hidden="true" tabindex="-1"></a><span class="co"># ....................... Create row % and format as text ....................</span></span>
<span id="cb15-29"><a href="#cb15-29" aria-hidden="true" tabindex="-1"></a>tab_combined <span class="ot">&lt;-</span> tab_combined <span class="sc">%&gt;%</span></span>
<span id="cb15-30"><a href="#cb15-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rowwise</span>() <span class="sc">%&gt;%</span></span>
<span id="cb15-31"><a href="#cb15-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb15-32"><a href="#cb15-32" aria-hidden="true" tabindex="-1"></a>    <span class="at">Total =</span> <span class="fu">sum</span>(<span class="st">`</span><span class="at">Respiratory vaccines</span><span class="st">`</span>, <span class="st">`</span><span class="at">Childhood vaccines</span><span class="st">`</span>, Other, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb15-33"><a href="#cb15-33" aria-hidden="true" tabindex="-1"></a>    <span class="at">Respiratory =</span> <span class="fu">paste0</span>(<span class="fu">comma</span>(<span class="st">`</span><span class="at">Respiratory vaccines</span><span class="st">`</span>), <span class="st">" ("</span>, <span class="fu">round</span>(<span class="dv">100</span> <span class="sc">*</span> <span class="st">`</span><span class="at">Respiratory vaccines</span><span class="st">`</span> <span class="sc">/</span> Total, <span class="dv">1</span>), <span class="st">")"</span>),</span>
<span id="cb15-34"><a href="#cb15-34" aria-hidden="true" tabindex="-1"></a>    <span class="at">Childhood   =</span> <span class="fu">paste0</span>(<span class="fu">comma</span>(<span class="st">`</span><span class="at">Childhood vaccines</span><span class="st">`</span>), <span class="st">" ("</span>, <span class="fu">round</span>(<span class="dv">100</span> <span class="sc">*</span> <span class="st">`</span><span class="at">Childhood vaccines</span><span class="st">`</span> <span class="sc">/</span> Total, <span class="dv">1</span>), <span class="st">")"</span>),</span>
<span id="cb15-35"><a href="#cb15-35" aria-hidden="true" tabindex="-1"></a>    <span class="at">Other_grp   =</span> <span class="fu">paste0</span>(<span class="fu">comma</span>(Other), <span class="st">" ("</span>, <span class="fu">round</span>(<span class="dv">100</span> <span class="sc">*</span> Other <span class="sc">/</span> Total, <span class="dv">1</span>), <span class="st">")"</span>)</span>
<span id="cb15-36"><a href="#cb15-36" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb15-37"><a href="#cb15-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb15-38"><a href="#cb15-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-39"><a href="#cb15-39" aria-hidden="true" tabindex="-1"></a><span class="co"># ............................. Remove repeated variable names ....................</span></span>
<span id="cb15-40"><a href="#cb15-40" aria-hidden="true" tabindex="-1"></a>tab_combined <span class="ot">&lt;-</span> tab_combined <span class="sc">%&gt;%</span></span>
<span id="cb15-41"><a href="#cb15-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Category) <span class="sc">%&gt;%</span></span>
<span id="cb15-42"><a href="#cb15-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Category =</span> <span class="fu">ifelse</span>(<span class="fu">row_number</span>() <span class="sc">==</span> <span class="dv">1</span>, Category, <span class="st">""</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb15-43"><a href="#cb15-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb15-44"><a href="#cb15-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-45"><a href="#cb15-45" aria-hidden="true" tabindex="-1"></a><span class="co"># ........................... Get total counts per vaccine group ....................</span></span>
<span id="cb15-46"><a href="#cb15-46" aria-hidden="true" tabindex="-1"></a>totals <span class="ot">&lt;-</span> vacc_1524 <span class="sc">%&gt;%</span></span>
<span id="cb15-47"><a href="#cb15-47" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(vacc_group3) <span class="sc">%&gt;%</span></span>
<span id="cb15-48"><a href="#cb15-48" aria-hidden="true" tabindex="-1"></a>  <span class="fu">deframe</span>()</span>
<span id="cb15-49"><a href="#cb15-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-50"><a href="#cb15-50" aria-hidden="true" tabindex="-1"></a><span class="co"># .................... Create flextable ....................</span></span>
<span id="cb15-51"><a href="#cb15-51" aria-hidden="true" tabindex="-1"></a>ft_vacc_summary <span class="ot">&lt;-</span> tab_combined <span class="sc">%&gt;%</span></span>
<span id="cb15-52"><a href="#cb15-52" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Category, Label, Respiratory, Childhood, Other_grp) <span class="sc">%&gt;%</span></span>
<span id="cb15-53"><a href="#cb15-53" aria-hidden="true" tabindex="-1"></a>  <span class="fu">flextable</span>() <span class="sc">%&gt;%</span></span>
<span id="cb15-54"><a href="#cb15-54" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_header_labels</span>(</span>
<span id="cb15-55"><a href="#cb15-55" aria-hidden="true" tabindex="-1"></a>    <span class="at">Category =</span> <span class="st">"Variable type"</span>,</span>
<span id="cb15-56"><a href="#cb15-56" aria-hidden="true" tabindex="-1"></a>    <span class="at">Label =</span> <span class="st">"Values"</span>,</span>
<span id="cb15-57"><a href="#cb15-57" aria-hidden="true" tabindex="-1"></a>    <span class="at">Respiratory =</span> <span class="st">"Number (%)·µÉ"</span>,</span>
<span id="cb15-58"><a href="#cb15-58" aria-hidden="true" tabindex="-1"></a>    <span class="at">Childhood =</span> <span class="st">"Number (%)·µÉ"</span>,</span>
<span id="cb15-59"><a href="#cb15-59" aria-hidden="true" tabindex="-1"></a>    <span class="at">Other_grp =</span> <span class="st">"Number (%)·µÉ"</span></span>
<span id="cb15-60"><a href="#cb15-60" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb15-61"><a href="#cb15-61" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_header_row</span>( <span class="co"># Second row</span></span>
<span id="cb15-62"><a href="#cb15-62" aria-hidden="true" tabindex="-1"></a>    <span class="at">values =</span> <span class="fu">c</span>(</span>
<span id="cb15-63"><a href="#cb15-63" aria-hidden="true" tabindex="-1"></a>      <span class="st">""</span>, <span class="st">""</span>,</span>
<span id="cb15-64"><a href="#cb15-64" aria-hidden="true" tabindex="-1"></a>      <span class="fu">paste0</span>(<span class="st">"Respiratory vaccines (N = "</span>, <span class="fu">format</span>(totals[<span class="st">"Respiratory vaccines"</span>], <span class="at">big.mark =</span> <span class="st">","</span>), <span class="st">")"</span>),</span>
<span id="cb15-65"><a href="#cb15-65" aria-hidden="true" tabindex="-1"></a>      <span class="fu">paste0</span>(<span class="st">"Childhood vaccines (N = "</span>, <span class="fu">format</span>(totals[<span class="st">"Childhood vaccines"</span>], <span class="at">big.mark =</span> <span class="st">","</span>), <span class="st">")"</span>),</span>
<span id="cb15-66"><a href="#cb15-66" aria-hidden="true" tabindex="-1"></a>      <span class="fu">paste0</span>(<span class="st">"Other (N = "</span>, <span class="fu">format</span>(totals[<span class="st">"Other"</span>], <span class="at">big.mark =</span> <span class="st">","</span>), <span class="st">")"</span>)</span>
<span id="cb15-67"><a href="#cb15-67" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb15-68"><a href="#cb15-68" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb15-69"><a href="#cb15-69" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_header_row</span>( <span class="co"># First row (merged header)</span></span>
<span id="cb15-70"><a href="#cb15-70" aria-hidden="true" tabindex="-1"></a>    <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"Description"</span>, <span class="st">"Vaccination uptake"</span>),</span>
<span id="cb15-71"><a href="#cb15-71" aria-hidden="true" tabindex="-1"></a>    <span class="at">colwidths =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">3</span>)</span>
<span id="cb15-72"><a href="#cb15-72" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb15-73"><a href="#cb15-73" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_box</span>() <span class="sc">%&gt;%</span></span>
<span id="cb15-74"><a href="#cb15-74" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_table_properties</span>(<span class="at">layout =</span> <span class="st">"autofit"</span>, <span class="at">width =</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb15-75"><a href="#cb15-75" aria-hidden="true" tabindex="-1"></a>  <span class="fu">width</span>(<span class="at">j =</span> <span class="dv">1</span>, <span class="at">width =</span> <span class="fl">1.5</span>) <span class="sc">%&gt;%</span></span>
<span id="cb15-76"><a href="#cb15-76" aria-hidden="true" tabindex="-1"></a>  <span class="fu">width</span>(<span class="at">j =</span> <span class="dv">2</span>, <span class="at">width =</span> <span class="fl">2.5</span>) <span class="sc">%&gt;%</span></span>
<span id="cb15-77"><a href="#cb15-77" aria-hidden="true" tabindex="-1"></a>  <span class="fu">width</span>(<span class="at">j =</span> <span class="dv">3</span><span class="sc">:</span><span class="dv">4</span>, <span class="at">width =</span> <span class="fl">1.5</span>) <span class="sc">%&gt;%</span></span>
<span id="cb15-78"><a href="#cb15-78" aria-hidden="true" tabindex="-1"></a>  <span class="fu">align</span>(<span class="at">align =</span> <span class="st">"justify"</span>, <span class="at">part =</span> <span class="st">"all"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb15-79"><a href="#cb15-79" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb15-80"><a href="#cb15-80" aria-hidden="true" tabindex="-1"></a>  <span class="fu">border_remove</span>() <span class="sc">%&gt;%</span></span>
<span id="cb15-81"><a href="#cb15-81" aria-hidden="true" tabindex="-1"></a>  <span class="fu">border</span>(<span class="at">part =</span> <span class="st">"header"</span>, <span class="at">i =</span> <span class="dv">1</span>, <span class="at">border.top =</span> <span class="fu">fp_border</span>(<span class="at">color =</span> <span class="st">"black"</span>, <span class="at">width =</span> <span class="dv">1</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb15-82"><a href="#cb15-82" aria-hidden="true" tabindex="-1"></a>  <span class="fu">border</span>(<span class="at">part =</span> <span class="st">"header"</span>, <span class="at">i =</span> <span class="dv">3</span>, <span class="at">border.bottom =</span> <span class="fu">fp_border</span>(<span class="at">color =</span> <span class="st">"black"</span>, <span class="at">width =</span> <span class="dv">1</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb15-83"><a href="#cb15-83" aria-hidden="true" tabindex="-1"></a>  <span class="fu">border_inner_h</span>(<span class="at">part =</span> <span class="st">"header"</span>, <span class="at">border =</span> <span class="fu">fp_border</span>(<span class="at">color =</span> <span class="st">"black"</span>, <span class="at">width =</span> <span class="fl">0.8</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb15-84"><a href="#cb15-84" aria-hidden="true" tabindex="-1"></a>  <span class="fu">border_inner_h</span>(<span class="at">part =</span> <span class="st">"body"</span>, <span class="at">border =</span> <span class="fu">fp_border</span>(<span class="at">color =</span> <span class="st">"black"</span>, <span class="at">width =</span> <span class="fl">0.8</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb15-85"><a href="#cb15-85" aria-hidden="true" tabindex="-1"></a>  <span class="fu">border</span>(<span class="at">part =</span> <span class="st">"body"</span>, <span class="at">i =</span> <span class="fu">nrow</span>(tab_combined), <span class="at">border.bottom =</span> <span class="fu">fp_border</span>(<span class="at">color =</span> <span class="st">"black"</span>, <span class="at">width =</span> <span class="dv">1</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb15-86"><a href="#cb15-86" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb15-87"><a href="#cb15-87" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_caption</span>(<span class="st">"Table: Vaccination uptake across service year, quarter, and weekday"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb15-88"><a href="#cb15-88" aria-hidden="true" tabindex="-1"></a>  <span class="fu">footnote</span>(<span class="at">i =</span> <span class="dv">1</span>, </span>
<span id="cb15-89"><a href="#cb15-89" aria-hidden="true" tabindex="-1"></a>           <span class="at">value =</span> <span class="fu">as_paragraph</span>(<span class="st">" Vaccination proportions were calculated row-wise (i.e., by row)."</span>),</span>
<span id="cb15-90"><a href="#cb15-90" aria-hidden="true" tabindex="-1"></a>           <span class="at">ref_symbols =</span> <span class="st">"·µÉ"</span>, <span class="at">part =</span> <span class="st">"header"</span>) </span>
<span id="cb15-91"><a href="#cb15-91" aria-hidden="true" tabindex="-1"></a><span class="co"># %&gt;%</span></span>
<span id="cb15-92"><a href="#cb15-92" aria-hidden="true" tabindex="-1"></a><span class="co">#   border_inner_h(border = fp_border(color = "black", width = 1))  %&gt;%</span></span>
<span id="cb15-93"><a href="#cb15-93" aria-hidden="true" tabindex="-1"></a><span class="co">#   add_header_lines(values = "Table xx: Vaccination uptake across service year, quarter, and weekday.") %&gt;%</span></span>
<span id="cb15-94"><a href="#cb15-94" aria-hidden="true" tabindex="-1"></a><span class="co">#   add_footer_lines(values = c(</span></span>
<span id="cb15-95"><a href="#cb15-95" aria-hidden="true" tabindex="-1"></a><span class="co">#     "·µÉ Vaccination proportions were calculated per row (row percentage).",</span></span>
<span id="cb15-96"><a href="#cb15-96" aria-hidden="true" tabindex="-1"></a><span class="co">#     paste0("·µá The vaccine provider type did not include unvaccinated (N = ", format(no_total, big.mark = ","), ")."),</span></span>
<span id="cb15-97"><a href="#cb15-97" aria-hidden="true" tabindex="-1"></a><span class="co">#     "·∂ú Vaccination proportions were calculated row-wise (i.e., by row).",</span></span>
<span id="cb15-98"><a href="#cb15-98" aria-hidden="true" tabindex="-1"></a><span class="co">#     "GP = General practitioner, PHU = Public Health Unit"</span></span>
<span id="cb15-99"><a href="#cb15-99" aria-hidden="true" tabindex="-1"></a><span class="co">#   ))</span></span>
<span id="cb15-100"><a href="#cb15-100" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-101"><a href="#cb15-101" aria-hidden="true" tabindex="-1"></a><span class="co"># Display the table</span></span>
<span id="cb15-102"><a href="#cb15-102" aria-hidden="true" tabindex="-1"></a>ft_vacc_summary</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="tabwid"><style>.cl-fbc23b4a{table-layout:auto;width:100%;}.cl-fbb9877a{font-family:'Arial';font-size:11pt;font-weight:bold;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-fbb98784{font-family:'Arial';font-size:6.6pt;font-weight:bold;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;position: relative;bottom:3.3pt;}.cl-fbb9878e{font-family:'Arial';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-fbb9878f{font-family:'Arial';font-size:6.6pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;position: relative;bottom:3.3pt;}.cl-fbbce758{margin:0;text-align:justify;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-fbbce76c{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-fbbd0c9c{background-color:transparent;vertical-align: middle;border-bottom: 0.8pt solid rgba(0, 0, 0, 1.00);border-top: 1pt solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-fbbd0c9d{background-color:transparent;vertical-align: middle;border-bottom: 0.8pt solid rgba(0, 0, 0, 1.00);border-top: 1pt solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-fbbd0ca6{background-color:transparent;vertical-align: middle;border-bottom: 0.8pt solid rgba(0, 0, 0, 1.00);border-top: 1pt solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-fbbd0ca7{background-color:transparent;vertical-align: middle;border-bottom: 0.8pt solid rgba(0, 0, 0, 1.00);border-top: 0.8pt solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-fbbd0ca8{background-color:transparent;vertical-align: middle;border-bottom: 0.8pt solid rgba(0, 0, 0, 1.00);border-top: 0.8pt solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-fbbd0cb0{background-color:transparent;vertical-align: middle;border-bottom: 0.8pt solid rgba(0, 0, 0, 1.00);border-top: 0.8pt solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-fbbd0cb1{background-color:transparent;vertical-align: middle;border-bottom: 1pt solid rgba(0, 0, 0, 1.00);border-top: 0.8pt solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-fbbd0cba{background-color:transparent;vertical-align: middle;border-bottom: 1pt solid rgba(0, 0, 0, 1.00);border-top: 0.8pt solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-fbbd0cbb{background-color:transparent;vertical-align: middle;border-bottom: 1pt solid rgba(0, 0, 0, 1.00);border-top: 0.8pt solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-fbbd0cbc{background-color:transparent;vertical-align: middle;border-bottom: 0.8pt solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-fbbd0cc4{background-color:transparent;vertical-align: middle;border-bottom: 0.8pt solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-fbbd0cc5{background-color:transparent;vertical-align: middle;border-bottom: 0.8pt solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-fbbd0cc6{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(255, 255, 255, 0.00);border-top: 0 solid rgba(255, 255, 255, 0.00);border-left: 0 solid rgba(255, 255, 255, 0.00);border-right: 0 solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-fbbd0cce{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(255, 255, 255, 0.00);border-top: 0 solid rgba(255, 255, 255, 0.00);border-left: 0 solid rgba(255, 255, 255, 0.00);border-right: 0 solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-fbbd0ccf{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(255, 255, 255, 0.00);border-top: 0 solid rgba(255, 255, 255, 0.00);border-left: 0 solid rgba(255, 255, 255, 0.00);border-right: 0 solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table data-quarto-disable-processing="true" class="cl-fbc23b4a"><thead><tr style="overflow-wrap:break-word;"><th colspan="2" class="cl-fbbd0c9c"><p class="cl-fbbce758"><span class="cl-fbb9877a">Description</span><span class="cl-fbb98784">·µÉ</span></p></th><th colspan="3" class="cl-fbbd0c9c"><p class="cl-fbbce758"><span class="cl-fbb9877a">Vaccination uptake</span><span class="cl-fbb98784">·µÉ</span></p></th></tr><tr style="overflow-wrap:break-word;"><th class="cl-fbbd0ca7"><p class="cl-fbbce758"><span class="cl-fbb9877a"></span></p></th><th class="cl-fbbd0ca8"><p class="cl-fbbce758"><span class="cl-fbb9877a"></span></p></th><th class="cl-fbbd0ca7"><p class="cl-fbbce758"><span class="cl-fbb9877a">Respiratory vaccines (N = 955)</span></p></th><th class="cl-fbbd0ca7"><p class="cl-fbbce758"><span class="cl-fbb9877a">Childhood vaccines (N = 472)</span></p></th><th class="cl-fbbd0cb0"><p class="cl-fbbce758"><span class="cl-fbb9877a">Other (N = 126)</span></p></th></tr><tr style="overflow-wrap:break-word;"><th class="cl-fbbd0cb1"><p class="cl-fbbce758"><span class="cl-fbb9877a">Variable type</span></p></th><th class="cl-fbbd0cba"><p class="cl-fbbce758"><span class="cl-fbb9877a">Values</span></p></th><th class="cl-fbbd0cb1"><p class="cl-fbbce758"><span class="cl-fbb9877a">Number (%)·µÉ</span></p></th><th class="cl-fbbd0cb1"><p class="cl-fbbce758"><span class="cl-fbb9877a">Number (%)·µÉ</span></p></th><th class="cl-fbbd0cbb"><p class="cl-fbbce758"><span class="cl-fbb9877a">Number (%)·µÉ</span></p></th></tr></thead><tbody><tr style="overflow-wrap:break-word;"><td class="cl-fbbd0cbc"><p class="cl-fbbce758"><span class="cl-fbb9878e">Gender</span></p></td><td class="cl-fbbd0cc4"><p class="cl-fbbce758"><span class="cl-fbb9878e">Female</span></p></td><td class="cl-fbbd0cbc"><p class="cl-fbbce758"><span class="cl-fbb9878e">511 (64)</span></p></td><td class="cl-fbbd0cbc"><p class="cl-fbbce758"><span class="cl-fbb9878e">233 (29.2)</span></p></td><td class="cl-fbbd0cc5"><p class="cl-fbbce758"><span class="cl-fbb9878e">54 (6.8)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-fbbd0ca7"><p class="cl-fbbce758"><span class="cl-fbb9878e"></span></p></td><td class="cl-fbbd0ca8"><p class="cl-fbbce758"><span class="cl-fbb9878e">Male</span></p></td><td class="cl-fbbd0ca7"><p class="cl-fbbce758"><span class="cl-fbb9878e">444 (58.8)</span></p></td><td class="cl-fbbd0ca7"><p class="cl-fbbce758"><span class="cl-fbb9878e">239 (31.7)</span></p></td><td class="cl-fbbd0cb0"><p class="cl-fbbce758"><span class="cl-fbb9878e">72 (9.5)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-fbbd0ca7"><p class="cl-fbbce758"><span class="cl-fbb9878e">Age</span></p></td><td class="cl-fbbd0ca8"><p class="cl-fbbce758"><span class="cl-fbb9878e">0-19</span></p></td><td class="cl-fbbd0ca7"><p class="cl-fbbce758"><span class="cl-fbb9878e">250 (38.9)</span></p></td><td class="cl-fbbd0ca7"><p class="cl-fbbce758"><span class="cl-fbb9878e">302 (47)</span></p></td><td class="cl-fbbd0cb0"><p class="cl-fbbce758"><span class="cl-fbb9878e">90 (14)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-fbbd0ca7"><p class="cl-fbbce758"><span class="cl-fbb9878e"></span></p></td><td class="cl-fbbd0ca8"><p class="cl-fbbce758"><span class="cl-fbb9878e">20-29</span></p></td><td class="cl-fbbd0ca7"><p class="cl-fbbce758"><span class="cl-fbb9878e">150 (68.2)</span></p></td><td class="cl-fbbd0ca7"><p class="cl-fbbce758"><span class="cl-fbb9878e">70 (31.8)</span></p></td><td class="cl-fbbd0cb0"><p class="cl-fbbce758"><span class="cl-fbb9878e">0 (0)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-fbbd0ca7"><p class="cl-fbbce758"><span class="cl-fbb9878e"></span></p></td><td class="cl-fbbd0ca8"><p class="cl-fbbce758"><span class="cl-fbb9878e">30-39</span></p></td><td class="cl-fbbd0ca7"><p class="cl-fbbce758"><span class="cl-fbb9878e">47 (71.2)</span></p></td><td class="cl-fbbd0ca7"><p class="cl-fbbce758"><span class="cl-fbb9878e">19 (28.8)</span></p></td><td class="cl-fbbd0cb0"><p class="cl-fbbce758"><span class="cl-fbb9878e">0 (0)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-fbbd0ca7"><p class="cl-fbbce758"><span class="cl-fbb9878e"></span></p></td><td class="cl-fbbd0ca8"><p class="cl-fbbce758"><span class="cl-fbb9878e">40-49</span></p></td><td class="cl-fbbd0ca7"><p class="cl-fbbce758"><span class="cl-fbb9878e">142 (75.9)</span></p></td><td class="cl-fbbd0ca7"><p class="cl-fbbce758"><span class="cl-fbb9878e">45 (24.1)</span></p></td><td class="cl-fbbd0cb0"><p class="cl-fbbce758"><span class="cl-fbb9878e">0 (0)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-fbbd0ca7"><p class="cl-fbbce758"><span class="cl-fbb9878e"></span></p></td><td class="cl-fbbd0ca8"><p class="cl-fbbce758"><span class="cl-fbb9878e">50-59</span></p></td><td class="cl-fbbd0ca7"><p class="cl-fbbce758"><span class="cl-fbb9878e">112 (77.8)</span></p></td><td class="cl-fbbd0ca7"><p class="cl-fbbce758"><span class="cl-fbb9878e">14 (9.7)</span></p></td><td class="cl-fbbd0cb0"><p class="cl-fbbce758"><span class="cl-fbb9878e">18 (12.5)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-fbbd0ca7"><p class="cl-fbbce758"><span class="cl-fbb9878e"></span></p></td><td class="cl-fbbd0ca8"><p class="cl-fbbce758"><span class="cl-fbb9878e">60-69</span></p></td><td class="cl-fbbd0ca7"><p class="cl-fbbce758"><span class="cl-fbb9878e">149 (87.6)</span></p></td><td class="cl-fbbd0ca7"><p class="cl-fbbce758"><span class="cl-fbb9878e">13 (7.6)</span></p></td><td class="cl-fbbd0cb0"><p class="cl-fbbce758"><span class="cl-fbb9878e">8 (4.7)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-fbbd0ca7"><p class="cl-fbbce758"><span class="cl-fbb9878e"></span></p></td><td class="cl-fbbd0ca8"><p class="cl-fbbce758"><span class="cl-fbb9878e">70+</span></p></td><td class="cl-fbbd0ca7"><p class="cl-fbbce758"><span class="cl-fbb9878e">105 (84.7)</span></p></td><td class="cl-fbbd0ca7"><p class="cl-fbbce758"><span class="cl-fbb9878e">9 (7.3)</span></p></td><td class="cl-fbbd0cb0"><p class="cl-fbbce758"><span class="cl-fbb9878e">10 (8.1)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-fbbd0ca7"><p class="cl-fbbce758"><span class="cl-fbb9878e">Marital status</span></p></td><td class="cl-fbbd0ca8"><p class="cl-fbbce758"><span class="cl-fbb9878e">Divorced</span></p></td><td class="cl-fbbd0ca7"><p class="cl-fbbce758"><span class="cl-fbb9878e">136 (83.4)</span></p></td><td class="cl-fbbd0ca7"><p class="cl-fbbce758"><span class="cl-fbb9878e">15 (9.2)</span></p></td><td class="cl-fbbd0cb0"><p class="cl-fbbce758"><span class="cl-fbb9878e">12 (7.4)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-fbbd0ca7"><p class="cl-fbbce758"><span class="cl-fbb9878e"></span></p></td><td class="cl-fbbd0ca8"><p class="cl-fbbce758"><span class="cl-fbb9878e">Married</span></p></td><td class="cl-fbbd0ca7"><p class="cl-fbbce758"><span class="cl-fbb9878e">289 (79)</span></p></td><td class="cl-fbbd0ca7"><p class="cl-fbbce758"><span class="cl-fbb9878e">59 (16.1)</span></p></td><td class="cl-fbbd0cb0"><p class="cl-fbbce758"><span class="cl-fbb9878e">18 (4.9)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-fbbd0ca7"><p class="cl-fbbce758"><span class="cl-fbb9878e"></span></p></td><td class="cl-fbbd0ca8"><p class="cl-fbbce758"><span class="cl-fbb9878e">Single/widowed</span></p></td><td class="cl-fbbd0ca7"><p class="cl-fbbce758"><span class="cl-fbb9878e">150 (79.4)</span></p></td><td class="cl-fbbd0ca7"><p class="cl-fbbce758"><span class="cl-fbb9878e">33 (17.5)</span></p></td><td class="cl-fbbd0cb0"><p class="cl-fbbce758"><span class="cl-fbb9878e">6 (3.2)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-fbbd0ca7"><p class="cl-fbbce758"><span class="cl-fbb9878e">Year</span></p></td><td class="cl-fbbd0ca8"><p class="cl-fbbce758"><span class="cl-fbb9878e">2015</span></p></td><td class="cl-fbbd0ca7"><p class="cl-fbbce758"><span class="cl-fbb9878e">78 (51)</span></p></td><td class="cl-fbbd0ca7"><p class="cl-fbbce758"><span class="cl-fbb9878e">56 (36.6)</span></p></td><td class="cl-fbbd0cb0"><p class="cl-fbbce758"><span class="cl-fbb9878e">19 (12.4)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-fbbd0ca7"><p class="cl-fbbce758"><span class="cl-fbb9878e"></span></p></td><td class="cl-fbbd0ca8"><p class="cl-fbbce758"><span class="cl-fbb9878e">2016</span></p></td><td class="cl-fbbd0ca7"><p class="cl-fbbce758"><span class="cl-fbb9878e">84 (60.4)</span></p></td><td class="cl-fbbd0ca7"><p class="cl-fbbce758"><span class="cl-fbb9878e">47 (33.8)</span></p></td><td class="cl-fbbd0cb0"><p class="cl-fbbce758"><span class="cl-fbb9878e">8 (5.8)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-fbbd0ca7"><p class="cl-fbbce758"><span class="cl-fbb9878e"></span></p></td><td class="cl-fbbd0ca8"><p class="cl-fbbce758"><span class="cl-fbb9878e">2017</span></p></td><td class="cl-fbbd0ca7"><p class="cl-fbbce758"><span class="cl-fbb9878e">75 (54.7)</span></p></td><td class="cl-fbbd0ca7"><p class="cl-fbbce758"><span class="cl-fbb9878e">52 (38)</span></p></td><td class="cl-fbbd0cb0"><p class="cl-fbbce758"><span class="cl-fbb9878e">10 (7.3)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-fbbd0ca7"><p class="cl-fbbce758"><span class="cl-fbb9878e"></span></p></td><td class="cl-fbbd0ca8"><p class="cl-fbbce758"><span class="cl-fbb9878e">2018</span></p></td><td class="cl-fbbd0ca7"><p class="cl-fbbce758"><span class="cl-fbb9878e">81 (53.6)</span></p></td><td class="cl-fbbd0ca7"><p class="cl-fbbce758"><span class="cl-fbb9878e">52 (34.4)</span></p></td><td class="cl-fbbd0cb0"><p class="cl-fbbce758"><span class="cl-fbb9878e">18 (11.9)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-fbbd0ca7"><p class="cl-fbbce758"><span class="cl-fbb9878e"></span></p></td><td class="cl-fbbd0ca8"><p class="cl-fbbce758"><span class="cl-fbb9878e">2019</span></p></td><td class="cl-fbbd0ca7"><p class="cl-fbbce758"><span class="cl-fbb9878e">83 (51.6)</span></p></td><td class="cl-fbbd0ca7"><p class="cl-fbbce758"><span class="cl-fbb9878e">60 (37.3)</span></p></td><td class="cl-fbbd0cb0"><p class="cl-fbbce758"><span class="cl-fbb9878e">18 (11.2)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-fbbd0ca7"><p class="cl-fbbce758"><span class="cl-fbb9878e"></span></p></td><td class="cl-fbbd0ca8"><p class="cl-fbbce758"><span class="cl-fbb9878e">2020</span></p></td><td class="cl-fbbd0ca7"><p class="cl-fbbce758"><span class="cl-fbb9878e">82 (59.9)</span></p></td><td class="cl-fbbd0ca7"><p class="cl-fbbce758"><span class="cl-fbb9878e">44 (32.1)</span></p></td><td class="cl-fbbd0cb0"><p class="cl-fbbce758"><span class="cl-fbb9878e">11 (8)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-fbbd0ca7"><p class="cl-fbbce758"><span class="cl-fbb9878e"></span></p></td><td class="cl-fbbd0ca8"><p class="cl-fbbce758"><span class="cl-fbb9878e">2021</span></p></td><td class="cl-fbbd0ca7"><p class="cl-fbbce758"><span class="cl-fbb9878e">223 (84.8)</span></p></td><td class="cl-fbbd0ca7"><p class="cl-fbbce758"><span class="cl-fbb9878e">34 (12.9)</span></p></td><td class="cl-fbbd0cb0"><p class="cl-fbbce758"><span class="cl-fbb9878e">6 (2.3)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-fbbd0ca7"><p class="cl-fbbce758"><span class="cl-fbb9878e"></span></p></td><td class="cl-fbbd0ca8"><p class="cl-fbbce758"><span class="cl-fbb9878e">2022</span></p></td><td class="cl-fbbd0ca7"><p class="cl-fbbce758"><span class="cl-fbb9878e">88 (73.3)</span></p></td><td class="cl-fbbd0ca7"><p class="cl-fbbce758"><span class="cl-fbb9878e">25 (20.8)</span></p></td><td class="cl-fbbd0cb0"><p class="cl-fbbce758"><span class="cl-fbb9878e">7 (5.8)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-fbbd0ca7"><p class="cl-fbbce758"><span class="cl-fbb9878e"></span></p></td><td class="cl-fbbd0ca8"><p class="cl-fbbce758"><span class="cl-fbb9878e">2023</span></p></td><td class="cl-fbbd0ca7"><p class="cl-fbbce758"><span class="cl-fbb9878e">87 (51.2)</span></p></td><td class="cl-fbbd0ca7"><p class="cl-fbbce758"><span class="cl-fbb9878e">63 (37.1)</span></p></td><td class="cl-fbbd0cb0"><p class="cl-fbbce758"><span class="cl-fbb9878e">20 (11.8)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-fbbd0ca7"><p class="cl-fbbce758"><span class="cl-fbb9878e"></span></p></td><td class="cl-fbbd0ca8"><p class="cl-fbbce758"><span class="cl-fbb9878e">2024</span></p></td><td class="cl-fbbd0ca7"><p class="cl-fbbce758"><span class="cl-fbb9878e">74 (60.7)</span></p></td><td class="cl-fbbd0ca7"><p class="cl-fbbce758"><span class="cl-fbb9878e">39 (32)</span></p></td><td class="cl-fbbd0cb0"><p class="cl-fbbce758"><span class="cl-fbb9878e">9 (7.4)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-fbbd0ca7"><p class="cl-fbbce758"><span class="cl-fbb9878e">Quarter</span></p></td><td class="cl-fbbd0ca8"><p class="cl-fbbce758"><span class="cl-fbb9878e">1</span></p></td><td class="cl-fbbd0ca7"><p class="cl-fbbce758"><span class="cl-fbb9878e">253 (62.8)</span></p></td><td class="cl-fbbd0ca7"><p class="cl-fbbce758"><span class="cl-fbb9878e">120 (29.8)</span></p></td><td class="cl-fbbd0cb0"><p class="cl-fbbce758"><span class="cl-fbb9878e">30 (7.4)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-fbbd0ca7"><p class="cl-fbbce758"><span class="cl-fbb9878e"></span></p></td><td class="cl-fbbd0ca8"><p class="cl-fbbce758"><span class="cl-fbb9878e">2</span></p></td><td class="cl-fbbd0ca7"><p class="cl-fbbce758"><span class="cl-fbb9878e">220 (58.5)</span></p></td><td class="cl-fbbd0ca7"><p class="cl-fbbce758"><span class="cl-fbb9878e">117 (31.1)</span></p></td><td class="cl-fbbd0cb0"><p class="cl-fbbce758"><span class="cl-fbb9878e">39 (10.4)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-fbbd0ca7"><p class="cl-fbbce758"><span class="cl-fbb9878e"></span></p></td><td class="cl-fbbd0ca8"><p class="cl-fbbce758"><span class="cl-fbb9878e">3</span></p></td><td class="cl-fbbd0ca7"><p class="cl-fbbce758"><span class="cl-fbb9878e">295 (63.2)</span></p></td><td class="cl-fbbd0ca7"><p class="cl-fbbce758"><span class="cl-fbb9878e">139 (29.8)</span></p></td><td class="cl-fbbd0cb0"><p class="cl-fbbce758"><span class="cl-fbb9878e">33 (7.1)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-fbbd0ca7"><p class="cl-fbbce758"><span class="cl-fbb9878e"></span></p></td><td class="cl-fbbd0ca8"><p class="cl-fbbce758"><span class="cl-fbb9878e">4</span></p></td><td class="cl-fbbd0ca7"><p class="cl-fbbce758"><span class="cl-fbb9878e">187 (60.9)</span></p></td><td class="cl-fbbd0ca7"><p class="cl-fbbce758"><span class="cl-fbb9878e">96 (31.3)</span></p></td><td class="cl-fbbd0cb0"><p class="cl-fbbce758"><span class="cl-fbb9878e">24 (7.8)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-fbbd0ca7"><p class="cl-fbbce758"><span class="cl-fbb9878e">Weekday</span></p></td><td class="cl-fbbd0ca8"><p class="cl-fbbce758"><span class="cl-fbb9878e">Friday</span></p></td><td class="cl-fbbd0ca7"><p class="cl-fbbce758"><span class="cl-fbb9878e">141 (78.3)</span></p></td><td class="cl-fbbd0ca7"><p class="cl-fbbce758"><span class="cl-fbb9878e">31 (17.2)</span></p></td><td class="cl-fbbd0cb0"><p class="cl-fbbce758"><span class="cl-fbb9878e">8 (4.4)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-fbbd0ca7"><p class="cl-fbbce758"><span class="cl-fbb9878e"></span></p></td><td class="cl-fbbd0ca8"><p class="cl-fbbce758"><span class="cl-fbb9878e">Monday</span></p></td><td class="cl-fbbd0ca7"><p class="cl-fbbce758"><span class="cl-fbb9878e">114 (64.4)</span></p></td><td class="cl-fbbd0ca7"><p class="cl-fbbce758"><span class="cl-fbb9878e">49 (27.7)</span></p></td><td class="cl-fbbd0cb0"><p class="cl-fbbce758"><span class="cl-fbb9878e">14 (7.9)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-fbbd0ca7"><p class="cl-fbbce758"><span class="cl-fbb9878e"></span></p></td><td class="cl-fbbd0ca8"><p class="cl-fbbce758"><span class="cl-fbb9878e">Saturday</span></p></td><td class="cl-fbbd0ca7"><p class="cl-fbbce758"><span class="cl-fbb9878e">160 (63.2)</span></p></td><td class="cl-fbbd0ca7"><p class="cl-fbbce758"><span class="cl-fbb9878e">81 (32)</span></p></td><td class="cl-fbbd0cb0"><p class="cl-fbbce758"><span class="cl-fbb9878e">12 (4.7)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-fbbd0ca7"><p class="cl-fbbce758"><span class="cl-fbb9878e"></span></p></td><td class="cl-fbbd0ca8"><p class="cl-fbbce758"><span class="cl-fbb9878e">Sunday</span></p></td><td class="cl-fbbd0ca7"><p class="cl-fbbce758"><span class="cl-fbb9878e">156 (56.3)</span></p></td><td class="cl-fbbd0ca7"><p class="cl-fbbce758"><span class="cl-fbb9878e">100 (36.1)</span></p></td><td class="cl-fbbd0cb0"><p class="cl-fbbce758"><span class="cl-fbb9878e">21 (7.6)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-fbbd0ca7"><p class="cl-fbbce758"><span class="cl-fbb9878e"></span></p></td><td class="cl-fbbd0ca8"><p class="cl-fbbce758"><span class="cl-fbb9878e">Thursday</span></p></td><td class="cl-fbbd0ca7"><p class="cl-fbbce758"><span class="cl-fbb9878e">167 (66)</span></p></td><td class="cl-fbbd0ca7"><p class="cl-fbbce758"><span class="cl-fbb9878e">66 (26.1)</span></p></td><td class="cl-fbbd0cb0"><p class="cl-fbbce758"><span class="cl-fbb9878e">20 (7.9)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-fbbd0ca7"><p class="cl-fbbce758"><span class="cl-fbb9878e"></span></p></td><td class="cl-fbbd0ca8"><p class="cl-fbbce758"><span class="cl-fbb9878e">Tuesday</span></p></td><td class="cl-fbbd0ca7"><p class="cl-fbbce758"><span class="cl-fbb9878e">108 (65.5)</span></p></td><td class="cl-fbbd0ca7"><p class="cl-fbbce758"><span class="cl-fbb9878e">43 (26.1)</span></p></td><td class="cl-fbbd0cb0"><p class="cl-fbbce758"><span class="cl-fbb9878e">14 (8.5)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-fbbd0cb1"><p class="cl-fbbce758"><span class="cl-fbb9878e"></span></p></td><td class="cl-fbbd0cba"><p class="cl-fbbce758"><span class="cl-fbb9878e">Wednesday</span></p></td><td class="cl-fbbd0cb1"><p class="cl-fbbce758"><span class="cl-fbb9878e">109 (44)</span></p></td><td class="cl-fbbd0cb1"><p class="cl-fbbce758"><span class="cl-fbb9878e">102 (41.1)</span></p></td><td class="cl-fbbd0cbb"><p class="cl-fbbce758"><span class="cl-fbb9878e">37 (14.9)</span></p></td></tr></tbody><tfoot><tr style="overflow-wrap:break-word;"><td colspan="5" class="cl-fbbd0cc6"><p class="cl-fbbce76c"><span class="cl-fbb9878f">·µÉ</span><span class="cl-fbb9878e"> Vaccination proportions were calculated row-wise (i.e., by row).</span></p></td></tr></tfoot></table></div>
</div>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co"># .................... Clean up environment ....................</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(tab_year, tab_quarter, tab_weekday, tab_combined, ft_vacc_summary, totals, create_tab)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="missing-values-with-n" class="level2" data-number="1.3">
<h2 data-number="1.3" class="anchored" data-anchor-id="missing-values-with-n"><span class="header-section-number">1.3</span> <strong>3. Missing Values with n(%)</strong></h2>
<p>In this version, we <strong>include ‚ÄúMissing‚Äù as a separate category</strong> and provide <strong>both counts and percentages</strong>.</p>
<p>üß† <em>Why this matters</em>: Ignoring missing values can skew analysis. This format transparently highlights data completeness.</p>
<p>üëç <em>Recommended for</em>: Health datasets, surveys, or administrative data where data quality assessment is key.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ------------3. Missing values with n(%)-------------------------------------------</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a><span class="co"># .................. Convert grouping vars to character ..................</span></span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>vacc_1524 <span class="ot">&lt;-</span> vacc_1524 <span class="sc">%&gt;%</span></span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">c</span>(age_group, gender, marital_status,</span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a>                  vacc_service_year, vacc_quarter, vacc_weekday), as.character))</span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a><span class="co"># .................. Table generation function with Missing ..................</span></span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a>create_tab <span class="ot">&lt;-</span> <span class="cf">function</span>(data, var, label) {</span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a>  tab_main <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span></span>
<span id="cb17-12"><a href="#cb17-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>({{ var }})) <span class="sc">%&gt;%</span></span>
<span id="cb17-13"><a href="#cb17-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tabyl</span>({{ var }}, vacc_group3) <span class="sc">%&gt;%</span></span>
<span id="cb17-14"><a href="#cb17-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">Category =</span> label, <span class="at">.before =</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb17-15"><a href="#cb17-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rename</span>(<span class="at">Label =</span> {{ var }}) <span class="sc">%&gt;%</span></span>
<span id="cb17-16"><a href="#cb17-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">Label =</span> <span class="fu">as.character</span>(Label))</span>
<span id="cb17-17"><a href="#cb17-17" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb17-18"><a href="#cb17-18" aria-hidden="true" tabindex="-1"></a>  na_count <span class="ot">&lt;-</span> <span class="fu">sum</span>(<span class="fu">is.na</span>(<span class="fu">pull</span>(data, {{ var }})))</span>
<span id="cb17-19"><a href="#cb17-19" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb17-20"><a href="#cb17-20" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (na_count <span class="sc">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb17-21"><a href="#cb17-21" aria-hidden="true" tabindex="-1"></a>    missing_row <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb17-22"><a href="#cb17-22" aria-hidden="true" tabindex="-1"></a>      <span class="at">Category =</span> label,</span>
<span id="cb17-23"><a href="#cb17-23" aria-hidden="true" tabindex="-1"></a>      <span class="at">Label =</span> <span class="st">"Missing"</span>,</span>
<span id="cb17-24"><a href="#cb17-24" aria-hidden="true" tabindex="-1"></a>      <span class="st">`</span><span class="at">Respiratory vaccines</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">sum</span>(data<span class="sc">$</span>vacc_group3 <span class="sc">==</span> <span class="st">"Respiratory vaccines"</span> <span class="sc">&amp;</span> <span class="fu">is.na</span>(<span class="fu">pull</span>(data, {{ var }})), <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb17-25"><a href="#cb17-25" aria-hidden="true" tabindex="-1"></a>      <span class="st">`</span><span class="at">Childhood vaccines</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">sum</span>(data<span class="sc">$</span>vacc_group3 <span class="sc">==</span> <span class="st">"Childhood vaccines"</span> <span class="sc">&amp;</span> <span class="fu">is.na</span>(<span class="fu">pull</span>(data, {{ var }})), <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb17-26"><a href="#cb17-26" aria-hidden="true" tabindex="-1"></a>      <span class="at">Other =</span> <span class="fu">sum</span>(data<span class="sc">$</span>vacc_group3 <span class="sc">==</span> <span class="st">"Other"</span> <span class="sc">&amp;</span> <span class="fu">is.na</span>(<span class="fu">pull</span>(data, {{ var }})), <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb17-27"><a href="#cb17-27" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb17-28"><a href="#cb17-28" aria-hidden="true" tabindex="-1"></a>    tab_final <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(tab_main, missing_row)</span>
<span id="cb17-29"><a href="#cb17-29" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb17-30"><a href="#cb17-30" aria-hidden="true" tabindex="-1"></a>    tab_final <span class="ot">&lt;-</span> tab_main</span>
<span id="cb17-31"><a href="#cb17-31" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb17-32"><a href="#cb17-32" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb17-33"><a href="#cb17-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(tab_final)</span>
<span id="cb17-34"><a href="#cb17-34" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb17-35"><a href="#cb17-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-36"><a href="#cb17-36" aria-hidden="true" tabindex="-1"></a><span class="co"># .................. Create summary tables ..................</span></span>
<span id="cb17-37"><a href="#cb17-37" aria-hidden="true" tabindex="-1"></a>tab_age            <span class="ot">&lt;-</span> <span class="fu">create_tab</span>(vacc_1524, age_group, <span class="st">"Age"</span>)</span>
<span id="cb17-38"><a href="#cb17-38" aria-hidden="true" tabindex="-1"></a>tab_sex            <span class="ot">&lt;-</span> <span class="fu">create_tab</span>(vacc_1524, gender, <span class="st">"Gender"</span>)</span>
<span id="cb17-39"><a href="#cb17-39" aria-hidden="true" tabindex="-1"></a>tab_marital_status <span class="ot">&lt;-</span> <span class="fu">create_tab</span>(vacc_1524, marital_status, <span class="st">"Marital status"</span>)</span>
<span id="cb17-40"><a href="#cb17-40" aria-hidden="true" tabindex="-1"></a>tab_year           <span class="ot">&lt;-</span> <span class="fu">create_tab</span>(vacc_1524, vacc_service_year, <span class="st">"Year"</span>)</span>
<span id="cb17-41"><a href="#cb17-41" aria-hidden="true" tabindex="-1"></a>tab_quarter        <span class="ot">&lt;-</span> <span class="fu">create_tab</span>(vacc_1524, vacc_quarter, <span class="st">"Quarter"</span>)</span>
<span id="cb17-42"><a href="#cb17-42" aria-hidden="true" tabindex="-1"></a>tab_weekday        <span class="ot">&lt;-</span> <span class="fu">create_tab</span>(vacc_1524, vacc_weekday, <span class="st">"Weekday"</span>)</span>
<span id="cb17-43"><a href="#cb17-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-44"><a href="#cb17-44" aria-hidden="true" tabindex="-1"></a><span class="co"># .................. Combine all tables ..................</span></span>
<span id="cb17-45"><a href="#cb17-45" aria-hidden="true" tabindex="-1"></a>tab_combined <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(tab_sex, tab_age, tab_marital_status, tab_year, tab_quarter, tab_weekday)</span>
<span id="cb17-46"><a href="#cb17-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-47"><a href="#cb17-47" aria-hidden="true" tabindex="-1"></a><span class="co"># .................. Calculate row-wise percentages ..................</span></span>
<span id="cb17-48"><a href="#cb17-48" aria-hidden="true" tabindex="-1"></a>tab_combined <span class="ot">&lt;-</span> tab_combined <span class="sc">%&gt;%</span></span>
<span id="cb17-49"><a href="#cb17-49" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rowwise</span>() <span class="sc">%&gt;%</span></span>
<span id="cb17-50"><a href="#cb17-50" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb17-51"><a href="#cb17-51" aria-hidden="true" tabindex="-1"></a>    <span class="at">Total =</span> <span class="fu">sum</span>(<span class="st">`</span><span class="at">Respiratory vaccines</span><span class="st">`</span>, <span class="st">`</span><span class="at">Childhood vaccines</span><span class="st">`</span>, Other, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb17-52"><a href="#cb17-52" aria-hidden="true" tabindex="-1"></a>    <span class="at">Respiratory =</span> <span class="fu">paste0</span>(<span class="fu">comma</span>(<span class="st">`</span><span class="at">Respiratory vaccines</span><span class="st">`</span>), <span class="st">" ("</span>, <span class="fu">round</span>(<span class="dv">100</span> <span class="sc">*</span> <span class="st">`</span><span class="at">Respiratory vaccines</span><span class="st">`</span> <span class="sc">/</span> Total, <span class="dv">1</span>), <span class="st">")"</span>),</span>
<span id="cb17-53"><a href="#cb17-53" aria-hidden="true" tabindex="-1"></a>    <span class="at">Childhood   =</span> <span class="fu">paste0</span>(<span class="fu">comma</span>(<span class="st">`</span><span class="at">Childhood vaccines</span><span class="st">`</span>), <span class="st">" ("</span>, <span class="fu">round</span>(<span class="dv">100</span> <span class="sc">*</span> <span class="st">`</span><span class="at">Childhood vaccines</span><span class="st">`</span> <span class="sc">/</span> Total, <span class="dv">1</span>), <span class="st">")"</span>),</span>
<span id="cb17-54"><a href="#cb17-54" aria-hidden="true" tabindex="-1"></a>    <span class="at">Other_grp   =</span> <span class="fu">paste0</span>(<span class="fu">comma</span>(Other), <span class="st">" ("</span>, <span class="fu">round</span>(<span class="dv">100</span> <span class="sc">*</span> Other <span class="sc">/</span> Total, <span class="dv">1</span>), <span class="st">")"</span>)</span>
<span id="cb17-55"><a href="#cb17-55" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb17-56"><a href="#cb17-56" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb17-57"><a href="#cb17-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-58"><a href="#cb17-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-59"><a href="#cb17-59" aria-hidden="true" tabindex="-1"></a><span class="co"># .................. Show Category only once per group ..................</span></span>
<span id="cb17-60"><a href="#cb17-60" aria-hidden="true" tabindex="-1"></a>tab_combined <span class="ot">&lt;-</span> tab_combined <span class="sc">%&gt;%</span></span>
<span id="cb17-61"><a href="#cb17-61" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Category) <span class="sc">%&gt;%</span></span>
<span id="cb17-62"><a href="#cb17-62" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Category =</span> <span class="fu">ifelse</span>(<span class="fu">row_number</span>() <span class="sc">==</span> <span class="dv">1</span>, Category, <span class="st">""</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb17-63"><a href="#cb17-63" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb17-64"><a href="#cb17-64" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-65"><a href="#cb17-65" aria-hidden="true" tabindex="-1"></a><span class="co"># .................. Get total counts per vaccine group ..................</span></span>
<span id="cb17-66"><a href="#cb17-66" aria-hidden="true" tabindex="-1"></a>totals <span class="ot">&lt;-</span> vacc_1524 <span class="sc">%&gt;%</span></span>
<span id="cb17-67"><a href="#cb17-67" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(vacc_group3) <span class="sc">%&gt;%</span></span>
<span id="cb17-68"><a href="#cb17-68" aria-hidden="true" tabindex="-1"></a>  <span class="fu">deframe</span>()</span>
<span id="cb17-69"><a href="#cb17-69" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-70"><a href="#cb17-70" aria-hidden="true" tabindex="-1"></a><span class="co"># .................. Create flextable ..................</span></span>
<span id="cb17-71"><a href="#cb17-71" aria-hidden="true" tabindex="-1"></a>ft_vacc_summary <span class="ot">&lt;-</span> tab_combined <span class="sc">%&gt;%</span></span>
<span id="cb17-72"><a href="#cb17-72" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Category, Label, Respiratory, Childhood, Other_grp) <span class="sc">%&gt;%</span></span>
<span id="cb17-73"><a href="#cb17-73" aria-hidden="true" tabindex="-1"></a>  <span class="fu">flextable</span>() <span class="sc">%&gt;%</span></span>
<span id="cb17-74"><a href="#cb17-74" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_header_labels</span>(</span>
<span id="cb17-75"><a href="#cb17-75" aria-hidden="true" tabindex="-1"></a>    <span class="at">Category =</span> <span class="st">"Variable type"</span>,</span>
<span id="cb17-76"><a href="#cb17-76" aria-hidden="true" tabindex="-1"></a>    <span class="at">Label =</span> <span class="st">"Values"</span>,</span>
<span id="cb17-77"><a href="#cb17-77" aria-hidden="true" tabindex="-1"></a>    <span class="at">Respiratory =</span> <span class="st">"Number (%)·µÉ"</span>,</span>
<span id="cb17-78"><a href="#cb17-78" aria-hidden="true" tabindex="-1"></a>    <span class="at">Childhood =</span> <span class="st">"Number (%)·µÉ"</span>,</span>
<span id="cb17-79"><a href="#cb17-79" aria-hidden="true" tabindex="-1"></a>    <span class="at">Other_grp =</span> <span class="st">"Number (%)·µÉ"</span></span>
<span id="cb17-80"><a href="#cb17-80" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb17-81"><a href="#cb17-81" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_header_row</span>(</span>
<span id="cb17-82"><a href="#cb17-82" aria-hidden="true" tabindex="-1"></a>    <span class="at">values =</span> <span class="fu">c</span>(</span>
<span id="cb17-83"><a href="#cb17-83" aria-hidden="true" tabindex="-1"></a>      <span class="st">""</span>, <span class="st">""</span>,</span>
<span id="cb17-84"><a href="#cb17-84" aria-hidden="true" tabindex="-1"></a>      <span class="fu">paste0</span>(<span class="st">"Respiratory vaccines (N = "</span>, <span class="fu">format</span>(totals[<span class="st">"Respiratory vaccines"</span>], <span class="at">big.mark =</span> <span class="st">","</span>), <span class="st">")"</span>),</span>
<span id="cb17-85"><a href="#cb17-85" aria-hidden="true" tabindex="-1"></a>      <span class="fu">paste0</span>(<span class="st">"Childhood vaccines (N = "</span>, <span class="fu">format</span>(totals[<span class="st">"Childhood vaccines"</span>], <span class="at">big.mark =</span> <span class="st">","</span>), <span class="st">")"</span>),</span>
<span id="cb17-86"><a href="#cb17-86" aria-hidden="true" tabindex="-1"></a>      <span class="fu">paste0</span>(<span class="st">"Other (N = "</span>, <span class="fu">format</span>(totals[<span class="st">"Other"</span>], <span class="at">big.mark =</span> <span class="st">","</span>), <span class="st">")"</span>)</span>
<span id="cb17-87"><a href="#cb17-87" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb17-88"><a href="#cb17-88" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb17-89"><a href="#cb17-89" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_header_row</span>(</span>
<span id="cb17-90"><a href="#cb17-90" aria-hidden="true" tabindex="-1"></a>    <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"Description"</span>, <span class="st">"Vaccination uptake"</span>),</span>
<span id="cb17-91"><a href="#cb17-91" aria-hidden="true" tabindex="-1"></a>    <span class="at">colwidths =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">3</span>)</span>
<span id="cb17-92"><a href="#cb17-92" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb17-93"><a href="#cb17-93" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_box</span>() <span class="sc">%&gt;%</span></span>
<span id="cb17-94"><a href="#cb17-94" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_table_properties</span>(<span class="at">layout =</span> <span class="st">"autofit"</span>, <span class="at">width =</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb17-95"><a href="#cb17-95" aria-hidden="true" tabindex="-1"></a>  <span class="fu">width</span>(<span class="at">j =</span> <span class="dv">1</span>, <span class="at">width =</span> <span class="fl">1.5</span>) <span class="sc">%&gt;%</span></span>
<span id="cb17-96"><a href="#cb17-96" aria-hidden="true" tabindex="-1"></a>  <span class="fu">width</span>(<span class="at">j =</span> <span class="dv">2</span>, <span class="at">width =</span> <span class="fl">2.5</span>) <span class="sc">%&gt;%</span></span>
<span id="cb17-97"><a href="#cb17-97" aria-hidden="true" tabindex="-1"></a>  <span class="fu">width</span>(<span class="at">j =</span> <span class="dv">3</span><span class="sc">:</span><span class="dv">5</span>, <span class="at">width =</span> <span class="fl">1.5</span>) <span class="sc">%&gt;%</span></span>
<span id="cb17-98"><a href="#cb17-98" aria-hidden="true" tabindex="-1"></a>  <span class="fu">align</span>(<span class="at">align =</span> <span class="st">"justify"</span>, <span class="at">part =</span> <span class="st">"all"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb17-99"><a href="#cb17-99" aria-hidden="true" tabindex="-1"></a>  <span class="fu">border_remove</span>() <span class="sc">%&gt;%</span></span>
<span id="cb17-100"><a href="#cb17-100" aria-hidden="true" tabindex="-1"></a>  <span class="fu">border</span>(<span class="at">part =</span> <span class="st">"header"</span>, <span class="at">i =</span> <span class="dv">1</span>, <span class="at">border.top =</span> <span class="fu">fp_border</span>(<span class="at">color =</span> <span class="st">"black"</span>, <span class="at">width =</span> <span class="dv">1</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb17-101"><a href="#cb17-101" aria-hidden="true" tabindex="-1"></a>  <span class="fu">border</span>(<span class="at">part =</span> <span class="st">"header"</span>, <span class="at">i =</span> <span class="dv">3</span>, <span class="at">border.bottom =</span> <span class="fu">fp_border</span>(<span class="at">color =</span> <span class="st">"black"</span>, <span class="at">width =</span> <span class="dv">1</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb17-102"><a href="#cb17-102" aria-hidden="true" tabindex="-1"></a>  <span class="fu">border_inner_h</span>(<span class="at">part =</span> <span class="st">"header"</span>, <span class="at">border =</span> <span class="fu">fp_border</span>(<span class="at">color =</span> <span class="st">"black"</span>, <span class="at">width =</span> <span class="fl">0.8</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb17-103"><a href="#cb17-103" aria-hidden="true" tabindex="-1"></a>  <span class="fu">border_inner_h</span>(<span class="at">part =</span> <span class="st">"body"</span>, <span class="at">border =</span> <span class="fu">fp_border</span>(<span class="at">color =</span> <span class="st">"black"</span>, <span class="at">width =</span> <span class="fl">0.8</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb17-104"><a href="#cb17-104" aria-hidden="true" tabindex="-1"></a>  <span class="fu">border</span>(<span class="at">part =</span> <span class="st">"body"</span>, <span class="at">i =</span> <span class="fu">nrow</span>(tab_combined), <span class="at">border.bottom =</span> <span class="fu">fp_border</span>(<span class="at">color =</span> <span class="st">"black"</span>, <span class="at">width =</span> <span class="dv">1</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb17-105"><a href="#cb17-105" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb17-106"><a href="#cb17-106" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_caption</span>(<span class="st">"Table: Vaccination uptake across service year, quarter, and weekday"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb17-107"><a href="#cb17-107" aria-hidden="true" tabindex="-1"></a>  <span class="fu">footnote</span>(<span class="at">i =</span> <span class="dv">1</span>, </span>
<span id="cb17-108"><a href="#cb17-108" aria-hidden="true" tabindex="-1"></a>           <span class="at">value =</span> <span class="fu">as_paragraph</span>(<span class="st">"Vaccination proportions were calculated row-wise (i.e., by row)."</span>),</span>
<span id="cb17-109"><a href="#cb17-109" aria-hidden="true" tabindex="-1"></a>           <span class="at">ref_symbols =</span> <span class="st">"·µÉ"</span>, </span>
<span id="cb17-110"><a href="#cb17-110" aria-hidden="true" tabindex="-1"></a>           <span class="at">part =</span> <span class="st">"header"</span>)</span>
<span id="cb17-111"><a href="#cb17-111" aria-hidden="true" tabindex="-1"></a><span class="co"># .................. Show the table ..................</span></span>
<span id="cb17-112"><a href="#cb17-112" aria-hidden="true" tabindex="-1"></a>ft_vacc_summary</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="tabwid"><style>.cl-fc11d7a4{table-layout:auto;width:100%;}.cl-fc09163c{font-family:'Arial';font-size:11pt;font-weight:bold;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-fc091646{font-family:'Arial';font-size:6.6pt;font-weight:bold;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;position: relative;bottom:3.3pt;}.cl-fc091647{font-family:'Arial';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-fc091648{font-family:'Arial';font-size:6.6pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;position: relative;bottom:3.3pt;}.cl-fc0c9690{margin:0;text-align:justify;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-fc0c969a{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-fc0cb986{background-color:transparent;vertical-align: middle;border-bottom: 0.8pt solid rgba(0, 0, 0, 1.00);border-top: 1pt solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-fc0cb990{background-color:transparent;vertical-align: middle;border-bottom: 0.8pt solid rgba(0, 0, 0, 1.00);border-top: 1pt solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-fc0cb991{background-color:transparent;vertical-align: middle;border-bottom: 0.8pt solid rgba(0, 0, 0, 1.00);border-top: 0.8pt solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-fc0cb99a{background-color:transparent;vertical-align: middle;border-bottom: 0.8pt solid rgba(0, 0, 0, 1.00);border-top: 0.8pt solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-fc0cb99b{background-color:transparent;vertical-align: middle;border-bottom: 1pt solid rgba(0, 0, 0, 1.00);border-top: 0.8pt solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-fc0cb99c{background-color:transparent;vertical-align: middle;border-bottom: 1pt solid rgba(0, 0, 0, 1.00);border-top: 0.8pt solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-fc0cb9a4{background-color:transparent;vertical-align: middle;border-bottom: 0.8pt solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-fc0cb9a5{background-color:transparent;vertical-align: middle;border-bottom: 0.8pt solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-fc0cb9a6{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(255, 255, 255, 0.00);border-top: 0 solid rgba(255, 255, 255, 0.00);border-left: 0 solid rgba(255, 255, 255, 0.00);border-right: 0 solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-fc0cb9ae{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(255, 255, 255, 0.00);border-top: 0 solid rgba(255, 255, 255, 0.00);border-left: 0 solid rgba(255, 255, 255, 0.00);border-right: 0 solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table data-quarto-disable-processing="true" class="cl-fc11d7a4"><thead><tr style="overflow-wrap:break-word;"><th colspan="2" class="cl-fc0cb986"><p class="cl-fc0c9690"><span class="cl-fc09163c">Description</span><span class="cl-fc091646">·µÉ</span></p></th><th colspan="3" class="cl-fc0cb986"><p class="cl-fc0c9690"><span class="cl-fc09163c">Vaccination uptake</span><span class="cl-fc091646">·µÉ</span></p></th></tr><tr style="overflow-wrap:break-word;"><th class="cl-fc0cb991"><p class="cl-fc0c9690"><span class="cl-fc09163c"></span></p></th><th class="cl-fc0cb99a"><p class="cl-fc0c9690"><span class="cl-fc09163c"></span></p></th><th class="cl-fc0cb991"><p class="cl-fc0c9690"><span class="cl-fc09163c">Respiratory vaccines (N = 955)</span></p></th><th class="cl-fc0cb991"><p class="cl-fc0c9690"><span class="cl-fc09163c">Childhood vaccines (N = 472)</span></p></th><th class="cl-fc0cb991"><p class="cl-fc0c9690"><span class="cl-fc09163c">Other (N = 126)</span></p></th></tr><tr style="overflow-wrap:break-word;"><th class="cl-fc0cb99b"><p class="cl-fc0c9690"><span class="cl-fc09163c">Variable type</span></p></th><th class="cl-fc0cb99c"><p class="cl-fc0c9690"><span class="cl-fc09163c">Values</span></p></th><th class="cl-fc0cb99b"><p class="cl-fc0c9690"><span class="cl-fc09163c">Number (%)·µÉ</span></p></th><th class="cl-fc0cb99b"><p class="cl-fc0c9690"><span class="cl-fc09163c">Number (%)·µÉ</span></p></th><th class="cl-fc0cb99b"><p class="cl-fc0c9690"><span class="cl-fc09163c">Number (%)·µÉ</span></p></th></tr></thead><tbody><tr style="overflow-wrap:break-word;"><td class="cl-fc0cb9a4"><p class="cl-fc0c9690"><span class="cl-fc091647">Gender</span></p></td><td class="cl-fc0cb9a5"><p class="cl-fc0c9690"><span class="cl-fc091647">Female</span></p></td><td class="cl-fc0cb9a4"><p class="cl-fc0c9690"><span class="cl-fc091647">511 (64)</span></p></td><td class="cl-fc0cb9a4"><p class="cl-fc0c9690"><span class="cl-fc091647">233 (29.2)</span></p></td><td class="cl-fc0cb9a4"><p class="cl-fc0c9690"><span class="cl-fc091647">54 (6.8)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-fc0cb991"><p class="cl-fc0c9690"><span class="cl-fc091647"></span></p></td><td class="cl-fc0cb99a"><p class="cl-fc0c9690"><span class="cl-fc091647">Male</span></p></td><td class="cl-fc0cb991"><p class="cl-fc0c9690"><span class="cl-fc091647">444 (58.8)</span></p></td><td class="cl-fc0cb991"><p class="cl-fc0c9690"><span class="cl-fc091647">239 (31.7)</span></p></td><td class="cl-fc0cb991"><p class="cl-fc0c9690"><span class="cl-fc091647">72 (9.5)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-fc0cb991"><p class="cl-fc0c9690"><span class="cl-fc091647">Age</span></p></td><td class="cl-fc0cb99a"><p class="cl-fc0c9690"><span class="cl-fc091647">0-19</span></p></td><td class="cl-fc0cb991"><p class="cl-fc0c9690"><span class="cl-fc091647">250 (38.9)</span></p></td><td class="cl-fc0cb991"><p class="cl-fc0c9690"><span class="cl-fc091647">302 (47)</span></p></td><td class="cl-fc0cb991"><p class="cl-fc0c9690"><span class="cl-fc091647">90 (14)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-fc0cb991"><p class="cl-fc0c9690"><span class="cl-fc091647"></span></p></td><td class="cl-fc0cb99a"><p class="cl-fc0c9690"><span class="cl-fc091647">20-29</span></p></td><td class="cl-fc0cb991"><p class="cl-fc0c9690"><span class="cl-fc091647">150 (68.2)</span></p></td><td class="cl-fc0cb991"><p class="cl-fc0c9690"><span class="cl-fc091647">70 (31.8)</span></p></td><td class="cl-fc0cb991"><p class="cl-fc0c9690"><span class="cl-fc091647">0 (0)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-fc0cb991"><p class="cl-fc0c9690"><span class="cl-fc091647"></span></p></td><td class="cl-fc0cb99a"><p class="cl-fc0c9690"><span class="cl-fc091647">30-39</span></p></td><td class="cl-fc0cb991"><p class="cl-fc0c9690"><span class="cl-fc091647">47 (71.2)</span></p></td><td class="cl-fc0cb991"><p class="cl-fc0c9690"><span class="cl-fc091647">19 (28.8)</span></p></td><td class="cl-fc0cb991"><p class="cl-fc0c9690"><span class="cl-fc091647">0 (0)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-fc0cb991"><p class="cl-fc0c9690"><span class="cl-fc091647"></span></p></td><td class="cl-fc0cb99a"><p class="cl-fc0c9690"><span class="cl-fc091647">40-49</span></p></td><td class="cl-fc0cb991"><p class="cl-fc0c9690"><span class="cl-fc091647">142 (75.9)</span></p></td><td class="cl-fc0cb991"><p class="cl-fc0c9690"><span class="cl-fc091647">45 (24.1)</span></p></td><td class="cl-fc0cb991"><p class="cl-fc0c9690"><span class="cl-fc091647">0 (0)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-fc0cb991"><p class="cl-fc0c9690"><span class="cl-fc091647"></span></p></td><td class="cl-fc0cb99a"><p class="cl-fc0c9690"><span class="cl-fc091647">50-59</span></p></td><td class="cl-fc0cb991"><p class="cl-fc0c9690"><span class="cl-fc091647">112 (77.8)</span></p></td><td class="cl-fc0cb991"><p class="cl-fc0c9690"><span class="cl-fc091647">14 (9.7)</span></p></td><td class="cl-fc0cb991"><p class="cl-fc0c9690"><span class="cl-fc091647">18 (12.5)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-fc0cb991"><p class="cl-fc0c9690"><span class="cl-fc091647"></span></p></td><td class="cl-fc0cb99a"><p class="cl-fc0c9690"><span class="cl-fc091647">60-69</span></p></td><td class="cl-fc0cb991"><p class="cl-fc0c9690"><span class="cl-fc091647">149 (87.6)</span></p></td><td class="cl-fc0cb991"><p class="cl-fc0c9690"><span class="cl-fc091647">13 (7.6)</span></p></td><td class="cl-fc0cb991"><p class="cl-fc0c9690"><span class="cl-fc091647">8 (4.7)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-fc0cb991"><p class="cl-fc0c9690"><span class="cl-fc091647"></span></p></td><td class="cl-fc0cb99a"><p class="cl-fc0c9690"><span class="cl-fc091647">70+</span></p></td><td class="cl-fc0cb991"><p class="cl-fc0c9690"><span class="cl-fc091647">105 (84.7)</span></p></td><td class="cl-fc0cb991"><p class="cl-fc0c9690"><span class="cl-fc091647">9 (7.3)</span></p></td><td class="cl-fc0cb991"><p class="cl-fc0c9690"><span class="cl-fc091647">10 (8.1)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-fc0cb991"><p class="cl-fc0c9690"><span class="cl-fc091647">Marital status</span></p></td><td class="cl-fc0cb99a"><p class="cl-fc0c9690"><span class="cl-fc091647">Divorced</span></p></td><td class="cl-fc0cb991"><p class="cl-fc0c9690"><span class="cl-fc091647">136 (83.4)</span></p></td><td class="cl-fc0cb991"><p class="cl-fc0c9690"><span class="cl-fc091647">15 (9.2)</span></p></td><td class="cl-fc0cb991"><p class="cl-fc0c9690"><span class="cl-fc091647">12 (7.4)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-fc0cb991"><p class="cl-fc0c9690"><span class="cl-fc091647"></span></p></td><td class="cl-fc0cb99a"><p class="cl-fc0c9690"><span class="cl-fc091647">Married</span></p></td><td class="cl-fc0cb991"><p class="cl-fc0c9690"><span class="cl-fc091647">289 (79)</span></p></td><td class="cl-fc0cb991"><p class="cl-fc0c9690"><span class="cl-fc091647">59 (16.1)</span></p></td><td class="cl-fc0cb991"><p class="cl-fc0c9690"><span class="cl-fc091647">18 (4.9)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-fc0cb991"><p class="cl-fc0c9690"><span class="cl-fc091647"></span></p></td><td class="cl-fc0cb99a"><p class="cl-fc0c9690"><span class="cl-fc091647">Single/widowed</span></p></td><td class="cl-fc0cb991"><p class="cl-fc0c9690"><span class="cl-fc091647">150 (79.4)</span></p></td><td class="cl-fc0cb991"><p class="cl-fc0c9690"><span class="cl-fc091647">33 (17.5)</span></p></td><td class="cl-fc0cb991"><p class="cl-fc0c9690"><span class="cl-fc091647">6 (3.2)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-fc0cb991"><p class="cl-fc0c9690"><span class="cl-fc091647"></span></p></td><td class="cl-fc0cb99a"><p class="cl-fc0c9690"><span class="cl-fc091647">Missing</span></p></td><td class="cl-fc0cb991"><p class="cl-fc0c9690"><span class="cl-fc091647">380 (45.5)</span></p></td><td class="cl-fc0cb991"><p class="cl-fc0c9690"><span class="cl-fc091647">365 (43.7)</span></p></td><td class="cl-fc0cb991"><p class="cl-fc0c9690"><span class="cl-fc091647">90 (10.8)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-fc0cb991"><p class="cl-fc0c9690"><span class="cl-fc091647">Year</span></p></td><td class="cl-fc0cb99a"><p class="cl-fc0c9690"><span class="cl-fc091647">2015</span></p></td><td class="cl-fc0cb991"><p class="cl-fc0c9690"><span class="cl-fc091647">78 (51)</span></p></td><td class="cl-fc0cb991"><p class="cl-fc0c9690"><span class="cl-fc091647">56 (36.6)</span></p></td><td class="cl-fc0cb991"><p class="cl-fc0c9690"><span class="cl-fc091647">19 (12.4)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-fc0cb991"><p class="cl-fc0c9690"><span class="cl-fc091647"></span></p></td><td class="cl-fc0cb99a"><p class="cl-fc0c9690"><span class="cl-fc091647">2016</span></p></td><td class="cl-fc0cb991"><p class="cl-fc0c9690"><span class="cl-fc091647">84 (60.4)</span></p></td><td class="cl-fc0cb991"><p class="cl-fc0c9690"><span class="cl-fc091647">47 (33.8)</span></p></td><td class="cl-fc0cb991"><p class="cl-fc0c9690"><span class="cl-fc091647">8 (5.8)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-fc0cb991"><p class="cl-fc0c9690"><span class="cl-fc091647"></span></p></td><td class="cl-fc0cb99a"><p class="cl-fc0c9690"><span class="cl-fc091647">2017</span></p></td><td class="cl-fc0cb991"><p class="cl-fc0c9690"><span class="cl-fc091647">75 (54.7)</span></p></td><td class="cl-fc0cb991"><p class="cl-fc0c9690"><span class="cl-fc091647">52 (38)</span></p></td><td class="cl-fc0cb991"><p class="cl-fc0c9690"><span class="cl-fc091647">10 (7.3)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-fc0cb991"><p class="cl-fc0c9690"><span class="cl-fc091647"></span></p></td><td class="cl-fc0cb99a"><p class="cl-fc0c9690"><span class="cl-fc091647">2018</span></p></td><td class="cl-fc0cb991"><p class="cl-fc0c9690"><span class="cl-fc091647">81 (53.6)</span></p></td><td class="cl-fc0cb991"><p class="cl-fc0c9690"><span class="cl-fc091647">52 (34.4)</span></p></td><td class="cl-fc0cb991"><p class="cl-fc0c9690"><span class="cl-fc091647">18 (11.9)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-fc0cb991"><p class="cl-fc0c9690"><span class="cl-fc091647"></span></p></td><td class="cl-fc0cb99a"><p class="cl-fc0c9690"><span class="cl-fc091647">2019</span></p></td><td class="cl-fc0cb991"><p class="cl-fc0c9690"><span class="cl-fc091647">83 (51.6)</span></p></td><td class="cl-fc0cb991"><p class="cl-fc0c9690"><span class="cl-fc091647">60 (37.3)</span></p></td><td class="cl-fc0cb991"><p class="cl-fc0c9690"><span class="cl-fc091647">18 (11.2)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-fc0cb991"><p class="cl-fc0c9690"><span class="cl-fc091647"></span></p></td><td class="cl-fc0cb99a"><p class="cl-fc0c9690"><span class="cl-fc091647">2020</span></p></td><td class="cl-fc0cb991"><p class="cl-fc0c9690"><span class="cl-fc091647">82 (59.9)</span></p></td><td class="cl-fc0cb991"><p class="cl-fc0c9690"><span class="cl-fc091647">44 (32.1)</span></p></td><td class="cl-fc0cb991"><p class="cl-fc0c9690"><span class="cl-fc091647">11 (8)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-fc0cb991"><p class="cl-fc0c9690"><span class="cl-fc091647"></span></p></td><td class="cl-fc0cb99a"><p class="cl-fc0c9690"><span class="cl-fc091647">2021</span></p></td><td class="cl-fc0cb991"><p class="cl-fc0c9690"><span class="cl-fc091647">223 (84.8)</span></p></td><td class="cl-fc0cb991"><p class="cl-fc0c9690"><span class="cl-fc091647">34 (12.9)</span></p></td><td class="cl-fc0cb991"><p class="cl-fc0c9690"><span class="cl-fc091647">6 (2.3)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-fc0cb991"><p class="cl-fc0c9690"><span class="cl-fc091647"></span></p></td><td class="cl-fc0cb99a"><p class="cl-fc0c9690"><span class="cl-fc091647">2022</span></p></td><td class="cl-fc0cb991"><p class="cl-fc0c9690"><span class="cl-fc091647">88 (73.3)</span></p></td><td class="cl-fc0cb991"><p class="cl-fc0c9690"><span class="cl-fc091647">25 (20.8)</span></p></td><td class="cl-fc0cb991"><p class="cl-fc0c9690"><span class="cl-fc091647">7 (5.8)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-fc0cb991"><p class="cl-fc0c9690"><span class="cl-fc091647"></span></p></td><td class="cl-fc0cb99a"><p class="cl-fc0c9690"><span class="cl-fc091647">2023</span></p></td><td class="cl-fc0cb991"><p class="cl-fc0c9690"><span class="cl-fc091647">87 (51.2)</span></p></td><td class="cl-fc0cb991"><p class="cl-fc0c9690"><span class="cl-fc091647">63 (37.1)</span></p></td><td class="cl-fc0cb991"><p class="cl-fc0c9690"><span class="cl-fc091647">20 (11.8)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-fc0cb991"><p class="cl-fc0c9690"><span class="cl-fc091647"></span></p></td><td class="cl-fc0cb99a"><p class="cl-fc0c9690"><span class="cl-fc091647">2024</span></p></td><td class="cl-fc0cb991"><p class="cl-fc0c9690"><span class="cl-fc091647">74 (60.7)</span></p></td><td class="cl-fc0cb991"><p class="cl-fc0c9690"><span class="cl-fc091647">39 (32)</span></p></td><td class="cl-fc0cb991"><p class="cl-fc0c9690"><span class="cl-fc091647">9 (7.4)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-fc0cb991"><p class="cl-fc0c9690"><span class="cl-fc091647">Quarter</span></p></td><td class="cl-fc0cb99a"><p class="cl-fc0c9690"><span class="cl-fc091647">1</span></p></td><td class="cl-fc0cb991"><p class="cl-fc0c9690"><span class="cl-fc091647">253 (62.8)</span></p></td><td class="cl-fc0cb991"><p class="cl-fc0c9690"><span class="cl-fc091647">120 (29.8)</span></p></td><td class="cl-fc0cb991"><p class="cl-fc0c9690"><span class="cl-fc091647">30 (7.4)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-fc0cb991"><p class="cl-fc0c9690"><span class="cl-fc091647"></span></p></td><td class="cl-fc0cb99a"><p class="cl-fc0c9690"><span class="cl-fc091647">2</span></p></td><td class="cl-fc0cb991"><p class="cl-fc0c9690"><span class="cl-fc091647">220 (58.5)</span></p></td><td class="cl-fc0cb991"><p class="cl-fc0c9690"><span class="cl-fc091647">117 (31.1)</span></p></td><td class="cl-fc0cb991"><p class="cl-fc0c9690"><span class="cl-fc091647">39 (10.4)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-fc0cb991"><p class="cl-fc0c9690"><span class="cl-fc091647"></span></p></td><td class="cl-fc0cb99a"><p class="cl-fc0c9690"><span class="cl-fc091647">3</span></p></td><td class="cl-fc0cb991"><p class="cl-fc0c9690"><span class="cl-fc091647">295 (63.2)</span></p></td><td class="cl-fc0cb991"><p class="cl-fc0c9690"><span class="cl-fc091647">139 (29.8)</span></p></td><td class="cl-fc0cb991"><p class="cl-fc0c9690"><span class="cl-fc091647">33 (7.1)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-fc0cb991"><p class="cl-fc0c9690"><span class="cl-fc091647"></span></p></td><td class="cl-fc0cb99a"><p class="cl-fc0c9690"><span class="cl-fc091647">4</span></p></td><td class="cl-fc0cb991"><p class="cl-fc0c9690"><span class="cl-fc091647">187 (60.9)</span></p></td><td class="cl-fc0cb991"><p class="cl-fc0c9690"><span class="cl-fc091647">96 (31.3)</span></p></td><td class="cl-fc0cb991"><p class="cl-fc0c9690"><span class="cl-fc091647">24 (7.8)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-fc0cb991"><p class="cl-fc0c9690"><span class="cl-fc091647">Weekday</span></p></td><td class="cl-fc0cb99a"><p class="cl-fc0c9690"><span class="cl-fc091647">Friday</span></p></td><td class="cl-fc0cb991"><p class="cl-fc0c9690"><span class="cl-fc091647">141 (78.3)</span></p></td><td class="cl-fc0cb991"><p class="cl-fc0c9690"><span class="cl-fc091647">31 (17.2)</span></p></td><td class="cl-fc0cb991"><p class="cl-fc0c9690"><span class="cl-fc091647">8 (4.4)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-fc0cb991"><p class="cl-fc0c9690"><span class="cl-fc091647"></span></p></td><td class="cl-fc0cb99a"><p class="cl-fc0c9690"><span class="cl-fc091647">Monday</span></p></td><td class="cl-fc0cb991"><p class="cl-fc0c9690"><span class="cl-fc091647">114 (64.4)</span></p></td><td class="cl-fc0cb991"><p class="cl-fc0c9690"><span class="cl-fc091647">49 (27.7)</span></p></td><td class="cl-fc0cb991"><p class="cl-fc0c9690"><span class="cl-fc091647">14 (7.9)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-fc0cb991"><p class="cl-fc0c9690"><span class="cl-fc091647"></span></p></td><td class="cl-fc0cb99a"><p class="cl-fc0c9690"><span class="cl-fc091647">Saturday</span></p></td><td class="cl-fc0cb991"><p class="cl-fc0c9690"><span class="cl-fc091647">160 (63.2)</span></p></td><td class="cl-fc0cb991"><p class="cl-fc0c9690"><span class="cl-fc091647">81 (32)</span></p></td><td class="cl-fc0cb991"><p class="cl-fc0c9690"><span class="cl-fc091647">12 (4.7)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-fc0cb991"><p class="cl-fc0c9690"><span class="cl-fc091647"></span></p></td><td class="cl-fc0cb99a"><p class="cl-fc0c9690"><span class="cl-fc091647">Sunday</span></p></td><td class="cl-fc0cb991"><p class="cl-fc0c9690"><span class="cl-fc091647">156 (56.3)</span></p></td><td class="cl-fc0cb991"><p class="cl-fc0c9690"><span class="cl-fc091647">100 (36.1)</span></p></td><td class="cl-fc0cb991"><p class="cl-fc0c9690"><span class="cl-fc091647">21 (7.6)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-fc0cb991"><p class="cl-fc0c9690"><span class="cl-fc091647"></span></p></td><td class="cl-fc0cb99a"><p class="cl-fc0c9690"><span class="cl-fc091647">Thursday</span></p></td><td class="cl-fc0cb991"><p class="cl-fc0c9690"><span class="cl-fc091647">167 (66)</span></p></td><td class="cl-fc0cb991"><p class="cl-fc0c9690"><span class="cl-fc091647">66 (26.1)</span></p></td><td class="cl-fc0cb991"><p class="cl-fc0c9690"><span class="cl-fc091647">20 (7.9)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-fc0cb991"><p class="cl-fc0c9690"><span class="cl-fc091647"></span></p></td><td class="cl-fc0cb99a"><p class="cl-fc0c9690"><span class="cl-fc091647">Tuesday</span></p></td><td class="cl-fc0cb991"><p class="cl-fc0c9690"><span class="cl-fc091647">108 (65.5)</span></p></td><td class="cl-fc0cb991"><p class="cl-fc0c9690"><span class="cl-fc091647">43 (26.1)</span></p></td><td class="cl-fc0cb991"><p class="cl-fc0c9690"><span class="cl-fc091647">14 (8.5)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-fc0cb99b"><p class="cl-fc0c9690"><span class="cl-fc091647"></span></p></td><td class="cl-fc0cb99c"><p class="cl-fc0c9690"><span class="cl-fc091647">Wednesday</span></p></td><td class="cl-fc0cb99b"><p class="cl-fc0c9690"><span class="cl-fc091647">109 (44)</span></p></td><td class="cl-fc0cb99b"><p class="cl-fc0c9690"><span class="cl-fc091647">102 (41.1)</span></p></td><td class="cl-fc0cb99b"><p class="cl-fc0c9690"><span class="cl-fc091647">37 (14.9)</span></p></td></tr></tbody><tfoot><tr style="overflow-wrap:break-word;"><td colspan="5" class="cl-fc0cb9a6"><p class="cl-fc0c969a"><span class="cl-fc091648">·µÉ</span><span class="cl-fc091647">Vaccination proportions were calculated row-wise (i.e., by row).</span></p></td></tr></tfoot></table></div>
</div>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="co"># .................. Clean up ..................</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(tab_age, tab_sex, tab_marital_status, tab_year, tab_quarter, tab_weekday, </span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>   tab_combined, ft_vacc_summary, totals, create_tab)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="missing-values-with-only-counts" class="level2" data-number="1.4">
<h2 data-number="1.4" class="anchored" data-anchor-id="missing-values-with-only-counts"><span class="header-section-number">1.4</span> <strong>4. Missing Values with Only Counts</strong></h2>
<p>This variation includes missing data rows but only shows <strong>raw counts</strong>, not percentages.</p>
<ul>
<li><p>‚öñÔ∏è <em>Why use this</em>: It prevents misleading interpretations‚Äîespecially when the denominator for percentage is unclear or inconsistent.</p></li>
<li><p>Use this when you want to <strong>acknowledge missing data</strong> but avoid implying proportional meaning.</p></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ------------4. Missing values with only counts-------------------------------------------</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a><span class="co"># .................. Convert grouping vars to character ..................</span></span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>vacc_1524 <span class="ot">&lt;-</span> vacc_1524 <span class="sc">%&gt;%</span></span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">c</span>(age_group, gender, marital_status,</span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>                  vacc_service_year, vacc_quarter, vacc_weekday), as.character))</span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a><span class="co"># .................. Table generation function with Missing ..................</span></span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a>create_tab <span class="ot">&lt;-</span> <span class="cf">function</span>(data, var, label) {</span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a>  tab_main <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span></span>
<span id="cb19-11"><a href="#cb19-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>({{ var }})) <span class="sc">%&gt;%</span></span>
<span id="cb19-12"><a href="#cb19-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tabyl</span>({{ var }}, vacc_group3) <span class="sc">%&gt;%</span></span>
<span id="cb19-13"><a href="#cb19-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">Category =</span> label, <span class="at">.before =</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb19-14"><a href="#cb19-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rename</span>(<span class="at">Label =</span> {{ var }}) <span class="sc">%&gt;%</span></span>
<span id="cb19-15"><a href="#cb19-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">Label =</span> <span class="fu">as.character</span>(Label))</span>
<span id="cb19-16"><a href="#cb19-16" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb19-17"><a href="#cb19-17" aria-hidden="true" tabindex="-1"></a>  na_count <span class="ot">&lt;-</span> <span class="fu">sum</span>(<span class="fu">is.na</span>(<span class="fu">pull</span>(data, {{ var }})))</span>
<span id="cb19-18"><a href="#cb19-18" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb19-19"><a href="#cb19-19" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (na_count <span class="sc">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb19-20"><a href="#cb19-20" aria-hidden="true" tabindex="-1"></a>    missing_row <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb19-21"><a href="#cb19-21" aria-hidden="true" tabindex="-1"></a>      <span class="at">Category =</span> label,</span>
<span id="cb19-22"><a href="#cb19-22" aria-hidden="true" tabindex="-1"></a>      <span class="at">Label =</span> <span class="st">"Missing"</span>,</span>
<span id="cb19-23"><a href="#cb19-23" aria-hidden="true" tabindex="-1"></a>      <span class="st">`</span><span class="at">Respiratory vaccines</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">sum</span>(data<span class="sc">$</span>vacc_group3 <span class="sc">==</span> <span class="st">"Respiratory vaccines"</span> <span class="sc">&amp;</span> <span class="fu">is.na</span>(<span class="fu">pull</span>(data, {{ var }})), <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb19-24"><a href="#cb19-24" aria-hidden="true" tabindex="-1"></a>      <span class="st">`</span><span class="at">Childhood vaccines</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">sum</span>(data<span class="sc">$</span>vacc_group3 <span class="sc">==</span> <span class="st">"Childhood vaccines"</span> <span class="sc">&amp;</span> <span class="fu">is.na</span>(<span class="fu">pull</span>(data, {{ var }})), <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb19-25"><a href="#cb19-25" aria-hidden="true" tabindex="-1"></a>      <span class="at">Other =</span> <span class="fu">sum</span>(data<span class="sc">$</span>vacc_group3 <span class="sc">==</span> <span class="st">"Other"</span> <span class="sc">&amp;</span> <span class="fu">is.na</span>(<span class="fu">pull</span>(data, {{ var }})), <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb19-26"><a href="#cb19-26" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb19-27"><a href="#cb19-27" aria-hidden="true" tabindex="-1"></a>    tab_final <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(tab_main, missing_row)</span>
<span id="cb19-28"><a href="#cb19-28" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb19-29"><a href="#cb19-29" aria-hidden="true" tabindex="-1"></a>    tab_final <span class="ot">&lt;-</span> tab_main</span>
<span id="cb19-30"><a href="#cb19-30" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb19-31"><a href="#cb19-31" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb19-32"><a href="#cb19-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(tab_final)</span>
<span id="cb19-33"><a href="#cb19-33" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb19-34"><a href="#cb19-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-35"><a href="#cb19-35" aria-hidden="true" tabindex="-1"></a><span class="co"># .................. Create summary tables ..................</span></span>
<span id="cb19-36"><a href="#cb19-36" aria-hidden="true" tabindex="-1"></a>tab_age            <span class="ot">&lt;-</span> <span class="fu">create_tab</span>(vacc_1524, age_group, <span class="st">"Age"</span>)</span>
<span id="cb19-37"><a href="#cb19-37" aria-hidden="true" tabindex="-1"></a>tab_sex            <span class="ot">&lt;-</span> <span class="fu">create_tab</span>(vacc_1524, gender, <span class="st">"Gender"</span>)</span>
<span id="cb19-38"><a href="#cb19-38" aria-hidden="true" tabindex="-1"></a>tab_marital_status <span class="ot">&lt;-</span> <span class="fu">create_tab</span>(vacc_1524, marital_status, <span class="st">"Marital status"</span>)</span>
<span id="cb19-39"><a href="#cb19-39" aria-hidden="true" tabindex="-1"></a>tab_year           <span class="ot">&lt;-</span> <span class="fu">create_tab</span>(vacc_1524, vacc_service_year, <span class="st">"Year"</span>)</span>
<span id="cb19-40"><a href="#cb19-40" aria-hidden="true" tabindex="-1"></a>tab_quarter        <span class="ot">&lt;-</span> <span class="fu">create_tab</span>(vacc_1524, vacc_quarter, <span class="st">"Quarter"</span>)</span>
<span id="cb19-41"><a href="#cb19-41" aria-hidden="true" tabindex="-1"></a>tab_weekday        <span class="ot">&lt;-</span> <span class="fu">create_tab</span>(vacc_1524, vacc_weekday, <span class="st">"Weekday"</span>)</span>
<span id="cb19-42"><a href="#cb19-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-43"><a href="#cb19-43" aria-hidden="true" tabindex="-1"></a><span class="co"># .................. Combine all tables ..................</span></span>
<span id="cb19-44"><a href="#cb19-44" aria-hidden="true" tabindex="-1"></a>tab_combined <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(tab_sex, tab_age, tab_marital_status, tab_year, tab_quarter, tab_weekday)</span>
<span id="cb19-45"><a href="#cb19-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-46"><a href="#cb19-46" aria-hidden="true" tabindex="-1"></a><span class="co"># .................. Calculate row-wise percentages (skip for Missing) ..................</span></span>
<span id="cb19-47"><a href="#cb19-47" aria-hidden="true" tabindex="-1"></a>tab_combined <span class="ot">&lt;-</span> tab_combined <span class="sc">%&gt;%</span></span>
<span id="cb19-48"><a href="#cb19-48" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rowwise</span>() <span class="sc">%&gt;%</span></span>
<span id="cb19-49"><a href="#cb19-49" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb19-50"><a href="#cb19-50" aria-hidden="true" tabindex="-1"></a>    <span class="at">Total =</span> <span class="fu">sum</span>(<span class="st">`</span><span class="at">Respiratory vaccines</span><span class="st">`</span>, <span class="st">`</span><span class="at">Childhood vaccines</span><span class="st">`</span>, Other, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb19-51"><a href="#cb19-51" aria-hidden="true" tabindex="-1"></a>    <span class="at">is_missing =</span> <span class="fu">trimws</span>(<span class="fu">tolower</span>(Label)) <span class="sc">==</span> <span class="st">"missing"</span>,</span>
<span id="cb19-52"><a href="#cb19-52" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb19-53"><a href="#cb19-53" aria-hidden="true" tabindex="-1"></a>    <span class="at">Respiratory =</span> <span class="fu">ifelse</span>(is_missing,</span>
<span id="cb19-54"><a href="#cb19-54" aria-hidden="true" tabindex="-1"></a>                         <span class="fu">comma</span>(<span class="st">`</span><span class="at">Respiratory vaccines</span><span class="st">`</span>),</span>
<span id="cb19-55"><a href="#cb19-55" aria-hidden="true" tabindex="-1"></a>                         <span class="fu">paste0</span>(<span class="fu">comma</span>(<span class="st">`</span><span class="at">Respiratory vaccines</span><span class="st">`</span>), <span class="st">" ("</span>, <span class="fu">round</span>(<span class="dv">100</span> <span class="sc">*</span> <span class="st">`</span><span class="at">Respiratory vaccines</span><span class="st">`</span> <span class="sc">/</span> Total, <span class="dv">1</span>), <span class="st">")"</span>)),</span>
<span id="cb19-56"><a href="#cb19-56" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb19-57"><a href="#cb19-57" aria-hidden="true" tabindex="-1"></a>    <span class="at">Childhood =</span> <span class="fu">ifelse</span>(is_missing,</span>
<span id="cb19-58"><a href="#cb19-58" aria-hidden="true" tabindex="-1"></a>                       <span class="fu">comma</span>(<span class="st">`</span><span class="at">Childhood vaccines</span><span class="st">`</span>),</span>
<span id="cb19-59"><a href="#cb19-59" aria-hidden="true" tabindex="-1"></a>                       <span class="fu">paste0</span>(<span class="fu">comma</span>(<span class="st">`</span><span class="at">Childhood vaccines</span><span class="st">`</span>), <span class="st">" ("</span>, <span class="fu">round</span>(<span class="dv">100</span> <span class="sc">*</span> <span class="st">`</span><span class="at">Childhood vaccines</span><span class="st">`</span> <span class="sc">/</span> Total, <span class="dv">1</span>), <span class="st">")"</span>)),</span>
<span id="cb19-60"><a href="#cb19-60" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb19-61"><a href="#cb19-61" aria-hidden="true" tabindex="-1"></a>    <span class="at">Other_grp =</span> <span class="fu">ifelse</span>(is_missing,</span>
<span id="cb19-62"><a href="#cb19-62" aria-hidden="true" tabindex="-1"></a>                       <span class="fu">comma</span>(Other),</span>
<span id="cb19-63"><a href="#cb19-63" aria-hidden="true" tabindex="-1"></a>                       <span class="fu">paste0</span>(<span class="fu">comma</span>(Other), <span class="st">" ("</span>, <span class="fu">round</span>(<span class="dv">100</span> <span class="sc">*</span> Other <span class="sc">/</span> Total, <span class="dv">1</span>), <span class="st">")"</span>))</span>
<span id="cb19-64"><a href="#cb19-64" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb19-65"><a href="#cb19-65" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb19-66"><a href="#cb19-66" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Category, Label, Respiratory, Childhood, Other_grp)</span>
<span id="cb19-67"><a href="#cb19-67" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-68"><a href="#cb19-68" aria-hidden="true" tabindex="-1"></a><span class="co"># .................. Show Category only once per group ..................</span></span>
<span id="cb19-69"><a href="#cb19-69" aria-hidden="true" tabindex="-1"></a>tab_combined <span class="ot">&lt;-</span> tab_combined <span class="sc">%&gt;%</span></span>
<span id="cb19-70"><a href="#cb19-70" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Category) <span class="sc">%&gt;%</span></span>
<span id="cb19-71"><a href="#cb19-71" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Category =</span> <span class="fu">ifelse</span>(<span class="fu">row_number</span>() <span class="sc">==</span> <span class="dv">1</span>, Category, <span class="st">""</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb19-72"><a href="#cb19-72" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb19-73"><a href="#cb19-73" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-74"><a href="#cb19-74" aria-hidden="true" tabindex="-1"></a><span class="co"># .................. Get total counts per vaccine group ..................</span></span>
<span id="cb19-75"><a href="#cb19-75" aria-hidden="true" tabindex="-1"></a>totals <span class="ot">&lt;-</span> vacc_1524 <span class="sc">%&gt;%</span></span>
<span id="cb19-76"><a href="#cb19-76" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(vacc_group3) <span class="sc">%&gt;%</span></span>
<span id="cb19-77"><a href="#cb19-77" aria-hidden="true" tabindex="-1"></a>  <span class="fu">deframe</span>()</span>
<span id="cb19-78"><a href="#cb19-78" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-79"><a href="#cb19-79" aria-hidden="true" tabindex="-1"></a><span class="co"># .................. Create flextable ..................</span></span>
<span id="cb19-80"><a href="#cb19-80" aria-hidden="true" tabindex="-1"></a>ft_vacc_summary <span class="ot">&lt;-</span> tab_combined <span class="sc">%&gt;%</span></span>
<span id="cb19-81"><a href="#cb19-81" aria-hidden="true" tabindex="-1"></a>  <span class="fu">flextable</span>() <span class="sc">%&gt;%</span></span>
<span id="cb19-82"><a href="#cb19-82" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_header_labels</span>(</span>
<span id="cb19-83"><a href="#cb19-83" aria-hidden="true" tabindex="-1"></a>    <span class="at">Category =</span> <span class="st">"Variable type"</span>,</span>
<span id="cb19-84"><a href="#cb19-84" aria-hidden="true" tabindex="-1"></a>    <span class="at">Label =</span> <span class="st">"Values"</span>,</span>
<span id="cb19-85"><a href="#cb19-85" aria-hidden="true" tabindex="-1"></a>    <span class="at">Respiratory =</span> <span class="st">"Number (%)·µÉ"</span>,</span>
<span id="cb19-86"><a href="#cb19-86" aria-hidden="true" tabindex="-1"></a>    <span class="at">Childhood =</span> <span class="st">"Number (%)·µÉ"</span>,</span>
<span id="cb19-87"><a href="#cb19-87" aria-hidden="true" tabindex="-1"></a>    <span class="at">Other_grp =</span> <span class="st">"Number (%)·µÉ"</span></span>
<span id="cb19-88"><a href="#cb19-88" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb19-89"><a href="#cb19-89" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_header_row</span>(</span>
<span id="cb19-90"><a href="#cb19-90" aria-hidden="true" tabindex="-1"></a>    <span class="at">values =</span> <span class="fu">c</span>(</span>
<span id="cb19-91"><a href="#cb19-91" aria-hidden="true" tabindex="-1"></a>      <span class="st">""</span>, <span class="st">""</span>,</span>
<span id="cb19-92"><a href="#cb19-92" aria-hidden="true" tabindex="-1"></a>      <span class="fu">paste0</span>(<span class="st">"Respiratory vaccines (N = "</span>, <span class="fu">format</span>(totals[<span class="st">"Respiratory vaccines"</span>], <span class="at">big.mark =</span> <span class="st">","</span>), <span class="st">")"</span>),</span>
<span id="cb19-93"><a href="#cb19-93" aria-hidden="true" tabindex="-1"></a>      <span class="fu">paste0</span>(<span class="st">"Childhood vaccines (N = "</span>, <span class="fu">format</span>(totals[<span class="st">"Childhood vaccines"</span>], <span class="at">big.mark =</span> <span class="st">","</span>), <span class="st">")"</span>),</span>
<span id="cb19-94"><a href="#cb19-94" aria-hidden="true" tabindex="-1"></a>      <span class="fu">paste0</span>(<span class="st">"Other (N = "</span>, <span class="fu">format</span>(totals[<span class="st">"Other"</span>], <span class="at">big.mark =</span> <span class="st">","</span>), <span class="st">")"</span>)</span>
<span id="cb19-95"><a href="#cb19-95" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb19-96"><a href="#cb19-96" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb19-97"><a href="#cb19-97" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_header_row</span>(</span>
<span id="cb19-98"><a href="#cb19-98" aria-hidden="true" tabindex="-1"></a>    <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"Description"</span>, <span class="st">"Vaccination uptake"</span>),</span>
<span id="cb19-99"><a href="#cb19-99" aria-hidden="true" tabindex="-1"></a>    <span class="at">colwidths =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">3</span>)</span>
<span id="cb19-100"><a href="#cb19-100" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb19-101"><a href="#cb19-101" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_box</span>() <span class="sc">%&gt;%</span></span>
<span id="cb19-102"><a href="#cb19-102" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_table_properties</span>(<span class="at">layout =</span> <span class="st">"autofit"</span>, <span class="at">width =</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb19-103"><a href="#cb19-103" aria-hidden="true" tabindex="-1"></a>  <span class="fu">width</span>(<span class="at">j =</span> <span class="dv">1</span>, <span class="at">width =</span> <span class="fl">1.5</span>) <span class="sc">%&gt;%</span></span>
<span id="cb19-104"><a href="#cb19-104" aria-hidden="true" tabindex="-1"></a>  <span class="fu">width</span>(<span class="at">j =</span> <span class="dv">2</span>, <span class="at">width =</span> <span class="fl">2.5</span>) <span class="sc">%&gt;%</span></span>
<span id="cb19-105"><a href="#cb19-105" aria-hidden="true" tabindex="-1"></a>  <span class="fu">width</span>(<span class="at">j =</span> <span class="dv">3</span><span class="sc">:</span><span class="dv">5</span>, <span class="at">width =</span> <span class="fl">1.5</span>) <span class="sc">%&gt;%</span></span>
<span id="cb19-106"><a href="#cb19-106" aria-hidden="true" tabindex="-1"></a>  <span class="fu">align</span>(<span class="at">align =</span> <span class="st">"justify"</span>, <span class="at">part =</span> <span class="st">"all"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb19-107"><a href="#cb19-107" aria-hidden="true" tabindex="-1"></a>  <span class="fu">border_remove</span>() <span class="sc">%&gt;%</span></span>
<span id="cb19-108"><a href="#cb19-108" aria-hidden="true" tabindex="-1"></a>  <span class="fu">border</span>(<span class="at">part =</span> <span class="st">"header"</span>, <span class="at">i =</span> <span class="dv">1</span>, <span class="at">border.top =</span> <span class="fu">fp_border</span>(<span class="at">color =</span> <span class="st">"black"</span>, <span class="at">width =</span> <span class="dv">1</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb19-109"><a href="#cb19-109" aria-hidden="true" tabindex="-1"></a>  <span class="fu">border</span>(<span class="at">part =</span> <span class="st">"header"</span>, <span class="at">i =</span> <span class="dv">3</span>, <span class="at">border.bottom =</span> <span class="fu">fp_border</span>(<span class="at">color =</span> <span class="st">"black"</span>, <span class="at">width =</span> <span class="dv">1</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb19-110"><a href="#cb19-110" aria-hidden="true" tabindex="-1"></a>  <span class="fu">border_inner_h</span>(<span class="at">part =</span> <span class="st">"header"</span>, <span class="at">border =</span> <span class="fu">fp_border</span>(<span class="at">color =</span> <span class="st">"black"</span>, <span class="at">width =</span> <span class="fl">0.8</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb19-111"><a href="#cb19-111" aria-hidden="true" tabindex="-1"></a>  <span class="fu">border_inner_h</span>(<span class="at">part =</span> <span class="st">"body"</span>, <span class="at">border =</span> <span class="fu">fp_border</span>(<span class="at">color =</span> <span class="st">"black"</span>, <span class="at">width =</span> <span class="fl">0.8</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb19-112"><a href="#cb19-112" aria-hidden="true" tabindex="-1"></a>  <span class="fu">border</span>(<span class="at">part =</span> <span class="st">"body"</span>, <span class="at">i =</span> <span class="fu">nrow</span>(tab_combined), <span class="at">border.bottom =</span> <span class="fu">fp_border</span>(<span class="at">color =</span> <span class="st">"black"</span>, <span class="at">width =</span> <span class="dv">1</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb19-113"><a href="#cb19-113" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb19-114"><a href="#cb19-114" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_caption</span>(<span class="st">"Table: Vaccination uptake across service year, quarter, and weekday"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb19-115"><a href="#cb19-115" aria-hidden="true" tabindex="-1"></a>  <span class="fu">footnote</span>(<span class="at">i =</span> <span class="dv">1</span>, </span>
<span id="cb19-116"><a href="#cb19-116" aria-hidden="true" tabindex="-1"></a>           <span class="at">value =</span> <span class="fu">as_paragraph</span>(<span class="st">"Vaccination proportions were calculated row-wise (i.e., by row)."</span>),</span>
<span id="cb19-117"><a href="#cb19-117" aria-hidden="true" tabindex="-1"></a>           <span class="at">ref_symbols =</span> <span class="st">"·µÉ"</span>, </span>
<span id="cb19-118"><a href="#cb19-118" aria-hidden="true" tabindex="-1"></a>           <span class="at">part =</span> <span class="st">"header"</span>)</span>
<span id="cb19-119"><a href="#cb19-119" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-120"><a href="#cb19-120" aria-hidden="true" tabindex="-1"></a><span class="co"># .................. Show the table ..................</span></span>
<span id="cb19-121"><a href="#cb19-121" aria-hidden="true" tabindex="-1"></a>ft_vacc_summary</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="tabwid"><style>.cl-fc59f2f0{table-layout:auto;width:100%;}.cl-fc50934a{font-family:'Arial';font-size:11pt;font-weight:bold;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-fc509354{font-family:'Arial';font-size:6.6pt;font-weight:bold;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;position: relative;bottom:3.3pt;}.cl-fc509355{font-family:'Arial';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-fc50935e{font-family:'Arial';font-size:6.6pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;position: relative;bottom:3.3pt;}.cl-fc54a2b4{margin:0;text-align:justify;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-fc54a2be{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-fc54c3e8{background-color:transparent;vertical-align: middle;border-bottom: 0.8pt solid rgba(0, 0, 0, 1.00);border-top: 1pt solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-fc54c3f2{background-color:transparent;vertical-align: middle;border-bottom: 0.8pt solid rgba(0, 0, 0, 1.00);border-top: 1pt solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-fc54c3f3{background-color:transparent;vertical-align: middle;border-bottom: 0.8pt solid rgba(0, 0, 0, 1.00);border-top: 0.8pt solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-fc54c3f4{background-color:transparent;vertical-align: middle;border-bottom: 0.8pt solid rgba(0, 0, 0, 1.00);border-top: 0.8pt solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-fc54c3f5{background-color:transparent;vertical-align: middle;border-bottom: 1pt solid rgba(0, 0, 0, 1.00);border-top: 0.8pt solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-fc54c3fc{background-color:transparent;vertical-align: middle;border-bottom: 1pt solid rgba(0, 0, 0, 1.00);border-top: 0.8pt solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-fc54c3fd{background-color:transparent;vertical-align: middle;border-bottom: 0.8pt solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-fc54c3fe{background-color:transparent;vertical-align: middle;border-bottom: 0.8pt solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-fc54c3ff{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(255, 255, 255, 0.00);border-top: 0 solid rgba(255, 255, 255, 0.00);border-left: 0 solid rgba(255, 255, 255, 0.00);border-right: 0 solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-fc54c406{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(255, 255, 255, 0.00);border-top: 0 solid rgba(255, 255, 255, 0.00);border-left: 0 solid rgba(255, 255, 255, 0.00);border-right: 0 solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table data-quarto-disable-processing="true" class="cl-fc59f2f0"><thead><tr style="overflow-wrap:break-word;"><th colspan="2" class="cl-fc54c3e8"><p class="cl-fc54a2b4"><span class="cl-fc50934a">Description</span><span class="cl-fc509354">·µÉ</span></p></th><th colspan="3" class="cl-fc54c3e8"><p class="cl-fc54a2b4"><span class="cl-fc50934a">Vaccination uptake</span><span class="cl-fc509354">·µÉ</span></p></th></tr><tr style="overflow-wrap:break-word;"><th class="cl-fc54c3f3"><p class="cl-fc54a2b4"><span class="cl-fc50934a"></span></p></th><th class="cl-fc54c3f4"><p class="cl-fc54a2b4"><span class="cl-fc50934a"></span></p></th><th class="cl-fc54c3f3"><p class="cl-fc54a2b4"><span class="cl-fc50934a">Respiratory vaccines (N = 955)</span></p></th><th class="cl-fc54c3f3"><p class="cl-fc54a2b4"><span class="cl-fc50934a">Childhood vaccines (N = 472)</span></p></th><th class="cl-fc54c3f3"><p class="cl-fc54a2b4"><span class="cl-fc50934a">Other (N = 126)</span></p></th></tr><tr style="overflow-wrap:break-word;"><th class="cl-fc54c3f5"><p class="cl-fc54a2b4"><span class="cl-fc50934a">Variable type</span></p></th><th class="cl-fc54c3fc"><p class="cl-fc54a2b4"><span class="cl-fc50934a">Values</span></p></th><th class="cl-fc54c3f5"><p class="cl-fc54a2b4"><span class="cl-fc50934a">Number (%)·µÉ</span></p></th><th class="cl-fc54c3f5"><p class="cl-fc54a2b4"><span class="cl-fc50934a">Number (%)·µÉ</span></p></th><th class="cl-fc54c3f5"><p class="cl-fc54a2b4"><span class="cl-fc50934a">Number (%)·µÉ</span></p></th></tr></thead><tbody><tr style="overflow-wrap:break-word;"><td class="cl-fc54c3fd"><p class="cl-fc54a2b4"><span class="cl-fc509355">Gender</span></p></td><td class="cl-fc54c3fe"><p class="cl-fc54a2b4"><span class="cl-fc509355">Female</span></p></td><td class="cl-fc54c3fd"><p class="cl-fc54a2b4"><span class="cl-fc509355">511 (64)</span></p></td><td class="cl-fc54c3fd"><p class="cl-fc54a2b4"><span class="cl-fc509355">233 (29.2)</span></p></td><td class="cl-fc54c3fd"><p class="cl-fc54a2b4"><span class="cl-fc509355">54 (6.8)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-fc54c3f3"><p class="cl-fc54a2b4"><span class="cl-fc509355"></span></p></td><td class="cl-fc54c3f4"><p class="cl-fc54a2b4"><span class="cl-fc509355">Male</span></p></td><td class="cl-fc54c3f3"><p class="cl-fc54a2b4"><span class="cl-fc509355">444 (58.8)</span></p></td><td class="cl-fc54c3f3"><p class="cl-fc54a2b4"><span class="cl-fc509355">239 (31.7)</span></p></td><td class="cl-fc54c3f3"><p class="cl-fc54a2b4"><span class="cl-fc509355">72 (9.5)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-fc54c3f3"><p class="cl-fc54a2b4"><span class="cl-fc509355">Age</span></p></td><td class="cl-fc54c3f4"><p class="cl-fc54a2b4"><span class="cl-fc509355">0-19</span></p></td><td class="cl-fc54c3f3"><p class="cl-fc54a2b4"><span class="cl-fc509355">250 (38.9)</span></p></td><td class="cl-fc54c3f3"><p class="cl-fc54a2b4"><span class="cl-fc509355">302 (47)</span></p></td><td class="cl-fc54c3f3"><p class="cl-fc54a2b4"><span class="cl-fc509355">90 (14)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-fc54c3f3"><p class="cl-fc54a2b4"><span class="cl-fc509355"></span></p></td><td class="cl-fc54c3f4"><p class="cl-fc54a2b4"><span class="cl-fc509355">20-29</span></p></td><td class="cl-fc54c3f3"><p class="cl-fc54a2b4"><span class="cl-fc509355">150 (68.2)</span></p></td><td class="cl-fc54c3f3"><p class="cl-fc54a2b4"><span class="cl-fc509355">70 (31.8)</span></p></td><td class="cl-fc54c3f3"><p class="cl-fc54a2b4"><span class="cl-fc509355">0 (0)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-fc54c3f3"><p class="cl-fc54a2b4"><span class="cl-fc509355"></span></p></td><td class="cl-fc54c3f4"><p class="cl-fc54a2b4"><span class="cl-fc509355">30-39</span></p></td><td class="cl-fc54c3f3"><p class="cl-fc54a2b4"><span class="cl-fc509355">47 (71.2)</span></p></td><td class="cl-fc54c3f3"><p class="cl-fc54a2b4"><span class="cl-fc509355">19 (28.8)</span></p></td><td class="cl-fc54c3f3"><p class="cl-fc54a2b4"><span class="cl-fc509355">0 (0)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-fc54c3f3"><p class="cl-fc54a2b4"><span class="cl-fc509355"></span></p></td><td class="cl-fc54c3f4"><p class="cl-fc54a2b4"><span class="cl-fc509355">40-49</span></p></td><td class="cl-fc54c3f3"><p class="cl-fc54a2b4"><span class="cl-fc509355">142 (75.9)</span></p></td><td class="cl-fc54c3f3"><p class="cl-fc54a2b4"><span class="cl-fc509355">45 (24.1)</span></p></td><td class="cl-fc54c3f3"><p class="cl-fc54a2b4"><span class="cl-fc509355">0 (0)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-fc54c3f3"><p class="cl-fc54a2b4"><span class="cl-fc509355"></span></p></td><td class="cl-fc54c3f4"><p class="cl-fc54a2b4"><span class="cl-fc509355">50-59</span></p></td><td class="cl-fc54c3f3"><p class="cl-fc54a2b4"><span class="cl-fc509355">112 (77.8)</span></p></td><td class="cl-fc54c3f3"><p class="cl-fc54a2b4"><span class="cl-fc509355">14 (9.7)</span></p></td><td class="cl-fc54c3f3"><p class="cl-fc54a2b4"><span class="cl-fc509355">18 (12.5)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-fc54c3f3"><p class="cl-fc54a2b4"><span class="cl-fc509355"></span></p></td><td class="cl-fc54c3f4"><p class="cl-fc54a2b4"><span class="cl-fc509355">60-69</span></p></td><td class="cl-fc54c3f3"><p class="cl-fc54a2b4"><span class="cl-fc509355">149 (87.6)</span></p></td><td class="cl-fc54c3f3"><p class="cl-fc54a2b4"><span class="cl-fc509355">13 (7.6)</span></p></td><td class="cl-fc54c3f3"><p class="cl-fc54a2b4"><span class="cl-fc509355">8 (4.7)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-fc54c3f3"><p class="cl-fc54a2b4"><span class="cl-fc509355"></span></p></td><td class="cl-fc54c3f4"><p class="cl-fc54a2b4"><span class="cl-fc509355">70+</span></p></td><td class="cl-fc54c3f3"><p class="cl-fc54a2b4"><span class="cl-fc509355">105 (84.7)</span></p></td><td class="cl-fc54c3f3"><p class="cl-fc54a2b4"><span class="cl-fc509355">9 (7.3)</span></p></td><td class="cl-fc54c3f3"><p class="cl-fc54a2b4"><span class="cl-fc509355">10 (8.1)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-fc54c3f3"><p class="cl-fc54a2b4"><span class="cl-fc509355">Marital status</span></p></td><td class="cl-fc54c3f4"><p class="cl-fc54a2b4"><span class="cl-fc509355">Divorced</span></p></td><td class="cl-fc54c3f3"><p class="cl-fc54a2b4"><span class="cl-fc509355">136 (83.4)</span></p></td><td class="cl-fc54c3f3"><p class="cl-fc54a2b4"><span class="cl-fc509355">15 (9.2)</span></p></td><td class="cl-fc54c3f3"><p class="cl-fc54a2b4"><span class="cl-fc509355">12 (7.4)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-fc54c3f3"><p class="cl-fc54a2b4"><span class="cl-fc509355"></span></p></td><td class="cl-fc54c3f4"><p class="cl-fc54a2b4"><span class="cl-fc509355">Married</span></p></td><td class="cl-fc54c3f3"><p class="cl-fc54a2b4"><span class="cl-fc509355">289 (79)</span></p></td><td class="cl-fc54c3f3"><p class="cl-fc54a2b4"><span class="cl-fc509355">59 (16.1)</span></p></td><td class="cl-fc54c3f3"><p class="cl-fc54a2b4"><span class="cl-fc509355">18 (4.9)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-fc54c3f3"><p class="cl-fc54a2b4"><span class="cl-fc509355"></span></p></td><td class="cl-fc54c3f4"><p class="cl-fc54a2b4"><span class="cl-fc509355">Single/widowed</span></p></td><td class="cl-fc54c3f3"><p class="cl-fc54a2b4"><span class="cl-fc509355">150 (79.4)</span></p></td><td class="cl-fc54c3f3"><p class="cl-fc54a2b4"><span class="cl-fc509355">33 (17.5)</span></p></td><td class="cl-fc54c3f3"><p class="cl-fc54a2b4"><span class="cl-fc509355">6 (3.2)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-fc54c3f3"><p class="cl-fc54a2b4"><span class="cl-fc509355"></span></p></td><td class="cl-fc54c3f4"><p class="cl-fc54a2b4"><span class="cl-fc509355">Missing</span></p></td><td class="cl-fc54c3f3"><p class="cl-fc54a2b4"><span class="cl-fc509355">380</span></p></td><td class="cl-fc54c3f3"><p class="cl-fc54a2b4"><span class="cl-fc509355">365</span></p></td><td class="cl-fc54c3f3"><p class="cl-fc54a2b4"><span class="cl-fc509355">90</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-fc54c3f3"><p class="cl-fc54a2b4"><span class="cl-fc509355">Year</span></p></td><td class="cl-fc54c3f4"><p class="cl-fc54a2b4"><span class="cl-fc509355">2015</span></p></td><td class="cl-fc54c3f3"><p class="cl-fc54a2b4"><span class="cl-fc509355">78 (51)</span></p></td><td class="cl-fc54c3f3"><p class="cl-fc54a2b4"><span class="cl-fc509355">56 (36.6)</span></p></td><td class="cl-fc54c3f3"><p class="cl-fc54a2b4"><span class="cl-fc509355">19 (12.4)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-fc54c3f3"><p class="cl-fc54a2b4"><span class="cl-fc509355"></span></p></td><td class="cl-fc54c3f4"><p class="cl-fc54a2b4"><span class="cl-fc509355">2016</span></p></td><td class="cl-fc54c3f3"><p class="cl-fc54a2b4"><span class="cl-fc509355">84 (60.4)</span></p></td><td class="cl-fc54c3f3"><p class="cl-fc54a2b4"><span class="cl-fc509355">47 (33.8)</span></p></td><td class="cl-fc54c3f3"><p class="cl-fc54a2b4"><span class="cl-fc509355">8 (5.8)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-fc54c3f3"><p class="cl-fc54a2b4"><span class="cl-fc509355"></span></p></td><td class="cl-fc54c3f4"><p class="cl-fc54a2b4"><span class="cl-fc509355">2017</span></p></td><td class="cl-fc54c3f3"><p class="cl-fc54a2b4"><span class="cl-fc509355">75 (54.7)</span></p></td><td class="cl-fc54c3f3"><p class="cl-fc54a2b4"><span class="cl-fc509355">52 (38)</span></p></td><td class="cl-fc54c3f3"><p class="cl-fc54a2b4"><span class="cl-fc509355">10 (7.3)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-fc54c3f3"><p class="cl-fc54a2b4"><span class="cl-fc509355"></span></p></td><td class="cl-fc54c3f4"><p class="cl-fc54a2b4"><span class="cl-fc509355">2018</span></p></td><td class="cl-fc54c3f3"><p class="cl-fc54a2b4"><span class="cl-fc509355">81 (53.6)</span></p></td><td class="cl-fc54c3f3"><p class="cl-fc54a2b4"><span class="cl-fc509355">52 (34.4)</span></p></td><td class="cl-fc54c3f3"><p class="cl-fc54a2b4"><span class="cl-fc509355">18 (11.9)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-fc54c3f3"><p class="cl-fc54a2b4"><span class="cl-fc509355"></span></p></td><td class="cl-fc54c3f4"><p class="cl-fc54a2b4"><span class="cl-fc509355">2019</span></p></td><td class="cl-fc54c3f3"><p class="cl-fc54a2b4"><span class="cl-fc509355">83 (51.6)</span></p></td><td class="cl-fc54c3f3"><p class="cl-fc54a2b4"><span class="cl-fc509355">60 (37.3)</span></p></td><td class="cl-fc54c3f3"><p class="cl-fc54a2b4"><span class="cl-fc509355">18 (11.2)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-fc54c3f3"><p class="cl-fc54a2b4"><span class="cl-fc509355"></span></p></td><td class="cl-fc54c3f4"><p class="cl-fc54a2b4"><span class="cl-fc509355">2020</span></p></td><td class="cl-fc54c3f3"><p class="cl-fc54a2b4"><span class="cl-fc509355">82 (59.9)</span></p></td><td class="cl-fc54c3f3"><p class="cl-fc54a2b4"><span class="cl-fc509355">44 (32.1)</span></p></td><td class="cl-fc54c3f3"><p class="cl-fc54a2b4"><span class="cl-fc509355">11 (8)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-fc54c3f3"><p class="cl-fc54a2b4"><span class="cl-fc509355"></span></p></td><td class="cl-fc54c3f4"><p class="cl-fc54a2b4"><span class="cl-fc509355">2021</span></p></td><td class="cl-fc54c3f3"><p class="cl-fc54a2b4"><span class="cl-fc509355">223 (84.8)</span></p></td><td class="cl-fc54c3f3"><p class="cl-fc54a2b4"><span class="cl-fc509355">34 (12.9)</span></p></td><td class="cl-fc54c3f3"><p class="cl-fc54a2b4"><span class="cl-fc509355">6 (2.3)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-fc54c3f3"><p class="cl-fc54a2b4"><span class="cl-fc509355"></span></p></td><td class="cl-fc54c3f4"><p class="cl-fc54a2b4"><span class="cl-fc509355">2022</span></p></td><td class="cl-fc54c3f3"><p class="cl-fc54a2b4"><span class="cl-fc509355">88 (73.3)</span></p></td><td class="cl-fc54c3f3"><p class="cl-fc54a2b4"><span class="cl-fc509355">25 (20.8)</span></p></td><td class="cl-fc54c3f3"><p class="cl-fc54a2b4"><span class="cl-fc509355">7 (5.8)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-fc54c3f3"><p class="cl-fc54a2b4"><span class="cl-fc509355"></span></p></td><td class="cl-fc54c3f4"><p class="cl-fc54a2b4"><span class="cl-fc509355">2023</span></p></td><td class="cl-fc54c3f3"><p class="cl-fc54a2b4"><span class="cl-fc509355">87 (51.2)</span></p></td><td class="cl-fc54c3f3"><p class="cl-fc54a2b4"><span class="cl-fc509355">63 (37.1)</span></p></td><td class="cl-fc54c3f3"><p class="cl-fc54a2b4"><span class="cl-fc509355">20 (11.8)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-fc54c3f3"><p class="cl-fc54a2b4"><span class="cl-fc509355"></span></p></td><td class="cl-fc54c3f4"><p class="cl-fc54a2b4"><span class="cl-fc509355">2024</span></p></td><td class="cl-fc54c3f3"><p class="cl-fc54a2b4"><span class="cl-fc509355">74 (60.7)</span></p></td><td class="cl-fc54c3f3"><p class="cl-fc54a2b4"><span class="cl-fc509355">39 (32)</span></p></td><td class="cl-fc54c3f3"><p class="cl-fc54a2b4"><span class="cl-fc509355">9 (7.4)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-fc54c3f3"><p class="cl-fc54a2b4"><span class="cl-fc509355">Quarter</span></p></td><td class="cl-fc54c3f4"><p class="cl-fc54a2b4"><span class="cl-fc509355">1</span></p></td><td class="cl-fc54c3f3"><p class="cl-fc54a2b4"><span class="cl-fc509355">253 (62.8)</span></p></td><td class="cl-fc54c3f3"><p class="cl-fc54a2b4"><span class="cl-fc509355">120 (29.8)</span></p></td><td class="cl-fc54c3f3"><p class="cl-fc54a2b4"><span class="cl-fc509355">30 (7.4)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-fc54c3f3"><p class="cl-fc54a2b4"><span class="cl-fc509355"></span></p></td><td class="cl-fc54c3f4"><p class="cl-fc54a2b4"><span class="cl-fc509355">2</span></p></td><td class="cl-fc54c3f3"><p class="cl-fc54a2b4"><span class="cl-fc509355">220 (58.5)</span></p></td><td class="cl-fc54c3f3"><p class="cl-fc54a2b4"><span class="cl-fc509355">117 (31.1)</span></p></td><td class="cl-fc54c3f3"><p class="cl-fc54a2b4"><span class="cl-fc509355">39 (10.4)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-fc54c3f3"><p class="cl-fc54a2b4"><span class="cl-fc509355"></span></p></td><td class="cl-fc54c3f4"><p class="cl-fc54a2b4"><span class="cl-fc509355">3</span></p></td><td class="cl-fc54c3f3"><p class="cl-fc54a2b4"><span class="cl-fc509355">295 (63.2)</span></p></td><td class="cl-fc54c3f3"><p class="cl-fc54a2b4"><span class="cl-fc509355">139 (29.8)</span></p></td><td class="cl-fc54c3f3"><p class="cl-fc54a2b4"><span class="cl-fc509355">33 (7.1)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-fc54c3f3"><p class="cl-fc54a2b4"><span class="cl-fc509355"></span></p></td><td class="cl-fc54c3f4"><p class="cl-fc54a2b4"><span class="cl-fc509355">4</span></p></td><td class="cl-fc54c3f3"><p class="cl-fc54a2b4"><span class="cl-fc509355">187 (60.9)</span></p></td><td class="cl-fc54c3f3"><p class="cl-fc54a2b4"><span class="cl-fc509355">96 (31.3)</span></p></td><td class="cl-fc54c3f3"><p class="cl-fc54a2b4"><span class="cl-fc509355">24 (7.8)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-fc54c3f3"><p class="cl-fc54a2b4"><span class="cl-fc509355">Weekday</span></p></td><td class="cl-fc54c3f4"><p class="cl-fc54a2b4"><span class="cl-fc509355">Friday</span></p></td><td class="cl-fc54c3f3"><p class="cl-fc54a2b4"><span class="cl-fc509355">141 (78.3)</span></p></td><td class="cl-fc54c3f3"><p class="cl-fc54a2b4"><span class="cl-fc509355">31 (17.2)</span></p></td><td class="cl-fc54c3f3"><p class="cl-fc54a2b4"><span class="cl-fc509355">8 (4.4)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-fc54c3f3"><p class="cl-fc54a2b4"><span class="cl-fc509355"></span></p></td><td class="cl-fc54c3f4"><p class="cl-fc54a2b4"><span class="cl-fc509355">Monday</span></p></td><td class="cl-fc54c3f3"><p class="cl-fc54a2b4"><span class="cl-fc509355">114 (64.4)</span></p></td><td class="cl-fc54c3f3"><p class="cl-fc54a2b4"><span class="cl-fc509355">49 (27.7)</span></p></td><td class="cl-fc54c3f3"><p class="cl-fc54a2b4"><span class="cl-fc509355">14 (7.9)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-fc54c3f3"><p class="cl-fc54a2b4"><span class="cl-fc509355"></span></p></td><td class="cl-fc54c3f4"><p class="cl-fc54a2b4"><span class="cl-fc509355">Saturday</span></p></td><td class="cl-fc54c3f3"><p class="cl-fc54a2b4"><span class="cl-fc509355">160 (63.2)</span></p></td><td class="cl-fc54c3f3"><p class="cl-fc54a2b4"><span class="cl-fc509355">81 (32)</span></p></td><td class="cl-fc54c3f3"><p class="cl-fc54a2b4"><span class="cl-fc509355">12 (4.7)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-fc54c3f3"><p class="cl-fc54a2b4"><span class="cl-fc509355"></span></p></td><td class="cl-fc54c3f4"><p class="cl-fc54a2b4"><span class="cl-fc509355">Sunday</span></p></td><td class="cl-fc54c3f3"><p class="cl-fc54a2b4"><span class="cl-fc509355">156 (56.3)</span></p></td><td class="cl-fc54c3f3"><p class="cl-fc54a2b4"><span class="cl-fc509355">100 (36.1)</span></p></td><td class="cl-fc54c3f3"><p class="cl-fc54a2b4"><span class="cl-fc509355">21 (7.6)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-fc54c3f3"><p class="cl-fc54a2b4"><span class="cl-fc509355"></span></p></td><td class="cl-fc54c3f4"><p class="cl-fc54a2b4"><span class="cl-fc509355">Thursday</span></p></td><td class="cl-fc54c3f3"><p class="cl-fc54a2b4"><span class="cl-fc509355">167 (66)</span></p></td><td class="cl-fc54c3f3"><p class="cl-fc54a2b4"><span class="cl-fc509355">66 (26.1)</span></p></td><td class="cl-fc54c3f3"><p class="cl-fc54a2b4"><span class="cl-fc509355">20 (7.9)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-fc54c3f3"><p class="cl-fc54a2b4"><span class="cl-fc509355"></span></p></td><td class="cl-fc54c3f4"><p class="cl-fc54a2b4"><span class="cl-fc509355">Tuesday</span></p></td><td class="cl-fc54c3f3"><p class="cl-fc54a2b4"><span class="cl-fc509355">108 (65.5)</span></p></td><td class="cl-fc54c3f3"><p class="cl-fc54a2b4"><span class="cl-fc509355">43 (26.1)</span></p></td><td class="cl-fc54c3f3"><p class="cl-fc54a2b4"><span class="cl-fc509355">14 (8.5)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-fc54c3f5"><p class="cl-fc54a2b4"><span class="cl-fc509355"></span></p></td><td class="cl-fc54c3fc"><p class="cl-fc54a2b4"><span class="cl-fc509355">Wednesday</span></p></td><td class="cl-fc54c3f5"><p class="cl-fc54a2b4"><span class="cl-fc509355">109 (44)</span></p></td><td class="cl-fc54c3f5"><p class="cl-fc54a2b4"><span class="cl-fc509355">102 (41.1)</span></p></td><td class="cl-fc54c3f5"><p class="cl-fc54a2b4"><span class="cl-fc509355">37 (14.9)</span></p></td></tr></tbody><tfoot><tr style="overflow-wrap:break-word;"><td colspan="5" class="cl-fc54c3ff"><p class="cl-fc54a2be"><span class="cl-fc50935e">·µÉ</span><span class="cl-fc509355">Vaccination proportions were calculated row-wise (i.e., by row).</span></p></td></tr></tfoot></table></div>
</div>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="co"># .................. Clean up ..................</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(tab_age, tab_sex, tab_marital_status, tab_year, tab_quarter, tab_weekday, </span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>   tab_combined, ft_vacc_summary, totals, create_tab)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="remove-all-lines" class="level2" data-number="1.5">
<h2 data-number="1.5" class="anchored" data-anchor-id="remove-all-lines"><span class="header-section-number">1.5</span> <strong>5. Remove All Lines</strong></h2>
<p>This version <strong>removes all border lines</strong> for a minimalist, text-friendly table.</p>
<p>‚ú® <em>Why this helps</em>: It improves visual integration in Word documents or printed reports where borders may clutter formatting.</p>
<p>üîç <em>Ideal for</em>: Inline reporting, Word exports, or journal submissions requiring custom styling.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ------------5. Lines: remove all lines -------------------------------------------</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a><span class="co"># .................. Convert grouping vars to character ..................</span></span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>vacc_1524 <span class="ot">&lt;-</span> vacc_1524 <span class="sc">%&gt;%</span></span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">c</span>(age_group, gender, marital_status,</span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a>                  vacc_service_year, vacc_quarter, vacc_weekday), as.character))</span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a><span class="co"># .................. Table generation function with Missing ..................</span></span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a>create_tab <span class="ot">&lt;-</span> <span class="cf">function</span>(data, var, label) {</span>
<span id="cb21-11"><a href="#cb21-11" aria-hidden="true" tabindex="-1"></a>  tab_main <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span></span>
<span id="cb21-12"><a href="#cb21-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>({{ var }})) <span class="sc">%&gt;%</span></span>
<span id="cb21-13"><a href="#cb21-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tabyl</span>({{ var }}, vacc_group3) <span class="sc">%&gt;%</span></span>
<span id="cb21-14"><a href="#cb21-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">Category =</span> label, <span class="at">.before =</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb21-15"><a href="#cb21-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rename</span>(<span class="at">Label =</span> {{ var }}) <span class="sc">%&gt;%</span></span>
<span id="cb21-16"><a href="#cb21-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">Label =</span> <span class="fu">as.character</span>(Label))</span>
<span id="cb21-17"><a href="#cb21-17" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb21-18"><a href="#cb21-18" aria-hidden="true" tabindex="-1"></a>  na_count <span class="ot">&lt;-</span> <span class="fu">sum</span>(<span class="fu">is.na</span>(<span class="fu">pull</span>(data, {{ var }})))</span>
<span id="cb21-19"><a href="#cb21-19" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb21-20"><a href="#cb21-20" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (na_count <span class="sc">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb21-21"><a href="#cb21-21" aria-hidden="true" tabindex="-1"></a>    missing_row <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb21-22"><a href="#cb21-22" aria-hidden="true" tabindex="-1"></a>      <span class="at">Category =</span> label,</span>
<span id="cb21-23"><a href="#cb21-23" aria-hidden="true" tabindex="-1"></a>      <span class="at">Label =</span> <span class="st">"Missing"</span>,</span>
<span id="cb21-24"><a href="#cb21-24" aria-hidden="true" tabindex="-1"></a>      <span class="st">`</span><span class="at">Respiratory vaccines</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">sum</span>(data<span class="sc">$</span>vacc_group3 <span class="sc">==</span> <span class="st">"Respiratory vaccines"</span> <span class="sc">&amp;</span> <span class="fu">is.na</span>(<span class="fu">pull</span>(data, {{ var }})), <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb21-25"><a href="#cb21-25" aria-hidden="true" tabindex="-1"></a>      <span class="st">`</span><span class="at">Childhood vaccines</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">sum</span>(data<span class="sc">$</span>vacc_group3 <span class="sc">==</span> <span class="st">"Childhood vaccines"</span> <span class="sc">&amp;</span> <span class="fu">is.na</span>(<span class="fu">pull</span>(data, {{ var }})), <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb21-26"><a href="#cb21-26" aria-hidden="true" tabindex="-1"></a>      <span class="at">Other =</span> <span class="fu">sum</span>(data<span class="sc">$</span>vacc_group3 <span class="sc">==</span> <span class="st">"Other"</span> <span class="sc">&amp;</span> <span class="fu">is.na</span>(<span class="fu">pull</span>(data, {{ var }})), <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb21-27"><a href="#cb21-27" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb21-28"><a href="#cb21-28" aria-hidden="true" tabindex="-1"></a>    tab_final <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(tab_main, missing_row)</span>
<span id="cb21-29"><a href="#cb21-29" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb21-30"><a href="#cb21-30" aria-hidden="true" tabindex="-1"></a>    tab_final <span class="ot">&lt;-</span> tab_main</span>
<span id="cb21-31"><a href="#cb21-31" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb21-32"><a href="#cb21-32" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb21-33"><a href="#cb21-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(tab_final)</span>
<span id="cb21-34"><a href="#cb21-34" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb21-35"><a href="#cb21-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-36"><a href="#cb21-36" aria-hidden="true" tabindex="-1"></a><span class="co"># .................. Create summary tables ..................</span></span>
<span id="cb21-37"><a href="#cb21-37" aria-hidden="true" tabindex="-1"></a>tab_age            <span class="ot">&lt;-</span> <span class="fu">create_tab</span>(vacc_1524, age_group, <span class="st">"Age"</span>)</span>
<span id="cb21-38"><a href="#cb21-38" aria-hidden="true" tabindex="-1"></a>tab_sex            <span class="ot">&lt;-</span> <span class="fu">create_tab</span>(vacc_1524, gender, <span class="st">"Gender"</span>)</span>
<span id="cb21-39"><a href="#cb21-39" aria-hidden="true" tabindex="-1"></a>tab_marital_status <span class="ot">&lt;-</span> <span class="fu">create_tab</span>(vacc_1524, marital_status, <span class="st">"Marital status"</span>)</span>
<span id="cb21-40"><a href="#cb21-40" aria-hidden="true" tabindex="-1"></a>tab_year           <span class="ot">&lt;-</span> <span class="fu">create_tab</span>(vacc_1524, vacc_service_year, <span class="st">"Year"</span>)</span>
<span id="cb21-41"><a href="#cb21-41" aria-hidden="true" tabindex="-1"></a>tab_quarter        <span class="ot">&lt;-</span> <span class="fu">create_tab</span>(vacc_1524, vacc_quarter, <span class="st">"Quarter"</span>)</span>
<span id="cb21-42"><a href="#cb21-42" aria-hidden="true" tabindex="-1"></a>tab_weekday        <span class="ot">&lt;-</span> <span class="fu">create_tab</span>(vacc_1524, vacc_weekday, <span class="st">"Weekday"</span>)</span>
<span id="cb21-43"><a href="#cb21-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-44"><a href="#cb21-44" aria-hidden="true" tabindex="-1"></a><span class="co"># .................. Combine all tables ..................</span></span>
<span id="cb21-45"><a href="#cb21-45" aria-hidden="true" tabindex="-1"></a>tab_combined <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(tab_sex, tab_age, tab_marital_status, tab_year, tab_quarter, tab_weekday)</span>
<span id="cb21-46"><a href="#cb21-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-47"><a href="#cb21-47" aria-hidden="true" tabindex="-1"></a><span class="co"># .................. Calculate row-wise percentages (skip for Missing) ..................</span></span>
<span id="cb21-48"><a href="#cb21-48" aria-hidden="true" tabindex="-1"></a>tab_combined <span class="ot">&lt;-</span> tab_combined <span class="sc">%&gt;%</span></span>
<span id="cb21-49"><a href="#cb21-49" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rowwise</span>() <span class="sc">%&gt;%</span></span>
<span id="cb21-50"><a href="#cb21-50" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb21-51"><a href="#cb21-51" aria-hidden="true" tabindex="-1"></a>    <span class="at">Total =</span> <span class="fu">sum</span>(<span class="st">`</span><span class="at">Respiratory vaccines</span><span class="st">`</span>, <span class="st">`</span><span class="at">Childhood vaccines</span><span class="st">`</span>, Other, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb21-52"><a href="#cb21-52" aria-hidden="true" tabindex="-1"></a>    <span class="at">is_missing =</span> <span class="fu">trimws</span>(<span class="fu">tolower</span>(Label)) <span class="sc">==</span> <span class="st">"missing"</span>,</span>
<span id="cb21-53"><a href="#cb21-53" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb21-54"><a href="#cb21-54" aria-hidden="true" tabindex="-1"></a>    <span class="at">Respiratory =</span> <span class="fu">ifelse</span>(is_missing,</span>
<span id="cb21-55"><a href="#cb21-55" aria-hidden="true" tabindex="-1"></a>                         <span class="fu">comma</span>(<span class="st">`</span><span class="at">Respiratory vaccines</span><span class="st">`</span>),</span>
<span id="cb21-56"><a href="#cb21-56" aria-hidden="true" tabindex="-1"></a>                         <span class="fu">paste0</span>(<span class="fu">comma</span>(<span class="st">`</span><span class="at">Respiratory vaccines</span><span class="st">`</span>), <span class="st">" ("</span>, <span class="fu">round</span>(<span class="dv">100</span> <span class="sc">*</span> <span class="st">`</span><span class="at">Respiratory vaccines</span><span class="st">`</span> <span class="sc">/</span> Total, <span class="dv">1</span>), <span class="st">")"</span>)),</span>
<span id="cb21-57"><a href="#cb21-57" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb21-58"><a href="#cb21-58" aria-hidden="true" tabindex="-1"></a>    <span class="at">Childhood =</span> <span class="fu">ifelse</span>(is_missing,</span>
<span id="cb21-59"><a href="#cb21-59" aria-hidden="true" tabindex="-1"></a>                       <span class="fu">comma</span>(<span class="st">`</span><span class="at">Childhood vaccines</span><span class="st">`</span>),</span>
<span id="cb21-60"><a href="#cb21-60" aria-hidden="true" tabindex="-1"></a>                       <span class="fu">paste0</span>(<span class="fu">comma</span>(<span class="st">`</span><span class="at">Childhood vaccines</span><span class="st">`</span>), <span class="st">" ("</span>, <span class="fu">round</span>(<span class="dv">100</span> <span class="sc">*</span> <span class="st">`</span><span class="at">Childhood vaccines</span><span class="st">`</span> <span class="sc">/</span> Total, <span class="dv">1</span>), <span class="st">")"</span>)),</span>
<span id="cb21-61"><a href="#cb21-61" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb21-62"><a href="#cb21-62" aria-hidden="true" tabindex="-1"></a>    <span class="at">Other_grp =</span> <span class="fu">ifelse</span>(is_missing,</span>
<span id="cb21-63"><a href="#cb21-63" aria-hidden="true" tabindex="-1"></a>                       <span class="fu">comma</span>(Other),</span>
<span id="cb21-64"><a href="#cb21-64" aria-hidden="true" tabindex="-1"></a>                       <span class="fu">paste0</span>(<span class="fu">comma</span>(Other), <span class="st">" ("</span>, <span class="fu">round</span>(<span class="dv">100</span> <span class="sc">*</span> Other <span class="sc">/</span> Total, <span class="dv">1</span>), <span class="st">")"</span>))</span>
<span id="cb21-65"><a href="#cb21-65" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb21-66"><a href="#cb21-66" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb21-67"><a href="#cb21-67" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Category, Label, Respiratory, Childhood, Other_grp)</span>
<span id="cb21-68"><a href="#cb21-68" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-69"><a href="#cb21-69" aria-hidden="true" tabindex="-1"></a><span class="co"># .................. Show Category only once per group ..................</span></span>
<span id="cb21-70"><a href="#cb21-70" aria-hidden="true" tabindex="-1"></a>tab_combined <span class="ot">&lt;-</span> tab_combined <span class="sc">%&gt;%</span></span>
<span id="cb21-71"><a href="#cb21-71" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Category) <span class="sc">%&gt;%</span></span>
<span id="cb21-72"><a href="#cb21-72" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Category =</span> <span class="fu">ifelse</span>(<span class="fu">row_number</span>() <span class="sc">==</span> <span class="dv">1</span>, Category, <span class="st">""</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb21-73"><a href="#cb21-73" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb21-74"><a href="#cb21-74" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-75"><a href="#cb21-75" aria-hidden="true" tabindex="-1"></a><span class="co"># .................. Get total counts per vaccine group ..................</span></span>
<span id="cb21-76"><a href="#cb21-76" aria-hidden="true" tabindex="-1"></a>totals <span class="ot">&lt;-</span> vacc_1524 <span class="sc">%&gt;%</span></span>
<span id="cb21-77"><a href="#cb21-77" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(vacc_group3) <span class="sc">%&gt;%</span></span>
<span id="cb21-78"><a href="#cb21-78" aria-hidden="true" tabindex="-1"></a>  <span class="fu">deframe</span>()</span>
<span id="cb21-79"><a href="#cb21-79" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-80"><a href="#cb21-80" aria-hidden="true" tabindex="-1"></a><span class="co"># .................. Create flextable ..................</span></span>
<span id="cb21-81"><a href="#cb21-81" aria-hidden="true" tabindex="-1"></a>ft_vacc_summary <span class="ot">&lt;-</span> tab_combined <span class="sc">%&gt;%</span></span>
<span id="cb21-82"><a href="#cb21-82" aria-hidden="true" tabindex="-1"></a>  <span class="fu">flextable</span>() <span class="sc">%&gt;%</span></span>
<span id="cb21-83"><a href="#cb21-83" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_header_labels</span>(</span>
<span id="cb21-84"><a href="#cb21-84" aria-hidden="true" tabindex="-1"></a>    <span class="at">Category =</span> <span class="st">"Variable type"</span>,</span>
<span id="cb21-85"><a href="#cb21-85" aria-hidden="true" tabindex="-1"></a>    <span class="at">Label =</span> <span class="st">"Values"</span>,</span>
<span id="cb21-86"><a href="#cb21-86" aria-hidden="true" tabindex="-1"></a>    <span class="at">Respiratory =</span> <span class="st">"Number (%)·µÉ"</span>,</span>
<span id="cb21-87"><a href="#cb21-87" aria-hidden="true" tabindex="-1"></a>    <span class="at">Childhood =</span> <span class="st">"Number (%)·µÉ"</span>,</span>
<span id="cb21-88"><a href="#cb21-88" aria-hidden="true" tabindex="-1"></a>    <span class="at">Other_grp =</span> <span class="st">"Number (%)·µÉ"</span></span>
<span id="cb21-89"><a href="#cb21-89" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb21-90"><a href="#cb21-90" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_header_row</span>(</span>
<span id="cb21-91"><a href="#cb21-91" aria-hidden="true" tabindex="-1"></a>    <span class="at">values =</span> <span class="fu">c</span>(</span>
<span id="cb21-92"><a href="#cb21-92" aria-hidden="true" tabindex="-1"></a>      <span class="st">""</span>, <span class="st">""</span>,</span>
<span id="cb21-93"><a href="#cb21-93" aria-hidden="true" tabindex="-1"></a>      <span class="fu">paste0</span>(<span class="st">"Respiratory vaccines (N = "</span>, <span class="fu">format</span>(totals[<span class="st">"Respiratory vaccines"</span>], <span class="at">big.mark =</span> <span class="st">","</span>), <span class="st">")"</span>),</span>
<span id="cb21-94"><a href="#cb21-94" aria-hidden="true" tabindex="-1"></a>      <span class="fu">paste0</span>(<span class="st">"Childhood vaccines (N = "</span>, <span class="fu">format</span>(totals[<span class="st">"Childhood vaccines"</span>], <span class="at">big.mark =</span> <span class="st">","</span>), <span class="st">")"</span>),</span>
<span id="cb21-95"><a href="#cb21-95" aria-hidden="true" tabindex="-1"></a>      <span class="fu">paste0</span>(<span class="st">"Other (N = "</span>, <span class="fu">format</span>(totals[<span class="st">"Other"</span>], <span class="at">big.mark =</span> <span class="st">","</span>), <span class="st">")"</span>)</span>
<span id="cb21-96"><a href="#cb21-96" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb21-97"><a href="#cb21-97" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb21-98"><a href="#cb21-98" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_header_row</span>(</span>
<span id="cb21-99"><a href="#cb21-99" aria-hidden="true" tabindex="-1"></a>    <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"Description"</span>, <span class="st">"Vaccination uptake"</span>),</span>
<span id="cb21-100"><a href="#cb21-100" aria-hidden="true" tabindex="-1"></a>    <span class="at">colwidths =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">3</span>)</span>
<span id="cb21-101"><a href="#cb21-101" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb21-102"><a href="#cb21-102" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_box</span>() <span class="sc">%&gt;%</span></span>
<span id="cb21-103"><a href="#cb21-103" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_table_properties</span>(<span class="at">layout =</span> <span class="st">"autofit"</span>, <span class="at">width =</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb21-104"><a href="#cb21-104" aria-hidden="true" tabindex="-1"></a>  <span class="fu">width</span>(<span class="at">j =</span> <span class="dv">1</span>, <span class="at">width =</span> <span class="fl">1.5</span>) <span class="sc">%&gt;%</span></span>
<span id="cb21-105"><a href="#cb21-105" aria-hidden="true" tabindex="-1"></a>  <span class="fu">width</span>(<span class="at">j =</span> <span class="dv">2</span>, <span class="at">width =</span> <span class="fl">2.5</span>) <span class="sc">%&gt;%</span></span>
<span id="cb21-106"><a href="#cb21-106" aria-hidden="true" tabindex="-1"></a>  <span class="fu">width</span>(<span class="at">j =</span> <span class="dv">3</span><span class="sc">:</span><span class="dv">5</span>, <span class="at">width =</span> <span class="fl">1.5</span>) <span class="sc">%&gt;%</span></span>
<span id="cb21-107"><a href="#cb21-107" aria-hidden="true" tabindex="-1"></a>  <span class="fu">align</span>(<span class="at">align =</span> <span class="st">"justify"</span>, <span class="at">part =</span> <span class="st">"all"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb21-108"><a href="#cb21-108" aria-hidden="true" tabindex="-1"></a>  <span class="fu">border_remove</span>() <span class="sc">%&gt;%</span></span>
<span id="cb21-109"><a href="#cb21-109" aria-hidden="true" tabindex="-1"></a>  <span class="co">#  border_inner_h(border = fp_border(color = "black", width = 1)) %&gt;%</span></span>
<span id="cb21-110"><a href="#cb21-110" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_caption</span>(<span class="st">"Table: Vaccination uptake across service year, quarter, and weekday"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb21-111"><a href="#cb21-111" aria-hidden="true" tabindex="-1"></a>  <span class="fu">footnote</span>(<span class="at">i =</span> <span class="dv">1</span>, </span>
<span id="cb21-112"><a href="#cb21-112" aria-hidden="true" tabindex="-1"></a>           <span class="at">value =</span> <span class="fu">as_paragraph</span>(<span class="st">"Vaccination proportions were calculated row-wise (i.e., by row)."</span>),</span>
<span id="cb21-113"><a href="#cb21-113" aria-hidden="true" tabindex="-1"></a>           <span class="at">ref_symbols =</span> <span class="st">"·µÉ"</span>, </span>
<span id="cb21-114"><a href="#cb21-114" aria-hidden="true" tabindex="-1"></a>           <span class="at">part =</span> <span class="st">"header"</span>)</span>
<span id="cb21-115"><a href="#cb21-115" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-116"><a href="#cb21-116" aria-hidden="true" tabindex="-1"></a><span class="co"># .................. Show the table ..................</span></span>
<span id="cb21-117"><a href="#cb21-117" aria-hidden="true" tabindex="-1"></a>ft_vacc_summary</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="tabwid"><style>.cl-fca2158a{table-layout:auto;width:100%;}.cl-fc98c250{font-family:'Arial';font-size:11pt;font-weight:bold;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-fc98c25a{font-family:'Arial';font-size:6.6pt;font-weight:bold;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;position: relative;bottom:3.3pt;}.cl-fc98c25b{font-family:'Arial';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-fc98c264{font-family:'Arial';font-size:6.6pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;position: relative;bottom:3.3pt;}.cl-fc9cc666{margin:0;text-align:justify;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-fc9cc670{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-fc9cec04{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-fc9cec0e{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-fc9cec0f{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(255, 255, 255, 0.00);border-top: 0 solid rgba(255, 255, 255, 0.00);border-left: 0 solid rgba(255, 255, 255, 0.00);border-right: 0 solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-fc9cec10{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(255, 255, 255, 0.00);border-top: 0 solid rgba(255, 255, 255, 0.00);border-left: 0 solid rgba(255, 255, 255, 0.00);border-right: 0 solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table data-quarto-disable-processing="true" class="cl-fca2158a"><thead><tr style="overflow-wrap:break-word;"><th colspan="2" class="cl-fc9cec04"><p class="cl-fc9cc666"><span class="cl-fc98c250">Description</span><span class="cl-fc98c25a">·µÉ</span></p></th><th colspan="3" class="cl-fc9cec04"><p class="cl-fc9cc666"><span class="cl-fc98c250">Vaccination uptake</span><span class="cl-fc98c25a">·µÉ</span></p></th></tr><tr style="overflow-wrap:break-word;"><th class="cl-fc9cec04"><p class="cl-fc9cc666"><span class="cl-fc98c250"></span></p></th><th class="cl-fc9cec0e"><p class="cl-fc9cc666"><span class="cl-fc98c250"></span></p></th><th class="cl-fc9cec04"><p class="cl-fc9cc666"><span class="cl-fc98c250">Respiratory vaccines (N = 955)</span></p></th><th class="cl-fc9cec04"><p class="cl-fc9cc666"><span class="cl-fc98c250">Childhood vaccines (N = 472)</span></p></th><th class="cl-fc9cec04"><p class="cl-fc9cc666"><span class="cl-fc98c250">Other (N = 126)</span></p></th></tr><tr style="overflow-wrap:break-word;"><th class="cl-fc9cec04"><p class="cl-fc9cc666"><span class="cl-fc98c250">Variable type</span></p></th><th class="cl-fc9cec0e"><p class="cl-fc9cc666"><span class="cl-fc98c250">Values</span></p></th><th class="cl-fc9cec04"><p class="cl-fc9cc666"><span class="cl-fc98c250">Number (%)·µÉ</span></p></th><th class="cl-fc9cec04"><p class="cl-fc9cc666"><span class="cl-fc98c250">Number (%)·µÉ</span></p></th><th class="cl-fc9cec04"><p class="cl-fc9cc666"><span class="cl-fc98c250">Number (%)·µÉ</span></p></th></tr></thead><tbody><tr style="overflow-wrap:break-word;"><td class="cl-fc9cec04"><p class="cl-fc9cc666"><span class="cl-fc98c25b">Gender</span></p></td><td class="cl-fc9cec0e"><p class="cl-fc9cc666"><span class="cl-fc98c25b">Female</span></p></td><td class="cl-fc9cec04"><p class="cl-fc9cc666"><span class="cl-fc98c25b">511 (64)</span></p></td><td class="cl-fc9cec04"><p class="cl-fc9cc666"><span class="cl-fc98c25b">233 (29.2)</span></p></td><td class="cl-fc9cec04"><p class="cl-fc9cc666"><span class="cl-fc98c25b">54 (6.8)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-fc9cec04"><p class="cl-fc9cc666"><span class="cl-fc98c25b"></span></p></td><td class="cl-fc9cec0e"><p class="cl-fc9cc666"><span class="cl-fc98c25b">Male</span></p></td><td class="cl-fc9cec04"><p class="cl-fc9cc666"><span class="cl-fc98c25b">444 (58.8)</span></p></td><td class="cl-fc9cec04"><p class="cl-fc9cc666"><span class="cl-fc98c25b">239 (31.7)</span></p></td><td class="cl-fc9cec04"><p class="cl-fc9cc666"><span class="cl-fc98c25b">72 (9.5)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-fc9cec04"><p class="cl-fc9cc666"><span class="cl-fc98c25b">Age</span></p></td><td class="cl-fc9cec0e"><p class="cl-fc9cc666"><span class="cl-fc98c25b">0-19</span></p></td><td class="cl-fc9cec04"><p class="cl-fc9cc666"><span class="cl-fc98c25b">250 (38.9)</span></p></td><td class="cl-fc9cec04"><p class="cl-fc9cc666"><span class="cl-fc98c25b">302 (47)</span></p></td><td class="cl-fc9cec04"><p class="cl-fc9cc666"><span class="cl-fc98c25b">90 (14)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-fc9cec04"><p class="cl-fc9cc666"><span class="cl-fc98c25b"></span></p></td><td class="cl-fc9cec0e"><p class="cl-fc9cc666"><span class="cl-fc98c25b">20-29</span></p></td><td class="cl-fc9cec04"><p class="cl-fc9cc666"><span class="cl-fc98c25b">150 (68.2)</span></p></td><td class="cl-fc9cec04"><p class="cl-fc9cc666"><span class="cl-fc98c25b">70 (31.8)</span></p></td><td class="cl-fc9cec04"><p class="cl-fc9cc666"><span class="cl-fc98c25b">0 (0)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-fc9cec04"><p class="cl-fc9cc666"><span class="cl-fc98c25b"></span></p></td><td class="cl-fc9cec0e"><p class="cl-fc9cc666"><span class="cl-fc98c25b">30-39</span></p></td><td class="cl-fc9cec04"><p class="cl-fc9cc666"><span class="cl-fc98c25b">47 (71.2)</span></p></td><td class="cl-fc9cec04"><p class="cl-fc9cc666"><span class="cl-fc98c25b">19 (28.8)</span></p></td><td class="cl-fc9cec04"><p class="cl-fc9cc666"><span class="cl-fc98c25b">0 (0)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-fc9cec04"><p class="cl-fc9cc666"><span class="cl-fc98c25b"></span></p></td><td class="cl-fc9cec0e"><p class="cl-fc9cc666"><span class="cl-fc98c25b">40-49</span></p></td><td class="cl-fc9cec04"><p class="cl-fc9cc666"><span class="cl-fc98c25b">142 (75.9)</span></p></td><td class="cl-fc9cec04"><p class="cl-fc9cc666"><span class="cl-fc98c25b">45 (24.1)</span></p></td><td class="cl-fc9cec04"><p class="cl-fc9cc666"><span class="cl-fc98c25b">0 (0)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-fc9cec04"><p class="cl-fc9cc666"><span class="cl-fc98c25b"></span></p></td><td class="cl-fc9cec0e"><p class="cl-fc9cc666"><span class="cl-fc98c25b">50-59</span></p></td><td class="cl-fc9cec04"><p class="cl-fc9cc666"><span class="cl-fc98c25b">112 (77.8)</span></p></td><td class="cl-fc9cec04"><p class="cl-fc9cc666"><span class="cl-fc98c25b">14 (9.7)</span></p></td><td class="cl-fc9cec04"><p class="cl-fc9cc666"><span class="cl-fc98c25b">18 (12.5)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-fc9cec04"><p class="cl-fc9cc666"><span class="cl-fc98c25b"></span></p></td><td class="cl-fc9cec0e"><p class="cl-fc9cc666"><span class="cl-fc98c25b">60-69</span></p></td><td class="cl-fc9cec04"><p class="cl-fc9cc666"><span class="cl-fc98c25b">149 (87.6)</span></p></td><td class="cl-fc9cec04"><p class="cl-fc9cc666"><span class="cl-fc98c25b">13 (7.6)</span></p></td><td class="cl-fc9cec04"><p class="cl-fc9cc666"><span class="cl-fc98c25b">8 (4.7)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-fc9cec04"><p class="cl-fc9cc666"><span class="cl-fc98c25b"></span></p></td><td class="cl-fc9cec0e"><p class="cl-fc9cc666"><span class="cl-fc98c25b">70+</span></p></td><td class="cl-fc9cec04"><p class="cl-fc9cc666"><span class="cl-fc98c25b">105 (84.7)</span></p></td><td class="cl-fc9cec04"><p class="cl-fc9cc666"><span class="cl-fc98c25b">9 (7.3)</span></p></td><td class="cl-fc9cec04"><p class="cl-fc9cc666"><span class="cl-fc98c25b">10 (8.1)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-fc9cec04"><p class="cl-fc9cc666"><span class="cl-fc98c25b">Marital status</span></p></td><td class="cl-fc9cec0e"><p class="cl-fc9cc666"><span class="cl-fc98c25b">Divorced</span></p></td><td class="cl-fc9cec04"><p class="cl-fc9cc666"><span class="cl-fc98c25b">136 (83.4)</span></p></td><td class="cl-fc9cec04"><p class="cl-fc9cc666"><span class="cl-fc98c25b">15 (9.2)</span></p></td><td class="cl-fc9cec04"><p class="cl-fc9cc666"><span class="cl-fc98c25b">12 (7.4)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-fc9cec04"><p class="cl-fc9cc666"><span class="cl-fc98c25b"></span></p></td><td class="cl-fc9cec0e"><p class="cl-fc9cc666"><span class="cl-fc98c25b">Married</span></p></td><td class="cl-fc9cec04"><p class="cl-fc9cc666"><span class="cl-fc98c25b">289 (79)</span></p></td><td class="cl-fc9cec04"><p class="cl-fc9cc666"><span class="cl-fc98c25b">59 (16.1)</span></p></td><td class="cl-fc9cec04"><p class="cl-fc9cc666"><span class="cl-fc98c25b">18 (4.9)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-fc9cec04"><p class="cl-fc9cc666"><span class="cl-fc98c25b"></span></p></td><td class="cl-fc9cec0e"><p class="cl-fc9cc666"><span class="cl-fc98c25b">Single/widowed</span></p></td><td class="cl-fc9cec04"><p class="cl-fc9cc666"><span class="cl-fc98c25b">150 (79.4)</span></p></td><td class="cl-fc9cec04"><p class="cl-fc9cc666"><span class="cl-fc98c25b">33 (17.5)</span></p></td><td class="cl-fc9cec04"><p class="cl-fc9cc666"><span class="cl-fc98c25b">6 (3.2)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-fc9cec04"><p class="cl-fc9cc666"><span class="cl-fc98c25b"></span></p></td><td class="cl-fc9cec0e"><p class="cl-fc9cc666"><span class="cl-fc98c25b">Missing</span></p></td><td class="cl-fc9cec04"><p class="cl-fc9cc666"><span class="cl-fc98c25b">380</span></p></td><td class="cl-fc9cec04"><p class="cl-fc9cc666"><span class="cl-fc98c25b">365</span></p></td><td class="cl-fc9cec04"><p class="cl-fc9cc666"><span class="cl-fc98c25b">90</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-fc9cec04"><p class="cl-fc9cc666"><span class="cl-fc98c25b">Year</span></p></td><td class="cl-fc9cec0e"><p class="cl-fc9cc666"><span class="cl-fc98c25b">2015</span></p></td><td class="cl-fc9cec04"><p class="cl-fc9cc666"><span class="cl-fc98c25b">78 (51)</span></p></td><td class="cl-fc9cec04"><p class="cl-fc9cc666"><span class="cl-fc98c25b">56 (36.6)</span></p></td><td class="cl-fc9cec04"><p class="cl-fc9cc666"><span class="cl-fc98c25b">19 (12.4)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-fc9cec04"><p class="cl-fc9cc666"><span class="cl-fc98c25b"></span></p></td><td class="cl-fc9cec0e"><p class="cl-fc9cc666"><span class="cl-fc98c25b">2016</span></p></td><td class="cl-fc9cec04"><p class="cl-fc9cc666"><span class="cl-fc98c25b">84 (60.4)</span></p></td><td class="cl-fc9cec04"><p class="cl-fc9cc666"><span class="cl-fc98c25b">47 (33.8)</span></p></td><td class="cl-fc9cec04"><p class="cl-fc9cc666"><span class="cl-fc98c25b">8 (5.8)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-fc9cec04"><p class="cl-fc9cc666"><span class="cl-fc98c25b"></span></p></td><td class="cl-fc9cec0e"><p class="cl-fc9cc666"><span class="cl-fc98c25b">2017</span></p></td><td class="cl-fc9cec04"><p class="cl-fc9cc666"><span class="cl-fc98c25b">75 (54.7)</span></p></td><td class="cl-fc9cec04"><p class="cl-fc9cc666"><span class="cl-fc98c25b">52 (38)</span></p></td><td class="cl-fc9cec04"><p class="cl-fc9cc666"><span class="cl-fc98c25b">10 (7.3)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-fc9cec04"><p class="cl-fc9cc666"><span class="cl-fc98c25b"></span></p></td><td class="cl-fc9cec0e"><p class="cl-fc9cc666"><span class="cl-fc98c25b">2018</span></p></td><td class="cl-fc9cec04"><p class="cl-fc9cc666"><span class="cl-fc98c25b">81 (53.6)</span></p></td><td class="cl-fc9cec04"><p class="cl-fc9cc666"><span class="cl-fc98c25b">52 (34.4)</span></p></td><td class="cl-fc9cec04"><p class="cl-fc9cc666"><span class="cl-fc98c25b">18 (11.9)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-fc9cec04"><p class="cl-fc9cc666"><span class="cl-fc98c25b"></span></p></td><td class="cl-fc9cec0e"><p class="cl-fc9cc666"><span class="cl-fc98c25b">2019</span></p></td><td class="cl-fc9cec04"><p class="cl-fc9cc666"><span class="cl-fc98c25b">83 (51.6)</span></p></td><td class="cl-fc9cec04"><p class="cl-fc9cc666"><span class="cl-fc98c25b">60 (37.3)</span></p></td><td class="cl-fc9cec04"><p class="cl-fc9cc666"><span class="cl-fc98c25b">18 (11.2)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-fc9cec04"><p class="cl-fc9cc666"><span class="cl-fc98c25b"></span></p></td><td class="cl-fc9cec0e"><p class="cl-fc9cc666"><span class="cl-fc98c25b">2020</span></p></td><td class="cl-fc9cec04"><p class="cl-fc9cc666"><span class="cl-fc98c25b">82 (59.9)</span></p></td><td class="cl-fc9cec04"><p class="cl-fc9cc666"><span class="cl-fc98c25b">44 (32.1)</span></p></td><td class="cl-fc9cec04"><p class="cl-fc9cc666"><span class="cl-fc98c25b">11 (8)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-fc9cec04"><p class="cl-fc9cc666"><span class="cl-fc98c25b"></span></p></td><td class="cl-fc9cec0e"><p class="cl-fc9cc666"><span class="cl-fc98c25b">2021</span></p></td><td class="cl-fc9cec04"><p class="cl-fc9cc666"><span class="cl-fc98c25b">223 (84.8)</span></p></td><td class="cl-fc9cec04"><p class="cl-fc9cc666"><span class="cl-fc98c25b">34 (12.9)</span></p></td><td class="cl-fc9cec04"><p class="cl-fc9cc666"><span class="cl-fc98c25b">6 (2.3)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-fc9cec04"><p class="cl-fc9cc666"><span class="cl-fc98c25b"></span></p></td><td class="cl-fc9cec0e"><p class="cl-fc9cc666"><span class="cl-fc98c25b">2022</span></p></td><td class="cl-fc9cec04"><p class="cl-fc9cc666"><span class="cl-fc98c25b">88 (73.3)</span></p></td><td class="cl-fc9cec04"><p class="cl-fc9cc666"><span class="cl-fc98c25b">25 (20.8)</span></p></td><td class="cl-fc9cec04"><p class="cl-fc9cc666"><span class="cl-fc98c25b">7 (5.8)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-fc9cec04"><p class="cl-fc9cc666"><span class="cl-fc98c25b"></span></p></td><td class="cl-fc9cec0e"><p class="cl-fc9cc666"><span class="cl-fc98c25b">2023</span></p></td><td class="cl-fc9cec04"><p class="cl-fc9cc666"><span class="cl-fc98c25b">87 (51.2)</span></p></td><td class="cl-fc9cec04"><p class="cl-fc9cc666"><span class="cl-fc98c25b">63 (37.1)</span></p></td><td class="cl-fc9cec04"><p class="cl-fc9cc666"><span class="cl-fc98c25b">20 (11.8)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-fc9cec04"><p class="cl-fc9cc666"><span class="cl-fc98c25b"></span></p></td><td class="cl-fc9cec0e"><p class="cl-fc9cc666"><span class="cl-fc98c25b">2024</span></p></td><td class="cl-fc9cec04"><p class="cl-fc9cc666"><span class="cl-fc98c25b">74 (60.7)</span></p></td><td class="cl-fc9cec04"><p class="cl-fc9cc666"><span class="cl-fc98c25b">39 (32)</span></p></td><td class="cl-fc9cec04"><p class="cl-fc9cc666"><span class="cl-fc98c25b">9 (7.4)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-fc9cec04"><p class="cl-fc9cc666"><span class="cl-fc98c25b">Quarter</span></p></td><td class="cl-fc9cec0e"><p class="cl-fc9cc666"><span class="cl-fc98c25b">1</span></p></td><td class="cl-fc9cec04"><p class="cl-fc9cc666"><span class="cl-fc98c25b">253 (62.8)</span></p></td><td class="cl-fc9cec04"><p class="cl-fc9cc666"><span class="cl-fc98c25b">120 (29.8)</span></p></td><td class="cl-fc9cec04"><p class="cl-fc9cc666"><span class="cl-fc98c25b">30 (7.4)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-fc9cec04"><p class="cl-fc9cc666"><span class="cl-fc98c25b"></span></p></td><td class="cl-fc9cec0e"><p class="cl-fc9cc666"><span class="cl-fc98c25b">2</span></p></td><td class="cl-fc9cec04"><p class="cl-fc9cc666"><span class="cl-fc98c25b">220 (58.5)</span></p></td><td class="cl-fc9cec04"><p class="cl-fc9cc666"><span class="cl-fc98c25b">117 (31.1)</span></p></td><td class="cl-fc9cec04"><p class="cl-fc9cc666"><span class="cl-fc98c25b">39 (10.4)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-fc9cec04"><p class="cl-fc9cc666"><span class="cl-fc98c25b"></span></p></td><td class="cl-fc9cec0e"><p class="cl-fc9cc666"><span class="cl-fc98c25b">3</span></p></td><td class="cl-fc9cec04"><p class="cl-fc9cc666"><span class="cl-fc98c25b">295 (63.2)</span></p></td><td class="cl-fc9cec04"><p class="cl-fc9cc666"><span class="cl-fc98c25b">139 (29.8)</span></p></td><td class="cl-fc9cec04"><p class="cl-fc9cc666"><span class="cl-fc98c25b">33 (7.1)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-fc9cec04"><p class="cl-fc9cc666"><span class="cl-fc98c25b"></span></p></td><td class="cl-fc9cec0e"><p class="cl-fc9cc666"><span class="cl-fc98c25b">4</span></p></td><td class="cl-fc9cec04"><p class="cl-fc9cc666"><span class="cl-fc98c25b">187 (60.9)</span></p></td><td class="cl-fc9cec04"><p class="cl-fc9cc666"><span class="cl-fc98c25b">96 (31.3)</span></p></td><td class="cl-fc9cec04"><p class="cl-fc9cc666"><span class="cl-fc98c25b">24 (7.8)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-fc9cec04"><p class="cl-fc9cc666"><span class="cl-fc98c25b">Weekday</span></p></td><td class="cl-fc9cec0e"><p class="cl-fc9cc666"><span class="cl-fc98c25b">Friday</span></p></td><td class="cl-fc9cec04"><p class="cl-fc9cc666"><span class="cl-fc98c25b">141 (78.3)</span></p></td><td class="cl-fc9cec04"><p class="cl-fc9cc666"><span class="cl-fc98c25b">31 (17.2)</span></p></td><td class="cl-fc9cec04"><p class="cl-fc9cc666"><span class="cl-fc98c25b">8 (4.4)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-fc9cec04"><p class="cl-fc9cc666"><span class="cl-fc98c25b"></span></p></td><td class="cl-fc9cec0e"><p class="cl-fc9cc666"><span class="cl-fc98c25b">Monday</span></p></td><td class="cl-fc9cec04"><p class="cl-fc9cc666"><span class="cl-fc98c25b">114 (64.4)</span></p></td><td class="cl-fc9cec04"><p class="cl-fc9cc666"><span class="cl-fc98c25b">49 (27.7)</span></p></td><td class="cl-fc9cec04"><p class="cl-fc9cc666"><span class="cl-fc98c25b">14 (7.9)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-fc9cec04"><p class="cl-fc9cc666"><span class="cl-fc98c25b"></span></p></td><td class="cl-fc9cec0e"><p class="cl-fc9cc666"><span class="cl-fc98c25b">Saturday</span></p></td><td class="cl-fc9cec04"><p class="cl-fc9cc666"><span class="cl-fc98c25b">160 (63.2)</span></p></td><td class="cl-fc9cec04"><p class="cl-fc9cc666"><span class="cl-fc98c25b">81 (32)</span></p></td><td class="cl-fc9cec04"><p class="cl-fc9cc666"><span class="cl-fc98c25b">12 (4.7)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-fc9cec04"><p class="cl-fc9cc666"><span class="cl-fc98c25b"></span></p></td><td class="cl-fc9cec0e"><p class="cl-fc9cc666"><span class="cl-fc98c25b">Sunday</span></p></td><td class="cl-fc9cec04"><p class="cl-fc9cc666"><span class="cl-fc98c25b">156 (56.3)</span></p></td><td class="cl-fc9cec04"><p class="cl-fc9cc666"><span class="cl-fc98c25b">100 (36.1)</span></p></td><td class="cl-fc9cec04"><p class="cl-fc9cc666"><span class="cl-fc98c25b">21 (7.6)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-fc9cec04"><p class="cl-fc9cc666"><span class="cl-fc98c25b"></span></p></td><td class="cl-fc9cec0e"><p class="cl-fc9cc666"><span class="cl-fc98c25b">Thursday</span></p></td><td class="cl-fc9cec04"><p class="cl-fc9cc666"><span class="cl-fc98c25b">167 (66)</span></p></td><td class="cl-fc9cec04"><p class="cl-fc9cc666"><span class="cl-fc98c25b">66 (26.1)</span></p></td><td class="cl-fc9cec04"><p class="cl-fc9cc666"><span class="cl-fc98c25b">20 (7.9)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-fc9cec04"><p class="cl-fc9cc666"><span class="cl-fc98c25b"></span></p></td><td class="cl-fc9cec0e"><p class="cl-fc9cc666"><span class="cl-fc98c25b">Tuesday</span></p></td><td class="cl-fc9cec04"><p class="cl-fc9cc666"><span class="cl-fc98c25b">108 (65.5)</span></p></td><td class="cl-fc9cec04"><p class="cl-fc9cc666"><span class="cl-fc98c25b">43 (26.1)</span></p></td><td class="cl-fc9cec04"><p class="cl-fc9cc666"><span class="cl-fc98c25b">14 (8.5)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-fc9cec04"><p class="cl-fc9cc666"><span class="cl-fc98c25b"></span></p></td><td class="cl-fc9cec0e"><p class="cl-fc9cc666"><span class="cl-fc98c25b">Wednesday</span></p></td><td class="cl-fc9cec04"><p class="cl-fc9cc666"><span class="cl-fc98c25b">109 (44)</span></p></td><td class="cl-fc9cec04"><p class="cl-fc9cc666"><span class="cl-fc98c25b">102 (41.1)</span></p></td><td class="cl-fc9cec04"><p class="cl-fc9cc666"><span class="cl-fc98c25b">37 (14.9)</span></p></td></tr></tbody><tfoot><tr style="overflow-wrap:break-word;"><td colspan="5" class="cl-fc9cec0f"><p class="cl-fc9cc670"><span class="cl-fc98c264">·µÉ</span><span class="cl-fc98c25b">Vaccination proportions were calculated row-wise (i.e., by row).</span></p></td></tr></tfoot></table></div>
</div>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="co"># .................. Clean up ..................</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(tab_age, tab_sex, tab_marital_status, tab_year, tab_quarter, tab_weekday, </span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>   tab_combined, ft_vacc_summary, totals, create_tab)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="only-horizontal-lines" class="level2" data-number="1.6">
<h2 data-number="1.6" class="anchored" data-anchor-id="only-horizontal-lines"><span class="header-section-number">1.6</span> <strong>6 . Only Horizontal Lines</strong></h2>
<p>This style keeps only <strong>horizontal dividers</strong> to improve readability without overwhelming the user.</p>
<p>üìè <em>Implication</em>: Helps guide the eye across wide tables while maintaining a clean aesthetic.</p>
<p>‚úÖ <em>Great for</em>: Formal documents and slide decks where visual clarity is important.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ------------6. Lines: Only Horizantal Lines -------------------------------------------</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a><span class="co"># .................. Convert grouping vars to character ..................</span></span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>vacc_1524 <span class="ot">&lt;-</span> vacc_1524 <span class="sc">%&gt;%</span></span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">c</span>(age_3group, gender, marital_status,</span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a>                  vacc_service_year, vacc_quarter, vacc_weekday), as.character))</span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a><span class="co"># .................. Table generation function with Missing ..................</span></span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a>create_tab <span class="ot">&lt;-</span> <span class="cf">function</span>(data, var, label) {</span>
<span id="cb23-10"><a href="#cb23-10" aria-hidden="true" tabindex="-1"></a>  tab_main <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span></span>
<span id="cb23-11"><a href="#cb23-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>({{ var }})) <span class="sc">%&gt;%</span></span>
<span id="cb23-12"><a href="#cb23-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tabyl</span>({{ var }}, vacc_group3) <span class="sc">%&gt;%</span></span>
<span id="cb23-13"><a href="#cb23-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">Category =</span> label, <span class="at">.before =</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb23-14"><a href="#cb23-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rename</span>(<span class="at">Label =</span> {{ var }}) <span class="sc">%&gt;%</span></span>
<span id="cb23-15"><a href="#cb23-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">Label =</span> <span class="fu">as.character</span>(Label))</span>
<span id="cb23-16"><a href="#cb23-16" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb23-17"><a href="#cb23-17" aria-hidden="true" tabindex="-1"></a>  na_count <span class="ot">&lt;-</span> <span class="fu">sum</span>(<span class="fu">is.na</span>(<span class="fu">pull</span>(data, {{ var }})))</span>
<span id="cb23-18"><a href="#cb23-18" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb23-19"><a href="#cb23-19" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (na_count <span class="sc">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb23-20"><a href="#cb23-20" aria-hidden="true" tabindex="-1"></a>    missing_row <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb23-21"><a href="#cb23-21" aria-hidden="true" tabindex="-1"></a>      <span class="at">Category =</span> label,</span>
<span id="cb23-22"><a href="#cb23-22" aria-hidden="true" tabindex="-1"></a>      <span class="at">Label =</span> <span class="st">"Missing"</span>,</span>
<span id="cb23-23"><a href="#cb23-23" aria-hidden="true" tabindex="-1"></a>      <span class="st">`</span><span class="at">Respiratory vaccines</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">sum</span>(data<span class="sc">$</span>vacc_group3 <span class="sc">==</span> <span class="st">"Respiratory vaccines"</span> <span class="sc">&amp;</span> <span class="fu">is.na</span>(<span class="fu">pull</span>(data, {{ var }})), <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb23-24"><a href="#cb23-24" aria-hidden="true" tabindex="-1"></a>      <span class="st">`</span><span class="at">Childhood vaccines</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">sum</span>(data<span class="sc">$</span>vacc_group3 <span class="sc">==</span> <span class="st">"Childhood vaccines"</span> <span class="sc">&amp;</span> <span class="fu">is.na</span>(<span class="fu">pull</span>(data, {{ var }})), <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb23-25"><a href="#cb23-25" aria-hidden="true" tabindex="-1"></a>      <span class="at">Other =</span> <span class="fu">sum</span>(data<span class="sc">$</span>vacc_group3 <span class="sc">==</span> <span class="st">"Other"</span> <span class="sc">&amp;</span> <span class="fu">is.na</span>(<span class="fu">pull</span>(data, {{ var }})), <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb23-26"><a href="#cb23-26" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb23-27"><a href="#cb23-27" aria-hidden="true" tabindex="-1"></a>    tab_final <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(tab_main, missing_row)</span>
<span id="cb23-28"><a href="#cb23-28" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb23-29"><a href="#cb23-29" aria-hidden="true" tabindex="-1"></a>    tab_final <span class="ot">&lt;-</span> tab_main</span>
<span id="cb23-30"><a href="#cb23-30" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb23-31"><a href="#cb23-31" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb23-32"><a href="#cb23-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(tab_final)</span>
<span id="cb23-33"><a href="#cb23-33" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb23-34"><a href="#cb23-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-35"><a href="#cb23-35" aria-hidden="true" tabindex="-1"></a><span class="co"># .................. Create summary tables ..................</span></span>
<span id="cb23-36"><a href="#cb23-36" aria-hidden="true" tabindex="-1"></a>tab_age            <span class="ot">&lt;-</span> <span class="fu">create_tab</span>(vacc_1524, age_group, <span class="st">"Age"</span>)</span>
<span id="cb23-37"><a href="#cb23-37" aria-hidden="true" tabindex="-1"></a>tab_sex            <span class="ot">&lt;-</span> <span class="fu">create_tab</span>(vacc_1524, gender, <span class="st">"Gender"</span>)</span>
<span id="cb23-38"><a href="#cb23-38" aria-hidden="true" tabindex="-1"></a>tab_marital_status <span class="ot">&lt;-</span> <span class="fu">create_tab</span>(vacc_1524, marital_status, <span class="st">"Marital status"</span>)</span>
<span id="cb23-39"><a href="#cb23-39" aria-hidden="true" tabindex="-1"></a>tab_year           <span class="ot">&lt;-</span> <span class="fu">create_tab</span>(vacc_1524, vacc_service_year, <span class="st">"Year"</span>)</span>
<span id="cb23-40"><a href="#cb23-40" aria-hidden="true" tabindex="-1"></a>tab_quarter        <span class="ot">&lt;-</span> <span class="fu">create_tab</span>(vacc_1524, vacc_quarter, <span class="st">"Quarter"</span>)</span>
<span id="cb23-41"><a href="#cb23-41" aria-hidden="true" tabindex="-1"></a>tab_weekday        <span class="ot">&lt;-</span> <span class="fu">create_tab</span>(vacc_1524, vacc_weekday, <span class="st">"Weekday"</span>)</span>
<span id="cb23-42"><a href="#cb23-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-43"><a href="#cb23-43" aria-hidden="true" tabindex="-1"></a><span class="co"># .................. Combine all tables ..................</span></span>
<span id="cb23-44"><a href="#cb23-44" aria-hidden="true" tabindex="-1"></a>tab_combined <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(tab_sex, tab_age, tab_marital_status, tab_year, tab_quarter, tab_weekday)</span>
<span id="cb23-45"><a href="#cb23-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-46"><a href="#cb23-46" aria-hidden="true" tabindex="-1"></a><span class="co"># .................. Calculate row-wise percentages (skip for Missing) ..................</span></span>
<span id="cb23-47"><a href="#cb23-47" aria-hidden="true" tabindex="-1"></a>tab_combined <span class="ot">&lt;-</span> tab_combined <span class="sc">%&gt;%</span></span>
<span id="cb23-48"><a href="#cb23-48" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rowwise</span>() <span class="sc">%&gt;%</span></span>
<span id="cb23-49"><a href="#cb23-49" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb23-50"><a href="#cb23-50" aria-hidden="true" tabindex="-1"></a>    <span class="at">Total =</span> <span class="fu">sum</span>(<span class="st">`</span><span class="at">Respiratory vaccines</span><span class="st">`</span>, <span class="st">`</span><span class="at">Childhood vaccines</span><span class="st">`</span>, Other, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb23-51"><a href="#cb23-51" aria-hidden="true" tabindex="-1"></a>    <span class="at">is_missing =</span> <span class="fu">trimws</span>(<span class="fu">tolower</span>(Label)) <span class="sc">==</span> <span class="st">"missing"</span>,</span>
<span id="cb23-52"><a href="#cb23-52" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb23-53"><a href="#cb23-53" aria-hidden="true" tabindex="-1"></a>    <span class="at">Respiratory =</span> <span class="fu">ifelse</span>(is_missing,</span>
<span id="cb23-54"><a href="#cb23-54" aria-hidden="true" tabindex="-1"></a>                         <span class="fu">comma</span>(<span class="st">`</span><span class="at">Respiratory vaccines</span><span class="st">`</span>),</span>
<span id="cb23-55"><a href="#cb23-55" aria-hidden="true" tabindex="-1"></a>                         <span class="fu">paste0</span>(<span class="fu">comma</span>(<span class="st">`</span><span class="at">Respiratory vaccines</span><span class="st">`</span>), <span class="st">" ("</span>, <span class="fu">round</span>(<span class="dv">100</span> <span class="sc">*</span> <span class="st">`</span><span class="at">Respiratory vaccines</span><span class="st">`</span> <span class="sc">/</span> Total, <span class="dv">1</span>), <span class="st">")"</span>)),</span>
<span id="cb23-56"><a href="#cb23-56" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb23-57"><a href="#cb23-57" aria-hidden="true" tabindex="-1"></a>    <span class="at">Childhood =</span> <span class="fu">ifelse</span>(is_missing,</span>
<span id="cb23-58"><a href="#cb23-58" aria-hidden="true" tabindex="-1"></a>                       <span class="fu">comma</span>(<span class="st">`</span><span class="at">Childhood vaccines</span><span class="st">`</span>),</span>
<span id="cb23-59"><a href="#cb23-59" aria-hidden="true" tabindex="-1"></a>                       <span class="fu">paste0</span>(<span class="fu">comma</span>(<span class="st">`</span><span class="at">Childhood vaccines</span><span class="st">`</span>), <span class="st">" ("</span>, <span class="fu">round</span>(<span class="dv">100</span> <span class="sc">*</span> <span class="st">`</span><span class="at">Childhood vaccines</span><span class="st">`</span> <span class="sc">/</span> Total, <span class="dv">1</span>), <span class="st">")"</span>)),</span>
<span id="cb23-60"><a href="#cb23-60" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb23-61"><a href="#cb23-61" aria-hidden="true" tabindex="-1"></a>    <span class="at">Other_grp =</span> <span class="fu">ifelse</span>(is_missing,</span>
<span id="cb23-62"><a href="#cb23-62" aria-hidden="true" tabindex="-1"></a>                       <span class="fu">comma</span>(Other),</span>
<span id="cb23-63"><a href="#cb23-63" aria-hidden="true" tabindex="-1"></a>                       <span class="fu">paste0</span>(<span class="fu">comma</span>(Other), <span class="st">" ("</span>, <span class="fu">round</span>(<span class="dv">100</span> <span class="sc">*</span> Other <span class="sc">/</span> Total, <span class="dv">1</span>), <span class="st">")"</span>))</span>
<span id="cb23-64"><a href="#cb23-64" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb23-65"><a href="#cb23-65" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb23-66"><a href="#cb23-66" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Category, Label, Respiratory, Childhood, Other_grp)</span>
<span id="cb23-67"><a href="#cb23-67" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-68"><a href="#cb23-68" aria-hidden="true" tabindex="-1"></a><span class="co"># .................. Show Category only once per group ..................</span></span>
<span id="cb23-69"><a href="#cb23-69" aria-hidden="true" tabindex="-1"></a>tab_combined <span class="ot">&lt;-</span> tab_combined <span class="sc">%&gt;%</span></span>
<span id="cb23-70"><a href="#cb23-70" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Category) <span class="sc">%&gt;%</span></span>
<span id="cb23-71"><a href="#cb23-71" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Category =</span> <span class="fu">ifelse</span>(<span class="fu">row_number</span>() <span class="sc">==</span> <span class="dv">1</span>, Category, <span class="st">""</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb23-72"><a href="#cb23-72" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb23-73"><a href="#cb23-73" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-74"><a href="#cb23-74" aria-hidden="true" tabindex="-1"></a><span class="co"># .................. Get total counts per vaccine group ..................</span></span>
<span id="cb23-75"><a href="#cb23-75" aria-hidden="true" tabindex="-1"></a>totals <span class="ot">&lt;-</span> vacc_1524 <span class="sc">%&gt;%</span></span>
<span id="cb23-76"><a href="#cb23-76" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(vacc_group3) <span class="sc">%&gt;%</span></span>
<span id="cb23-77"><a href="#cb23-77" aria-hidden="true" tabindex="-1"></a>  <span class="fu">deframe</span>()</span>
<span id="cb23-78"><a href="#cb23-78" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-79"><a href="#cb23-79" aria-hidden="true" tabindex="-1"></a><span class="co"># .................. Create flextable ..................</span></span>
<span id="cb23-80"><a href="#cb23-80" aria-hidden="true" tabindex="-1"></a>ft_vacc_summary <span class="ot">&lt;-</span> tab_combined <span class="sc">%&gt;%</span></span>
<span id="cb23-81"><a href="#cb23-81" aria-hidden="true" tabindex="-1"></a>  <span class="fu">flextable</span>() <span class="sc">%&gt;%</span></span>
<span id="cb23-82"><a href="#cb23-82" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_header_labels</span>(</span>
<span id="cb23-83"><a href="#cb23-83" aria-hidden="true" tabindex="-1"></a>    <span class="at">Category =</span> <span class="st">"Variable type"</span>,</span>
<span id="cb23-84"><a href="#cb23-84" aria-hidden="true" tabindex="-1"></a>    <span class="at">Label =</span> <span class="st">"Values"</span>,</span>
<span id="cb23-85"><a href="#cb23-85" aria-hidden="true" tabindex="-1"></a>    <span class="at">Respiratory =</span> <span class="st">"Number (%)·µÉ"</span>,</span>
<span id="cb23-86"><a href="#cb23-86" aria-hidden="true" tabindex="-1"></a>    <span class="at">Childhood =</span> <span class="st">"Number (%)·µÉ"</span>,</span>
<span id="cb23-87"><a href="#cb23-87" aria-hidden="true" tabindex="-1"></a>    <span class="at">Other_grp =</span> <span class="st">"Number (%)·µÉ"</span></span>
<span id="cb23-88"><a href="#cb23-88" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb23-89"><a href="#cb23-89" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_header_row</span>(</span>
<span id="cb23-90"><a href="#cb23-90" aria-hidden="true" tabindex="-1"></a>    <span class="at">values =</span> <span class="fu">c</span>(</span>
<span id="cb23-91"><a href="#cb23-91" aria-hidden="true" tabindex="-1"></a>      <span class="st">""</span>, <span class="st">""</span>,</span>
<span id="cb23-92"><a href="#cb23-92" aria-hidden="true" tabindex="-1"></a>      <span class="fu">paste0</span>(<span class="st">"Respiratory vaccines (N = "</span>, <span class="fu">format</span>(totals[<span class="st">"Respiratory vaccines"</span>], <span class="at">big.mark =</span> <span class="st">","</span>), <span class="st">")"</span>),</span>
<span id="cb23-93"><a href="#cb23-93" aria-hidden="true" tabindex="-1"></a>      <span class="fu">paste0</span>(<span class="st">"Childhood vaccines (N = "</span>, <span class="fu">format</span>(totals[<span class="st">"Childhood vaccines"</span>], <span class="at">big.mark =</span> <span class="st">","</span>), <span class="st">")"</span>),</span>
<span id="cb23-94"><a href="#cb23-94" aria-hidden="true" tabindex="-1"></a>      <span class="fu">paste0</span>(<span class="st">"Other (N = "</span>, <span class="fu">format</span>(totals[<span class="st">"Other"</span>], <span class="at">big.mark =</span> <span class="st">","</span>), <span class="st">")"</span>)</span>
<span id="cb23-95"><a href="#cb23-95" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb23-96"><a href="#cb23-96" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb23-97"><a href="#cb23-97" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_header_row</span>(</span>
<span id="cb23-98"><a href="#cb23-98" aria-hidden="true" tabindex="-1"></a>    <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"Description"</span>, <span class="st">"Vaccination uptake"</span>),</span>
<span id="cb23-99"><a href="#cb23-99" aria-hidden="true" tabindex="-1"></a>    <span class="at">colwidths =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">3</span>)</span>
<span id="cb23-100"><a href="#cb23-100" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb23-101"><a href="#cb23-101" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_box</span>() <span class="sc">%&gt;%</span></span>
<span id="cb23-102"><a href="#cb23-102" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_table_properties</span>(<span class="at">layout =</span> <span class="st">"autofit"</span>, <span class="at">width =</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb23-103"><a href="#cb23-103" aria-hidden="true" tabindex="-1"></a>  <span class="fu">width</span>(<span class="at">j =</span> <span class="dv">1</span>, <span class="at">width =</span> <span class="fl">1.5</span>) <span class="sc">%&gt;%</span></span>
<span id="cb23-104"><a href="#cb23-104" aria-hidden="true" tabindex="-1"></a>  <span class="fu">width</span>(<span class="at">j =</span> <span class="dv">2</span>, <span class="at">width =</span> <span class="fl">2.5</span>) <span class="sc">%&gt;%</span></span>
<span id="cb23-105"><a href="#cb23-105" aria-hidden="true" tabindex="-1"></a>  <span class="fu">width</span>(<span class="at">j =</span> <span class="dv">3</span><span class="sc">:</span><span class="dv">5</span>, <span class="at">width =</span> <span class="fl">1.5</span>) <span class="sc">%&gt;%</span></span>
<span id="cb23-106"><a href="#cb23-106" aria-hidden="true" tabindex="-1"></a>  <span class="fu">align</span>(<span class="at">align =</span> <span class="st">"justify"</span>, <span class="at">part =</span> <span class="st">"all"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb23-107"><a href="#cb23-107" aria-hidden="true" tabindex="-1"></a>  <span class="fu">border_remove</span>() <span class="sc">%&gt;%</span></span>
<span id="cb23-108"><a href="#cb23-108" aria-hidden="true" tabindex="-1"></a>  <span class="fu">border</span>(<span class="at">part =</span> <span class="st">"header"</span>, <span class="at">i =</span> <span class="dv">1</span>, <span class="at">border.top =</span> <span class="fu">fp_border</span>(<span class="at">color =</span> <span class="st">"black"</span>, <span class="at">width =</span> <span class="dv">1</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb23-109"><a href="#cb23-109" aria-hidden="true" tabindex="-1"></a>  <span class="fu">border</span>(<span class="at">part =</span> <span class="st">"header"</span>, <span class="at">i =</span> <span class="dv">3</span>, <span class="at">border.bottom =</span> <span class="fu">fp_border</span>(<span class="at">color =</span> <span class="st">"black"</span>, <span class="at">width =</span> <span class="dv">1</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb23-110"><a href="#cb23-110" aria-hidden="true" tabindex="-1"></a>  <span class="fu">border_inner_h</span>(<span class="at">part =</span> <span class="st">"header"</span>, <span class="at">border =</span> <span class="fu">fp_border</span>(<span class="at">color =</span> <span class="st">"black"</span>, <span class="at">width =</span> <span class="fl">0.8</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb23-111"><a href="#cb23-111" aria-hidden="true" tabindex="-1"></a>  <span class="fu">border_inner_h</span>(<span class="at">part =</span> <span class="st">"body"</span>, <span class="at">border =</span> <span class="fu">fp_border</span>(<span class="at">color =</span> <span class="st">"black"</span>, <span class="at">width =</span> <span class="fl">0.8</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb23-112"><a href="#cb23-112" aria-hidden="true" tabindex="-1"></a>  <span class="fu">border</span>(<span class="at">part =</span> <span class="st">"body"</span>, <span class="at">i =</span> <span class="fu">nrow</span>(tab_combined), <span class="at">border.bottom =</span> <span class="fu">fp_border</span>(<span class="at">color =</span> <span class="st">"black"</span>, <span class="at">width =</span> <span class="dv">1</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb23-113"><a href="#cb23-113" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb23-114"><a href="#cb23-114" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_caption</span>(<span class="st">"Table: Vaccination uptake across service year, quarter, and weekday"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb23-115"><a href="#cb23-115" aria-hidden="true" tabindex="-1"></a>  <span class="fu">footnote</span>(<span class="at">i =</span> <span class="dv">1</span>, </span>
<span id="cb23-116"><a href="#cb23-116" aria-hidden="true" tabindex="-1"></a>           <span class="at">value =</span> <span class="fu">as_paragraph</span>(<span class="st">"Vaccination proportions were calculated row-wise (i.e., by row)."</span>),</span>
<span id="cb23-117"><a href="#cb23-117" aria-hidden="true" tabindex="-1"></a>           <span class="at">ref_symbols =</span> <span class="st">"·µÉ"</span>, </span>
<span id="cb23-118"><a href="#cb23-118" aria-hidden="true" tabindex="-1"></a>           <span class="at">part =</span> <span class="st">"header"</span>)</span>
<span id="cb23-119"><a href="#cb23-119" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-120"><a href="#cb23-120" aria-hidden="true" tabindex="-1"></a><span class="co"># .................. Show the table ..................</span></span>
<span id="cb23-121"><a href="#cb23-121" aria-hidden="true" tabindex="-1"></a>ft_vacc_summary</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="tabwid"><style>.cl-fce9cf2e{table-layout:auto;width:100%;}.cl-fcdff346{font-family:'Arial';font-size:11pt;font-weight:bold;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-fcdff35a{font-family:'Arial';font-size:6.6pt;font-weight:bold;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;position: relative;bottom:3.3pt;}.cl-fcdff35b{font-family:'Arial';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-fcdff364{font-family:'Arial';font-size:6.6pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;position: relative;bottom:3.3pt;}.cl-fce434b0{margin:0;text-align:justify;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-fce434ba{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-fce45792{background-color:transparent;vertical-align: middle;border-bottom: 0.8pt solid rgba(0, 0, 0, 1.00);border-top: 1pt solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-fce4579c{background-color:transparent;vertical-align: middle;border-bottom: 0.8pt solid rgba(0, 0, 0, 1.00);border-top: 1pt solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-fce457a6{background-color:transparent;vertical-align: middle;border-bottom: 0.8pt solid rgba(0, 0, 0, 1.00);border-top: 0.8pt solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-fce457a7{background-color:transparent;vertical-align: middle;border-bottom: 0.8pt solid rgba(0, 0, 0, 1.00);border-top: 0.8pt solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-fce457a8{background-color:transparent;vertical-align: middle;border-bottom: 1pt solid rgba(0, 0, 0, 1.00);border-top: 0.8pt solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-fce457b0{background-color:transparent;vertical-align: middle;border-bottom: 1pt solid rgba(0, 0, 0, 1.00);border-top: 0.8pt solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-fce457b1{background-color:transparent;vertical-align: middle;border-bottom: 0.8pt solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-fce457b2{background-color:transparent;vertical-align: middle;border-bottom: 0.8pt solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-fce457ba{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(255, 255, 255, 0.00);border-top: 0 solid rgba(255, 255, 255, 0.00);border-left: 0 solid rgba(255, 255, 255, 0.00);border-right: 0 solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-fce457bb{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(255, 255, 255, 0.00);border-top: 0 solid rgba(255, 255, 255, 0.00);border-left: 0 solid rgba(255, 255, 255, 0.00);border-right: 0 solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table data-quarto-disable-processing="true" class="cl-fce9cf2e"><thead><tr style="overflow-wrap:break-word;"><th colspan="2" class="cl-fce45792"><p class="cl-fce434b0"><span class="cl-fcdff346">Description</span><span class="cl-fcdff35a">·µÉ</span></p></th><th colspan="3" class="cl-fce45792"><p class="cl-fce434b0"><span class="cl-fcdff346">Vaccination uptake</span><span class="cl-fcdff35a">·µÉ</span></p></th></tr><tr style="overflow-wrap:break-word;"><th class="cl-fce457a6"><p class="cl-fce434b0"><span class="cl-fcdff346"></span></p></th><th class="cl-fce457a7"><p class="cl-fce434b0"><span class="cl-fcdff346"></span></p></th><th class="cl-fce457a6"><p class="cl-fce434b0"><span class="cl-fcdff346">Respiratory vaccines (N = 955)</span></p></th><th class="cl-fce457a6"><p class="cl-fce434b0"><span class="cl-fcdff346">Childhood vaccines (N = 472)</span></p></th><th class="cl-fce457a6"><p class="cl-fce434b0"><span class="cl-fcdff346">Other (N = 126)</span></p></th></tr><tr style="overflow-wrap:break-word;"><th class="cl-fce457a8"><p class="cl-fce434b0"><span class="cl-fcdff346">Variable type</span></p></th><th class="cl-fce457b0"><p class="cl-fce434b0"><span class="cl-fcdff346">Values</span></p></th><th class="cl-fce457a8"><p class="cl-fce434b0"><span class="cl-fcdff346">Number (%)·µÉ</span></p></th><th class="cl-fce457a8"><p class="cl-fce434b0"><span class="cl-fcdff346">Number (%)·µÉ</span></p></th><th class="cl-fce457a8"><p class="cl-fce434b0"><span class="cl-fcdff346">Number (%)·µÉ</span></p></th></tr></thead><tbody><tr style="overflow-wrap:break-word;"><td class="cl-fce457b1"><p class="cl-fce434b0"><span class="cl-fcdff35b">Gender</span></p></td><td class="cl-fce457b2"><p class="cl-fce434b0"><span class="cl-fcdff35b">Female</span></p></td><td class="cl-fce457b1"><p class="cl-fce434b0"><span class="cl-fcdff35b">511 (64)</span></p></td><td class="cl-fce457b1"><p class="cl-fce434b0"><span class="cl-fcdff35b">233 (29.2)</span></p></td><td class="cl-fce457b1"><p class="cl-fce434b0"><span class="cl-fcdff35b">54 (6.8)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-fce457a6"><p class="cl-fce434b0"><span class="cl-fcdff35b"></span></p></td><td class="cl-fce457a7"><p class="cl-fce434b0"><span class="cl-fcdff35b">Male</span></p></td><td class="cl-fce457a6"><p class="cl-fce434b0"><span class="cl-fcdff35b">444 (58.8)</span></p></td><td class="cl-fce457a6"><p class="cl-fce434b0"><span class="cl-fcdff35b">239 (31.7)</span></p></td><td class="cl-fce457a6"><p class="cl-fce434b0"><span class="cl-fcdff35b">72 (9.5)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-fce457a6"><p class="cl-fce434b0"><span class="cl-fcdff35b">Age</span></p></td><td class="cl-fce457a7"><p class="cl-fce434b0"><span class="cl-fcdff35b">0-19</span></p></td><td class="cl-fce457a6"><p class="cl-fce434b0"><span class="cl-fcdff35b">250 (38.9)</span></p></td><td class="cl-fce457a6"><p class="cl-fce434b0"><span class="cl-fcdff35b">302 (47)</span></p></td><td class="cl-fce457a6"><p class="cl-fce434b0"><span class="cl-fcdff35b">90 (14)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-fce457a6"><p class="cl-fce434b0"><span class="cl-fcdff35b"></span></p></td><td class="cl-fce457a7"><p class="cl-fce434b0"><span class="cl-fcdff35b">20-29</span></p></td><td class="cl-fce457a6"><p class="cl-fce434b0"><span class="cl-fcdff35b">150 (68.2)</span></p></td><td class="cl-fce457a6"><p class="cl-fce434b0"><span class="cl-fcdff35b">70 (31.8)</span></p></td><td class="cl-fce457a6"><p class="cl-fce434b0"><span class="cl-fcdff35b">0 (0)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-fce457a6"><p class="cl-fce434b0"><span class="cl-fcdff35b"></span></p></td><td class="cl-fce457a7"><p class="cl-fce434b0"><span class="cl-fcdff35b">30-39</span></p></td><td class="cl-fce457a6"><p class="cl-fce434b0"><span class="cl-fcdff35b">47 (71.2)</span></p></td><td class="cl-fce457a6"><p class="cl-fce434b0"><span class="cl-fcdff35b">19 (28.8)</span></p></td><td class="cl-fce457a6"><p class="cl-fce434b0"><span class="cl-fcdff35b">0 (0)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-fce457a6"><p class="cl-fce434b0"><span class="cl-fcdff35b"></span></p></td><td class="cl-fce457a7"><p class="cl-fce434b0"><span class="cl-fcdff35b">40-49</span></p></td><td class="cl-fce457a6"><p class="cl-fce434b0"><span class="cl-fcdff35b">142 (75.9)</span></p></td><td class="cl-fce457a6"><p class="cl-fce434b0"><span class="cl-fcdff35b">45 (24.1)</span></p></td><td class="cl-fce457a6"><p class="cl-fce434b0"><span class="cl-fcdff35b">0 (0)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-fce457a6"><p class="cl-fce434b0"><span class="cl-fcdff35b"></span></p></td><td class="cl-fce457a7"><p class="cl-fce434b0"><span class="cl-fcdff35b">50-59</span></p></td><td class="cl-fce457a6"><p class="cl-fce434b0"><span class="cl-fcdff35b">112 (77.8)</span></p></td><td class="cl-fce457a6"><p class="cl-fce434b0"><span class="cl-fcdff35b">14 (9.7)</span></p></td><td class="cl-fce457a6"><p class="cl-fce434b0"><span class="cl-fcdff35b">18 (12.5)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-fce457a6"><p class="cl-fce434b0"><span class="cl-fcdff35b"></span></p></td><td class="cl-fce457a7"><p class="cl-fce434b0"><span class="cl-fcdff35b">60-69</span></p></td><td class="cl-fce457a6"><p class="cl-fce434b0"><span class="cl-fcdff35b">149 (87.6)</span></p></td><td class="cl-fce457a6"><p class="cl-fce434b0"><span class="cl-fcdff35b">13 (7.6)</span></p></td><td class="cl-fce457a6"><p class="cl-fce434b0"><span class="cl-fcdff35b">8 (4.7)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-fce457a6"><p class="cl-fce434b0"><span class="cl-fcdff35b"></span></p></td><td class="cl-fce457a7"><p class="cl-fce434b0"><span class="cl-fcdff35b">70+</span></p></td><td class="cl-fce457a6"><p class="cl-fce434b0"><span class="cl-fcdff35b">105 (84.7)</span></p></td><td class="cl-fce457a6"><p class="cl-fce434b0"><span class="cl-fcdff35b">9 (7.3)</span></p></td><td class="cl-fce457a6"><p class="cl-fce434b0"><span class="cl-fcdff35b">10 (8.1)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-fce457a6"><p class="cl-fce434b0"><span class="cl-fcdff35b">Marital status</span></p></td><td class="cl-fce457a7"><p class="cl-fce434b0"><span class="cl-fcdff35b">Divorced</span></p></td><td class="cl-fce457a6"><p class="cl-fce434b0"><span class="cl-fcdff35b">136 (83.4)</span></p></td><td class="cl-fce457a6"><p class="cl-fce434b0"><span class="cl-fcdff35b">15 (9.2)</span></p></td><td class="cl-fce457a6"><p class="cl-fce434b0"><span class="cl-fcdff35b">12 (7.4)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-fce457a6"><p class="cl-fce434b0"><span class="cl-fcdff35b"></span></p></td><td class="cl-fce457a7"><p class="cl-fce434b0"><span class="cl-fcdff35b">Married</span></p></td><td class="cl-fce457a6"><p class="cl-fce434b0"><span class="cl-fcdff35b">289 (79)</span></p></td><td class="cl-fce457a6"><p class="cl-fce434b0"><span class="cl-fcdff35b">59 (16.1)</span></p></td><td class="cl-fce457a6"><p class="cl-fce434b0"><span class="cl-fcdff35b">18 (4.9)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-fce457a6"><p class="cl-fce434b0"><span class="cl-fcdff35b"></span></p></td><td class="cl-fce457a7"><p class="cl-fce434b0"><span class="cl-fcdff35b">Single/widowed</span></p></td><td class="cl-fce457a6"><p class="cl-fce434b0"><span class="cl-fcdff35b">150 (79.4)</span></p></td><td class="cl-fce457a6"><p class="cl-fce434b0"><span class="cl-fcdff35b">33 (17.5)</span></p></td><td class="cl-fce457a6"><p class="cl-fce434b0"><span class="cl-fcdff35b">6 (3.2)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-fce457a6"><p class="cl-fce434b0"><span class="cl-fcdff35b"></span></p></td><td class="cl-fce457a7"><p class="cl-fce434b0"><span class="cl-fcdff35b">Missing</span></p></td><td class="cl-fce457a6"><p class="cl-fce434b0"><span class="cl-fcdff35b">380</span></p></td><td class="cl-fce457a6"><p class="cl-fce434b0"><span class="cl-fcdff35b">365</span></p></td><td class="cl-fce457a6"><p class="cl-fce434b0"><span class="cl-fcdff35b">90</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-fce457a6"><p class="cl-fce434b0"><span class="cl-fcdff35b">Year</span></p></td><td class="cl-fce457a7"><p class="cl-fce434b0"><span class="cl-fcdff35b">2015</span></p></td><td class="cl-fce457a6"><p class="cl-fce434b0"><span class="cl-fcdff35b">78 (51)</span></p></td><td class="cl-fce457a6"><p class="cl-fce434b0"><span class="cl-fcdff35b">56 (36.6)</span></p></td><td class="cl-fce457a6"><p class="cl-fce434b0"><span class="cl-fcdff35b">19 (12.4)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-fce457a6"><p class="cl-fce434b0"><span class="cl-fcdff35b"></span></p></td><td class="cl-fce457a7"><p class="cl-fce434b0"><span class="cl-fcdff35b">2016</span></p></td><td class="cl-fce457a6"><p class="cl-fce434b0"><span class="cl-fcdff35b">84 (60.4)</span></p></td><td class="cl-fce457a6"><p class="cl-fce434b0"><span class="cl-fcdff35b">47 (33.8)</span></p></td><td class="cl-fce457a6"><p class="cl-fce434b0"><span class="cl-fcdff35b">8 (5.8)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-fce457a6"><p class="cl-fce434b0"><span class="cl-fcdff35b"></span></p></td><td class="cl-fce457a7"><p class="cl-fce434b0"><span class="cl-fcdff35b">2017</span></p></td><td class="cl-fce457a6"><p class="cl-fce434b0"><span class="cl-fcdff35b">75 (54.7)</span></p></td><td class="cl-fce457a6"><p class="cl-fce434b0"><span class="cl-fcdff35b">52 (38)</span></p></td><td class="cl-fce457a6"><p class="cl-fce434b0"><span class="cl-fcdff35b">10 (7.3)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-fce457a6"><p class="cl-fce434b0"><span class="cl-fcdff35b"></span></p></td><td class="cl-fce457a7"><p class="cl-fce434b0"><span class="cl-fcdff35b">2018</span></p></td><td class="cl-fce457a6"><p class="cl-fce434b0"><span class="cl-fcdff35b">81 (53.6)</span></p></td><td class="cl-fce457a6"><p class="cl-fce434b0"><span class="cl-fcdff35b">52 (34.4)</span></p></td><td class="cl-fce457a6"><p class="cl-fce434b0"><span class="cl-fcdff35b">18 (11.9)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-fce457a6"><p class="cl-fce434b0"><span class="cl-fcdff35b"></span></p></td><td class="cl-fce457a7"><p class="cl-fce434b0"><span class="cl-fcdff35b">2019</span></p></td><td class="cl-fce457a6"><p class="cl-fce434b0"><span class="cl-fcdff35b">83 (51.6)</span></p></td><td class="cl-fce457a6"><p class="cl-fce434b0"><span class="cl-fcdff35b">60 (37.3)</span></p></td><td class="cl-fce457a6"><p class="cl-fce434b0"><span class="cl-fcdff35b">18 (11.2)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-fce457a6"><p class="cl-fce434b0"><span class="cl-fcdff35b"></span></p></td><td class="cl-fce457a7"><p class="cl-fce434b0"><span class="cl-fcdff35b">2020</span></p></td><td class="cl-fce457a6"><p class="cl-fce434b0"><span class="cl-fcdff35b">82 (59.9)</span></p></td><td class="cl-fce457a6"><p class="cl-fce434b0"><span class="cl-fcdff35b">44 (32.1)</span></p></td><td class="cl-fce457a6"><p class="cl-fce434b0"><span class="cl-fcdff35b">11 (8)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-fce457a6"><p class="cl-fce434b0"><span class="cl-fcdff35b"></span></p></td><td class="cl-fce457a7"><p class="cl-fce434b0"><span class="cl-fcdff35b">2021</span></p></td><td class="cl-fce457a6"><p class="cl-fce434b0"><span class="cl-fcdff35b">223 (84.8)</span></p></td><td class="cl-fce457a6"><p class="cl-fce434b0"><span class="cl-fcdff35b">34 (12.9)</span></p></td><td class="cl-fce457a6"><p class="cl-fce434b0"><span class="cl-fcdff35b">6 (2.3)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-fce457a6"><p class="cl-fce434b0"><span class="cl-fcdff35b"></span></p></td><td class="cl-fce457a7"><p class="cl-fce434b0"><span class="cl-fcdff35b">2022</span></p></td><td class="cl-fce457a6"><p class="cl-fce434b0"><span class="cl-fcdff35b">88 (73.3)</span></p></td><td class="cl-fce457a6"><p class="cl-fce434b0"><span class="cl-fcdff35b">25 (20.8)</span></p></td><td class="cl-fce457a6"><p class="cl-fce434b0"><span class="cl-fcdff35b">7 (5.8)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-fce457a6"><p class="cl-fce434b0"><span class="cl-fcdff35b"></span></p></td><td class="cl-fce457a7"><p class="cl-fce434b0"><span class="cl-fcdff35b">2023</span></p></td><td class="cl-fce457a6"><p class="cl-fce434b0"><span class="cl-fcdff35b">87 (51.2)</span></p></td><td class="cl-fce457a6"><p class="cl-fce434b0"><span class="cl-fcdff35b">63 (37.1)</span></p></td><td class="cl-fce457a6"><p class="cl-fce434b0"><span class="cl-fcdff35b">20 (11.8)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-fce457a6"><p class="cl-fce434b0"><span class="cl-fcdff35b"></span></p></td><td class="cl-fce457a7"><p class="cl-fce434b0"><span class="cl-fcdff35b">2024</span></p></td><td class="cl-fce457a6"><p class="cl-fce434b0"><span class="cl-fcdff35b">74 (60.7)</span></p></td><td class="cl-fce457a6"><p class="cl-fce434b0"><span class="cl-fcdff35b">39 (32)</span></p></td><td class="cl-fce457a6"><p class="cl-fce434b0"><span class="cl-fcdff35b">9 (7.4)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-fce457a6"><p class="cl-fce434b0"><span class="cl-fcdff35b">Quarter</span></p></td><td class="cl-fce457a7"><p class="cl-fce434b0"><span class="cl-fcdff35b">1</span></p></td><td class="cl-fce457a6"><p class="cl-fce434b0"><span class="cl-fcdff35b">253 (62.8)</span></p></td><td class="cl-fce457a6"><p class="cl-fce434b0"><span class="cl-fcdff35b">120 (29.8)</span></p></td><td class="cl-fce457a6"><p class="cl-fce434b0"><span class="cl-fcdff35b">30 (7.4)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-fce457a6"><p class="cl-fce434b0"><span class="cl-fcdff35b"></span></p></td><td class="cl-fce457a7"><p class="cl-fce434b0"><span class="cl-fcdff35b">2</span></p></td><td class="cl-fce457a6"><p class="cl-fce434b0"><span class="cl-fcdff35b">220 (58.5)</span></p></td><td class="cl-fce457a6"><p class="cl-fce434b0"><span class="cl-fcdff35b">117 (31.1)</span></p></td><td class="cl-fce457a6"><p class="cl-fce434b0"><span class="cl-fcdff35b">39 (10.4)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-fce457a6"><p class="cl-fce434b0"><span class="cl-fcdff35b"></span></p></td><td class="cl-fce457a7"><p class="cl-fce434b0"><span class="cl-fcdff35b">3</span></p></td><td class="cl-fce457a6"><p class="cl-fce434b0"><span class="cl-fcdff35b">295 (63.2)</span></p></td><td class="cl-fce457a6"><p class="cl-fce434b0"><span class="cl-fcdff35b">139 (29.8)</span></p></td><td class="cl-fce457a6"><p class="cl-fce434b0"><span class="cl-fcdff35b">33 (7.1)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-fce457a6"><p class="cl-fce434b0"><span class="cl-fcdff35b"></span></p></td><td class="cl-fce457a7"><p class="cl-fce434b0"><span class="cl-fcdff35b">4</span></p></td><td class="cl-fce457a6"><p class="cl-fce434b0"><span class="cl-fcdff35b">187 (60.9)</span></p></td><td class="cl-fce457a6"><p class="cl-fce434b0"><span class="cl-fcdff35b">96 (31.3)</span></p></td><td class="cl-fce457a6"><p class="cl-fce434b0"><span class="cl-fcdff35b">24 (7.8)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-fce457a6"><p class="cl-fce434b0"><span class="cl-fcdff35b">Weekday</span></p></td><td class="cl-fce457a7"><p class="cl-fce434b0"><span class="cl-fcdff35b">Friday</span></p></td><td class="cl-fce457a6"><p class="cl-fce434b0"><span class="cl-fcdff35b">141 (78.3)</span></p></td><td class="cl-fce457a6"><p class="cl-fce434b0"><span class="cl-fcdff35b">31 (17.2)</span></p></td><td class="cl-fce457a6"><p class="cl-fce434b0"><span class="cl-fcdff35b">8 (4.4)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-fce457a6"><p class="cl-fce434b0"><span class="cl-fcdff35b"></span></p></td><td class="cl-fce457a7"><p class="cl-fce434b0"><span class="cl-fcdff35b">Monday</span></p></td><td class="cl-fce457a6"><p class="cl-fce434b0"><span class="cl-fcdff35b">114 (64.4)</span></p></td><td class="cl-fce457a6"><p class="cl-fce434b0"><span class="cl-fcdff35b">49 (27.7)</span></p></td><td class="cl-fce457a6"><p class="cl-fce434b0"><span class="cl-fcdff35b">14 (7.9)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-fce457a6"><p class="cl-fce434b0"><span class="cl-fcdff35b"></span></p></td><td class="cl-fce457a7"><p class="cl-fce434b0"><span class="cl-fcdff35b">Saturday</span></p></td><td class="cl-fce457a6"><p class="cl-fce434b0"><span class="cl-fcdff35b">160 (63.2)</span></p></td><td class="cl-fce457a6"><p class="cl-fce434b0"><span class="cl-fcdff35b">81 (32)</span></p></td><td class="cl-fce457a6"><p class="cl-fce434b0"><span class="cl-fcdff35b">12 (4.7)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-fce457a6"><p class="cl-fce434b0"><span class="cl-fcdff35b"></span></p></td><td class="cl-fce457a7"><p class="cl-fce434b0"><span class="cl-fcdff35b">Sunday</span></p></td><td class="cl-fce457a6"><p class="cl-fce434b0"><span class="cl-fcdff35b">156 (56.3)</span></p></td><td class="cl-fce457a6"><p class="cl-fce434b0"><span class="cl-fcdff35b">100 (36.1)</span></p></td><td class="cl-fce457a6"><p class="cl-fce434b0"><span class="cl-fcdff35b">21 (7.6)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-fce457a6"><p class="cl-fce434b0"><span class="cl-fcdff35b"></span></p></td><td class="cl-fce457a7"><p class="cl-fce434b0"><span class="cl-fcdff35b">Thursday</span></p></td><td class="cl-fce457a6"><p class="cl-fce434b0"><span class="cl-fcdff35b">167 (66)</span></p></td><td class="cl-fce457a6"><p class="cl-fce434b0"><span class="cl-fcdff35b">66 (26.1)</span></p></td><td class="cl-fce457a6"><p class="cl-fce434b0"><span class="cl-fcdff35b">20 (7.9)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-fce457a6"><p class="cl-fce434b0"><span class="cl-fcdff35b"></span></p></td><td class="cl-fce457a7"><p class="cl-fce434b0"><span class="cl-fcdff35b">Tuesday</span></p></td><td class="cl-fce457a6"><p class="cl-fce434b0"><span class="cl-fcdff35b">108 (65.5)</span></p></td><td class="cl-fce457a6"><p class="cl-fce434b0"><span class="cl-fcdff35b">43 (26.1)</span></p></td><td class="cl-fce457a6"><p class="cl-fce434b0"><span class="cl-fcdff35b">14 (8.5)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-fce457a8"><p class="cl-fce434b0"><span class="cl-fcdff35b"></span></p></td><td class="cl-fce457b0"><p class="cl-fce434b0"><span class="cl-fcdff35b">Wednesday</span></p></td><td class="cl-fce457a8"><p class="cl-fce434b0"><span class="cl-fcdff35b">109 (44)</span></p></td><td class="cl-fce457a8"><p class="cl-fce434b0"><span class="cl-fcdff35b">102 (41.1)</span></p></td><td class="cl-fce457a8"><p class="cl-fce434b0"><span class="cl-fcdff35b">37 (14.9)</span></p></td></tr></tbody><tfoot><tr style="overflow-wrap:break-word;"><td colspan="5" class="cl-fce457ba"><p class="cl-fce434ba"><span class="cl-fcdff364">·µÉ</span><span class="cl-fcdff35b">Vaccination proportions were calculated row-wise (i.e., by row).</span></p></td></tr></tfoot></table></div>
</div>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="co"># .................. Clean up ..................</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(tab_age, tab_sex, tab_marital_status, tab_year, tab_quarter, tab_weekday, </span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>   tab_combined, ft_vacc_summary, totals, create_tab)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="all-lines-visible" class="level2" data-number="1.7">
<h2 data-number="1.7" class="anchored" data-anchor-id="all-lines-visible"><span class="header-section-number">1.7</span> <strong>7. All Lines Visible</strong></h2>
<p>This version includes both <strong>horizontal and vertical grid lines</strong>, mimicking Excel-style tables.</p>
<p>üìä <em>When to use</em>: When presenting detailed tables where structure must be visually enforced.</p>
<p>üì¶ <em>Applicability</em>: Regulatory reports, appendices, or complex data breakdowns.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ------------6. Lines: All Lines Visible-------------------------------------------</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a><span class="co"># .................. Convert grouping vars to character ..................</span></span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>vacc_1524 <span class="ot">&lt;-</span> vacc_1524 <span class="sc">%&gt;%</span></span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">c</span>(age_group, gender, marital_status,</span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a>                  vacc_service_year, vacc_quarter, vacc_weekday), as.character))</span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a><span class="co"># .................. Table generation function with Missing ..................</span></span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true" tabindex="-1"></a>create_tab <span class="ot">&lt;-</span> <span class="cf">function</span>(data, var, label) {</span>
<span id="cb25-10"><a href="#cb25-10" aria-hidden="true" tabindex="-1"></a>  tab_main <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span></span>
<span id="cb25-11"><a href="#cb25-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>({{ var }})) <span class="sc">%&gt;%</span></span>
<span id="cb25-12"><a href="#cb25-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tabyl</span>({{ var }}, vacc_group3) <span class="sc">%&gt;%</span></span>
<span id="cb25-13"><a href="#cb25-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">Category =</span> label, <span class="at">.before =</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb25-14"><a href="#cb25-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rename</span>(<span class="at">Label =</span> {{ var }}) <span class="sc">%&gt;%</span></span>
<span id="cb25-15"><a href="#cb25-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">Label =</span> <span class="fu">as.character</span>(Label))</span>
<span id="cb25-16"><a href="#cb25-16" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb25-17"><a href="#cb25-17" aria-hidden="true" tabindex="-1"></a>  na_count <span class="ot">&lt;-</span> <span class="fu">sum</span>(<span class="fu">is.na</span>(<span class="fu">pull</span>(data, {{ var }})))</span>
<span id="cb25-18"><a href="#cb25-18" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb25-19"><a href="#cb25-19" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (na_count <span class="sc">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb25-20"><a href="#cb25-20" aria-hidden="true" tabindex="-1"></a>    missing_row <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb25-21"><a href="#cb25-21" aria-hidden="true" tabindex="-1"></a>      <span class="at">Category =</span> label,</span>
<span id="cb25-22"><a href="#cb25-22" aria-hidden="true" tabindex="-1"></a>      <span class="at">Label =</span> <span class="st">"Missing"</span>,</span>
<span id="cb25-23"><a href="#cb25-23" aria-hidden="true" tabindex="-1"></a>      <span class="st">`</span><span class="at">Respiratory vaccines</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">sum</span>(data<span class="sc">$</span>vacc_group3 <span class="sc">==</span> <span class="st">"Respiratory vaccines"</span> <span class="sc">&amp;</span> <span class="fu">is.na</span>(<span class="fu">pull</span>(data, {{ var }})), <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb25-24"><a href="#cb25-24" aria-hidden="true" tabindex="-1"></a>      <span class="st">`</span><span class="at">Childhood vaccines</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">sum</span>(data<span class="sc">$</span>vacc_group3 <span class="sc">==</span> <span class="st">"Childhood vaccines"</span> <span class="sc">&amp;</span> <span class="fu">is.na</span>(<span class="fu">pull</span>(data, {{ var }})), <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb25-25"><a href="#cb25-25" aria-hidden="true" tabindex="-1"></a>      <span class="at">Other =</span> <span class="fu">sum</span>(data<span class="sc">$</span>vacc_group3 <span class="sc">==</span> <span class="st">"Other"</span> <span class="sc">&amp;</span> <span class="fu">is.na</span>(<span class="fu">pull</span>(data, {{ var }})), <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb25-26"><a href="#cb25-26" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb25-27"><a href="#cb25-27" aria-hidden="true" tabindex="-1"></a>    tab_final <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(tab_main, missing_row)</span>
<span id="cb25-28"><a href="#cb25-28" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb25-29"><a href="#cb25-29" aria-hidden="true" tabindex="-1"></a>    tab_final <span class="ot">&lt;-</span> tab_main</span>
<span id="cb25-30"><a href="#cb25-30" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb25-31"><a href="#cb25-31" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb25-32"><a href="#cb25-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(tab_final)</span>
<span id="cb25-33"><a href="#cb25-33" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb25-34"><a href="#cb25-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-35"><a href="#cb25-35" aria-hidden="true" tabindex="-1"></a><span class="co"># .................. Create summary tables ..................</span></span>
<span id="cb25-36"><a href="#cb25-36" aria-hidden="true" tabindex="-1"></a>tab_age            <span class="ot">&lt;-</span> <span class="fu">create_tab</span>(vacc_1524, age_group, <span class="st">"Age"</span>)</span>
<span id="cb25-37"><a href="#cb25-37" aria-hidden="true" tabindex="-1"></a>tab_sex            <span class="ot">&lt;-</span> <span class="fu">create_tab</span>(vacc_1524, gender, <span class="st">"Gender"</span>)</span>
<span id="cb25-38"><a href="#cb25-38" aria-hidden="true" tabindex="-1"></a>tab_marital_status <span class="ot">&lt;-</span> <span class="fu">create_tab</span>(vacc_1524, marital_status, <span class="st">"Marital status"</span>)</span>
<span id="cb25-39"><a href="#cb25-39" aria-hidden="true" tabindex="-1"></a>tab_year           <span class="ot">&lt;-</span> <span class="fu">create_tab</span>(vacc_1524, vacc_service_year, <span class="st">"Year"</span>)</span>
<span id="cb25-40"><a href="#cb25-40" aria-hidden="true" tabindex="-1"></a>tab_quarter        <span class="ot">&lt;-</span> <span class="fu">create_tab</span>(vacc_1524, vacc_quarter, <span class="st">"Quarter"</span>)</span>
<span id="cb25-41"><a href="#cb25-41" aria-hidden="true" tabindex="-1"></a>tab_weekday        <span class="ot">&lt;-</span> <span class="fu">create_tab</span>(vacc_1524, vacc_weekday, <span class="st">"Weekday"</span>)</span>
<span id="cb25-42"><a href="#cb25-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-43"><a href="#cb25-43" aria-hidden="true" tabindex="-1"></a><span class="co"># .................. Combine all tables ..................</span></span>
<span id="cb25-44"><a href="#cb25-44" aria-hidden="true" tabindex="-1"></a>tab_combined <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(tab_sex, tab_age, tab_marital_status, tab_year, tab_quarter, tab_weekday)</span>
<span id="cb25-45"><a href="#cb25-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-46"><a href="#cb25-46" aria-hidden="true" tabindex="-1"></a><span class="co"># .................. Calculate row-wise percentages (skip for Missing) ..................</span></span>
<span id="cb25-47"><a href="#cb25-47" aria-hidden="true" tabindex="-1"></a>tab_combined <span class="ot">&lt;-</span> tab_combined <span class="sc">%&gt;%</span></span>
<span id="cb25-48"><a href="#cb25-48" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rowwise</span>() <span class="sc">%&gt;%</span></span>
<span id="cb25-49"><a href="#cb25-49" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb25-50"><a href="#cb25-50" aria-hidden="true" tabindex="-1"></a>    <span class="at">Total =</span> <span class="fu">sum</span>(<span class="st">`</span><span class="at">Respiratory vaccines</span><span class="st">`</span>, <span class="st">`</span><span class="at">Childhood vaccines</span><span class="st">`</span>, Other, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb25-51"><a href="#cb25-51" aria-hidden="true" tabindex="-1"></a>    <span class="at">is_missing =</span> <span class="fu">trimws</span>(<span class="fu">tolower</span>(Label)) <span class="sc">==</span> <span class="st">"missing"</span>,</span>
<span id="cb25-52"><a href="#cb25-52" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb25-53"><a href="#cb25-53" aria-hidden="true" tabindex="-1"></a>    <span class="at">Respiratory =</span> <span class="fu">ifelse</span>(is_missing,</span>
<span id="cb25-54"><a href="#cb25-54" aria-hidden="true" tabindex="-1"></a>                         <span class="fu">comma</span>(<span class="st">`</span><span class="at">Respiratory vaccines</span><span class="st">`</span>),</span>
<span id="cb25-55"><a href="#cb25-55" aria-hidden="true" tabindex="-1"></a>                         <span class="fu">paste0</span>(<span class="fu">comma</span>(<span class="st">`</span><span class="at">Respiratory vaccines</span><span class="st">`</span>), <span class="st">" ("</span>, <span class="fu">round</span>(<span class="dv">100</span> <span class="sc">*</span> <span class="st">`</span><span class="at">Respiratory vaccines</span><span class="st">`</span> <span class="sc">/</span> Total, <span class="dv">1</span>), <span class="st">")"</span>)),</span>
<span id="cb25-56"><a href="#cb25-56" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb25-57"><a href="#cb25-57" aria-hidden="true" tabindex="-1"></a>    <span class="at">Childhood =</span> <span class="fu">ifelse</span>(is_missing,</span>
<span id="cb25-58"><a href="#cb25-58" aria-hidden="true" tabindex="-1"></a>                       <span class="fu">comma</span>(<span class="st">`</span><span class="at">Childhood vaccines</span><span class="st">`</span>),</span>
<span id="cb25-59"><a href="#cb25-59" aria-hidden="true" tabindex="-1"></a>                       <span class="fu">paste0</span>(<span class="fu">comma</span>(<span class="st">`</span><span class="at">Childhood vaccines</span><span class="st">`</span>), <span class="st">" ("</span>, <span class="fu">round</span>(<span class="dv">100</span> <span class="sc">*</span> <span class="st">`</span><span class="at">Childhood vaccines</span><span class="st">`</span> <span class="sc">/</span> Total, <span class="dv">1</span>), <span class="st">")"</span>)),</span>
<span id="cb25-60"><a href="#cb25-60" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb25-61"><a href="#cb25-61" aria-hidden="true" tabindex="-1"></a>    <span class="at">Other_grp =</span> <span class="fu">ifelse</span>(is_missing,</span>
<span id="cb25-62"><a href="#cb25-62" aria-hidden="true" tabindex="-1"></a>                       <span class="fu">comma</span>(Other),</span>
<span id="cb25-63"><a href="#cb25-63" aria-hidden="true" tabindex="-1"></a>                       <span class="fu">paste0</span>(<span class="fu">comma</span>(Other), <span class="st">" ("</span>, <span class="fu">round</span>(<span class="dv">100</span> <span class="sc">*</span> Other <span class="sc">/</span> Total, <span class="dv">1</span>), <span class="st">")"</span>))</span>
<span id="cb25-64"><a href="#cb25-64" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb25-65"><a href="#cb25-65" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb25-66"><a href="#cb25-66" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Category, Label, Respiratory, Childhood, Other_grp)</span>
<span id="cb25-67"><a href="#cb25-67" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-68"><a href="#cb25-68" aria-hidden="true" tabindex="-1"></a><span class="co"># .................. Show Category only once per group ..................</span></span>
<span id="cb25-69"><a href="#cb25-69" aria-hidden="true" tabindex="-1"></a>tab_combined <span class="ot">&lt;-</span> tab_combined <span class="sc">%&gt;%</span></span>
<span id="cb25-70"><a href="#cb25-70" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Category) <span class="sc">%&gt;%</span></span>
<span id="cb25-71"><a href="#cb25-71" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Category =</span> <span class="fu">ifelse</span>(<span class="fu">row_number</span>() <span class="sc">==</span> <span class="dv">1</span>, Category, <span class="st">""</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb25-72"><a href="#cb25-72" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb25-73"><a href="#cb25-73" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-74"><a href="#cb25-74" aria-hidden="true" tabindex="-1"></a><span class="co"># .................. Get total counts per vaccine group ..................</span></span>
<span id="cb25-75"><a href="#cb25-75" aria-hidden="true" tabindex="-1"></a>totals <span class="ot">&lt;-</span> vacc_1524 <span class="sc">%&gt;%</span></span>
<span id="cb25-76"><a href="#cb25-76" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(vacc_group3) <span class="sc">%&gt;%</span></span>
<span id="cb25-77"><a href="#cb25-77" aria-hidden="true" tabindex="-1"></a>  <span class="fu">deframe</span>()</span>
<span id="cb25-78"><a href="#cb25-78" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-79"><a href="#cb25-79" aria-hidden="true" tabindex="-1"></a><span class="co"># .................. Create flextable ..................</span></span>
<span id="cb25-80"><a href="#cb25-80" aria-hidden="true" tabindex="-1"></a>ft_vacc_summary <span class="ot">&lt;-</span> tab_combined <span class="sc">%&gt;%</span></span>
<span id="cb25-81"><a href="#cb25-81" aria-hidden="true" tabindex="-1"></a>  <span class="fu">flextable</span>() <span class="sc">%&gt;%</span></span>
<span id="cb25-82"><a href="#cb25-82" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_header_labels</span>(</span>
<span id="cb25-83"><a href="#cb25-83" aria-hidden="true" tabindex="-1"></a>    <span class="at">Category =</span> <span class="st">"Variable type"</span>,</span>
<span id="cb25-84"><a href="#cb25-84" aria-hidden="true" tabindex="-1"></a>    <span class="at">Label =</span> <span class="st">"Values"</span>,</span>
<span id="cb25-85"><a href="#cb25-85" aria-hidden="true" tabindex="-1"></a>    <span class="at">Respiratory =</span> <span class="st">"Number (%)·µÉ"</span>,</span>
<span id="cb25-86"><a href="#cb25-86" aria-hidden="true" tabindex="-1"></a>    <span class="at">Childhood =</span> <span class="st">"Number (%)·µÉ"</span>,</span>
<span id="cb25-87"><a href="#cb25-87" aria-hidden="true" tabindex="-1"></a>    <span class="at">Other_grp =</span> <span class="st">"Number (%)·µÉ"</span></span>
<span id="cb25-88"><a href="#cb25-88" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb25-89"><a href="#cb25-89" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_header_row</span>(</span>
<span id="cb25-90"><a href="#cb25-90" aria-hidden="true" tabindex="-1"></a>    <span class="at">values =</span> <span class="fu">c</span>(</span>
<span id="cb25-91"><a href="#cb25-91" aria-hidden="true" tabindex="-1"></a>      <span class="st">""</span>, <span class="st">""</span>,</span>
<span id="cb25-92"><a href="#cb25-92" aria-hidden="true" tabindex="-1"></a>      <span class="fu">paste0</span>(<span class="st">"Respiratory vaccines (N = "</span>, <span class="fu">format</span>(totals[<span class="st">"Respiratory vaccines"</span>], <span class="at">big.mark =</span> <span class="st">","</span>), <span class="st">")"</span>),</span>
<span id="cb25-93"><a href="#cb25-93" aria-hidden="true" tabindex="-1"></a>      <span class="fu">paste0</span>(<span class="st">"Childhood vaccines (N = "</span>, <span class="fu">format</span>(totals[<span class="st">"Childhood vaccines"</span>], <span class="at">big.mark =</span> <span class="st">","</span>), <span class="st">")"</span>),</span>
<span id="cb25-94"><a href="#cb25-94" aria-hidden="true" tabindex="-1"></a>      <span class="fu">paste0</span>(<span class="st">"Other (N = "</span>, <span class="fu">format</span>(totals[<span class="st">"Other"</span>], <span class="at">big.mark =</span> <span class="st">","</span>), <span class="st">")"</span>)</span>
<span id="cb25-95"><a href="#cb25-95" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb25-96"><a href="#cb25-96" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb25-97"><a href="#cb25-97" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_header_row</span>(</span>
<span id="cb25-98"><a href="#cb25-98" aria-hidden="true" tabindex="-1"></a>    <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"Description"</span>, <span class="st">"Vaccination uptake"</span>),</span>
<span id="cb25-99"><a href="#cb25-99" aria-hidden="true" tabindex="-1"></a>    <span class="at">colwidths =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">3</span>)</span>
<span id="cb25-100"><a href="#cb25-100" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb25-101"><a href="#cb25-101" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_box</span>() <span class="sc">%&gt;%</span></span>
<span id="cb25-102"><a href="#cb25-102" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_table_properties</span>(<span class="at">layout =</span> <span class="st">"autofit"</span>, <span class="at">width =</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb25-103"><a href="#cb25-103" aria-hidden="true" tabindex="-1"></a>  <span class="fu">width</span>(<span class="at">j =</span> <span class="dv">1</span>, <span class="at">width =</span> <span class="fl">1.5</span>) <span class="sc">%&gt;%</span></span>
<span id="cb25-104"><a href="#cb25-104" aria-hidden="true" tabindex="-1"></a>  <span class="fu">width</span>(<span class="at">j =</span> <span class="dv">2</span>, <span class="at">width =</span> <span class="fl">2.5</span>) <span class="sc">%&gt;%</span></span>
<span id="cb25-105"><a href="#cb25-105" aria-hidden="true" tabindex="-1"></a>  <span class="fu">width</span>(<span class="at">j =</span> <span class="dv">3</span><span class="sc">:</span><span class="dv">5</span>, <span class="at">width =</span> <span class="fl">1.5</span>) <span class="sc">%&gt;%</span></span>
<span id="cb25-106"><a href="#cb25-106" aria-hidden="true" tabindex="-1"></a>  <span class="fu">align</span>(<span class="at">align =</span> <span class="st">"justify"</span>, <span class="at">part =</span> <span class="st">"all"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb25-107"><a href="#cb25-107" aria-hidden="true" tabindex="-1"></a>  <span class="fu">border_inner_h</span>(<span class="at">border =</span> <span class="fu">fp_border</span>(<span class="at">color =</span> <span class="st">"black"</span>, <span class="at">width =</span> <span class="dv">1</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb25-108"><a href="#cb25-108" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_caption</span>(<span class="st">"Table: Vaccination uptake across service year, quarter, and weekday"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb25-109"><a href="#cb25-109" aria-hidden="true" tabindex="-1"></a>  <span class="fu">footnote</span>(<span class="at">i =</span> <span class="dv">1</span>, </span>
<span id="cb25-110"><a href="#cb25-110" aria-hidden="true" tabindex="-1"></a>           <span class="at">value =</span> <span class="fu">as_paragraph</span>(<span class="st">"Vaccination proportions were calculated row-wise (i.e., by row)."</span>),</span>
<span id="cb25-111"><a href="#cb25-111" aria-hidden="true" tabindex="-1"></a>           <span class="at">ref_symbols =</span> <span class="st">"·µÉ"</span>, </span>
<span id="cb25-112"><a href="#cb25-112" aria-hidden="true" tabindex="-1"></a>           <span class="at">part =</span> <span class="st">"header"</span>)</span>
<span id="cb25-113"><a href="#cb25-113" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-114"><a href="#cb25-114" aria-hidden="true" tabindex="-1"></a><span class="co"># .................. Show the table ..................</span></span>
<span id="cb25-115"><a href="#cb25-115" aria-hidden="true" tabindex="-1"></a>ft_vacc_summary</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="tabwid"><style>.cl-fd32fee2{table-layout:auto;width:100%;}.cl-fd296cf6{font-family:'Arial';font-size:11pt;font-weight:bold;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-fd296d00{font-family:'Arial';font-size:6.6pt;font-weight:bold;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;position: relative;bottom:3.3pt;}.cl-fd296d01{font-family:'Arial';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-fd296d02{font-family:'Arial';font-size:6.6pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;position: relative;bottom:3.3pt;}.cl-fd2d975e{margin:0;text-align:justify;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-fd2d9768{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-fd2dbbc6{background-color:transparent;vertical-align: middle;border-bottom: 0.75pt solid rgba(102, 102, 102, 1.00);border-top: 0.75pt solid rgba(102, 102, 102, 1.00);border-left: 0.75pt solid rgba(102, 102, 102, 1.00);border-right: 0.75pt solid rgba(102, 102, 102, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-fd2dbbc7{background-color:transparent;vertical-align: middle;border-bottom: 0.75pt solid rgba(102, 102, 102, 1.00);border-top: 0.75pt solid rgba(102, 102, 102, 1.00);border-left: 0.75pt solid rgba(102, 102, 102, 1.00);border-right: 0.75pt solid rgba(102, 102, 102, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-fd2dbbd0{background-color:transparent;vertical-align: middle;border-bottom: 1pt solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0.75pt solid rgba(102, 102, 102, 1.00);border-right: 0.75pt solid rgba(102, 102, 102, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-fd2dbbd1{background-color:transparent;vertical-align: middle;border-bottom: 1pt solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0.75pt solid rgba(102, 102, 102, 1.00);border-right: 0.75pt solid rgba(102, 102, 102, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-fd2dbbd2{background-color:transparent;vertical-align: middle;border-bottom: 1pt solid rgba(0, 0, 0, 1.00);border-top: 1pt solid rgba(0, 0, 0, 1.00);border-left: 0.75pt solid rgba(102, 102, 102, 1.00);border-right: 0.75pt solid rgba(102, 102, 102, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-fd2dbbda{background-color:transparent;vertical-align: middle;border-bottom: 1pt solid rgba(0, 0, 0, 1.00);border-top: 1pt solid rgba(0, 0, 0, 1.00);border-left: 0.75pt solid rgba(102, 102, 102, 1.00);border-right: 0.75pt solid rgba(102, 102, 102, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-fd2dbbdb{background-color:transparent;vertical-align: middle;border-bottom: 0.75pt solid rgba(102, 102, 102, 1.00);border-top: 1pt solid rgba(0, 0, 0, 1.00);border-left: 0.75pt solid rgba(102, 102, 102, 1.00);border-right: 0.75pt solid rgba(102, 102, 102, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-fd2dbbdc{background-color:transparent;vertical-align: middle;border-bottom: 0.75pt solid rgba(102, 102, 102, 1.00);border-top: 1pt solid rgba(0, 0, 0, 1.00);border-left: 0.75pt solid rgba(102, 102, 102, 1.00);border-right: 0.75pt solid rgba(102, 102, 102, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-fd2dbbe4{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(255, 255, 255, 0.00);border-top: 0 solid rgba(255, 255, 255, 0.00);border-left: 0 solid rgba(255, 255, 255, 0.00);border-right: 0 solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-fd2dbbe5{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(255, 255, 255, 0.00);border-top: 0 solid rgba(255, 255, 255, 0.00);border-left: 0 solid rgba(255, 255, 255, 0.00);border-right: 0 solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table data-quarto-disable-processing="true" class="cl-fd32fee2"><thead><tr style="overflow-wrap:break-word;"><th colspan="2" class="cl-fd2dbbc6"><p class="cl-fd2d975e"><span class="cl-fd296cf6">Description</span><span class="cl-fd296d00">·µÉ</span></p></th><th colspan="3" class="cl-fd2dbbc6"><p class="cl-fd2d975e"><span class="cl-fd296cf6">Vaccination uptake</span><span class="cl-fd296d00">·µÉ</span></p></th></tr><tr style="overflow-wrap:break-word;"><th class="cl-fd2dbbc6"><p class="cl-fd2d975e"><span class="cl-fd296cf6"></span></p></th><th class="cl-fd2dbbc7"><p class="cl-fd2d975e"><span class="cl-fd296cf6"></span></p></th><th class="cl-fd2dbbc6"><p class="cl-fd2d975e"><span class="cl-fd296cf6">Respiratory vaccines (N = 955)</span></p></th><th class="cl-fd2dbbc6"><p class="cl-fd2d975e"><span class="cl-fd296cf6">Childhood vaccines (N = 472)</span></p></th><th class="cl-fd2dbbc6"><p class="cl-fd2d975e"><span class="cl-fd296cf6">Other (N = 126)</span></p></th></tr><tr style="overflow-wrap:break-word;"><th class="cl-fd2dbbc6"><p class="cl-fd2d975e"><span class="cl-fd296cf6">Variable type</span></p></th><th class="cl-fd2dbbc7"><p class="cl-fd2d975e"><span class="cl-fd296cf6">Values</span></p></th><th class="cl-fd2dbbc6"><p class="cl-fd2d975e"><span class="cl-fd296cf6">Number (%)·µÉ</span></p></th><th class="cl-fd2dbbc6"><p class="cl-fd2d975e"><span class="cl-fd296cf6">Number (%)·µÉ</span></p></th><th class="cl-fd2dbbc6"><p class="cl-fd2d975e"><span class="cl-fd296cf6">Number (%)·µÉ</span></p></th></tr></thead><tbody><tr style="overflow-wrap:break-word;"><td class="cl-fd2dbbd0"><p class="cl-fd2d975e"><span class="cl-fd296d01">Gender</span></p></td><td class="cl-fd2dbbd1"><p class="cl-fd2d975e"><span class="cl-fd296d01">Female</span></p></td><td class="cl-fd2dbbd0"><p class="cl-fd2d975e"><span class="cl-fd296d01">511 (64)</span></p></td><td class="cl-fd2dbbd0"><p class="cl-fd2d975e"><span class="cl-fd296d01">233 (29.2)</span></p></td><td class="cl-fd2dbbd0"><p class="cl-fd2d975e"><span class="cl-fd296d01">54 (6.8)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-fd2dbbd2"><p class="cl-fd2d975e"><span class="cl-fd296d01"></span></p></td><td class="cl-fd2dbbda"><p class="cl-fd2d975e"><span class="cl-fd296d01">Male</span></p></td><td class="cl-fd2dbbd2"><p class="cl-fd2d975e"><span class="cl-fd296d01">444 (58.8)</span></p></td><td class="cl-fd2dbbd2"><p class="cl-fd2d975e"><span class="cl-fd296d01">239 (31.7)</span></p></td><td class="cl-fd2dbbd2"><p class="cl-fd2d975e"><span class="cl-fd296d01">72 (9.5)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-fd2dbbd2"><p class="cl-fd2d975e"><span class="cl-fd296d01">Age</span></p></td><td class="cl-fd2dbbda"><p class="cl-fd2d975e"><span class="cl-fd296d01">0-19</span></p></td><td class="cl-fd2dbbd2"><p class="cl-fd2d975e"><span class="cl-fd296d01">250 (38.9)</span></p></td><td class="cl-fd2dbbd2"><p class="cl-fd2d975e"><span class="cl-fd296d01">302 (47)</span></p></td><td class="cl-fd2dbbd2"><p class="cl-fd2d975e"><span class="cl-fd296d01">90 (14)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-fd2dbbd2"><p class="cl-fd2d975e"><span class="cl-fd296d01"></span></p></td><td class="cl-fd2dbbda"><p class="cl-fd2d975e"><span class="cl-fd296d01">20-29</span></p></td><td class="cl-fd2dbbd2"><p class="cl-fd2d975e"><span class="cl-fd296d01">150 (68.2)</span></p></td><td class="cl-fd2dbbd2"><p class="cl-fd2d975e"><span class="cl-fd296d01">70 (31.8)</span></p></td><td class="cl-fd2dbbd2"><p class="cl-fd2d975e"><span class="cl-fd296d01">0 (0)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-fd2dbbd2"><p class="cl-fd2d975e"><span class="cl-fd296d01"></span></p></td><td class="cl-fd2dbbda"><p class="cl-fd2d975e"><span class="cl-fd296d01">30-39</span></p></td><td class="cl-fd2dbbd2"><p class="cl-fd2d975e"><span class="cl-fd296d01">47 (71.2)</span></p></td><td class="cl-fd2dbbd2"><p class="cl-fd2d975e"><span class="cl-fd296d01">19 (28.8)</span></p></td><td class="cl-fd2dbbd2"><p class="cl-fd2d975e"><span class="cl-fd296d01">0 (0)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-fd2dbbd2"><p class="cl-fd2d975e"><span class="cl-fd296d01"></span></p></td><td class="cl-fd2dbbda"><p class="cl-fd2d975e"><span class="cl-fd296d01">40-49</span></p></td><td class="cl-fd2dbbd2"><p class="cl-fd2d975e"><span class="cl-fd296d01">142 (75.9)</span></p></td><td class="cl-fd2dbbd2"><p class="cl-fd2d975e"><span class="cl-fd296d01">45 (24.1)</span></p></td><td class="cl-fd2dbbd2"><p class="cl-fd2d975e"><span class="cl-fd296d01">0 (0)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-fd2dbbd2"><p class="cl-fd2d975e"><span class="cl-fd296d01"></span></p></td><td class="cl-fd2dbbda"><p class="cl-fd2d975e"><span class="cl-fd296d01">50-59</span></p></td><td class="cl-fd2dbbd2"><p class="cl-fd2d975e"><span class="cl-fd296d01">112 (77.8)</span></p></td><td class="cl-fd2dbbd2"><p class="cl-fd2d975e"><span class="cl-fd296d01">14 (9.7)</span></p></td><td class="cl-fd2dbbd2"><p class="cl-fd2d975e"><span class="cl-fd296d01">18 (12.5)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-fd2dbbd2"><p class="cl-fd2d975e"><span class="cl-fd296d01"></span></p></td><td class="cl-fd2dbbda"><p class="cl-fd2d975e"><span class="cl-fd296d01">60-69</span></p></td><td class="cl-fd2dbbd2"><p class="cl-fd2d975e"><span class="cl-fd296d01">149 (87.6)</span></p></td><td class="cl-fd2dbbd2"><p class="cl-fd2d975e"><span class="cl-fd296d01">13 (7.6)</span></p></td><td class="cl-fd2dbbd2"><p class="cl-fd2d975e"><span class="cl-fd296d01">8 (4.7)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-fd2dbbd2"><p class="cl-fd2d975e"><span class="cl-fd296d01"></span></p></td><td class="cl-fd2dbbda"><p class="cl-fd2d975e"><span class="cl-fd296d01">70+</span></p></td><td class="cl-fd2dbbd2"><p class="cl-fd2d975e"><span class="cl-fd296d01">105 (84.7)</span></p></td><td class="cl-fd2dbbd2"><p class="cl-fd2d975e"><span class="cl-fd296d01">9 (7.3)</span></p></td><td class="cl-fd2dbbd2"><p class="cl-fd2d975e"><span class="cl-fd296d01">10 (8.1)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-fd2dbbd2"><p class="cl-fd2d975e"><span class="cl-fd296d01">Marital status</span></p></td><td class="cl-fd2dbbda"><p class="cl-fd2d975e"><span class="cl-fd296d01">Divorced</span></p></td><td class="cl-fd2dbbd2"><p class="cl-fd2d975e"><span class="cl-fd296d01">136 (83.4)</span></p></td><td class="cl-fd2dbbd2"><p class="cl-fd2d975e"><span class="cl-fd296d01">15 (9.2)</span></p></td><td class="cl-fd2dbbd2"><p class="cl-fd2d975e"><span class="cl-fd296d01">12 (7.4)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-fd2dbbd2"><p class="cl-fd2d975e"><span class="cl-fd296d01"></span></p></td><td class="cl-fd2dbbda"><p class="cl-fd2d975e"><span class="cl-fd296d01">Married</span></p></td><td class="cl-fd2dbbd2"><p class="cl-fd2d975e"><span class="cl-fd296d01">289 (79)</span></p></td><td class="cl-fd2dbbd2"><p class="cl-fd2d975e"><span class="cl-fd296d01">59 (16.1)</span></p></td><td class="cl-fd2dbbd2"><p class="cl-fd2d975e"><span class="cl-fd296d01">18 (4.9)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-fd2dbbd2"><p class="cl-fd2d975e"><span class="cl-fd296d01"></span></p></td><td class="cl-fd2dbbda"><p class="cl-fd2d975e"><span class="cl-fd296d01">Single/widowed</span></p></td><td class="cl-fd2dbbd2"><p class="cl-fd2d975e"><span class="cl-fd296d01">150 (79.4)</span></p></td><td class="cl-fd2dbbd2"><p class="cl-fd2d975e"><span class="cl-fd296d01">33 (17.5)</span></p></td><td class="cl-fd2dbbd2"><p class="cl-fd2d975e"><span class="cl-fd296d01">6 (3.2)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-fd2dbbd2"><p class="cl-fd2d975e"><span class="cl-fd296d01"></span></p></td><td class="cl-fd2dbbda"><p class="cl-fd2d975e"><span class="cl-fd296d01">Missing</span></p></td><td class="cl-fd2dbbd2"><p class="cl-fd2d975e"><span class="cl-fd296d01">380</span></p></td><td class="cl-fd2dbbd2"><p class="cl-fd2d975e"><span class="cl-fd296d01">365</span></p></td><td class="cl-fd2dbbd2"><p class="cl-fd2d975e"><span class="cl-fd296d01">90</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-fd2dbbd2"><p class="cl-fd2d975e"><span class="cl-fd296d01">Year</span></p></td><td class="cl-fd2dbbda"><p class="cl-fd2d975e"><span class="cl-fd296d01">2015</span></p></td><td class="cl-fd2dbbd2"><p class="cl-fd2d975e"><span class="cl-fd296d01">78 (51)</span></p></td><td class="cl-fd2dbbd2"><p class="cl-fd2d975e"><span class="cl-fd296d01">56 (36.6)</span></p></td><td class="cl-fd2dbbd2"><p class="cl-fd2d975e"><span class="cl-fd296d01">19 (12.4)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-fd2dbbd2"><p class="cl-fd2d975e"><span class="cl-fd296d01"></span></p></td><td class="cl-fd2dbbda"><p class="cl-fd2d975e"><span class="cl-fd296d01">2016</span></p></td><td class="cl-fd2dbbd2"><p class="cl-fd2d975e"><span class="cl-fd296d01">84 (60.4)</span></p></td><td class="cl-fd2dbbd2"><p class="cl-fd2d975e"><span class="cl-fd296d01">47 (33.8)</span></p></td><td class="cl-fd2dbbd2"><p class="cl-fd2d975e"><span class="cl-fd296d01">8 (5.8)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-fd2dbbd2"><p class="cl-fd2d975e"><span class="cl-fd296d01"></span></p></td><td class="cl-fd2dbbda"><p class="cl-fd2d975e"><span class="cl-fd296d01">2017</span></p></td><td class="cl-fd2dbbd2"><p class="cl-fd2d975e"><span class="cl-fd296d01">75 (54.7)</span></p></td><td class="cl-fd2dbbd2"><p class="cl-fd2d975e"><span class="cl-fd296d01">52 (38)</span></p></td><td class="cl-fd2dbbd2"><p class="cl-fd2d975e"><span class="cl-fd296d01">10 (7.3)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-fd2dbbd2"><p class="cl-fd2d975e"><span class="cl-fd296d01"></span></p></td><td class="cl-fd2dbbda"><p class="cl-fd2d975e"><span class="cl-fd296d01">2018</span></p></td><td class="cl-fd2dbbd2"><p class="cl-fd2d975e"><span class="cl-fd296d01">81 (53.6)</span></p></td><td class="cl-fd2dbbd2"><p class="cl-fd2d975e"><span class="cl-fd296d01">52 (34.4)</span></p></td><td class="cl-fd2dbbd2"><p class="cl-fd2d975e"><span class="cl-fd296d01">18 (11.9)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-fd2dbbd2"><p class="cl-fd2d975e"><span class="cl-fd296d01"></span></p></td><td class="cl-fd2dbbda"><p class="cl-fd2d975e"><span class="cl-fd296d01">2019</span></p></td><td class="cl-fd2dbbd2"><p class="cl-fd2d975e"><span class="cl-fd296d01">83 (51.6)</span></p></td><td class="cl-fd2dbbd2"><p class="cl-fd2d975e"><span class="cl-fd296d01">60 (37.3)</span></p></td><td class="cl-fd2dbbd2"><p class="cl-fd2d975e"><span class="cl-fd296d01">18 (11.2)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-fd2dbbd2"><p class="cl-fd2d975e"><span class="cl-fd296d01"></span></p></td><td class="cl-fd2dbbda"><p class="cl-fd2d975e"><span class="cl-fd296d01">2020</span></p></td><td class="cl-fd2dbbd2"><p class="cl-fd2d975e"><span class="cl-fd296d01">82 (59.9)</span></p></td><td class="cl-fd2dbbd2"><p class="cl-fd2d975e"><span class="cl-fd296d01">44 (32.1)</span></p></td><td class="cl-fd2dbbd2"><p class="cl-fd2d975e"><span class="cl-fd296d01">11 (8)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-fd2dbbd2"><p class="cl-fd2d975e"><span class="cl-fd296d01"></span></p></td><td class="cl-fd2dbbda"><p class="cl-fd2d975e"><span class="cl-fd296d01">2021</span></p></td><td class="cl-fd2dbbd2"><p class="cl-fd2d975e"><span class="cl-fd296d01">223 (84.8)</span></p></td><td class="cl-fd2dbbd2"><p class="cl-fd2d975e"><span class="cl-fd296d01">34 (12.9)</span></p></td><td class="cl-fd2dbbd2"><p class="cl-fd2d975e"><span class="cl-fd296d01">6 (2.3)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-fd2dbbd2"><p class="cl-fd2d975e"><span class="cl-fd296d01"></span></p></td><td class="cl-fd2dbbda"><p class="cl-fd2d975e"><span class="cl-fd296d01">2022</span></p></td><td class="cl-fd2dbbd2"><p class="cl-fd2d975e"><span class="cl-fd296d01">88 (73.3)</span></p></td><td class="cl-fd2dbbd2"><p class="cl-fd2d975e"><span class="cl-fd296d01">25 (20.8)</span></p></td><td class="cl-fd2dbbd2"><p class="cl-fd2d975e"><span class="cl-fd296d01">7 (5.8)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-fd2dbbd2"><p class="cl-fd2d975e"><span class="cl-fd296d01"></span></p></td><td class="cl-fd2dbbda"><p class="cl-fd2d975e"><span class="cl-fd296d01">2023</span></p></td><td class="cl-fd2dbbd2"><p class="cl-fd2d975e"><span class="cl-fd296d01">87 (51.2)</span></p></td><td class="cl-fd2dbbd2"><p class="cl-fd2d975e"><span class="cl-fd296d01">63 (37.1)</span></p></td><td class="cl-fd2dbbd2"><p class="cl-fd2d975e"><span class="cl-fd296d01">20 (11.8)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-fd2dbbd2"><p class="cl-fd2d975e"><span class="cl-fd296d01"></span></p></td><td class="cl-fd2dbbda"><p class="cl-fd2d975e"><span class="cl-fd296d01">2024</span></p></td><td class="cl-fd2dbbd2"><p class="cl-fd2d975e"><span class="cl-fd296d01">74 (60.7)</span></p></td><td class="cl-fd2dbbd2"><p class="cl-fd2d975e"><span class="cl-fd296d01">39 (32)</span></p></td><td class="cl-fd2dbbd2"><p class="cl-fd2d975e"><span class="cl-fd296d01">9 (7.4)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-fd2dbbd2"><p class="cl-fd2d975e"><span class="cl-fd296d01">Quarter</span></p></td><td class="cl-fd2dbbda"><p class="cl-fd2d975e"><span class="cl-fd296d01">1</span></p></td><td class="cl-fd2dbbd2"><p class="cl-fd2d975e"><span class="cl-fd296d01">253 (62.8)</span></p></td><td class="cl-fd2dbbd2"><p class="cl-fd2d975e"><span class="cl-fd296d01">120 (29.8)</span></p></td><td class="cl-fd2dbbd2"><p class="cl-fd2d975e"><span class="cl-fd296d01">30 (7.4)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-fd2dbbd2"><p class="cl-fd2d975e"><span class="cl-fd296d01"></span></p></td><td class="cl-fd2dbbda"><p class="cl-fd2d975e"><span class="cl-fd296d01">2</span></p></td><td class="cl-fd2dbbd2"><p class="cl-fd2d975e"><span class="cl-fd296d01">220 (58.5)</span></p></td><td class="cl-fd2dbbd2"><p class="cl-fd2d975e"><span class="cl-fd296d01">117 (31.1)</span></p></td><td class="cl-fd2dbbd2"><p class="cl-fd2d975e"><span class="cl-fd296d01">39 (10.4)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-fd2dbbd2"><p class="cl-fd2d975e"><span class="cl-fd296d01"></span></p></td><td class="cl-fd2dbbda"><p class="cl-fd2d975e"><span class="cl-fd296d01">3</span></p></td><td class="cl-fd2dbbd2"><p class="cl-fd2d975e"><span class="cl-fd296d01">295 (63.2)</span></p></td><td class="cl-fd2dbbd2"><p class="cl-fd2d975e"><span class="cl-fd296d01">139 (29.8)</span></p></td><td class="cl-fd2dbbd2"><p class="cl-fd2d975e"><span class="cl-fd296d01">33 (7.1)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-fd2dbbd2"><p class="cl-fd2d975e"><span class="cl-fd296d01"></span></p></td><td class="cl-fd2dbbda"><p class="cl-fd2d975e"><span class="cl-fd296d01">4</span></p></td><td class="cl-fd2dbbd2"><p class="cl-fd2d975e"><span class="cl-fd296d01">187 (60.9)</span></p></td><td class="cl-fd2dbbd2"><p class="cl-fd2d975e"><span class="cl-fd296d01">96 (31.3)</span></p></td><td class="cl-fd2dbbd2"><p class="cl-fd2d975e"><span class="cl-fd296d01">24 (7.8)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-fd2dbbd2"><p class="cl-fd2d975e"><span class="cl-fd296d01">Weekday</span></p></td><td class="cl-fd2dbbda"><p class="cl-fd2d975e"><span class="cl-fd296d01">Friday</span></p></td><td class="cl-fd2dbbd2"><p class="cl-fd2d975e"><span class="cl-fd296d01">141 (78.3)</span></p></td><td class="cl-fd2dbbd2"><p class="cl-fd2d975e"><span class="cl-fd296d01">31 (17.2)</span></p></td><td class="cl-fd2dbbd2"><p class="cl-fd2d975e"><span class="cl-fd296d01">8 (4.4)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-fd2dbbd2"><p class="cl-fd2d975e"><span class="cl-fd296d01"></span></p></td><td class="cl-fd2dbbda"><p class="cl-fd2d975e"><span class="cl-fd296d01">Monday</span></p></td><td class="cl-fd2dbbd2"><p class="cl-fd2d975e"><span class="cl-fd296d01">114 (64.4)</span></p></td><td class="cl-fd2dbbd2"><p class="cl-fd2d975e"><span class="cl-fd296d01">49 (27.7)</span></p></td><td class="cl-fd2dbbd2"><p class="cl-fd2d975e"><span class="cl-fd296d01">14 (7.9)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-fd2dbbd2"><p class="cl-fd2d975e"><span class="cl-fd296d01"></span></p></td><td class="cl-fd2dbbda"><p class="cl-fd2d975e"><span class="cl-fd296d01">Saturday</span></p></td><td class="cl-fd2dbbd2"><p class="cl-fd2d975e"><span class="cl-fd296d01">160 (63.2)</span></p></td><td class="cl-fd2dbbd2"><p class="cl-fd2d975e"><span class="cl-fd296d01">81 (32)</span></p></td><td class="cl-fd2dbbd2"><p class="cl-fd2d975e"><span class="cl-fd296d01">12 (4.7)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-fd2dbbd2"><p class="cl-fd2d975e"><span class="cl-fd296d01"></span></p></td><td class="cl-fd2dbbda"><p class="cl-fd2d975e"><span class="cl-fd296d01">Sunday</span></p></td><td class="cl-fd2dbbd2"><p class="cl-fd2d975e"><span class="cl-fd296d01">156 (56.3)</span></p></td><td class="cl-fd2dbbd2"><p class="cl-fd2d975e"><span class="cl-fd296d01">100 (36.1)</span></p></td><td class="cl-fd2dbbd2"><p class="cl-fd2d975e"><span class="cl-fd296d01">21 (7.6)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-fd2dbbd2"><p class="cl-fd2d975e"><span class="cl-fd296d01"></span></p></td><td class="cl-fd2dbbda"><p class="cl-fd2d975e"><span class="cl-fd296d01">Thursday</span></p></td><td class="cl-fd2dbbd2"><p class="cl-fd2d975e"><span class="cl-fd296d01">167 (66)</span></p></td><td class="cl-fd2dbbd2"><p class="cl-fd2d975e"><span class="cl-fd296d01">66 (26.1)</span></p></td><td class="cl-fd2dbbd2"><p class="cl-fd2d975e"><span class="cl-fd296d01">20 (7.9)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-fd2dbbd2"><p class="cl-fd2d975e"><span class="cl-fd296d01"></span></p></td><td class="cl-fd2dbbda"><p class="cl-fd2d975e"><span class="cl-fd296d01">Tuesday</span></p></td><td class="cl-fd2dbbd2"><p class="cl-fd2d975e"><span class="cl-fd296d01">108 (65.5)</span></p></td><td class="cl-fd2dbbd2"><p class="cl-fd2d975e"><span class="cl-fd296d01">43 (26.1)</span></p></td><td class="cl-fd2dbbd2"><p class="cl-fd2d975e"><span class="cl-fd296d01">14 (8.5)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-fd2dbbdb"><p class="cl-fd2d975e"><span class="cl-fd296d01"></span></p></td><td class="cl-fd2dbbdc"><p class="cl-fd2d975e"><span class="cl-fd296d01">Wednesday</span></p></td><td class="cl-fd2dbbdb"><p class="cl-fd2d975e"><span class="cl-fd296d01">109 (44)</span></p></td><td class="cl-fd2dbbdb"><p class="cl-fd2d975e"><span class="cl-fd296d01">102 (41.1)</span></p></td><td class="cl-fd2dbbdb"><p class="cl-fd2d975e"><span class="cl-fd296d01">37 (14.9)</span></p></td></tr></tbody><tfoot><tr style="overflow-wrap:break-word;"><td colspan="5" class="cl-fd2dbbe4"><p class="cl-fd2d9768"><span class="cl-fd296d02">·µÉ</span><span class="cl-fd296d01">Vaccination proportions were calculated row-wise (i.e., by row).</span></p></td></tr></tfoot></table></div>
</div>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="co"># .................. Clean up ..................</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(tab_age, tab_sex, tab_marital_status, tab_year, tab_quarter, tab_weekday, </span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>   tab_combined, ft_vacc_summary, totals, create_tab)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="font-formatting-colour-and-font-options" class="level2" data-number="1.8">
<h2 data-number="1.8" class="anchored" data-anchor-id="font-formatting-colour-and-font-options"><span class="header-section-number">1.8</span> <strong>8. Font Formatting: Colour and Font Options</strong></h2>
<p>Here, I demonstrate how to:</p>
<ul>
<li><p>Set font types (e.g., Times New Roman)</p></li>
<li><p>Control font size</p></li>
<li><p>Apply alternating row colors and header backgrounds</p></li>
</ul>
<p>üé® <em>Why this is valuable</em>:</p>
<ul>
<li><p>Enhances visual appeal and professionalism.</p></li>
<li><p>Aligns with publication or organizational branding requirements.</p></li>
<li><p><em>Best for</em>: Reports to stakeholders, executive summaries, or printed materials.</p></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ------------ 7. Font Formating: Colour and Font type options adding in the Table -------------------------------------------</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(janitor)</span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tibble)</span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(scales)</span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(flextable)</span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-9"><a href="#cb27-9" aria-hidden="true" tabindex="-1"></a><span class="co"># .................. Convert grouping vars to character ..................</span></span>
<span id="cb27-10"><a href="#cb27-10" aria-hidden="true" tabindex="-1"></a>vacc_1524 <span class="ot">&lt;-</span> vacc_1524 <span class="sc">%&gt;%</span></span>
<span id="cb27-11"><a href="#cb27-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">c</span>(age_group, gender, marital_status,</span>
<span id="cb27-12"><a href="#cb27-12" aria-hidden="true" tabindex="-1"></a>                  vacc_service_year, vacc_quarter, vacc_weekday), as.character))</span>
<span id="cb27-13"><a href="#cb27-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-14"><a href="#cb27-14" aria-hidden="true" tabindex="-1"></a><span class="co"># .................. Table generation function with Missing ..................</span></span>
<span id="cb27-15"><a href="#cb27-15" aria-hidden="true" tabindex="-1"></a>create_tab <span class="ot">&lt;-</span> <span class="cf">function</span>(data, var, label) {</span>
<span id="cb27-16"><a href="#cb27-16" aria-hidden="true" tabindex="-1"></a>  tab_main <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span></span>
<span id="cb27-17"><a href="#cb27-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>({{ var }})) <span class="sc">%&gt;%</span></span>
<span id="cb27-18"><a href="#cb27-18" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tabyl</span>({{ var }}, vacc_group3) <span class="sc">%&gt;%</span></span>
<span id="cb27-19"><a href="#cb27-19" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">Category =</span> label, <span class="at">.before =</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb27-20"><a href="#cb27-20" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rename</span>(<span class="at">Label =</span> {{ var }}) <span class="sc">%&gt;%</span></span>
<span id="cb27-21"><a href="#cb27-21" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">Label =</span> <span class="fu">as.character</span>(Label))</span>
<span id="cb27-22"><a href="#cb27-22" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb27-23"><a href="#cb27-23" aria-hidden="true" tabindex="-1"></a>  na_count <span class="ot">&lt;-</span> <span class="fu">sum</span>(<span class="fu">is.na</span>(<span class="fu">pull</span>(data, {{ var }})))</span>
<span id="cb27-24"><a href="#cb27-24" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb27-25"><a href="#cb27-25" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (na_count <span class="sc">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb27-26"><a href="#cb27-26" aria-hidden="true" tabindex="-1"></a>    missing_row <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb27-27"><a href="#cb27-27" aria-hidden="true" tabindex="-1"></a>      <span class="at">Category =</span> label,</span>
<span id="cb27-28"><a href="#cb27-28" aria-hidden="true" tabindex="-1"></a>      <span class="at">Label =</span> <span class="st">"Missing"</span>,</span>
<span id="cb27-29"><a href="#cb27-29" aria-hidden="true" tabindex="-1"></a>      <span class="st">`</span><span class="at">Respiratory vaccines</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">sum</span>(data<span class="sc">$</span>vacc_group3 <span class="sc">==</span> <span class="st">"Respiratory vaccines"</span> <span class="sc">&amp;</span> <span class="fu">is.na</span>(<span class="fu">pull</span>(data, {{ var }})), <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb27-30"><a href="#cb27-30" aria-hidden="true" tabindex="-1"></a>      <span class="st">`</span><span class="at">Childhood vaccines</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">sum</span>(data<span class="sc">$</span>vacc_group3 <span class="sc">==</span> <span class="st">"Childhood vaccines"</span> <span class="sc">&amp;</span> <span class="fu">is.na</span>(<span class="fu">pull</span>(data, {{ var }})), <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb27-31"><a href="#cb27-31" aria-hidden="true" tabindex="-1"></a>      <span class="at">Other =</span> <span class="fu">sum</span>(data<span class="sc">$</span>vacc_group3 <span class="sc">==</span> <span class="st">"Other"</span> <span class="sc">&amp;</span> <span class="fu">is.na</span>(<span class="fu">pull</span>(data, {{ var }})), <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb27-32"><a href="#cb27-32" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb27-33"><a href="#cb27-33" aria-hidden="true" tabindex="-1"></a>    tab_final <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(tab_main, missing_row)</span>
<span id="cb27-34"><a href="#cb27-34" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb27-35"><a href="#cb27-35" aria-hidden="true" tabindex="-1"></a>    tab_final <span class="ot">&lt;-</span> tab_main</span>
<span id="cb27-36"><a href="#cb27-36" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb27-37"><a href="#cb27-37" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb27-38"><a href="#cb27-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(tab_final)</span>
<span id="cb27-39"><a href="#cb27-39" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb27-40"><a href="#cb27-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-41"><a href="#cb27-41" aria-hidden="true" tabindex="-1"></a><span class="co"># .................. Create summary tables ..................</span></span>
<span id="cb27-42"><a href="#cb27-42" aria-hidden="true" tabindex="-1"></a>tab_age            <span class="ot">&lt;-</span> <span class="fu">create_tab</span>(vacc_1524, age_group, <span class="st">"Age"</span>)</span>
<span id="cb27-43"><a href="#cb27-43" aria-hidden="true" tabindex="-1"></a>tab_sex            <span class="ot">&lt;-</span> <span class="fu">create_tab</span>(vacc_1524, gender, <span class="st">"Gender"</span>)</span>
<span id="cb27-44"><a href="#cb27-44" aria-hidden="true" tabindex="-1"></a>tab_marital_status <span class="ot">&lt;-</span> <span class="fu">create_tab</span>(vacc_1524, marital_status, <span class="st">"Marital status"</span>)</span>
<span id="cb27-45"><a href="#cb27-45" aria-hidden="true" tabindex="-1"></a>tab_year           <span class="ot">&lt;-</span> <span class="fu">create_tab</span>(vacc_1524, vacc_service_year, <span class="st">"Year"</span>)</span>
<span id="cb27-46"><a href="#cb27-46" aria-hidden="true" tabindex="-1"></a>tab_quarter        <span class="ot">&lt;-</span> <span class="fu">create_tab</span>(vacc_1524, vacc_quarter, <span class="st">"Quarter"</span>)</span>
<span id="cb27-47"><a href="#cb27-47" aria-hidden="true" tabindex="-1"></a>tab_weekday        <span class="ot">&lt;-</span> <span class="fu">create_tab</span>(vacc_1524, vacc_weekday, <span class="st">"Weekday"</span>)</span>
<span id="cb27-48"><a href="#cb27-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-49"><a href="#cb27-49" aria-hidden="true" tabindex="-1"></a><span class="co"># .................. Combine all tables ..................</span></span>
<span id="cb27-50"><a href="#cb27-50" aria-hidden="true" tabindex="-1"></a>tab_combined <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(tab_sex, tab_age, tab_marital_status, tab_year, tab_quarter, tab_weekday)</span>
<span id="cb27-51"><a href="#cb27-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-52"><a href="#cb27-52" aria-hidden="true" tabindex="-1"></a><span class="co"># .................. Calculate row-wise percentages (skip for Missing) ..................</span></span>
<span id="cb27-53"><a href="#cb27-53" aria-hidden="true" tabindex="-1"></a>tab_combined <span class="ot">&lt;-</span> tab_combined <span class="sc">%&gt;%</span></span>
<span id="cb27-54"><a href="#cb27-54" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rowwise</span>() <span class="sc">%&gt;%</span></span>
<span id="cb27-55"><a href="#cb27-55" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb27-56"><a href="#cb27-56" aria-hidden="true" tabindex="-1"></a>    <span class="at">Total =</span> <span class="fu">sum</span>(<span class="st">`</span><span class="at">Respiratory vaccines</span><span class="st">`</span>, <span class="st">`</span><span class="at">Childhood vaccines</span><span class="st">`</span>, Other, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb27-57"><a href="#cb27-57" aria-hidden="true" tabindex="-1"></a>    <span class="at">is_missing =</span> <span class="fu">trimws</span>(<span class="fu">tolower</span>(Label)) <span class="sc">==</span> <span class="st">"missing"</span>,</span>
<span id="cb27-58"><a href="#cb27-58" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb27-59"><a href="#cb27-59" aria-hidden="true" tabindex="-1"></a>    <span class="at">Respiratory =</span> <span class="fu">ifelse</span>(is_missing,</span>
<span id="cb27-60"><a href="#cb27-60" aria-hidden="true" tabindex="-1"></a>                         <span class="fu">comma</span>(<span class="st">`</span><span class="at">Respiratory vaccines</span><span class="st">`</span>),</span>
<span id="cb27-61"><a href="#cb27-61" aria-hidden="true" tabindex="-1"></a>                         <span class="fu">paste0</span>(<span class="fu">comma</span>(<span class="st">`</span><span class="at">Respiratory vaccines</span><span class="st">`</span>), <span class="st">" ("</span>, <span class="fu">round</span>(<span class="dv">100</span> <span class="sc">*</span> <span class="st">`</span><span class="at">Respiratory vaccines</span><span class="st">`</span> <span class="sc">/</span> Total, <span class="dv">1</span>), <span class="st">")"</span>)),</span>
<span id="cb27-62"><a href="#cb27-62" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb27-63"><a href="#cb27-63" aria-hidden="true" tabindex="-1"></a>    <span class="at">Childhood =</span> <span class="fu">ifelse</span>(is_missing,</span>
<span id="cb27-64"><a href="#cb27-64" aria-hidden="true" tabindex="-1"></a>                       <span class="fu">comma</span>(<span class="st">`</span><span class="at">Childhood vaccines</span><span class="st">`</span>),</span>
<span id="cb27-65"><a href="#cb27-65" aria-hidden="true" tabindex="-1"></a>                       <span class="fu">paste0</span>(<span class="fu">comma</span>(<span class="st">`</span><span class="at">Childhood vaccines</span><span class="st">`</span>), <span class="st">" ("</span>, <span class="fu">round</span>(<span class="dv">100</span> <span class="sc">*</span> <span class="st">`</span><span class="at">Childhood vaccines</span><span class="st">`</span> <span class="sc">/</span> Total, <span class="dv">1</span>), <span class="st">")"</span>)),</span>
<span id="cb27-66"><a href="#cb27-66" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb27-67"><a href="#cb27-67" aria-hidden="true" tabindex="-1"></a>    <span class="at">Other_grp =</span> <span class="fu">ifelse</span>(is_missing,</span>
<span id="cb27-68"><a href="#cb27-68" aria-hidden="true" tabindex="-1"></a>                       <span class="fu">comma</span>(Other),</span>
<span id="cb27-69"><a href="#cb27-69" aria-hidden="true" tabindex="-1"></a>                       <span class="fu">paste0</span>(<span class="fu">comma</span>(Other), <span class="st">" ("</span>, <span class="fu">round</span>(<span class="dv">100</span> <span class="sc">*</span> Other <span class="sc">/</span> Total, <span class="dv">1</span>), <span class="st">")"</span>))</span>
<span id="cb27-70"><a href="#cb27-70" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb27-71"><a href="#cb27-71" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb27-72"><a href="#cb27-72" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Category, Label, Respiratory, Childhood, Other_grp)</span>
<span id="cb27-73"><a href="#cb27-73" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-74"><a href="#cb27-74" aria-hidden="true" tabindex="-1"></a><span class="co"># .................. Show Category only once per group ..................</span></span>
<span id="cb27-75"><a href="#cb27-75" aria-hidden="true" tabindex="-1"></a>tab_combined <span class="ot">&lt;-</span> tab_combined <span class="sc">%&gt;%</span></span>
<span id="cb27-76"><a href="#cb27-76" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Category) <span class="sc">%&gt;%</span></span>
<span id="cb27-77"><a href="#cb27-77" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Category =</span> <span class="fu">ifelse</span>(<span class="fu">row_number</span>() <span class="sc">==</span> <span class="dv">1</span>, Category, <span class="st">""</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb27-78"><a href="#cb27-78" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb27-79"><a href="#cb27-79" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-80"><a href="#cb27-80" aria-hidden="true" tabindex="-1"></a><span class="co"># .................. Get total counts per vaccine group ..................</span></span>
<span id="cb27-81"><a href="#cb27-81" aria-hidden="true" tabindex="-1"></a>totals <span class="ot">&lt;-</span> vacc_1524 <span class="sc">%&gt;%</span></span>
<span id="cb27-82"><a href="#cb27-82" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(vacc_group3) <span class="sc">%&gt;%</span></span>
<span id="cb27-83"><a href="#cb27-83" aria-hidden="true" tabindex="-1"></a>  <span class="fu">deframe</span>()</span>
<span id="cb27-84"><a href="#cb27-84" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-85"><a href="#cb27-85" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-86"><a href="#cb27-86" aria-hidden="true" tabindex="-1"></a>ft_vacc_summary <span class="ot">&lt;-</span> tab_combined <span class="sc">%&gt;%</span></span>
<span id="cb27-87"><a href="#cb27-87" aria-hidden="true" tabindex="-1"></a>  <span class="fu">flextable</span>() <span class="sc">%&gt;%</span></span>
<span id="cb27-88"><a href="#cb27-88" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_header_labels</span>(</span>
<span id="cb27-89"><a href="#cb27-89" aria-hidden="true" tabindex="-1"></a>    <span class="at">Category =</span> <span class="st">"Variable type"</span>,</span>
<span id="cb27-90"><a href="#cb27-90" aria-hidden="true" tabindex="-1"></a>    <span class="at">Label =</span> <span class="st">"Values"</span>,</span>
<span id="cb27-91"><a href="#cb27-91" aria-hidden="true" tabindex="-1"></a>    <span class="at">Respiratory =</span> <span class="st">"Number (%)·µÉ"</span>,</span>
<span id="cb27-92"><a href="#cb27-92" aria-hidden="true" tabindex="-1"></a>    <span class="at">Childhood =</span> <span class="st">"Number (%)·µÉ"</span>,</span>
<span id="cb27-93"><a href="#cb27-93" aria-hidden="true" tabindex="-1"></a>    <span class="at">Other_grp =</span> <span class="st">"Number (%)·µÉ"</span></span>
<span id="cb27-94"><a href="#cb27-94" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb27-95"><a href="#cb27-95" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_header_row</span>(</span>
<span id="cb27-96"><a href="#cb27-96" aria-hidden="true" tabindex="-1"></a>    <span class="at">values =</span> <span class="fu">c</span>(</span>
<span id="cb27-97"><a href="#cb27-97" aria-hidden="true" tabindex="-1"></a>      <span class="st">""</span>, <span class="st">""</span>,</span>
<span id="cb27-98"><a href="#cb27-98" aria-hidden="true" tabindex="-1"></a>      <span class="fu">paste0</span>(<span class="st">"Respiratory vaccines (N = "</span>, <span class="fu">format</span>(totals[<span class="st">"Respiratory vaccines"</span>], <span class="at">big.mark =</span> <span class="st">","</span>), <span class="st">")"</span>),</span>
<span id="cb27-99"><a href="#cb27-99" aria-hidden="true" tabindex="-1"></a>      <span class="fu">paste0</span>(<span class="st">"Childhood vaccines (N = "</span>, <span class="fu">format</span>(totals[<span class="st">"Childhood vaccines"</span>], <span class="at">big.mark =</span> <span class="st">","</span>), <span class="st">")"</span>),</span>
<span id="cb27-100"><a href="#cb27-100" aria-hidden="true" tabindex="-1"></a>      <span class="fu">paste0</span>(<span class="st">"Other (N = "</span>, <span class="fu">format</span>(totals[<span class="st">"Other"</span>], <span class="at">big.mark =</span> <span class="st">","</span>), <span class="st">")"</span>)</span>
<span id="cb27-101"><a href="#cb27-101" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb27-102"><a href="#cb27-102" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb27-103"><a href="#cb27-103" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_header_row</span>(</span>
<span id="cb27-104"><a href="#cb27-104" aria-hidden="true" tabindex="-1"></a>    <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"Description"</span>, <span class="st">"Vaccination uptake"</span>),</span>
<span id="cb27-105"><a href="#cb27-105" aria-hidden="true" tabindex="-1"></a>    <span class="at">colwidths =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">3</span>)</span>
<span id="cb27-106"><a href="#cb27-106" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb27-107"><a href="#cb27-107" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_box</span>() <span class="sc">%&gt;%</span></span>
<span id="cb27-108"><a href="#cb27-108" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_table_properties</span>(<span class="at">layout =</span> <span class="st">"autofit"</span>, <span class="at">width =</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb27-109"><a href="#cb27-109" aria-hidden="true" tabindex="-1"></a>  <span class="fu">width</span>(<span class="at">j =</span> <span class="dv">1</span>, <span class="at">width =</span> <span class="fl">1.5</span>) <span class="sc">%&gt;%</span></span>
<span id="cb27-110"><a href="#cb27-110" aria-hidden="true" tabindex="-1"></a>  <span class="fu">width</span>(<span class="at">j =</span> <span class="dv">2</span>, <span class="at">width =</span> <span class="fl">2.5</span>) <span class="sc">%&gt;%</span></span>
<span id="cb27-111"><a href="#cb27-111" aria-hidden="true" tabindex="-1"></a>  <span class="fu">width</span>(<span class="at">j =</span> <span class="dv">3</span><span class="sc">:</span><span class="dv">5</span>, <span class="at">width =</span> <span class="fl">1.5</span>) <span class="sc">%&gt;%</span></span>
<span id="cb27-112"><a href="#cb27-112" aria-hidden="true" tabindex="-1"></a>  <span class="fu">align</span>(<span class="at">align =</span> <span class="st">"justify"</span>, <span class="at">part =</span> <span class="st">"all"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb27-113"><a href="#cb27-113" aria-hidden="true" tabindex="-1"></a>  <span class="fu">border_remove</span>() <span class="sc">%&gt;%</span></span>
<span id="cb27-114"><a href="#cb27-114" aria-hidden="true" tabindex="-1"></a>  <span class="fu">border</span>(<span class="at">part =</span> <span class="st">"header"</span>, <span class="at">i =</span> <span class="dv">1</span>, <span class="at">border.top =</span> <span class="fu">fp_border</span>(<span class="at">color =</span> <span class="st">"black"</span>, <span class="at">width =</span> <span class="dv">1</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb27-115"><a href="#cb27-115" aria-hidden="true" tabindex="-1"></a>  <span class="fu">border</span>(<span class="at">part =</span> <span class="st">"header"</span>, <span class="at">i =</span> <span class="dv">3</span>, <span class="at">border.bottom =</span> <span class="fu">fp_border</span>(<span class="at">color =</span> <span class="st">"black"</span>, <span class="at">width =</span> <span class="dv">1</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb27-116"><a href="#cb27-116" aria-hidden="true" tabindex="-1"></a>  <span class="fu">border_inner_h</span>(<span class="at">part =</span> <span class="st">"header"</span>, <span class="at">border =</span> <span class="fu">fp_border</span>(<span class="at">color =</span> <span class="st">"black"</span>, <span class="at">width =</span> <span class="fl">0.8</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb27-117"><a href="#cb27-117" aria-hidden="true" tabindex="-1"></a>  <span class="fu">border_inner_h</span>(<span class="at">part =</span> <span class="st">"body"</span>, <span class="at">border =</span> <span class="fu">fp_border</span>(<span class="at">color =</span> <span class="st">"black"</span>, <span class="at">width =</span> <span class="fl">0.8</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb27-118"><a href="#cb27-118" aria-hidden="true" tabindex="-1"></a>  <span class="fu">border</span>(<span class="at">part =</span> <span class="st">"body"</span>, <span class="at">i =</span> <span class="fu">nrow</span>(tab_combined), <span class="at">border.bottom =</span> <span class="fu">fp_border</span>(<span class="at">color =</span> <span class="st">"black"</span>, <span class="at">width =</span> <span class="dv">1</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb27-119"><a href="#cb27-119" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb27-120"><a href="#cb27-120" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_caption</span>(<span class="fu">as_paragraph</span>(<span class="fu">as_chunk</span>(<span class="st">"Table: Vaccination uptake across service year, quarter, and weekday"</span>,</span>
<span id="cb27-121"><a href="#cb27-121" aria-hidden="true" tabindex="-1"></a>                                    <span class="at">props =</span> <span class="fu">fp_text</span>(<span class="at">font.size =</span> <span class="dv">14</span>, <span class="at">font.family =</span> <span class="st">"Times New Roman"</span>, <span class="at">bold =</span> <span class="cn">FALSE</span>)))) <span class="sc">%&gt;%</span></span>
<span id="cb27-122"><a href="#cb27-122" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fontsize</span>(<span class="at">part =</span> <span class="st">"header"</span>, <span class="at">size =</span> <span class="dv">12</span>) <span class="sc">%&gt;%</span></span>
<span id="cb27-123"><a href="#cb27-123" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fontsize</span>(<span class="at">part =</span> <span class="st">"body"</span>, <span class="at">size =</span> <span class="dv">11</span>) <span class="sc">%&gt;%</span></span>
<span id="cb27-124"><a href="#cb27-124" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fontsize</span>(<span class="at">part =</span> <span class="st">"footer"</span>, <span class="at">size =</span> <span class="dv">10</span>) <span class="sc">%&gt;%</span></span>
<span id="cb27-125"><a href="#cb27-125" aria-hidden="true" tabindex="-1"></a>  <span class="fu">font</span>(<span class="at">part =</span> <span class="st">"all"</span>, <span class="at">fontname =</span> <span class="st">"Times New Roman"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb27-126"><a href="#cb27-126" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bg</span>(<span class="at">part =</span> <span class="st">"header"</span>, <span class="at">bg =</span> <span class="st">"lightblue"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb27-127"><a href="#cb27-127" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bg</span>(<span class="at">j =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>, <span class="at">i =</span> <span class="fu">seq</span>(<span class="dv">1</span>, <span class="fu">nrow</span>(tab_combined), <span class="dv">2</span>), <span class="at">bg =</span> <span class="st">"lightgray"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb27-128"><a href="#cb27-128" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bg</span>(<span class="at">j =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>, <span class="at">i =</span> <span class="fu">seq</span>(<span class="dv">2</span>, <span class="fu">nrow</span>(tab_combined), <span class="dv">2</span>), <span class="at">bg =</span> <span class="st">"red"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb27-129"><a href="#cb27-129" aria-hidden="true" tabindex="-1"></a>  <span class="fu">footnote</span>(<span class="at">i =</span> <span class="dv">1</span>, </span>
<span id="cb27-130"><a href="#cb27-130" aria-hidden="true" tabindex="-1"></a>           <span class="at">value =</span> <span class="fu">as_paragraph</span>(<span class="st">"Vaccination proportions were calculated row-wise (i.e., by row)."</span>),</span>
<span id="cb27-131"><a href="#cb27-131" aria-hidden="true" tabindex="-1"></a>           <span class="at">ref_symbols =</span> <span class="st">"·µÉ"</span>, </span>
<span id="cb27-132"><a href="#cb27-132" aria-hidden="true" tabindex="-1"></a>           <span class="at">part =</span> <span class="st">"header"</span>)</span>
<span id="cb27-133"><a href="#cb27-133" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-134"><a href="#cb27-134" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-135"><a href="#cb27-135" aria-hidden="true" tabindex="-1"></a><span class="co"># .................. Show the table ..................</span></span>
<span id="cb27-136"><a href="#cb27-136" aria-hidden="true" tabindex="-1"></a>ft_vacc_summary</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="tabwid"><style>.cl-fd7d1c34{table-layout:auto;width:100%;}.cl-fd73ea2e{font-family:'Times New Roman';font-size:12pt;font-weight:bold;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-fd73ea38{font-family:'Times New Roman';font-size:7.2pt;font-weight:bold;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;position: relative;bottom:3.6pt;}.cl-fd73ea42{font-family:'Times New Roman';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-fd73ea43{font-family:'Arial';font-size:6.6pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;position: relative;bottom:3.3pt;}.cl-fd73ea44{font-family:'Arial';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-fd7778b0{margin:0;text-align:justify;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-fd7778ba{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-fd779afc{background-color:rgba(173, 216, 230, 1.00);vertical-align: middle;border-bottom: 0.8pt solid rgba(0, 0, 0, 1.00);border-top: 1pt solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-fd779b06{background-color:rgba(173, 216, 230, 1.00);vertical-align: middle;border-bottom: 0.8pt solid rgba(0, 0, 0, 1.00);border-top: 1pt solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-fd779b07{background-color:rgba(173, 216, 230, 1.00);vertical-align: middle;border-bottom: 0.8pt solid rgba(0, 0, 0, 1.00);border-top: 0.8pt solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-fd779b10{background-color:rgba(173, 216, 230, 1.00);vertical-align: middle;border-bottom: 0.8pt solid rgba(0, 0, 0, 1.00);border-top: 0.8pt solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-fd779b11{background-color:rgba(173, 216, 230, 1.00);vertical-align: middle;border-bottom: 1pt solid rgba(0, 0, 0, 1.00);border-top: 0.8pt solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-fd779b12{background-color:rgba(173, 216, 230, 1.00);vertical-align: middle;border-bottom: 1pt solid rgba(0, 0, 0, 1.00);border-top: 0.8pt solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-fd779b1a{background-color:rgba(211, 211, 211, 1.00);vertical-align: middle;border-bottom: 0.8pt solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-fd779b1b{background-color:rgba(211, 211, 211, 1.00);vertical-align: middle;border-bottom: 0.8pt solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-fd779b1c{background-color:rgba(255, 0, 0, 1.00);vertical-align: middle;border-bottom: 0.8pt solid rgba(0, 0, 0, 1.00);border-top: 0.8pt solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-fd779b24{background-color:rgba(255, 0, 0, 1.00);vertical-align: middle;border-bottom: 0.8pt solid rgba(0, 0, 0, 1.00);border-top: 0.8pt solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-fd779b25{background-color:rgba(211, 211, 211, 1.00);vertical-align: middle;border-bottom: 0.8pt solid rgba(0, 0, 0, 1.00);border-top: 0.8pt solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-fd779b26{background-color:rgba(211, 211, 211, 1.00);vertical-align: middle;border-bottom: 0.8pt solid rgba(0, 0, 0, 1.00);border-top: 0.8pt solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-fd779b2e{background-color:rgba(255, 0, 0, 1.00);vertical-align: middle;border-bottom: 1pt solid rgba(0, 0, 0, 1.00);border-top: 0.8pt solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-fd779b2f{background-color:rgba(255, 0, 0, 1.00);vertical-align: middle;border-bottom: 1pt solid rgba(0, 0, 0, 1.00);border-top: 0.8pt solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-fd779b30{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(255, 255, 255, 0.00);border-top: 0 solid rgba(255, 255, 255, 0.00);border-left: 0 solid rgba(255, 255, 255, 0.00);border-right: 0 solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-fd779b38{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(255, 255, 255, 0.00);border-top: 0 solid rgba(255, 255, 255, 0.00);border-left: 0 solid rgba(255, 255, 255, 0.00);border-right: 0 solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table data-quarto-disable-processing="true" class="cl-fd7d1c34"><thead><tr style="overflow-wrap:break-word;"><th colspan="2" class="cl-fd779afc"><p class="cl-fd7778b0"><span class="cl-fd73ea2e">Description</span><span class="cl-fd73ea38">·µÉ</span></p></th><th colspan="3" class="cl-fd779afc"><p class="cl-fd7778b0"><span class="cl-fd73ea2e">Vaccination uptake</span><span class="cl-fd73ea38">·µÉ</span></p></th></tr><tr style="overflow-wrap:break-word;"><th class="cl-fd779b07"><p class="cl-fd7778b0"><span class="cl-fd73ea2e"></span></p></th><th class="cl-fd779b10"><p class="cl-fd7778b0"><span class="cl-fd73ea2e"></span></p></th><th class="cl-fd779b07"><p class="cl-fd7778b0"><span class="cl-fd73ea2e">Respiratory vaccines (N = 955)</span></p></th><th class="cl-fd779b07"><p class="cl-fd7778b0"><span class="cl-fd73ea2e">Childhood vaccines (N = 472)</span></p></th><th class="cl-fd779b07"><p class="cl-fd7778b0"><span class="cl-fd73ea2e">Other (N = 126)</span></p></th></tr><tr style="overflow-wrap:break-word;"><th class="cl-fd779b11"><p class="cl-fd7778b0"><span class="cl-fd73ea2e">Variable type</span></p></th><th class="cl-fd779b12"><p class="cl-fd7778b0"><span class="cl-fd73ea2e">Values</span></p></th><th class="cl-fd779b11"><p class="cl-fd7778b0"><span class="cl-fd73ea2e">Number (%)·µÉ</span></p></th><th class="cl-fd779b11"><p class="cl-fd7778b0"><span class="cl-fd73ea2e">Number (%)·µÉ</span></p></th><th class="cl-fd779b11"><p class="cl-fd7778b0"><span class="cl-fd73ea2e">Number (%)·µÉ</span></p></th></tr></thead><tbody><tr style="overflow-wrap:break-word;"><td class="cl-fd779b1a"><p class="cl-fd7778b0"><span class="cl-fd73ea42">Gender</span></p></td><td class="cl-fd779b1b"><p class="cl-fd7778b0"><span class="cl-fd73ea42">Female</span></p></td><td class="cl-fd779b1a"><p class="cl-fd7778b0"><span class="cl-fd73ea42">511 (64)</span></p></td><td class="cl-fd779b1a"><p class="cl-fd7778b0"><span class="cl-fd73ea42">233 (29.2)</span></p></td><td class="cl-fd779b1a"><p class="cl-fd7778b0"><span class="cl-fd73ea42">54 (6.8)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-fd779b1c"><p class="cl-fd7778b0"><span class="cl-fd73ea42"></span></p></td><td class="cl-fd779b24"><p class="cl-fd7778b0"><span class="cl-fd73ea42">Male</span></p></td><td class="cl-fd779b1c"><p class="cl-fd7778b0"><span class="cl-fd73ea42">444 (58.8)</span></p></td><td class="cl-fd779b1c"><p class="cl-fd7778b0"><span class="cl-fd73ea42">239 (31.7)</span></p></td><td class="cl-fd779b1c"><p class="cl-fd7778b0"><span class="cl-fd73ea42">72 (9.5)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-fd779b25"><p class="cl-fd7778b0"><span class="cl-fd73ea42">Age</span></p></td><td class="cl-fd779b26"><p class="cl-fd7778b0"><span class="cl-fd73ea42">0-19</span></p></td><td class="cl-fd779b25"><p class="cl-fd7778b0"><span class="cl-fd73ea42">250 (38.9)</span></p></td><td class="cl-fd779b25"><p class="cl-fd7778b0"><span class="cl-fd73ea42">302 (47)</span></p></td><td class="cl-fd779b25"><p class="cl-fd7778b0"><span class="cl-fd73ea42">90 (14)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-fd779b1c"><p class="cl-fd7778b0"><span class="cl-fd73ea42"></span></p></td><td class="cl-fd779b24"><p class="cl-fd7778b0"><span class="cl-fd73ea42">20-29</span></p></td><td class="cl-fd779b1c"><p class="cl-fd7778b0"><span class="cl-fd73ea42">150 (68.2)</span></p></td><td class="cl-fd779b1c"><p class="cl-fd7778b0"><span class="cl-fd73ea42">70 (31.8)</span></p></td><td class="cl-fd779b1c"><p class="cl-fd7778b0"><span class="cl-fd73ea42">0 (0)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-fd779b25"><p class="cl-fd7778b0"><span class="cl-fd73ea42"></span></p></td><td class="cl-fd779b26"><p class="cl-fd7778b0"><span class="cl-fd73ea42">30-39</span></p></td><td class="cl-fd779b25"><p class="cl-fd7778b0"><span class="cl-fd73ea42">47 (71.2)</span></p></td><td class="cl-fd779b25"><p class="cl-fd7778b0"><span class="cl-fd73ea42">19 (28.8)</span></p></td><td class="cl-fd779b25"><p class="cl-fd7778b0"><span class="cl-fd73ea42">0 (0)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-fd779b1c"><p class="cl-fd7778b0"><span class="cl-fd73ea42"></span></p></td><td class="cl-fd779b24"><p class="cl-fd7778b0"><span class="cl-fd73ea42">40-49</span></p></td><td class="cl-fd779b1c"><p class="cl-fd7778b0"><span class="cl-fd73ea42">142 (75.9)</span></p></td><td class="cl-fd779b1c"><p class="cl-fd7778b0"><span class="cl-fd73ea42">45 (24.1)</span></p></td><td class="cl-fd779b1c"><p class="cl-fd7778b0"><span class="cl-fd73ea42">0 (0)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-fd779b25"><p class="cl-fd7778b0"><span class="cl-fd73ea42"></span></p></td><td class="cl-fd779b26"><p class="cl-fd7778b0"><span class="cl-fd73ea42">50-59</span></p></td><td class="cl-fd779b25"><p class="cl-fd7778b0"><span class="cl-fd73ea42">112 (77.8)</span></p></td><td class="cl-fd779b25"><p class="cl-fd7778b0"><span class="cl-fd73ea42">14 (9.7)</span></p></td><td class="cl-fd779b25"><p class="cl-fd7778b0"><span class="cl-fd73ea42">18 (12.5)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-fd779b1c"><p class="cl-fd7778b0"><span class="cl-fd73ea42"></span></p></td><td class="cl-fd779b24"><p class="cl-fd7778b0"><span class="cl-fd73ea42">60-69</span></p></td><td class="cl-fd779b1c"><p class="cl-fd7778b0"><span class="cl-fd73ea42">149 (87.6)</span></p></td><td class="cl-fd779b1c"><p class="cl-fd7778b0"><span class="cl-fd73ea42">13 (7.6)</span></p></td><td class="cl-fd779b1c"><p class="cl-fd7778b0"><span class="cl-fd73ea42">8 (4.7)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-fd779b25"><p class="cl-fd7778b0"><span class="cl-fd73ea42"></span></p></td><td class="cl-fd779b26"><p class="cl-fd7778b0"><span class="cl-fd73ea42">70+</span></p></td><td class="cl-fd779b25"><p class="cl-fd7778b0"><span class="cl-fd73ea42">105 (84.7)</span></p></td><td class="cl-fd779b25"><p class="cl-fd7778b0"><span class="cl-fd73ea42">9 (7.3)</span></p></td><td class="cl-fd779b25"><p class="cl-fd7778b0"><span class="cl-fd73ea42">10 (8.1)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-fd779b1c"><p class="cl-fd7778b0"><span class="cl-fd73ea42">Marital status</span></p></td><td class="cl-fd779b24"><p class="cl-fd7778b0"><span class="cl-fd73ea42">Divorced</span></p></td><td class="cl-fd779b1c"><p class="cl-fd7778b0"><span class="cl-fd73ea42">136 (83.4)</span></p></td><td class="cl-fd779b1c"><p class="cl-fd7778b0"><span class="cl-fd73ea42">15 (9.2)</span></p></td><td class="cl-fd779b1c"><p class="cl-fd7778b0"><span class="cl-fd73ea42">12 (7.4)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-fd779b25"><p class="cl-fd7778b0"><span class="cl-fd73ea42"></span></p></td><td class="cl-fd779b26"><p class="cl-fd7778b0"><span class="cl-fd73ea42">Married</span></p></td><td class="cl-fd779b25"><p class="cl-fd7778b0"><span class="cl-fd73ea42">289 (79)</span></p></td><td class="cl-fd779b25"><p class="cl-fd7778b0"><span class="cl-fd73ea42">59 (16.1)</span></p></td><td class="cl-fd779b25"><p class="cl-fd7778b0"><span class="cl-fd73ea42">18 (4.9)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-fd779b1c"><p class="cl-fd7778b0"><span class="cl-fd73ea42"></span></p></td><td class="cl-fd779b24"><p class="cl-fd7778b0"><span class="cl-fd73ea42">Single/widowed</span></p></td><td class="cl-fd779b1c"><p class="cl-fd7778b0"><span class="cl-fd73ea42">150 (79.4)</span></p></td><td class="cl-fd779b1c"><p class="cl-fd7778b0"><span class="cl-fd73ea42">33 (17.5)</span></p></td><td class="cl-fd779b1c"><p class="cl-fd7778b0"><span class="cl-fd73ea42">6 (3.2)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-fd779b25"><p class="cl-fd7778b0"><span class="cl-fd73ea42"></span></p></td><td class="cl-fd779b26"><p class="cl-fd7778b0"><span class="cl-fd73ea42">Missing</span></p></td><td class="cl-fd779b25"><p class="cl-fd7778b0"><span class="cl-fd73ea42">380</span></p></td><td class="cl-fd779b25"><p class="cl-fd7778b0"><span class="cl-fd73ea42">365</span></p></td><td class="cl-fd779b25"><p class="cl-fd7778b0"><span class="cl-fd73ea42">90</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-fd779b1c"><p class="cl-fd7778b0"><span class="cl-fd73ea42">Year</span></p></td><td class="cl-fd779b24"><p class="cl-fd7778b0"><span class="cl-fd73ea42">2015</span></p></td><td class="cl-fd779b1c"><p class="cl-fd7778b0"><span class="cl-fd73ea42">78 (51)</span></p></td><td class="cl-fd779b1c"><p class="cl-fd7778b0"><span class="cl-fd73ea42">56 (36.6)</span></p></td><td class="cl-fd779b1c"><p class="cl-fd7778b0"><span class="cl-fd73ea42">19 (12.4)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-fd779b25"><p class="cl-fd7778b0"><span class="cl-fd73ea42"></span></p></td><td class="cl-fd779b26"><p class="cl-fd7778b0"><span class="cl-fd73ea42">2016</span></p></td><td class="cl-fd779b25"><p class="cl-fd7778b0"><span class="cl-fd73ea42">84 (60.4)</span></p></td><td class="cl-fd779b25"><p class="cl-fd7778b0"><span class="cl-fd73ea42">47 (33.8)</span></p></td><td class="cl-fd779b25"><p class="cl-fd7778b0"><span class="cl-fd73ea42">8 (5.8)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-fd779b1c"><p class="cl-fd7778b0"><span class="cl-fd73ea42"></span></p></td><td class="cl-fd779b24"><p class="cl-fd7778b0"><span class="cl-fd73ea42">2017</span></p></td><td class="cl-fd779b1c"><p class="cl-fd7778b0"><span class="cl-fd73ea42">75 (54.7)</span></p></td><td class="cl-fd779b1c"><p class="cl-fd7778b0"><span class="cl-fd73ea42">52 (38)</span></p></td><td class="cl-fd779b1c"><p class="cl-fd7778b0"><span class="cl-fd73ea42">10 (7.3)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-fd779b25"><p class="cl-fd7778b0"><span class="cl-fd73ea42"></span></p></td><td class="cl-fd779b26"><p class="cl-fd7778b0"><span class="cl-fd73ea42">2018</span></p></td><td class="cl-fd779b25"><p class="cl-fd7778b0"><span class="cl-fd73ea42">81 (53.6)</span></p></td><td class="cl-fd779b25"><p class="cl-fd7778b0"><span class="cl-fd73ea42">52 (34.4)</span></p></td><td class="cl-fd779b25"><p class="cl-fd7778b0"><span class="cl-fd73ea42">18 (11.9)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-fd779b1c"><p class="cl-fd7778b0"><span class="cl-fd73ea42"></span></p></td><td class="cl-fd779b24"><p class="cl-fd7778b0"><span class="cl-fd73ea42">2019</span></p></td><td class="cl-fd779b1c"><p class="cl-fd7778b0"><span class="cl-fd73ea42">83 (51.6)</span></p></td><td class="cl-fd779b1c"><p class="cl-fd7778b0"><span class="cl-fd73ea42">60 (37.3)</span></p></td><td class="cl-fd779b1c"><p class="cl-fd7778b0"><span class="cl-fd73ea42">18 (11.2)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-fd779b25"><p class="cl-fd7778b0"><span class="cl-fd73ea42"></span></p></td><td class="cl-fd779b26"><p class="cl-fd7778b0"><span class="cl-fd73ea42">2020</span></p></td><td class="cl-fd779b25"><p class="cl-fd7778b0"><span class="cl-fd73ea42">82 (59.9)</span></p></td><td class="cl-fd779b25"><p class="cl-fd7778b0"><span class="cl-fd73ea42">44 (32.1)</span></p></td><td class="cl-fd779b25"><p class="cl-fd7778b0"><span class="cl-fd73ea42">11 (8)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-fd779b1c"><p class="cl-fd7778b0"><span class="cl-fd73ea42"></span></p></td><td class="cl-fd779b24"><p class="cl-fd7778b0"><span class="cl-fd73ea42">2021</span></p></td><td class="cl-fd779b1c"><p class="cl-fd7778b0"><span class="cl-fd73ea42">223 (84.8)</span></p></td><td class="cl-fd779b1c"><p class="cl-fd7778b0"><span class="cl-fd73ea42">34 (12.9)</span></p></td><td class="cl-fd779b1c"><p class="cl-fd7778b0"><span class="cl-fd73ea42">6 (2.3)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-fd779b25"><p class="cl-fd7778b0"><span class="cl-fd73ea42"></span></p></td><td class="cl-fd779b26"><p class="cl-fd7778b0"><span class="cl-fd73ea42">2022</span></p></td><td class="cl-fd779b25"><p class="cl-fd7778b0"><span class="cl-fd73ea42">88 (73.3)</span></p></td><td class="cl-fd779b25"><p class="cl-fd7778b0"><span class="cl-fd73ea42">25 (20.8)</span></p></td><td class="cl-fd779b25"><p class="cl-fd7778b0"><span class="cl-fd73ea42">7 (5.8)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-fd779b1c"><p class="cl-fd7778b0"><span class="cl-fd73ea42"></span></p></td><td class="cl-fd779b24"><p class="cl-fd7778b0"><span class="cl-fd73ea42">2023</span></p></td><td class="cl-fd779b1c"><p class="cl-fd7778b0"><span class="cl-fd73ea42">87 (51.2)</span></p></td><td class="cl-fd779b1c"><p class="cl-fd7778b0"><span class="cl-fd73ea42">63 (37.1)</span></p></td><td class="cl-fd779b1c"><p class="cl-fd7778b0"><span class="cl-fd73ea42">20 (11.8)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-fd779b25"><p class="cl-fd7778b0"><span class="cl-fd73ea42"></span></p></td><td class="cl-fd779b26"><p class="cl-fd7778b0"><span class="cl-fd73ea42">2024</span></p></td><td class="cl-fd779b25"><p class="cl-fd7778b0"><span class="cl-fd73ea42">74 (60.7)</span></p></td><td class="cl-fd779b25"><p class="cl-fd7778b0"><span class="cl-fd73ea42">39 (32)</span></p></td><td class="cl-fd779b25"><p class="cl-fd7778b0"><span class="cl-fd73ea42">9 (7.4)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-fd779b1c"><p class="cl-fd7778b0"><span class="cl-fd73ea42">Quarter</span></p></td><td class="cl-fd779b24"><p class="cl-fd7778b0"><span class="cl-fd73ea42">1</span></p></td><td class="cl-fd779b1c"><p class="cl-fd7778b0"><span class="cl-fd73ea42">253 (62.8)</span></p></td><td class="cl-fd779b1c"><p class="cl-fd7778b0"><span class="cl-fd73ea42">120 (29.8)</span></p></td><td class="cl-fd779b1c"><p class="cl-fd7778b0"><span class="cl-fd73ea42">30 (7.4)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-fd779b25"><p class="cl-fd7778b0"><span class="cl-fd73ea42"></span></p></td><td class="cl-fd779b26"><p class="cl-fd7778b0"><span class="cl-fd73ea42">2</span></p></td><td class="cl-fd779b25"><p class="cl-fd7778b0"><span class="cl-fd73ea42">220 (58.5)</span></p></td><td class="cl-fd779b25"><p class="cl-fd7778b0"><span class="cl-fd73ea42">117 (31.1)</span></p></td><td class="cl-fd779b25"><p class="cl-fd7778b0"><span class="cl-fd73ea42">39 (10.4)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-fd779b1c"><p class="cl-fd7778b0"><span class="cl-fd73ea42"></span></p></td><td class="cl-fd779b24"><p class="cl-fd7778b0"><span class="cl-fd73ea42">3</span></p></td><td class="cl-fd779b1c"><p class="cl-fd7778b0"><span class="cl-fd73ea42">295 (63.2)</span></p></td><td class="cl-fd779b1c"><p class="cl-fd7778b0"><span class="cl-fd73ea42">139 (29.8)</span></p></td><td class="cl-fd779b1c"><p class="cl-fd7778b0"><span class="cl-fd73ea42">33 (7.1)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-fd779b25"><p class="cl-fd7778b0"><span class="cl-fd73ea42"></span></p></td><td class="cl-fd779b26"><p class="cl-fd7778b0"><span class="cl-fd73ea42">4</span></p></td><td class="cl-fd779b25"><p class="cl-fd7778b0"><span class="cl-fd73ea42">187 (60.9)</span></p></td><td class="cl-fd779b25"><p class="cl-fd7778b0"><span class="cl-fd73ea42">96 (31.3)</span></p></td><td class="cl-fd779b25"><p class="cl-fd7778b0"><span class="cl-fd73ea42">24 (7.8)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-fd779b1c"><p class="cl-fd7778b0"><span class="cl-fd73ea42">Weekday</span></p></td><td class="cl-fd779b24"><p class="cl-fd7778b0"><span class="cl-fd73ea42">Friday</span></p></td><td class="cl-fd779b1c"><p class="cl-fd7778b0"><span class="cl-fd73ea42">141 (78.3)</span></p></td><td class="cl-fd779b1c"><p class="cl-fd7778b0"><span class="cl-fd73ea42">31 (17.2)</span></p></td><td class="cl-fd779b1c"><p class="cl-fd7778b0"><span class="cl-fd73ea42">8 (4.4)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-fd779b25"><p class="cl-fd7778b0"><span class="cl-fd73ea42"></span></p></td><td class="cl-fd779b26"><p class="cl-fd7778b0"><span class="cl-fd73ea42">Monday</span></p></td><td class="cl-fd779b25"><p class="cl-fd7778b0"><span class="cl-fd73ea42">114 (64.4)</span></p></td><td class="cl-fd779b25"><p class="cl-fd7778b0"><span class="cl-fd73ea42">49 (27.7)</span></p></td><td class="cl-fd779b25"><p class="cl-fd7778b0"><span class="cl-fd73ea42">14 (7.9)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-fd779b1c"><p class="cl-fd7778b0"><span class="cl-fd73ea42"></span></p></td><td class="cl-fd779b24"><p class="cl-fd7778b0"><span class="cl-fd73ea42">Saturday</span></p></td><td class="cl-fd779b1c"><p class="cl-fd7778b0"><span class="cl-fd73ea42">160 (63.2)</span></p></td><td class="cl-fd779b1c"><p class="cl-fd7778b0"><span class="cl-fd73ea42">81 (32)</span></p></td><td class="cl-fd779b1c"><p class="cl-fd7778b0"><span class="cl-fd73ea42">12 (4.7)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-fd779b25"><p class="cl-fd7778b0"><span class="cl-fd73ea42"></span></p></td><td class="cl-fd779b26"><p class="cl-fd7778b0"><span class="cl-fd73ea42">Sunday</span></p></td><td class="cl-fd779b25"><p class="cl-fd7778b0"><span class="cl-fd73ea42">156 (56.3)</span></p></td><td class="cl-fd779b25"><p class="cl-fd7778b0"><span class="cl-fd73ea42">100 (36.1)</span></p></td><td class="cl-fd779b25"><p class="cl-fd7778b0"><span class="cl-fd73ea42">21 (7.6)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-fd779b1c"><p class="cl-fd7778b0"><span class="cl-fd73ea42"></span></p></td><td class="cl-fd779b24"><p class="cl-fd7778b0"><span class="cl-fd73ea42">Thursday</span></p></td><td class="cl-fd779b1c"><p class="cl-fd7778b0"><span class="cl-fd73ea42">167 (66)</span></p></td><td class="cl-fd779b1c"><p class="cl-fd7778b0"><span class="cl-fd73ea42">66 (26.1)</span></p></td><td class="cl-fd779b1c"><p class="cl-fd7778b0"><span class="cl-fd73ea42">20 (7.9)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-fd779b25"><p class="cl-fd7778b0"><span class="cl-fd73ea42"></span></p></td><td class="cl-fd779b26"><p class="cl-fd7778b0"><span class="cl-fd73ea42">Tuesday</span></p></td><td class="cl-fd779b25"><p class="cl-fd7778b0"><span class="cl-fd73ea42">108 (65.5)</span></p></td><td class="cl-fd779b25"><p class="cl-fd7778b0"><span class="cl-fd73ea42">43 (26.1)</span></p></td><td class="cl-fd779b25"><p class="cl-fd7778b0"><span class="cl-fd73ea42">14 (8.5)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-fd779b2e"><p class="cl-fd7778b0"><span class="cl-fd73ea42"></span></p></td><td class="cl-fd779b2f"><p class="cl-fd7778b0"><span class="cl-fd73ea42">Wednesday</span></p></td><td class="cl-fd779b2e"><p class="cl-fd7778b0"><span class="cl-fd73ea42">109 (44)</span></p></td><td class="cl-fd779b2e"><p class="cl-fd7778b0"><span class="cl-fd73ea42">102 (41.1)</span></p></td><td class="cl-fd779b2e"><p class="cl-fd7778b0"><span class="cl-fd73ea42">37 (14.9)</span></p></td></tr></tbody><tfoot><tr style="overflow-wrap:break-word;"><td colspan="5" class="cl-fd779b30"><p class="cl-fd7778ba"><span class="cl-fd73ea43">·µÉ</span><span class="cl-fd73ea44">Vaccination proportions were calculated row-wise (i.e., by row).</span></p></td></tr></tfoot></table></div>
</div>
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="co"># .................. Clean up all new objects ..................</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(tab_age, tab_sex, tab_marital_status, tab_year, tab_quarter, tab_weekday, </span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>   tab_combined, ft_vacc_summary, totals, create_tab)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="rowwise-tables-summary" class="level2" data-number="1.9">
<h2 data-number="1.9" class="anchored" data-anchor-id="rowwise-tables-summary"><span class="header-section-number">1.9</span> <strong>9. Rowwise Tables (Summary)</strong></h2>
<p>This is not a new table‚Äîrather, it‚Äôs a <strong>conceptual summary</strong> of the row-wise percentage approaches applied in earlier sections.</p>
<p><strong>Importance</strong>:</p>
<ul>
<li>Percentages sum to 100% per row, highlighting within-group distributions.</li>
</ul>
<p><strong>Implications</strong>:</p>
<ul>
<li>Answers: ‚ÄúWithin age group X, what % received each vaccine?‚Äù</li>
</ul>
</section>
<section id="columnwise-tables" class="level2" data-number="1.10">
<h2 data-number="1.10" class="anchored" data-anchor-id="columnwise-tables"><span class="header-section-number">1.10</span> <strong>10. Columnwise Tables</strong></h2>
<p>This version calculates <strong>percentages down each vaccine group column</strong>, rather than across each row.</p>
<p><strong>Importance</strong>:</p>
<ul>
<li>Percentages sum to 100% per column, showing group contributions to totals.</li>
</ul>
<p><strong>Implications</strong>:</p>
<ul>
<li>Answers: ‚ÄúAmong Respiratory vaccines, what % are from age group X?‚Äù</li>
<li><em>Use this when</em>: You want to know, for example, what percentage of all Respiratory vaccine users were aged below 25 years.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ------------ 10. Columnwise Tables -------------------------------------------</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Prepare Vaccination Uptake Table (All Variables Using Column Percentages)</span></span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a><span class="co"># --- Convert selected variables to character type for proper label handling ---</span></span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a>vacc_1524 <span class="ot">&lt;-</span> vacc_1524 <span class="sc">%&gt;%</span></span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">c</span>(gender, age_3group, marital_2group, year_3group, vacc_quarter, race_grouped), as.character))</span>
<span id="cb29-8"><a href="#cb29-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-9"><a href="#cb29-9" aria-hidden="true" tabindex="-1"></a><span class="co"># --- Create general table-building function with optional column percentage flag ---</span></span>
<span id="cb29-10"><a href="#cb29-10" aria-hidden="true" tabindex="-1"></a><span class="co"># This function creates a summary count table of vaccination type by a categorical variable.</span></span>
<span id="cb29-11"><a href="#cb29-11" aria-hidden="true" tabindex="-1"></a><span class="co"># If use_col_percentage is TRUE, the summary will support column-based percentage formatting.</span></span>
<span id="cb29-12"><a href="#cb29-12" aria-hidden="true" tabindex="-1"></a>create_tab <span class="ot">&lt;-</span> <span class="cf">function</span>(data, var, label, <span class="at">use_col_percentage =</span> <span class="cn">TRUE</span>) {</span>
<span id="cb29-13"><a href="#cb29-13" aria-hidden="true" tabindex="-1"></a>  tab_main <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span></span>
<span id="cb29-14"><a href="#cb29-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>({{ var }})) <span class="sc">%&gt;%</span></span>
<span id="cb29-15"><a href="#cb29-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tabyl</span>({{ var }}, vacc_group3) <span class="sc">%&gt;%</span></span>
<span id="cb29-16"><a href="#cb29-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">Category =</span> label, <span class="at">.before =</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb29-17"><a href="#cb29-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rename</span>(<span class="at">Label =</span> {{ var }}) <span class="sc">%&gt;%</span></span>
<span id="cb29-18"><a href="#cb29-18" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">Label =</span> <span class="fu">as.character</span>(Label))</span>
<span id="cb29-19"><a href="#cb29-19" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb29-20"><a href="#cb29-20" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Add a row for "Unknown" if missing values are found</span></span>
<span id="cb29-21"><a href="#cb29-21" aria-hidden="true" tabindex="-1"></a>  na_count <span class="ot">&lt;-</span> <span class="fu">sum</span>(<span class="fu">is.na</span>(<span class="fu">pull</span>(data, {{ var }})))</span>
<span id="cb29-22"><a href="#cb29-22" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (na_count <span class="sc">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb29-23"><a href="#cb29-23" aria-hidden="true" tabindex="-1"></a>    na_row <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb29-24"><a href="#cb29-24" aria-hidden="true" tabindex="-1"></a>      <span class="at">Category =</span> label,</span>
<span id="cb29-25"><a href="#cb29-25" aria-hidden="true" tabindex="-1"></a>      <span class="at">Label =</span> <span class="st">"Unknown"</span>,</span>
<span id="cb29-26"><a href="#cb29-26" aria-hidden="true" tabindex="-1"></a>      <span class="st">`</span><span class="at">Respiratory vaccines</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">sum</span>(data<span class="sc">$</span>vacc_group3 <span class="sc">==</span> <span class="st">"Respiratory vaccines"</span> <span class="sc">&amp;</span> <span class="fu">is.na</span>(<span class="fu">pull</span>(data, {{ var }})), <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb29-27"><a href="#cb29-27" aria-hidden="true" tabindex="-1"></a>      <span class="st">`</span><span class="at">Childhood vaccines</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">sum</span>(data<span class="sc">$</span>vacc_group3 <span class="sc">==</span> <span class="st">"Childhood vaccines"</span> <span class="sc">&amp;</span> <span class="fu">is.na</span>(<span class="fu">pull</span>(data, {{ var }})), <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb29-28"><a href="#cb29-28" aria-hidden="true" tabindex="-1"></a>      <span class="at">Other =</span> <span class="fu">sum</span>(data<span class="sc">$</span>vacc_group3 <span class="sc">==</span> <span class="st">"Other"</span> <span class="sc">&amp;</span> <span class="fu">is.na</span>(<span class="fu">pull</span>(data, {{ var }})), <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb29-29"><a href="#cb29-29" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb29-30"><a href="#cb29-30" aria-hidden="true" tabindex="-1"></a>    tab_combined <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(tab_main, na_row)</span>
<span id="cb29-31"><a href="#cb29-31" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb29-32"><a href="#cb29-32" aria-hidden="true" tabindex="-1"></a>    tab_combined <span class="ot">&lt;-</span> tab_main</span>
<span id="cb29-33"><a href="#cb29-33" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb29-34"><a href="#cb29-34" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb29-35"><a href="#cb29-35" aria-hidden="true" tabindex="-1"></a>  tab_combined <span class="sc">%&gt;%</span></span>
<span id="cb29-36"><a href="#cb29-36" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">use_col_percentage =</span> use_col_percentage)</span>
<span id="cb29-37"><a href="#cb29-37" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb29-38"><a href="#cb29-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-39"><a href="#cb29-39" aria-hidden="true" tabindex="-1"></a><span class="co"># --- Generate summary tables for each variable using column percentages ---</span></span>
<span id="cb29-40"><a href="#cb29-40" aria-hidden="true" tabindex="-1"></a>tab_gender    <span class="ot">&lt;-</span> <span class="fu">create_tab</span>(vacc_1524, gender, <span class="st">"Gender"</span>)</span>
<span id="cb29-41"><a href="#cb29-41" aria-hidden="true" tabindex="-1"></a>tab_age       <span class="ot">&lt;-</span> <span class="fu">create_tab</span>(vacc_1524, age_3group, <span class="st">"Age group"</span>)</span>
<span id="cb29-42"><a href="#cb29-42" aria-hidden="true" tabindex="-1"></a>tab_marital   <span class="ot">&lt;-</span> <span class="fu">create_tab</span>(vacc_1524, marital_2group, <span class="st">"Marital status·µá"</span>)</span>
<span id="cb29-43"><a href="#cb29-43" aria-hidden="true" tabindex="-1"></a>tab_year      <span class="ot">&lt;-</span> <span class="fu">create_tab</span>(vacc_1524, year_3group, <span class="st">"Year group"</span>)</span>
<span id="cb29-44"><a href="#cb29-44" aria-hidden="true" tabindex="-1"></a>tab_quarter   <span class="ot">&lt;-</span> <span class="fu">create_tab</span>(vacc_1524, vacc_quarter, <span class="st">"Quarter"</span>)</span>
<span id="cb29-45"><a href="#cb29-45" aria-hidden="true" tabindex="-1"></a>tab_race      <span class="ot">&lt;-</span> <span class="fu">create_tab</span>(vacc_1524, race_grouped, <span class="st">"Race group"</span>)</span>
<span id="cb29-46"><a href="#cb29-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-47"><a href="#cb29-47" aria-hidden="true" tabindex="-1"></a><span class="co"># --- Combine all variable-level tables into one ---</span></span>
<span id="cb29-48"><a href="#cb29-48" aria-hidden="true" tabindex="-1"></a>tab_combined <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(</span>
<span id="cb29-49"><a href="#cb29-49" aria-hidden="true" tabindex="-1"></a>  tab_gender, tab_age, tab_marital,</span>
<span id="cb29-50"><a href="#cb29-50" aria-hidden="true" tabindex="-1"></a>  tab_year, tab_quarter, tab_race</span>
<span id="cb29-51"><a href="#cb29-51" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb29-52"><a href="#cb29-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-53"><a href="#cb29-53" aria-hidden="true" tabindex="-1"></a><span class="co"># --- Calculate percentages and format values into strings with "Number (%)" ---</span></span>
<span id="cb29-54"><a href="#cb29-54" aria-hidden="true" tabindex="-1"></a>tab_combined <span class="ot">&lt;-</span> tab_combined <span class="sc">%&gt;%</span></span>
<span id="cb29-55"><a href="#cb29-55" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Category) <span class="sc">%&gt;%</span></span>
<span id="cb29-56"><a href="#cb29-56" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb29-57"><a href="#cb29-57" aria-hidden="true" tabindex="-1"></a>    <span class="at">use_col =</span> <span class="cn">TRUE</span>,  <span class="co"># column percentages applied uniformly</span></span>
<span id="cb29-58"><a href="#cb29-58" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb29-59"><a href="#cb29-59" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Calculate denominators excluding "Unknown"</span></span>
<span id="cb29-60"><a href="#cb29-60" aria-hidden="true" tabindex="-1"></a>    <span class="at">Total_Resp =</span> <span class="fu">sum</span>(<span class="st">`</span><span class="at">Respiratory vaccines</span><span class="st">`</span>[Label <span class="sc">!=</span> <span class="st">"Unknown"</span>], <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb29-61"><a href="#cb29-61" aria-hidden="true" tabindex="-1"></a>    <span class="at">Total_Child =</span> <span class="fu">sum</span>(<span class="st">`</span><span class="at">Childhood vaccines</span><span class="st">`</span>[Label <span class="sc">!=</span> <span class="st">"Unknown"</span>], <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb29-62"><a href="#cb29-62" aria-hidden="true" tabindex="-1"></a>    <span class="at">Total_Other =</span> <span class="fu">sum</span>(Other[Label <span class="sc">!=</span> <span class="st">"Unknown"</span>], <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb29-63"><a href="#cb29-63" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb29-64"><a href="#cb29-64" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Calculate percentages</span></span>
<span id="cb29-65"><a href="#cb29-65" aria-hidden="true" tabindex="-1"></a>    <span class="at">Resp_prop =</span> <span class="fu">ifelse</span>(Label <span class="sc">!=</span> <span class="st">"Unknown"</span>, <span class="fu">round</span>(<span class="dv">100</span> <span class="sc">*</span> <span class="st">`</span><span class="at">Respiratory vaccines</span><span class="st">`</span> <span class="sc">/</span> Total_Resp, <span class="dv">1</span>), <span class="cn">NA</span>),</span>
<span id="cb29-66"><a href="#cb29-66" aria-hidden="true" tabindex="-1"></a>    <span class="at">Child_prop =</span> <span class="fu">ifelse</span>(Label <span class="sc">!=</span> <span class="st">"Unknown"</span>, <span class="fu">round</span>(<span class="dv">100</span> <span class="sc">*</span> <span class="st">`</span><span class="at">Childhood vaccines</span><span class="st">`</span> <span class="sc">/</span> Total_Child, <span class="dv">1</span>), <span class="cn">NA</span>),</span>
<span id="cb29-67"><a href="#cb29-67" aria-hidden="true" tabindex="-1"></a>    <span class="at">Other_prop =</span> <span class="fu">ifelse</span>(Label <span class="sc">!=</span> <span class="st">"Unknown"</span>, <span class="fu">round</span>(<span class="dv">100</span> <span class="sc">*</span> Other <span class="sc">/</span> Total_Other, <span class="dv">1</span>), <span class="cn">NA</span>),</span>
<span id="cb29-68"><a href="#cb29-68" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb29-69"><a href="#cb29-69" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Format final output as "number (percentage)"</span></span>
<span id="cb29-70"><a href="#cb29-70" aria-hidden="true" tabindex="-1"></a>    <span class="at">Respiratory =</span> <span class="fu">ifelse</span>(<span class="fu">is.na</span>(Resp_prop),</span>
<span id="cb29-71"><a href="#cb29-71" aria-hidden="true" tabindex="-1"></a>                         <span class="fu">paste0</span>(<span class="fu">comma</span>(<span class="st">`</span><span class="at">Respiratory vaccines</span><span class="st">`</span>)),</span>
<span id="cb29-72"><a href="#cb29-72" aria-hidden="true" tabindex="-1"></a>                         <span class="fu">paste0</span>(<span class="fu">comma</span>(<span class="st">`</span><span class="at">Respiratory vaccines</span><span class="st">`</span>), <span class="st">" ("</span>, Resp_prop, <span class="st">")"</span>)),</span>
<span id="cb29-73"><a href="#cb29-73" aria-hidden="true" tabindex="-1"></a>    <span class="at">Childhood =</span> <span class="fu">ifelse</span>(<span class="fu">is.na</span>(Child_prop),</span>
<span id="cb29-74"><a href="#cb29-74" aria-hidden="true" tabindex="-1"></a>                       <span class="fu">paste0</span>(<span class="fu">comma</span>(<span class="st">`</span><span class="at">Childhood vaccines</span><span class="st">`</span>)),</span>
<span id="cb29-75"><a href="#cb29-75" aria-hidden="true" tabindex="-1"></a>                       <span class="fu">paste0</span>(<span class="fu">comma</span>(<span class="st">`</span><span class="at">Childhood vaccines</span><span class="st">`</span>), <span class="st">" ("</span>, Child_prop, <span class="st">")"</span>)),</span>
<span id="cb29-76"><a href="#cb29-76" aria-hidden="true" tabindex="-1"></a>    <span class="at">Other_grp =</span> <span class="fu">ifelse</span>(<span class="fu">is.na</span>(Other_prop),</span>
<span id="cb29-77"><a href="#cb29-77" aria-hidden="true" tabindex="-1"></a>                       <span class="fu">paste0</span>(<span class="fu">comma</span>(Other)),</span>
<span id="cb29-78"><a href="#cb29-78" aria-hidden="true" tabindex="-1"></a>                       <span class="fu">paste0</span>(<span class="fu">comma</span>(Other), <span class="st">" ("</span>, Other_prop, <span class="st">")"</span>))</span>
<span id="cb29-79"><a href="#cb29-79" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb29-80"><a href="#cb29-80" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb29-81"><a href="#cb29-81" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-82"><a href="#cb29-82" aria-hidden="true" tabindex="-1"></a><span class="co"># --- Final clean-up: labels, superscripts, and hiding "0 (0)" from Unknown row ---</span></span>
<span id="cb29-83"><a href="#cb29-83" aria-hidden="true" tabindex="-1"></a>tab_combined <span class="ot">&lt;-</span> tab_combined <span class="sc">%&gt;%</span></span>
<span id="cb29-84"><a href="#cb29-84" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb29-85"><a href="#cb29-85" aria-hidden="true" tabindex="-1"></a>    <span class="at">Label =</span> <span class="fu">ifelse</span>(Label <span class="sc">==</span> <span class="st">"Other"</span>, <span class="st">"Other·∂ú"</span>, Label),</span>
<span id="cb29-86"><a href="#cb29-86" aria-hidden="true" tabindex="-1"></a>    <span class="at">Respiratory =</span> <span class="fu">ifelse</span>(Label <span class="sc">==</span> <span class="st">"Unknown"</span> <span class="sc">&amp;</span> <span class="st">`</span><span class="at">Respiratory vaccines</span><span class="st">`</span> <span class="sc">==</span> <span class="dv">0</span>, <span class="st">""</span>, Respiratory),</span>
<span id="cb29-87"><a href="#cb29-87" aria-hidden="true" tabindex="-1"></a>    <span class="at">Childhood   =</span> <span class="fu">ifelse</span>(Label <span class="sc">==</span> <span class="st">"Unknown"</span> <span class="sc">&amp;</span> <span class="st">`</span><span class="at">Childhood vaccines</span><span class="st">`</span> <span class="sc">==</span> <span class="dv">0</span>, <span class="st">""</span>, Childhood),</span>
<span id="cb29-88"><a href="#cb29-88" aria-hidden="true" tabindex="-1"></a>    <span class="at">Other_grp   =</span> <span class="fu">ifelse</span>(Label <span class="sc">==</span> <span class="st">"Unknown"</span> <span class="sc">&amp;</span> Other <span class="sc">==</span> <span class="dv">0</span>, <span class="st">""</span>, Other_grp)</span>
<span id="cb29-89"><a href="#cb29-89" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb29-90"><a href="#cb29-90" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Category) <span class="sc">%&gt;%</span></span>
<span id="cb29-91"><a href="#cb29-91" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Category =</span> <span class="fu">ifelse</span>(<span class="fu">row_number</span>() <span class="sc">==</span> <span class="dv">1</span>, Category, <span class="st">""</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb29-92"><a href="#cb29-92" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb29-93"><a href="#cb29-93" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Category, Label, Respiratory, Childhood, Other_grp)</span>
<span id="cb29-94"><a href="#cb29-94" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-95"><a href="#cb29-95" aria-hidden="true" tabindex="-1"></a><span class="co"># --- Get total N for each vaccine group to display in header ---</span></span>
<span id="cb29-96"><a href="#cb29-96" aria-hidden="true" tabindex="-1"></a>totals <span class="ot">&lt;-</span> <span class="fu">table</span>(vacc_1524<span class="sc">$</span>vacc_group3)</span>
<span id="cb29-97"><a href="#cb29-97" aria-hidden="true" tabindex="-1"></a>total_resp <span class="ot">&lt;-</span> totals[<span class="st">"Respiratory vaccines"</span>]</span>
<span id="cb29-98"><a href="#cb29-98" aria-hidden="true" tabindex="-1"></a>total_child <span class="ot">&lt;-</span> totals[<span class="st">"Childhood vaccines"</span>]</span>
<span id="cb29-99"><a href="#cb29-99" aria-hidden="true" tabindex="-1"></a>total_other <span class="ot">&lt;-</span> totals[<span class="st">"Other"</span>]</span>
<span id="cb29-100"><a href="#cb29-100" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-101"><a href="#cb29-101" aria-hidden="true" tabindex="-1"></a><span class="co"># --- Build flextable for formatted presentation ---</span></span>
<span id="cb29-102"><a href="#cb29-102" aria-hidden="true" tabindex="-1"></a>table_vacc_summary <span class="ot">&lt;-</span> <span class="fu">flextable</span>(tab_combined) <span class="sc">%&gt;%</span></span>
<span id="cb29-103"><a href="#cb29-103" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_header_labels</span>(</span>
<span id="cb29-104"><a href="#cb29-104" aria-hidden="true" tabindex="-1"></a>    <span class="at">Category =</span> <span class="st">"Variable type"</span>,</span>
<span id="cb29-105"><a href="#cb29-105" aria-hidden="true" tabindex="-1"></a>    <span class="at">Label =</span> <span class="st">"Values"</span>,</span>
<span id="cb29-106"><a href="#cb29-106" aria-hidden="true" tabindex="-1"></a>    <span class="at">Respiratory =</span> <span class="st">"Number (%)·µÉ"</span>,</span>
<span id="cb29-107"><a href="#cb29-107" aria-hidden="true" tabindex="-1"></a>    <span class="at">Childhood =</span> <span class="st">"Number (%)·µÉ"</span>,</span>
<span id="cb29-108"><a href="#cb29-108" aria-hidden="true" tabindex="-1"></a>    <span class="at">Other_grp =</span> <span class="st">"Number (%)·µÉ"</span></span>
<span id="cb29-109"><a href="#cb29-109" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb29-110"><a href="#cb29-110" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_header_row</span>(</span>
<span id="cb29-111"><a href="#cb29-111" aria-hidden="true" tabindex="-1"></a>    <span class="at">values =</span> <span class="fu">c</span>(<span class="st">""</span>, <span class="st">""</span>,</span>
<span id="cb29-112"><a href="#cb29-112" aria-hidden="true" tabindex="-1"></a>               <span class="fu">paste0</span>(<span class="st">"Respiratory vaccines (N = "</span>, <span class="fu">format</span>(total_resp, <span class="at">big.mark =</span> <span class="st">","</span>), <span class="st">")"</span>),</span>
<span id="cb29-113"><a href="#cb29-113" aria-hidden="true" tabindex="-1"></a>               <span class="fu">paste0</span>(<span class="st">"Childhood vaccines (N = "</span>, <span class="fu">format</span>(total_child, <span class="at">big.mark =</span> <span class="st">","</span>), <span class="st">")"</span>),</span>
<span id="cb29-114"><a href="#cb29-114" aria-hidden="true" tabindex="-1"></a>               <span class="fu">paste0</span>(<span class="st">"Other (N = "</span>, <span class="fu">format</span>(total_other, <span class="at">big.mark =</span> <span class="st">","</span>), <span class="st">")"</span>)),</span>
<span id="cb29-115"><a href="#cb29-115" aria-hidden="true" tabindex="-1"></a>    <span class="at">colwidths =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>),</span>
<span id="cb29-116"><a href="#cb29-116" aria-hidden="true" tabindex="-1"></a>    <span class="at">top =</span> <span class="cn">TRUE</span></span>
<span id="cb29-117"><a href="#cb29-117" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb29-118"><a href="#cb29-118" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_header_row</span>(</span>
<span id="cb29-119"><a href="#cb29-119" aria-hidden="true" tabindex="-1"></a>    <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"Description"</span>, <span class="st">"Vaccination uptake"</span>),</span>
<span id="cb29-120"><a href="#cb29-120" aria-hidden="true" tabindex="-1"></a>    <span class="at">colwidths =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">3</span>),</span>
<span id="cb29-121"><a href="#cb29-121" aria-hidden="true" tabindex="-1"></a>    <span class="at">top =</span> <span class="cn">TRUE</span></span>
<span id="cb29-122"><a href="#cb29-122" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb29-123"><a href="#cb29-123" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_box</span>() <span class="sc">%&gt;%</span></span>
<span id="cb29-124"><a href="#cb29-124" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_table_properties</span>(<span class="at">layout =</span> <span class="st">"autofit"</span>, <span class="at">width =</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb29-125"><a href="#cb29-125" aria-hidden="true" tabindex="-1"></a>  <span class="fu">width</span>(<span class="at">j =</span> <span class="dv">1</span>, <span class="at">width =</span> <span class="fl">1.5</span>) <span class="sc">%&gt;%</span></span>
<span id="cb29-126"><a href="#cb29-126" aria-hidden="true" tabindex="-1"></a>  <span class="fu">width</span>(<span class="at">j =</span> <span class="dv">2</span>, <span class="at">width =</span> <span class="fl">2.5</span>) <span class="sc">%&gt;%</span></span>
<span id="cb29-127"><a href="#cb29-127" aria-hidden="true" tabindex="-1"></a>  <span class="fu">width</span>(<span class="at">j =</span> <span class="dv">3</span><span class="sc">:</span><span class="dv">5</span>, <span class="at">width =</span> <span class="fl">1.5</span>) <span class="sc">%&gt;%</span></span>
<span id="cb29-128"><a href="#cb29-128" aria-hidden="true" tabindex="-1"></a>  <span class="fu">align</span>(<span class="at">align =</span> <span class="st">"justify"</span>, <span class="at">part =</span> <span class="st">"all"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb29-129"><a href="#cb29-129" aria-hidden="true" tabindex="-1"></a>  <span class="fu">border_remove</span>() <span class="sc">%&gt;%</span></span>
<span id="cb29-130"><a href="#cb29-130" aria-hidden="true" tabindex="-1"></a>  <span class="fu">border</span>(<span class="at">part =</span> <span class="st">"header"</span>, <span class="at">i =</span> <span class="dv">1</span>, <span class="at">border.top =</span> <span class="fu">fp_border</span>(<span class="at">color =</span> <span class="st">"black"</span>, <span class="at">width =</span> <span class="dv">1</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb29-131"><a href="#cb29-131" aria-hidden="true" tabindex="-1"></a>  <span class="fu">border</span>(<span class="at">part =</span> <span class="st">"header"</span>, <span class="at">i =</span> <span class="dv">3</span>, <span class="at">border.bottom =</span> <span class="fu">fp_border</span>(<span class="at">color =</span> <span class="st">"black"</span>, <span class="at">width =</span> <span class="dv">1</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb29-132"><a href="#cb29-132" aria-hidden="true" tabindex="-1"></a>  <span class="fu">border_inner_h</span>(<span class="at">part =</span> <span class="st">"header"</span>, <span class="at">border =</span> <span class="fu">fp_border</span>(<span class="at">color =</span> <span class="st">"black"</span>, <span class="at">width =</span> <span class="fl">0.8</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb29-133"><a href="#cb29-133" aria-hidden="true" tabindex="-1"></a>  <span class="fu">border_inner_h</span>(<span class="at">part =</span> <span class="st">"body"</span>, <span class="at">border =</span> <span class="fu">fp_border</span>(<span class="at">color =</span> <span class="st">"black"</span>, <span class="at">width =</span> <span class="fl">0.8</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb29-134"><a href="#cb29-134" aria-hidden="true" tabindex="-1"></a>  <span class="fu">border</span>(<span class="at">part =</span> <span class="st">"body"</span>, <span class="at">i =</span> <span class="fu">nrow</span>(tab_combined), <span class="at">border.bottom =</span> <span class="fu">fp_border</span>(<span class="at">color =</span> <span class="st">"black"</span>, <span class="at">width =</span> <span class="dv">1</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb29-135"><a href="#cb29-135" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_caption</span>(<span class="fu">as_paragraph</span>(<span class="fu">as_chunk</span>(</span>
<span id="cb29-136"><a href="#cb29-136" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Table xx: Column-percentage summary of vaccination uptake across all demographic variables, 2015‚Äì2024."</span>,</span>
<span id="cb29-137"><a href="#cb29-137" aria-hidden="true" tabindex="-1"></a>    <span class="at">props =</span> <span class="fu">fp_text</span>(<span class="at">font.size =</span> <span class="dv">12</span>, <span class="at">font.family =</span> <span class="st">"Times New Roman"</span>, <span class="at">bold =</span> <span class="cn">FALSE</span>)</span>
<span id="cb29-138"><a href="#cb29-138" aria-hidden="true" tabindex="-1"></a>  ))) <span class="sc">%&gt;%</span></span>
<span id="cb29-139"><a href="#cb29-139" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_footer_lines</span>(<span class="at">values =</span> <span class="fu">c</span>(</span>
<span id="cb29-140"><a href="#cb29-140" aria-hidden="true" tabindex="-1"></a>    <span class="st">"·µÉ Vaccination proportions were calculated using column percentages for all variables."</span>,</span>
<span id="cb29-141"><a href="#cb29-141" aria-hidden="true" tabindex="-1"></a>    <span class="st">"·µá Marital status was grouped into two: partnered (married) and not-partnered (divorced, widowed, single)."</span>,</span>
<span id="cb29-142"><a href="#cb29-142" aria-hidden="true" tabindex="-1"></a>    <span class="st">"·∂ú Other race refers to those identifying as native or other racial groups."</span></span>
<span id="cb29-143"><a href="#cb29-143" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">%&gt;%</span></span>
<span id="cb29-144"><a href="#cb29-144" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fontsize</span>(<span class="at">part =</span> <span class="st">"header"</span>, <span class="at">size =</span> <span class="dv">12</span>) <span class="sc">%&gt;%</span></span>
<span id="cb29-145"><a href="#cb29-145" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fontsize</span>(<span class="at">part =</span> <span class="st">"body"</span>, <span class="at">size =</span> <span class="dv">11</span>) <span class="sc">%&gt;%</span></span>
<span id="cb29-146"><a href="#cb29-146" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fontsize</span>(<span class="at">part =</span> <span class="st">"footer"</span>, <span class="at">size =</span> <span class="dv">10</span>) <span class="sc">%&gt;%</span></span>
<span id="cb29-147"><a href="#cb29-147" aria-hidden="true" tabindex="-1"></a>  <span class="fu">font</span>(<span class="at">part =</span> <span class="st">"all"</span>, <span class="at">fontname =</span> <span class="st">"Times New Roman"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb29-148"><a href="#cb29-148" aria-hidden="true" tabindex="-1"></a>  <span class="fu">color</span>(<span class="at">part =</span> <span class="st">"header"</span>, <span class="at">color =</span> <span class="st">"white"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb29-149"><a href="#cb29-149" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bg</span>(<span class="at">part =</span> <span class="st">"header"</span>, <span class="at">bg =</span> <span class="st">"black"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb29-150"><a href="#cb29-150" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bg</span>(<span class="at">j =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>, <span class="at">i =</span> <span class="fu">seq</span>(<span class="dv">2</span>, <span class="fu">nrow</span>(tab_combined), <span class="dv">2</span>), <span class="at">bg =</span> <span class="st">"white"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb29-151"><a href="#cb29-151" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bold</span>(<span class="at">j =</span> <span class="dv">1</span>, <span class="at">part =</span> <span class="st">"body"</span>)</span>
<span id="cb29-152"><a href="#cb29-152" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-153"><a href="#cb29-153" aria-hidden="true" tabindex="-1"></a><span class="co"># --- Display final table ---</span></span>
<span id="cb29-154"><a href="#cb29-154" aria-hidden="true" tabindex="-1"></a>table_vacc_summary</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="tabwid"><style>.cl-fdc625e6{table-layout:auto;width:100%;}.cl-fdbd6956{font-family:'Times New Roman';font-size:12pt;font-weight:bold;font-style:normal;text-decoration:none;color:rgba(255, 255, 255, 1.00);background-color:transparent;}.cl-fdbd6960{font-family:'Times New Roman';font-size:11pt;font-weight:bold;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-fdbd6961{font-family:'Times New Roman';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-fdbd696a{font-family:'Times New Roman';font-size:10pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-fdc117ae{margin:0;text-align:justify;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-fdc117b8{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-fdc13a9a{background-color:rgba(0, 0, 0, 1.00);vertical-align: middle;border-bottom: 0.8pt solid rgba(0, 0, 0, 1.00);border-top: 1pt solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-fdc13aa4{background-color:rgba(0, 0, 0, 1.00);vertical-align: middle;border-bottom: 0.8pt solid rgba(0, 0, 0, 1.00);border-top: 1pt solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-fdc13aa5{background-color:rgba(0, 0, 0, 1.00);vertical-align: middle;border-bottom: 0.8pt solid rgba(0, 0, 0, 1.00);border-top: 0.8pt solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-fdc13aae{background-color:rgba(0, 0, 0, 1.00);vertical-align: middle;border-bottom: 0.8pt solid rgba(0, 0, 0, 1.00);border-top: 0.8pt solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-fdc13ab8{background-color:rgba(0, 0, 0, 1.00);vertical-align: middle;border-bottom: 1pt solid rgba(0, 0, 0, 1.00);border-top: 0.8pt solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-fdc13ab9{background-color:rgba(0, 0, 0, 1.00);vertical-align: middle;border-bottom: 1pt solid rgba(0, 0, 0, 1.00);border-top: 0.8pt solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-fdc13aba{background-color:transparent;vertical-align: middle;border-bottom: 0.8pt solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-fdc13ac2{background-color:transparent;vertical-align: middle;border-bottom: 0.8pt solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-fdc13ac3{background-color:rgba(255, 255, 255, 1.00);vertical-align: middle;border-bottom: 0.8pt solid rgba(0, 0, 0, 1.00);border-top: 0.8pt solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-fdc13ac4{background-color:rgba(255, 255, 255, 1.00);vertical-align: middle;border-bottom: 0.8pt solid rgba(0, 0, 0, 1.00);border-top: 0.8pt solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-fdc13acc{background-color:transparent;vertical-align: middle;border-bottom: 0.8pt solid rgba(0, 0, 0, 1.00);border-top: 0.8pt solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-fdc13acd{background-color:transparent;vertical-align: middle;border-bottom: 0.8pt solid rgba(0, 0, 0, 1.00);border-top: 0.8pt solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-fdc13ad6{background-color:transparent;vertical-align: middle;border-bottom: 1pt solid rgba(0, 0, 0, 1.00);border-top: 0.8pt solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-fdc13ad7{background-color:transparent;vertical-align: middle;border-bottom: 1pt solid rgba(0, 0, 0, 1.00);border-top: 0.8pt solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-fdc13ad8{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(255, 255, 255, 0.00);border-top: 0 solid rgba(255, 255, 255, 0.00);border-left: 0 solid rgba(255, 255, 255, 0.00);border-right: 0 solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-fdc13ad9{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(255, 255, 255, 0.00);border-top: 0 solid rgba(255, 255, 255, 0.00);border-left: 0 solid rgba(255, 255, 255, 0.00);border-right: 0 solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table data-quarto-disable-processing="true" class="cl-fdc625e6"><thead><tr style="overflow-wrap:break-word;"><th colspan="2" class="cl-fdc13a9a"><p class="cl-fdc117ae"><span class="cl-fdbd6956">Description</span></p></th><th colspan="3" class="cl-fdc13a9a"><p class="cl-fdc117ae"><span class="cl-fdbd6956">Vaccination uptake</span></p></th></tr><tr style="overflow-wrap:break-word;"><th class="cl-fdc13aa5"><p class="cl-fdc117ae"><span class="cl-fdbd6956"></span></p></th><th class="cl-fdc13aae"><p class="cl-fdc117ae"><span class="cl-fdbd6956"></span></p></th><th class="cl-fdc13aa5"><p class="cl-fdc117ae"><span class="cl-fdbd6956">Respiratory vaccines (N = 955)</span></p></th><th class="cl-fdc13aa5"><p class="cl-fdc117ae"><span class="cl-fdbd6956">Childhood vaccines (N = 472)</span></p></th><th class="cl-fdc13aa5"><p class="cl-fdc117ae"><span class="cl-fdbd6956">Other (N = 126)</span></p></th></tr><tr style="overflow-wrap:break-word;"><th class="cl-fdc13ab8"><p class="cl-fdc117ae"><span class="cl-fdbd6956">Variable type</span></p></th><th class="cl-fdc13ab9"><p class="cl-fdc117ae"><span class="cl-fdbd6956">Values</span></p></th><th class="cl-fdc13ab8"><p class="cl-fdc117ae"><span class="cl-fdbd6956">Number (%)·µÉ</span></p></th><th class="cl-fdc13ab8"><p class="cl-fdc117ae"><span class="cl-fdbd6956">Number (%)·µÉ</span></p></th><th class="cl-fdc13ab8"><p class="cl-fdc117ae"><span class="cl-fdbd6956">Number (%)·µÉ</span></p></th></tr></thead><tbody><tr style="overflow-wrap:break-word;"><td class="cl-fdc13aba"><p class="cl-fdc117ae"><span class="cl-fdbd6960">Gender</span></p></td><td class="cl-fdc13ac2"><p class="cl-fdc117ae"><span class="cl-fdbd6961">Female</span></p></td><td class="cl-fdc13aba"><p class="cl-fdc117ae"><span class="cl-fdbd6961">511 (53.5)</span></p></td><td class="cl-fdc13aba"><p class="cl-fdc117ae"><span class="cl-fdbd6961">233 (49.4)</span></p></td><td class="cl-fdc13aba"><p class="cl-fdc117ae"><span class="cl-fdbd6961">54 (42.9)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-fdc13ac3"><p class="cl-fdc117ae"><span class="cl-fdbd6960"></span></p></td><td class="cl-fdc13ac4"><p class="cl-fdc117ae"><span class="cl-fdbd6961">Male</span></p></td><td class="cl-fdc13ac3"><p class="cl-fdc117ae"><span class="cl-fdbd6961">444 (46.5)</span></p></td><td class="cl-fdc13ac3"><p class="cl-fdc117ae"><span class="cl-fdbd6961">239 (50.6)</span></p></td><td class="cl-fdc13ac3"><p class="cl-fdc117ae"><span class="cl-fdbd6961">72 (57.1)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-fdc13acc"><p class="cl-fdc117ae"><span class="cl-fdbd6960">Age group</span></p></td><td class="cl-fdc13acd"><p class="cl-fdc117ae"><span class="cl-fdbd6961">&lt;25</span></p></td><td class="cl-fdc13acc"><p class="cl-fdc117ae"><span class="cl-fdbd6961">332 (34.8)</span></p></td><td class="cl-fdc13acc"><p class="cl-fdc117ae"><span class="cl-fdbd6961">337 (71.4)</span></p></td><td class="cl-fdc13acc"><p class="cl-fdc117ae"><span class="cl-fdbd6961">90 (71.4)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-fdc13ac3"><p class="cl-fdc117ae"><span class="cl-fdbd6960"></span></p></td><td class="cl-fdc13ac4"><p class="cl-fdc117ae"><span class="cl-fdbd6961">25-34</span></p></td><td class="cl-fdc13ac3"><p class="cl-fdc117ae"><span class="cl-fdbd6961">98 (10.3)</span></p></td><td class="cl-fdc13ac3"><p class="cl-fdc117ae"><span class="cl-fdbd6961">51 (10.8)</span></p></td><td class="cl-fdc13ac3"><p class="cl-fdc117ae"><span class="cl-fdbd6961">0 (0)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-fdc13acc"><p class="cl-fdc117ae"><span class="cl-fdbd6960"></span></p></td><td class="cl-fdc13acd"><p class="cl-fdc117ae"><span class="cl-fdbd6961">35+</span></p></td><td class="cl-fdc13acc"><p class="cl-fdc117ae"><span class="cl-fdbd6961">525 (55)</span></p></td><td class="cl-fdc13acc"><p class="cl-fdc117ae"><span class="cl-fdbd6961">84 (17.8)</span></p></td><td class="cl-fdc13acc"><p class="cl-fdc117ae"><span class="cl-fdbd6961">36 (28.6)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-fdc13ac3"><p class="cl-fdc117ae"><span class="cl-fdbd6960">Marital status·µá</span></p></td><td class="cl-fdc13ac4"><p class="cl-fdc117ae"><span class="cl-fdbd6961">Not partnered</span></p></td><td class="cl-fdc13ac3"><p class="cl-fdc117ae"><span class="cl-fdbd6961">286 (49.7)</span></p></td><td class="cl-fdc13ac3"><p class="cl-fdc117ae"><span class="cl-fdbd6961">48 (44.9)</span></p></td><td class="cl-fdc13ac3"><p class="cl-fdc117ae"><span class="cl-fdbd6961">18 (50)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-fdc13acc"><p class="cl-fdc117ae"><span class="cl-fdbd6960"></span></p></td><td class="cl-fdc13acd"><p class="cl-fdc117ae"><span class="cl-fdbd6961">Partnered</span></p></td><td class="cl-fdc13acc"><p class="cl-fdc117ae"><span class="cl-fdbd6961">289 (50.3)</span></p></td><td class="cl-fdc13acc"><p class="cl-fdc117ae"><span class="cl-fdbd6961">59 (55.1)</span></p></td><td class="cl-fdc13acc"><p class="cl-fdc117ae"><span class="cl-fdbd6961">18 (50)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-fdc13ac3"><p class="cl-fdc117ae"><span class="cl-fdbd6960"></span></p></td><td class="cl-fdc13ac4"><p class="cl-fdc117ae"><span class="cl-fdbd6961">Unknown</span></p></td><td class="cl-fdc13ac3"><p class="cl-fdc117ae"><span class="cl-fdbd6961">380</span></p></td><td class="cl-fdc13ac3"><p class="cl-fdc117ae"><span class="cl-fdbd6961">365</span></p></td><td class="cl-fdc13ac3"><p class="cl-fdc117ae"><span class="cl-fdbd6961">90</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-fdc13acc"><p class="cl-fdc117ae"><span class="cl-fdbd6960">Year group</span></p></td><td class="cl-fdc13acd"><p class="cl-fdc117ae"><span class="cl-fdbd6961">‚â§2020</span></p></td><td class="cl-fdc13acc"><p class="cl-fdc117ae"><span class="cl-fdbd6961">483 (50.6)</span></p></td><td class="cl-fdc13acc"><p class="cl-fdc117ae"><span class="cl-fdbd6961">311 (65.9)</span></p></td><td class="cl-fdc13acc"><p class="cl-fdc117ae"><span class="cl-fdbd6961">84 (66.7)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-fdc13ac3"><p class="cl-fdc117ae"><span class="cl-fdbd6960"></span></p></td><td class="cl-fdc13ac4"><p class="cl-fdc117ae"><span class="cl-fdbd6961">2021-2022</span></p></td><td class="cl-fdc13ac3"><p class="cl-fdc117ae"><span class="cl-fdbd6961">311 (32.6)</span></p></td><td class="cl-fdc13ac3"><p class="cl-fdc117ae"><span class="cl-fdbd6961">59 (12.5)</span></p></td><td class="cl-fdc13ac3"><p class="cl-fdc117ae"><span class="cl-fdbd6961">13 (10.3)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-fdc13acc"><p class="cl-fdc117ae"><span class="cl-fdbd6960"></span></p></td><td class="cl-fdc13acd"><p class="cl-fdc117ae"><span class="cl-fdbd6961">2023+</span></p></td><td class="cl-fdc13acc"><p class="cl-fdc117ae"><span class="cl-fdbd6961">161 (16.9)</span></p></td><td class="cl-fdc13acc"><p class="cl-fdc117ae"><span class="cl-fdbd6961">102 (21.6)</span></p></td><td class="cl-fdc13acc"><p class="cl-fdc117ae"><span class="cl-fdbd6961">29 (23)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-fdc13ac3"><p class="cl-fdc117ae"><span class="cl-fdbd6960">Quarter</span></p></td><td class="cl-fdc13ac4"><p class="cl-fdc117ae"><span class="cl-fdbd6961">1</span></p></td><td class="cl-fdc13ac3"><p class="cl-fdc117ae"><span class="cl-fdbd6961">253 (26.5)</span></p></td><td class="cl-fdc13ac3"><p class="cl-fdc117ae"><span class="cl-fdbd6961">120 (25.4)</span></p></td><td class="cl-fdc13ac3"><p class="cl-fdc117ae"><span class="cl-fdbd6961">30 (23.8)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-fdc13acc"><p class="cl-fdc117ae"><span class="cl-fdbd6960"></span></p></td><td class="cl-fdc13acd"><p class="cl-fdc117ae"><span class="cl-fdbd6961">2</span></p></td><td class="cl-fdc13acc"><p class="cl-fdc117ae"><span class="cl-fdbd6961">220 (23)</span></p></td><td class="cl-fdc13acc"><p class="cl-fdc117ae"><span class="cl-fdbd6961">117 (24.8)</span></p></td><td class="cl-fdc13acc"><p class="cl-fdc117ae"><span class="cl-fdbd6961">39 (31)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-fdc13ac3"><p class="cl-fdc117ae"><span class="cl-fdbd6960"></span></p></td><td class="cl-fdc13ac4"><p class="cl-fdc117ae"><span class="cl-fdbd6961">3</span></p></td><td class="cl-fdc13ac3"><p class="cl-fdc117ae"><span class="cl-fdbd6961">295 (30.9)</span></p></td><td class="cl-fdc13ac3"><p class="cl-fdc117ae"><span class="cl-fdbd6961">139 (29.4)</span></p></td><td class="cl-fdc13ac3"><p class="cl-fdc117ae"><span class="cl-fdbd6961">33 (26.2)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-fdc13acc"><p class="cl-fdc117ae"><span class="cl-fdbd6960"></span></p></td><td class="cl-fdc13acd"><p class="cl-fdc117ae"><span class="cl-fdbd6961">4</span></p></td><td class="cl-fdc13acc"><p class="cl-fdc117ae"><span class="cl-fdbd6961">187 (19.6)</span></p></td><td class="cl-fdc13acc"><p class="cl-fdc117ae"><span class="cl-fdbd6961">96 (20.3)</span></p></td><td class="cl-fdc13acc"><p class="cl-fdc117ae"><span class="cl-fdbd6961">24 (19)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-fdc13ac3"><p class="cl-fdc117ae"><span class="cl-fdbd6960">Race group</span></p></td><td class="cl-fdc13ac4"><p class="cl-fdc117ae"><span class="cl-fdbd6961">Asian</span></p></td><td class="cl-fdc13ac3"><p class="cl-fdc117ae"><span class="cl-fdbd6961">69 (7.8)</span></p></td><td class="cl-fdc13ac3"><p class="cl-fdc117ae"><span class="cl-fdbd6961">33 (7.3)</span></p></td><td class="cl-fdc13ac3"><p class="cl-fdc117ae"><span class="cl-fdbd6961">9 (7.3)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-fdc13acc"><p class="cl-fdc117ae"><span class="cl-fdbd6960"></span></p></td><td class="cl-fdc13acd"><p class="cl-fdc117ae"><span class="cl-fdbd6961">Other·∂ú</span></p></td><td class="cl-fdc13acc"><p class="cl-fdc117ae"><span class="cl-fdbd6961">28 (3.2)</span></p></td><td class="cl-fdc13acc"><p class="cl-fdc117ae"><span class="cl-fdbd6961">13 (2.9)</span></p></td><td class="cl-fdc13acc"><p class="cl-fdc117ae"><span class="cl-fdbd6961">1 (0.8)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-fdc13ac3"><p class="cl-fdc117ae"><span class="cl-fdbd6960"></span></p></td><td class="cl-fdc13ac4"><p class="cl-fdc117ae"><span class="cl-fdbd6961">White</span></p></td><td class="cl-fdc13ac3"><p class="cl-fdc117ae"><span class="cl-fdbd6961">788 (89)</span></p></td><td class="cl-fdc13ac3"><p class="cl-fdc117ae"><span class="cl-fdbd6961">404 (89.8)</span></p></td><td class="cl-fdc13ac3"><p class="cl-fdc117ae"><span class="cl-fdbd6961">114 (91.9)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-fdc13ad6"><p class="cl-fdc117ae"><span class="cl-fdbd6960"></span></p></td><td class="cl-fdc13ad7"><p class="cl-fdc117ae"><span class="cl-fdbd6961">Unknown</span></p></td><td class="cl-fdc13ad6"><p class="cl-fdc117ae"><span class="cl-fdbd6961">70</span></p></td><td class="cl-fdc13ad6"><p class="cl-fdc117ae"><span class="cl-fdbd6961">22</span></p></td><td class="cl-fdc13ad6"><p class="cl-fdc117ae"><span class="cl-fdbd6961">2</span></p></td></tr></tbody><tfoot><tr style="overflow-wrap:break-word;"><td colspan="5" class="cl-fdc13ad8"><p class="cl-fdc117b8"><span class="cl-fdbd696a">·µÉ Vaccination proportions were calculated using column percentages for all variables.</span></p></td></tr><tr style="overflow-wrap:break-word;"><td colspan="5" class="cl-fdc13ad8"><p class="cl-fdc117b8"><span class="cl-fdbd696a">·µá Marital status was grouped into two: partnered (married) and not-partnered (divorced, widowed, single).</span></p></td></tr><tr style="overflow-wrap:break-word;"><td colspan="5" class="cl-fdc13ad8"><p class="cl-fdc117b8"><span class="cl-fdbd696a">·∂ú Other race refers to those identifying as native or other racial groups.</span></p></td></tr></tfoot></table></div>
</div>
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="co"># --- Clean up temporary variables (optional good practice) ---</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(</span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>  tab_gender, tab_age, tab_marital, tab_year, tab_quarter, tab_race,</span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>  tab_combined, create_tab, totals, total_resp, total_child, total_other</span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="columnwise-tables-with-na-values" class="level2" data-number="1.11">
<h2 data-number="1.11" class="anchored" data-anchor-id="columnwise-tables-with-na-values"><span class="header-section-number">1.11</span> <strong>11. Columnwise Tables with NA values</strong></h2>
<p>Columnwise percentage table including NA where applicable - All variables use column percentages (i.e., % down each vaccine group column) - NA values are shown only where relevant (e.g., race group for Respiratory vaccines) - ‚ÄúUnknown‚Äù variable categories are excluded from percentage calculations to maintain ~100% totals per column - Useful for subgroup summaries where not all variables apply across all vaccine type</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ------------ 11. Columnwise Tables with NA values-------------------------------------------</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Prepare Vaccination Uptake Table (All Variables Using Column Percentages)</span></span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a><span class="co"># ....................................................................................................</span></span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a><span class="co"># --- Set working directory and load data (if needed) ---</span></span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a><span class="co"># setwd("C:/Users/User/Desktop/Materials_ Course and proposals/Course Related/DataCamp/Data/")</span></span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true" tabindex="-1"></a><span class="co"># load("Vaccination_uptake.RDATA")</span></span>
<span id="cb31-9"><a href="#cb31-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-10"><a href="#cb31-10" aria-hidden="true" tabindex="-1"></a><span class="co"># --- Clean and prepare datasets ---</span></span>
<span id="cb31-11"><a href="#cb31-11" aria-hidden="true" tabindex="-1"></a>vacc_1524 <span class="ot">&lt;-</span> vacc_1524 <span class="sc">%&gt;%</span></span>
<span id="cb31-12"><a href="#cb31-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">c</span>(gender, age_3group, marital_2group, year_3group, vacc_quarter, race_grouped), as.character))</span>
<span id="cb31-13"><a href="#cb31-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-14"><a href="#cb31-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Subset data for Respiratory vaccines to calculate column-based percentages (used for race)</span></span>
<span id="cb31-15"><a href="#cb31-15" aria-hidden="true" tabindex="-1"></a>respiratory_vaccines <span class="ot">&lt;-</span> vacc_1524 <span class="sc">%&gt;%</span></span>
<span id="cb31-16"><a href="#cb31-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(vacc_group3 <span class="sc">==</span> <span class="st">"Respiratory vaccines"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb31-17"><a href="#cb31-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(race_grouped, as.character))</span>
<span id="cb31-18"><a href="#cb31-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-19"><a href="#cb31-19" aria-hidden="true" tabindex="-1"></a><span class="co"># --- General table builder ---</span></span>
<span id="cb31-20"><a href="#cb31-20" aria-hidden="true" tabindex="-1"></a>create_tab <span class="ot">&lt;-</span> <span class="cf">function</span>(data, var, label, <span class="at">use_col_percentage =</span> <span class="cn">TRUE</span>) {</span>
<span id="cb31-21"><a href="#cb31-21" aria-hidden="true" tabindex="-1"></a>  tab_main <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span></span>
<span id="cb31-22"><a href="#cb31-22" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>({{ var }})) <span class="sc">%&gt;%</span></span>
<span id="cb31-23"><a href="#cb31-23" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tabyl</span>({{ var }}, vacc_group3) <span class="sc">%&gt;%</span></span>
<span id="cb31-24"><a href="#cb31-24" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">Category =</span> label, <span class="at">.before =</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb31-25"><a href="#cb31-25" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rename</span>(<span class="at">Label =</span> {{ var }}) <span class="sc">%&gt;%</span></span>
<span id="cb31-26"><a href="#cb31-26" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">Label =</span> <span class="fu">as.character</span>(Label))</span>
<span id="cb31-27"><a href="#cb31-27" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb31-28"><a href="#cb31-28" aria-hidden="true" tabindex="-1"></a>  na_count <span class="ot">&lt;-</span> <span class="fu">sum</span>(<span class="fu">is.na</span>(<span class="fu">pull</span>(data, {{ var }})))</span>
<span id="cb31-29"><a href="#cb31-29" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (na_count <span class="sc">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb31-30"><a href="#cb31-30" aria-hidden="true" tabindex="-1"></a>    na_row <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb31-31"><a href="#cb31-31" aria-hidden="true" tabindex="-1"></a>      <span class="at">Category =</span> label,</span>
<span id="cb31-32"><a href="#cb31-32" aria-hidden="true" tabindex="-1"></a>      <span class="at">Label =</span> <span class="st">"Unknown"</span>,</span>
<span id="cb31-33"><a href="#cb31-33" aria-hidden="true" tabindex="-1"></a>      <span class="st">`</span><span class="at">Respiratory vaccines</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">sum</span>(data<span class="sc">$</span>vacc_group3 <span class="sc">==</span> <span class="st">"Respiratory vaccines"</span> <span class="sc">&amp;</span> <span class="fu">is.na</span>(<span class="fu">pull</span>(data, {{ var }})), <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb31-34"><a href="#cb31-34" aria-hidden="true" tabindex="-1"></a>      <span class="st">`</span><span class="at">Childhood vaccines</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">sum</span>(data<span class="sc">$</span>vacc_group3 <span class="sc">==</span> <span class="st">"Childhood vaccines"</span> <span class="sc">&amp;</span> <span class="fu">is.na</span>(<span class="fu">pull</span>(data, {{ var }})), <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb31-35"><a href="#cb31-35" aria-hidden="true" tabindex="-1"></a>      <span class="at">Other =</span> <span class="fu">sum</span>(data<span class="sc">$</span>vacc_group3 <span class="sc">==</span> <span class="st">"Other"</span> <span class="sc">&amp;</span> <span class="fu">is.na</span>(<span class="fu">pull</span>(data, {{ var }})), <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb31-36"><a href="#cb31-36" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb31-37"><a href="#cb31-37" aria-hidden="true" tabindex="-1"></a>    tab_combined <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(tab_main, na_row)</span>
<span id="cb31-38"><a href="#cb31-38" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb31-39"><a href="#cb31-39" aria-hidden="true" tabindex="-1"></a>    tab_combined <span class="ot">&lt;-</span> tab_main</span>
<span id="cb31-40"><a href="#cb31-40" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb31-41"><a href="#cb31-41" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb31-42"><a href="#cb31-42" aria-hidden="true" tabindex="-1"></a>  tab_combined <span class="sc">%&gt;%</span></span>
<span id="cb31-43"><a href="#cb31-43" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">use_col_percentage =</span> use_col_percentage)</span>
<span id="cb31-44"><a href="#cb31-44" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb31-45"><a href="#cb31-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-46"><a href="#cb31-46" aria-hidden="true" tabindex="-1"></a><span class="co"># --- Create summary tables ---</span></span>
<span id="cb31-47"><a href="#cb31-47" aria-hidden="true" tabindex="-1"></a>tab_gender    <span class="ot">&lt;-</span> <span class="fu">create_tab</span>(vacc_1524, gender, <span class="st">"Gender"</span>)</span>
<span id="cb31-48"><a href="#cb31-48" aria-hidden="true" tabindex="-1"></a>tab_age       <span class="ot">&lt;-</span> <span class="fu">create_tab</span>(vacc_1524, age_3group, <span class="st">"Age group"</span>)</span>
<span id="cb31-49"><a href="#cb31-49" aria-hidden="true" tabindex="-1"></a>tab_marital   <span class="ot">&lt;-</span> <span class="fu">create_tab</span>(vacc_1524, marital_2group, <span class="st">"Marital status·µá"</span>)</span>
<span id="cb31-50"><a href="#cb31-50" aria-hidden="true" tabindex="-1"></a>tab_year      <span class="ot">&lt;-</span> <span class="fu">create_tab</span>(vacc_1524, year_3group, <span class="st">"Year group"</span>)</span>
<span id="cb31-51"><a href="#cb31-51" aria-hidden="true" tabindex="-1"></a>tab_quarter   <span class="ot">&lt;-</span> <span class="fu">create_tab</span>(vacc_1524, vacc_quarter, <span class="st">"Quarter"</span>)</span>
<span id="cb31-52"><a href="#cb31-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-53"><a href="#cb31-53" aria-hidden="true" tabindex="-1"></a><span class="co"># Race group from respiratory-only subset (denominator = respiratory group only)</span></span>
<span id="cb31-54"><a href="#cb31-54" aria-hidden="true" tabindex="-1"></a>tab_race      <span class="ot">&lt;-</span> <span class="fu">create_tab</span>(respiratory_vaccines, race_grouped, <span class="st">"Race group"</span>)</span>
<span id="cb31-55"><a href="#cb31-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-56"><a href="#cb31-56" aria-hidden="true" tabindex="-1"></a><span class="co"># --- Combine all tables ---</span></span>
<span id="cb31-57"><a href="#cb31-57" aria-hidden="true" tabindex="-1"></a>tab_combined <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(</span>
<span id="cb31-58"><a href="#cb31-58" aria-hidden="true" tabindex="-1"></a>  tab_gender, tab_age, tab_marital,</span>
<span id="cb31-59"><a href="#cb31-59" aria-hidden="true" tabindex="-1"></a>  tab_year, tab_quarter, tab_race</span>
<span id="cb31-60"><a href="#cb31-60" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb31-61"><a href="#cb31-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-62"><a href="#cb31-62" aria-hidden="true" tabindex="-1"></a><span class="co"># --- Calculate and format column percentages ---</span></span>
<span id="cb31-63"><a href="#cb31-63" aria-hidden="true" tabindex="-1"></a>tab_combined <span class="ot">&lt;-</span> tab_combined <span class="sc">%&gt;%</span></span>
<span id="cb31-64"><a href="#cb31-64" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Category) <span class="sc">%&gt;%</span></span>
<span id="cb31-65"><a href="#cb31-65" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb31-66"><a href="#cb31-66" aria-hidden="true" tabindex="-1"></a>    <span class="at">use_col =</span> <span class="cn">TRUE</span>,</span>
<span id="cb31-67"><a href="#cb31-67" aria-hidden="true" tabindex="-1"></a>    <span class="at">Total_Resp =</span> <span class="fu">sum</span>(<span class="st">`</span><span class="at">Respiratory vaccines</span><span class="st">`</span>[Label <span class="sc">!=</span> <span class="st">"Unknown"</span>], <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb31-68"><a href="#cb31-68" aria-hidden="true" tabindex="-1"></a>    <span class="at">Total_Child =</span> <span class="fu">sum</span>(<span class="st">`</span><span class="at">Childhood vaccines</span><span class="st">`</span>[Label <span class="sc">!=</span> <span class="st">"Unknown"</span>], <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb31-69"><a href="#cb31-69" aria-hidden="true" tabindex="-1"></a>    <span class="at">Total_Other =</span> <span class="fu">sum</span>(Other[Label <span class="sc">!=</span> <span class="st">"Unknown"</span>], <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb31-70"><a href="#cb31-70" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb31-71"><a href="#cb31-71" aria-hidden="true" tabindex="-1"></a>    <span class="at">Resp_prop =</span> <span class="fu">ifelse</span>(Label <span class="sc">!=</span> <span class="st">"Unknown"</span>, <span class="fu">round</span>(<span class="dv">100</span> <span class="sc">*</span> <span class="st">`</span><span class="at">Respiratory vaccines</span><span class="st">`</span> <span class="sc">/</span> Total_Resp, <span class="dv">1</span>), <span class="cn">NA</span>),</span>
<span id="cb31-72"><a href="#cb31-72" aria-hidden="true" tabindex="-1"></a>    <span class="at">Child_prop =</span> <span class="fu">ifelse</span>(Label <span class="sc">!=</span> <span class="st">"Unknown"</span>, <span class="fu">round</span>(<span class="dv">100</span> <span class="sc">*</span> <span class="st">`</span><span class="at">Childhood vaccines</span><span class="st">`</span> <span class="sc">/</span> Total_Child, <span class="dv">1</span>), <span class="cn">NA</span>),</span>
<span id="cb31-73"><a href="#cb31-73" aria-hidden="true" tabindex="-1"></a>    <span class="at">Other_prop =</span> <span class="fu">ifelse</span>(Label <span class="sc">!=</span> <span class="st">"Unknown"</span>, <span class="fu">round</span>(<span class="dv">100</span> <span class="sc">*</span> Other <span class="sc">/</span> Total_Other, <span class="dv">1</span>), <span class="cn">NA</span>),</span>
<span id="cb31-74"><a href="#cb31-74" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb31-75"><a href="#cb31-75" aria-hidden="true" tabindex="-1"></a>    <span class="at">Respiratory =</span> <span class="fu">ifelse</span>(<span class="fu">is.na</span>(Resp_prop),</span>
<span id="cb31-76"><a href="#cb31-76" aria-hidden="true" tabindex="-1"></a>                         <span class="fu">paste0</span>(<span class="fu">comma</span>(<span class="st">`</span><span class="at">Respiratory vaccines</span><span class="st">`</span>)),</span>
<span id="cb31-77"><a href="#cb31-77" aria-hidden="true" tabindex="-1"></a>                         <span class="fu">paste0</span>(<span class="fu">comma</span>(<span class="st">`</span><span class="at">Respiratory vaccines</span><span class="st">`</span>), <span class="st">" ("</span>, Resp_prop, <span class="st">")"</span>)),</span>
<span id="cb31-78"><a href="#cb31-78" aria-hidden="true" tabindex="-1"></a>    <span class="at">Childhood =</span> <span class="fu">ifelse</span>(<span class="fu">is.na</span>(Child_prop),</span>
<span id="cb31-79"><a href="#cb31-79" aria-hidden="true" tabindex="-1"></a>                       <span class="fu">paste0</span>(<span class="fu">comma</span>(<span class="st">`</span><span class="at">Childhood vaccines</span><span class="st">`</span>)),</span>
<span id="cb31-80"><a href="#cb31-80" aria-hidden="true" tabindex="-1"></a>                       <span class="fu">paste0</span>(<span class="fu">comma</span>(<span class="st">`</span><span class="at">Childhood vaccines</span><span class="st">`</span>), <span class="st">" ("</span>, Child_prop, <span class="st">")"</span>)),</span>
<span id="cb31-81"><a href="#cb31-81" aria-hidden="true" tabindex="-1"></a>    <span class="at">Other_grp =</span> <span class="fu">ifelse</span>(<span class="fu">is.na</span>(Other_prop),</span>
<span id="cb31-82"><a href="#cb31-82" aria-hidden="true" tabindex="-1"></a>                       <span class="fu">paste0</span>(<span class="fu">comma</span>(Other)),</span>
<span id="cb31-83"><a href="#cb31-83" aria-hidden="true" tabindex="-1"></a>                       <span class="fu">paste0</span>(<span class="fu">comma</span>(Other), <span class="st">" ("</span>, Other_prop, <span class="st">")"</span>))</span>
<span id="cb31-84"><a href="#cb31-84" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb31-85"><a href="#cb31-85" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb31-86"><a href="#cb31-86" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-87"><a href="#cb31-87" aria-hidden="true" tabindex="-1"></a><span class="co"># --- Format labels and rows ---</span></span>
<span id="cb31-88"><a href="#cb31-88" aria-hidden="true" tabindex="-1"></a>tab_combined <span class="ot">&lt;-</span> tab_combined <span class="sc">%&gt;%</span></span>
<span id="cb31-89"><a href="#cb31-89" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb31-90"><a href="#cb31-90" aria-hidden="true" tabindex="-1"></a>    <span class="at">Label =</span> <span class="fu">ifelse</span>(Label <span class="sc">==</span> <span class="st">"Other"</span>, <span class="st">"Other·∂ú"</span>, Label),</span>
<span id="cb31-91"><a href="#cb31-91" aria-hidden="true" tabindex="-1"></a>    <span class="at">Respiratory =</span> <span class="fu">ifelse</span>(Label <span class="sc">==</span> <span class="st">"Unknown"</span> <span class="sc">&amp;</span> <span class="st">`</span><span class="at">Respiratory vaccines</span><span class="st">`</span> <span class="sc">==</span> <span class="dv">0</span>, <span class="st">""</span>, Respiratory),</span>
<span id="cb31-92"><a href="#cb31-92" aria-hidden="true" tabindex="-1"></a>    <span class="at">Childhood   =</span> <span class="fu">ifelse</span>(Label <span class="sc">==</span> <span class="st">"Unknown"</span> <span class="sc">&amp;</span> <span class="st">`</span><span class="at">Childhood vaccines</span><span class="st">`</span> <span class="sc">==</span> <span class="dv">0</span>, <span class="st">""</span>, Childhood),</span>
<span id="cb31-93"><a href="#cb31-93" aria-hidden="true" tabindex="-1"></a>    <span class="at">Other_grp   =</span> <span class="fu">ifelse</span>(Label <span class="sc">==</span> <span class="st">"Unknown"</span> <span class="sc">&amp;</span> Other <span class="sc">==</span> <span class="dv">0</span>, <span class="st">""</span>, Other_grp)</span>
<span id="cb31-94"><a href="#cb31-94" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb31-95"><a href="#cb31-95" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Category) <span class="sc">%&gt;%</span></span>
<span id="cb31-96"><a href="#cb31-96" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Category =</span> <span class="fu">ifelse</span>(<span class="fu">row_number</span>() <span class="sc">==</span> <span class="dv">1</span>, Category, <span class="st">""</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb31-97"><a href="#cb31-97" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb31-98"><a href="#cb31-98" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Category, Label, Respiratory, Childhood, Other_grp)</span>
<span id="cb31-99"><a href="#cb31-99" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-100"><a href="#cb31-100" aria-hidden="true" tabindex="-1"></a><span class="co"># --- Prepare column Ns for header ---</span></span>
<span id="cb31-101"><a href="#cb31-101" aria-hidden="true" tabindex="-1"></a>totals <span class="ot">&lt;-</span> <span class="fu">table</span>(vacc_1524<span class="sc">$</span>vacc_group3)</span>
<span id="cb31-102"><a href="#cb31-102" aria-hidden="true" tabindex="-1"></a>total_resp <span class="ot">&lt;-</span> totals[<span class="st">"Respiratory vaccines"</span>]</span>
<span id="cb31-103"><a href="#cb31-103" aria-hidden="true" tabindex="-1"></a>total_child <span class="ot">&lt;-</span> totals[<span class="st">"Childhood vaccines"</span>]</span>
<span id="cb31-104"><a href="#cb31-104" aria-hidden="true" tabindex="-1"></a>total_other <span class="ot">&lt;-</span> totals[<span class="st">"Other"</span>]</span>
<span id="cb31-105"><a href="#cb31-105" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-106"><a href="#cb31-106" aria-hidden="true" tabindex="-1"></a><span class="co"># --- Build Flextable ---</span></span>
<span id="cb31-107"><a href="#cb31-107" aria-hidden="true" tabindex="-1"></a>table_vacc_summary <span class="ot">&lt;-</span> <span class="fu">flextable</span>(tab_combined) <span class="sc">%&gt;%</span></span>
<span id="cb31-108"><a href="#cb31-108" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_header_labels</span>(</span>
<span id="cb31-109"><a href="#cb31-109" aria-hidden="true" tabindex="-1"></a>    <span class="at">Category =</span> <span class="st">"Variable type"</span>,</span>
<span id="cb31-110"><a href="#cb31-110" aria-hidden="true" tabindex="-1"></a>    <span class="at">Label =</span> <span class="st">"Values"</span>,</span>
<span id="cb31-111"><a href="#cb31-111" aria-hidden="true" tabindex="-1"></a>    <span class="at">Respiratory =</span> <span class="st">"Number (%)·µÉ"</span>,</span>
<span id="cb31-112"><a href="#cb31-112" aria-hidden="true" tabindex="-1"></a>    <span class="at">Childhood =</span> <span class="st">"Number (%)·µÉ"</span>,</span>
<span id="cb31-113"><a href="#cb31-113" aria-hidden="true" tabindex="-1"></a>    <span class="at">Other_grp =</span> <span class="st">"Number (%)·µÉ"</span></span>
<span id="cb31-114"><a href="#cb31-114" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb31-115"><a href="#cb31-115" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_header_row</span>(</span>
<span id="cb31-116"><a href="#cb31-116" aria-hidden="true" tabindex="-1"></a>    <span class="at">values =</span> <span class="fu">c</span>(<span class="st">""</span>, <span class="st">""</span>,</span>
<span id="cb31-117"><a href="#cb31-117" aria-hidden="true" tabindex="-1"></a>               <span class="fu">paste0</span>(<span class="st">"Respiratory vaccines (N = "</span>, <span class="fu">format</span>(total_resp, <span class="at">big.mark =</span> <span class="st">","</span>), <span class="st">")"</span>),</span>
<span id="cb31-118"><a href="#cb31-118" aria-hidden="true" tabindex="-1"></a>               <span class="fu">paste0</span>(<span class="st">"Childhood vaccines (N = "</span>, <span class="fu">format</span>(total_child, <span class="at">big.mark =</span> <span class="st">","</span>), <span class="st">")"</span>),</span>
<span id="cb31-119"><a href="#cb31-119" aria-hidden="true" tabindex="-1"></a>               <span class="fu">paste0</span>(<span class="st">"Other (N = "</span>, <span class="fu">format</span>(total_other, <span class="at">big.mark =</span> <span class="st">","</span>), <span class="st">")"</span>)),</span>
<span id="cb31-120"><a href="#cb31-120" aria-hidden="true" tabindex="-1"></a>    <span class="at">colwidths =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>),</span>
<span id="cb31-121"><a href="#cb31-121" aria-hidden="true" tabindex="-1"></a>    <span class="at">top =</span> <span class="cn">TRUE</span></span>
<span id="cb31-122"><a href="#cb31-122" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb31-123"><a href="#cb31-123" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_header_row</span>(</span>
<span id="cb31-124"><a href="#cb31-124" aria-hidden="true" tabindex="-1"></a>    <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"Description"</span>, <span class="st">"Vaccination uptake"</span>),</span>
<span id="cb31-125"><a href="#cb31-125" aria-hidden="true" tabindex="-1"></a>    <span class="at">colwidths =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">3</span>),</span>
<span id="cb31-126"><a href="#cb31-126" aria-hidden="true" tabindex="-1"></a>    <span class="at">top =</span> <span class="cn">TRUE</span></span>
<span id="cb31-127"><a href="#cb31-127" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb31-128"><a href="#cb31-128" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_box</span>() <span class="sc">%&gt;%</span></span>
<span id="cb31-129"><a href="#cb31-129" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_table_properties</span>(<span class="at">layout =</span> <span class="st">"autofit"</span>, <span class="at">width =</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb31-130"><a href="#cb31-130" aria-hidden="true" tabindex="-1"></a>  <span class="fu">width</span>(<span class="at">j =</span> <span class="dv">1</span>, <span class="at">width =</span> <span class="fl">1.5</span>) <span class="sc">%&gt;%</span></span>
<span id="cb31-131"><a href="#cb31-131" aria-hidden="true" tabindex="-1"></a>  <span class="fu">width</span>(<span class="at">j =</span> <span class="dv">2</span>, <span class="at">width =</span> <span class="fl">2.5</span>) <span class="sc">%&gt;%</span></span>
<span id="cb31-132"><a href="#cb31-132" aria-hidden="true" tabindex="-1"></a>  <span class="fu">width</span>(<span class="at">j =</span> <span class="dv">3</span><span class="sc">:</span><span class="dv">5</span>, <span class="at">width =</span> <span class="fl">1.5</span>) <span class="sc">%&gt;%</span></span>
<span id="cb31-133"><a href="#cb31-133" aria-hidden="true" tabindex="-1"></a>  <span class="fu">align</span>(<span class="at">align =</span> <span class="st">"justify"</span>, <span class="at">part =</span> <span class="st">"all"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb31-134"><a href="#cb31-134" aria-hidden="true" tabindex="-1"></a>  <span class="fu">border_remove</span>() <span class="sc">%&gt;%</span></span>
<span id="cb31-135"><a href="#cb31-135" aria-hidden="true" tabindex="-1"></a>  <span class="fu">border</span>(<span class="at">part =</span> <span class="st">"header"</span>, <span class="at">i =</span> <span class="dv">1</span>, <span class="at">border.top =</span> <span class="fu">fp_border</span>(<span class="at">color =</span> <span class="st">"black"</span>, <span class="at">width =</span> <span class="dv">1</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb31-136"><a href="#cb31-136" aria-hidden="true" tabindex="-1"></a>  <span class="fu">border</span>(<span class="at">part =</span> <span class="st">"header"</span>, <span class="at">i =</span> <span class="dv">3</span>, <span class="at">border.bottom =</span> <span class="fu">fp_border</span>(<span class="at">color =</span> <span class="st">"black"</span>, <span class="at">width =</span> <span class="dv">1</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb31-137"><a href="#cb31-137" aria-hidden="true" tabindex="-1"></a>  <span class="fu">border_inner_h</span>(<span class="at">part =</span> <span class="st">"header"</span>, <span class="at">border =</span> <span class="fu">fp_border</span>(<span class="at">color =</span> <span class="st">"black"</span>, <span class="at">width =</span> <span class="fl">0.8</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb31-138"><a href="#cb31-138" aria-hidden="true" tabindex="-1"></a>  <span class="fu">border_inner_h</span>(<span class="at">part =</span> <span class="st">"body"</span>, <span class="at">border =</span> <span class="fu">fp_border</span>(<span class="at">color =</span> <span class="st">"black"</span>, <span class="at">width =</span> <span class="fl">0.8</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb31-139"><a href="#cb31-139" aria-hidden="true" tabindex="-1"></a>  <span class="fu">border</span>(<span class="at">part =</span> <span class="st">"body"</span>, <span class="at">i =</span> <span class="fu">nrow</span>(tab_combined), <span class="at">border.bottom =</span> <span class="fu">fp_border</span>(<span class="at">color =</span> <span class="st">"black"</span>, <span class="at">width =</span> <span class="dv">1</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb31-140"><a href="#cb31-140" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_caption</span>(<span class="fu">as_paragraph</span>(<span class="fu">as_chunk</span>(</span>
<span id="cb31-141"><a href="#cb31-141" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Table xx: Column-percentage summary of vaccination uptake across all demographic variables, 2015‚Äì2024."</span>,</span>
<span id="cb31-142"><a href="#cb31-142" aria-hidden="true" tabindex="-1"></a>    <span class="at">props =</span> <span class="fu">fp_text</span>(<span class="at">font.size =</span> <span class="dv">12</span>, <span class="at">font.family =</span> <span class="st">"Times New Roman"</span>, <span class="at">bold =</span> <span class="cn">FALSE</span>)</span>
<span id="cb31-143"><a href="#cb31-143" aria-hidden="true" tabindex="-1"></a>  ))) <span class="sc">%&gt;%</span></span>
<span id="cb31-144"><a href="#cb31-144" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_footer_lines</span>(<span class="at">values =</span> <span class="fu">c</span>(</span>
<span id="cb31-145"><a href="#cb31-145" aria-hidden="true" tabindex="-1"></a>    <span class="st">"·µÉ Vaccination proportions were calculated using column percentages. Race group used respiratory vaccine subset only."</span>,</span>
<span id="cb31-146"><a href="#cb31-146" aria-hidden="true" tabindex="-1"></a>    <span class="st">"·µá Marital status was grouped into partnered (married) and non-partnered (single, divorced, widowed)."</span>,</span>
<span id="cb31-147"><a href="#cb31-147" aria-hidden="true" tabindex="-1"></a>    <span class="st">"·∂ú 'Other' race includes native or other less represented racial identities."</span></span>
<span id="cb31-148"><a href="#cb31-148" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">%&gt;%</span></span>
<span id="cb31-149"><a href="#cb31-149" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fontsize</span>(<span class="at">part =</span> <span class="st">"header"</span>, <span class="at">size =</span> <span class="dv">12</span>) <span class="sc">%&gt;%</span></span>
<span id="cb31-150"><a href="#cb31-150" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fontsize</span>(<span class="at">part =</span> <span class="st">"body"</span>, <span class="at">size =</span> <span class="dv">11</span>) <span class="sc">%&gt;%</span></span>
<span id="cb31-151"><a href="#cb31-151" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fontsize</span>(<span class="at">part =</span> <span class="st">"footer"</span>, <span class="at">size =</span> <span class="dv">10</span>) <span class="sc">%&gt;%</span></span>
<span id="cb31-152"><a href="#cb31-152" aria-hidden="true" tabindex="-1"></a>  <span class="fu">font</span>(<span class="at">part =</span> <span class="st">"all"</span>, <span class="at">fontname =</span> <span class="st">"Times New Roman"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb31-153"><a href="#cb31-153" aria-hidden="true" tabindex="-1"></a>  <span class="fu">color</span>(<span class="at">part =</span> <span class="st">"header"</span>, <span class="at">color =</span> <span class="st">"white"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb31-154"><a href="#cb31-154" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bg</span>(<span class="at">part =</span> <span class="st">"header"</span>, <span class="at">bg =</span> <span class="st">"#000000"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb31-155"><a href="#cb31-155" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bg</span>(<span class="at">j =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>, <span class="at">i =</span> <span class="fu">seq</span>(<span class="dv">2</span>, <span class="fu">nrow</span>(tab_combined), <span class="dv">2</span>), <span class="at">bg =</span> <span class="st">"white"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb31-156"><a href="#cb31-156" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bold</span>(<span class="at">j =</span> <span class="dv">1</span>, <span class="at">part =</span> <span class="st">"body"</span>)</span>
<span id="cb31-157"><a href="#cb31-157" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-158"><a href="#cb31-158" aria-hidden="true" tabindex="-1"></a><span class="co"># --- Display final table ---</span></span>
<span id="cb31-159"><a href="#cb31-159" aria-hidden="true" tabindex="-1"></a>table_vacc_summary</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="tabwid"><style>.cl-fe192138{table-layout:auto;width:100%;}.cl-fe101e26{font-family:'Times New Roman';font-size:12pt;font-weight:bold;font-style:normal;text-decoration:none;color:rgba(255, 255, 255, 1.00);background-color:transparent;}.cl-fe101e30{font-family:'Times New Roman';font-size:11pt;font-weight:bold;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-fe101e31{font-family:'Times New Roman';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-fe101e3a{font-family:'Times New Roman';font-size:10pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-fe136fe0{margin:0;text-align:justify;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-fe136fea{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-fe139614{background-color:rgba(0, 0, 0, 1.00);vertical-align: middle;border-bottom: 0.8pt solid rgba(0, 0, 0, 1.00);border-top: 1pt solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-fe139615{background-color:rgba(0, 0, 0, 1.00);vertical-align: middle;border-bottom: 0.8pt solid rgba(0, 0, 0, 1.00);border-top: 1pt solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-fe13961e{background-color:rgba(0, 0, 0, 1.00);vertical-align: middle;border-bottom: 0.8pt solid rgba(0, 0, 0, 1.00);border-top: 0.8pt solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-fe13961f{background-color:rgba(0, 0, 0, 1.00);vertical-align: middle;border-bottom: 0.8pt solid rgba(0, 0, 0, 1.00);border-top: 0.8pt solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-fe139620{background-color:rgba(0, 0, 0, 1.00);vertical-align: middle;border-bottom: 1pt solid rgba(0, 0, 0, 1.00);border-top: 0.8pt solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-fe139628{background-color:rgba(0, 0, 0, 1.00);vertical-align: middle;border-bottom: 1pt solid rgba(0, 0, 0, 1.00);border-top: 0.8pt solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-fe139629{background-color:transparent;vertical-align: middle;border-bottom: 0.8pt solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-fe13962a{background-color:transparent;vertical-align: middle;border-bottom: 0.8pt solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-fe13962b{background-color:rgba(255, 255, 255, 1.00);vertical-align: middle;border-bottom: 0.8pt solid rgba(0, 0, 0, 1.00);border-top: 0.8pt solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-fe139632{background-color:rgba(255, 255, 255, 1.00);vertical-align: middle;border-bottom: 0.8pt solid rgba(0, 0, 0, 1.00);border-top: 0.8pt solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-fe139633{background-color:transparent;vertical-align: middle;border-bottom: 0.8pt solid rgba(0, 0, 0, 1.00);border-top: 0.8pt solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-fe13963c{background-color:transparent;vertical-align: middle;border-bottom: 0.8pt solid rgba(0, 0, 0, 1.00);border-top: 0.8pt solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-fe13963d{background-color:transparent;vertical-align: middle;border-bottom: 1pt solid rgba(0, 0, 0, 1.00);border-top: 0.8pt solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-fe13963e{background-color:transparent;vertical-align: middle;border-bottom: 1pt solid rgba(0, 0, 0, 1.00);border-top: 0.8pt solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-fe13963f{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(255, 255, 255, 0.00);border-top: 0 solid rgba(255, 255, 255, 0.00);border-left: 0 solid rgba(255, 255, 255, 0.00);border-right: 0 solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-fe139646{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(255, 255, 255, 0.00);border-top: 0 solid rgba(255, 255, 255, 0.00);border-left: 0 solid rgba(255, 255, 255, 0.00);border-right: 0 solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table data-quarto-disable-processing="true" class="cl-fe192138"><thead><tr style="overflow-wrap:break-word;"><th colspan="2" class="cl-fe139614"><p class="cl-fe136fe0"><span class="cl-fe101e26">Description</span></p></th><th colspan="3" class="cl-fe139614"><p class="cl-fe136fe0"><span class="cl-fe101e26">Vaccination uptake</span></p></th></tr><tr style="overflow-wrap:break-word;"><th class="cl-fe13961e"><p class="cl-fe136fe0"><span class="cl-fe101e26"></span></p></th><th class="cl-fe13961f"><p class="cl-fe136fe0"><span class="cl-fe101e26"></span></p></th><th class="cl-fe13961e"><p class="cl-fe136fe0"><span class="cl-fe101e26">Respiratory vaccines (N = 955)</span></p></th><th class="cl-fe13961e"><p class="cl-fe136fe0"><span class="cl-fe101e26">Childhood vaccines (N = 472)</span></p></th><th class="cl-fe13961e"><p class="cl-fe136fe0"><span class="cl-fe101e26">Other (N = 126)</span></p></th></tr><tr style="overflow-wrap:break-word;"><th class="cl-fe139620"><p class="cl-fe136fe0"><span class="cl-fe101e26">Variable type</span></p></th><th class="cl-fe139628"><p class="cl-fe136fe0"><span class="cl-fe101e26">Values</span></p></th><th class="cl-fe139620"><p class="cl-fe136fe0"><span class="cl-fe101e26">Number (%)·µÉ</span></p></th><th class="cl-fe139620"><p class="cl-fe136fe0"><span class="cl-fe101e26">Number (%)·µÉ</span></p></th><th class="cl-fe139620"><p class="cl-fe136fe0"><span class="cl-fe101e26">Number (%)·µÉ</span></p></th></tr></thead><tbody><tr style="overflow-wrap:break-word;"><td class="cl-fe139629"><p class="cl-fe136fe0"><span class="cl-fe101e30">Gender</span></p></td><td class="cl-fe13962a"><p class="cl-fe136fe0"><span class="cl-fe101e31">Female</span></p></td><td class="cl-fe139629"><p class="cl-fe136fe0"><span class="cl-fe101e31">511 (53.5)</span></p></td><td class="cl-fe139629"><p class="cl-fe136fe0"><span class="cl-fe101e31">233 (49.4)</span></p></td><td class="cl-fe139629"><p class="cl-fe136fe0"><span class="cl-fe101e31">54 (42.9)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-fe13962b"><p class="cl-fe136fe0"><span class="cl-fe101e30"></span></p></td><td class="cl-fe139632"><p class="cl-fe136fe0"><span class="cl-fe101e31">Male</span></p></td><td class="cl-fe13962b"><p class="cl-fe136fe0"><span class="cl-fe101e31">444 (46.5)</span></p></td><td class="cl-fe13962b"><p class="cl-fe136fe0"><span class="cl-fe101e31">239 (50.6)</span></p></td><td class="cl-fe13962b"><p class="cl-fe136fe0"><span class="cl-fe101e31">72 (57.1)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-fe139633"><p class="cl-fe136fe0"><span class="cl-fe101e30">Age group</span></p></td><td class="cl-fe13963c"><p class="cl-fe136fe0"><span class="cl-fe101e31">&lt;25</span></p></td><td class="cl-fe139633"><p class="cl-fe136fe0"><span class="cl-fe101e31">332 (34.8)</span></p></td><td class="cl-fe139633"><p class="cl-fe136fe0"><span class="cl-fe101e31">337 (71.4)</span></p></td><td class="cl-fe139633"><p class="cl-fe136fe0"><span class="cl-fe101e31">90 (71.4)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-fe13962b"><p class="cl-fe136fe0"><span class="cl-fe101e30"></span></p></td><td class="cl-fe139632"><p class="cl-fe136fe0"><span class="cl-fe101e31">25-34</span></p></td><td class="cl-fe13962b"><p class="cl-fe136fe0"><span class="cl-fe101e31">98 (10.3)</span></p></td><td class="cl-fe13962b"><p class="cl-fe136fe0"><span class="cl-fe101e31">51 (10.8)</span></p></td><td class="cl-fe13962b"><p class="cl-fe136fe0"><span class="cl-fe101e31">0 (0)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-fe139633"><p class="cl-fe136fe0"><span class="cl-fe101e30"></span></p></td><td class="cl-fe13963c"><p class="cl-fe136fe0"><span class="cl-fe101e31">35+</span></p></td><td class="cl-fe139633"><p class="cl-fe136fe0"><span class="cl-fe101e31">525 (55)</span></p></td><td class="cl-fe139633"><p class="cl-fe136fe0"><span class="cl-fe101e31">84 (17.8)</span></p></td><td class="cl-fe139633"><p class="cl-fe136fe0"><span class="cl-fe101e31">36 (28.6)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-fe13962b"><p class="cl-fe136fe0"><span class="cl-fe101e30">Marital status·µá</span></p></td><td class="cl-fe139632"><p class="cl-fe136fe0"><span class="cl-fe101e31">Not partnered</span></p></td><td class="cl-fe13962b"><p class="cl-fe136fe0"><span class="cl-fe101e31">286 (49.7)</span></p></td><td class="cl-fe13962b"><p class="cl-fe136fe0"><span class="cl-fe101e31">48 (44.9)</span></p></td><td class="cl-fe13962b"><p class="cl-fe136fe0"><span class="cl-fe101e31">18 (50)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-fe139633"><p class="cl-fe136fe0"><span class="cl-fe101e30"></span></p></td><td class="cl-fe13963c"><p class="cl-fe136fe0"><span class="cl-fe101e31">Partnered</span></p></td><td class="cl-fe139633"><p class="cl-fe136fe0"><span class="cl-fe101e31">289 (50.3)</span></p></td><td class="cl-fe139633"><p class="cl-fe136fe0"><span class="cl-fe101e31">59 (55.1)</span></p></td><td class="cl-fe139633"><p class="cl-fe136fe0"><span class="cl-fe101e31">18 (50)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-fe13962b"><p class="cl-fe136fe0"><span class="cl-fe101e30"></span></p></td><td class="cl-fe139632"><p class="cl-fe136fe0"><span class="cl-fe101e31">Unknown</span></p></td><td class="cl-fe13962b"><p class="cl-fe136fe0"><span class="cl-fe101e31">380</span></p></td><td class="cl-fe13962b"><p class="cl-fe136fe0"><span class="cl-fe101e31">365</span></p></td><td class="cl-fe13962b"><p class="cl-fe136fe0"><span class="cl-fe101e31">90</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-fe139633"><p class="cl-fe136fe0"><span class="cl-fe101e30">Year group</span></p></td><td class="cl-fe13963c"><p class="cl-fe136fe0"><span class="cl-fe101e31">‚â§2020</span></p></td><td class="cl-fe139633"><p class="cl-fe136fe0"><span class="cl-fe101e31">483 (50.6)</span></p></td><td class="cl-fe139633"><p class="cl-fe136fe0"><span class="cl-fe101e31">311 (65.9)</span></p></td><td class="cl-fe139633"><p class="cl-fe136fe0"><span class="cl-fe101e31">84 (66.7)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-fe13962b"><p class="cl-fe136fe0"><span class="cl-fe101e30"></span></p></td><td class="cl-fe139632"><p class="cl-fe136fe0"><span class="cl-fe101e31">2021-2022</span></p></td><td class="cl-fe13962b"><p class="cl-fe136fe0"><span class="cl-fe101e31">311 (32.6)</span></p></td><td class="cl-fe13962b"><p class="cl-fe136fe0"><span class="cl-fe101e31">59 (12.5)</span></p></td><td class="cl-fe13962b"><p class="cl-fe136fe0"><span class="cl-fe101e31">13 (10.3)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-fe139633"><p class="cl-fe136fe0"><span class="cl-fe101e30"></span></p></td><td class="cl-fe13963c"><p class="cl-fe136fe0"><span class="cl-fe101e31">2023+</span></p></td><td class="cl-fe139633"><p class="cl-fe136fe0"><span class="cl-fe101e31">161 (16.9)</span></p></td><td class="cl-fe139633"><p class="cl-fe136fe0"><span class="cl-fe101e31">102 (21.6)</span></p></td><td class="cl-fe139633"><p class="cl-fe136fe0"><span class="cl-fe101e31">29 (23)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-fe13962b"><p class="cl-fe136fe0"><span class="cl-fe101e30">Quarter</span></p></td><td class="cl-fe139632"><p class="cl-fe136fe0"><span class="cl-fe101e31">1</span></p></td><td class="cl-fe13962b"><p class="cl-fe136fe0"><span class="cl-fe101e31">253 (26.5)</span></p></td><td class="cl-fe13962b"><p class="cl-fe136fe0"><span class="cl-fe101e31">120 (25.4)</span></p></td><td class="cl-fe13962b"><p class="cl-fe136fe0"><span class="cl-fe101e31">30 (23.8)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-fe139633"><p class="cl-fe136fe0"><span class="cl-fe101e30"></span></p></td><td class="cl-fe13963c"><p class="cl-fe136fe0"><span class="cl-fe101e31">2</span></p></td><td class="cl-fe139633"><p class="cl-fe136fe0"><span class="cl-fe101e31">220 (23)</span></p></td><td class="cl-fe139633"><p class="cl-fe136fe0"><span class="cl-fe101e31">117 (24.8)</span></p></td><td class="cl-fe139633"><p class="cl-fe136fe0"><span class="cl-fe101e31">39 (31)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-fe13962b"><p class="cl-fe136fe0"><span class="cl-fe101e30"></span></p></td><td class="cl-fe139632"><p class="cl-fe136fe0"><span class="cl-fe101e31">3</span></p></td><td class="cl-fe13962b"><p class="cl-fe136fe0"><span class="cl-fe101e31">295 (30.9)</span></p></td><td class="cl-fe13962b"><p class="cl-fe136fe0"><span class="cl-fe101e31">139 (29.4)</span></p></td><td class="cl-fe13962b"><p class="cl-fe136fe0"><span class="cl-fe101e31">33 (26.2)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-fe139633"><p class="cl-fe136fe0"><span class="cl-fe101e30"></span></p></td><td class="cl-fe13963c"><p class="cl-fe136fe0"><span class="cl-fe101e31">4</span></p></td><td class="cl-fe139633"><p class="cl-fe136fe0"><span class="cl-fe101e31">187 (19.6)</span></p></td><td class="cl-fe139633"><p class="cl-fe136fe0"><span class="cl-fe101e31">96 (20.3)</span></p></td><td class="cl-fe139633"><p class="cl-fe136fe0"><span class="cl-fe101e31">24 (19)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-fe13962b"><p class="cl-fe136fe0"><span class="cl-fe101e30">Race group</span></p></td><td class="cl-fe139632"><p class="cl-fe136fe0"><span class="cl-fe101e31">Asian</span></p></td><td class="cl-fe13962b"><p class="cl-fe136fe0"><span class="cl-fe101e31">69 (7.8)</span></p></td><td class="cl-fe13962b"><p class="cl-fe136fe0"><span class="cl-fe101e31">NA</span></p></td><td class="cl-fe13962b"><p class="cl-fe136fe0"><span class="cl-fe101e31">NA</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-fe139633"><p class="cl-fe136fe0"><span class="cl-fe101e30"></span></p></td><td class="cl-fe13963c"><p class="cl-fe136fe0"><span class="cl-fe101e31">Other·∂ú</span></p></td><td class="cl-fe139633"><p class="cl-fe136fe0"><span class="cl-fe101e31">28 (3.2)</span></p></td><td class="cl-fe139633"><p class="cl-fe136fe0"><span class="cl-fe101e31">NA</span></p></td><td class="cl-fe139633"><p class="cl-fe136fe0"><span class="cl-fe101e31">NA</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-fe13962b"><p class="cl-fe136fe0"><span class="cl-fe101e30"></span></p></td><td class="cl-fe139632"><p class="cl-fe136fe0"><span class="cl-fe101e31">White</span></p></td><td class="cl-fe13962b"><p class="cl-fe136fe0"><span class="cl-fe101e31">788 (89)</span></p></td><td class="cl-fe13962b"><p class="cl-fe136fe0"><span class="cl-fe101e31">NA</span></p></td><td class="cl-fe13962b"><p class="cl-fe136fe0"><span class="cl-fe101e31">NA</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-fe13963d"><p class="cl-fe136fe0"><span class="cl-fe101e30"></span></p></td><td class="cl-fe13963e"><p class="cl-fe136fe0"><span class="cl-fe101e31">Unknown</span></p></td><td class="cl-fe13963d"><p class="cl-fe136fe0"><span class="cl-fe101e31">70</span></p></td><td class="cl-fe13963d"><p class="cl-fe136fe0"><span class="cl-fe101e31"></span></p></td><td class="cl-fe13963d"><p class="cl-fe136fe0"><span class="cl-fe101e31"></span></p></td></tr></tbody><tfoot><tr style="overflow-wrap:break-word;"><td colspan="5" class="cl-fe13963f"><p class="cl-fe136fea"><span class="cl-fe101e3a">·µÉ Vaccination proportions were calculated using column percentages. Race group used respiratory vaccine subset only.</span></p></td></tr><tr style="overflow-wrap:break-word;"><td colspan="5" class="cl-fe13963f"><p class="cl-fe136fea"><span class="cl-fe101e3a">·µá Marital status was grouped into partnered (married) and non-partnered (single, divorced, widowed).</span></p></td></tr><tr style="overflow-wrap:break-word;"><td colspan="5" class="cl-fe13963f"><p class="cl-fe136fea"><span class="cl-fe101e3a">·∂ú 'Other' race includes native or other less represented racial identities.</span></p></td></tr></tfoot></table></div>
</div>
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="co"># --- Cleanup temporary objects ---</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(</span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>  tab_gender, tab_age, tab_marital, tab_year, tab_quarter, tab_race,</span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a>  tab_combined, create_tab, totals, total_resp, total_child, total_other,</span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a>  respiratory_vaccines</span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="both-row-wise-and-column-wise-tables" class="level2" data-number="1.12">
<h2 data-number="1.12" class="anchored" data-anchor-id="both-row-wise-and-column-wise-tables"><span class="header-section-number">1.12</span> <strong>12. Both Row wise and Column wise Tables</strong></h2>
<p>This table presents <strong>both row and column percentages</strong> for vaccination uptake:</p>
<ul>
<li>Row percentages show how each category (e.g., age group, gender) distributes across vaccine types.</li>
<li>Column percentages are applied only to the <em>race group</em>, highlighting the demographic makeup within the respiratory vaccine recipients.</li>
</ul>
<p>This format helps answer questions like: - <em>‚ÄúWhat proportion of women in each age group received respiratory vaccines?‚Äù</em> (row %) - <em>‚ÄúWhat proportion of respiratory vaccine recipients were Aboriginal?‚Äù</em> (column %)</p>
<p>Unknown values are included but excluded from percentage calculations to avoid distorting group totals.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ------------12. Both Row wise and Column wise Tables -------------------------------------------</span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a><span class="co"># ....................................................................................................</span></span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Prepare Vaccination Uptake Table (Row and Column Percentages)</span></span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a><span class="co"># ....................................................................................................</span></span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true" tabindex="-1"></a><span class="co"># --- Step 1: Prepare data for table formatting ---</span></span>
<span id="cb33-8"><a href="#cb33-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert grouping variables to character for cleaner label handling</span></span>
<span id="cb33-9"><a href="#cb33-9" aria-hidden="true" tabindex="-1"></a>vacc_1524 <span class="ot">&lt;-</span> vacc_1524 <span class="sc">%&gt;%</span></span>
<span id="cb33-10"><a href="#cb33-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">c</span>(gender, age_3group, marital_2group, year_3group, vacc_quarter, race_grouped), as.character))</span>
<span id="cb33-11"><a href="#cb33-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-12"><a href="#cb33-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Subset data for Respiratory vaccines to calculate column-based percentages (used for race)</span></span>
<span id="cb33-13"><a href="#cb33-13" aria-hidden="true" tabindex="-1"></a>respiratory_vaccines <span class="ot">&lt;-</span> vacc_1524 <span class="sc">%&gt;%</span></span>
<span id="cb33-14"><a href="#cb33-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(vacc_group3 <span class="sc">==</span> <span class="st">"Respiratory vaccines"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb33-15"><a href="#cb33-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(race_grouped, as.character))</span>
<span id="cb33-16"><a href="#cb33-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-17"><a href="#cb33-17" aria-hidden="true" tabindex="-1"></a><span class="co"># --- Step 2: Create table-building function ---</span></span>
<span id="cb33-18"><a href="#cb33-18" aria-hidden="true" tabindex="-1"></a><span class="co"># This function tabulates counts by category and optionally adds missing (Unknown) values</span></span>
<span id="cb33-19"><a href="#cb33-19" aria-hidden="true" tabindex="-1"></a>create_tab <span class="ot">&lt;-</span> <span class="cf">function</span>(data, var, label, <span class="at">use_col_percentage =</span> <span class="cn">FALSE</span>) {</span>
<span id="cb33-20"><a href="#cb33-20" aria-hidden="true" tabindex="-1"></a>  tab_main <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span></span>
<span id="cb33-21"><a href="#cb33-21" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>({{ var }})) <span class="sc">%&gt;%</span></span>
<span id="cb33-22"><a href="#cb33-22" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tabyl</span>({{ var }}, vacc_group3) <span class="sc">%&gt;%</span></span>
<span id="cb33-23"><a href="#cb33-23" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">Category =</span> label, <span class="at">.before =</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb33-24"><a href="#cb33-24" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rename</span>(<span class="at">Label =</span> {{ var }}) <span class="sc">%&gt;%</span></span>
<span id="cb33-25"><a href="#cb33-25" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">Label =</span> <span class="fu">as.character</span>(Label))</span>
<span id="cb33-26"><a href="#cb33-26" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb33-27"><a href="#cb33-27" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Add a row for missing/unknown if needed</span></span>
<span id="cb33-28"><a href="#cb33-28" aria-hidden="true" tabindex="-1"></a>  na_count <span class="ot">&lt;-</span> <span class="fu">sum</span>(<span class="fu">is.na</span>(<span class="fu">pull</span>(data, {{ var }})))</span>
<span id="cb33-29"><a href="#cb33-29" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (na_count <span class="sc">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb33-30"><a href="#cb33-30" aria-hidden="true" tabindex="-1"></a>    na_row <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb33-31"><a href="#cb33-31" aria-hidden="true" tabindex="-1"></a>      <span class="at">Category =</span> label,</span>
<span id="cb33-32"><a href="#cb33-32" aria-hidden="true" tabindex="-1"></a>      <span class="at">Label =</span> <span class="st">"Unknown"</span>,</span>
<span id="cb33-33"><a href="#cb33-33" aria-hidden="true" tabindex="-1"></a>      <span class="st">`</span><span class="at">Respiratory vaccines</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">sum</span>(data<span class="sc">$</span>vacc_group3 <span class="sc">==</span> <span class="st">"Respiratory vaccines"</span> <span class="sc">&amp;</span> <span class="fu">is.na</span>(<span class="fu">pull</span>(data, {{ var }})), <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb33-34"><a href="#cb33-34" aria-hidden="true" tabindex="-1"></a>      <span class="st">`</span><span class="at">Childhood vaccines</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">sum</span>(data<span class="sc">$</span>vacc_group3 <span class="sc">==</span> <span class="st">"Childhood vaccines"</span> <span class="sc">&amp;</span> <span class="fu">is.na</span>(<span class="fu">pull</span>(data, {{ var }})), <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb33-35"><a href="#cb33-35" aria-hidden="true" tabindex="-1"></a>      <span class="at">Other =</span> <span class="fu">sum</span>(data<span class="sc">$</span>vacc_group3 <span class="sc">==</span> <span class="st">"Other"</span> <span class="sc">&amp;</span> <span class="fu">is.na</span>(<span class="fu">pull</span>(data, {{ var }})), <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb33-36"><a href="#cb33-36" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb33-37"><a href="#cb33-37" aria-hidden="true" tabindex="-1"></a>    tab_combined <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(tab_main, na_row)</span>
<span id="cb33-38"><a href="#cb33-38" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb33-39"><a href="#cb33-39" aria-hidden="true" tabindex="-1"></a>    tab_combined <span class="ot">&lt;-</span> tab_main</span>
<span id="cb33-40"><a href="#cb33-40" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb33-41"><a href="#cb33-41" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb33-42"><a href="#cb33-42" aria-hidden="true" tabindex="-1"></a>  tab_combined <span class="sc">%&gt;%</span></span>
<span id="cb33-43"><a href="#cb33-43" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">use_col_percentage =</span> use_col_percentage)</span>
<span id="cb33-44"><a href="#cb33-44" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb33-45"><a href="#cb33-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-46"><a href="#cb33-46" aria-hidden="true" tabindex="-1"></a><span class="co"># --- Step 3: Generate frequency tables for each variable ---</span></span>
<span id="cb33-47"><a href="#cb33-47" aria-hidden="true" tabindex="-1"></a>tab_gender    <span class="ot">&lt;-</span> <span class="fu">create_tab</span>(vacc_1524, gender, <span class="st">"Gender"</span>)</span>
<span id="cb33-48"><a href="#cb33-48" aria-hidden="true" tabindex="-1"></a>tab_age       <span class="ot">&lt;-</span> <span class="fu">create_tab</span>(vacc_1524, age_3group, <span class="st">"Age group"</span>)</span>
<span id="cb33-49"><a href="#cb33-49" aria-hidden="true" tabindex="-1"></a>tab_marital   <span class="ot">&lt;-</span> <span class="fu">create_tab</span>(vacc_1524, marital_2group, <span class="st">"Marital status·µá"</span>)</span>
<span id="cb33-50"><a href="#cb33-50" aria-hidden="true" tabindex="-1"></a>tab_year      <span class="ot">&lt;-</span> <span class="fu">create_tab</span>(vacc_1524, year_3group, <span class="st">"Year group"</span>)</span>
<span id="cb33-51"><a href="#cb33-51" aria-hidden="true" tabindex="-1"></a>tab_quarter   <span class="ot">&lt;-</span> <span class="fu">create_tab</span>(vacc_1524, vacc_quarter, <span class="st">"Quarter"</span>)</span>
<span id="cb33-52"><a href="#cb33-52" aria-hidden="true" tabindex="-1"></a>tab_race      <span class="ot">&lt;-</span> <span class="fu">create_tab</span>(respiratory_vaccines, race_grouped, <span class="st">"Race group"</span>, <span class="at">use_col_percentage =</span> <span class="cn">TRUE</span>)</span>
<span id="cb33-53"><a href="#cb33-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-54"><a href="#cb33-54" aria-hidden="true" tabindex="-1"></a><span class="co"># --- Step 4: Combine all tables ---</span></span>
<span id="cb33-55"><a href="#cb33-55" aria-hidden="true" tabindex="-1"></a>tab_combined <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(</span>
<span id="cb33-56"><a href="#cb33-56" aria-hidden="true" tabindex="-1"></a>  tab_gender, tab_age, tab_marital,</span>
<span id="cb33-57"><a href="#cb33-57" aria-hidden="true" tabindex="-1"></a>  tab_year, tab_quarter, tab_race</span>
<span id="cb33-58"><a href="#cb33-58" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb33-59"><a href="#cb33-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-60"><a href="#cb33-60" aria-hidden="true" tabindex="-1"></a><span class="co"># --- Step 5: Calculate percentages and formatted string outputs ---</span></span>
<span id="cb33-61"><a href="#cb33-61" aria-hidden="true" tabindex="-1"></a>tab_combined <span class="ot">&lt;-</span> tab_combined <span class="sc">%&gt;%</span></span>
<span id="cb33-62"><a href="#cb33-62" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Category) <span class="sc">%&gt;%</span></span>
<span id="cb33-63"><a href="#cb33-63" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb33-64"><a href="#cb33-64" aria-hidden="true" tabindex="-1"></a>    <span class="at">use_col =</span> <span class="fu">first</span>(use_col_percentage),</span>
<span id="cb33-65"><a href="#cb33-65" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb33-66"><a href="#cb33-66" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Exclude "Unknown" when calculating column totals to ensure proportions sum to 100</span></span>
<span id="cb33-67"><a href="#cb33-67" aria-hidden="true" tabindex="-1"></a>    <span class="at">Total_Resp =</span> <span class="fu">ifelse</span>(use_col, <span class="fu">sum</span>(<span class="st">`</span><span class="at">Respiratory vaccines</span><span class="st">`</span>[Label <span class="sc">!=</span> <span class="st">"Unknown"</span>], <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb33-68"><a href="#cb33-68" aria-hidden="true" tabindex="-1"></a>                        <span class="st">`</span><span class="at">Respiratory vaccines</span><span class="st">`</span> <span class="sc">+</span> <span class="st">`</span><span class="at">Childhood vaccines</span><span class="st">`</span> <span class="sc">+</span> Other),</span>
<span id="cb33-69"><a href="#cb33-69" aria-hidden="true" tabindex="-1"></a>    <span class="at">Total_Child =</span> <span class="fu">ifelse</span>(use_col, <span class="fu">sum</span>(<span class="st">`</span><span class="at">Childhood vaccines</span><span class="st">`</span>[Label <span class="sc">!=</span> <span class="st">"Unknown"</span>], <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb33-70"><a href="#cb33-70" aria-hidden="true" tabindex="-1"></a>                         <span class="st">`</span><span class="at">Respiratory vaccines</span><span class="st">`</span> <span class="sc">+</span> <span class="st">`</span><span class="at">Childhood vaccines</span><span class="st">`</span> <span class="sc">+</span> Other),</span>
<span id="cb33-71"><a href="#cb33-71" aria-hidden="true" tabindex="-1"></a>    <span class="at">Total_Other =</span> <span class="fu">ifelse</span>(use_col, <span class="fu">sum</span>(Other[Label <span class="sc">!=</span> <span class="st">"Unknown"</span>], <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb33-72"><a href="#cb33-72" aria-hidden="true" tabindex="-1"></a>                         <span class="st">`</span><span class="at">Respiratory vaccines</span><span class="st">`</span> <span class="sc">+</span> <span class="st">`</span><span class="at">Childhood vaccines</span><span class="st">`</span> <span class="sc">+</span> Other),</span>
<span id="cb33-73"><a href="#cb33-73" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb33-74"><a href="#cb33-74" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Calculate proportions</span></span>
<span id="cb33-75"><a href="#cb33-75" aria-hidden="true" tabindex="-1"></a>    <span class="at">Resp_prop =</span> <span class="fu">ifelse</span>(Label <span class="sc">!=</span> <span class="st">"Unknown"</span>, <span class="fu">round</span>(<span class="dv">100</span> <span class="sc">*</span> <span class="st">`</span><span class="at">Respiratory vaccines</span><span class="st">`</span> <span class="sc">/</span> Total_Resp, <span class="dv">1</span>), <span class="cn">NA</span>),</span>
<span id="cb33-76"><a href="#cb33-76" aria-hidden="true" tabindex="-1"></a>    <span class="at">Child_prop =</span> <span class="fu">ifelse</span>(Label <span class="sc">!=</span> <span class="st">"Unknown"</span>, <span class="fu">round</span>(<span class="dv">100</span> <span class="sc">*</span> <span class="st">`</span><span class="at">Childhood vaccines</span><span class="st">`</span> <span class="sc">/</span> Total_Child, <span class="dv">1</span>), <span class="cn">NA</span>),</span>
<span id="cb33-77"><a href="#cb33-77" aria-hidden="true" tabindex="-1"></a>    <span class="at">Other_prop =</span> <span class="fu">ifelse</span>(Label <span class="sc">!=</span> <span class="st">"Unknown"</span>, <span class="fu">round</span>(<span class="dv">100</span> <span class="sc">*</span> Other <span class="sc">/</span> Total_Other, <span class="dv">1</span>), <span class="cn">NA</span>),</span>
<span id="cb33-78"><a href="#cb33-78" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb33-79"><a href="#cb33-79" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Format numbers and percentages</span></span>
<span id="cb33-80"><a href="#cb33-80" aria-hidden="true" tabindex="-1"></a>    <span class="at">Respiratory =</span> <span class="fu">ifelse</span>(<span class="fu">is.na</span>(Resp_prop),</span>
<span id="cb33-81"><a href="#cb33-81" aria-hidden="true" tabindex="-1"></a>                         <span class="fu">paste0</span>(<span class="fu">comma</span>(<span class="st">`</span><span class="at">Respiratory vaccines</span><span class="st">`</span>)),</span>
<span id="cb33-82"><a href="#cb33-82" aria-hidden="true" tabindex="-1"></a>                         <span class="fu">paste0</span>(<span class="fu">comma</span>(<span class="st">`</span><span class="at">Respiratory vaccines</span><span class="st">`</span>), <span class="st">" ("</span>, Resp_prop, <span class="st">")"</span>)),</span>
<span id="cb33-83"><a href="#cb33-83" aria-hidden="true" tabindex="-1"></a>    <span class="at">Childhood =</span> <span class="fu">ifelse</span>(<span class="fu">is.na</span>(Child_prop),</span>
<span id="cb33-84"><a href="#cb33-84" aria-hidden="true" tabindex="-1"></a>                       <span class="fu">paste0</span>(<span class="fu">comma</span>(<span class="st">`</span><span class="at">Childhood vaccines</span><span class="st">`</span>)),</span>
<span id="cb33-85"><a href="#cb33-85" aria-hidden="true" tabindex="-1"></a>                       <span class="fu">paste0</span>(<span class="fu">comma</span>(<span class="st">`</span><span class="at">Childhood vaccines</span><span class="st">`</span>), <span class="st">" ("</span>, Child_prop, <span class="st">")"</span>)),</span>
<span id="cb33-86"><a href="#cb33-86" aria-hidden="true" tabindex="-1"></a>    <span class="at">Other_grp =</span> <span class="fu">ifelse</span>(<span class="fu">is.na</span>(Other_prop),</span>
<span id="cb33-87"><a href="#cb33-87" aria-hidden="true" tabindex="-1"></a>                       <span class="fu">paste0</span>(<span class="fu">comma</span>(Other)),</span>
<span id="cb33-88"><a href="#cb33-88" aria-hidden="true" tabindex="-1"></a>                       <span class="fu">paste0</span>(<span class="fu">comma</span>(Other), <span class="st">" ("</span>, Other_prop, <span class="st">")"</span>))</span>
<span id="cb33-89"><a href="#cb33-89" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb33-90"><a href="#cb33-90" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb33-91"><a href="#cb33-91" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-92"><a href="#cb33-92" aria-hidden="true" tabindex="-1"></a><span class="co"># --- Step 6: Clean labels and fix formatting for final table ---</span></span>
<span id="cb33-93"><a href="#cb33-93" aria-hidden="true" tabindex="-1"></a>tab_combined <span class="ot">&lt;-</span> tab_combined <span class="sc">%&gt;%</span></span>
<span id="cb33-94"><a href="#cb33-94" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb33-95"><a href="#cb33-95" aria-hidden="true" tabindex="-1"></a>    <span class="at">Label =</span> <span class="fu">ifelse</span>(Label <span class="sc">==</span> <span class="st">"Other"</span>, <span class="st">"Other·∂ú"</span>, Label),</span>
<span id="cb33-96"><a href="#cb33-96" aria-hidden="true" tabindex="-1"></a>    <span class="at">Respiratory =</span> <span class="fu">ifelse</span>(Label <span class="sc">==</span> <span class="st">"Unknown"</span> <span class="sc">&amp;</span> <span class="st">`</span><span class="at">Respiratory vaccines</span><span class="st">`</span> <span class="sc">==</span> <span class="dv">0</span>, <span class="st">""</span>, Respiratory),</span>
<span id="cb33-97"><a href="#cb33-97" aria-hidden="true" tabindex="-1"></a>    <span class="at">Childhood   =</span> <span class="fu">ifelse</span>(Label <span class="sc">==</span> <span class="st">"Unknown"</span> <span class="sc">&amp;</span> <span class="st">`</span><span class="at">Childhood vaccines</span><span class="st">`</span> <span class="sc">==</span> <span class="dv">0</span>, <span class="st">""</span>, Childhood),</span>
<span id="cb33-98"><a href="#cb33-98" aria-hidden="true" tabindex="-1"></a>    <span class="at">Other_grp   =</span> <span class="fu">ifelse</span>(Label <span class="sc">==</span> <span class="st">"Unknown"</span> <span class="sc">&amp;</span> Other <span class="sc">==</span> <span class="dv">0</span>, <span class="st">""</span>, Other_grp)</span>
<span id="cb33-99"><a href="#cb33-99" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb33-100"><a href="#cb33-100" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Category) <span class="sc">%&gt;%</span></span>
<span id="cb33-101"><a href="#cb33-101" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Category =</span> <span class="fu">ifelse</span>(<span class="fu">row_number</span>() <span class="sc">==</span> <span class="dv">1</span>, Category, <span class="st">""</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb33-102"><a href="#cb33-102" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb33-103"><a href="#cb33-103" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Category, Label, Respiratory, Childhood, Other_grp)</span>
<span id="cb33-104"><a href="#cb33-104" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-105"><a href="#cb33-105" aria-hidden="true" tabindex="-1"></a><span class="co"># --- Step 7: Calculate group totals for header ---</span></span>
<span id="cb33-106"><a href="#cb33-106" aria-hidden="true" tabindex="-1"></a>totals <span class="ot">&lt;-</span> <span class="fu">table</span>(vacc_1524<span class="sc">$</span>vacc_group3)</span>
<span id="cb33-107"><a href="#cb33-107" aria-hidden="true" tabindex="-1"></a>total_resp <span class="ot">&lt;-</span> totals[<span class="st">"Respiratory vaccines"</span>]</span>
<span id="cb33-108"><a href="#cb33-108" aria-hidden="true" tabindex="-1"></a>total_child <span class="ot">&lt;-</span> totals[<span class="st">"Childhood vaccines"</span>]</span>
<span id="cb33-109"><a href="#cb33-109" aria-hidden="true" tabindex="-1"></a>total_other <span class="ot">&lt;-</span> totals[<span class="st">"Other"</span>]</span>
<span id="cb33-110"><a href="#cb33-110" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-111"><a href="#cb33-111" aria-hidden="true" tabindex="-1"></a><span class="co"># --- Step 8: Create styled summary table using flextable ---</span></span>
<span id="cb33-112"><a href="#cb33-112" aria-hidden="true" tabindex="-1"></a>table_vacc_summary <span class="ot">&lt;-</span> <span class="fu">flextable</span>(tab_combined) <span class="sc">%&gt;%</span></span>
<span id="cb33-113"><a href="#cb33-113" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_header_labels</span>(</span>
<span id="cb33-114"><a href="#cb33-114" aria-hidden="true" tabindex="-1"></a>    <span class="at">Category =</span> <span class="st">"Variable type"</span>,</span>
<span id="cb33-115"><a href="#cb33-115" aria-hidden="true" tabindex="-1"></a>    <span class="at">Label =</span> <span class="st">"Values"</span>,</span>
<span id="cb33-116"><a href="#cb33-116" aria-hidden="true" tabindex="-1"></a>    <span class="at">Respiratory =</span> <span class="st">"Number (%)·µÉ"</span>,</span>
<span id="cb33-117"><a href="#cb33-117" aria-hidden="true" tabindex="-1"></a>    <span class="at">Childhood =</span> <span class="st">"Number (%)·µÉ"</span>,</span>
<span id="cb33-118"><a href="#cb33-118" aria-hidden="true" tabindex="-1"></a>    <span class="at">Other_grp =</span> <span class="st">"Number (%)·µÉ"</span></span>
<span id="cb33-119"><a href="#cb33-119" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb33-120"><a href="#cb33-120" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_header_row</span>(</span>
<span id="cb33-121"><a href="#cb33-121" aria-hidden="true" tabindex="-1"></a>    <span class="at">values =</span> <span class="fu">c</span>(<span class="st">""</span>, <span class="st">""</span>,</span>
<span id="cb33-122"><a href="#cb33-122" aria-hidden="true" tabindex="-1"></a>               <span class="fu">paste0</span>(<span class="st">"Respiratory vaccines (N = "</span>, <span class="fu">format</span>(total_resp, <span class="at">big.mark =</span> <span class="st">","</span>), <span class="st">")"</span>),</span>
<span id="cb33-123"><a href="#cb33-123" aria-hidden="true" tabindex="-1"></a>               <span class="fu">paste0</span>(<span class="st">"Childhood vaccines (N = "</span>, <span class="fu">format</span>(total_child, <span class="at">big.mark =</span> <span class="st">","</span>), <span class="st">")"</span>),</span>
<span id="cb33-124"><a href="#cb33-124" aria-hidden="true" tabindex="-1"></a>               <span class="fu">paste0</span>(<span class="st">"Other (N = "</span>, <span class="fu">format</span>(total_other, <span class="at">big.mark =</span> <span class="st">","</span>), <span class="st">")"</span>)),</span>
<span id="cb33-125"><a href="#cb33-125" aria-hidden="true" tabindex="-1"></a>    <span class="at">colwidths =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>),</span>
<span id="cb33-126"><a href="#cb33-126" aria-hidden="true" tabindex="-1"></a>    <span class="at">top =</span> <span class="cn">TRUE</span></span>
<span id="cb33-127"><a href="#cb33-127" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb33-128"><a href="#cb33-128" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_header_row</span>(</span>
<span id="cb33-129"><a href="#cb33-129" aria-hidden="true" tabindex="-1"></a>    <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"Description"</span>, <span class="st">"Vaccination uptake"</span>),</span>
<span id="cb33-130"><a href="#cb33-130" aria-hidden="true" tabindex="-1"></a>    <span class="at">colwidths =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">3</span>),</span>
<span id="cb33-131"><a href="#cb33-131" aria-hidden="true" tabindex="-1"></a>    <span class="at">top =</span> <span class="cn">TRUE</span></span>
<span id="cb33-132"><a href="#cb33-132" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb33-133"><a href="#cb33-133" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_box</span>() <span class="sc">%&gt;%</span></span>
<span id="cb33-134"><a href="#cb33-134" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_table_properties</span>(<span class="at">layout =</span> <span class="st">"autofit"</span>, <span class="at">width =</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb33-135"><a href="#cb33-135" aria-hidden="true" tabindex="-1"></a>  <span class="fu">width</span>(<span class="at">j =</span> <span class="dv">1</span>, <span class="at">width =</span> <span class="fl">1.5</span>) <span class="sc">%&gt;%</span></span>
<span id="cb33-136"><a href="#cb33-136" aria-hidden="true" tabindex="-1"></a>  <span class="fu">width</span>(<span class="at">j =</span> <span class="dv">2</span>, <span class="at">width =</span> <span class="fl">2.5</span>) <span class="sc">%&gt;%</span></span>
<span id="cb33-137"><a href="#cb33-137" aria-hidden="true" tabindex="-1"></a>  <span class="fu">width</span>(<span class="at">j =</span> <span class="dv">3</span><span class="sc">:</span><span class="dv">5</span>, <span class="at">width =</span> <span class="fl">1.5</span>) <span class="sc">%&gt;%</span></span>
<span id="cb33-138"><a href="#cb33-138" aria-hidden="true" tabindex="-1"></a>  <span class="fu">align</span>(<span class="at">align =</span> <span class="st">"justify"</span>, <span class="at">part =</span> <span class="st">"all"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb33-139"><a href="#cb33-139" aria-hidden="true" tabindex="-1"></a>  <span class="fu">border_remove</span>() <span class="sc">%&gt;%</span></span>
<span id="cb33-140"><a href="#cb33-140" aria-hidden="true" tabindex="-1"></a>  <span class="fu">border</span>(<span class="at">part =</span> <span class="st">"header"</span>, <span class="at">i =</span> <span class="dv">1</span>, <span class="at">border.top =</span> <span class="fu">fp_border</span>(<span class="at">color =</span> <span class="st">"black"</span>, <span class="at">width =</span> <span class="dv">1</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb33-141"><a href="#cb33-141" aria-hidden="true" tabindex="-1"></a>  <span class="fu">border</span>(<span class="at">part =</span> <span class="st">"header"</span>, <span class="at">i =</span> <span class="dv">3</span>, <span class="at">border.bottom =</span> <span class="fu">fp_border</span>(<span class="at">color =</span> <span class="st">"black"</span>, <span class="at">width =</span> <span class="dv">1</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb33-142"><a href="#cb33-142" aria-hidden="true" tabindex="-1"></a>  <span class="fu">border_inner_h</span>(<span class="at">part =</span> <span class="st">"header"</span>, <span class="at">border =</span> <span class="fu">fp_border</span>(<span class="at">color =</span> <span class="st">"black"</span>, <span class="at">width =</span> <span class="fl">0.8</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb33-143"><a href="#cb33-143" aria-hidden="true" tabindex="-1"></a>  <span class="fu">border_inner_h</span>(<span class="at">part =</span> <span class="st">"body"</span>, <span class="at">border =</span> <span class="fu">fp_border</span>(<span class="at">color =</span> <span class="st">"black"</span>, <span class="at">width =</span> <span class="fl">0.8</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb33-144"><a href="#cb33-144" aria-hidden="true" tabindex="-1"></a>  <span class="fu">border</span>(<span class="at">part =</span> <span class="st">"body"</span>, <span class="at">i =</span> <span class="fu">nrow</span>(tab_combined), <span class="at">border.bottom =</span> <span class="fu">fp_border</span>(<span class="at">color =</span> <span class="st">"black"</span>, <span class="at">width =</span> <span class="dv">1</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb33-145"><a href="#cb33-145" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_caption</span>(<span class="fu">as_paragraph</span>(<span class="fu">as_chunk</span>(</span>
<span id="cb33-146"><a href="#cb33-146" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Table xx: Vaccination uptake by demographic, temporal, and race variables, 2015‚Äì2024."</span>,</span>
<span id="cb33-147"><a href="#cb33-147" aria-hidden="true" tabindex="-1"></a>    <span class="at">props =</span> <span class="fu">fp_text</span>(<span class="at">font.size =</span> <span class="dv">12</span>, <span class="at">font.family =</span> <span class="st">"Times New Roman"</span>, <span class="at">bold =</span> <span class="cn">FALSE</span>)</span>
<span id="cb33-148"><a href="#cb33-148" aria-hidden="true" tabindex="-1"></a>  ))) <span class="sc">%&gt;%</span></span>
<span id="cb33-149"><a href="#cb33-149" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_footer_lines</span>(<span class="at">values =</span> <span class="fu">c</span>(</span>
<span id="cb33-150"><a href="#cb33-150" aria-hidden="true" tabindex="-1"></a>    <span class="st">"·µÉ Vaccination proportions were calculated per row (row percentage) except for race group which used column percentages."</span>,</span>
<span id="cb33-151"><a href="#cb33-151" aria-hidden="true" tabindex="-1"></a>    <span class="st">"·µá Marital status was grouped into two: partnered for those married and non-partnered for those divorced, widowed or single."</span>,</span>
<span id="cb33-152"><a href="#cb33-152" aria-hidden="true" tabindex="-1"></a>    <span class="st">"·∂ú Other race refers to those who identify as native or other racial groups."</span></span>
<span id="cb33-153"><a href="#cb33-153" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">%&gt;%</span></span>
<span id="cb33-154"><a href="#cb33-154" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fontsize</span>(<span class="at">part =</span> <span class="st">"header"</span>, <span class="at">size =</span> <span class="dv">12</span>) <span class="sc">%&gt;%</span></span>
<span id="cb33-155"><a href="#cb33-155" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fontsize</span>(<span class="at">part =</span> <span class="st">"body"</span>, <span class="at">size =</span> <span class="dv">11</span>) <span class="sc">%&gt;%</span></span>
<span id="cb33-156"><a href="#cb33-156" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fontsize</span>(<span class="at">part =</span> <span class="st">"footer"</span>, <span class="at">size =</span> <span class="dv">10</span>) <span class="sc">%&gt;%</span></span>
<span id="cb33-157"><a href="#cb33-157" aria-hidden="true" tabindex="-1"></a>  <span class="fu">font</span>(<span class="at">part =</span> <span class="st">"all"</span>, <span class="at">fontname =</span> <span class="st">"Times New Roman"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb33-158"><a href="#cb33-158" aria-hidden="true" tabindex="-1"></a>  <span class="fu">color</span>(<span class="at">part =</span> <span class="st">"header"</span>, <span class="at">color =</span> <span class="st">"white"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb33-159"><a href="#cb33-159" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bg</span>(<span class="at">part =</span> <span class="st">"header"</span>, <span class="at">bg =</span> <span class="st">"black"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb33-160"><a href="#cb33-160" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bg</span>(<span class="at">j =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>, <span class="at">i =</span> <span class="fu">seq</span>(<span class="dv">2</span>, <span class="fu">nrow</span>(tab_combined), <span class="dv">2</span>), <span class="at">bg =</span> <span class="st">"white"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb33-161"><a href="#cb33-161" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bold</span>(<span class="at">j =</span> <span class="dv">1</span>, <span class="at">part =</span> <span class="st">"body"</span>)</span>
<span id="cb33-162"><a href="#cb33-162" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-163"><a href="#cb33-163" aria-hidden="true" tabindex="-1"></a><span class="co"># --- Step 9: Display table ---</span></span>
<span id="cb33-164"><a href="#cb33-164" aria-hidden="true" tabindex="-1"></a>table_vacc_summary</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="tabwid"><style>.cl-fe5a64a4{table-layout:auto;width:100%;}.cl-fe520a3e{font-family:'Times New Roman';font-size:12pt;font-weight:bold;font-style:normal;text-decoration:none;color:rgba(255, 255, 255, 1.00);background-color:transparent;}.cl-fe520a48{font-family:'Times New Roman';font-size:11pt;font-weight:bold;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-fe520a49{font-family:'Times New Roman';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-fe520a52{font-family:'Times New Roman';font-size:10pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-fe5534ca{margin:0;text-align:justify;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-fe5534d4{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-fe555716{background-color:rgba(0, 0, 0, 1.00);vertical-align: middle;border-bottom: 0.8pt solid rgba(0, 0, 0, 1.00);border-top: 1pt solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-fe555717{background-color:rgba(0, 0, 0, 1.00);vertical-align: middle;border-bottom: 0.8pt solid rgba(0, 0, 0, 1.00);border-top: 1pt solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-fe555720{background-color:rgba(0, 0, 0, 1.00);vertical-align: middle;border-bottom: 0.8pt solid rgba(0, 0, 0, 1.00);border-top: 0.8pt solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-fe555721{background-color:rgba(0, 0, 0, 1.00);vertical-align: middle;border-bottom: 0.8pt solid rgba(0, 0, 0, 1.00);border-top: 0.8pt solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-fe555722{background-color:rgba(0, 0, 0, 1.00);vertical-align: middle;border-bottom: 1pt solid rgba(0, 0, 0, 1.00);border-top: 0.8pt solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-fe55572a{background-color:rgba(0, 0, 0, 1.00);vertical-align: middle;border-bottom: 1pt solid rgba(0, 0, 0, 1.00);border-top: 0.8pt solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-fe55572b{background-color:transparent;vertical-align: middle;border-bottom: 0.8pt solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-fe55572c{background-color:transparent;vertical-align: middle;border-bottom: 0.8pt solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-fe55572d{background-color:rgba(255, 255, 255, 1.00);vertical-align: middle;border-bottom: 0.8pt solid rgba(0, 0, 0, 1.00);border-top: 0.8pt solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-fe555734{background-color:rgba(255, 255, 255, 1.00);vertical-align: middle;border-bottom: 0.8pt solid rgba(0, 0, 0, 1.00);border-top: 0.8pt solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-fe555735{background-color:transparent;vertical-align: middle;border-bottom: 0.8pt solid rgba(0, 0, 0, 1.00);border-top: 0.8pt solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-fe555736{background-color:transparent;vertical-align: middle;border-bottom: 0.8pt solid rgba(0, 0, 0, 1.00);border-top: 0.8pt solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-fe555737{background-color:transparent;vertical-align: middle;border-bottom: 1pt solid rgba(0, 0, 0, 1.00);border-top: 0.8pt solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-fe555738{background-color:transparent;vertical-align: middle;border-bottom: 1pt solid rgba(0, 0, 0, 1.00);border-top: 0.8pt solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-fe55573e{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(255, 255, 255, 0.00);border-top: 0 solid rgba(255, 255, 255, 0.00);border-left: 0 solid rgba(255, 255, 255, 0.00);border-right: 0 solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-fe55573f{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(255, 255, 255, 0.00);border-top: 0 solid rgba(255, 255, 255, 0.00);border-left: 0 solid rgba(255, 255, 255, 0.00);border-right: 0 solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table data-quarto-disable-processing="true" class="cl-fe5a64a4"><thead><tr style="overflow-wrap:break-word;"><th colspan="2" class="cl-fe555716"><p class="cl-fe5534ca"><span class="cl-fe520a3e">Description</span></p></th><th colspan="3" class="cl-fe555716"><p class="cl-fe5534ca"><span class="cl-fe520a3e">Vaccination uptake</span></p></th></tr><tr style="overflow-wrap:break-word;"><th class="cl-fe555720"><p class="cl-fe5534ca"><span class="cl-fe520a3e"></span></p></th><th class="cl-fe555721"><p class="cl-fe5534ca"><span class="cl-fe520a3e"></span></p></th><th class="cl-fe555720"><p class="cl-fe5534ca"><span class="cl-fe520a3e">Respiratory vaccines (N = 955)</span></p></th><th class="cl-fe555720"><p class="cl-fe5534ca"><span class="cl-fe520a3e">Childhood vaccines (N = 472)</span></p></th><th class="cl-fe555720"><p class="cl-fe5534ca"><span class="cl-fe520a3e">Other (N = 126)</span></p></th></tr><tr style="overflow-wrap:break-word;"><th class="cl-fe555722"><p class="cl-fe5534ca"><span class="cl-fe520a3e">Variable type</span></p></th><th class="cl-fe55572a"><p class="cl-fe5534ca"><span class="cl-fe520a3e">Values</span></p></th><th class="cl-fe555722"><p class="cl-fe5534ca"><span class="cl-fe520a3e">Number (%)·µÉ</span></p></th><th class="cl-fe555722"><p class="cl-fe5534ca"><span class="cl-fe520a3e">Number (%)·µÉ</span></p></th><th class="cl-fe555722"><p class="cl-fe5534ca"><span class="cl-fe520a3e">Number (%)·µÉ</span></p></th></tr></thead><tbody><tr style="overflow-wrap:break-word;"><td class="cl-fe55572b"><p class="cl-fe5534ca"><span class="cl-fe520a48">Gender</span></p></td><td class="cl-fe55572c"><p class="cl-fe5534ca"><span class="cl-fe520a49">Female</span></p></td><td class="cl-fe55572b"><p class="cl-fe5534ca"><span class="cl-fe520a49">511 (64)</span></p></td><td class="cl-fe55572b"><p class="cl-fe5534ca"><span class="cl-fe520a49">233 (29.2)</span></p></td><td class="cl-fe55572b"><p class="cl-fe5534ca"><span class="cl-fe520a49">54 (6.8)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-fe55572d"><p class="cl-fe5534ca"><span class="cl-fe520a48"></span></p></td><td class="cl-fe555734"><p class="cl-fe5534ca"><span class="cl-fe520a49">Male</span></p></td><td class="cl-fe55572d"><p class="cl-fe5534ca"><span class="cl-fe520a49">444 (58.8)</span></p></td><td class="cl-fe55572d"><p class="cl-fe5534ca"><span class="cl-fe520a49">239 (31.7)</span></p></td><td class="cl-fe55572d"><p class="cl-fe5534ca"><span class="cl-fe520a49">72 (9.5)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-fe555735"><p class="cl-fe5534ca"><span class="cl-fe520a48">Age group</span></p></td><td class="cl-fe555736"><p class="cl-fe5534ca"><span class="cl-fe520a49">&lt;25</span></p></td><td class="cl-fe555735"><p class="cl-fe5534ca"><span class="cl-fe520a49">332 (43.7)</span></p></td><td class="cl-fe555735"><p class="cl-fe5534ca"><span class="cl-fe520a49">337 (44.4)</span></p></td><td class="cl-fe555735"><p class="cl-fe5534ca"><span class="cl-fe520a49">90 (11.9)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-fe55572d"><p class="cl-fe5534ca"><span class="cl-fe520a48"></span></p></td><td class="cl-fe555734"><p class="cl-fe5534ca"><span class="cl-fe520a49">25-34</span></p></td><td class="cl-fe55572d"><p class="cl-fe5534ca"><span class="cl-fe520a49">98 (65.8)</span></p></td><td class="cl-fe55572d"><p class="cl-fe5534ca"><span class="cl-fe520a49">51 (34.2)</span></p></td><td class="cl-fe55572d"><p class="cl-fe5534ca"><span class="cl-fe520a49">0 (0)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-fe555735"><p class="cl-fe5534ca"><span class="cl-fe520a48"></span></p></td><td class="cl-fe555736"><p class="cl-fe5534ca"><span class="cl-fe520a49">35+</span></p></td><td class="cl-fe555735"><p class="cl-fe5534ca"><span class="cl-fe520a49">525 (81.4)</span></p></td><td class="cl-fe555735"><p class="cl-fe5534ca"><span class="cl-fe520a49">84 (13)</span></p></td><td class="cl-fe555735"><p class="cl-fe5534ca"><span class="cl-fe520a49">36 (5.6)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-fe55572d"><p class="cl-fe5534ca"><span class="cl-fe520a48">Marital status·µá</span></p></td><td class="cl-fe555734"><p class="cl-fe5534ca"><span class="cl-fe520a49">Not partnered</span></p></td><td class="cl-fe55572d"><p class="cl-fe5534ca"><span class="cl-fe520a49">286 (81.2)</span></p></td><td class="cl-fe55572d"><p class="cl-fe5534ca"><span class="cl-fe520a49">48 (13.6)</span></p></td><td class="cl-fe55572d"><p class="cl-fe5534ca"><span class="cl-fe520a49">18 (5.1)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-fe555735"><p class="cl-fe5534ca"><span class="cl-fe520a48"></span></p></td><td class="cl-fe555736"><p class="cl-fe5534ca"><span class="cl-fe520a49">Partnered</span></p></td><td class="cl-fe555735"><p class="cl-fe5534ca"><span class="cl-fe520a49">289 (79)</span></p></td><td class="cl-fe555735"><p class="cl-fe5534ca"><span class="cl-fe520a49">59 (16.1)</span></p></td><td class="cl-fe555735"><p class="cl-fe5534ca"><span class="cl-fe520a49">18 (4.9)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-fe55572d"><p class="cl-fe5534ca"><span class="cl-fe520a48"></span></p></td><td class="cl-fe555734"><p class="cl-fe5534ca"><span class="cl-fe520a49">Unknown</span></p></td><td class="cl-fe55572d"><p class="cl-fe5534ca"><span class="cl-fe520a49">380</span></p></td><td class="cl-fe55572d"><p class="cl-fe5534ca"><span class="cl-fe520a49">365</span></p></td><td class="cl-fe55572d"><p class="cl-fe5534ca"><span class="cl-fe520a49">90</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-fe555735"><p class="cl-fe5534ca"><span class="cl-fe520a48">Year group</span></p></td><td class="cl-fe555736"><p class="cl-fe5534ca"><span class="cl-fe520a49">‚â§2020</span></p></td><td class="cl-fe555735"><p class="cl-fe5534ca"><span class="cl-fe520a49">483 (55)</span></p></td><td class="cl-fe555735"><p class="cl-fe5534ca"><span class="cl-fe520a49">311 (35.4)</span></p></td><td class="cl-fe555735"><p class="cl-fe5534ca"><span class="cl-fe520a49">84 (9.6)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-fe55572d"><p class="cl-fe5534ca"><span class="cl-fe520a48"></span></p></td><td class="cl-fe555734"><p class="cl-fe5534ca"><span class="cl-fe520a49">2021-2022</span></p></td><td class="cl-fe55572d"><p class="cl-fe5534ca"><span class="cl-fe520a49">311 (81.2)</span></p></td><td class="cl-fe55572d"><p class="cl-fe5534ca"><span class="cl-fe520a49">59 (15.4)</span></p></td><td class="cl-fe55572d"><p class="cl-fe5534ca"><span class="cl-fe520a49">13 (3.4)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-fe555735"><p class="cl-fe5534ca"><span class="cl-fe520a48"></span></p></td><td class="cl-fe555736"><p class="cl-fe5534ca"><span class="cl-fe520a49">2023+</span></p></td><td class="cl-fe555735"><p class="cl-fe5534ca"><span class="cl-fe520a49">161 (55.1)</span></p></td><td class="cl-fe555735"><p class="cl-fe5534ca"><span class="cl-fe520a49">102 (34.9)</span></p></td><td class="cl-fe555735"><p class="cl-fe5534ca"><span class="cl-fe520a49">29 (9.9)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-fe55572d"><p class="cl-fe5534ca"><span class="cl-fe520a48">Quarter</span></p></td><td class="cl-fe555734"><p class="cl-fe5534ca"><span class="cl-fe520a49">1</span></p></td><td class="cl-fe55572d"><p class="cl-fe5534ca"><span class="cl-fe520a49">253 (62.8)</span></p></td><td class="cl-fe55572d"><p class="cl-fe5534ca"><span class="cl-fe520a49">120 (29.8)</span></p></td><td class="cl-fe55572d"><p class="cl-fe5534ca"><span class="cl-fe520a49">30 (7.4)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-fe555735"><p class="cl-fe5534ca"><span class="cl-fe520a48"></span></p></td><td class="cl-fe555736"><p class="cl-fe5534ca"><span class="cl-fe520a49">2</span></p></td><td class="cl-fe555735"><p class="cl-fe5534ca"><span class="cl-fe520a49">220 (58.5)</span></p></td><td class="cl-fe555735"><p class="cl-fe5534ca"><span class="cl-fe520a49">117 (31.1)</span></p></td><td class="cl-fe555735"><p class="cl-fe5534ca"><span class="cl-fe520a49">39 (10.4)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-fe55572d"><p class="cl-fe5534ca"><span class="cl-fe520a48"></span></p></td><td class="cl-fe555734"><p class="cl-fe5534ca"><span class="cl-fe520a49">3</span></p></td><td class="cl-fe55572d"><p class="cl-fe5534ca"><span class="cl-fe520a49">295 (63.2)</span></p></td><td class="cl-fe55572d"><p class="cl-fe5534ca"><span class="cl-fe520a49">139 (29.8)</span></p></td><td class="cl-fe55572d"><p class="cl-fe5534ca"><span class="cl-fe520a49">33 (7.1)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-fe555735"><p class="cl-fe5534ca"><span class="cl-fe520a48"></span></p></td><td class="cl-fe555736"><p class="cl-fe5534ca"><span class="cl-fe520a49">4</span></p></td><td class="cl-fe555735"><p class="cl-fe5534ca"><span class="cl-fe520a49">187 (60.9)</span></p></td><td class="cl-fe555735"><p class="cl-fe5534ca"><span class="cl-fe520a49">96 (31.3)</span></p></td><td class="cl-fe555735"><p class="cl-fe5534ca"><span class="cl-fe520a49">24 (7.8)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-fe55572d"><p class="cl-fe5534ca"><span class="cl-fe520a48">Race group</span></p></td><td class="cl-fe555734"><p class="cl-fe5534ca"><span class="cl-fe520a49">Asian</span></p></td><td class="cl-fe55572d"><p class="cl-fe5534ca"><span class="cl-fe520a49">69 (7.8)</span></p></td><td class="cl-fe55572d"><p class="cl-fe5534ca"><span class="cl-fe520a49">NA</span></p></td><td class="cl-fe55572d"><p class="cl-fe5534ca"><span class="cl-fe520a49">NA</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-fe555735"><p class="cl-fe5534ca"><span class="cl-fe520a48"></span></p></td><td class="cl-fe555736"><p class="cl-fe5534ca"><span class="cl-fe520a49">Other·∂ú</span></p></td><td class="cl-fe555735"><p class="cl-fe5534ca"><span class="cl-fe520a49">28 (3.2)</span></p></td><td class="cl-fe555735"><p class="cl-fe5534ca"><span class="cl-fe520a49">NA</span></p></td><td class="cl-fe555735"><p class="cl-fe5534ca"><span class="cl-fe520a49">NA</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-fe55572d"><p class="cl-fe5534ca"><span class="cl-fe520a48"></span></p></td><td class="cl-fe555734"><p class="cl-fe5534ca"><span class="cl-fe520a49">White</span></p></td><td class="cl-fe55572d"><p class="cl-fe5534ca"><span class="cl-fe520a49">788 (89)</span></p></td><td class="cl-fe55572d"><p class="cl-fe5534ca"><span class="cl-fe520a49">NA</span></p></td><td class="cl-fe55572d"><p class="cl-fe5534ca"><span class="cl-fe520a49">NA</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-fe555737"><p class="cl-fe5534ca"><span class="cl-fe520a48"></span></p></td><td class="cl-fe555738"><p class="cl-fe5534ca"><span class="cl-fe520a49">Unknown</span></p></td><td class="cl-fe555737"><p class="cl-fe5534ca"><span class="cl-fe520a49">70</span></p></td><td class="cl-fe555737"><p class="cl-fe5534ca"><span class="cl-fe520a49"></span></p></td><td class="cl-fe555737"><p class="cl-fe5534ca"><span class="cl-fe520a49"></span></p></td></tr></tbody><tfoot><tr style="overflow-wrap:break-word;"><td colspan="5" class="cl-fe55573e"><p class="cl-fe5534d4"><span class="cl-fe520a52">·µÉ Vaccination proportions were calculated per row (row percentage) except for race group which used column percentages.</span></p></td></tr><tr style="overflow-wrap:break-word;"><td colspan="5" class="cl-fe55573e"><p class="cl-fe5534d4"><span class="cl-fe520a52">·µá Marital status was grouped into two: partnered for those married and non-partnered for those divorced, widowed or single.</span></p></td></tr><tr style="overflow-wrap:break-word;"><td colspan="5" class="cl-fe55573e"><p class="cl-fe5534d4"><span class="cl-fe520a52">·∂ú Other race refers to those who identify as native or other racial groups.</span></p></td></tr></tfoot></table></div>
</div>
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="co"># --- Step 10: Clean up temporary objects (optional) ---</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(</span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>  tab_gender, tab_age, tab_marital, tab_year, tab_quarter, tab_race,</span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a>  tab_combined, create_tab, respiratory_vaccines,</span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a>  totals, total_resp, total_child, total_other</span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="multiple-response-tables-rowwise-percentage" class="level2" data-number="1.13">
<h2 data-number="1.13" class="anchored" data-anchor-id="multiple-response-tables-rowwise-percentage"><span class="header-section-number">1.13</span> <strong>13. Multiple Response Tables ‚Äì Rowwise Percentage</strong></h2>
<p>Here we simulate <strong>multiple-response tables</strong> by combining summary outputs from different variables side-by-side.</p>
<p>üìö <em>What‚Äôs useful here?</em></p>
<ul>
<li><p>Shows how people responded with combinations of vaccine types (e.g., Both, Influenza, or None), where both here refers vaccination of influenza and other vaccine types.</p></li>
<li><p>üôå <em>Applies to</em>: Any analysis involving response overlaps (e.g., co-morbidity, multiple treatments, combined exposures).</p></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ------------ 10. Mutiple Response Tables: via appending: Rowwise -------------------------------------------</span></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a><span class="co"># .................. Create flextable summary by variable ..................</span></span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a>process_variable <span class="ot">&lt;-</span> <span class="cf">function</span>(data, group_var, group_label) {</span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Base pattern: Both and No</span></span>
<span id="cb35-7"><a href="#cb35-7" aria-hidden="true" tabindex="-1"></a>  df_base <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span></span>
<span id="cb35-8"><a href="#cb35-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(<span class="fu">across</span>(<span class="fu">all_of</span>(group_var)), vacc_pattern) <span class="sc">%&gt;%</span></span>
<span id="cb35-9"><a href="#cb35-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarise</span>(<span class="at">count =</span> <span class="fu">n</span>(), <span class="at">.groups =</span> <span class="st">"drop"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb35-10"><a href="#cb35-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(<span class="fu">across</span>(<span class="fu">all_of</span>(group_var))) <span class="sc">%&gt;%</span></span>
<span id="cb35-11"><a href="#cb35-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">total =</span> <span class="fu">sum</span>(count),</span>
<span id="cb35-12"><a href="#cb35-12" aria-hidden="true" tabindex="-1"></a>           <span class="at">proportion =</span> <span class="fu">round</span>((count <span class="sc">/</span> total) <span class="sc">*</span> <span class="dv">100</span>, <span class="dv">1</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb35-13"><a href="#cb35-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb35-14"><a href="#cb35-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(vacc_pattern <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"Both"</span>, <span class="st">"No"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb35-15"><a href="#cb35-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rename</span>(<span class="at">value =</span> <span class="sc">!!</span><span class="fu">sym</span>(group_var)) <span class="sc">%&gt;%</span></span>
<span id="cb35-16"><a href="#cb35-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">value =</span> <span class="fu">as.character</span>(value))</span>
<span id="cb35-17"><a href="#cb35-17" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb35-18"><a href="#cb35-18" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Influenza </span></span>
<span id="cb35-19"><a href="#cb35-19" aria-hidden="true" tabindex="-1"></a>  df_flu <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span></span>
<span id="cb35-20"><a href="#cb35-20" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(<span class="sc">!!</span><span class="fu">sym</span>(group_var))) <span class="sc">%&gt;%</span></span>
<span id="cb35-21"><a href="#cb35-21" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">flu_yes =</span> <span class="fu">recode</span>(flu_yes, <span class="st">"Yes"</span> <span class="ot">=</span> <span class="st">"Influenza"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb35-22"><a href="#cb35-22" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(<span class="fu">across</span>(<span class="fu">all_of</span>(group_var)), flu_yes) <span class="sc">%&gt;%</span></span>
<span id="cb35-23"><a href="#cb35-23" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarise</span>(<span class="at">count =</span> <span class="fu">n</span>(), <span class="at">.groups =</span> <span class="st">"drop"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb35-24"><a href="#cb35-24" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(<span class="fu">across</span>(<span class="fu">all_of</span>(group_var))) <span class="sc">%&gt;%</span></span>
<span id="cb35-25"><a href="#cb35-25" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">total =</span> <span class="fu">sum</span>(count),</span>
<span id="cb35-26"><a href="#cb35-26" aria-hidden="true" tabindex="-1"></a>           <span class="at">proportion =</span> <span class="fu">round</span>((count <span class="sc">/</span> total) <span class="sc">*</span> <span class="dv">100</span>, <span class="dv">1</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb35-27"><a href="#cb35-27" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb35-28"><a href="#cb35-28" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(flu_yes <span class="sc">==</span> <span class="st">"Influenza"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb35-29"><a href="#cb35-29" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rename</span>(<span class="at">vacc_pattern =</span> flu_yes, <span class="at">value =</span> <span class="sc">!!</span><span class="fu">sym</span>(group_var)) <span class="sc">%&gt;%</span></span>
<span id="cb35-30"><a href="#cb35-30" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">value =</span> <span class="fu">as.character</span>(value))</span>
<span id="cb35-31"><a href="#cb35-31" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb35-32"><a href="#cb35-32" aria-hidden="true" tabindex="-1"></a>  df_combined <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(df_base, df_flu) <span class="sc">%&gt;%</span></span>
<span id="cb35-33"><a href="#cb35-33" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">vacc_pattern =</span> <span class="fu">factor</span>(vacc_pattern, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"Both"</span>, <span class="st">"Influenza"</span>, <span class="st">"No"</span>)))</span>
<span id="cb35-34"><a href="#cb35-34" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb35-35"><a href="#cb35-35" aria-hidden="true" tabindex="-1"></a>  df_wide <span class="ot">&lt;-</span> df_combined <span class="sc">%&gt;%</span></span>
<span id="cb35-36"><a href="#cb35-36" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(value, vacc_pattern, count, proportion) <span class="sc">%&gt;%</span></span>
<span id="cb35-37"><a href="#cb35-37" aria-hidden="true" tabindex="-1"></a>    <span class="fu">pivot_wider</span>(</span>
<span id="cb35-38"><a href="#cb35-38" aria-hidden="true" tabindex="-1"></a>      <span class="at">names_from =</span> vacc_pattern,</span>
<span id="cb35-39"><a href="#cb35-39" aria-hidden="true" tabindex="-1"></a>      <span class="at">values_from =</span> <span class="fu">c</span>(count, proportion),</span>
<span id="cb35-40"><a href="#cb35-40" aria-hidden="true" tabindex="-1"></a>      <span class="at">values_fn =</span> <span class="fu">list</span>(<span class="at">count =</span> sum, <span class="at">proportion =</span> sum),</span>
<span id="cb35-41"><a href="#cb35-41" aria-hidden="true" tabindex="-1"></a>      <span class="at">values_fill =</span> <span class="fu">list</span>(<span class="at">count =</span> <span class="dv">0</span>, <span class="at">proportion =</span> <span class="dv">0</span>)</span>
<span id="cb35-42"><a href="#cb35-42" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span></span>
<span id="cb35-43"><a href="#cb35-43" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(</span>
<span id="cb35-44"><a href="#cb35-44" aria-hidden="true" tabindex="-1"></a>      <span class="at">Both =</span> <span class="fu">paste0</span>(<span class="fu">comma</span>(<span class="st">`</span><span class="at">count_Both</span><span class="st">`</span>), <span class="st">" ("</span>, <span class="st">`</span><span class="at">proportion_Both</span><span class="st">`</span>, <span class="st">")"</span>),</span>
<span id="cb35-45"><a href="#cb35-45" aria-hidden="true" tabindex="-1"></a>      <span class="st">`</span><span class="at">Influenza only</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">paste0</span>(<span class="fu">comma</span>(<span class="st">`</span><span class="at">count_Influenza</span><span class="st">`</span>), <span class="st">" ("</span>, <span class="st">`</span><span class="at">proportion_Influenza</span><span class="st">`</span>, <span class="st">")"</span>),</span>
<span id="cb35-46"><a href="#cb35-46" aria-hidden="true" tabindex="-1"></a>      <span class="at">No =</span> <span class="fu">paste0</span>(<span class="fu">comma</span>(<span class="st">`</span><span class="at">count_No</span><span class="st">`</span>), <span class="st">" ("</span>, <span class="st">`</span><span class="at">proportion_No</span><span class="st">`</span>, <span class="st">")"</span>),</span>
<span id="cb35-47"><a href="#cb35-47" aria-hidden="true" tabindex="-1"></a>      <span class="at">Variable =</span> group_label</span>
<span id="cb35-48"><a href="#cb35-48" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span></span>
<span id="cb35-49"><a href="#cb35-49" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(value, Both, <span class="st">`</span><span class="at">Influenza only</span><span class="st">`</span>, No, Variable)</span>
<span id="cb35-50"><a href="#cb35-50" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb35-51"><a href="#cb35-51" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(df_wide)</span>
<span id="cb35-52"><a href="#cb35-52" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb35-53"><a href="#cb35-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-54"><a href="#cb35-54" aria-hidden="true" tabindex="-1"></a><span class="co"># Run for selected grouping variables</span></span>
<span id="cb35-55"><a href="#cb35-55" aria-hidden="true" tabindex="-1"></a>df_year <span class="ot">&lt;-</span> <span class="fu">process_variable</span>(vacc_1524, <span class="st">"vacc_service_year"</span>, <span class="st">"Service year"</span>)</span>
<span id="cb35-56"><a href="#cb35-56" aria-hidden="true" tabindex="-1"></a>df_age <span class="ot">&lt;-</span> <span class="fu">process_variable</span>(vacc_1524, <span class="st">"age_group"</span>, <span class="st">"Age group"</span>)</span>
<span id="cb35-57"><a href="#cb35-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-58"><a href="#cb35-58" aria-hidden="true" tabindex="-1"></a><span class="co"># Combine and format for flextable</span></span>
<span id="cb35-59"><a href="#cb35-59" aria-hidden="true" tabindex="-1"></a>df_combined_long <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(df_year, df_age) <span class="sc">%&gt;%</span></span>
<span id="cb35-60"><a href="#cb35-60" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">Value =</span> value) <span class="sc">%&gt;%</span></span>
<span id="cb35-61"><a href="#cb35-61" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Variable, Value, Both, <span class="st">`</span><span class="at">Influenza only</span><span class="st">`</span>, No) <span class="sc">%&gt;%</span></span>
<span id="cb35-62"><a href="#cb35-62" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Variable) <span class="sc">%&gt;%</span></span>
<span id="cb35-63"><a href="#cb35-63" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Variable =</span> <span class="fu">ifelse</span>(<span class="fu">row_number</span>() <span class="sc">==</span> <span class="dv">1</span>, Variable, <span class="st">""</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb35-64"><a href="#cb35-64" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb35-65"><a href="#cb35-65" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-66"><a href="#cb35-66" aria-hidden="true" tabindex="-1"></a><span class="co"># Create flextable</span></span>
<span id="cb35-67"><a href="#cb35-67" aria-hidden="true" tabindex="-1"></a>final_table <span class="ot">&lt;-</span> <span class="fu">flextable</span>(df_combined_long) <span class="sc">%&gt;%</span></span>
<span id="cb35-68"><a href="#cb35-68" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_header_labels</span>(</span>
<span id="cb35-69"><a href="#cb35-69" aria-hidden="true" tabindex="-1"></a>    <span class="at">Variable =</span> <span class="st">"Variable"</span>,</span>
<span id="cb35-70"><a href="#cb35-70" aria-hidden="true" tabindex="-1"></a>    <span class="at">Value =</span> <span class="st">"Value"</span>,</span>
<span id="cb35-71"><a href="#cb35-71" aria-hidden="true" tabindex="-1"></a>    <span class="at">Both =</span> <span class="st">"Both (%)"</span>,</span>
<span id="cb35-72"><a href="#cb35-72" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">Influenza only</span><span class="st">`</span> <span class="ot">=</span> <span class="st">"Influenza (%)"</span>,</span>
<span id="cb35-73"><a href="#cb35-73" aria-hidden="true" tabindex="-1"></a>    <span class="at">No =</span> <span class="st">"No (%)"</span></span>
<span id="cb35-74"><a href="#cb35-74" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb35-75"><a href="#cb35-75" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_header_row</span>(</span>
<span id="cb35-76"><a href="#cb35-76" aria-hidden="true" tabindex="-1"></a>    <span class="at">values =</span> <span class="fu">c</span>(<span class="st">" "</span>, <span class="st">" "</span>, <span class="st">"Vaccination pattern·µÉ"</span>),</span>
<span id="cb35-77"><a href="#cb35-77" aria-hidden="true" tabindex="-1"></a>    <span class="at">colwidths =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">3</span>)</span>
<span id="cb35-78"><a href="#cb35-78" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb35-79"><a href="#cb35-79" aria-hidden="true" tabindex="-1"></a>  <span class="fu">align</span>(<span class="at">align =</span> <span class="st">"justify"</span>, <span class="at">part =</span> <span class="st">"all"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb35-80"><a href="#cb35-80" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bold</span>(<span class="at">part =</span> <span class="st">"header"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb35-81"><a href="#cb35-81" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bold</span>(<span class="at">i =</span> <span class="dv">1</span>, <span class="at">part =</span> <span class="st">"body"</span>, <span class="at">j =</span> <span class="st">"Variable"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb35-82"><a href="#cb35-82" aria-hidden="true" tabindex="-1"></a> <span class="fu">border_remove</span>() <span class="sc">%&gt;%</span></span>
<span id="cb35-83"><a href="#cb35-83" aria-hidden="true" tabindex="-1"></a>  <span class="fu">border_inner_h</span>(<span class="at">border =</span> <span class="fu">fp_border</span>(<span class="at">color =</span> <span class="st">"black"</span>, <span class="at">width =</span> <span class="dv">1</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb35-84"><a href="#cb35-84" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb35-85"><a href="#cb35-85" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_header_lines</span>(<span class="at">values =</span> <span class="st">"Table xx: Vaccination uptake pattern, 2015‚Äì2024."</span>) <span class="sc">%&gt;%</span></span>
<span id="cb35-86"><a href="#cb35-86" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_footer_lines</span>(<span class="at">values =</span> <span class="fu">c</span>(</span>
<span id="cb35-87"><a href="#cb35-87" aria-hidden="true" tabindex="-1"></a>    <span class="st">"·µÉ The pattern reflects those with influenza vaccination history, influenza, or both."</span></span>
<span id="cb35-88"><a href="#cb35-88" aria-hidden="true" tabindex="-1"></a>  ))</span>
<span id="cb35-89"><a href="#cb35-89" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-90"><a href="#cb35-90" aria-hidden="true" tabindex="-1"></a><span class="co"># Display table</span></span>
<span id="cb35-91"><a href="#cb35-91" aria-hidden="true" tabindex="-1"></a>final_table</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="tabwid"><style>.cl-fe9176ec{}.cl-fe899fa8{font-family:'Arial';font-size:11pt;font-weight:bold;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-fe899fb2{font-family:'Arial';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-fe8cc1c4{margin:0;text-align:justify;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-fe8cc1ce{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-fe8ce154{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-fe8ce15e{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1pt solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-fe8ce15f{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1pt solid rgba(0, 0, 0, 1.00);border-top: 1pt solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-fe8ce168{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 1pt solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-fe8ce169{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(255, 255, 255, 0.00);border-top: 0 solid rgba(255, 255, 255, 0.00);border-left: 0 solid rgba(255, 255, 255, 0.00);border-right: 0 solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table data-quarto-disable-processing="true" class="cl-fe9176ec"><thead><tr style="overflow-wrap:break-word;"><th colspan="5" class="cl-fe8ce154"><p class="cl-fe8cc1c4"><span class="cl-fe899fa8">Table xx: Vaccination uptake pattern, 2015‚Äì2024.</span></p></th></tr><tr style="overflow-wrap:break-word;"><th class="cl-fe8ce154"><p class="cl-fe8cc1c4"><span class="cl-fe899fa8"> </span></p></th><th class="cl-fe8ce154"><p class="cl-fe8cc1c4"><span class="cl-fe899fa8"> </span></p></th><th colspan="3" class="cl-fe8ce154"><p class="cl-fe8cc1c4"><span class="cl-fe899fa8">Vaccination pattern·µÉ</span></p></th></tr><tr style="overflow-wrap:break-word;"><th class="cl-fe8ce154"><p class="cl-fe8cc1c4"><span class="cl-fe899fa8">Variable</span></p></th><th class="cl-fe8ce154"><p class="cl-fe8cc1c4"><span class="cl-fe899fa8">Value</span></p></th><th class="cl-fe8ce154"><p class="cl-fe8cc1c4"><span class="cl-fe899fa8">Both (%)</span></p></th><th class="cl-fe8ce154"><p class="cl-fe8cc1c4"><span class="cl-fe899fa8">Influenza (%)</span></p></th><th class="cl-fe8ce154"><p class="cl-fe8cc1c4"><span class="cl-fe899fa8">No (%)</span></p></th></tr></thead><tbody><tr style="overflow-wrap:break-word;"><td class="cl-fe8ce15e"><p class="cl-fe8cc1c4"><span class="cl-fe899fa8">Service year</span></p></td><td class="cl-fe8ce15e"><p class="cl-fe8cc1c4"><span class="cl-fe899fb2">2015</span></p></td><td class="cl-fe8ce15e"><p class="cl-fe8cc1c4"><span class="cl-fe899fb2">8 (5.2)</span></p></td><td class="cl-fe8ce15e"><p class="cl-fe8cc1c4"><span class="cl-fe899fb2">27 (17.6)</span></p></td><td class="cl-fe8ce15e"><p class="cl-fe8cc1c4"><span class="cl-fe899fb2">110 (71.9)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-fe8ce15f"><p class="cl-fe8cc1c4"><span class="cl-fe899fb2"></span></p></td><td class="cl-fe8ce15f"><p class="cl-fe8cc1c4"><span class="cl-fe899fb2">2016</span></p></td><td class="cl-fe8ce15f"><p class="cl-fe8cc1c4"><span class="cl-fe899fb2">52 (37.4)</span></p></td><td class="cl-fe8ce15f"><p class="cl-fe8cc1c4"><span class="cl-fe899fb2">81 (58.3)</span></p></td><td class="cl-fe8ce15f"><p class="cl-fe8cc1c4"><span class="cl-fe899fb2">36 (25.9)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-fe8ce15f"><p class="cl-fe8cc1c4"><span class="cl-fe899fb2"></span></p></td><td class="cl-fe8ce15f"><p class="cl-fe8cc1c4"><span class="cl-fe899fb2">2017</span></p></td><td class="cl-fe8ce15f"><p class="cl-fe8cc1c4"><span class="cl-fe899fb2">41 (29.9)</span></p></td><td class="cl-fe8ce15f"><p class="cl-fe8cc1c4"><span class="cl-fe899fb2">74 (54)</span></p></td><td class="cl-fe8ce15f"><p class="cl-fe8cc1c4"><span class="cl-fe899fb2">34 (24.8)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-fe8ce15f"><p class="cl-fe8cc1c4"><span class="cl-fe899fb2"></span></p></td><td class="cl-fe8ce15f"><p class="cl-fe8cc1c4"><span class="cl-fe899fb2">2018</span></p></td><td class="cl-fe8ce15f"><p class="cl-fe8cc1c4"><span class="cl-fe899fb2">50 (33.1)</span></p></td><td class="cl-fe8ce15f"><p class="cl-fe8cc1c4"><span class="cl-fe899fb2">73 (48.3)</span></p></td><td class="cl-fe8ce15f"><p class="cl-fe8cc1c4"><span class="cl-fe899fb2">47 (31.1)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-fe8ce15f"><p class="cl-fe8cc1c4"><span class="cl-fe899fb2"></span></p></td><td class="cl-fe8ce15f"><p class="cl-fe8cc1c4"><span class="cl-fe899fb2">2019</span></p></td><td class="cl-fe8ce15f"><p class="cl-fe8cc1c4"><span class="cl-fe899fb2">53 (32.9)</span></p></td><td class="cl-fe8ce15f"><p class="cl-fe8cc1c4"><span class="cl-fe899fb2">85 (52.8)</span></p></td><td class="cl-fe8ce15f"><p class="cl-fe8cc1c4"><span class="cl-fe899fb2">46 (28.6)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-fe8ce15f"><p class="cl-fe8cc1c4"><span class="cl-fe899fb2"></span></p></td><td class="cl-fe8ce15f"><p class="cl-fe8cc1c4"><span class="cl-fe899fb2">2020</span></p></td><td class="cl-fe8ce15f"><p class="cl-fe8cc1c4"><span class="cl-fe899fb2">53 (38.7)</span></p></td><td class="cl-fe8ce15f"><p class="cl-fe8cc1c4"><span class="cl-fe899fb2">82 (59.9)</span></p></td><td class="cl-fe8ce15f"><p class="cl-fe8cc1c4"><span class="cl-fe899fb2">26 (19)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-fe8ce15f"><p class="cl-fe8cc1c4"><span class="cl-fe899fb2"></span></p></td><td class="cl-fe8ce15f"><p class="cl-fe8cc1c4"><span class="cl-fe899fb2">2021</span></p></td><td class="cl-fe8ce15f"><p class="cl-fe8cc1c4"><span class="cl-fe899fb2">27 (10.3)</span></p></td><td class="cl-fe8ce15f"><p class="cl-fe8cc1c4"><span class="cl-fe899fb2">109 (41.4)</span></p></td><td class="cl-fe8ce15f"><p class="cl-fe8cc1c4"><span class="cl-fe899fb2">96 (36.5)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-fe8ce15f"><p class="cl-fe8cc1c4"><span class="cl-fe899fb2"></span></p></td><td class="cl-fe8ce15f"><p class="cl-fe8cc1c4"><span class="cl-fe899fb2">2022</span></p></td><td class="cl-fe8ce15f"><p class="cl-fe8cc1c4"><span class="cl-fe899fb2">39 (32.5)</span></p></td><td class="cl-fe8ce15f"><p class="cl-fe8cc1c4"><span class="cl-fe899fb2">57 (47.5)</span></p></td><td class="cl-fe8ce15f"><p class="cl-fe8cc1c4"><span class="cl-fe899fb2">16 (13.3)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-fe8ce15f"><p class="cl-fe8cc1c4"><span class="cl-fe899fb2"></span></p></td><td class="cl-fe8ce15f"><p class="cl-fe8cc1c4"><span class="cl-fe899fb2">2023</span></p></td><td class="cl-fe8ce15f"><p class="cl-fe8cc1c4"><span class="cl-fe899fb2">57 (33.5)</span></p></td><td class="cl-fe8ce15f"><p class="cl-fe8cc1c4"><span class="cl-fe899fb2">86 (50.6)</span></p></td><td class="cl-fe8ce15f"><p class="cl-fe8cc1c4"><span class="cl-fe899fb2">56 (32.9)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-fe8ce15f"><p class="cl-fe8cc1c4"><span class="cl-fe899fb2"></span></p></td><td class="cl-fe8ce15f"><p class="cl-fe8cc1c4"><span class="cl-fe899fb2">2024</span></p></td><td class="cl-fe8ce15f"><p class="cl-fe8cc1c4"><span class="cl-fe899fb2">46 (37.7)</span></p></td><td class="cl-fe8ce15f"><p class="cl-fe8cc1c4"><span class="cl-fe899fb2">73 (59.8)</span></p></td><td class="cl-fe8ce15f"><p class="cl-fe8cc1c4"><span class="cl-fe899fb2">23 (18.9)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-fe8ce15f"><p class="cl-fe8cc1c4"><span class="cl-fe899fb2">Age group</span></p></td><td class="cl-fe8ce15f"><p class="cl-fe8cc1c4"><span class="cl-fe899fb2">0-19</span></p></td><td class="cl-fe8ce15f"><p class="cl-fe8cc1c4"><span class="cl-fe899fb2">99 (15.4)</span></p></td><td class="cl-fe8ce15f"><p class="cl-fe8cc1c4"><span class="cl-fe899fb2">214 (33.3)</span></p></td><td class="cl-fe8ce15f"><p class="cl-fe8cc1c4"><span class="cl-fe899fb2">308 (48)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-fe8ce15f"><p class="cl-fe8cc1c4"><span class="cl-fe899fb2"></span></p></td><td class="cl-fe8ce15f"><p class="cl-fe8cc1c4"><span class="cl-fe899fb2">20-29</span></p></td><td class="cl-fe8ce15f"><p class="cl-fe8cc1c4"><span class="cl-fe899fb2">53 (24.1)</span></p></td><td class="cl-fe8ce15f"><p class="cl-fe8cc1c4"><span class="cl-fe899fb2">110 (50)</span></p></td><td class="cl-fe8ce15f"><p class="cl-fe8cc1c4"><span class="cl-fe899fb2">51 (23.2)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-fe8ce15f"><p class="cl-fe8cc1c4"><span class="cl-fe899fb2"></span></p></td><td class="cl-fe8ce15f"><p class="cl-fe8cc1c4"><span class="cl-fe899fb2">30-39</span></p></td><td class="cl-fe8ce15f"><p class="cl-fe8cc1c4"><span class="cl-fe899fb2">11 (16.7)</span></p></td><td class="cl-fe8ce15f"><p class="cl-fe8cc1c4"><span class="cl-fe899fb2">28 (42.4)</span></p></td><td class="cl-fe8ce15f"><p class="cl-fe8cc1c4"><span class="cl-fe899fb2">24 (36.4)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-fe8ce15f"><p class="cl-fe8cc1c4"><span class="cl-fe899fb2"></span></p></td><td class="cl-fe8ce15f"><p class="cl-fe8cc1c4"><span class="cl-fe899fb2">40-49</span></p></td><td class="cl-fe8ce15f"><p class="cl-fe8cc1c4"><span class="cl-fe899fb2">64 (34.2)</span></p></td><td class="cl-fe8ce15f"><p class="cl-fe8cc1c4"><span class="cl-fe899fb2">108 (57.8)</span></p></td><td class="cl-fe8ce15f"><p class="cl-fe8cc1c4"><span class="cl-fe899fb2">40 (21.4)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-fe8ce15f"><p class="cl-fe8cc1c4"><span class="cl-fe899fb2"></span></p></td><td class="cl-fe8ce15f"><p class="cl-fe8cc1c4"><span class="cl-fe899fb2">50-59</span></p></td><td class="cl-fe8ce15f"><p class="cl-fe8cc1c4"><span class="cl-fe899fb2">50 (34.7)</span></p></td><td class="cl-fe8ce15f"><p class="cl-fe8cc1c4"><span class="cl-fe899fb2">85 (59)</span></p></td><td class="cl-fe8ce15f"><p class="cl-fe8cc1c4"><span class="cl-fe899fb2">25 (17.4)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-fe8ce15f"><p class="cl-fe8cc1c4"><span class="cl-fe899fb2"></span></p></td><td class="cl-fe8ce15f"><p class="cl-fe8cc1c4"><span class="cl-fe899fb2">60-69</span></p></td><td class="cl-fe8ce15f"><p class="cl-fe8cc1c4"><span class="cl-fe899fb2">92 (54.1)</span></p></td><td class="cl-fe8ce15f"><p class="cl-fe8cc1c4"><span class="cl-fe899fb2">120 (70.6)</span></p></td><td class="cl-fe8ce15f"><p class="cl-fe8cc1c4"><span class="cl-fe899fb2">24 (14.1)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-fe8ce168"><p class="cl-fe8cc1c4"><span class="cl-fe899fb2"></span></p></td><td class="cl-fe8ce168"><p class="cl-fe8cc1c4"><span class="cl-fe899fb2">70+</span></p></td><td class="cl-fe8ce168"><p class="cl-fe8cc1c4"><span class="cl-fe899fb2">57 (46)</span></p></td><td class="cl-fe8ce168"><p class="cl-fe8cc1c4"><span class="cl-fe899fb2">82 (66.1)</span></p></td><td class="cl-fe8ce168"><p class="cl-fe8cc1c4"><span class="cl-fe899fb2">18 (14.5)</span></p></td></tr></tbody><tfoot><tr style="overflow-wrap:break-word;"><td colspan="5" class="cl-fe8ce169"><p class="cl-fe8cc1ce"><span class="cl-fe899fb2">·µÉ The pattern reflects those with influenza vaccination history, influenza, or both.</span></p></td></tr></tfoot></table></div>
</div>
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="co"># .................. Clean up ..................</span></span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(df_year, df_age, df_combined_long, process_variable, final_table)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="multiple-response-tables-columnwise-percentages" class="level2" data-number="1.14">
<h2 data-number="1.14" class="anchored" data-anchor-id="multiple-response-tables-columnwise-percentages"><span class="header-section-number">1.14</span> <strong>14. Multiple Response Tables ‚Äì Columnwise Percentages</strong></h2>
<p>Similar to the rowwise example, this version presents the <strong>column percentages</strong> of multiple responses.</p>
<p>üßæ <em>Key advantage</em>: Allows side-by-side comparison of proportions within each vaccine group across multiple demographics.</p>
<p>üíº <em>Common in</em>: Survey analysis, patient preference studies, behavioral research.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ------------ 11. Mutiple Response Tables: via appending: Columnwise -------------------------------------------</span></span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a><span class="co"># .................. Convert grouping vars to character ..................</span></span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a>vacc_1524 <span class="ot">&lt;-</span> vacc_1524 <span class="sc">%&gt;%</span></span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">c</span>(age_group, gender, marital_status,</span>
<span id="cb37-6"><a href="#cb37-6" aria-hidden="true" tabindex="-1"></a>                  vacc_service_year, vacc_quarter, vacc_weekday), as.character))</span>
<span id="cb37-7"><a href="#cb37-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-8"><a href="#cb37-8" aria-hidden="true" tabindex="-1"></a><span class="co"># .................. Table generation function (column-wise %) ..................</span></span>
<span id="cb37-9"><a href="#cb37-9" aria-hidden="true" tabindex="-1"></a>create_tab <span class="ot">&lt;-</span> <span class="cf">function</span>(data, var, label) {</span>
<span id="cb37-10"><a href="#cb37-10" aria-hidden="true" tabindex="-1"></a>  tab_main <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span></span>
<span id="cb37-11"><a href="#cb37-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>({{ var }})) <span class="sc">%&gt;%</span></span>
<span id="cb37-12"><a href="#cb37-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tabyl</span>({{ var }}, vacc_group3) <span class="sc">%&gt;%</span></span>
<span id="cb37-13"><a href="#cb37-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">Category =</span> label, <span class="at">.before =</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb37-14"><a href="#cb37-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rename</span>(<span class="at">Label =</span> {{ var }}) <span class="sc">%&gt;%</span></span>
<span id="cb37-15"><a href="#cb37-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">Label =</span> <span class="fu">as.character</span>(Label))</span>
<span id="cb37-16"><a href="#cb37-16" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb37-17"><a href="#cb37-17" aria-hidden="true" tabindex="-1"></a>  na_count <span class="ot">&lt;-</span> <span class="fu">sum</span>(<span class="fu">is.na</span>(<span class="fu">pull</span>(data, {{ var }})))</span>
<span id="cb37-18"><a href="#cb37-18" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb37-19"><a href="#cb37-19" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (na_count <span class="sc">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb37-20"><a href="#cb37-20" aria-hidden="true" tabindex="-1"></a>    missing_row <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb37-21"><a href="#cb37-21" aria-hidden="true" tabindex="-1"></a>      <span class="at">Category =</span> label,</span>
<span id="cb37-22"><a href="#cb37-22" aria-hidden="true" tabindex="-1"></a>      <span class="at">Label =</span> <span class="st">"Missing"</span>,</span>
<span id="cb37-23"><a href="#cb37-23" aria-hidden="true" tabindex="-1"></a>      <span class="st">`</span><span class="at">Respiratory vaccines</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">sum</span>(data<span class="sc">$</span>vacc_group3 <span class="sc">==</span> <span class="st">"Respiratory vaccines"</span> <span class="sc">&amp;</span> <span class="fu">is.na</span>(<span class="fu">pull</span>(data, {{ var }})), <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb37-24"><a href="#cb37-24" aria-hidden="true" tabindex="-1"></a>      <span class="st">`</span><span class="at">Childhood vaccines</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">sum</span>(data<span class="sc">$</span>vacc_group3 <span class="sc">==</span> <span class="st">"Childhood vaccines"</span> <span class="sc">&amp;</span> <span class="fu">is.na</span>(<span class="fu">pull</span>(data, {{ var }})), <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb37-25"><a href="#cb37-25" aria-hidden="true" tabindex="-1"></a>      <span class="at">Other =</span> <span class="fu">sum</span>(data<span class="sc">$</span>vacc_group3 <span class="sc">==</span> <span class="st">"Other"</span> <span class="sc">&amp;</span> <span class="fu">is.na</span>(<span class="fu">pull</span>(data, {{ var }})), <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb37-26"><a href="#cb37-26" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb37-27"><a href="#cb37-27" aria-hidden="true" tabindex="-1"></a>    tab_final <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(tab_main, missing_row)</span>
<span id="cb37-28"><a href="#cb37-28" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb37-29"><a href="#cb37-29" aria-hidden="true" tabindex="-1"></a>    tab_final <span class="ot">&lt;-</span> tab_main</span>
<span id="cb37-30"><a href="#cb37-30" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb37-31"><a href="#cb37-31" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb37-32"><a href="#cb37-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(tab_final)</span>
<span id="cb37-33"><a href="#cb37-33" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb37-34"><a href="#cb37-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-35"><a href="#cb37-35" aria-hidden="true" tabindex="-1"></a><span class="co"># .................. Create summary tables ..................</span></span>
<span id="cb37-36"><a href="#cb37-36" aria-hidden="true" tabindex="-1"></a>tab_age            <span class="ot">&lt;-</span> <span class="fu">create_tab</span>(vacc_1524, age_group, <span class="st">"Age"</span>)</span>
<span id="cb37-37"><a href="#cb37-37" aria-hidden="true" tabindex="-1"></a>tab_sex            <span class="ot">&lt;-</span> <span class="fu">create_tab</span>(vacc_1524, gender, <span class="st">"Gender"</span>)</span>
<span id="cb37-38"><a href="#cb37-38" aria-hidden="true" tabindex="-1"></a>tab_marital_status <span class="ot">&lt;-</span> <span class="fu">create_tab</span>(vacc_1524, marital_status, <span class="st">"Marital status"</span>)</span>
<span id="cb37-39"><a href="#cb37-39" aria-hidden="true" tabindex="-1"></a>tab_year           <span class="ot">&lt;-</span> <span class="fu">create_tab</span>(vacc_1524, vacc_service_year, <span class="st">"Year"</span>)</span>
<span id="cb37-40"><a href="#cb37-40" aria-hidden="true" tabindex="-1"></a>tab_quarter        <span class="ot">&lt;-</span> <span class="fu">create_tab</span>(vacc_1524, vacc_quarter, <span class="st">"Quarter"</span>)</span>
<span id="cb37-41"><a href="#cb37-41" aria-hidden="true" tabindex="-1"></a>tab_weekday        <span class="ot">&lt;-</span> <span class="fu">create_tab</span>(vacc_1524, vacc_weekday, <span class="st">"Weekday"</span>)</span>
<span id="cb37-42"><a href="#cb37-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-43"><a href="#cb37-43" aria-hidden="true" tabindex="-1"></a><span class="co"># .................. Combine all tables ..................</span></span>
<span id="cb37-44"><a href="#cb37-44" aria-hidden="true" tabindex="-1"></a>tab_combined <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(tab_sex, tab_age, tab_marital_status, tab_year, tab_quarter, tab_weekday)</span>
<span id="cb37-45"><a href="#cb37-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-46"><a href="#cb37-46" aria-hidden="true" tabindex="-1"></a><span class="co"># .................. Calculate column-wise percentages within each Category group ..................</span></span>
<span id="cb37-47"><a href="#cb37-47" aria-hidden="true" tabindex="-1"></a>tab_combined <span class="ot">&lt;-</span> tab_combined <span class="sc">%&gt;%</span></span>
<span id="cb37-48"><a href="#cb37-48" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Category) <span class="sc">%&gt;%</span></span>
<span id="cb37-49"><a href="#cb37-49" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb37-50"><a href="#cb37-50" aria-hidden="true" tabindex="-1"></a>    <span class="at">Total_Resp =</span> <span class="fu">sum</span>(<span class="st">`</span><span class="at">Respiratory vaccines</span><span class="st">`</span>[Label <span class="sc">!=</span> <span class="st">"Missing"</span>], <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb37-51"><a href="#cb37-51" aria-hidden="true" tabindex="-1"></a>    <span class="at">Total_Child =</span> <span class="fu">sum</span>(<span class="st">`</span><span class="at">Childhood vaccines</span><span class="st">`</span>[Label <span class="sc">!=</span> <span class="st">"Missing"</span>], <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb37-52"><a href="#cb37-52" aria-hidden="true" tabindex="-1"></a>    <span class="at">Total_Other =</span> <span class="fu">sum</span>(Other[Label <span class="sc">!=</span> <span class="st">"Missing"</span>], <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb37-53"><a href="#cb37-53" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb37-54"><a href="#cb37-54" aria-hidden="true" tabindex="-1"></a>    <span class="at">is_missing =</span> <span class="fu">trimws</span>(<span class="fu">tolower</span>(Label)) <span class="sc">==</span> <span class="st">"missing"</span>,</span>
<span id="cb37-55"><a href="#cb37-55" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb37-56"><a href="#cb37-56" aria-hidden="true" tabindex="-1"></a>    <span class="at">Respiratory =</span> <span class="fu">ifelse</span>(is_missing,</span>
<span id="cb37-57"><a href="#cb37-57" aria-hidden="true" tabindex="-1"></a>                         <span class="fu">comma</span>(<span class="st">`</span><span class="at">Respiratory vaccines</span><span class="st">`</span>),</span>
<span id="cb37-58"><a href="#cb37-58" aria-hidden="true" tabindex="-1"></a>                         <span class="fu">paste0</span>(<span class="fu">comma</span>(<span class="st">`</span><span class="at">Respiratory vaccines</span><span class="st">`</span>), <span class="st">" ("</span>, <span class="fu">round</span>(<span class="dv">100</span> <span class="sc">*</span> <span class="st">`</span><span class="at">Respiratory vaccines</span><span class="st">`</span> <span class="sc">/</span> Total_Resp, <span class="dv">1</span>), <span class="st">"%)"</span>)),</span>
<span id="cb37-59"><a href="#cb37-59" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb37-60"><a href="#cb37-60" aria-hidden="true" tabindex="-1"></a>    <span class="at">Childhood =</span> <span class="fu">ifelse</span>(is_missing,</span>
<span id="cb37-61"><a href="#cb37-61" aria-hidden="true" tabindex="-1"></a>                       <span class="fu">comma</span>(<span class="st">`</span><span class="at">Childhood vaccines</span><span class="st">`</span>),</span>
<span id="cb37-62"><a href="#cb37-62" aria-hidden="true" tabindex="-1"></a>                       <span class="fu">paste0</span>(<span class="fu">comma</span>(<span class="st">`</span><span class="at">Childhood vaccines</span><span class="st">`</span>), <span class="st">" ("</span>, <span class="fu">round</span>(<span class="dv">100</span> <span class="sc">*</span> <span class="st">`</span><span class="at">Childhood vaccines</span><span class="st">`</span> <span class="sc">/</span> Total_Child, <span class="dv">1</span>), <span class="st">"%)"</span>)),</span>
<span id="cb37-63"><a href="#cb37-63" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb37-64"><a href="#cb37-64" aria-hidden="true" tabindex="-1"></a>    <span class="at">Other_grp =</span> <span class="fu">ifelse</span>(is_missing,</span>
<span id="cb37-65"><a href="#cb37-65" aria-hidden="true" tabindex="-1"></a>                       <span class="fu">comma</span>(Other),</span>
<span id="cb37-66"><a href="#cb37-66" aria-hidden="true" tabindex="-1"></a>                       <span class="fu">paste0</span>(<span class="fu">comma</span>(Other), <span class="st">" ("</span>, <span class="fu">round</span>(<span class="dv">100</span> <span class="sc">*</span> Other <span class="sc">/</span> Total_Other, <span class="dv">1</span>), <span class="st">"%)"</span>))</span>
<span id="cb37-67"><a href="#cb37-67" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb37-68"><a href="#cb37-68" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb37-69"><a href="#cb37-69" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Category, Label, Respiratory, Childhood, Other_grp)</span>
<span id="cb37-70"><a href="#cb37-70" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-71"><a href="#cb37-71" aria-hidden="true" tabindex="-1"></a><span class="co"># .................. Show Category only once per group ..................</span></span>
<span id="cb37-72"><a href="#cb37-72" aria-hidden="true" tabindex="-1"></a>tab_combined <span class="ot">&lt;-</span> tab_combined <span class="sc">%&gt;%</span></span>
<span id="cb37-73"><a href="#cb37-73" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Category) <span class="sc">%&gt;%</span></span>
<span id="cb37-74"><a href="#cb37-74" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Category =</span> <span class="fu">ifelse</span>(<span class="fu">row_number</span>() <span class="sc">==</span> <span class="dv">1</span>, Category, <span class="st">""</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb37-75"><a href="#cb37-75" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb37-76"><a href="#cb37-76" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-77"><a href="#cb37-77" aria-hidden="true" tabindex="-1"></a><span class="co"># .................. Get total counts per vaccine group ..................</span></span>
<span id="cb37-78"><a href="#cb37-78" aria-hidden="true" tabindex="-1"></a>totals <span class="ot">&lt;-</span> vacc_1524 <span class="sc">%&gt;%</span></span>
<span id="cb37-79"><a href="#cb37-79" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(vacc_group3) <span class="sc">%&gt;%</span></span>
<span id="cb37-80"><a href="#cb37-80" aria-hidden="true" tabindex="-1"></a>  <span class="fu">deframe</span>()</span>
<span id="cb37-81"><a href="#cb37-81" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-82"><a href="#cb37-82" aria-hidden="true" tabindex="-1"></a><span class="co"># .................. Create flextable ..................</span></span>
<span id="cb37-83"><a href="#cb37-83" aria-hidden="true" tabindex="-1"></a>ft_vacc_summary <span class="ot">&lt;-</span> tab_combined <span class="sc">%&gt;%</span></span>
<span id="cb37-84"><a href="#cb37-84" aria-hidden="true" tabindex="-1"></a>  <span class="fu">flextable</span>() <span class="sc">%&gt;%</span></span>
<span id="cb37-85"><a href="#cb37-85" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_header_labels</span>(</span>
<span id="cb37-86"><a href="#cb37-86" aria-hidden="true" tabindex="-1"></a>    <span class="at">Category =</span> <span class="st">"Variable type"</span>,</span>
<span id="cb37-87"><a href="#cb37-87" aria-hidden="true" tabindex="-1"></a>    <span class="at">Label =</span> <span class="st">"Values"</span>,</span>
<span id="cb37-88"><a href="#cb37-88" aria-hidden="true" tabindex="-1"></a>    <span class="at">Respiratory =</span> <span class="st">"Number (%)·µÉ"</span>,</span>
<span id="cb37-89"><a href="#cb37-89" aria-hidden="true" tabindex="-1"></a>    <span class="at">Childhood =</span> <span class="st">"Number (%)·µÉ"</span>,</span>
<span id="cb37-90"><a href="#cb37-90" aria-hidden="true" tabindex="-1"></a>    <span class="at">Other_grp =</span> <span class="st">"Number (%)·µÉ"</span></span>
<span id="cb37-91"><a href="#cb37-91" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb37-92"><a href="#cb37-92" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_header_row</span>(</span>
<span id="cb37-93"><a href="#cb37-93" aria-hidden="true" tabindex="-1"></a>    <span class="at">values =</span> <span class="fu">c</span>(</span>
<span id="cb37-94"><a href="#cb37-94" aria-hidden="true" tabindex="-1"></a>      <span class="st">""</span>, <span class="st">""</span>,</span>
<span id="cb37-95"><a href="#cb37-95" aria-hidden="true" tabindex="-1"></a>      <span class="fu">paste0</span>(<span class="st">"Respiratory vaccines (N = "</span>, <span class="fu">format</span>(totals[<span class="st">"Respiratory vaccines"</span>], <span class="at">big.mark =</span> <span class="st">","</span>), <span class="st">")"</span>),</span>
<span id="cb37-96"><a href="#cb37-96" aria-hidden="true" tabindex="-1"></a>      <span class="fu">paste0</span>(<span class="st">"Childhood vaccines (N = "</span>, <span class="fu">format</span>(totals[<span class="st">"Childhood vaccines"</span>], <span class="at">big.mark =</span> <span class="st">","</span>), <span class="st">")"</span>),</span>
<span id="cb37-97"><a href="#cb37-97" aria-hidden="true" tabindex="-1"></a>      <span class="fu">paste0</span>(<span class="st">"Other (N = "</span>, <span class="fu">format</span>(totals[<span class="st">"Other"</span>], <span class="at">big.mark =</span> <span class="st">","</span>), <span class="st">")"</span>)</span>
<span id="cb37-98"><a href="#cb37-98" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb37-99"><a href="#cb37-99" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb37-100"><a href="#cb37-100" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_header_row</span>(</span>
<span id="cb37-101"><a href="#cb37-101" aria-hidden="true" tabindex="-1"></a>    <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"Description"</span>, <span class="st">"Vaccination uptake"</span>),</span>
<span id="cb37-102"><a href="#cb37-102" aria-hidden="true" tabindex="-1"></a>    <span class="at">colwidths =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">3</span>)</span>
<span id="cb37-103"><a href="#cb37-103" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb37-104"><a href="#cb37-104" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_box</span>() <span class="sc">%&gt;%</span></span>
<span id="cb37-105"><a href="#cb37-105" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_table_properties</span>(<span class="at">layout =</span> <span class="st">"autofit"</span>, <span class="at">width =</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb37-106"><a href="#cb37-106" aria-hidden="true" tabindex="-1"></a>  <span class="fu">width</span>(<span class="at">j =</span> <span class="dv">1</span>, <span class="at">width =</span> <span class="fl">1.5</span>) <span class="sc">%&gt;%</span></span>
<span id="cb37-107"><a href="#cb37-107" aria-hidden="true" tabindex="-1"></a>  <span class="fu">width</span>(<span class="at">j =</span> <span class="dv">2</span>, <span class="at">width =</span> <span class="fl">2.5</span>) <span class="sc">%&gt;%</span></span>
<span id="cb37-108"><a href="#cb37-108" aria-hidden="true" tabindex="-1"></a>  <span class="fu">width</span>(<span class="at">j =</span> <span class="dv">3</span><span class="sc">:</span><span class="dv">5</span>, <span class="at">width =</span> <span class="fl">1.5</span>) <span class="sc">%&gt;%</span></span>
<span id="cb37-109"><a href="#cb37-109" aria-hidden="true" tabindex="-1"></a>  <span class="fu">align</span>(<span class="at">align =</span> <span class="st">"justify"</span>, <span class="at">part =</span> <span class="st">"all"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb37-110"><a href="#cb37-110" aria-hidden="true" tabindex="-1"></a>  <span class="fu">border_remove</span>() <span class="sc">%&gt;%</span></span>
<span id="cb37-111"><a href="#cb37-111" aria-hidden="true" tabindex="-1"></a>  <span class="fu">border_inner_h</span>(<span class="at">border =</span> <span class="fu">fp_border</span>(<span class="at">color =</span> <span class="st">"black"</span>, <span class="at">width =</span> <span class="dv">1</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb37-112"><a href="#cb37-112" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb37-113"><a href="#cb37-113" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_caption</span>(<span class="st">"Table: Vaccination uptake (column percentage) across service year, quarter, and weekday"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb37-114"><a href="#cb37-114" aria-hidden="true" tabindex="-1"></a>  <span class="fu">footnote</span>(<span class="at">i =</span> <span class="dv">1</span>, </span>
<span id="cb37-115"><a href="#cb37-115" aria-hidden="true" tabindex="-1"></a>           <span class="at">value =</span> <span class="fu">as_paragraph</span>(<span class="st">"Vaccination proportions were calculated column-wise (i.e., within each vaccine group)."</span>),</span>
<span id="cb37-116"><a href="#cb37-116" aria-hidden="true" tabindex="-1"></a>           <span class="at">ref_symbols =</span> <span class="st">"·µÉ"</span>, </span>
<span id="cb37-117"><a href="#cb37-117" aria-hidden="true" tabindex="-1"></a>           <span class="at">part =</span> <span class="st">"header"</span>)</span>
<span id="cb37-118"><a href="#cb37-118" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-119"><a href="#cb37-119" aria-hidden="true" tabindex="-1"></a><span class="co"># .................. Show the table ..................</span></span>
<span id="cb37-120"><a href="#cb37-120" aria-hidden="true" tabindex="-1"></a>ft_vacc_summary</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="tabwid"><style>.cl-fed0a862{table-layout:auto;width:100%;}.cl-fec741a0{font-family:'Arial';font-size:11pt;font-weight:bold;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-fec741aa{font-family:'Arial';font-size:6.6pt;font-weight:bold;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;position: relative;bottom:3.3pt;}.cl-fec741ab{font-family:'Arial';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-fec741b4{font-family:'Arial';font-size:6.6pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;position: relative;bottom:3.3pt;}.cl-fecac802{margin:0;text-align:justify;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-fecac80c{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-fecaee72{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-fecaee7c{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-fecaee7d{background-color:transparent;vertical-align: middle;border-bottom: 1pt solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-fecaee86{background-color:transparent;vertical-align: middle;border-bottom: 1pt solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-fecaee87{background-color:transparent;vertical-align: middle;border-bottom: 1pt solid rgba(0, 0, 0, 1.00);border-top: 1pt solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-fecaee88{background-color:transparent;vertical-align: middle;border-bottom: 1pt solid rgba(0, 0, 0, 1.00);border-top: 1pt solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-fecaee90{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 1pt solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-fecaee91{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 1pt solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-fecaee92{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(255, 255, 255, 0.00);border-top: 0 solid rgba(255, 255, 255, 0.00);border-left: 0 solid rgba(255, 255, 255, 0.00);border-right: 0 solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-fecaee9a{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(255, 255, 255, 0.00);border-top: 0 solid rgba(255, 255, 255, 0.00);border-left: 0 solid rgba(255, 255, 255, 0.00);border-right: 0 solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table data-quarto-disable-processing="true" class="cl-fed0a862"><thead><tr style="overflow-wrap:break-word;"><th colspan="2" class="cl-fecaee72"><p class="cl-fecac802"><span class="cl-fec741a0">Description</span><span class="cl-fec741aa">·µÉ</span></p></th><th colspan="3" class="cl-fecaee72"><p class="cl-fecac802"><span class="cl-fec741a0">Vaccination uptake</span><span class="cl-fec741aa">·µÉ</span></p></th></tr><tr style="overflow-wrap:break-word;"><th class="cl-fecaee72"><p class="cl-fecac802"><span class="cl-fec741a0"></span></p></th><th class="cl-fecaee7c"><p class="cl-fecac802"><span class="cl-fec741a0"></span></p></th><th class="cl-fecaee72"><p class="cl-fecac802"><span class="cl-fec741a0">Respiratory vaccines (N = 955)</span></p></th><th class="cl-fecaee72"><p class="cl-fecac802"><span class="cl-fec741a0">Childhood vaccines (N = 472)</span></p></th><th class="cl-fecaee72"><p class="cl-fecac802"><span class="cl-fec741a0">Other (N = 126)</span></p></th></tr><tr style="overflow-wrap:break-word;"><th class="cl-fecaee72"><p class="cl-fecac802"><span class="cl-fec741a0">Variable type</span></p></th><th class="cl-fecaee7c"><p class="cl-fecac802"><span class="cl-fec741a0">Values</span></p></th><th class="cl-fecaee72"><p class="cl-fecac802"><span class="cl-fec741a0">Number (%)·µÉ</span></p></th><th class="cl-fecaee72"><p class="cl-fecac802"><span class="cl-fec741a0">Number (%)·µÉ</span></p></th><th class="cl-fecaee72"><p class="cl-fecac802"><span class="cl-fec741a0">Number (%)·µÉ</span></p></th></tr></thead><tbody><tr style="overflow-wrap:break-word;"><td class="cl-fecaee7d"><p class="cl-fecac802"><span class="cl-fec741ab">Gender</span></p></td><td class="cl-fecaee86"><p class="cl-fecac802"><span class="cl-fec741ab">Female</span></p></td><td class="cl-fecaee7d"><p class="cl-fecac802"><span class="cl-fec741ab">511 (53.5%)</span></p></td><td class="cl-fecaee7d"><p class="cl-fecac802"><span class="cl-fec741ab">233 (49.4%)</span></p></td><td class="cl-fecaee7d"><p class="cl-fecac802"><span class="cl-fec741ab">54 (42.9%)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-fecaee87"><p class="cl-fecac802"><span class="cl-fec741ab"></span></p></td><td class="cl-fecaee88"><p class="cl-fecac802"><span class="cl-fec741ab">Male</span></p></td><td class="cl-fecaee87"><p class="cl-fecac802"><span class="cl-fec741ab">444 (46.5%)</span></p></td><td class="cl-fecaee87"><p class="cl-fecac802"><span class="cl-fec741ab">239 (50.6%)</span></p></td><td class="cl-fecaee87"><p class="cl-fecac802"><span class="cl-fec741ab">72 (57.1%)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-fecaee87"><p class="cl-fecac802"><span class="cl-fec741ab">Age</span></p></td><td class="cl-fecaee88"><p class="cl-fecac802"><span class="cl-fec741ab">0-19</span></p></td><td class="cl-fecaee87"><p class="cl-fecac802"><span class="cl-fec741ab">250 (26.2%)</span></p></td><td class="cl-fecaee87"><p class="cl-fecac802"><span class="cl-fec741ab">302 (64%)</span></p></td><td class="cl-fecaee87"><p class="cl-fecac802"><span class="cl-fec741ab">90 (71.4%)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-fecaee87"><p class="cl-fecac802"><span class="cl-fec741ab"></span></p></td><td class="cl-fecaee88"><p class="cl-fecac802"><span class="cl-fec741ab">20-29</span></p></td><td class="cl-fecaee87"><p class="cl-fecac802"><span class="cl-fec741ab">150 (15.7%)</span></p></td><td class="cl-fecaee87"><p class="cl-fecac802"><span class="cl-fec741ab">70 (14.8%)</span></p></td><td class="cl-fecaee87"><p class="cl-fecac802"><span class="cl-fec741ab">0 (0%)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-fecaee87"><p class="cl-fecac802"><span class="cl-fec741ab"></span></p></td><td class="cl-fecaee88"><p class="cl-fecac802"><span class="cl-fec741ab">30-39</span></p></td><td class="cl-fecaee87"><p class="cl-fecac802"><span class="cl-fec741ab">47 (4.9%)</span></p></td><td class="cl-fecaee87"><p class="cl-fecac802"><span class="cl-fec741ab">19 (4%)</span></p></td><td class="cl-fecaee87"><p class="cl-fecac802"><span class="cl-fec741ab">0 (0%)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-fecaee87"><p class="cl-fecac802"><span class="cl-fec741ab"></span></p></td><td class="cl-fecaee88"><p class="cl-fecac802"><span class="cl-fec741ab">40-49</span></p></td><td class="cl-fecaee87"><p class="cl-fecac802"><span class="cl-fec741ab">142 (14.9%)</span></p></td><td class="cl-fecaee87"><p class="cl-fecac802"><span class="cl-fec741ab">45 (9.5%)</span></p></td><td class="cl-fecaee87"><p class="cl-fecac802"><span class="cl-fec741ab">0 (0%)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-fecaee87"><p class="cl-fecac802"><span class="cl-fec741ab"></span></p></td><td class="cl-fecaee88"><p class="cl-fecac802"><span class="cl-fec741ab">50-59</span></p></td><td class="cl-fecaee87"><p class="cl-fecac802"><span class="cl-fec741ab">112 (11.7%)</span></p></td><td class="cl-fecaee87"><p class="cl-fecac802"><span class="cl-fec741ab">14 (3%)</span></p></td><td class="cl-fecaee87"><p class="cl-fecac802"><span class="cl-fec741ab">18 (14.3%)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-fecaee87"><p class="cl-fecac802"><span class="cl-fec741ab"></span></p></td><td class="cl-fecaee88"><p class="cl-fecac802"><span class="cl-fec741ab">60-69</span></p></td><td class="cl-fecaee87"><p class="cl-fecac802"><span class="cl-fec741ab">149 (15.6%)</span></p></td><td class="cl-fecaee87"><p class="cl-fecac802"><span class="cl-fec741ab">13 (2.8%)</span></p></td><td class="cl-fecaee87"><p class="cl-fecac802"><span class="cl-fec741ab">8 (6.3%)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-fecaee87"><p class="cl-fecac802"><span class="cl-fec741ab"></span></p></td><td class="cl-fecaee88"><p class="cl-fecac802"><span class="cl-fec741ab">70+</span></p></td><td class="cl-fecaee87"><p class="cl-fecac802"><span class="cl-fec741ab">105 (11%)</span></p></td><td class="cl-fecaee87"><p class="cl-fecac802"><span class="cl-fec741ab">9 (1.9%)</span></p></td><td class="cl-fecaee87"><p class="cl-fecac802"><span class="cl-fec741ab">10 (7.9%)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-fecaee87"><p class="cl-fecac802"><span class="cl-fec741ab">Marital status</span></p></td><td class="cl-fecaee88"><p class="cl-fecac802"><span class="cl-fec741ab">Divorced</span></p></td><td class="cl-fecaee87"><p class="cl-fecac802"><span class="cl-fec741ab">136 (23.7%)</span></p></td><td class="cl-fecaee87"><p class="cl-fecac802"><span class="cl-fec741ab">15 (14%)</span></p></td><td class="cl-fecaee87"><p class="cl-fecac802"><span class="cl-fec741ab">12 (33.3%)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-fecaee87"><p class="cl-fecac802"><span class="cl-fec741ab"></span></p></td><td class="cl-fecaee88"><p class="cl-fecac802"><span class="cl-fec741ab">Married</span></p></td><td class="cl-fecaee87"><p class="cl-fecac802"><span class="cl-fec741ab">289 (50.3%)</span></p></td><td class="cl-fecaee87"><p class="cl-fecac802"><span class="cl-fec741ab">59 (55.1%)</span></p></td><td class="cl-fecaee87"><p class="cl-fecac802"><span class="cl-fec741ab">18 (50%)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-fecaee87"><p class="cl-fecac802"><span class="cl-fec741ab"></span></p></td><td class="cl-fecaee88"><p class="cl-fecac802"><span class="cl-fec741ab">Single/widowed</span></p></td><td class="cl-fecaee87"><p class="cl-fecac802"><span class="cl-fec741ab">150 (26.1%)</span></p></td><td class="cl-fecaee87"><p class="cl-fecac802"><span class="cl-fec741ab">33 (30.8%)</span></p></td><td class="cl-fecaee87"><p class="cl-fecac802"><span class="cl-fec741ab">6 (16.7%)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-fecaee87"><p class="cl-fecac802"><span class="cl-fec741ab"></span></p></td><td class="cl-fecaee88"><p class="cl-fecac802"><span class="cl-fec741ab">Missing</span></p></td><td class="cl-fecaee87"><p class="cl-fecac802"><span class="cl-fec741ab">380</span></p></td><td class="cl-fecaee87"><p class="cl-fecac802"><span class="cl-fec741ab">365</span></p></td><td class="cl-fecaee87"><p class="cl-fecac802"><span class="cl-fec741ab">90</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-fecaee87"><p class="cl-fecac802"><span class="cl-fec741ab">Year</span></p></td><td class="cl-fecaee88"><p class="cl-fecac802"><span class="cl-fec741ab">2015</span></p></td><td class="cl-fecaee87"><p class="cl-fecac802"><span class="cl-fec741ab">78 (8.2%)</span></p></td><td class="cl-fecaee87"><p class="cl-fecac802"><span class="cl-fec741ab">56 (11.9%)</span></p></td><td class="cl-fecaee87"><p class="cl-fecac802"><span class="cl-fec741ab">19 (15.1%)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-fecaee87"><p class="cl-fecac802"><span class="cl-fec741ab"></span></p></td><td class="cl-fecaee88"><p class="cl-fecac802"><span class="cl-fec741ab">2016</span></p></td><td class="cl-fecaee87"><p class="cl-fecac802"><span class="cl-fec741ab">84 (8.8%)</span></p></td><td class="cl-fecaee87"><p class="cl-fecac802"><span class="cl-fec741ab">47 (10%)</span></p></td><td class="cl-fecaee87"><p class="cl-fecac802"><span class="cl-fec741ab">8 (6.3%)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-fecaee87"><p class="cl-fecac802"><span class="cl-fec741ab"></span></p></td><td class="cl-fecaee88"><p class="cl-fecac802"><span class="cl-fec741ab">2017</span></p></td><td class="cl-fecaee87"><p class="cl-fecac802"><span class="cl-fec741ab">75 (7.9%)</span></p></td><td class="cl-fecaee87"><p class="cl-fecac802"><span class="cl-fec741ab">52 (11%)</span></p></td><td class="cl-fecaee87"><p class="cl-fecac802"><span class="cl-fec741ab">10 (7.9%)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-fecaee87"><p class="cl-fecac802"><span class="cl-fec741ab"></span></p></td><td class="cl-fecaee88"><p class="cl-fecac802"><span class="cl-fec741ab">2018</span></p></td><td class="cl-fecaee87"><p class="cl-fecac802"><span class="cl-fec741ab">81 (8.5%)</span></p></td><td class="cl-fecaee87"><p class="cl-fecac802"><span class="cl-fec741ab">52 (11%)</span></p></td><td class="cl-fecaee87"><p class="cl-fecac802"><span class="cl-fec741ab">18 (14.3%)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-fecaee87"><p class="cl-fecac802"><span class="cl-fec741ab"></span></p></td><td class="cl-fecaee88"><p class="cl-fecac802"><span class="cl-fec741ab">2019</span></p></td><td class="cl-fecaee87"><p class="cl-fecac802"><span class="cl-fec741ab">83 (8.7%)</span></p></td><td class="cl-fecaee87"><p class="cl-fecac802"><span class="cl-fec741ab">60 (12.7%)</span></p></td><td class="cl-fecaee87"><p class="cl-fecac802"><span class="cl-fec741ab">18 (14.3%)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-fecaee87"><p class="cl-fecac802"><span class="cl-fec741ab"></span></p></td><td class="cl-fecaee88"><p class="cl-fecac802"><span class="cl-fec741ab">2020</span></p></td><td class="cl-fecaee87"><p class="cl-fecac802"><span class="cl-fec741ab">82 (8.6%)</span></p></td><td class="cl-fecaee87"><p class="cl-fecac802"><span class="cl-fec741ab">44 (9.3%)</span></p></td><td class="cl-fecaee87"><p class="cl-fecac802"><span class="cl-fec741ab">11 (8.7%)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-fecaee87"><p class="cl-fecac802"><span class="cl-fec741ab"></span></p></td><td class="cl-fecaee88"><p class="cl-fecac802"><span class="cl-fec741ab">2021</span></p></td><td class="cl-fecaee87"><p class="cl-fecac802"><span class="cl-fec741ab">223 (23.4%)</span></p></td><td class="cl-fecaee87"><p class="cl-fecac802"><span class="cl-fec741ab">34 (7.2%)</span></p></td><td class="cl-fecaee87"><p class="cl-fecac802"><span class="cl-fec741ab">6 (4.8%)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-fecaee87"><p class="cl-fecac802"><span class="cl-fec741ab"></span></p></td><td class="cl-fecaee88"><p class="cl-fecac802"><span class="cl-fec741ab">2022</span></p></td><td class="cl-fecaee87"><p class="cl-fecac802"><span class="cl-fec741ab">88 (9.2%)</span></p></td><td class="cl-fecaee87"><p class="cl-fecac802"><span class="cl-fec741ab">25 (5.3%)</span></p></td><td class="cl-fecaee87"><p class="cl-fecac802"><span class="cl-fec741ab">7 (5.6%)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-fecaee87"><p class="cl-fecac802"><span class="cl-fec741ab"></span></p></td><td class="cl-fecaee88"><p class="cl-fecac802"><span class="cl-fec741ab">2023</span></p></td><td class="cl-fecaee87"><p class="cl-fecac802"><span class="cl-fec741ab">87 (9.1%)</span></p></td><td class="cl-fecaee87"><p class="cl-fecac802"><span class="cl-fec741ab">63 (13.3%)</span></p></td><td class="cl-fecaee87"><p class="cl-fecac802"><span class="cl-fec741ab">20 (15.9%)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-fecaee87"><p class="cl-fecac802"><span class="cl-fec741ab"></span></p></td><td class="cl-fecaee88"><p class="cl-fecac802"><span class="cl-fec741ab">2024</span></p></td><td class="cl-fecaee87"><p class="cl-fecac802"><span class="cl-fec741ab">74 (7.7%)</span></p></td><td class="cl-fecaee87"><p class="cl-fecac802"><span class="cl-fec741ab">39 (8.3%)</span></p></td><td class="cl-fecaee87"><p class="cl-fecac802"><span class="cl-fec741ab">9 (7.1%)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-fecaee87"><p class="cl-fecac802"><span class="cl-fec741ab">Quarter</span></p></td><td class="cl-fecaee88"><p class="cl-fecac802"><span class="cl-fec741ab">1</span></p></td><td class="cl-fecaee87"><p class="cl-fecac802"><span class="cl-fec741ab">253 (26.5%)</span></p></td><td class="cl-fecaee87"><p class="cl-fecac802"><span class="cl-fec741ab">120 (25.4%)</span></p></td><td class="cl-fecaee87"><p class="cl-fecac802"><span class="cl-fec741ab">30 (23.8%)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-fecaee87"><p class="cl-fecac802"><span class="cl-fec741ab"></span></p></td><td class="cl-fecaee88"><p class="cl-fecac802"><span class="cl-fec741ab">2</span></p></td><td class="cl-fecaee87"><p class="cl-fecac802"><span class="cl-fec741ab">220 (23%)</span></p></td><td class="cl-fecaee87"><p class="cl-fecac802"><span class="cl-fec741ab">117 (24.8%)</span></p></td><td class="cl-fecaee87"><p class="cl-fecac802"><span class="cl-fec741ab">39 (31%)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-fecaee87"><p class="cl-fecac802"><span class="cl-fec741ab"></span></p></td><td class="cl-fecaee88"><p class="cl-fecac802"><span class="cl-fec741ab">3</span></p></td><td class="cl-fecaee87"><p class="cl-fecac802"><span class="cl-fec741ab">295 (30.9%)</span></p></td><td class="cl-fecaee87"><p class="cl-fecac802"><span class="cl-fec741ab">139 (29.4%)</span></p></td><td class="cl-fecaee87"><p class="cl-fecac802"><span class="cl-fec741ab">33 (26.2%)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-fecaee87"><p class="cl-fecac802"><span class="cl-fec741ab"></span></p></td><td class="cl-fecaee88"><p class="cl-fecac802"><span class="cl-fec741ab">4</span></p></td><td class="cl-fecaee87"><p class="cl-fecac802"><span class="cl-fec741ab">187 (19.6%)</span></p></td><td class="cl-fecaee87"><p class="cl-fecac802"><span class="cl-fec741ab">96 (20.3%)</span></p></td><td class="cl-fecaee87"><p class="cl-fecac802"><span class="cl-fec741ab">24 (19%)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-fecaee87"><p class="cl-fecac802"><span class="cl-fec741ab">Weekday</span></p></td><td class="cl-fecaee88"><p class="cl-fecac802"><span class="cl-fec741ab">Friday</span></p></td><td class="cl-fecaee87"><p class="cl-fecac802"><span class="cl-fec741ab">141 (14.8%)</span></p></td><td class="cl-fecaee87"><p class="cl-fecac802"><span class="cl-fec741ab">31 (6.6%)</span></p></td><td class="cl-fecaee87"><p class="cl-fecac802"><span class="cl-fec741ab">8 (6.3%)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-fecaee87"><p class="cl-fecac802"><span class="cl-fec741ab"></span></p></td><td class="cl-fecaee88"><p class="cl-fecac802"><span class="cl-fec741ab">Monday</span></p></td><td class="cl-fecaee87"><p class="cl-fecac802"><span class="cl-fec741ab">114 (11.9%)</span></p></td><td class="cl-fecaee87"><p class="cl-fecac802"><span class="cl-fec741ab">49 (10.4%)</span></p></td><td class="cl-fecaee87"><p class="cl-fecac802"><span class="cl-fec741ab">14 (11.1%)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-fecaee87"><p class="cl-fecac802"><span class="cl-fec741ab"></span></p></td><td class="cl-fecaee88"><p class="cl-fecac802"><span class="cl-fec741ab">Saturday</span></p></td><td class="cl-fecaee87"><p class="cl-fecac802"><span class="cl-fec741ab">160 (16.8%)</span></p></td><td class="cl-fecaee87"><p class="cl-fecac802"><span class="cl-fec741ab">81 (17.2%)</span></p></td><td class="cl-fecaee87"><p class="cl-fecac802"><span class="cl-fec741ab">12 (9.5%)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-fecaee87"><p class="cl-fecac802"><span class="cl-fec741ab"></span></p></td><td class="cl-fecaee88"><p class="cl-fecac802"><span class="cl-fec741ab">Sunday</span></p></td><td class="cl-fecaee87"><p class="cl-fecac802"><span class="cl-fec741ab">156 (16.3%)</span></p></td><td class="cl-fecaee87"><p class="cl-fecac802"><span class="cl-fec741ab">100 (21.2%)</span></p></td><td class="cl-fecaee87"><p class="cl-fecac802"><span class="cl-fec741ab">21 (16.7%)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-fecaee87"><p class="cl-fecac802"><span class="cl-fec741ab"></span></p></td><td class="cl-fecaee88"><p class="cl-fecac802"><span class="cl-fec741ab">Thursday</span></p></td><td class="cl-fecaee87"><p class="cl-fecac802"><span class="cl-fec741ab">167 (17.5%)</span></p></td><td class="cl-fecaee87"><p class="cl-fecac802"><span class="cl-fec741ab">66 (14%)</span></p></td><td class="cl-fecaee87"><p class="cl-fecac802"><span class="cl-fec741ab">20 (15.9%)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-fecaee87"><p class="cl-fecac802"><span class="cl-fec741ab"></span></p></td><td class="cl-fecaee88"><p class="cl-fecac802"><span class="cl-fec741ab">Tuesday</span></p></td><td class="cl-fecaee87"><p class="cl-fecac802"><span class="cl-fec741ab">108 (11.3%)</span></p></td><td class="cl-fecaee87"><p class="cl-fecac802"><span class="cl-fec741ab">43 (9.1%)</span></p></td><td class="cl-fecaee87"><p class="cl-fecac802"><span class="cl-fec741ab">14 (11.1%)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-fecaee90"><p class="cl-fecac802"><span class="cl-fec741ab"></span></p></td><td class="cl-fecaee91"><p class="cl-fecac802"><span class="cl-fec741ab">Wednesday</span></p></td><td class="cl-fecaee90"><p class="cl-fecac802"><span class="cl-fec741ab">109 (11.4%)</span></p></td><td class="cl-fecaee90"><p class="cl-fecac802"><span class="cl-fec741ab">102 (21.6%)</span></p></td><td class="cl-fecaee90"><p class="cl-fecac802"><span class="cl-fec741ab">37 (29.4%)</span></p></td></tr></tbody><tfoot><tr style="overflow-wrap:break-word;"><td colspan="5" class="cl-fecaee92"><p class="cl-fecac80c"><span class="cl-fec741b4">·µÉ</span><span class="cl-fec741ab">Vaccination proportions were calculated column-wise (i.e., within each vaccine group).</span></p></td></tr></tfoot></table></div>
</div>
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="co"># .................. Clean up environment ..................</span></span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(tab_age, tab_sex, tab_marital_status, tab_year, tab_quarter, tab_weekday,</span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a>   tab_combined, ft_vacc_summary, totals, create_tab)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="interactive-and-print-ready-table" class="level2" data-number="1.15">
<h2 data-number="1.15" class="anchored" data-anchor-id="interactive-and-print-ready-table"><span class="header-section-number">1.15</span> <strong>15. Interactive and Print-Ready Table</strong></h2>
<p>Finally, we build an <strong>interactive table using the DT package</strong> with export options (CSV, Excel, Print).</p>
<p>üñ±Ô∏è <em>Why use this</em>:</p>
<ul>
<li><p>Offers flexibility for exploratory review or end-user interaction.</p></li>
<li><p>Enables printing or downloading filtered subsets.</p></li>
</ul>
<p>üåç <em>Perfect for</em>: Dashboards, websites, or when publishing to HTML via Quarto/GitHub.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ------------ 12. Interactive and Print ready: Table  -------------------------------------------</span></span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a><span class="co"># .................. Convert grouping vars to character ..................</span></span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a>vacc_1524 <span class="ot">&lt;-</span> vacc_1524 <span class="sc">%&gt;%</span></span>
<span id="cb39-6"><a href="#cb39-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">c</span>(age_group, gender, marital_status,</span>
<span id="cb39-7"><a href="#cb39-7" aria-hidden="true" tabindex="-1"></a>                  vacc_service_year, vacc_quarter, vacc_weekday), as.character))</span>
<span id="cb39-8"><a href="#cb39-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-9"><a href="#cb39-9" aria-hidden="true" tabindex="-1"></a><span class="co"># .................. Table generation function with Missing ..................</span></span>
<span id="cb39-10"><a href="#cb39-10" aria-hidden="true" tabindex="-1"></a>create_tab <span class="ot">&lt;-</span> <span class="cf">function</span>(data, var, label) {</span>
<span id="cb39-11"><a href="#cb39-11" aria-hidden="true" tabindex="-1"></a>  tab_main <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span></span>
<span id="cb39-12"><a href="#cb39-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>({{ var }})) <span class="sc">%&gt;%</span></span>
<span id="cb39-13"><a href="#cb39-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tabyl</span>({{ var }}, vacc_group3) <span class="sc">%&gt;%</span></span>
<span id="cb39-14"><a href="#cb39-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">Category =</span> label, <span class="at">.before =</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb39-15"><a href="#cb39-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rename</span>(<span class="at">Label =</span> {{ var }}) <span class="sc">%&gt;%</span></span>
<span id="cb39-16"><a href="#cb39-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">Label =</span> <span class="fu">as.character</span>(Label))</span>
<span id="cb39-17"><a href="#cb39-17" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb39-18"><a href="#cb39-18" aria-hidden="true" tabindex="-1"></a>  na_count <span class="ot">&lt;-</span> <span class="fu">sum</span>(<span class="fu">is.na</span>(<span class="fu">pull</span>(data, {{ var }})))</span>
<span id="cb39-19"><a href="#cb39-19" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb39-20"><a href="#cb39-20" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (na_count <span class="sc">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb39-21"><a href="#cb39-21" aria-hidden="true" tabindex="-1"></a>    missing_row <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb39-22"><a href="#cb39-22" aria-hidden="true" tabindex="-1"></a>      <span class="at">Category =</span> label,</span>
<span id="cb39-23"><a href="#cb39-23" aria-hidden="true" tabindex="-1"></a>      <span class="at">Label =</span> <span class="st">"Missing"</span>,</span>
<span id="cb39-24"><a href="#cb39-24" aria-hidden="true" tabindex="-1"></a>      <span class="st">`</span><span class="at">Respiratory vaccines</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">sum</span>(data<span class="sc">$</span>vacc_group3 <span class="sc">==</span> <span class="st">"Respiratory vaccines"</span> <span class="sc">&amp;</span> <span class="fu">is.na</span>(<span class="fu">pull</span>(data, {{ var }})), <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb39-25"><a href="#cb39-25" aria-hidden="true" tabindex="-1"></a>      <span class="st">`</span><span class="at">Childhood vaccines</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">sum</span>(data<span class="sc">$</span>vacc_group3 <span class="sc">==</span> <span class="st">"Childhood vaccines"</span> <span class="sc">&amp;</span> <span class="fu">is.na</span>(<span class="fu">pull</span>(data, {{ var }})), <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb39-26"><a href="#cb39-26" aria-hidden="true" tabindex="-1"></a>      <span class="at">Other =</span> <span class="fu">sum</span>(data<span class="sc">$</span>vacc_group3 <span class="sc">==</span> <span class="st">"Other"</span> <span class="sc">&amp;</span> <span class="fu">is.na</span>(<span class="fu">pull</span>(data, {{ var }})), <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb39-27"><a href="#cb39-27" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb39-28"><a href="#cb39-28" aria-hidden="true" tabindex="-1"></a>    tab_final <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(tab_main, missing_row)</span>
<span id="cb39-29"><a href="#cb39-29" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb39-30"><a href="#cb39-30" aria-hidden="true" tabindex="-1"></a>    tab_final <span class="ot">&lt;-</span> tab_main</span>
<span id="cb39-31"><a href="#cb39-31" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb39-32"><a href="#cb39-32" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb39-33"><a href="#cb39-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(tab_final)</span>
<span id="cb39-34"><a href="#cb39-34" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb39-35"><a href="#cb39-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-36"><a href="#cb39-36" aria-hidden="true" tabindex="-1"></a><span class="co"># .................. Create summary tables ..................</span></span>
<span id="cb39-37"><a href="#cb39-37" aria-hidden="true" tabindex="-1"></a>tab_age            <span class="ot">&lt;-</span> <span class="fu">create_tab</span>(vacc_1524, age_group, <span class="st">"Age"</span>)</span>
<span id="cb39-38"><a href="#cb39-38" aria-hidden="true" tabindex="-1"></a>tab_sex            <span class="ot">&lt;-</span> <span class="fu">create_tab</span>(vacc_1524, gender, <span class="st">"Gender"</span>)</span>
<span id="cb39-39"><a href="#cb39-39" aria-hidden="true" tabindex="-1"></a>tab_marital_status <span class="ot">&lt;-</span> <span class="fu">create_tab</span>(vacc_1524, marital_status, <span class="st">"Marital status"</span>)</span>
<span id="cb39-40"><a href="#cb39-40" aria-hidden="true" tabindex="-1"></a>tab_year           <span class="ot">&lt;-</span> <span class="fu">create_tab</span>(vacc_1524, vacc_service_year, <span class="st">"Year"</span>)</span>
<span id="cb39-41"><a href="#cb39-41" aria-hidden="true" tabindex="-1"></a>tab_quarter        <span class="ot">&lt;-</span> <span class="fu">create_tab</span>(vacc_1524, vacc_quarter, <span class="st">"Quarter"</span>)</span>
<span id="cb39-42"><a href="#cb39-42" aria-hidden="true" tabindex="-1"></a>tab_weekday        <span class="ot">&lt;-</span> <span class="fu">create_tab</span>(vacc_1524, vacc_weekday, <span class="st">"Weekday"</span>)</span>
<span id="cb39-43"><a href="#cb39-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-44"><a href="#cb39-44" aria-hidden="true" tabindex="-1"></a><span class="co"># .................. Combine all tables ..................</span></span>
<span id="cb39-45"><a href="#cb39-45" aria-hidden="true" tabindex="-1"></a>tab_combined <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(tab_sex, tab_age, tab_marital_status, tab_year, tab_quarter, tab_weekday)</span>
<span id="cb39-46"><a href="#cb39-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-47"><a href="#cb39-47" aria-hidden="true" tabindex="-1"></a><span class="co"># .................. Calculate row-wise percentages (skip for Missing) ..................</span></span>
<span id="cb39-48"><a href="#cb39-48" aria-hidden="true" tabindex="-1"></a>tab_combined <span class="ot">&lt;-</span> tab_combined <span class="sc">%&gt;%</span></span>
<span id="cb39-49"><a href="#cb39-49" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rowwise</span>() <span class="sc">%&gt;%</span></span>
<span id="cb39-50"><a href="#cb39-50" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb39-51"><a href="#cb39-51" aria-hidden="true" tabindex="-1"></a>    <span class="at">Total =</span> <span class="fu">sum</span>(<span class="st">`</span><span class="at">Respiratory vaccines</span><span class="st">`</span>, <span class="st">`</span><span class="at">Childhood vaccines</span><span class="st">`</span>, Other, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb39-52"><a href="#cb39-52" aria-hidden="true" tabindex="-1"></a>    <span class="at">is_missing =</span> <span class="fu">trimws</span>(<span class="fu">tolower</span>(Label)) <span class="sc">==</span> <span class="st">"missing"</span>,</span>
<span id="cb39-53"><a href="#cb39-53" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb39-54"><a href="#cb39-54" aria-hidden="true" tabindex="-1"></a>    <span class="at">Respiratory =</span> <span class="fu">ifelse</span>(is_missing,</span>
<span id="cb39-55"><a href="#cb39-55" aria-hidden="true" tabindex="-1"></a>                         <span class="fu">comma</span>(<span class="st">`</span><span class="at">Respiratory vaccines</span><span class="st">`</span>),</span>
<span id="cb39-56"><a href="#cb39-56" aria-hidden="true" tabindex="-1"></a>                         <span class="fu">paste0</span>(<span class="fu">comma</span>(<span class="st">`</span><span class="at">Respiratory vaccines</span><span class="st">`</span>), <span class="st">" ("</span>, <span class="fu">round</span>(<span class="dv">100</span> <span class="sc">*</span> <span class="st">`</span><span class="at">Respiratory vaccines</span><span class="st">`</span> <span class="sc">/</span> Total, <span class="dv">1</span>), <span class="st">")"</span>)),</span>
<span id="cb39-57"><a href="#cb39-57" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb39-58"><a href="#cb39-58" aria-hidden="true" tabindex="-1"></a>    <span class="at">Childhood =</span> <span class="fu">ifelse</span>(is_missing,</span>
<span id="cb39-59"><a href="#cb39-59" aria-hidden="true" tabindex="-1"></a>                       <span class="fu">comma</span>(<span class="st">`</span><span class="at">Childhood vaccines</span><span class="st">`</span>),</span>
<span id="cb39-60"><a href="#cb39-60" aria-hidden="true" tabindex="-1"></a>                       <span class="fu">paste0</span>(<span class="fu">comma</span>(<span class="st">`</span><span class="at">Childhood vaccines</span><span class="st">`</span>), <span class="st">" ("</span>, <span class="fu">round</span>(<span class="dv">100</span> <span class="sc">*</span> <span class="st">`</span><span class="at">Childhood vaccines</span><span class="st">`</span> <span class="sc">/</span> Total, <span class="dv">1</span>), <span class="st">")"</span>)),</span>
<span id="cb39-61"><a href="#cb39-61" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb39-62"><a href="#cb39-62" aria-hidden="true" tabindex="-1"></a>    <span class="at">Other_grp =</span> <span class="fu">ifelse</span>(is_missing,</span>
<span id="cb39-63"><a href="#cb39-63" aria-hidden="true" tabindex="-1"></a>                       <span class="fu">comma</span>(Other),</span>
<span id="cb39-64"><a href="#cb39-64" aria-hidden="true" tabindex="-1"></a>                       <span class="fu">paste0</span>(<span class="fu">comma</span>(Other), <span class="st">" ("</span>, <span class="fu">round</span>(<span class="dv">100</span> <span class="sc">*</span> Other <span class="sc">/</span> Total, <span class="dv">1</span>), <span class="st">")"</span>))</span>
<span id="cb39-65"><a href="#cb39-65" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb39-66"><a href="#cb39-66" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb39-67"><a href="#cb39-67" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Category, Label, Respiratory, Childhood, Other_grp)</span>
<span id="cb39-68"><a href="#cb39-68" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-69"><a href="#cb39-69" aria-hidden="true" tabindex="-1"></a><span class="co"># .................. Show Category only once per group ..................</span></span>
<span id="cb39-70"><a href="#cb39-70" aria-hidden="true" tabindex="-1"></a>tab_combined <span class="ot">&lt;-</span> tab_combined <span class="sc">%&gt;%</span></span>
<span id="cb39-71"><a href="#cb39-71" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Category) <span class="sc">%&gt;%</span></span>
<span id="cb39-72"><a href="#cb39-72" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Category =</span> <span class="fu">ifelse</span>(<span class="fu">row_number</span>() <span class="sc">==</span> <span class="dv">1</span>, Category, <span class="st">""</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb39-73"><a href="#cb39-73" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb39-74"><a href="#cb39-74" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-75"><a href="#cb39-75" aria-hidden="true" tabindex="-1"></a><span class="co"># .................. Create interactive table with DT ..................</span></span>
<span id="cb39-76"><a href="#cb39-76" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-77"><a href="#cb39-77" aria-hidden="true" tabindex="-1"></a><span class="fu">datatable</span>(</span>
<span id="cb39-78"><a href="#cb39-78" aria-hidden="true" tabindex="-1"></a>  tab_combined,</span>
<span id="cb39-79"><a href="#cb39-79" aria-hidden="true" tabindex="-1"></a>  <span class="at">rownames =</span> <span class="cn">FALSE</span>,</span>
<span id="cb39-80"><a href="#cb39-80" aria-hidden="true" tabindex="-1"></a>  <span class="at">extensions =</span> <span class="st">'Buttons'</span>,</span>
<span id="cb39-81"><a href="#cb39-81" aria-hidden="true" tabindex="-1"></a>  <span class="at">options =</span> <span class="fu">list</span>(</span>
<span id="cb39-82"><a href="#cb39-82" aria-hidden="true" tabindex="-1"></a>    <span class="at">dom =</span> <span class="st">'Bfrtip'</span>,</span>
<span id="cb39-83"><a href="#cb39-83" aria-hidden="true" tabindex="-1"></a>    <span class="at">buttons =</span> <span class="fu">c</span>(<span class="st">'copy'</span>, <span class="st">'csv'</span>, <span class="st">'excel'</span>, <span class="st">'pdf'</span>, <span class="st">'print'</span>),</span>
<span id="cb39-84"><a href="#cb39-84" aria-hidden="true" tabindex="-1"></a>    <span class="at">pageLength =</span> <span class="dv">25</span>,</span>
<span id="cb39-85"><a href="#cb39-85" aria-hidden="true" tabindex="-1"></a>    <span class="at">autoWidth =</span> <span class="cn">TRUE</span>,</span>
<span id="cb39-86"><a href="#cb39-86" aria-hidden="true" tabindex="-1"></a>    <span class="at">columnDefs =</span> <span class="fu">list</span>(<span class="fu">list</span>(<span class="at">width =</span> <span class="st">'200px'</span>, <span class="at">targets =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>)))</span>
<span id="cb39-87"><a href="#cb39-87" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb39-88"><a href="#cb39-88" aria-hidden="true" tabindex="-1"></a>  <span class="at">caption =</span> htmltools<span class="sc">::</span>tags<span class="sc">$</span><span class="fu">caption</span>(</span>
<span id="cb39-89"><a href="#cb39-89" aria-hidden="true" tabindex="-1"></a>    <span class="at">style =</span> <span class="st">'caption-side: top; font-size: 18px; font-family: "Times New Roman"; font-weight: bold;'</span>,</span>
<span id="cb39-90"><a href="#cb39-90" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Table: Vaccination uptake across service year, quarter, and weekday'</span></span>
<span id="cb39-91"><a href="#cb39-91" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb39-92"><a href="#cb39-92" aria-hidden="true" tabindex="-1"></a>  <span class="at">class =</span> <span class="st">'stripe hover cell-border'</span></span>
<span id="cb39-93"><a href="#cb39-93" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="datatables html-widget html-fill-item" id="htmlwidget-0a56e3955bf1104e2160" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-0a56e3955bf1104e2160">{"x":{"filter":"none","vertical":false,"extensions":["Buttons"],"caption":"<caption style=\"caption-side: top; font-size: 18px; font-family: &quot;Times New Roman&quot;; font-weight: bold;\">Table: Vaccination uptake across service year, quarter, and weekday<\/caption>","data":[["Gender","","Age","","","","","","","Marital status","","","","Year","","","","","","","","","","Quarter","","","","Weekday","","","","","",""],["Female","Male","0-19","20-29","30-39","40-49","50-59","60-69","70+","Divorced","Married","Single/widowed","Missing","2015","2016","2017","2018","2019","2020","2021","2022","2023","2024","1","2","3","4","Friday","Monday","Saturday","Sunday","Thursday","Tuesday","Wednesday"],["511 (64)","444 (58.8)","250 (38.9)","150 (68.2)","47 (71.2)","142 (75.9)","112 (77.8)","149 (87.6)","105 (84.7)","136 (83.4)","289 (79)","150 (79.4)","380","78 (51)","84 (60.4)","75 (54.7)","81 (53.6)","83 (51.6)","82 (59.9)","223 (84.8)","88 (73.3)","87 (51.2)","74 (60.7)","253 (62.8)","220 (58.5)","295 (63.2)","187 (60.9)","141 (78.3)","114 (64.4)","160 (63.2)","156 (56.3)","167 (66)","108 (65.5)","109 (44)"],["233 (29.2)","239 (31.7)","302 (47)","70 (31.8)","19 (28.8)","45 (24.1)","14 (9.7)","13 (7.6)","9 (7.3)","15 (9.2)","59 (16.1)","33 (17.5)","365","56 (36.6)","47 (33.8)","52 (38)","52 (34.4)","60 (37.3)","44 (32.1)","34 (12.9)","25 (20.8)","63 (37.1)","39 (32)","120 (29.8)","117 (31.1)","139 (29.8)","96 (31.3)","31 (17.2)","49 (27.7)","81 (32)","100 (36.1)","66 (26.1)","43 (26.1)","102 (41.1)"],["54 (6.8)","72 (9.5)","90 (14)","0 (0)","0 (0)","0 (0)","18 (12.5)","8 (4.7)","10 (8.1)","12 (7.4)","18 (4.9)","6 (3.2)","90","19 (12.4)","8 (5.8)","10 (7.3)","18 (11.9)","18 (11.2)","11 (8)","6 (2.3)","7 (5.8)","20 (11.8)","9 (7.4)","30 (7.4)","39 (10.4)","33 (7.1)","24 (7.8)","8 (4.4)","14 (7.9)","12 (4.7)","21 (7.6)","20 (7.9)","14 (8.5)","37 (14.9)"]],"container":"<table class=\"stripe hover cell-border\">\n  <thead>\n    <tr>\n      <th>Category<\/th>\n      <th>Label<\/th>\n      <th>Respiratory<\/th>\n      <th>Childhood<\/th>\n      <th>Other_grp<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"dom":"Bfrtip","buttons":["copy","csv","excel","pdf","print"],"pageLength":25,"autoWidth":true,"columnDefs":[{"width":"200px","targets":[0,1]},{"name":"Category","targets":0},{"name":"Label","targets":1},{"name":"Respiratory","targets":2},{"name":"Childhood","targets":3},{"name":"Other_grp","targets":4}],"order":[],"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
</div>
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="co"># .................. Clean up all new objects ..................</span></span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(tab_age, tab_sex, tab_marital_status, tab_year, tab_quarter, tab_weekday,</span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a>   tab_combined, create_tab)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="brief-summary" class="level1" data-number="2">
<h1 data-number="2"><span class="header-section-number">2</span> Brief summary</h1>
<p>Automating table generation is crucial for improving reproducibility, consistency, and efficiency in health data reporting. It reduces the need for repetitive formatting and enables streamlined integration with reporting tools such as Quarto and GitHub. This document demonstrates various approaches to creating publication-ready tables using R.</p>
<section id="row-wise-tables" class="level3" data-number="2.0.1">
<h3 data-number="2.0.1" class="anchored" data-anchor-id="row-wise-tables"><span class="header-section-number">2.0.1</span> Row-Wise Tables</h3>
<p>This method calculates percentages across rows, meaning each row adds up to 100%. Ideal for summarizing characteristics such as age, gender, or quarter.</p>
</section>
<section id="column-wise-tables" class="level3" data-number="2.0.2">
<h3 data-number="2.0.2" class="anchored" data-anchor-id="column-wise-tables"><span class="header-section-number">2.0.2</span> Column-Wise Tables</h3>
<p>This variation calculates percentages within each vaccine group (i.e., by column). Each column totals 100%.</p>
</section>
<section id="handling-missing-data" class="level3" data-number="2.0.3">
<h3 data-number="2.0.3" class="anchored" data-anchor-id="handling-missing-data"><span class="header-section-number">2.0.3</span> Handling Missing Data</h3>
<p>Tables optionally include rows labeled ‚ÄúMissing‚Äù to account for unreported values.</p>
</section>
<section id="table-styles-fonts-and-border-options" class="level3" data-number="2.0.4">
<h3 data-number="2.0.4" class="anchored"><span class="header-section-number">2.0.4</span> Table Styles, Fonts and Border Options</h3>
<p>Apply different styling configurations:</p>
<ul>
<li><p><strong>No lines</strong> ‚Äì minimal look for Word docs</p></li>
<li><p><strong>Horizontal lines only</strong> ‚Äì readable and clean for print</p></li>
<li><p><strong>All lines visible</strong> ‚Äì structured look for Excel-style documents</p></li>
<li><p>The goal is to adapt the visual format to your output medium.</p></li>
<li><p>Font selection (e.g., Times New Roman)</p></li>
<li><p>Font sizes (header, body, footer)</p></li>
<li><p>Color-coding headers and alternating rows</p></li>
<li><p>Setting captions and custom footnotes</p>
<div>
<h2 id="interactive-tables" data-number="2.1" class="anchored" data-anchor-id="table-styles-fonts-and-border-options"><span class="header-section-number">2.1</span> Interactive Tables</h2>
</div></li>
</ul>
<p>Interactive tables are created using <code>DT::datatable()</code> for HTML outputs. Key features:</p>
<ul>
<li><p>Searchable and filterable</p></li>
<li><p>Buttons for export (CSV, Excel, PDF)</p></li>
<li><p>Caption styling using <code>htmltools</code></p></li>
</ul>
<pre><code>## Summary Table: Style and Purpose</code></pre>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Style</th>
<th>Use Case</th>
<th>Best For</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Row-wise %</td>
<td>Compare categories</td>
<td>Epidemiological summaries</td>
</tr>
<tr class="even">
<td>Column-wise %</td>
<td>Within group totals</td>
<td>Vaccine distribution</td>
</tr>
<tr class="odd">
<td>Missing shown</td>
<td>Transparency</td>
<td>Data audits</td>
</tr>
<tr class="even">
<td>No borders</td>
<td>Word reports</td>
<td>Clean look</td>
</tr>
<tr class="odd">
<td>Full borders</td>
<td>Technical</td>
<td>Detailed analysis</td>
</tr>
<tr class="even">
<td>Interactive</td>
<td>HTML export</td>
<td>User engagement</td>
</tr>
</tbody>
</table>
</section>
</section>
<section id="key-takeaways" class="level1" data-number="3">
<h1 data-number="3"><span class="header-section-number">3</span> Key Takeaways</h1>
<ul>
<li><p>Automated table generation is efficient, reproducible, and customizable.</p></li>
<li><p><code>flextable</code>, <code>janitor</code>, and <code>dplyr</code> form a powerful combination for health data summarization.</p></li>
<li><p>Style your tables based on your audience‚Äîminimal for reports, interactive for dashboards.</p></li>
<li><p>Table Automation reduces manual error and allows rapid updates to underlying data.</p></li>
<li><p>You can extend this workflow to support additional data types, link it to Shiny dashboards, or convert it for LaTeX outputs.</p></li>
</ul>
<p><em>This project is hosted on GitHub and supports reproducible outcomes using Quarto.</em></p>


<!-- -->

</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "Óßã";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb42" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a><span class="an">title:</span><span class="co"> "Automating Publication-Ready Tables in R"</span></span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a><span class="an">author:</span><span class="co"> "Habtamu Bizuayehu"</span></span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a><span class="an">website:</span><span class="co"> "https://habtamubizuayehu.com/"</span></span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a><span class="an">orcid:</span><span class="co"> "https://orcid.org/0000-0002-1360-4909"</span></span>
<span id="cb42-6"><a href="#cb42-6" aria-hidden="true" tabindex="-1"></a><span class="an">highlight-style:</span><span class="co"> github</span></span>
<span id="cb42-7"><a href="#cb42-7" aria-hidden="true" tabindex="-1"></a><span class="an">project:</span></span>
<span id="cb42-8"><a href="#cb42-8" aria-hidden="true" tabindex="-1"></a><span class="co">  type: website</span></span>
<span id="cb42-9"><a href="#cb42-9" aria-hidden="true" tabindex="-1"></a><span class="co">  output-dir: docs</span></span>
<span id="cb42-10"><a href="#cb42-10" aria-hidden="true" tabindex="-1"></a><span class="an">format:</span><span class="co"> html</span></span>
<span id="cb42-11"><a href="#cb42-11" aria-hidden="true" tabindex="-1"></a><span class="an">toc:</span><span class="co"> true</span></span>
<span id="cb42-12"><a href="#cb42-12" aria-hidden="true" tabindex="-1"></a><span class="an">toc-depth:</span><span class="co"> 2</span></span>
<span id="cb42-13"><a href="#cb42-13" aria-hidden="true" tabindex="-1"></a><span class="an">number-sections:</span><span class="co"> true</span></span>
<span id="cb42-14"><a href="#cb42-14" aria-hidden="true" tabindex="-1"></a><span class="an">code-fold:</span><span class="co"> false</span></span>
<span id="cb42-15"><a href="#cb42-15" aria-hidden="true" tabindex="-1"></a><span class="an">code-tools:</span><span class="co"> true</span></span>
<span id="cb42-16"><a href="#cb42-16" aria-hidden="true" tabindex="-1"></a><span class="an">code-summary:</span><span class="co"> "Show the code"</span></span>
<span id="cb42-17"><a href="#cb42-17" aria-hidden="true" tabindex="-1"></a><span class="an">theme:</span><span class="co"> united</span></span>
<span id="cb42-18"><a href="#cb42-18" aria-hidden="true" tabindex="-1"></a><span class="an">knitr:</span></span>
<span id="cb42-19"><a href="#cb42-19" aria-hidden="true" tabindex="-1"></a><span class="co">  opts_chunk:</span></span>
<span id="cb42-20"><a href="#cb42-20" aria-hidden="true" tabindex="-1"></a><span class="co">    warning: false</span></span>
<span id="cb42-21"><a href="#cb42-21" aria-hidden="true" tabindex="-1"></a><span class="co">    message: false</span></span>
<span id="cb42-22"><a href="#cb42-22" aria-hidden="true" tabindex="-1"></a><span class="an">editor:</span><span class="co"> visual</span></span>
<span id="cb42-23"><a href="#cb42-23" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb42-24"><a href="#cb42-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-25"><a href="#cb42-25" aria-hidden="true" tabindex="-1"></a><span class="fu"># üìã Overview: Creating a Publication-Ready Table in R with `flextable`</span></span>
<span id="cb42-26"><a href="#cb42-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-27"><a href="#cb42-27" aria-hidden="true" tabindex="-1"></a>This section presents a walkthrough of generating a publication-ready table. The aim is to summarize and format data in a professional way. The key steps include:</span>
<span id="cb42-28"><a href="#cb42-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-29"><a href="#cb42-29" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Cleaning and preparing data for consistency.</span>
<span id="cb42-30"><a href="#cb42-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-31"><a href="#cb42-31" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Creating summary tables for different variables.</span>
<span id="cb42-32"><a href="#cb42-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-33"><a href="#cb42-33" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Combining and styling tables for clear visual presentation.</span>
<span id="cb42-34"><a href="#cb42-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-35"><a href="#cb42-35" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Automating the process using <span class="in">`flextable`</span>.</span>
<span id="cb42-36"><a href="#cb42-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-37"><a href="#cb42-37" aria-hidden="true" tabindex="-1"></a>The code below demonstrates how to achieve these steps. I will demonstrate how to generate a **clean, publication-ready summary table** using R. The approach combines data manipulation with <span class="in">`dplyr`</span>, summary tabulation with <span class="in">`janitor`</span>, and elegant styling via the <span class="in">`flextable`</span> package.</span>
<span id="cb42-38"><a href="#cb42-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-39"><a href="#cb42-39" aria-hidden="true" tabindex="-1"></a>This process is especially useful for public health datasets with categorical variables like age, gender, or service dates and includes options for handling missing data, calculating row percentages, column percentages and customizing formatting such as font type, table width, and color.</span>
<span id="cb42-40"><a href="#cb42-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-41"><a href="#cb42-41" aria-hidden="true" tabindex="-1"></a>By automating these steps, we can save time, reduce manual formatting errors, and ensure consistency across tables.</span>
<span id="cb42-42"><a href="#cb42-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-43"><a href="#cb42-43" aria-hidden="true" tabindex="-1"></a>üîπ Step 1: Load Required Libraries</span>
<span id="cb42-44"><a href="#cb42-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-45"><a href="#cb42-45" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, message=FALSE, warning=FALSE}</span></span>
<span id="cb42-46"><a href="#cb42-46" aria-hidden="true" tabindex="-1"></a><span class="in"># Clear environment and console</span></span>
<span id="cb42-47"><a href="#cb42-47" aria-hidden="true" tabindex="-1"></a><span class="in">rm(list = ls()) </span></span>
<span id="cb42-48"><a href="#cb42-48" aria-hidden="true" tabindex="-1"></a><span class="in">cat("\014")</span></span>
<span id="cb42-49"><a href="#cb42-49" aria-hidden="true" tabindex="-1"></a><span class="in"># Load required packages</span></span>
<span id="cb42-50"><a href="#cb42-50" aria-hidden="true" tabindex="-1"></a><span class="in">#gc() #garbage collector to clean up the workspace.</span></span>
<span id="cb42-51"><a href="#cb42-51" aria-hidden="true" tabindex="-1"></a><span class="in">options(repos = c(CRAN = "https://cran.rstudio.com"))</span></span>
<span id="cb42-52"><a href="#cb42-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-53"><a href="#cb42-53" aria-hidden="true" tabindex="-1"></a><span class="in"># List of required packages for Date and Time Data Analysis</span></span>
<span id="cb42-54"><a href="#cb42-54" aria-hidden="true" tabindex="-1"></a><span class="in">packages &lt;- c(</span></span>
<span id="cb42-55"><a href="#cb42-55" aria-hidden="true" tabindex="-1"></a><span class="in">  "lubridate", "dplyr", "stringr", "zoo", "tsibble", "ggplot2", "plotly", </span></span>
<span id="cb42-56"><a href="#cb42-56" aria-hidden="true" tabindex="-1"></a><span class="in">  "readr", "forecast", "prettydoc", "janitor", "knitr", "rmarkdown", "yaml", </span></span>
<span id="cb42-57"><a href="#cb42-57" aria-hidden="true" tabindex="-1"></a><span class="in">  "flextable", "scales", "gt", "reactable", "tidyverse", "tidyr", "officer"</span></span>
<span id="cb42-58"><a href="#cb42-58" aria-hidden="true" tabindex="-1"></a><span class="in">)</span></span>
<span id="cb42-59"><a href="#cb42-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-60"><a href="#cb42-60" aria-hidden="true" tabindex="-1"></a><span class="in"># Install and load packages with descriptions</span></span>
<span id="cb42-61"><a href="#cb42-61" aria-hidden="true" tabindex="-1"></a><span class="in">for (pkg in packages) {</span></span>
<span id="cb42-62"><a href="#cb42-62" aria-hidden="true" tabindex="-1"></a><span class="in">  if (!require(pkg, character.only = TRUE)) {</span></span>
<span id="cb42-63"><a href="#cb42-63" aria-hidden="true" tabindex="-1"></a><span class="in">    install.packages(pkg)</span></span>
<span id="cb42-64"><a href="#cb42-64" aria-hidden="true" tabindex="-1"></a><span class="in">  }</span></span>
<span id="cb42-65"><a href="#cb42-65" aria-hidden="true" tabindex="-1"></a><span class="in">}</span></span>
<span id="cb42-66"><a href="#cb42-66" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-67"><a href="#cb42-67" aria-hidden="true" tabindex="-1"></a><span class="in"># Install quarto if not already installed</span></span>
<span id="cb42-68"><a href="#cb42-68" aria-hidden="true" tabindex="-1"></a><span class="in">if (!requireNamespace("quarto", quietly = TRUE)) install.packages("quarto")</span></span>
<span id="cb42-69"><a href="#cb42-69" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-70"><a href="#cb42-70" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-71"><a href="#cb42-71" aria-hidden="true" tabindex="-1"></a><span class="in"># **Load required libraries**</span></span>
<span id="cb42-72"><a href="#cb42-72" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-73"><a href="#cb42-73" aria-hidden="true" tabindex="-1"></a><span class="in">library(lubridate) # Simplifies the manipulation of dates and times in R (e.g., formatting, extracting components)</span></span>
<span id="cb42-74"><a href="#cb42-74" aria-hidden="true" tabindex="-1"></a><span class="in">library(dplyr) # Provides tools for data manipulation, helpful for filtering and summarizing date-based data</span></span>
<span id="cb42-75"><a href="#cb42-75" aria-hidden="true" tabindex="-1"></a><span class="in">library(stringr) # Simplifies string manipulation</span></span>
<span id="cb42-76"><a href="#cb42-76" aria-hidden="true" tabindex="-1"></a><span class="in">library(tidyr)   # Reshaping and tidying data</span></span>
<span id="cb42-77"><a href="#cb42-77" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-78"><a href="#cb42-78" aria-hidden="true" tabindex="-1"></a><span class="in">library(zoo) # For working with time series data, including rolling calculations and handling missing data in time series</span></span>
<span id="cb42-79"><a href="#cb42-79" aria-hidden="true" tabindex="-1"></a><span class="in">library(tsibble) # Provides tools for handling time series data, including date-time indexes and features for forecasting</span></span>
<span id="cb42-80"><a href="#cb42-80" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-81"><a href="#cb42-81" aria-hidden="true" tabindex="-1"></a><span class="in">library(readr) # For reading date-time data from CSV</span></span>
<span id="cb42-82"><a href="#cb42-82" aria-hidden="true" tabindex="-1"></a><span class="in">library(haven) #  data from other statistical software formats (SPSS, SAS, Stata)</span></span>
<span id="cb42-83"><a href="#cb42-83" aria-hidden="true" tabindex="-1"></a><span class="in">library(forecast) # Useful for time series forecasting, especially when working with seasonal or trend-based data</span></span>
<span id="cb42-84"><a href="#cb42-84" aria-hidden="true" tabindex="-1"></a><span class="in">library(ggplot2) # For visualizing date-time trends in data (e.g., time series plots)</span></span>
<span id="cb42-85"><a href="#cb42-85" aria-hidden="true" tabindex="-1"></a><span class="in">library(janitor) # Tabulation, cleaning column names, adding totals and proportions</span></span>
<span id="cb42-86"><a href="#cb42-86" aria-hidden="true" tabindex="-1"></a><span class="in">library (plotly)     # Interactive visualizations</span></span>
<span id="cb42-87"><a href="#cb42-87" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-88"><a href="#cb42-88" aria-hidden="true" tabindex="-1"></a><span class="in"># Documentation/reporting</span></span>
<span id="cb42-89"><a href="#cb42-89" aria-hidden="true" tabindex="-1"></a><span class="in">library(prettydoc)  # Pretty document templates</span></span>
<span id="cb42-90"><a href="#cb42-90" aria-hidden="true" tabindex="-1"></a><span class="in">library(flexdashboard)# Interactive dashboards</span></span>
<span id="cb42-91"><a href="#cb42-91" aria-hidden="true" tabindex="-1"></a><span class="in">library(quarto)  # For rendering and publishing documents with the Quarto framework</span></span>
<span id="cb42-92"><a href="#cb42-92" aria-hidden="true" tabindex="-1"></a><span class="in">library(yaml)       # YAML document processing</span></span>
<span id="cb42-93"><a href="#cb42-93" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-94"><a href="#cb42-94" aria-hidden="true" tabindex="-1"></a><span class="in"># Tabulation</span></span>
<span id="cb42-95"><a href="#cb42-95" aria-hidden="true" tabindex="-1"></a><span class="in">library(flextable)  # for creating styled, publication-ready tables</span></span>
<span id="cb42-96"><a href="#cb42-96" aria-hidden="true" tabindex="-1"></a><span class="in">library(gt)         # Grammar of tables</span></span>
<span id="cb42-97"><a href="#cb42-97" aria-hidden="true" tabindex="-1"></a><span class="in">library(reactable)  # Interactive tables</span></span>
<span id="cb42-98"><a href="#cb42-98" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-99"><a href="#cb42-99" aria-hidden="true" tabindex="-1"></a><span class="in">library(scales) # for number formatting (e.g., commas)</span></span>
<span id="cb42-100"><a href="#cb42-100" aria-hidden="true" tabindex="-1"></a><span class="in">library(officer)  #  For exporting tables/reports to Word or PowerPoint</span></span>
<span id="cb42-101"><a href="#cb42-101" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-102"><a href="#cb42-102" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb42-103"><a href="#cb42-103" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-106"><a href="#cb42-106" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb42-107"><a href="#cb42-107" aria-hidden="true" tabindex="-1"></a><span class="fu">setwd</span>(<span class="st">"C:/Users/User/Desktop/Materials_ Course and proposals/Course Related/DataCamp/Data/"</span>)</span>
<span id="cb42-108"><a href="#cb42-108" aria-hidden="true" tabindex="-1"></a><span class="fu">load</span>(<span class="st">"Vaccination_uptake.RDATA"</span>)</span>
<span id="cb42-109"><a href="#cb42-109" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-110"><a href="#cb42-110" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb42-111"><a href="#cb42-111" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-112"><a href="#cb42-112" aria-hidden="true" tabindex="-1"></a>üîπ Step 2: Convert Grouping Variables to Character</span>
<span id="cb42-113"><a href="#cb42-113" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-114"><a href="#cb42-114" aria-hidden="true" tabindex="-1"></a>Before we tabulate values, we need to ensure all grouping variables have a consistent format. The table-generating function later in this workflow expects character values. If a mix of numeric and character types is used, the output may fail or be misaligned.</span>
<span id="cb42-115"><a href="#cb42-115" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-116"><a href="#cb42-116" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, eval=FALSE}</span></span>
<span id="cb42-117"><a href="#cb42-117" aria-hidden="true" tabindex="-1"></a><span class="in">vacc_1524 &lt;- vacc_1524 %&gt;%   mutate(across(c(age_group, gender, marital_status,                   vacc_service_year, vacc_quarter, vacc_weekday), as.character))</span></span>
<span id="cb42-118"><a href="#cb42-118" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb42-119"><a href="#cb42-119" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-120"><a href="#cb42-120" aria-hidden="true" tabindex="-1"></a>üí° *Why this matters*: If one variable like <span class="in">`gender`</span> is stored as a character and another like <span class="in">`age_group`</span> is numeric, the table creation function won't process them uniformly. This step ensures compatibility and consistency.</span>
<span id="cb42-121"><a href="#cb42-121" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-122"><a href="#cb42-122" aria-hidden="true" tabindex="-1"></a>üîπ Step 3: Define a Table Generation Function</span>
<span id="cb42-123"><a href="#cb42-123" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-124"><a href="#cb42-124" aria-hidden="true" tabindex="-1"></a>This section defines a reusable function that creates a summary table for any categorical variable of interest.</span>
<span id="cb42-125"><a href="#cb42-125" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-126"><a href="#cb42-126" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, eval=FALSE}</span></span>
<span id="cb42-127"><a href="#cb42-127" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-128"><a href="#cb42-128" aria-hidden="true" tabindex="-1"></a><span class="in">create_tab &lt;- function(data, var, label) {</span></span>
<span id="cb42-129"><a href="#cb42-129" aria-hidden="true" tabindex="-1"></a><span class="in">  # Step 1: Generate counts for non-missing values</span></span>
<span id="cb42-130"><a href="#cb42-130" aria-hidden="true" tabindex="-1"></a><span class="in">  tab_main &lt;- data %&gt;%</span></span>
<span id="cb42-131"><a href="#cb42-131" aria-hidden="true" tabindex="-1"></a><span class="in">    filter(!is.na({{ var }})) %&gt;%          # Exclude missing values</span></span>
<span id="cb42-132"><a href="#cb42-132" aria-hidden="true" tabindex="-1"></a><span class="in">    tabyl({{ var }}, vacc_group3) %&gt;%      # Cross-tabulate (var √ó vaccine groups)</span></span>
<span id="cb42-133"><a href="#cb42-133" aria-hidden="true" tabindex="-1"></a><span class="in">    mutate(Category = label, .before = 1) %&gt;%  # Add category label (e.g., "Gender")</span></span>
<span id="cb42-134"><a href="#cb42-134" aria-hidden="true" tabindex="-1"></a><span class="in">    rename(Label = {{ var }}) %&gt;%           # Rename variable column for consistency</span></span>
<span id="cb42-135"><a href="#cb42-135" aria-hidden="true" tabindex="-1"></a><span class="in">    mutate(Label = as.character(Label))     # Ensure labels are text</span></span>
<span id="cb42-136"><a href="#cb42-136" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-137"><a href="#cb42-137" aria-hidden="true" tabindex="-1"></a><span class="in">  # Step 2: Check for and append missing values (if any)</span></span>
<span id="cb42-138"><a href="#cb42-138" aria-hidden="true" tabindex="-1"></a><span class="in">  na_count &lt;- sum(is.na(pull(data, {{ var }})))</span></span>
<span id="cb42-139"><a href="#cb42-139" aria-hidden="true" tabindex="-1"></a><span class="in">  if (na_count &gt; 0) {</span></span>
<span id="cb42-140"><a href="#cb42-140" aria-hidden="true" tabindex="-1"></a><span class="in">    missing_row &lt;- tibble(</span></span>
<span id="cb42-141"><a href="#cb42-141" aria-hidden="true" tabindex="-1"></a><span class="in">      Category = label,</span></span>
<span id="cb42-142"><a href="#cb42-142" aria-hidden="true" tabindex="-1"></a><span class="in">      Label = "Missing",</span></span>
<span id="cb42-143"><a href="#cb42-143" aria-hidden="true" tabindex="-1"></a><span class="in">      `Respiratory vaccines` = sum(data$vacc_group3 == "Respiratory vaccines" &amp; is.na(pull(data, {{ var }})), na.rm = TRUE),</span></span>
<span id="cb42-144"><a href="#cb42-144" aria-hidden="true" tabindex="-1"></a><span class="in">      ...  # Similar for other vaccine groups</span></span>
<span id="cb42-145"><a href="#cb42-145" aria-hidden="true" tabindex="-1"></a><span class="in">    )</span></span>
<span id="cb42-146"><a href="#cb42-146" aria-hidden="true" tabindex="-1"></a><span class="in">    tab_final &lt;- bind_rows(tab_main, missing_row)  # Combine with main table</span></span>
<span id="cb42-147"><a href="#cb42-147" aria-hidden="true" tabindex="-1"></a><span class="in">  } else {</span></span>
<span id="cb42-148"><a href="#cb42-148" aria-hidden="true" tabindex="-1"></a><span class="in">    tab_final &lt;- tab_main</span></span>
<span id="cb42-149"><a href="#cb42-149" aria-hidden="true" tabindex="-1"></a><span class="in">  }</span></span>
<span id="cb42-150"><a href="#cb42-150" aria-hidden="true" tabindex="-1"></a><span class="in">  return(tab_final)</span></span>
<span id="cb42-151"><a href="#cb42-151" aria-hidden="true" tabindex="-1"></a><span class="in">}</span></span>
<span id="cb42-152"><a href="#cb42-152" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb42-153"><a href="#cb42-153" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-154"><a href="#cb42-154" aria-hidden="true" tabindex="-1"></a>Let's break it down:</span>
<span id="cb42-155"><a href="#cb42-155" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-156"><a href="#cb42-156" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**`data`**: The full dataset (<span class="in">`vacc_1524`</span>) you are analyzing.</span>
<span id="cb42-157"><a href="#cb42-157" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-158"><a href="#cb42-158" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**`var`**: A single categorical variable (e.g., <span class="in">`age_group`</span>) whose values will appear as rows.</span>
<span id="cb42-159"><a href="#cb42-159" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-160"><a href="#cb42-160" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**`label`**: A string label that describes the variable for the final table (e.g., <span class="in">`"Age"`</span>).</span>
<span id="cb42-161"><a href="#cb42-161" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-162"><a href="#cb42-162" aria-hidden="true" tabindex="-1"></a>Inside the function:</span>
<span id="cb42-163"><a href="#cb42-163" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-164"><a href="#cb42-164" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>We filter out missing values temporarily to generate the main table using tabyl().</span>
<span id="cb42-165"><a href="#cb42-165" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-166"><a href="#cb42-166" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>We count and append missing entries separately, if any.</span>
<span id="cb42-167"><a href="#cb42-167" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-168"><a href="#cb42-168" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>We return a single tibble containing counts across vaccine groups by value of the selected variable.</span>
<span id="cb42-169"><a href="#cb42-169" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-170"><a href="#cb42-170" aria-hidden="true" tabindex="-1"></a>This abstraction allows us to apply one function to multiple variables.</span>
<span id="cb42-171"><a href="#cb42-171" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-172"><a href="#cb42-172" aria-hidden="true" tabindex="-1"></a>üîπ Step 4: Generate Summary Tables for Each Variable</span>
<span id="cb42-173"><a href="#cb42-173" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-174"><a href="#cb42-174" aria-hidden="true" tabindex="-1"></a>The code below creates summary tables for several key variables: age, gender, marital status, service year, quarter, and weekday.</span>
<span id="cb42-175"><a href="#cb42-175" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-176"><a href="#cb42-176" aria-hidden="true" tabindex="-1"></a><span class="in">```{r eval=FALSE}</span></span>
<span id="cb42-177"><a href="#cb42-177" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-178"><a href="#cb42-178" aria-hidden="true" tabindex="-1"></a><span class="in">tab_age            &lt;- create_tab(vacc_1524, age_group, "Age")</span></span>
<span id="cb42-179"><a href="#cb42-179" aria-hidden="true" tabindex="-1"></a><span class="in">tab_sex            &lt;- create_tab(vacc_1524, gender, "Gender")</span></span>
<span id="cb42-180"><a href="#cb42-180" aria-hidden="true" tabindex="-1"></a><span class="in">tab_marital_status &lt;- create_tab(vacc_1524, marital_status, "Marital status")</span></span>
<span id="cb42-181"><a href="#cb42-181" aria-hidden="true" tabindex="-1"></a><span class="in">tab_year           &lt;- create_tab(vacc_1524, vacc_service_year, "Year")</span></span>
<span id="cb42-182"><a href="#cb42-182" aria-hidden="true" tabindex="-1"></a><span class="in">tab_quarter        &lt;- create_tab(vacc_1524, vacc_quarter, "Quarter")</span></span>
<span id="cb42-183"><a href="#cb42-183" aria-hidden="true" tabindex="-1"></a><span class="in">tab_weekday        &lt;- create_tab(vacc_1524, vacc_weekday, "Weekday")</span></span>
<span id="cb42-184"><a href="#cb42-184" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-185"><a href="#cb42-185" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb42-186"><a href="#cb42-186" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-187"><a href="#cb42-187" aria-hidden="true" tabindex="-1"></a>Each result is a well-structured table of vaccine uptake by subgroup.</span>
<span id="cb42-188"><a href="#cb42-188" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-189"><a href="#cb42-189" aria-hidden="true" tabindex="-1"></a>üîπ Step 5: Combine All Summary Tables</span>
<span id="cb42-190"><a href="#cb42-190" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-191"><a href="#cb42-191" aria-hidden="true" tabindex="-1"></a>Here, we merge the results into one combined table that can be styled and displayed together.</span>
<span id="cb42-192"><a href="#cb42-192" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-193"><a href="#cb42-193" aria-hidden="true" tabindex="-1"></a><span class="in">```{r eval=FALSE}</span></span>
<span id="cb42-194"><a href="#cb42-194" aria-hidden="true" tabindex="-1"></a><span class="in">tab_combined &lt;- bind_rows(tab_sex, tab_age, tab_marital_status, tab_year, tab_quarter, tab_weekday)</span></span>
<span id="cb42-195"><a href="#cb42-195" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-196"><a href="#cb42-196" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb42-197"><a href="#cb42-197" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-198"><a href="#cb42-198" aria-hidden="true" tabindex="-1"></a>We are now working with one long-format table that contains all the variables of interest.</span>
<span id="cb42-199"><a href="#cb42-199" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-200"><a href="#cb42-200" aria-hidden="true" tabindex="-1"></a>üîπ Step 6: Calculate Row-Wise Percentages and Format Counts</span>
<span id="cb42-201"><a href="#cb42-201" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-202"><a href="#cb42-202" aria-hidden="true" tabindex="-1"></a>Next, I add percentages for each vaccine type within a row (e.g., among all women aged 20‚Äì29, what percent received respiratory vaccines?). I also format the counts with commas for easier reading.</span>
<span id="cb42-203"><a href="#cb42-203" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-204"><a href="#cb42-204" aria-hidden="true" tabindex="-1"></a><span class="in">```{r eval=FALSE}</span></span>
<span id="cb42-205"><a href="#cb42-205" aria-hidden="true" tabindex="-1"></a><span class="in">tab_combined &lt;- tab_combined %&gt;%</span></span>
<span id="cb42-206"><a href="#cb42-206" aria-hidden="true" tabindex="-1"></a><span class="in">  rowwise() %&gt;%</span></span>
<span id="cb42-207"><a href="#cb42-207" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(</span></span>
<span id="cb42-208"><a href="#cb42-208" aria-hidden="true" tabindex="-1"></a><span class="in">    Total = sum(`Respiratory vaccines`, `Childhood vaccines`, Other, na.rm = TRUE),</span></span>
<span id="cb42-209"><a href="#cb42-209" aria-hidden="true" tabindex="-1"></a><span class="in">    is_missing = trimws(tolower(Label)) == "missing",</span></span>
<span id="cb42-210"><a href="#cb42-210" aria-hidden="true" tabindex="-1"></a><span class="in">    </span></span>
<span id="cb42-211"><a href="#cb42-211" aria-hidden="true" tabindex="-1"></a><span class="in">    Respiratory = ifelse(is_missing,</span></span>
<span id="cb42-212"><a href="#cb42-212" aria-hidden="true" tabindex="-1"></a><span class="in">                         comma(`Respiratory vaccines`),</span></span>
<span id="cb42-213"><a href="#cb42-213" aria-hidden="true" tabindex="-1"></a><span class="in">                         paste0(comma(`Respiratory vaccines`), " (", round(100 * `Respiratory vaccines` / Total, 1), ")")),</span></span>
<span id="cb42-214"><a href="#cb42-214" aria-hidden="true" tabindex="-1"></a><span class="in">    </span></span>
<span id="cb42-215"><a href="#cb42-215" aria-hidden="true" tabindex="-1"></a><span class="in">    Childhood = ifelse(is_missing,</span></span>
<span id="cb42-216"><a href="#cb42-216" aria-hidden="true" tabindex="-1"></a><span class="in">                       comma(`Childhood vaccines`),</span></span>
<span id="cb42-217"><a href="#cb42-217" aria-hidden="true" tabindex="-1"></a><span class="in">                       paste0(comma(`Childhood vaccines`), " (", round(100 * `Childhood vaccines` / Total, 1), ")")),</span></span>
<span id="cb42-218"><a href="#cb42-218" aria-hidden="true" tabindex="-1"></a><span class="in">    </span></span>
<span id="cb42-219"><a href="#cb42-219" aria-hidden="true" tabindex="-1"></a><span class="in">    Other_grp = ifelse(is_missing,</span></span>
<span id="cb42-220"><a href="#cb42-220" aria-hidden="true" tabindex="-1"></a><span class="in">                       comma(Other),</span></span>
<span id="cb42-221"><a href="#cb42-221" aria-hidden="true" tabindex="-1"></a><span class="in">                       paste0(comma(Other), " (", round(100 * Other / Total, 1), ")"))</span></span>
<span id="cb42-222"><a href="#cb42-222" aria-hidden="true" tabindex="-1"></a><span class="in">  ) %&gt;%</span></span>
<span id="cb42-223"><a href="#cb42-223" aria-hidden="true" tabindex="-1"></a><span class="in">  ungroup() %&gt;%</span></span>
<span id="cb42-224"><a href="#cb42-224" aria-hidden="true" tabindex="-1"></a><span class="in">  select(Category, Label, Respiratory, Childhood, Other_grp)</span></span>
<span id="cb42-225"><a href="#cb42-225" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb42-226"><a href="#cb42-226" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-227"><a href="#cb42-227" aria-hidden="true" tabindex="-1"></a>üëâ Note: We skip calculating percentages for ‚ÄúMissing‚Äù rows to avoid misleading results.</span>
<span id="cb42-228"><a href="#cb42-228" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-229"><a href="#cb42-229" aria-hidden="true" tabindex="-1"></a>üîπ Step 7: Show Category Name Once per Block</span>
<span id="cb42-230"><a href="#cb42-230" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-231"><a href="#cb42-231" aria-hidden="true" tabindex="-1"></a>To improve readability, I only show the category name (like "Age" or "Gender") once per group.</span>
<span id="cb42-232"><a href="#cb42-232" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-233"><a href="#cb42-233" aria-hidden="true" tabindex="-1"></a><span class="in">```{r eval=FALSE}</span></span>
<span id="cb42-234"><a href="#cb42-234" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-235"><a href="#cb42-235" aria-hidden="true" tabindex="-1"></a><span class="in">tab_combined &lt;- tab_combined %&gt;%</span></span>
<span id="cb42-236"><a href="#cb42-236" aria-hidden="true" tabindex="-1"></a><span class="in">  group_by(Category) %&gt;%</span></span>
<span id="cb42-237"><a href="#cb42-237" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(Category = ifelse(row_number() == 1, Category, "")) %&gt;%</span></span>
<span id="cb42-238"><a href="#cb42-238" aria-hidden="true" tabindex="-1"></a><span class="in">  ungroup()</span></span>
<span id="cb42-239"><a href="#cb42-239" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb42-240"><a href="#cb42-240" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-241"><a href="#cb42-241" aria-hidden="true" tabindex="-1"></a>üîπ Step 8: Count Total Vaccine Recipients (for Header Labels)</span>
<span id="cb42-242"><a href="#cb42-242" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-243"><a href="#cb42-243" aria-hidden="true" tabindex="-1"></a>We calculate the total number of people who received each type of vaccine to include in the header row.</span>
<span id="cb42-244"><a href="#cb42-244" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-245"><a href="#cb42-245" aria-hidden="true" tabindex="-1"></a><span class="in">```{r eval=FALSE}</span></span>
<span id="cb42-246"><a href="#cb42-246" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-247"><a href="#cb42-247" aria-hidden="true" tabindex="-1"></a><span class="in">totals &lt;- vacc_1524 %&gt;%   count(vacc_group3) %&gt;%   deframe()</span></span>
<span id="cb42-248"><a href="#cb42-248" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb42-249"><a href="#cb42-249" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-250"><a href="#cb42-250" aria-hidden="true" tabindex="-1"></a>üîπ Step 9: Style the Table Using <span class="in">`{flextable}`</span></span>
<span id="cb42-251"><a href="#cb42-251" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-252"><a href="#cb42-252" aria-hidden="true" tabindex="-1"></a>Now comes the fun part! We format and stylize the table with headers, font choices, alternating colors, and footnotes. This creates a visually appealing table suitable for publication.</span>
<span id="cb42-253"><a href="#cb42-253" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-254"><a href="#cb42-254" aria-hidden="true" tabindex="-1"></a><span class="in">```{r eval=FALSE}</span></span>
<span id="cb42-255"><a href="#cb42-255" aria-hidden="true" tabindex="-1"></a><span class="in"># ft_vacc_summary &lt;- tab_combined %&gt;%   flextable() %&gt;%   set_header_labels(...) %&gt;%   add_header_row(...) %&gt;%   add_header_row(...) %&gt;%   theme_box() %&gt;%   set_table_properties(layout = "autofit", width = 1) %&gt;%   width(...) %&gt;%   align(align = "justify", part = "all") %&gt;%   border_remove() %&gt;%   set_caption(...) %&gt;%   fontsize(...) %&gt;%   font(part = "all", fontname = "Times New Roman") %&gt;%   bg(part = "header", bg = "lightblue") %&gt;%   bg(j = 1:5, i = seq(1, nrow(tab_combined), 2), bg = "lightgray") %&gt;%   bg(j = 1:5, i = seq(2, nrow(tab_combined), 2), bg = "red") %&gt;%   footnote(...)</span></span>
<span id="cb42-256"><a href="#cb42-256" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb42-257"><a href="#cb42-257" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-258"><a href="#cb42-258" aria-hidden="true" tabindex="-1"></a>**Key Steps**:</span>
<span id="cb42-259"><a href="#cb42-259" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-260"><a href="#cb42-260" aria-hidden="true" tabindex="-1"></a><span class="ss">1.  </span>**Set Headers**: Labels columns appropriately such as including multi-row headers that describe each vaccine group with sample size (N)</span>
<span id="cb42-261"><a href="#cb42-261" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-262"><a href="#cb42-262" aria-hidden="true" tabindex="-1"></a><span class="ss">2.  </span>**Add Header Rows**: Includes multi-level headers for clarity.</span>
<span id="cb42-263"><a href="#cb42-263" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-264"><a href="#cb42-264" aria-hidden="true" tabindex="-1"></a><span class="ss">3.  </span>**Themes and Layout**: Applies a boxed theme, adjusts column widths, and aligns text.</span>
<span id="cb42-265"><a href="#cb42-265" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-266"><a href="#cb42-266" aria-hidden="true" tabindex="-1"></a><span class="ss">4.  </span>**Font and Colors**: Uses "Times New Roman" and alternates row colors (e.g., gray and red) for better visuals.</span>
<span id="cb42-267"><a href="#cb42-267" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-268"><a href="#cb42-268" aria-hidden="true" tabindex="-1"></a><span class="ss">5.  </span>**Add Captions, Superscripts and Footnotes**: Provides context to the table.</span>
<span id="cb42-269"><a href="#cb42-269" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-270"><a href="#cb42-270" aria-hidden="true" tabindex="-1"></a>üîπ Step 10: Display the Table</span>
<span id="cb42-271"><a href="#cb42-271" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-272"><a href="#cb42-272" aria-hidden="true" tabindex="-1"></a>üîπ Step 11: Clean Up Temporary Objects</span>
<span id="cb42-273"><a href="#cb42-273" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-274"><a href="#cb42-274" aria-hidden="true" tabindex="-1"></a>To keep your R environment tidy, we remove the temporary tables and variables created along the way.</span>
<span id="cb42-275"><a href="#cb42-275" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-276"><a href="#cb42-276" aria-hidden="true" tabindex="-1"></a><span class="in">```{r eval=FALSE}</span></span>
<span id="cb42-277"><a href="#cb42-277" aria-hidden="true" tabindex="-1"></a><span class="in">rm(tab_age, tab_sex, tab_marital_status, tab_year, tab_quarter, tab_weekday,     tab_combined, ft_vacc_summary, totals, create_tab)</span></span>
<span id="cb42-278"><a href="#cb42-278" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb42-279"><a href="#cb42-279" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-280"><a href="#cb42-280" aria-hidden="true" tabindex="-1"></a><span class="fu">## **1. Table Without Title and Footer**</span></span>
<span id="cb42-281"><a href="#cb42-281" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-282"><a href="#cb42-282" aria-hidden="true" tabindex="-1"></a>This section introduces a basic version of the automated table‚Äîminimal and clean without captions or footnotes.</span>
<span id="cb42-283"><a href="#cb42-283" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-284"><a href="#cb42-284" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**Why it matters**: A stripped-down table is great for quick previews or inline summaries.</span>
<span id="cb42-285"><a href="#cb42-285" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-286"><a href="#cb42-286" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**When to use**: Internal drafts, early analysis stages, or dashboards.</span>
<span id="cb42-287"><a href="#cb42-287" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-288"><a href="#cb42-288" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Ensure grouping variables are characters to avoid formatting issues.</span>
<span id="cb42-289"><a href="#cb42-289" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-290"><a href="#cb42-290" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Build one reusable function (<span class="in">`create_tab`</span>) to apply across multiple variables.</span>
<span id="cb42-291"><a href="#cb42-291" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-292"><a href="#cb42-292" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Bind all summary tables into a combined format.</span>
<span id="cb42-293"><a href="#cb42-293" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-294"><a href="#cb42-294" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Add row-wise percentages directly to the table.</span>
<span id="cb42-295"><a href="#cb42-295" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-298"><a href="#cb42-298" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb42-299"><a href="#cb42-299" aria-hidden="true" tabindex="-1"></a><span class="co"># ------------1. Table without title and footer -------------------------------------------+</span></span>
<span id="cb42-300"><a href="#cb42-300" aria-hidden="true" tabindex="-1"></a><span class="co">#.......................Ensure grouping variables are characters............................</span></span>
<span id="cb42-301"><a href="#cb42-301" aria-hidden="true" tabindex="-1"></a>vacc_1524 <span class="ot">&lt;-</span> vacc_1524 <span class="sc">%&gt;%</span></span>
<span id="cb42-302"><a href="#cb42-302" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">c</span>(vacc_service_year, vacc_quarter, vacc_weekday), as.character))</span>
<span id="cb42-303"><a href="#cb42-303" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-304"><a href="#cb42-304" aria-hidden="true" tabindex="-1"></a><span class="co"># ---------------- Table generation function ....................</span></span>
<span id="cb42-305"><a href="#cb42-305" aria-hidden="true" tabindex="-1"></a>create_tab <span class="ot">&lt;-</span> <span class="cf">function</span>(data, var, label) {</span>
<span id="cb42-306"><a href="#cb42-306" aria-hidden="true" tabindex="-1"></a>  data <span class="sc">%&gt;%</span></span>
<span id="cb42-307"><a href="#cb42-307" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>({{ var }})) <span class="sc">%&gt;%</span></span>
<span id="cb42-308"><a href="#cb42-308" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tabyl</span>({{ var }}, vacc_group3) <span class="sc">%&gt;%</span></span>
<span id="cb42-309"><a href="#cb42-309" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">Category =</span> label, <span class="at">.before =</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb42-310"><a href="#cb42-310" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rename</span>(<span class="at">Label =</span> {{ var }}) <span class="sc">%&gt;%</span></span>
<span id="cb42-311"><a href="#cb42-311" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">Label =</span> <span class="fu">as.character</span>(Label))</span>
<span id="cb42-312"><a href="#cb42-312" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb42-313"><a href="#cb42-313" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-314"><a href="#cb42-314" aria-hidden="true" tabindex="-1"></a><span class="co"># .................... Create summary tables ....................</span></span>
<span id="cb42-315"><a href="#cb42-315" aria-hidden="true" tabindex="-1"></a>tab_age <span class="ot">&lt;-</span> <span class="fu">create_tab</span>(vacc_1524, age_group, <span class="st">"Age"</span>)</span>
<span id="cb42-316"><a href="#cb42-316" aria-hidden="true" tabindex="-1"></a>tab_sex <span class="ot">&lt;-</span> <span class="fu">create_tab</span>(vacc_1524, gender, <span class="st">"Gender"</span>)</span>
<span id="cb42-317"><a href="#cb42-317" aria-hidden="true" tabindex="-1"></a>tab_marital_status <span class="ot">&lt;-</span> <span class="fu">create_tab</span>(vacc_1524, marital_status, <span class="st">"Marital status"</span>)</span>
<span id="cb42-318"><a href="#cb42-318" aria-hidden="true" tabindex="-1"></a>tab_year    <span class="ot">&lt;-</span> <span class="fu">create_tab</span>(vacc_1524, vacc_service_year, <span class="st">"Year"</span>)</span>
<span id="cb42-319"><a href="#cb42-319" aria-hidden="true" tabindex="-1"></a>tab_quarter <span class="ot">&lt;-</span> <span class="fu">create_tab</span>(vacc_1524, vacc_quarter, <span class="st">"Quarter"</span>)</span>
<span id="cb42-320"><a href="#cb42-320" aria-hidden="true" tabindex="-1"></a>tab_weekday <span class="ot">&lt;-</span> <span class="fu">create_tab</span>(vacc_1524, vacc_weekday, <span class="st">"Weekday"</span>)</span>
<span id="cb42-321"><a href="#cb42-321" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-322"><a href="#cb42-322" aria-hidden="true" tabindex="-1"></a><span class="co"># ......................Combine all tabs ....................</span></span>
<span id="cb42-323"><a href="#cb42-323" aria-hidden="true" tabindex="-1"></a>tab_combined <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(tab_sex, tab_age, tab_marital_status, tab_year, tab_quarter, tab_weekday)</span>
<span id="cb42-324"><a href="#cb42-324" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-325"><a href="#cb42-325" aria-hidden="true" tabindex="-1"></a><span class="co"># ....................... Create row % and format as text ....................</span></span>
<span id="cb42-326"><a href="#cb42-326" aria-hidden="true" tabindex="-1"></a>tab_combined <span class="ot">&lt;-</span> tab_combined <span class="sc">%&gt;%</span></span>
<span id="cb42-327"><a href="#cb42-327" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rowwise</span>() <span class="sc">%&gt;%</span></span>
<span id="cb42-328"><a href="#cb42-328" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb42-329"><a href="#cb42-329" aria-hidden="true" tabindex="-1"></a>    <span class="at">Total =</span> <span class="fu">sum</span>(<span class="st">`</span><span class="at">Respiratory vaccines</span><span class="st">`</span>, <span class="st">`</span><span class="at">Childhood vaccines</span><span class="st">`</span>, Other, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb42-330"><a href="#cb42-330" aria-hidden="true" tabindex="-1"></a>    <span class="at">Respiratory =</span> <span class="fu">paste0</span>(<span class="fu">comma</span>(<span class="st">`</span><span class="at">Respiratory vaccines</span><span class="st">`</span>), <span class="st">" ("</span>, <span class="fu">round</span>(<span class="dv">100</span> <span class="sc">*</span> <span class="st">`</span><span class="at">Respiratory vaccines</span><span class="st">`</span> <span class="sc">/</span> Total, <span class="dv">1</span>), <span class="st">")"</span>),</span>
<span id="cb42-331"><a href="#cb42-331" aria-hidden="true" tabindex="-1"></a>    <span class="at">Childhood   =</span> <span class="fu">paste0</span>(<span class="fu">comma</span>(<span class="st">`</span><span class="at">Childhood vaccines</span><span class="st">`</span>), <span class="st">" ("</span>, <span class="fu">round</span>(<span class="dv">100</span> <span class="sc">*</span> <span class="st">`</span><span class="at">Childhood vaccines</span><span class="st">`</span> <span class="sc">/</span> Total, <span class="dv">1</span>), <span class="st">")"</span>),</span>
<span id="cb42-332"><a href="#cb42-332" aria-hidden="true" tabindex="-1"></a>    <span class="at">Other_grp   =</span> <span class="fu">paste0</span>(<span class="fu">comma</span>(Other), <span class="st">" ("</span>, <span class="fu">round</span>(<span class="dv">100</span> <span class="sc">*</span> Other <span class="sc">/</span> Total, <span class="dv">1</span>), <span class="st">")"</span>)</span>
<span id="cb42-333"><a href="#cb42-333" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb42-334"><a href="#cb42-334" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb42-335"><a href="#cb42-335" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-336"><a href="#cb42-336" aria-hidden="true" tabindex="-1"></a><span class="co"># ............................. Remove repeated variable names ....................</span></span>
<span id="cb42-337"><a href="#cb42-337" aria-hidden="true" tabindex="-1"></a>tab_combined <span class="ot">&lt;-</span> tab_combined <span class="sc">%&gt;%</span></span>
<span id="cb42-338"><a href="#cb42-338" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Category) <span class="sc">%&gt;%</span></span>
<span id="cb42-339"><a href="#cb42-339" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Category =</span> <span class="fu">ifelse</span>(<span class="fu">row_number</span>() <span class="sc">==</span> <span class="dv">1</span>, Category, <span class="st">""</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb42-340"><a href="#cb42-340" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb42-341"><a href="#cb42-341" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-342"><a href="#cb42-342" aria-hidden="true" tabindex="-1"></a><span class="co"># ........................... Get total counts per vaccine group ....................</span></span>
<span id="cb42-343"><a href="#cb42-343" aria-hidden="true" tabindex="-1"></a>totals <span class="ot">&lt;-</span> vacc_1524 <span class="sc">%&gt;%</span></span>
<span id="cb42-344"><a href="#cb42-344" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(vacc_group3) <span class="sc">%&gt;%</span></span>
<span id="cb42-345"><a href="#cb42-345" aria-hidden="true" tabindex="-1"></a>  <span class="fu">deframe</span>()</span>
<span id="cb42-346"><a href="#cb42-346" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-347"><a href="#cb42-347" aria-hidden="true" tabindex="-1"></a><span class="co"># .................... Create flextable ....................</span></span>
<span id="cb42-348"><a href="#cb42-348" aria-hidden="true" tabindex="-1"></a>ft_vacc_summary <span class="ot">&lt;-</span> tab_combined <span class="sc">%&gt;%</span></span>
<span id="cb42-349"><a href="#cb42-349" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Category, Label, Respiratory, Childhood, Other_grp) <span class="sc">%&gt;%</span></span>
<span id="cb42-350"><a href="#cb42-350" aria-hidden="true" tabindex="-1"></a>  <span class="fu">flextable</span>() <span class="sc">%&gt;%</span></span>
<span id="cb42-351"><a href="#cb42-351" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_header_labels</span>(</span>
<span id="cb42-352"><a href="#cb42-352" aria-hidden="true" tabindex="-1"></a>    <span class="at">Category =</span> <span class="st">"Variable type"</span>,</span>
<span id="cb42-353"><a href="#cb42-353" aria-hidden="true" tabindex="-1"></a>    <span class="at">Label =</span> <span class="st">"Values"</span>,</span>
<span id="cb42-354"><a href="#cb42-354" aria-hidden="true" tabindex="-1"></a>    <span class="at">Respiratory =</span> <span class="st">"Number (%)·µÉ"</span>,</span>
<span id="cb42-355"><a href="#cb42-355" aria-hidden="true" tabindex="-1"></a>    <span class="at">Childhood =</span> <span class="st">"Number (%)·µÉ"</span>,</span>
<span id="cb42-356"><a href="#cb42-356" aria-hidden="true" tabindex="-1"></a>    <span class="at">Other_grp =</span> <span class="st">"Number (%)·µÉ"</span></span>
<span id="cb42-357"><a href="#cb42-357" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb42-358"><a href="#cb42-358" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_header_row</span>( <span class="co"># Second row</span></span>
<span id="cb42-359"><a href="#cb42-359" aria-hidden="true" tabindex="-1"></a>    <span class="at">values =</span> <span class="fu">c</span>(</span>
<span id="cb42-360"><a href="#cb42-360" aria-hidden="true" tabindex="-1"></a>      <span class="st">""</span>, <span class="st">""</span>,</span>
<span id="cb42-361"><a href="#cb42-361" aria-hidden="true" tabindex="-1"></a>      <span class="fu">paste0</span>(<span class="st">"Respiratory vaccines (N = "</span>, <span class="fu">format</span>(totals[<span class="st">"Respiratory vaccines"</span>], <span class="at">big.mark =</span> <span class="st">","</span>), <span class="st">")"</span>),</span>
<span id="cb42-362"><a href="#cb42-362" aria-hidden="true" tabindex="-1"></a>      <span class="fu">paste0</span>(<span class="st">"Childhood vaccines (N = "</span>, <span class="fu">format</span>(totals[<span class="st">"Childhood vaccines"</span>], <span class="at">big.mark =</span> <span class="st">","</span>), <span class="st">")"</span>),</span>
<span id="cb42-363"><a href="#cb42-363" aria-hidden="true" tabindex="-1"></a>      <span class="fu">paste0</span>(<span class="st">"Other (N = "</span>, <span class="fu">format</span>(totals[<span class="st">"Other"</span>], <span class="at">big.mark =</span> <span class="st">","</span>), <span class="st">")"</span>)</span>
<span id="cb42-364"><a href="#cb42-364" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb42-365"><a href="#cb42-365" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb42-366"><a href="#cb42-366" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_header_row</span>( <span class="co"># First row (merged header)</span></span>
<span id="cb42-367"><a href="#cb42-367" aria-hidden="true" tabindex="-1"></a>    <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"Description"</span>, <span class="st">"Vaccination uptake"</span>),</span>
<span id="cb42-368"><a href="#cb42-368" aria-hidden="true" tabindex="-1"></a>    <span class="at">colwidths =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">3</span>)</span>
<span id="cb42-369"><a href="#cb42-369" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb42-370"><a href="#cb42-370" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_box</span>() <span class="sc">%&gt;%</span></span>
<span id="cb42-371"><a href="#cb42-371" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_table_properties</span>(<span class="at">layout =</span> <span class="st">"autofit"</span>, <span class="at">width =</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb42-372"><a href="#cb42-372" aria-hidden="true" tabindex="-1"></a>  <span class="fu">width</span>(<span class="at">j =</span> <span class="dv">1</span>, <span class="at">width =</span> <span class="fl">1.5</span>) <span class="sc">%&gt;%</span></span>
<span id="cb42-373"><a href="#cb42-373" aria-hidden="true" tabindex="-1"></a>  <span class="fu">width</span>(<span class="at">j =</span> <span class="dv">2</span>, <span class="at">width =</span> <span class="fl">2.5</span>) <span class="sc">%&gt;%</span></span>
<span id="cb42-374"><a href="#cb42-374" aria-hidden="true" tabindex="-1"></a>  <span class="fu">width</span>(<span class="at">j =</span> <span class="dv">3</span><span class="sc">:</span><span class="dv">4</span>, <span class="at">width =</span> <span class="fl">1.5</span>) <span class="sc">%&gt;%</span></span>
<span id="cb42-375"><a href="#cb42-375" aria-hidden="true" tabindex="-1"></a>  <span class="fu">align</span>(<span class="at">align =</span> <span class="st">"justify"</span>, <span class="at">part =</span> <span class="st">"all"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb42-376"><a href="#cb42-376" aria-hidden="true" tabindex="-1"></a>  <span class="fu">border_remove</span>() <span class="sc">%&gt;%</span></span>
<span id="cb42-377"><a href="#cb42-377" aria-hidden="true" tabindex="-1"></a>  <span class="fu">border</span>(<span class="at">part =</span> <span class="st">"header"</span>, <span class="at">i =</span> <span class="dv">1</span>, <span class="at">border.top =</span> <span class="fu">fp_border</span>(<span class="at">color =</span> <span class="st">"black"</span>, <span class="at">width =</span> <span class="dv">1</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb42-378"><a href="#cb42-378" aria-hidden="true" tabindex="-1"></a>  <span class="fu">border</span>(<span class="at">part =</span> <span class="st">"header"</span>, <span class="at">i =</span> <span class="dv">3</span>, <span class="at">border.bottom =</span> <span class="fu">fp_border</span>(<span class="at">color =</span> <span class="st">"black"</span>, <span class="at">width =</span> <span class="dv">1</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb42-379"><a href="#cb42-379" aria-hidden="true" tabindex="-1"></a>  <span class="fu">border_inner_h</span>(<span class="at">part =</span> <span class="st">"header"</span>, <span class="at">border =</span> <span class="fu">fp_border</span>(<span class="at">color =</span> <span class="st">"black"</span>, <span class="at">width =</span> <span class="fl">0.8</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb42-380"><a href="#cb42-380" aria-hidden="true" tabindex="-1"></a>  <span class="fu">border_inner_h</span>(<span class="at">part =</span> <span class="st">"body"</span>, <span class="at">border =</span> <span class="fu">fp_border</span>(<span class="at">color =</span> <span class="st">"black"</span>, <span class="at">width =</span> <span class="fl">0.8</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb42-381"><a href="#cb42-381" aria-hidden="true" tabindex="-1"></a>  <span class="fu">border</span>(<span class="at">part =</span> <span class="st">"body"</span>, <span class="at">i =</span> <span class="fu">nrow</span>(tab_combined), <span class="at">border.bottom =</span> <span class="fu">fp_border</span>(<span class="at">color =</span> <span class="st">"black"</span>, <span class="at">width =</span> <span class="dv">1</span>)) </span>
<span id="cb42-382"><a href="#cb42-382" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb42-383"><a href="#cb42-383" aria-hidden="true" tabindex="-1"></a><span class="co"># --- Display the table ---</span></span>
<span id="cb42-384"><a href="#cb42-384" aria-hidden="true" tabindex="-1"></a>ft_vacc_summary</span>
<span id="cb42-385"><a href="#cb42-385" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-386"><a href="#cb42-386" aria-hidden="true" tabindex="-1"></a><span class="co"># --- Clean up environment ---</span></span>
<span id="cb42-387"><a href="#cb42-387" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(tab_year, tab_quarter, tab_weekday, tab_combined, totals, create_tab, ft_vacc_summary)</span>
<span id="cb42-388"><a href="#cb42-388" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-389"><a href="#cb42-389" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb42-390"><a href="#cb42-390" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-391"><a href="#cb42-391" aria-hidden="true" tabindex="-1"></a><span class="fu">## **2 Table With Title and Footer**</span></span>
<span id="cb42-392"><a href="#cb42-392" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-393"><a href="#cb42-393" aria-hidden="true" tabindex="-1"></a>This extends the previous section by including a clear **table caption** and an explanatory **footnote**.</span>
<span id="cb42-394"><a href="#cb42-394" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-395"><a href="#cb42-395" aria-hidden="true" tabindex="-1"></a>üßæ *Why this is important*:</span>
<span id="cb42-396"><a href="#cb42-396" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-397"><a href="#cb42-397" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Captions add context‚Äîespecially in reports.</span>
<span id="cb42-398"><a href="#cb42-398" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-399"><a href="#cb42-399" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Footnotes help clarify how metrics are calculated (e.g., row percentages).</span>
<span id="cb42-400"><a href="#cb42-400" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-401"><a href="#cb42-401" aria-hidden="true" tabindex="-1"></a>üìò *Best used when*: Preparing for publication, stakeholder presentations, or final reports.</span>
<span id="cb42-402"><a href="#cb42-402" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-405"><a href="#cb42-405" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb42-406"><a href="#cb42-406" aria-hidden="true" tabindex="-1"></a><span class="co"># ------------2. Table with Title and Footer -------------------------------------------</span></span>
<span id="cb42-407"><a href="#cb42-407" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-408"><a href="#cb42-408" aria-hidden="true" tabindex="-1"></a><span class="co">#.......................Ensure grouping variables are characters............................</span></span>
<span id="cb42-409"><a href="#cb42-409" aria-hidden="true" tabindex="-1"></a>vacc_1524 <span class="ot">&lt;-</span> vacc_1524 <span class="sc">%&gt;%</span></span>
<span id="cb42-410"><a href="#cb42-410" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">c</span>(vacc_service_year, vacc_quarter, vacc_weekday), as.character))</span>
<span id="cb42-411"><a href="#cb42-411" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-412"><a href="#cb42-412" aria-hidden="true" tabindex="-1"></a><span class="co"># ---------------- Table generation function ....................</span></span>
<span id="cb42-413"><a href="#cb42-413" aria-hidden="true" tabindex="-1"></a>create_tab <span class="ot">&lt;-</span> <span class="cf">function</span>(data, var, label) {</span>
<span id="cb42-414"><a href="#cb42-414" aria-hidden="true" tabindex="-1"></a>  data <span class="sc">%&gt;%</span></span>
<span id="cb42-415"><a href="#cb42-415" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>({{ var }})) <span class="sc">%&gt;%</span></span>
<span id="cb42-416"><a href="#cb42-416" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tabyl</span>({{ var }}, vacc_group3) <span class="sc">%&gt;%</span></span>
<span id="cb42-417"><a href="#cb42-417" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">Category =</span> label, <span class="at">.before =</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb42-418"><a href="#cb42-418" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rename</span>(<span class="at">Label =</span> {{ var }}) <span class="sc">%&gt;%</span></span>
<span id="cb42-419"><a href="#cb42-419" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">Label =</span> <span class="fu">as.character</span>(Label))</span>
<span id="cb42-420"><a href="#cb42-420" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb42-421"><a href="#cb42-421" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-422"><a href="#cb42-422" aria-hidden="true" tabindex="-1"></a><span class="co"># .................... Create summary tables ....................</span></span>
<span id="cb42-423"><a href="#cb42-423" aria-hidden="true" tabindex="-1"></a>tab_age <span class="ot">&lt;-</span> <span class="fu">create_tab</span>(vacc_1524, age_group, <span class="st">"Age"</span>)</span>
<span id="cb42-424"><a href="#cb42-424" aria-hidden="true" tabindex="-1"></a>tab_sex <span class="ot">&lt;-</span> <span class="fu">create_tab</span>(vacc_1524, gender, <span class="st">"Gender"</span>)</span>
<span id="cb42-425"><a href="#cb42-425" aria-hidden="true" tabindex="-1"></a>tab_marital_status <span class="ot">&lt;-</span> <span class="fu">create_tab</span>(vacc_1524, marital_status, <span class="st">"Marital status"</span>)</span>
<span id="cb42-426"><a href="#cb42-426" aria-hidden="true" tabindex="-1"></a>tab_year    <span class="ot">&lt;-</span> <span class="fu">create_tab</span>(vacc_1524, vacc_service_year, <span class="st">"Year"</span>)</span>
<span id="cb42-427"><a href="#cb42-427" aria-hidden="true" tabindex="-1"></a>tab_quarter <span class="ot">&lt;-</span> <span class="fu">create_tab</span>(vacc_1524, vacc_quarter, <span class="st">"Quarter"</span>)</span>
<span id="cb42-428"><a href="#cb42-428" aria-hidden="true" tabindex="-1"></a>tab_weekday <span class="ot">&lt;-</span> <span class="fu">create_tab</span>(vacc_1524, vacc_weekday, <span class="st">"Weekday"</span>)</span>
<span id="cb42-429"><a href="#cb42-429" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-430"><a href="#cb42-430" aria-hidden="true" tabindex="-1"></a><span class="co"># ......................Combine all tabs ....................</span></span>
<span id="cb42-431"><a href="#cb42-431" aria-hidden="true" tabindex="-1"></a>tab_combined <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(tab_sex, tab_age, tab_marital_status, tab_year, tab_quarter, tab_weekday)</span>
<span id="cb42-432"><a href="#cb42-432" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-433"><a href="#cb42-433" aria-hidden="true" tabindex="-1"></a><span class="co"># ....................... Create row % and format as text ....................</span></span>
<span id="cb42-434"><a href="#cb42-434" aria-hidden="true" tabindex="-1"></a>tab_combined <span class="ot">&lt;-</span> tab_combined <span class="sc">%&gt;%</span></span>
<span id="cb42-435"><a href="#cb42-435" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rowwise</span>() <span class="sc">%&gt;%</span></span>
<span id="cb42-436"><a href="#cb42-436" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb42-437"><a href="#cb42-437" aria-hidden="true" tabindex="-1"></a>    <span class="at">Total =</span> <span class="fu">sum</span>(<span class="st">`</span><span class="at">Respiratory vaccines</span><span class="st">`</span>, <span class="st">`</span><span class="at">Childhood vaccines</span><span class="st">`</span>, Other, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb42-438"><a href="#cb42-438" aria-hidden="true" tabindex="-1"></a>    <span class="at">Respiratory =</span> <span class="fu">paste0</span>(<span class="fu">comma</span>(<span class="st">`</span><span class="at">Respiratory vaccines</span><span class="st">`</span>), <span class="st">" ("</span>, <span class="fu">round</span>(<span class="dv">100</span> <span class="sc">*</span> <span class="st">`</span><span class="at">Respiratory vaccines</span><span class="st">`</span> <span class="sc">/</span> Total, <span class="dv">1</span>), <span class="st">")"</span>),</span>
<span id="cb42-439"><a href="#cb42-439" aria-hidden="true" tabindex="-1"></a>    <span class="at">Childhood   =</span> <span class="fu">paste0</span>(<span class="fu">comma</span>(<span class="st">`</span><span class="at">Childhood vaccines</span><span class="st">`</span>), <span class="st">" ("</span>, <span class="fu">round</span>(<span class="dv">100</span> <span class="sc">*</span> <span class="st">`</span><span class="at">Childhood vaccines</span><span class="st">`</span> <span class="sc">/</span> Total, <span class="dv">1</span>), <span class="st">")"</span>),</span>
<span id="cb42-440"><a href="#cb42-440" aria-hidden="true" tabindex="-1"></a>    <span class="at">Other_grp   =</span> <span class="fu">paste0</span>(<span class="fu">comma</span>(Other), <span class="st">" ("</span>, <span class="fu">round</span>(<span class="dv">100</span> <span class="sc">*</span> Other <span class="sc">/</span> Total, <span class="dv">1</span>), <span class="st">")"</span>)</span>
<span id="cb42-441"><a href="#cb42-441" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb42-442"><a href="#cb42-442" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb42-443"><a href="#cb42-443" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-444"><a href="#cb42-444" aria-hidden="true" tabindex="-1"></a><span class="co"># ............................. Remove repeated variable names ....................</span></span>
<span id="cb42-445"><a href="#cb42-445" aria-hidden="true" tabindex="-1"></a>tab_combined <span class="ot">&lt;-</span> tab_combined <span class="sc">%&gt;%</span></span>
<span id="cb42-446"><a href="#cb42-446" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Category) <span class="sc">%&gt;%</span></span>
<span id="cb42-447"><a href="#cb42-447" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Category =</span> <span class="fu">ifelse</span>(<span class="fu">row_number</span>() <span class="sc">==</span> <span class="dv">1</span>, Category, <span class="st">""</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb42-448"><a href="#cb42-448" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb42-449"><a href="#cb42-449" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-450"><a href="#cb42-450" aria-hidden="true" tabindex="-1"></a><span class="co"># ........................... Get total counts per vaccine group ....................</span></span>
<span id="cb42-451"><a href="#cb42-451" aria-hidden="true" tabindex="-1"></a>totals <span class="ot">&lt;-</span> vacc_1524 <span class="sc">%&gt;%</span></span>
<span id="cb42-452"><a href="#cb42-452" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(vacc_group3) <span class="sc">%&gt;%</span></span>
<span id="cb42-453"><a href="#cb42-453" aria-hidden="true" tabindex="-1"></a>  <span class="fu">deframe</span>()</span>
<span id="cb42-454"><a href="#cb42-454" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-455"><a href="#cb42-455" aria-hidden="true" tabindex="-1"></a><span class="co"># .................... Create flextable ....................</span></span>
<span id="cb42-456"><a href="#cb42-456" aria-hidden="true" tabindex="-1"></a>ft_vacc_summary <span class="ot">&lt;-</span> tab_combined <span class="sc">%&gt;%</span></span>
<span id="cb42-457"><a href="#cb42-457" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Category, Label, Respiratory, Childhood, Other_grp) <span class="sc">%&gt;%</span></span>
<span id="cb42-458"><a href="#cb42-458" aria-hidden="true" tabindex="-1"></a>  <span class="fu">flextable</span>() <span class="sc">%&gt;%</span></span>
<span id="cb42-459"><a href="#cb42-459" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_header_labels</span>(</span>
<span id="cb42-460"><a href="#cb42-460" aria-hidden="true" tabindex="-1"></a>    <span class="at">Category =</span> <span class="st">"Variable type"</span>,</span>
<span id="cb42-461"><a href="#cb42-461" aria-hidden="true" tabindex="-1"></a>    <span class="at">Label =</span> <span class="st">"Values"</span>,</span>
<span id="cb42-462"><a href="#cb42-462" aria-hidden="true" tabindex="-1"></a>    <span class="at">Respiratory =</span> <span class="st">"Number (%)·µÉ"</span>,</span>
<span id="cb42-463"><a href="#cb42-463" aria-hidden="true" tabindex="-1"></a>    <span class="at">Childhood =</span> <span class="st">"Number (%)·µÉ"</span>,</span>
<span id="cb42-464"><a href="#cb42-464" aria-hidden="true" tabindex="-1"></a>    <span class="at">Other_grp =</span> <span class="st">"Number (%)·µÉ"</span></span>
<span id="cb42-465"><a href="#cb42-465" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb42-466"><a href="#cb42-466" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_header_row</span>( <span class="co"># Second row</span></span>
<span id="cb42-467"><a href="#cb42-467" aria-hidden="true" tabindex="-1"></a>    <span class="at">values =</span> <span class="fu">c</span>(</span>
<span id="cb42-468"><a href="#cb42-468" aria-hidden="true" tabindex="-1"></a>      <span class="st">""</span>, <span class="st">""</span>,</span>
<span id="cb42-469"><a href="#cb42-469" aria-hidden="true" tabindex="-1"></a>      <span class="fu">paste0</span>(<span class="st">"Respiratory vaccines (N = "</span>, <span class="fu">format</span>(totals[<span class="st">"Respiratory vaccines"</span>], <span class="at">big.mark =</span> <span class="st">","</span>), <span class="st">")"</span>),</span>
<span id="cb42-470"><a href="#cb42-470" aria-hidden="true" tabindex="-1"></a>      <span class="fu">paste0</span>(<span class="st">"Childhood vaccines (N = "</span>, <span class="fu">format</span>(totals[<span class="st">"Childhood vaccines"</span>], <span class="at">big.mark =</span> <span class="st">","</span>), <span class="st">")"</span>),</span>
<span id="cb42-471"><a href="#cb42-471" aria-hidden="true" tabindex="-1"></a>      <span class="fu">paste0</span>(<span class="st">"Other (N = "</span>, <span class="fu">format</span>(totals[<span class="st">"Other"</span>], <span class="at">big.mark =</span> <span class="st">","</span>), <span class="st">")"</span>)</span>
<span id="cb42-472"><a href="#cb42-472" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb42-473"><a href="#cb42-473" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb42-474"><a href="#cb42-474" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_header_row</span>( <span class="co"># First row (merged header)</span></span>
<span id="cb42-475"><a href="#cb42-475" aria-hidden="true" tabindex="-1"></a>    <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"Description"</span>, <span class="st">"Vaccination uptake"</span>),</span>
<span id="cb42-476"><a href="#cb42-476" aria-hidden="true" tabindex="-1"></a>    <span class="at">colwidths =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">3</span>)</span>
<span id="cb42-477"><a href="#cb42-477" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb42-478"><a href="#cb42-478" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_box</span>() <span class="sc">%&gt;%</span></span>
<span id="cb42-479"><a href="#cb42-479" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_table_properties</span>(<span class="at">layout =</span> <span class="st">"autofit"</span>, <span class="at">width =</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb42-480"><a href="#cb42-480" aria-hidden="true" tabindex="-1"></a>  <span class="fu">width</span>(<span class="at">j =</span> <span class="dv">1</span>, <span class="at">width =</span> <span class="fl">1.5</span>) <span class="sc">%&gt;%</span></span>
<span id="cb42-481"><a href="#cb42-481" aria-hidden="true" tabindex="-1"></a>  <span class="fu">width</span>(<span class="at">j =</span> <span class="dv">2</span>, <span class="at">width =</span> <span class="fl">2.5</span>) <span class="sc">%&gt;%</span></span>
<span id="cb42-482"><a href="#cb42-482" aria-hidden="true" tabindex="-1"></a>  <span class="fu">width</span>(<span class="at">j =</span> <span class="dv">3</span><span class="sc">:</span><span class="dv">4</span>, <span class="at">width =</span> <span class="fl">1.5</span>) <span class="sc">%&gt;%</span></span>
<span id="cb42-483"><a href="#cb42-483" aria-hidden="true" tabindex="-1"></a>  <span class="fu">align</span>(<span class="at">align =</span> <span class="st">"justify"</span>, <span class="at">part =</span> <span class="st">"all"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb42-484"><a href="#cb42-484" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb42-485"><a href="#cb42-485" aria-hidden="true" tabindex="-1"></a>  <span class="fu">border_remove</span>() <span class="sc">%&gt;%</span></span>
<span id="cb42-486"><a href="#cb42-486" aria-hidden="true" tabindex="-1"></a>  <span class="fu">border</span>(<span class="at">part =</span> <span class="st">"header"</span>, <span class="at">i =</span> <span class="dv">1</span>, <span class="at">border.top =</span> <span class="fu">fp_border</span>(<span class="at">color =</span> <span class="st">"black"</span>, <span class="at">width =</span> <span class="dv">1</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb42-487"><a href="#cb42-487" aria-hidden="true" tabindex="-1"></a>  <span class="fu">border</span>(<span class="at">part =</span> <span class="st">"header"</span>, <span class="at">i =</span> <span class="dv">3</span>, <span class="at">border.bottom =</span> <span class="fu">fp_border</span>(<span class="at">color =</span> <span class="st">"black"</span>, <span class="at">width =</span> <span class="dv">1</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb42-488"><a href="#cb42-488" aria-hidden="true" tabindex="-1"></a>  <span class="fu">border_inner_h</span>(<span class="at">part =</span> <span class="st">"header"</span>, <span class="at">border =</span> <span class="fu">fp_border</span>(<span class="at">color =</span> <span class="st">"black"</span>, <span class="at">width =</span> <span class="fl">0.8</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb42-489"><a href="#cb42-489" aria-hidden="true" tabindex="-1"></a>  <span class="fu">border_inner_h</span>(<span class="at">part =</span> <span class="st">"body"</span>, <span class="at">border =</span> <span class="fu">fp_border</span>(<span class="at">color =</span> <span class="st">"black"</span>, <span class="at">width =</span> <span class="fl">0.8</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb42-490"><a href="#cb42-490" aria-hidden="true" tabindex="-1"></a>  <span class="fu">border</span>(<span class="at">part =</span> <span class="st">"body"</span>, <span class="at">i =</span> <span class="fu">nrow</span>(tab_combined), <span class="at">border.bottom =</span> <span class="fu">fp_border</span>(<span class="at">color =</span> <span class="st">"black"</span>, <span class="at">width =</span> <span class="dv">1</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb42-491"><a href="#cb42-491" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb42-492"><a href="#cb42-492" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_caption</span>(<span class="st">"Table: Vaccination uptake across service year, quarter, and weekday"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb42-493"><a href="#cb42-493" aria-hidden="true" tabindex="-1"></a>  <span class="fu">footnote</span>(<span class="at">i =</span> <span class="dv">1</span>, </span>
<span id="cb42-494"><a href="#cb42-494" aria-hidden="true" tabindex="-1"></a>           <span class="at">value =</span> <span class="fu">as_paragraph</span>(<span class="st">" Vaccination proportions were calculated row-wise (i.e., by row)."</span>),</span>
<span id="cb42-495"><a href="#cb42-495" aria-hidden="true" tabindex="-1"></a>           <span class="at">ref_symbols =</span> <span class="st">"·µÉ"</span>, <span class="at">part =</span> <span class="st">"header"</span>) </span>
<span id="cb42-496"><a href="#cb42-496" aria-hidden="true" tabindex="-1"></a><span class="co"># %&gt;%</span></span>
<span id="cb42-497"><a href="#cb42-497" aria-hidden="true" tabindex="-1"></a><span class="co">#   border_inner_h(border = fp_border(color = "black", width = 1))  %&gt;%</span></span>
<span id="cb42-498"><a href="#cb42-498" aria-hidden="true" tabindex="-1"></a><span class="co">#   add_header_lines(values = "Table xx: Vaccination uptake across service year, quarter, and weekday.") %&gt;%</span></span>
<span id="cb42-499"><a href="#cb42-499" aria-hidden="true" tabindex="-1"></a><span class="co">#   add_footer_lines(values = c(</span></span>
<span id="cb42-500"><a href="#cb42-500" aria-hidden="true" tabindex="-1"></a><span class="co">#     "·µÉ Vaccination proportions were calculated per row (row percentage).",</span></span>
<span id="cb42-501"><a href="#cb42-501" aria-hidden="true" tabindex="-1"></a><span class="co">#     paste0("·µá The vaccine provider type did not include unvaccinated (N = ", format(no_total, big.mark = ","), ")."),</span></span>
<span id="cb42-502"><a href="#cb42-502" aria-hidden="true" tabindex="-1"></a><span class="co">#     "·∂ú Vaccination proportions were calculated row-wise (i.e., by row).",</span></span>
<span id="cb42-503"><a href="#cb42-503" aria-hidden="true" tabindex="-1"></a><span class="co">#     "GP = General practitioner, PHU = Public Health Unit"</span></span>
<span id="cb42-504"><a href="#cb42-504" aria-hidden="true" tabindex="-1"></a><span class="co">#   ))</span></span>
<span id="cb42-505"><a href="#cb42-505" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-506"><a href="#cb42-506" aria-hidden="true" tabindex="-1"></a><span class="co"># Display the table</span></span>
<span id="cb42-507"><a href="#cb42-507" aria-hidden="true" tabindex="-1"></a>ft_vacc_summary</span>
<span id="cb42-508"><a href="#cb42-508" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-509"><a href="#cb42-509" aria-hidden="true" tabindex="-1"></a><span class="co"># .................... Clean up environment ....................</span></span>
<span id="cb42-510"><a href="#cb42-510" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(tab_year, tab_quarter, tab_weekday, tab_combined, ft_vacc_summary, totals, create_tab)</span>
<span id="cb42-511"><a href="#cb42-511" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-512"><a href="#cb42-512" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb42-513"><a href="#cb42-513" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-514"><a href="#cb42-514" aria-hidden="true" tabindex="-1"></a><span class="fu">## **3. Missing Values with n(%)**</span></span>
<span id="cb42-515"><a href="#cb42-515" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-516"><a href="#cb42-516" aria-hidden="true" tabindex="-1"></a>In this version, we **include "Missing" as a separate category** and provide **both counts and percentages**.</span>
<span id="cb42-517"><a href="#cb42-517" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-518"><a href="#cb42-518" aria-hidden="true" tabindex="-1"></a>üß† *Why this matters*: Ignoring missing values can skew analysis. This format transparently highlights data completeness.</span>
<span id="cb42-519"><a href="#cb42-519" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-520"><a href="#cb42-520" aria-hidden="true" tabindex="-1"></a>üëç *Recommended for*: Health datasets, surveys, or administrative data where data quality assessment is key.</span>
<span id="cb42-521"><a href="#cb42-521" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-524"><a href="#cb42-524" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb42-525"><a href="#cb42-525" aria-hidden="true" tabindex="-1"></a><span class="co"># ------------3. Missing values with n(%)-------------------------------------------</span></span>
<span id="cb42-526"><a href="#cb42-526" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-527"><a href="#cb42-527" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-528"><a href="#cb42-528" aria-hidden="true" tabindex="-1"></a><span class="co"># .................. Convert grouping vars to character ..................</span></span>
<span id="cb42-529"><a href="#cb42-529" aria-hidden="true" tabindex="-1"></a>vacc_1524 <span class="ot">&lt;-</span> vacc_1524 <span class="sc">%&gt;%</span></span>
<span id="cb42-530"><a href="#cb42-530" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">c</span>(age_group, gender, marital_status,</span>
<span id="cb42-531"><a href="#cb42-531" aria-hidden="true" tabindex="-1"></a>                  vacc_service_year, vacc_quarter, vacc_weekday), as.character))</span>
<span id="cb42-532"><a href="#cb42-532" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-533"><a href="#cb42-533" aria-hidden="true" tabindex="-1"></a><span class="co"># .................. Table generation function with Missing ..................</span></span>
<span id="cb42-534"><a href="#cb42-534" aria-hidden="true" tabindex="-1"></a>create_tab <span class="ot">&lt;-</span> <span class="cf">function</span>(data, var, label) {</span>
<span id="cb42-535"><a href="#cb42-535" aria-hidden="true" tabindex="-1"></a>  tab_main <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span></span>
<span id="cb42-536"><a href="#cb42-536" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>({{ var }})) <span class="sc">%&gt;%</span></span>
<span id="cb42-537"><a href="#cb42-537" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tabyl</span>({{ var }}, vacc_group3) <span class="sc">%&gt;%</span></span>
<span id="cb42-538"><a href="#cb42-538" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">Category =</span> label, <span class="at">.before =</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb42-539"><a href="#cb42-539" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rename</span>(<span class="at">Label =</span> {{ var }}) <span class="sc">%&gt;%</span></span>
<span id="cb42-540"><a href="#cb42-540" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">Label =</span> <span class="fu">as.character</span>(Label))</span>
<span id="cb42-541"><a href="#cb42-541" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb42-542"><a href="#cb42-542" aria-hidden="true" tabindex="-1"></a>  na_count <span class="ot">&lt;-</span> <span class="fu">sum</span>(<span class="fu">is.na</span>(<span class="fu">pull</span>(data, {{ var }})))</span>
<span id="cb42-543"><a href="#cb42-543" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb42-544"><a href="#cb42-544" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (na_count <span class="sc">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb42-545"><a href="#cb42-545" aria-hidden="true" tabindex="-1"></a>    missing_row <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb42-546"><a href="#cb42-546" aria-hidden="true" tabindex="-1"></a>      <span class="at">Category =</span> label,</span>
<span id="cb42-547"><a href="#cb42-547" aria-hidden="true" tabindex="-1"></a>      <span class="at">Label =</span> <span class="st">"Missing"</span>,</span>
<span id="cb42-548"><a href="#cb42-548" aria-hidden="true" tabindex="-1"></a>      <span class="st">`</span><span class="at">Respiratory vaccines</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">sum</span>(data<span class="sc">$</span>vacc_group3 <span class="sc">==</span> <span class="st">"Respiratory vaccines"</span> <span class="sc">&amp;</span> <span class="fu">is.na</span>(<span class="fu">pull</span>(data, {{ var }})), <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb42-549"><a href="#cb42-549" aria-hidden="true" tabindex="-1"></a>      <span class="st">`</span><span class="at">Childhood vaccines</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">sum</span>(data<span class="sc">$</span>vacc_group3 <span class="sc">==</span> <span class="st">"Childhood vaccines"</span> <span class="sc">&amp;</span> <span class="fu">is.na</span>(<span class="fu">pull</span>(data, {{ var }})), <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb42-550"><a href="#cb42-550" aria-hidden="true" tabindex="-1"></a>      <span class="at">Other =</span> <span class="fu">sum</span>(data<span class="sc">$</span>vacc_group3 <span class="sc">==</span> <span class="st">"Other"</span> <span class="sc">&amp;</span> <span class="fu">is.na</span>(<span class="fu">pull</span>(data, {{ var }})), <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb42-551"><a href="#cb42-551" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb42-552"><a href="#cb42-552" aria-hidden="true" tabindex="-1"></a>    tab_final <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(tab_main, missing_row)</span>
<span id="cb42-553"><a href="#cb42-553" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb42-554"><a href="#cb42-554" aria-hidden="true" tabindex="-1"></a>    tab_final <span class="ot">&lt;-</span> tab_main</span>
<span id="cb42-555"><a href="#cb42-555" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb42-556"><a href="#cb42-556" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb42-557"><a href="#cb42-557" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(tab_final)</span>
<span id="cb42-558"><a href="#cb42-558" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb42-559"><a href="#cb42-559" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-560"><a href="#cb42-560" aria-hidden="true" tabindex="-1"></a><span class="co"># .................. Create summary tables ..................</span></span>
<span id="cb42-561"><a href="#cb42-561" aria-hidden="true" tabindex="-1"></a>tab_age            <span class="ot">&lt;-</span> <span class="fu">create_tab</span>(vacc_1524, age_group, <span class="st">"Age"</span>)</span>
<span id="cb42-562"><a href="#cb42-562" aria-hidden="true" tabindex="-1"></a>tab_sex            <span class="ot">&lt;-</span> <span class="fu">create_tab</span>(vacc_1524, gender, <span class="st">"Gender"</span>)</span>
<span id="cb42-563"><a href="#cb42-563" aria-hidden="true" tabindex="-1"></a>tab_marital_status <span class="ot">&lt;-</span> <span class="fu">create_tab</span>(vacc_1524, marital_status, <span class="st">"Marital status"</span>)</span>
<span id="cb42-564"><a href="#cb42-564" aria-hidden="true" tabindex="-1"></a>tab_year           <span class="ot">&lt;-</span> <span class="fu">create_tab</span>(vacc_1524, vacc_service_year, <span class="st">"Year"</span>)</span>
<span id="cb42-565"><a href="#cb42-565" aria-hidden="true" tabindex="-1"></a>tab_quarter        <span class="ot">&lt;-</span> <span class="fu">create_tab</span>(vacc_1524, vacc_quarter, <span class="st">"Quarter"</span>)</span>
<span id="cb42-566"><a href="#cb42-566" aria-hidden="true" tabindex="-1"></a>tab_weekday        <span class="ot">&lt;-</span> <span class="fu">create_tab</span>(vacc_1524, vacc_weekday, <span class="st">"Weekday"</span>)</span>
<span id="cb42-567"><a href="#cb42-567" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-568"><a href="#cb42-568" aria-hidden="true" tabindex="-1"></a><span class="co"># .................. Combine all tables ..................</span></span>
<span id="cb42-569"><a href="#cb42-569" aria-hidden="true" tabindex="-1"></a>tab_combined <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(tab_sex, tab_age, tab_marital_status, tab_year, tab_quarter, tab_weekday)</span>
<span id="cb42-570"><a href="#cb42-570" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-571"><a href="#cb42-571" aria-hidden="true" tabindex="-1"></a><span class="co"># .................. Calculate row-wise percentages ..................</span></span>
<span id="cb42-572"><a href="#cb42-572" aria-hidden="true" tabindex="-1"></a>tab_combined <span class="ot">&lt;-</span> tab_combined <span class="sc">%&gt;%</span></span>
<span id="cb42-573"><a href="#cb42-573" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rowwise</span>() <span class="sc">%&gt;%</span></span>
<span id="cb42-574"><a href="#cb42-574" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb42-575"><a href="#cb42-575" aria-hidden="true" tabindex="-1"></a>    <span class="at">Total =</span> <span class="fu">sum</span>(<span class="st">`</span><span class="at">Respiratory vaccines</span><span class="st">`</span>, <span class="st">`</span><span class="at">Childhood vaccines</span><span class="st">`</span>, Other, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb42-576"><a href="#cb42-576" aria-hidden="true" tabindex="-1"></a>    <span class="at">Respiratory =</span> <span class="fu">paste0</span>(<span class="fu">comma</span>(<span class="st">`</span><span class="at">Respiratory vaccines</span><span class="st">`</span>), <span class="st">" ("</span>, <span class="fu">round</span>(<span class="dv">100</span> <span class="sc">*</span> <span class="st">`</span><span class="at">Respiratory vaccines</span><span class="st">`</span> <span class="sc">/</span> Total, <span class="dv">1</span>), <span class="st">")"</span>),</span>
<span id="cb42-577"><a href="#cb42-577" aria-hidden="true" tabindex="-1"></a>    <span class="at">Childhood   =</span> <span class="fu">paste0</span>(<span class="fu">comma</span>(<span class="st">`</span><span class="at">Childhood vaccines</span><span class="st">`</span>), <span class="st">" ("</span>, <span class="fu">round</span>(<span class="dv">100</span> <span class="sc">*</span> <span class="st">`</span><span class="at">Childhood vaccines</span><span class="st">`</span> <span class="sc">/</span> Total, <span class="dv">1</span>), <span class="st">")"</span>),</span>
<span id="cb42-578"><a href="#cb42-578" aria-hidden="true" tabindex="-1"></a>    <span class="at">Other_grp   =</span> <span class="fu">paste0</span>(<span class="fu">comma</span>(Other), <span class="st">" ("</span>, <span class="fu">round</span>(<span class="dv">100</span> <span class="sc">*</span> Other <span class="sc">/</span> Total, <span class="dv">1</span>), <span class="st">")"</span>)</span>
<span id="cb42-579"><a href="#cb42-579" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb42-580"><a href="#cb42-580" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb42-581"><a href="#cb42-581" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-582"><a href="#cb42-582" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-583"><a href="#cb42-583" aria-hidden="true" tabindex="-1"></a><span class="co"># .................. Show Category only once per group ..................</span></span>
<span id="cb42-584"><a href="#cb42-584" aria-hidden="true" tabindex="-1"></a>tab_combined <span class="ot">&lt;-</span> tab_combined <span class="sc">%&gt;%</span></span>
<span id="cb42-585"><a href="#cb42-585" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Category) <span class="sc">%&gt;%</span></span>
<span id="cb42-586"><a href="#cb42-586" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Category =</span> <span class="fu">ifelse</span>(<span class="fu">row_number</span>() <span class="sc">==</span> <span class="dv">1</span>, Category, <span class="st">""</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb42-587"><a href="#cb42-587" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb42-588"><a href="#cb42-588" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-589"><a href="#cb42-589" aria-hidden="true" tabindex="-1"></a><span class="co"># .................. Get total counts per vaccine group ..................</span></span>
<span id="cb42-590"><a href="#cb42-590" aria-hidden="true" tabindex="-1"></a>totals <span class="ot">&lt;-</span> vacc_1524 <span class="sc">%&gt;%</span></span>
<span id="cb42-591"><a href="#cb42-591" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(vacc_group3) <span class="sc">%&gt;%</span></span>
<span id="cb42-592"><a href="#cb42-592" aria-hidden="true" tabindex="-1"></a>  <span class="fu">deframe</span>()</span>
<span id="cb42-593"><a href="#cb42-593" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-594"><a href="#cb42-594" aria-hidden="true" tabindex="-1"></a><span class="co"># .................. Create flextable ..................</span></span>
<span id="cb42-595"><a href="#cb42-595" aria-hidden="true" tabindex="-1"></a>ft_vacc_summary <span class="ot">&lt;-</span> tab_combined <span class="sc">%&gt;%</span></span>
<span id="cb42-596"><a href="#cb42-596" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Category, Label, Respiratory, Childhood, Other_grp) <span class="sc">%&gt;%</span></span>
<span id="cb42-597"><a href="#cb42-597" aria-hidden="true" tabindex="-1"></a>  <span class="fu">flextable</span>() <span class="sc">%&gt;%</span></span>
<span id="cb42-598"><a href="#cb42-598" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_header_labels</span>(</span>
<span id="cb42-599"><a href="#cb42-599" aria-hidden="true" tabindex="-1"></a>    <span class="at">Category =</span> <span class="st">"Variable type"</span>,</span>
<span id="cb42-600"><a href="#cb42-600" aria-hidden="true" tabindex="-1"></a>    <span class="at">Label =</span> <span class="st">"Values"</span>,</span>
<span id="cb42-601"><a href="#cb42-601" aria-hidden="true" tabindex="-1"></a>    <span class="at">Respiratory =</span> <span class="st">"Number (%)·µÉ"</span>,</span>
<span id="cb42-602"><a href="#cb42-602" aria-hidden="true" tabindex="-1"></a>    <span class="at">Childhood =</span> <span class="st">"Number (%)·µÉ"</span>,</span>
<span id="cb42-603"><a href="#cb42-603" aria-hidden="true" tabindex="-1"></a>    <span class="at">Other_grp =</span> <span class="st">"Number (%)·µÉ"</span></span>
<span id="cb42-604"><a href="#cb42-604" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb42-605"><a href="#cb42-605" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_header_row</span>(</span>
<span id="cb42-606"><a href="#cb42-606" aria-hidden="true" tabindex="-1"></a>    <span class="at">values =</span> <span class="fu">c</span>(</span>
<span id="cb42-607"><a href="#cb42-607" aria-hidden="true" tabindex="-1"></a>      <span class="st">""</span>, <span class="st">""</span>,</span>
<span id="cb42-608"><a href="#cb42-608" aria-hidden="true" tabindex="-1"></a>      <span class="fu">paste0</span>(<span class="st">"Respiratory vaccines (N = "</span>, <span class="fu">format</span>(totals[<span class="st">"Respiratory vaccines"</span>], <span class="at">big.mark =</span> <span class="st">","</span>), <span class="st">")"</span>),</span>
<span id="cb42-609"><a href="#cb42-609" aria-hidden="true" tabindex="-1"></a>      <span class="fu">paste0</span>(<span class="st">"Childhood vaccines (N = "</span>, <span class="fu">format</span>(totals[<span class="st">"Childhood vaccines"</span>], <span class="at">big.mark =</span> <span class="st">","</span>), <span class="st">")"</span>),</span>
<span id="cb42-610"><a href="#cb42-610" aria-hidden="true" tabindex="-1"></a>      <span class="fu">paste0</span>(<span class="st">"Other (N = "</span>, <span class="fu">format</span>(totals[<span class="st">"Other"</span>], <span class="at">big.mark =</span> <span class="st">","</span>), <span class="st">")"</span>)</span>
<span id="cb42-611"><a href="#cb42-611" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb42-612"><a href="#cb42-612" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb42-613"><a href="#cb42-613" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_header_row</span>(</span>
<span id="cb42-614"><a href="#cb42-614" aria-hidden="true" tabindex="-1"></a>    <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"Description"</span>, <span class="st">"Vaccination uptake"</span>),</span>
<span id="cb42-615"><a href="#cb42-615" aria-hidden="true" tabindex="-1"></a>    <span class="at">colwidths =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">3</span>)</span>
<span id="cb42-616"><a href="#cb42-616" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb42-617"><a href="#cb42-617" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_box</span>() <span class="sc">%&gt;%</span></span>
<span id="cb42-618"><a href="#cb42-618" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_table_properties</span>(<span class="at">layout =</span> <span class="st">"autofit"</span>, <span class="at">width =</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb42-619"><a href="#cb42-619" aria-hidden="true" tabindex="-1"></a>  <span class="fu">width</span>(<span class="at">j =</span> <span class="dv">1</span>, <span class="at">width =</span> <span class="fl">1.5</span>) <span class="sc">%&gt;%</span></span>
<span id="cb42-620"><a href="#cb42-620" aria-hidden="true" tabindex="-1"></a>  <span class="fu">width</span>(<span class="at">j =</span> <span class="dv">2</span>, <span class="at">width =</span> <span class="fl">2.5</span>) <span class="sc">%&gt;%</span></span>
<span id="cb42-621"><a href="#cb42-621" aria-hidden="true" tabindex="-1"></a>  <span class="fu">width</span>(<span class="at">j =</span> <span class="dv">3</span><span class="sc">:</span><span class="dv">5</span>, <span class="at">width =</span> <span class="fl">1.5</span>) <span class="sc">%&gt;%</span></span>
<span id="cb42-622"><a href="#cb42-622" aria-hidden="true" tabindex="-1"></a>  <span class="fu">align</span>(<span class="at">align =</span> <span class="st">"justify"</span>, <span class="at">part =</span> <span class="st">"all"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb42-623"><a href="#cb42-623" aria-hidden="true" tabindex="-1"></a>  <span class="fu">border_remove</span>() <span class="sc">%&gt;%</span></span>
<span id="cb42-624"><a href="#cb42-624" aria-hidden="true" tabindex="-1"></a>  <span class="fu">border</span>(<span class="at">part =</span> <span class="st">"header"</span>, <span class="at">i =</span> <span class="dv">1</span>, <span class="at">border.top =</span> <span class="fu">fp_border</span>(<span class="at">color =</span> <span class="st">"black"</span>, <span class="at">width =</span> <span class="dv">1</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb42-625"><a href="#cb42-625" aria-hidden="true" tabindex="-1"></a>  <span class="fu">border</span>(<span class="at">part =</span> <span class="st">"header"</span>, <span class="at">i =</span> <span class="dv">3</span>, <span class="at">border.bottom =</span> <span class="fu">fp_border</span>(<span class="at">color =</span> <span class="st">"black"</span>, <span class="at">width =</span> <span class="dv">1</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb42-626"><a href="#cb42-626" aria-hidden="true" tabindex="-1"></a>  <span class="fu">border_inner_h</span>(<span class="at">part =</span> <span class="st">"header"</span>, <span class="at">border =</span> <span class="fu">fp_border</span>(<span class="at">color =</span> <span class="st">"black"</span>, <span class="at">width =</span> <span class="fl">0.8</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb42-627"><a href="#cb42-627" aria-hidden="true" tabindex="-1"></a>  <span class="fu">border_inner_h</span>(<span class="at">part =</span> <span class="st">"body"</span>, <span class="at">border =</span> <span class="fu">fp_border</span>(<span class="at">color =</span> <span class="st">"black"</span>, <span class="at">width =</span> <span class="fl">0.8</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb42-628"><a href="#cb42-628" aria-hidden="true" tabindex="-1"></a>  <span class="fu">border</span>(<span class="at">part =</span> <span class="st">"body"</span>, <span class="at">i =</span> <span class="fu">nrow</span>(tab_combined), <span class="at">border.bottom =</span> <span class="fu">fp_border</span>(<span class="at">color =</span> <span class="st">"black"</span>, <span class="at">width =</span> <span class="dv">1</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb42-629"><a href="#cb42-629" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb42-630"><a href="#cb42-630" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_caption</span>(<span class="st">"Table: Vaccination uptake across service year, quarter, and weekday"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb42-631"><a href="#cb42-631" aria-hidden="true" tabindex="-1"></a>  <span class="fu">footnote</span>(<span class="at">i =</span> <span class="dv">1</span>, </span>
<span id="cb42-632"><a href="#cb42-632" aria-hidden="true" tabindex="-1"></a>           <span class="at">value =</span> <span class="fu">as_paragraph</span>(<span class="st">"Vaccination proportions were calculated row-wise (i.e., by row)."</span>),</span>
<span id="cb42-633"><a href="#cb42-633" aria-hidden="true" tabindex="-1"></a>           <span class="at">ref_symbols =</span> <span class="st">"·µÉ"</span>, </span>
<span id="cb42-634"><a href="#cb42-634" aria-hidden="true" tabindex="-1"></a>           <span class="at">part =</span> <span class="st">"header"</span>)</span>
<span id="cb42-635"><a href="#cb42-635" aria-hidden="true" tabindex="-1"></a><span class="co"># .................. Show the table ..................</span></span>
<span id="cb42-636"><a href="#cb42-636" aria-hidden="true" tabindex="-1"></a>ft_vacc_summary</span>
<span id="cb42-637"><a href="#cb42-637" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-638"><a href="#cb42-638" aria-hidden="true" tabindex="-1"></a><span class="co"># .................. Clean up ..................</span></span>
<span id="cb42-639"><a href="#cb42-639" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(tab_age, tab_sex, tab_marital_status, tab_year, tab_quarter, tab_weekday, </span>
<span id="cb42-640"><a href="#cb42-640" aria-hidden="true" tabindex="-1"></a>   tab_combined, ft_vacc_summary, totals, create_tab)</span>
<span id="cb42-641"><a href="#cb42-641" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-642"><a href="#cb42-642" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb42-643"><a href="#cb42-643" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-644"><a href="#cb42-644" aria-hidden="true" tabindex="-1"></a><span class="fu">## **4. Missing Values with Only Counts**</span></span>
<span id="cb42-645"><a href="#cb42-645" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-646"><a href="#cb42-646" aria-hidden="true" tabindex="-1"></a>This variation includes missing data rows but only shows **raw counts**, not percentages.</span>
<span id="cb42-647"><a href="#cb42-647" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-648"><a href="#cb42-648" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>‚öñÔ∏è *Why use this*: It prevents misleading interpretations‚Äîespecially when the denominator for percentage is unclear or inconsistent.</span>
<span id="cb42-649"><a href="#cb42-649" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-650"><a href="#cb42-650" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Use this when you want to **acknowledge missing data** but avoid implying proportional meaning.</span>
<span id="cb42-651"><a href="#cb42-651" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-654"><a href="#cb42-654" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb42-655"><a href="#cb42-655" aria-hidden="true" tabindex="-1"></a><span class="co"># ------------4. Missing values with only counts-------------------------------------------</span></span>
<span id="cb42-656"><a href="#cb42-656" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-657"><a href="#cb42-657" aria-hidden="true" tabindex="-1"></a><span class="co"># .................. Convert grouping vars to character ..................</span></span>
<span id="cb42-658"><a href="#cb42-658" aria-hidden="true" tabindex="-1"></a>vacc_1524 <span class="ot">&lt;-</span> vacc_1524 <span class="sc">%&gt;%</span></span>
<span id="cb42-659"><a href="#cb42-659" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">c</span>(age_group, gender, marital_status,</span>
<span id="cb42-660"><a href="#cb42-660" aria-hidden="true" tabindex="-1"></a>                  vacc_service_year, vacc_quarter, vacc_weekday), as.character))</span>
<span id="cb42-661"><a href="#cb42-661" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-662"><a href="#cb42-662" aria-hidden="true" tabindex="-1"></a><span class="co"># .................. Table generation function with Missing ..................</span></span>
<span id="cb42-663"><a href="#cb42-663" aria-hidden="true" tabindex="-1"></a>create_tab <span class="ot">&lt;-</span> <span class="cf">function</span>(data, var, label) {</span>
<span id="cb42-664"><a href="#cb42-664" aria-hidden="true" tabindex="-1"></a>  tab_main <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span></span>
<span id="cb42-665"><a href="#cb42-665" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>({{ var }})) <span class="sc">%&gt;%</span></span>
<span id="cb42-666"><a href="#cb42-666" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tabyl</span>({{ var }}, vacc_group3) <span class="sc">%&gt;%</span></span>
<span id="cb42-667"><a href="#cb42-667" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">Category =</span> label, <span class="at">.before =</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb42-668"><a href="#cb42-668" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rename</span>(<span class="at">Label =</span> {{ var }}) <span class="sc">%&gt;%</span></span>
<span id="cb42-669"><a href="#cb42-669" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">Label =</span> <span class="fu">as.character</span>(Label))</span>
<span id="cb42-670"><a href="#cb42-670" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb42-671"><a href="#cb42-671" aria-hidden="true" tabindex="-1"></a>  na_count <span class="ot">&lt;-</span> <span class="fu">sum</span>(<span class="fu">is.na</span>(<span class="fu">pull</span>(data, {{ var }})))</span>
<span id="cb42-672"><a href="#cb42-672" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb42-673"><a href="#cb42-673" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (na_count <span class="sc">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb42-674"><a href="#cb42-674" aria-hidden="true" tabindex="-1"></a>    missing_row <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb42-675"><a href="#cb42-675" aria-hidden="true" tabindex="-1"></a>      <span class="at">Category =</span> label,</span>
<span id="cb42-676"><a href="#cb42-676" aria-hidden="true" tabindex="-1"></a>      <span class="at">Label =</span> <span class="st">"Missing"</span>,</span>
<span id="cb42-677"><a href="#cb42-677" aria-hidden="true" tabindex="-1"></a>      <span class="st">`</span><span class="at">Respiratory vaccines</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">sum</span>(data<span class="sc">$</span>vacc_group3 <span class="sc">==</span> <span class="st">"Respiratory vaccines"</span> <span class="sc">&amp;</span> <span class="fu">is.na</span>(<span class="fu">pull</span>(data, {{ var }})), <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb42-678"><a href="#cb42-678" aria-hidden="true" tabindex="-1"></a>      <span class="st">`</span><span class="at">Childhood vaccines</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">sum</span>(data<span class="sc">$</span>vacc_group3 <span class="sc">==</span> <span class="st">"Childhood vaccines"</span> <span class="sc">&amp;</span> <span class="fu">is.na</span>(<span class="fu">pull</span>(data, {{ var }})), <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb42-679"><a href="#cb42-679" aria-hidden="true" tabindex="-1"></a>      <span class="at">Other =</span> <span class="fu">sum</span>(data<span class="sc">$</span>vacc_group3 <span class="sc">==</span> <span class="st">"Other"</span> <span class="sc">&amp;</span> <span class="fu">is.na</span>(<span class="fu">pull</span>(data, {{ var }})), <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb42-680"><a href="#cb42-680" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb42-681"><a href="#cb42-681" aria-hidden="true" tabindex="-1"></a>    tab_final <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(tab_main, missing_row)</span>
<span id="cb42-682"><a href="#cb42-682" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb42-683"><a href="#cb42-683" aria-hidden="true" tabindex="-1"></a>    tab_final <span class="ot">&lt;-</span> tab_main</span>
<span id="cb42-684"><a href="#cb42-684" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb42-685"><a href="#cb42-685" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb42-686"><a href="#cb42-686" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(tab_final)</span>
<span id="cb42-687"><a href="#cb42-687" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb42-688"><a href="#cb42-688" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-689"><a href="#cb42-689" aria-hidden="true" tabindex="-1"></a><span class="co"># .................. Create summary tables ..................</span></span>
<span id="cb42-690"><a href="#cb42-690" aria-hidden="true" tabindex="-1"></a>tab_age            <span class="ot">&lt;-</span> <span class="fu">create_tab</span>(vacc_1524, age_group, <span class="st">"Age"</span>)</span>
<span id="cb42-691"><a href="#cb42-691" aria-hidden="true" tabindex="-1"></a>tab_sex            <span class="ot">&lt;-</span> <span class="fu">create_tab</span>(vacc_1524, gender, <span class="st">"Gender"</span>)</span>
<span id="cb42-692"><a href="#cb42-692" aria-hidden="true" tabindex="-1"></a>tab_marital_status <span class="ot">&lt;-</span> <span class="fu">create_tab</span>(vacc_1524, marital_status, <span class="st">"Marital status"</span>)</span>
<span id="cb42-693"><a href="#cb42-693" aria-hidden="true" tabindex="-1"></a>tab_year           <span class="ot">&lt;-</span> <span class="fu">create_tab</span>(vacc_1524, vacc_service_year, <span class="st">"Year"</span>)</span>
<span id="cb42-694"><a href="#cb42-694" aria-hidden="true" tabindex="-1"></a>tab_quarter        <span class="ot">&lt;-</span> <span class="fu">create_tab</span>(vacc_1524, vacc_quarter, <span class="st">"Quarter"</span>)</span>
<span id="cb42-695"><a href="#cb42-695" aria-hidden="true" tabindex="-1"></a>tab_weekday        <span class="ot">&lt;-</span> <span class="fu">create_tab</span>(vacc_1524, vacc_weekday, <span class="st">"Weekday"</span>)</span>
<span id="cb42-696"><a href="#cb42-696" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-697"><a href="#cb42-697" aria-hidden="true" tabindex="-1"></a><span class="co"># .................. Combine all tables ..................</span></span>
<span id="cb42-698"><a href="#cb42-698" aria-hidden="true" tabindex="-1"></a>tab_combined <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(tab_sex, tab_age, tab_marital_status, tab_year, tab_quarter, tab_weekday)</span>
<span id="cb42-699"><a href="#cb42-699" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-700"><a href="#cb42-700" aria-hidden="true" tabindex="-1"></a><span class="co"># .................. Calculate row-wise percentages (skip for Missing) ..................</span></span>
<span id="cb42-701"><a href="#cb42-701" aria-hidden="true" tabindex="-1"></a>tab_combined <span class="ot">&lt;-</span> tab_combined <span class="sc">%&gt;%</span></span>
<span id="cb42-702"><a href="#cb42-702" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rowwise</span>() <span class="sc">%&gt;%</span></span>
<span id="cb42-703"><a href="#cb42-703" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb42-704"><a href="#cb42-704" aria-hidden="true" tabindex="-1"></a>    <span class="at">Total =</span> <span class="fu">sum</span>(<span class="st">`</span><span class="at">Respiratory vaccines</span><span class="st">`</span>, <span class="st">`</span><span class="at">Childhood vaccines</span><span class="st">`</span>, Other, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb42-705"><a href="#cb42-705" aria-hidden="true" tabindex="-1"></a>    <span class="at">is_missing =</span> <span class="fu">trimws</span>(<span class="fu">tolower</span>(Label)) <span class="sc">==</span> <span class="st">"missing"</span>,</span>
<span id="cb42-706"><a href="#cb42-706" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb42-707"><a href="#cb42-707" aria-hidden="true" tabindex="-1"></a>    <span class="at">Respiratory =</span> <span class="fu">ifelse</span>(is_missing,</span>
<span id="cb42-708"><a href="#cb42-708" aria-hidden="true" tabindex="-1"></a>                         <span class="fu">comma</span>(<span class="st">`</span><span class="at">Respiratory vaccines</span><span class="st">`</span>),</span>
<span id="cb42-709"><a href="#cb42-709" aria-hidden="true" tabindex="-1"></a>                         <span class="fu">paste0</span>(<span class="fu">comma</span>(<span class="st">`</span><span class="at">Respiratory vaccines</span><span class="st">`</span>), <span class="st">" ("</span>, <span class="fu">round</span>(<span class="dv">100</span> <span class="sc">*</span> <span class="st">`</span><span class="at">Respiratory vaccines</span><span class="st">`</span> <span class="sc">/</span> Total, <span class="dv">1</span>), <span class="st">")"</span>)),</span>
<span id="cb42-710"><a href="#cb42-710" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb42-711"><a href="#cb42-711" aria-hidden="true" tabindex="-1"></a>    <span class="at">Childhood =</span> <span class="fu">ifelse</span>(is_missing,</span>
<span id="cb42-712"><a href="#cb42-712" aria-hidden="true" tabindex="-1"></a>                       <span class="fu">comma</span>(<span class="st">`</span><span class="at">Childhood vaccines</span><span class="st">`</span>),</span>
<span id="cb42-713"><a href="#cb42-713" aria-hidden="true" tabindex="-1"></a>                       <span class="fu">paste0</span>(<span class="fu">comma</span>(<span class="st">`</span><span class="at">Childhood vaccines</span><span class="st">`</span>), <span class="st">" ("</span>, <span class="fu">round</span>(<span class="dv">100</span> <span class="sc">*</span> <span class="st">`</span><span class="at">Childhood vaccines</span><span class="st">`</span> <span class="sc">/</span> Total, <span class="dv">1</span>), <span class="st">")"</span>)),</span>
<span id="cb42-714"><a href="#cb42-714" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb42-715"><a href="#cb42-715" aria-hidden="true" tabindex="-1"></a>    <span class="at">Other_grp =</span> <span class="fu">ifelse</span>(is_missing,</span>
<span id="cb42-716"><a href="#cb42-716" aria-hidden="true" tabindex="-1"></a>                       <span class="fu">comma</span>(Other),</span>
<span id="cb42-717"><a href="#cb42-717" aria-hidden="true" tabindex="-1"></a>                       <span class="fu">paste0</span>(<span class="fu">comma</span>(Other), <span class="st">" ("</span>, <span class="fu">round</span>(<span class="dv">100</span> <span class="sc">*</span> Other <span class="sc">/</span> Total, <span class="dv">1</span>), <span class="st">")"</span>))</span>
<span id="cb42-718"><a href="#cb42-718" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb42-719"><a href="#cb42-719" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb42-720"><a href="#cb42-720" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Category, Label, Respiratory, Childhood, Other_grp)</span>
<span id="cb42-721"><a href="#cb42-721" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-722"><a href="#cb42-722" aria-hidden="true" tabindex="-1"></a><span class="co"># .................. Show Category only once per group ..................</span></span>
<span id="cb42-723"><a href="#cb42-723" aria-hidden="true" tabindex="-1"></a>tab_combined <span class="ot">&lt;-</span> tab_combined <span class="sc">%&gt;%</span></span>
<span id="cb42-724"><a href="#cb42-724" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Category) <span class="sc">%&gt;%</span></span>
<span id="cb42-725"><a href="#cb42-725" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Category =</span> <span class="fu">ifelse</span>(<span class="fu">row_number</span>() <span class="sc">==</span> <span class="dv">1</span>, Category, <span class="st">""</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb42-726"><a href="#cb42-726" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb42-727"><a href="#cb42-727" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-728"><a href="#cb42-728" aria-hidden="true" tabindex="-1"></a><span class="co"># .................. Get total counts per vaccine group ..................</span></span>
<span id="cb42-729"><a href="#cb42-729" aria-hidden="true" tabindex="-1"></a>totals <span class="ot">&lt;-</span> vacc_1524 <span class="sc">%&gt;%</span></span>
<span id="cb42-730"><a href="#cb42-730" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(vacc_group3) <span class="sc">%&gt;%</span></span>
<span id="cb42-731"><a href="#cb42-731" aria-hidden="true" tabindex="-1"></a>  <span class="fu">deframe</span>()</span>
<span id="cb42-732"><a href="#cb42-732" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-733"><a href="#cb42-733" aria-hidden="true" tabindex="-1"></a><span class="co"># .................. Create flextable ..................</span></span>
<span id="cb42-734"><a href="#cb42-734" aria-hidden="true" tabindex="-1"></a>ft_vacc_summary <span class="ot">&lt;-</span> tab_combined <span class="sc">%&gt;%</span></span>
<span id="cb42-735"><a href="#cb42-735" aria-hidden="true" tabindex="-1"></a>  <span class="fu">flextable</span>() <span class="sc">%&gt;%</span></span>
<span id="cb42-736"><a href="#cb42-736" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_header_labels</span>(</span>
<span id="cb42-737"><a href="#cb42-737" aria-hidden="true" tabindex="-1"></a>    <span class="at">Category =</span> <span class="st">"Variable type"</span>,</span>
<span id="cb42-738"><a href="#cb42-738" aria-hidden="true" tabindex="-1"></a>    <span class="at">Label =</span> <span class="st">"Values"</span>,</span>
<span id="cb42-739"><a href="#cb42-739" aria-hidden="true" tabindex="-1"></a>    <span class="at">Respiratory =</span> <span class="st">"Number (%)·µÉ"</span>,</span>
<span id="cb42-740"><a href="#cb42-740" aria-hidden="true" tabindex="-1"></a>    <span class="at">Childhood =</span> <span class="st">"Number (%)·µÉ"</span>,</span>
<span id="cb42-741"><a href="#cb42-741" aria-hidden="true" tabindex="-1"></a>    <span class="at">Other_grp =</span> <span class="st">"Number (%)·µÉ"</span></span>
<span id="cb42-742"><a href="#cb42-742" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb42-743"><a href="#cb42-743" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_header_row</span>(</span>
<span id="cb42-744"><a href="#cb42-744" aria-hidden="true" tabindex="-1"></a>    <span class="at">values =</span> <span class="fu">c</span>(</span>
<span id="cb42-745"><a href="#cb42-745" aria-hidden="true" tabindex="-1"></a>      <span class="st">""</span>, <span class="st">""</span>,</span>
<span id="cb42-746"><a href="#cb42-746" aria-hidden="true" tabindex="-1"></a>      <span class="fu">paste0</span>(<span class="st">"Respiratory vaccines (N = "</span>, <span class="fu">format</span>(totals[<span class="st">"Respiratory vaccines"</span>], <span class="at">big.mark =</span> <span class="st">","</span>), <span class="st">")"</span>),</span>
<span id="cb42-747"><a href="#cb42-747" aria-hidden="true" tabindex="-1"></a>      <span class="fu">paste0</span>(<span class="st">"Childhood vaccines (N = "</span>, <span class="fu">format</span>(totals[<span class="st">"Childhood vaccines"</span>], <span class="at">big.mark =</span> <span class="st">","</span>), <span class="st">")"</span>),</span>
<span id="cb42-748"><a href="#cb42-748" aria-hidden="true" tabindex="-1"></a>      <span class="fu">paste0</span>(<span class="st">"Other (N = "</span>, <span class="fu">format</span>(totals[<span class="st">"Other"</span>], <span class="at">big.mark =</span> <span class="st">","</span>), <span class="st">")"</span>)</span>
<span id="cb42-749"><a href="#cb42-749" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb42-750"><a href="#cb42-750" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb42-751"><a href="#cb42-751" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_header_row</span>(</span>
<span id="cb42-752"><a href="#cb42-752" aria-hidden="true" tabindex="-1"></a>    <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"Description"</span>, <span class="st">"Vaccination uptake"</span>),</span>
<span id="cb42-753"><a href="#cb42-753" aria-hidden="true" tabindex="-1"></a>    <span class="at">colwidths =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">3</span>)</span>
<span id="cb42-754"><a href="#cb42-754" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb42-755"><a href="#cb42-755" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_box</span>() <span class="sc">%&gt;%</span></span>
<span id="cb42-756"><a href="#cb42-756" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_table_properties</span>(<span class="at">layout =</span> <span class="st">"autofit"</span>, <span class="at">width =</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb42-757"><a href="#cb42-757" aria-hidden="true" tabindex="-1"></a>  <span class="fu">width</span>(<span class="at">j =</span> <span class="dv">1</span>, <span class="at">width =</span> <span class="fl">1.5</span>) <span class="sc">%&gt;%</span></span>
<span id="cb42-758"><a href="#cb42-758" aria-hidden="true" tabindex="-1"></a>  <span class="fu">width</span>(<span class="at">j =</span> <span class="dv">2</span>, <span class="at">width =</span> <span class="fl">2.5</span>) <span class="sc">%&gt;%</span></span>
<span id="cb42-759"><a href="#cb42-759" aria-hidden="true" tabindex="-1"></a>  <span class="fu">width</span>(<span class="at">j =</span> <span class="dv">3</span><span class="sc">:</span><span class="dv">5</span>, <span class="at">width =</span> <span class="fl">1.5</span>) <span class="sc">%&gt;%</span></span>
<span id="cb42-760"><a href="#cb42-760" aria-hidden="true" tabindex="-1"></a>  <span class="fu">align</span>(<span class="at">align =</span> <span class="st">"justify"</span>, <span class="at">part =</span> <span class="st">"all"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb42-761"><a href="#cb42-761" aria-hidden="true" tabindex="-1"></a>  <span class="fu">border_remove</span>() <span class="sc">%&gt;%</span></span>
<span id="cb42-762"><a href="#cb42-762" aria-hidden="true" tabindex="-1"></a>  <span class="fu">border</span>(<span class="at">part =</span> <span class="st">"header"</span>, <span class="at">i =</span> <span class="dv">1</span>, <span class="at">border.top =</span> <span class="fu">fp_border</span>(<span class="at">color =</span> <span class="st">"black"</span>, <span class="at">width =</span> <span class="dv">1</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb42-763"><a href="#cb42-763" aria-hidden="true" tabindex="-1"></a>  <span class="fu">border</span>(<span class="at">part =</span> <span class="st">"header"</span>, <span class="at">i =</span> <span class="dv">3</span>, <span class="at">border.bottom =</span> <span class="fu">fp_border</span>(<span class="at">color =</span> <span class="st">"black"</span>, <span class="at">width =</span> <span class="dv">1</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb42-764"><a href="#cb42-764" aria-hidden="true" tabindex="-1"></a>  <span class="fu">border_inner_h</span>(<span class="at">part =</span> <span class="st">"header"</span>, <span class="at">border =</span> <span class="fu">fp_border</span>(<span class="at">color =</span> <span class="st">"black"</span>, <span class="at">width =</span> <span class="fl">0.8</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb42-765"><a href="#cb42-765" aria-hidden="true" tabindex="-1"></a>  <span class="fu">border_inner_h</span>(<span class="at">part =</span> <span class="st">"body"</span>, <span class="at">border =</span> <span class="fu">fp_border</span>(<span class="at">color =</span> <span class="st">"black"</span>, <span class="at">width =</span> <span class="fl">0.8</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb42-766"><a href="#cb42-766" aria-hidden="true" tabindex="-1"></a>  <span class="fu">border</span>(<span class="at">part =</span> <span class="st">"body"</span>, <span class="at">i =</span> <span class="fu">nrow</span>(tab_combined), <span class="at">border.bottom =</span> <span class="fu">fp_border</span>(<span class="at">color =</span> <span class="st">"black"</span>, <span class="at">width =</span> <span class="dv">1</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb42-767"><a href="#cb42-767" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb42-768"><a href="#cb42-768" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_caption</span>(<span class="st">"Table: Vaccination uptake across service year, quarter, and weekday"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb42-769"><a href="#cb42-769" aria-hidden="true" tabindex="-1"></a>  <span class="fu">footnote</span>(<span class="at">i =</span> <span class="dv">1</span>, </span>
<span id="cb42-770"><a href="#cb42-770" aria-hidden="true" tabindex="-1"></a>           <span class="at">value =</span> <span class="fu">as_paragraph</span>(<span class="st">"Vaccination proportions were calculated row-wise (i.e., by row)."</span>),</span>
<span id="cb42-771"><a href="#cb42-771" aria-hidden="true" tabindex="-1"></a>           <span class="at">ref_symbols =</span> <span class="st">"·µÉ"</span>, </span>
<span id="cb42-772"><a href="#cb42-772" aria-hidden="true" tabindex="-1"></a>           <span class="at">part =</span> <span class="st">"header"</span>)</span>
<span id="cb42-773"><a href="#cb42-773" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-774"><a href="#cb42-774" aria-hidden="true" tabindex="-1"></a><span class="co"># .................. Show the table ..................</span></span>
<span id="cb42-775"><a href="#cb42-775" aria-hidden="true" tabindex="-1"></a>ft_vacc_summary</span>
<span id="cb42-776"><a href="#cb42-776" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-777"><a href="#cb42-777" aria-hidden="true" tabindex="-1"></a><span class="co"># .................. Clean up ..................</span></span>
<span id="cb42-778"><a href="#cb42-778" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(tab_age, tab_sex, tab_marital_status, tab_year, tab_quarter, tab_weekday, </span>
<span id="cb42-779"><a href="#cb42-779" aria-hidden="true" tabindex="-1"></a>   tab_combined, ft_vacc_summary, totals, create_tab)</span>
<span id="cb42-780"><a href="#cb42-780" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-781"><a href="#cb42-781" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-782"><a href="#cb42-782" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb42-783"><a href="#cb42-783" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-784"><a href="#cb42-784" aria-hidden="true" tabindex="-1"></a><span class="fu">## **5. Remove All Lines**</span></span>
<span id="cb42-785"><a href="#cb42-785" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-786"><a href="#cb42-786" aria-hidden="true" tabindex="-1"></a>This version **removes all border lines** for a minimalist, text-friendly table.</span>
<span id="cb42-787"><a href="#cb42-787" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-788"><a href="#cb42-788" aria-hidden="true" tabindex="-1"></a>‚ú® *Why this helps*: It improves visual integration in Word documents or printed reports where borders may clutter formatting.</span>
<span id="cb42-789"><a href="#cb42-789" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-790"><a href="#cb42-790" aria-hidden="true" tabindex="-1"></a>üîç *Ideal for*: Inline reporting, Word exports, or journal submissions requiring custom styling.</span>
<span id="cb42-791"><a href="#cb42-791" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-794"><a href="#cb42-794" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb42-795"><a href="#cb42-795" aria-hidden="true" tabindex="-1"></a><span class="co"># ------------5. Lines: remove all lines -------------------------------------------</span></span>
<span id="cb42-796"><a href="#cb42-796" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-797"><a href="#cb42-797" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-798"><a href="#cb42-798" aria-hidden="true" tabindex="-1"></a><span class="co"># .................. Convert grouping vars to character ..................</span></span>
<span id="cb42-799"><a href="#cb42-799" aria-hidden="true" tabindex="-1"></a>vacc_1524 <span class="ot">&lt;-</span> vacc_1524 <span class="sc">%&gt;%</span></span>
<span id="cb42-800"><a href="#cb42-800" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">c</span>(age_group, gender, marital_status,</span>
<span id="cb42-801"><a href="#cb42-801" aria-hidden="true" tabindex="-1"></a>                  vacc_service_year, vacc_quarter, vacc_weekday), as.character))</span>
<span id="cb42-802"><a href="#cb42-802" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-803"><a href="#cb42-803" aria-hidden="true" tabindex="-1"></a><span class="co"># .................. Table generation function with Missing ..................</span></span>
<span id="cb42-804"><a href="#cb42-804" aria-hidden="true" tabindex="-1"></a>create_tab <span class="ot">&lt;-</span> <span class="cf">function</span>(data, var, label) {</span>
<span id="cb42-805"><a href="#cb42-805" aria-hidden="true" tabindex="-1"></a>  tab_main <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span></span>
<span id="cb42-806"><a href="#cb42-806" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>({{ var }})) <span class="sc">%&gt;%</span></span>
<span id="cb42-807"><a href="#cb42-807" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tabyl</span>({{ var }}, vacc_group3) <span class="sc">%&gt;%</span></span>
<span id="cb42-808"><a href="#cb42-808" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">Category =</span> label, <span class="at">.before =</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb42-809"><a href="#cb42-809" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rename</span>(<span class="at">Label =</span> {{ var }}) <span class="sc">%&gt;%</span></span>
<span id="cb42-810"><a href="#cb42-810" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">Label =</span> <span class="fu">as.character</span>(Label))</span>
<span id="cb42-811"><a href="#cb42-811" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb42-812"><a href="#cb42-812" aria-hidden="true" tabindex="-1"></a>  na_count <span class="ot">&lt;-</span> <span class="fu">sum</span>(<span class="fu">is.na</span>(<span class="fu">pull</span>(data, {{ var }})))</span>
<span id="cb42-813"><a href="#cb42-813" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb42-814"><a href="#cb42-814" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (na_count <span class="sc">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb42-815"><a href="#cb42-815" aria-hidden="true" tabindex="-1"></a>    missing_row <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb42-816"><a href="#cb42-816" aria-hidden="true" tabindex="-1"></a>      <span class="at">Category =</span> label,</span>
<span id="cb42-817"><a href="#cb42-817" aria-hidden="true" tabindex="-1"></a>      <span class="at">Label =</span> <span class="st">"Missing"</span>,</span>
<span id="cb42-818"><a href="#cb42-818" aria-hidden="true" tabindex="-1"></a>      <span class="st">`</span><span class="at">Respiratory vaccines</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">sum</span>(data<span class="sc">$</span>vacc_group3 <span class="sc">==</span> <span class="st">"Respiratory vaccines"</span> <span class="sc">&amp;</span> <span class="fu">is.na</span>(<span class="fu">pull</span>(data, {{ var }})), <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb42-819"><a href="#cb42-819" aria-hidden="true" tabindex="-1"></a>      <span class="st">`</span><span class="at">Childhood vaccines</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">sum</span>(data<span class="sc">$</span>vacc_group3 <span class="sc">==</span> <span class="st">"Childhood vaccines"</span> <span class="sc">&amp;</span> <span class="fu">is.na</span>(<span class="fu">pull</span>(data, {{ var }})), <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb42-820"><a href="#cb42-820" aria-hidden="true" tabindex="-1"></a>      <span class="at">Other =</span> <span class="fu">sum</span>(data<span class="sc">$</span>vacc_group3 <span class="sc">==</span> <span class="st">"Other"</span> <span class="sc">&amp;</span> <span class="fu">is.na</span>(<span class="fu">pull</span>(data, {{ var }})), <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb42-821"><a href="#cb42-821" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb42-822"><a href="#cb42-822" aria-hidden="true" tabindex="-1"></a>    tab_final <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(tab_main, missing_row)</span>
<span id="cb42-823"><a href="#cb42-823" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb42-824"><a href="#cb42-824" aria-hidden="true" tabindex="-1"></a>    tab_final <span class="ot">&lt;-</span> tab_main</span>
<span id="cb42-825"><a href="#cb42-825" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb42-826"><a href="#cb42-826" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb42-827"><a href="#cb42-827" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(tab_final)</span>
<span id="cb42-828"><a href="#cb42-828" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb42-829"><a href="#cb42-829" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-830"><a href="#cb42-830" aria-hidden="true" tabindex="-1"></a><span class="co"># .................. Create summary tables ..................</span></span>
<span id="cb42-831"><a href="#cb42-831" aria-hidden="true" tabindex="-1"></a>tab_age            <span class="ot">&lt;-</span> <span class="fu">create_tab</span>(vacc_1524, age_group, <span class="st">"Age"</span>)</span>
<span id="cb42-832"><a href="#cb42-832" aria-hidden="true" tabindex="-1"></a>tab_sex            <span class="ot">&lt;-</span> <span class="fu">create_tab</span>(vacc_1524, gender, <span class="st">"Gender"</span>)</span>
<span id="cb42-833"><a href="#cb42-833" aria-hidden="true" tabindex="-1"></a>tab_marital_status <span class="ot">&lt;-</span> <span class="fu">create_tab</span>(vacc_1524, marital_status, <span class="st">"Marital status"</span>)</span>
<span id="cb42-834"><a href="#cb42-834" aria-hidden="true" tabindex="-1"></a>tab_year           <span class="ot">&lt;-</span> <span class="fu">create_tab</span>(vacc_1524, vacc_service_year, <span class="st">"Year"</span>)</span>
<span id="cb42-835"><a href="#cb42-835" aria-hidden="true" tabindex="-1"></a>tab_quarter        <span class="ot">&lt;-</span> <span class="fu">create_tab</span>(vacc_1524, vacc_quarter, <span class="st">"Quarter"</span>)</span>
<span id="cb42-836"><a href="#cb42-836" aria-hidden="true" tabindex="-1"></a>tab_weekday        <span class="ot">&lt;-</span> <span class="fu">create_tab</span>(vacc_1524, vacc_weekday, <span class="st">"Weekday"</span>)</span>
<span id="cb42-837"><a href="#cb42-837" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-838"><a href="#cb42-838" aria-hidden="true" tabindex="-1"></a><span class="co"># .................. Combine all tables ..................</span></span>
<span id="cb42-839"><a href="#cb42-839" aria-hidden="true" tabindex="-1"></a>tab_combined <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(tab_sex, tab_age, tab_marital_status, tab_year, tab_quarter, tab_weekday)</span>
<span id="cb42-840"><a href="#cb42-840" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-841"><a href="#cb42-841" aria-hidden="true" tabindex="-1"></a><span class="co"># .................. Calculate row-wise percentages (skip for Missing) ..................</span></span>
<span id="cb42-842"><a href="#cb42-842" aria-hidden="true" tabindex="-1"></a>tab_combined <span class="ot">&lt;-</span> tab_combined <span class="sc">%&gt;%</span></span>
<span id="cb42-843"><a href="#cb42-843" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rowwise</span>() <span class="sc">%&gt;%</span></span>
<span id="cb42-844"><a href="#cb42-844" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb42-845"><a href="#cb42-845" aria-hidden="true" tabindex="-1"></a>    <span class="at">Total =</span> <span class="fu">sum</span>(<span class="st">`</span><span class="at">Respiratory vaccines</span><span class="st">`</span>, <span class="st">`</span><span class="at">Childhood vaccines</span><span class="st">`</span>, Other, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb42-846"><a href="#cb42-846" aria-hidden="true" tabindex="-1"></a>    <span class="at">is_missing =</span> <span class="fu">trimws</span>(<span class="fu">tolower</span>(Label)) <span class="sc">==</span> <span class="st">"missing"</span>,</span>
<span id="cb42-847"><a href="#cb42-847" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb42-848"><a href="#cb42-848" aria-hidden="true" tabindex="-1"></a>    <span class="at">Respiratory =</span> <span class="fu">ifelse</span>(is_missing,</span>
<span id="cb42-849"><a href="#cb42-849" aria-hidden="true" tabindex="-1"></a>                         <span class="fu">comma</span>(<span class="st">`</span><span class="at">Respiratory vaccines</span><span class="st">`</span>),</span>
<span id="cb42-850"><a href="#cb42-850" aria-hidden="true" tabindex="-1"></a>                         <span class="fu">paste0</span>(<span class="fu">comma</span>(<span class="st">`</span><span class="at">Respiratory vaccines</span><span class="st">`</span>), <span class="st">" ("</span>, <span class="fu">round</span>(<span class="dv">100</span> <span class="sc">*</span> <span class="st">`</span><span class="at">Respiratory vaccines</span><span class="st">`</span> <span class="sc">/</span> Total, <span class="dv">1</span>), <span class="st">")"</span>)),</span>
<span id="cb42-851"><a href="#cb42-851" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb42-852"><a href="#cb42-852" aria-hidden="true" tabindex="-1"></a>    <span class="at">Childhood =</span> <span class="fu">ifelse</span>(is_missing,</span>
<span id="cb42-853"><a href="#cb42-853" aria-hidden="true" tabindex="-1"></a>                       <span class="fu">comma</span>(<span class="st">`</span><span class="at">Childhood vaccines</span><span class="st">`</span>),</span>
<span id="cb42-854"><a href="#cb42-854" aria-hidden="true" tabindex="-1"></a>                       <span class="fu">paste0</span>(<span class="fu">comma</span>(<span class="st">`</span><span class="at">Childhood vaccines</span><span class="st">`</span>), <span class="st">" ("</span>, <span class="fu">round</span>(<span class="dv">100</span> <span class="sc">*</span> <span class="st">`</span><span class="at">Childhood vaccines</span><span class="st">`</span> <span class="sc">/</span> Total, <span class="dv">1</span>), <span class="st">")"</span>)),</span>
<span id="cb42-855"><a href="#cb42-855" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb42-856"><a href="#cb42-856" aria-hidden="true" tabindex="-1"></a>    <span class="at">Other_grp =</span> <span class="fu">ifelse</span>(is_missing,</span>
<span id="cb42-857"><a href="#cb42-857" aria-hidden="true" tabindex="-1"></a>                       <span class="fu">comma</span>(Other),</span>
<span id="cb42-858"><a href="#cb42-858" aria-hidden="true" tabindex="-1"></a>                       <span class="fu">paste0</span>(<span class="fu">comma</span>(Other), <span class="st">" ("</span>, <span class="fu">round</span>(<span class="dv">100</span> <span class="sc">*</span> Other <span class="sc">/</span> Total, <span class="dv">1</span>), <span class="st">")"</span>))</span>
<span id="cb42-859"><a href="#cb42-859" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb42-860"><a href="#cb42-860" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb42-861"><a href="#cb42-861" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Category, Label, Respiratory, Childhood, Other_grp)</span>
<span id="cb42-862"><a href="#cb42-862" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-863"><a href="#cb42-863" aria-hidden="true" tabindex="-1"></a><span class="co"># .................. Show Category only once per group ..................</span></span>
<span id="cb42-864"><a href="#cb42-864" aria-hidden="true" tabindex="-1"></a>tab_combined <span class="ot">&lt;-</span> tab_combined <span class="sc">%&gt;%</span></span>
<span id="cb42-865"><a href="#cb42-865" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Category) <span class="sc">%&gt;%</span></span>
<span id="cb42-866"><a href="#cb42-866" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Category =</span> <span class="fu">ifelse</span>(<span class="fu">row_number</span>() <span class="sc">==</span> <span class="dv">1</span>, Category, <span class="st">""</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb42-867"><a href="#cb42-867" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb42-868"><a href="#cb42-868" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-869"><a href="#cb42-869" aria-hidden="true" tabindex="-1"></a><span class="co"># .................. Get total counts per vaccine group ..................</span></span>
<span id="cb42-870"><a href="#cb42-870" aria-hidden="true" tabindex="-1"></a>totals <span class="ot">&lt;-</span> vacc_1524 <span class="sc">%&gt;%</span></span>
<span id="cb42-871"><a href="#cb42-871" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(vacc_group3) <span class="sc">%&gt;%</span></span>
<span id="cb42-872"><a href="#cb42-872" aria-hidden="true" tabindex="-1"></a>  <span class="fu">deframe</span>()</span>
<span id="cb42-873"><a href="#cb42-873" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-874"><a href="#cb42-874" aria-hidden="true" tabindex="-1"></a><span class="co"># .................. Create flextable ..................</span></span>
<span id="cb42-875"><a href="#cb42-875" aria-hidden="true" tabindex="-1"></a>ft_vacc_summary <span class="ot">&lt;-</span> tab_combined <span class="sc">%&gt;%</span></span>
<span id="cb42-876"><a href="#cb42-876" aria-hidden="true" tabindex="-1"></a>  <span class="fu">flextable</span>() <span class="sc">%&gt;%</span></span>
<span id="cb42-877"><a href="#cb42-877" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_header_labels</span>(</span>
<span id="cb42-878"><a href="#cb42-878" aria-hidden="true" tabindex="-1"></a>    <span class="at">Category =</span> <span class="st">"Variable type"</span>,</span>
<span id="cb42-879"><a href="#cb42-879" aria-hidden="true" tabindex="-1"></a>    <span class="at">Label =</span> <span class="st">"Values"</span>,</span>
<span id="cb42-880"><a href="#cb42-880" aria-hidden="true" tabindex="-1"></a>    <span class="at">Respiratory =</span> <span class="st">"Number (%)·µÉ"</span>,</span>
<span id="cb42-881"><a href="#cb42-881" aria-hidden="true" tabindex="-1"></a>    <span class="at">Childhood =</span> <span class="st">"Number (%)·µÉ"</span>,</span>
<span id="cb42-882"><a href="#cb42-882" aria-hidden="true" tabindex="-1"></a>    <span class="at">Other_grp =</span> <span class="st">"Number (%)·µÉ"</span></span>
<span id="cb42-883"><a href="#cb42-883" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb42-884"><a href="#cb42-884" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_header_row</span>(</span>
<span id="cb42-885"><a href="#cb42-885" aria-hidden="true" tabindex="-1"></a>    <span class="at">values =</span> <span class="fu">c</span>(</span>
<span id="cb42-886"><a href="#cb42-886" aria-hidden="true" tabindex="-1"></a>      <span class="st">""</span>, <span class="st">""</span>,</span>
<span id="cb42-887"><a href="#cb42-887" aria-hidden="true" tabindex="-1"></a>      <span class="fu">paste0</span>(<span class="st">"Respiratory vaccines (N = "</span>, <span class="fu">format</span>(totals[<span class="st">"Respiratory vaccines"</span>], <span class="at">big.mark =</span> <span class="st">","</span>), <span class="st">")"</span>),</span>
<span id="cb42-888"><a href="#cb42-888" aria-hidden="true" tabindex="-1"></a>      <span class="fu">paste0</span>(<span class="st">"Childhood vaccines (N = "</span>, <span class="fu">format</span>(totals[<span class="st">"Childhood vaccines"</span>], <span class="at">big.mark =</span> <span class="st">","</span>), <span class="st">")"</span>),</span>
<span id="cb42-889"><a href="#cb42-889" aria-hidden="true" tabindex="-1"></a>      <span class="fu">paste0</span>(<span class="st">"Other (N = "</span>, <span class="fu">format</span>(totals[<span class="st">"Other"</span>], <span class="at">big.mark =</span> <span class="st">","</span>), <span class="st">")"</span>)</span>
<span id="cb42-890"><a href="#cb42-890" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb42-891"><a href="#cb42-891" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb42-892"><a href="#cb42-892" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_header_row</span>(</span>
<span id="cb42-893"><a href="#cb42-893" aria-hidden="true" tabindex="-1"></a>    <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"Description"</span>, <span class="st">"Vaccination uptake"</span>),</span>
<span id="cb42-894"><a href="#cb42-894" aria-hidden="true" tabindex="-1"></a>    <span class="at">colwidths =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">3</span>)</span>
<span id="cb42-895"><a href="#cb42-895" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb42-896"><a href="#cb42-896" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_box</span>() <span class="sc">%&gt;%</span></span>
<span id="cb42-897"><a href="#cb42-897" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_table_properties</span>(<span class="at">layout =</span> <span class="st">"autofit"</span>, <span class="at">width =</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb42-898"><a href="#cb42-898" aria-hidden="true" tabindex="-1"></a>  <span class="fu">width</span>(<span class="at">j =</span> <span class="dv">1</span>, <span class="at">width =</span> <span class="fl">1.5</span>) <span class="sc">%&gt;%</span></span>
<span id="cb42-899"><a href="#cb42-899" aria-hidden="true" tabindex="-1"></a>  <span class="fu">width</span>(<span class="at">j =</span> <span class="dv">2</span>, <span class="at">width =</span> <span class="fl">2.5</span>) <span class="sc">%&gt;%</span></span>
<span id="cb42-900"><a href="#cb42-900" aria-hidden="true" tabindex="-1"></a>  <span class="fu">width</span>(<span class="at">j =</span> <span class="dv">3</span><span class="sc">:</span><span class="dv">5</span>, <span class="at">width =</span> <span class="fl">1.5</span>) <span class="sc">%&gt;%</span></span>
<span id="cb42-901"><a href="#cb42-901" aria-hidden="true" tabindex="-1"></a>  <span class="fu">align</span>(<span class="at">align =</span> <span class="st">"justify"</span>, <span class="at">part =</span> <span class="st">"all"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb42-902"><a href="#cb42-902" aria-hidden="true" tabindex="-1"></a>  <span class="fu">border_remove</span>() <span class="sc">%&gt;%</span></span>
<span id="cb42-903"><a href="#cb42-903" aria-hidden="true" tabindex="-1"></a>  <span class="co">#  border_inner_h(border = fp_border(color = "black", width = 1)) %&gt;%</span></span>
<span id="cb42-904"><a href="#cb42-904" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_caption</span>(<span class="st">"Table: Vaccination uptake across service year, quarter, and weekday"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb42-905"><a href="#cb42-905" aria-hidden="true" tabindex="-1"></a>  <span class="fu">footnote</span>(<span class="at">i =</span> <span class="dv">1</span>, </span>
<span id="cb42-906"><a href="#cb42-906" aria-hidden="true" tabindex="-1"></a>           <span class="at">value =</span> <span class="fu">as_paragraph</span>(<span class="st">"Vaccination proportions were calculated row-wise (i.e., by row)."</span>),</span>
<span id="cb42-907"><a href="#cb42-907" aria-hidden="true" tabindex="-1"></a>           <span class="at">ref_symbols =</span> <span class="st">"·µÉ"</span>, </span>
<span id="cb42-908"><a href="#cb42-908" aria-hidden="true" tabindex="-1"></a>           <span class="at">part =</span> <span class="st">"header"</span>)</span>
<span id="cb42-909"><a href="#cb42-909" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-910"><a href="#cb42-910" aria-hidden="true" tabindex="-1"></a><span class="co"># .................. Show the table ..................</span></span>
<span id="cb42-911"><a href="#cb42-911" aria-hidden="true" tabindex="-1"></a>ft_vacc_summary</span>
<span id="cb42-912"><a href="#cb42-912" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-913"><a href="#cb42-913" aria-hidden="true" tabindex="-1"></a><span class="co"># .................. Clean up ..................</span></span>
<span id="cb42-914"><a href="#cb42-914" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(tab_age, tab_sex, tab_marital_status, tab_year, tab_quarter, tab_weekday, </span>
<span id="cb42-915"><a href="#cb42-915" aria-hidden="true" tabindex="-1"></a>   tab_combined, ft_vacc_summary, totals, create_tab)</span>
<span id="cb42-916"><a href="#cb42-916" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-917"><a href="#cb42-917" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb42-918"><a href="#cb42-918" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-919"><a href="#cb42-919" aria-hidden="true" tabindex="-1"></a><span class="fu">## **6 . Only Horizontal Lines**</span></span>
<span id="cb42-920"><a href="#cb42-920" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-921"><a href="#cb42-921" aria-hidden="true" tabindex="-1"></a>This style keeps only **horizontal dividers** to improve readability without overwhelming the user.</span>
<span id="cb42-922"><a href="#cb42-922" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-923"><a href="#cb42-923" aria-hidden="true" tabindex="-1"></a>üìè *Implication*: Helps guide the eye across wide tables while maintaining a clean aesthetic.</span>
<span id="cb42-924"><a href="#cb42-924" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-925"><a href="#cb42-925" aria-hidden="true" tabindex="-1"></a>‚úÖ *Great for*: Formal documents and slide decks where visual clarity is important.</span>
<span id="cb42-926"><a href="#cb42-926" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-929"><a href="#cb42-929" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb42-930"><a href="#cb42-930" aria-hidden="true" tabindex="-1"></a><span class="co"># ------------6. Lines: Only Horizantal Lines -------------------------------------------</span></span>
<span id="cb42-931"><a href="#cb42-931" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-932"><a href="#cb42-932" aria-hidden="true" tabindex="-1"></a><span class="co"># .................. Convert grouping vars to character ..................</span></span>
<span id="cb42-933"><a href="#cb42-933" aria-hidden="true" tabindex="-1"></a>vacc_1524 <span class="ot">&lt;-</span> vacc_1524 <span class="sc">%&gt;%</span></span>
<span id="cb42-934"><a href="#cb42-934" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">c</span>(age_3group, gender, marital_status,</span>
<span id="cb42-935"><a href="#cb42-935" aria-hidden="true" tabindex="-1"></a>                  vacc_service_year, vacc_quarter, vacc_weekday), as.character))</span>
<span id="cb42-936"><a href="#cb42-936" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-937"><a href="#cb42-937" aria-hidden="true" tabindex="-1"></a><span class="co"># .................. Table generation function with Missing ..................</span></span>
<span id="cb42-938"><a href="#cb42-938" aria-hidden="true" tabindex="-1"></a>create_tab <span class="ot">&lt;-</span> <span class="cf">function</span>(data, var, label) {</span>
<span id="cb42-939"><a href="#cb42-939" aria-hidden="true" tabindex="-1"></a>  tab_main <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span></span>
<span id="cb42-940"><a href="#cb42-940" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>({{ var }})) <span class="sc">%&gt;%</span></span>
<span id="cb42-941"><a href="#cb42-941" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tabyl</span>({{ var }}, vacc_group3) <span class="sc">%&gt;%</span></span>
<span id="cb42-942"><a href="#cb42-942" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">Category =</span> label, <span class="at">.before =</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb42-943"><a href="#cb42-943" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rename</span>(<span class="at">Label =</span> {{ var }}) <span class="sc">%&gt;%</span></span>
<span id="cb42-944"><a href="#cb42-944" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">Label =</span> <span class="fu">as.character</span>(Label))</span>
<span id="cb42-945"><a href="#cb42-945" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb42-946"><a href="#cb42-946" aria-hidden="true" tabindex="-1"></a>  na_count <span class="ot">&lt;-</span> <span class="fu">sum</span>(<span class="fu">is.na</span>(<span class="fu">pull</span>(data, {{ var }})))</span>
<span id="cb42-947"><a href="#cb42-947" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb42-948"><a href="#cb42-948" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (na_count <span class="sc">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb42-949"><a href="#cb42-949" aria-hidden="true" tabindex="-1"></a>    missing_row <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb42-950"><a href="#cb42-950" aria-hidden="true" tabindex="-1"></a>      <span class="at">Category =</span> label,</span>
<span id="cb42-951"><a href="#cb42-951" aria-hidden="true" tabindex="-1"></a>      <span class="at">Label =</span> <span class="st">"Missing"</span>,</span>
<span id="cb42-952"><a href="#cb42-952" aria-hidden="true" tabindex="-1"></a>      <span class="st">`</span><span class="at">Respiratory vaccines</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">sum</span>(data<span class="sc">$</span>vacc_group3 <span class="sc">==</span> <span class="st">"Respiratory vaccines"</span> <span class="sc">&amp;</span> <span class="fu">is.na</span>(<span class="fu">pull</span>(data, {{ var }})), <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb42-953"><a href="#cb42-953" aria-hidden="true" tabindex="-1"></a>      <span class="st">`</span><span class="at">Childhood vaccines</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">sum</span>(data<span class="sc">$</span>vacc_group3 <span class="sc">==</span> <span class="st">"Childhood vaccines"</span> <span class="sc">&amp;</span> <span class="fu">is.na</span>(<span class="fu">pull</span>(data, {{ var }})), <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb42-954"><a href="#cb42-954" aria-hidden="true" tabindex="-1"></a>      <span class="at">Other =</span> <span class="fu">sum</span>(data<span class="sc">$</span>vacc_group3 <span class="sc">==</span> <span class="st">"Other"</span> <span class="sc">&amp;</span> <span class="fu">is.na</span>(<span class="fu">pull</span>(data, {{ var }})), <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb42-955"><a href="#cb42-955" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb42-956"><a href="#cb42-956" aria-hidden="true" tabindex="-1"></a>    tab_final <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(tab_main, missing_row)</span>
<span id="cb42-957"><a href="#cb42-957" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb42-958"><a href="#cb42-958" aria-hidden="true" tabindex="-1"></a>    tab_final <span class="ot">&lt;-</span> tab_main</span>
<span id="cb42-959"><a href="#cb42-959" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb42-960"><a href="#cb42-960" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb42-961"><a href="#cb42-961" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(tab_final)</span>
<span id="cb42-962"><a href="#cb42-962" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb42-963"><a href="#cb42-963" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-964"><a href="#cb42-964" aria-hidden="true" tabindex="-1"></a><span class="co"># .................. Create summary tables ..................</span></span>
<span id="cb42-965"><a href="#cb42-965" aria-hidden="true" tabindex="-1"></a>tab_age            <span class="ot">&lt;-</span> <span class="fu">create_tab</span>(vacc_1524, age_group, <span class="st">"Age"</span>)</span>
<span id="cb42-966"><a href="#cb42-966" aria-hidden="true" tabindex="-1"></a>tab_sex            <span class="ot">&lt;-</span> <span class="fu">create_tab</span>(vacc_1524, gender, <span class="st">"Gender"</span>)</span>
<span id="cb42-967"><a href="#cb42-967" aria-hidden="true" tabindex="-1"></a>tab_marital_status <span class="ot">&lt;-</span> <span class="fu">create_tab</span>(vacc_1524, marital_status, <span class="st">"Marital status"</span>)</span>
<span id="cb42-968"><a href="#cb42-968" aria-hidden="true" tabindex="-1"></a>tab_year           <span class="ot">&lt;-</span> <span class="fu">create_tab</span>(vacc_1524, vacc_service_year, <span class="st">"Year"</span>)</span>
<span id="cb42-969"><a href="#cb42-969" aria-hidden="true" tabindex="-1"></a>tab_quarter        <span class="ot">&lt;-</span> <span class="fu">create_tab</span>(vacc_1524, vacc_quarter, <span class="st">"Quarter"</span>)</span>
<span id="cb42-970"><a href="#cb42-970" aria-hidden="true" tabindex="-1"></a>tab_weekday        <span class="ot">&lt;-</span> <span class="fu">create_tab</span>(vacc_1524, vacc_weekday, <span class="st">"Weekday"</span>)</span>
<span id="cb42-971"><a href="#cb42-971" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-972"><a href="#cb42-972" aria-hidden="true" tabindex="-1"></a><span class="co"># .................. Combine all tables ..................</span></span>
<span id="cb42-973"><a href="#cb42-973" aria-hidden="true" tabindex="-1"></a>tab_combined <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(tab_sex, tab_age, tab_marital_status, tab_year, tab_quarter, tab_weekday)</span>
<span id="cb42-974"><a href="#cb42-974" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-975"><a href="#cb42-975" aria-hidden="true" tabindex="-1"></a><span class="co"># .................. Calculate row-wise percentages (skip for Missing) ..................</span></span>
<span id="cb42-976"><a href="#cb42-976" aria-hidden="true" tabindex="-1"></a>tab_combined <span class="ot">&lt;-</span> tab_combined <span class="sc">%&gt;%</span></span>
<span id="cb42-977"><a href="#cb42-977" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rowwise</span>() <span class="sc">%&gt;%</span></span>
<span id="cb42-978"><a href="#cb42-978" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb42-979"><a href="#cb42-979" aria-hidden="true" tabindex="-1"></a>    <span class="at">Total =</span> <span class="fu">sum</span>(<span class="st">`</span><span class="at">Respiratory vaccines</span><span class="st">`</span>, <span class="st">`</span><span class="at">Childhood vaccines</span><span class="st">`</span>, Other, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb42-980"><a href="#cb42-980" aria-hidden="true" tabindex="-1"></a>    <span class="at">is_missing =</span> <span class="fu">trimws</span>(<span class="fu">tolower</span>(Label)) <span class="sc">==</span> <span class="st">"missing"</span>,</span>
<span id="cb42-981"><a href="#cb42-981" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb42-982"><a href="#cb42-982" aria-hidden="true" tabindex="-1"></a>    <span class="at">Respiratory =</span> <span class="fu">ifelse</span>(is_missing,</span>
<span id="cb42-983"><a href="#cb42-983" aria-hidden="true" tabindex="-1"></a>                         <span class="fu">comma</span>(<span class="st">`</span><span class="at">Respiratory vaccines</span><span class="st">`</span>),</span>
<span id="cb42-984"><a href="#cb42-984" aria-hidden="true" tabindex="-1"></a>                         <span class="fu">paste0</span>(<span class="fu">comma</span>(<span class="st">`</span><span class="at">Respiratory vaccines</span><span class="st">`</span>), <span class="st">" ("</span>, <span class="fu">round</span>(<span class="dv">100</span> <span class="sc">*</span> <span class="st">`</span><span class="at">Respiratory vaccines</span><span class="st">`</span> <span class="sc">/</span> Total, <span class="dv">1</span>), <span class="st">")"</span>)),</span>
<span id="cb42-985"><a href="#cb42-985" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb42-986"><a href="#cb42-986" aria-hidden="true" tabindex="-1"></a>    <span class="at">Childhood =</span> <span class="fu">ifelse</span>(is_missing,</span>
<span id="cb42-987"><a href="#cb42-987" aria-hidden="true" tabindex="-1"></a>                       <span class="fu">comma</span>(<span class="st">`</span><span class="at">Childhood vaccines</span><span class="st">`</span>),</span>
<span id="cb42-988"><a href="#cb42-988" aria-hidden="true" tabindex="-1"></a>                       <span class="fu">paste0</span>(<span class="fu">comma</span>(<span class="st">`</span><span class="at">Childhood vaccines</span><span class="st">`</span>), <span class="st">" ("</span>, <span class="fu">round</span>(<span class="dv">100</span> <span class="sc">*</span> <span class="st">`</span><span class="at">Childhood vaccines</span><span class="st">`</span> <span class="sc">/</span> Total, <span class="dv">1</span>), <span class="st">")"</span>)),</span>
<span id="cb42-989"><a href="#cb42-989" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb42-990"><a href="#cb42-990" aria-hidden="true" tabindex="-1"></a>    <span class="at">Other_grp =</span> <span class="fu">ifelse</span>(is_missing,</span>
<span id="cb42-991"><a href="#cb42-991" aria-hidden="true" tabindex="-1"></a>                       <span class="fu">comma</span>(Other),</span>
<span id="cb42-992"><a href="#cb42-992" aria-hidden="true" tabindex="-1"></a>                       <span class="fu">paste0</span>(<span class="fu">comma</span>(Other), <span class="st">" ("</span>, <span class="fu">round</span>(<span class="dv">100</span> <span class="sc">*</span> Other <span class="sc">/</span> Total, <span class="dv">1</span>), <span class="st">")"</span>))</span>
<span id="cb42-993"><a href="#cb42-993" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb42-994"><a href="#cb42-994" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb42-995"><a href="#cb42-995" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Category, Label, Respiratory, Childhood, Other_grp)</span>
<span id="cb42-996"><a href="#cb42-996" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-997"><a href="#cb42-997" aria-hidden="true" tabindex="-1"></a><span class="co"># .................. Show Category only once per group ..................</span></span>
<span id="cb42-998"><a href="#cb42-998" aria-hidden="true" tabindex="-1"></a>tab_combined <span class="ot">&lt;-</span> tab_combined <span class="sc">%&gt;%</span></span>
<span id="cb42-999"><a href="#cb42-999" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Category) <span class="sc">%&gt;%</span></span>
<span id="cb42-1000"><a href="#cb42-1000" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Category =</span> <span class="fu">ifelse</span>(<span class="fu">row_number</span>() <span class="sc">==</span> <span class="dv">1</span>, Category, <span class="st">""</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb42-1001"><a href="#cb42-1001" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb42-1002"><a href="#cb42-1002" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-1003"><a href="#cb42-1003" aria-hidden="true" tabindex="-1"></a><span class="co"># .................. Get total counts per vaccine group ..................</span></span>
<span id="cb42-1004"><a href="#cb42-1004" aria-hidden="true" tabindex="-1"></a>totals <span class="ot">&lt;-</span> vacc_1524 <span class="sc">%&gt;%</span></span>
<span id="cb42-1005"><a href="#cb42-1005" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(vacc_group3) <span class="sc">%&gt;%</span></span>
<span id="cb42-1006"><a href="#cb42-1006" aria-hidden="true" tabindex="-1"></a>  <span class="fu">deframe</span>()</span>
<span id="cb42-1007"><a href="#cb42-1007" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-1008"><a href="#cb42-1008" aria-hidden="true" tabindex="-1"></a><span class="co"># .................. Create flextable ..................</span></span>
<span id="cb42-1009"><a href="#cb42-1009" aria-hidden="true" tabindex="-1"></a>ft_vacc_summary <span class="ot">&lt;-</span> tab_combined <span class="sc">%&gt;%</span></span>
<span id="cb42-1010"><a href="#cb42-1010" aria-hidden="true" tabindex="-1"></a>  <span class="fu">flextable</span>() <span class="sc">%&gt;%</span></span>
<span id="cb42-1011"><a href="#cb42-1011" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_header_labels</span>(</span>
<span id="cb42-1012"><a href="#cb42-1012" aria-hidden="true" tabindex="-1"></a>    <span class="at">Category =</span> <span class="st">"Variable type"</span>,</span>
<span id="cb42-1013"><a href="#cb42-1013" aria-hidden="true" tabindex="-1"></a>    <span class="at">Label =</span> <span class="st">"Values"</span>,</span>
<span id="cb42-1014"><a href="#cb42-1014" aria-hidden="true" tabindex="-1"></a>    <span class="at">Respiratory =</span> <span class="st">"Number (%)·µÉ"</span>,</span>
<span id="cb42-1015"><a href="#cb42-1015" aria-hidden="true" tabindex="-1"></a>    <span class="at">Childhood =</span> <span class="st">"Number (%)·µÉ"</span>,</span>
<span id="cb42-1016"><a href="#cb42-1016" aria-hidden="true" tabindex="-1"></a>    <span class="at">Other_grp =</span> <span class="st">"Number (%)·µÉ"</span></span>
<span id="cb42-1017"><a href="#cb42-1017" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb42-1018"><a href="#cb42-1018" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_header_row</span>(</span>
<span id="cb42-1019"><a href="#cb42-1019" aria-hidden="true" tabindex="-1"></a>    <span class="at">values =</span> <span class="fu">c</span>(</span>
<span id="cb42-1020"><a href="#cb42-1020" aria-hidden="true" tabindex="-1"></a>      <span class="st">""</span>, <span class="st">""</span>,</span>
<span id="cb42-1021"><a href="#cb42-1021" aria-hidden="true" tabindex="-1"></a>      <span class="fu">paste0</span>(<span class="st">"Respiratory vaccines (N = "</span>, <span class="fu">format</span>(totals[<span class="st">"Respiratory vaccines"</span>], <span class="at">big.mark =</span> <span class="st">","</span>), <span class="st">")"</span>),</span>
<span id="cb42-1022"><a href="#cb42-1022" aria-hidden="true" tabindex="-1"></a>      <span class="fu">paste0</span>(<span class="st">"Childhood vaccines (N = "</span>, <span class="fu">format</span>(totals[<span class="st">"Childhood vaccines"</span>], <span class="at">big.mark =</span> <span class="st">","</span>), <span class="st">")"</span>),</span>
<span id="cb42-1023"><a href="#cb42-1023" aria-hidden="true" tabindex="-1"></a>      <span class="fu">paste0</span>(<span class="st">"Other (N = "</span>, <span class="fu">format</span>(totals[<span class="st">"Other"</span>], <span class="at">big.mark =</span> <span class="st">","</span>), <span class="st">")"</span>)</span>
<span id="cb42-1024"><a href="#cb42-1024" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb42-1025"><a href="#cb42-1025" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb42-1026"><a href="#cb42-1026" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_header_row</span>(</span>
<span id="cb42-1027"><a href="#cb42-1027" aria-hidden="true" tabindex="-1"></a>    <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"Description"</span>, <span class="st">"Vaccination uptake"</span>),</span>
<span id="cb42-1028"><a href="#cb42-1028" aria-hidden="true" tabindex="-1"></a>    <span class="at">colwidths =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">3</span>)</span>
<span id="cb42-1029"><a href="#cb42-1029" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb42-1030"><a href="#cb42-1030" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_box</span>() <span class="sc">%&gt;%</span></span>
<span id="cb42-1031"><a href="#cb42-1031" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_table_properties</span>(<span class="at">layout =</span> <span class="st">"autofit"</span>, <span class="at">width =</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb42-1032"><a href="#cb42-1032" aria-hidden="true" tabindex="-1"></a>  <span class="fu">width</span>(<span class="at">j =</span> <span class="dv">1</span>, <span class="at">width =</span> <span class="fl">1.5</span>) <span class="sc">%&gt;%</span></span>
<span id="cb42-1033"><a href="#cb42-1033" aria-hidden="true" tabindex="-1"></a>  <span class="fu">width</span>(<span class="at">j =</span> <span class="dv">2</span>, <span class="at">width =</span> <span class="fl">2.5</span>) <span class="sc">%&gt;%</span></span>
<span id="cb42-1034"><a href="#cb42-1034" aria-hidden="true" tabindex="-1"></a>  <span class="fu">width</span>(<span class="at">j =</span> <span class="dv">3</span><span class="sc">:</span><span class="dv">5</span>, <span class="at">width =</span> <span class="fl">1.5</span>) <span class="sc">%&gt;%</span></span>
<span id="cb42-1035"><a href="#cb42-1035" aria-hidden="true" tabindex="-1"></a>  <span class="fu">align</span>(<span class="at">align =</span> <span class="st">"justify"</span>, <span class="at">part =</span> <span class="st">"all"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb42-1036"><a href="#cb42-1036" aria-hidden="true" tabindex="-1"></a>  <span class="fu">border_remove</span>() <span class="sc">%&gt;%</span></span>
<span id="cb42-1037"><a href="#cb42-1037" aria-hidden="true" tabindex="-1"></a>  <span class="fu">border</span>(<span class="at">part =</span> <span class="st">"header"</span>, <span class="at">i =</span> <span class="dv">1</span>, <span class="at">border.top =</span> <span class="fu">fp_border</span>(<span class="at">color =</span> <span class="st">"black"</span>, <span class="at">width =</span> <span class="dv">1</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb42-1038"><a href="#cb42-1038" aria-hidden="true" tabindex="-1"></a>  <span class="fu">border</span>(<span class="at">part =</span> <span class="st">"header"</span>, <span class="at">i =</span> <span class="dv">3</span>, <span class="at">border.bottom =</span> <span class="fu">fp_border</span>(<span class="at">color =</span> <span class="st">"black"</span>, <span class="at">width =</span> <span class="dv">1</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb42-1039"><a href="#cb42-1039" aria-hidden="true" tabindex="-1"></a>  <span class="fu">border_inner_h</span>(<span class="at">part =</span> <span class="st">"header"</span>, <span class="at">border =</span> <span class="fu">fp_border</span>(<span class="at">color =</span> <span class="st">"black"</span>, <span class="at">width =</span> <span class="fl">0.8</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb42-1040"><a href="#cb42-1040" aria-hidden="true" tabindex="-1"></a>  <span class="fu">border_inner_h</span>(<span class="at">part =</span> <span class="st">"body"</span>, <span class="at">border =</span> <span class="fu">fp_border</span>(<span class="at">color =</span> <span class="st">"black"</span>, <span class="at">width =</span> <span class="fl">0.8</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb42-1041"><a href="#cb42-1041" aria-hidden="true" tabindex="-1"></a>  <span class="fu">border</span>(<span class="at">part =</span> <span class="st">"body"</span>, <span class="at">i =</span> <span class="fu">nrow</span>(tab_combined), <span class="at">border.bottom =</span> <span class="fu">fp_border</span>(<span class="at">color =</span> <span class="st">"black"</span>, <span class="at">width =</span> <span class="dv">1</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb42-1042"><a href="#cb42-1042" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb42-1043"><a href="#cb42-1043" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_caption</span>(<span class="st">"Table: Vaccination uptake across service year, quarter, and weekday"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb42-1044"><a href="#cb42-1044" aria-hidden="true" tabindex="-1"></a>  <span class="fu">footnote</span>(<span class="at">i =</span> <span class="dv">1</span>, </span>
<span id="cb42-1045"><a href="#cb42-1045" aria-hidden="true" tabindex="-1"></a>           <span class="at">value =</span> <span class="fu">as_paragraph</span>(<span class="st">"Vaccination proportions were calculated row-wise (i.e., by row)."</span>),</span>
<span id="cb42-1046"><a href="#cb42-1046" aria-hidden="true" tabindex="-1"></a>           <span class="at">ref_symbols =</span> <span class="st">"·µÉ"</span>, </span>
<span id="cb42-1047"><a href="#cb42-1047" aria-hidden="true" tabindex="-1"></a>           <span class="at">part =</span> <span class="st">"header"</span>)</span>
<span id="cb42-1048"><a href="#cb42-1048" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-1049"><a href="#cb42-1049" aria-hidden="true" tabindex="-1"></a><span class="co"># .................. Show the table ..................</span></span>
<span id="cb42-1050"><a href="#cb42-1050" aria-hidden="true" tabindex="-1"></a>ft_vacc_summary</span>
<span id="cb42-1051"><a href="#cb42-1051" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-1052"><a href="#cb42-1052" aria-hidden="true" tabindex="-1"></a><span class="co"># .................. Clean up ..................</span></span>
<span id="cb42-1053"><a href="#cb42-1053" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(tab_age, tab_sex, tab_marital_status, tab_year, tab_quarter, tab_weekday, </span>
<span id="cb42-1054"><a href="#cb42-1054" aria-hidden="true" tabindex="-1"></a>   tab_combined, ft_vacc_summary, totals, create_tab)</span>
<span id="cb42-1055"><a href="#cb42-1055" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-1056"><a href="#cb42-1056" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb42-1057"><a href="#cb42-1057" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-1058"><a href="#cb42-1058" aria-hidden="true" tabindex="-1"></a><span class="fu">## **7. All Lines Visible**</span></span>
<span id="cb42-1059"><a href="#cb42-1059" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-1060"><a href="#cb42-1060" aria-hidden="true" tabindex="-1"></a>This version includes both **horizontal and vertical grid lines**, mimicking Excel-style tables.</span>
<span id="cb42-1061"><a href="#cb42-1061" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-1062"><a href="#cb42-1062" aria-hidden="true" tabindex="-1"></a>üìä *When to use*: When presenting detailed tables where structure must be visually enforced.</span>
<span id="cb42-1063"><a href="#cb42-1063" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-1064"><a href="#cb42-1064" aria-hidden="true" tabindex="-1"></a>üì¶ *Applicability*: Regulatory reports, appendices, or complex data breakdowns.</span>
<span id="cb42-1065"><a href="#cb42-1065" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-1068"><a href="#cb42-1068" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb42-1069"><a href="#cb42-1069" aria-hidden="true" tabindex="-1"></a><span class="co"># ------------6. Lines: All Lines Visible-------------------------------------------</span></span>
<span id="cb42-1070"><a href="#cb42-1070" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-1071"><a href="#cb42-1071" aria-hidden="true" tabindex="-1"></a><span class="co"># .................. Convert grouping vars to character ..................</span></span>
<span id="cb42-1072"><a href="#cb42-1072" aria-hidden="true" tabindex="-1"></a>vacc_1524 <span class="ot">&lt;-</span> vacc_1524 <span class="sc">%&gt;%</span></span>
<span id="cb42-1073"><a href="#cb42-1073" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">c</span>(age_group, gender, marital_status,</span>
<span id="cb42-1074"><a href="#cb42-1074" aria-hidden="true" tabindex="-1"></a>                  vacc_service_year, vacc_quarter, vacc_weekday), as.character))</span>
<span id="cb42-1075"><a href="#cb42-1075" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-1076"><a href="#cb42-1076" aria-hidden="true" tabindex="-1"></a><span class="co"># .................. Table generation function with Missing ..................</span></span>
<span id="cb42-1077"><a href="#cb42-1077" aria-hidden="true" tabindex="-1"></a>create_tab <span class="ot">&lt;-</span> <span class="cf">function</span>(data, var, label) {</span>
<span id="cb42-1078"><a href="#cb42-1078" aria-hidden="true" tabindex="-1"></a>  tab_main <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span></span>
<span id="cb42-1079"><a href="#cb42-1079" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>({{ var }})) <span class="sc">%&gt;%</span></span>
<span id="cb42-1080"><a href="#cb42-1080" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tabyl</span>({{ var }}, vacc_group3) <span class="sc">%&gt;%</span></span>
<span id="cb42-1081"><a href="#cb42-1081" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">Category =</span> label, <span class="at">.before =</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb42-1082"><a href="#cb42-1082" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rename</span>(<span class="at">Label =</span> {{ var }}) <span class="sc">%&gt;%</span></span>
<span id="cb42-1083"><a href="#cb42-1083" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">Label =</span> <span class="fu">as.character</span>(Label))</span>
<span id="cb42-1084"><a href="#cb42-1084" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb42-1085"><a href="#cb42-1085" aria-hidden="true" tabindex="-1"></a>  na_count <span class="ot">&lt;-</span> <span class="fu">sum</span>(<span class="fu">is.na</span>(<span class="fu">pull</span>(data, {{ var }})))</span>
<span id="cb42-1086"><a href="#cb42-1086" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb42-1087"><a href="#cb42-1087" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (na_count <span class="sc">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb42-1088"><a href="#cb42-1088" aria-hidden="true" tabindex="-1"></a>    missing_row <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb42-1089"><a href="#cb42-1089" aria-hidden="true" tabindex="-1"></a>      <span class="at">Category =</span> label,</span>
<span id="cb42-1090"><a href="#cb42-1090" aria-hidden="true" tabindex="-1"></a>      <span class="at">Label =</span> <span class="st">"Missing"</span>,</span>
<span id="cb42-1091"><a href="#cb42-1091" aria-hidden="true" tabindex="-1"></a>      <span class="st">`</span><span class="at">Respiratory vaccines</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">sum</span>(data<span class="sc">$</span>vacc_group3 <span class="sc">==</span> <span class="st">"Respiratory vaccines"</span> <span class="sc">&amp;</span> <span class="fu">is.na</span>(<span class="fu">pull</span>(data, {{ var }})), <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb42-1092"><a href="#cb42-1092" aria-hidden="true" tabindex="-1"></a>      <span class="st">`</span><span class="at">Childhood vaccines</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">sum</span>(data<span class="sc">$</span>vacc_group3 <span class="sc">==</span> <span class="st">"Childhood vaccines"</span> <span class="sc">&amp;</span> <span class="fu">is.na</span>(<span class="fu">pull</span>(data, {{ var }})), <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb42-1093"><a href="#cb42-1093" aria-hidden="true" tabindex="-1"></a>      <span class="at">Other =</span> <span class="fu">sum</span>(data<span class="sc">$</span>vacc_group3 <span class="sc">==</span> <span class="st">"Other"</span> <span class="sc">&amp;</span> <span class="fu">is.na</span>(<span class="fu">pull</span>(data, {{ var }})), <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb42-1094"><a href="#cb42-1094" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb42-1095"><a href="#cb42-1095" aria-hidden="true" tabindex="-1"></a>    tab_final <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(tab_main, missing_row)</span>
<span id="cb42-1096"><a href="#cb42-1096" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb42-1097"><a href="#cb42-1097" aria-hidden="true" tabindex="-1"></a>    tab_final <span class="ot">&lt;-</span> tab_main</span>
<span id="cb42-1098"><a href="#cb42-1098" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb42-1099"><a href="#cb42-1099" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb42-1100"><a href="#cb42-1100" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(tab_final)</span>
<span id="cb42-1101"><a href="#cb42-1101" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb42-1102"><a href="#cb42-1102" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-1103"><a href="#cb42-1103" aria-hidden="true" tabindex="-1"></a><span class="co"># .................. Create summary tables ..................</span></span>
<span id="cb42-1104"><a href="#cb42-1104" aria-hidden="true" tabindex="-1"></a>tab_age            <span class="ot">&lt;-</span> <span class="fu">create_tab</span>(vacc_1524, age_group, <span class="st">"Age"</span>)</span>
<span id="cb42-1105"><a href="#cb42-1105" aria-hidden="true" tabindex="-1"></a>tab_sex            <span class="ot">&lt;-</span> <span class="fu">create_tab</span>(vacc_1524, gender, <span class="st">"Gender"</span>)</span>
<span id="cb42-1106"><a href="#cb42-1106" aria-hidden="true" tabindex="-1"></a>tab_marital_status <span class="ot">&lt;-</span> <span class="fu">create_tab</span>(vacc_1524, marital_status, <span class="st">"Marital status"</span>)</span>
<span id="cb42-1107"><a href="#cb42-1107" aria-hidden="true" tabindex="-1"></a>tab_year           <span class="ot">&lt;-</span> <span class="fu">create_tab</span>(vacc_1524, vacc_service_year, <span class="st">"Year"</span>)</span>
<span id="cb42-1108"><a href="#cb42-1108" aria-hidden="true" tabindex="-1"></a>tab_quarter        <span class="ot">&lt;-</span> <span class="fu">create_tab</span>(vacc_1524, vacc_quarter, <span class="st">"Quarter"</span>)</span>
<span id="cb42-1109"><a href="#cb42-1109" aria-hidden="true" tabindex="-1"></a>tab_weekday        <span class="ot">&lt;-</span> <span class="fu">create_tab</span>(vacc_1524, vacc_weekday, <span class="st">"Weekday"</span>)</span>
<span id="cb42-1110"><a href="#cb42-1110" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-1111"><a href="#cb42-1111" aria-hidden="true" tabindex="-1"></a><span class="co"># .................. Combine all tables ..................</span></span>
<span id="cb42-1112"><a href="#cb42-1112" aria-hidden="true" tabindex="-1"></a>tab_combined <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(tab_sex, tab_age, tab_marital_status, tab_year, tab_quarter, tab_weekday)</span>
<span id="cb42-1113"><a href="#cb42-1113" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-1114"><a href="#cb42-1114" aria-hidden="true" tabindex="-1"></a><span class="co"># .................. Calculate row-wise percentages (skip for Missing) ..................</span></span>
<span id="cb42-1115"><a href="#cb42-1115" aria-hidden="true" tabindex="-1"></a>tab_combined <span class="ot">&lt;-</span> tab_combined <span class="sc">%&gt;%</span></span>
<span id="cb42-1116"><a href="#cb42-1116" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rowwise</span>() <span class="sc">%&gt;%</span></span>
<span id="cb42-1117"><a href="#cb42-1117" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb42-1118"><a href="#cb42-1118" aria-hidden="true" tabindex="-1"></a>    <span class="at">Total =</span> <span class="fu">sum</span>(<span class="st">`</span><span class="at">Respiratory vaccines</span><span class="st">`</span>, <span class="st">`</span><span class="at">Childhood vaccines</span><span class="st">`</span>, Other, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb42-1119"><a href="#cb42-1119" aria-hidden="true" tabindex="-1"></a>    <span class="at">is_missing =</span> <span class="fu">trimws</span>(<span class="fu">tolower</span>(Label)) <span class="sc">==</span> <span class="st">"missing"</span>,</span>
<span id="cb42-1120"><a href="#cb42-1120" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb42-1121"><a href="#cb42-1121" aria-hidden="true" tabindex="-1"></a>    <span class="at">Respiratory =</span> <span class="fu">ifelse</span>(is_missing,</span>
<span id="cb42-1122"><a href="#cb42-1122" aria-hidden="true" tabindex="-1"></a>                         <span class="fu">comma</span>(<span class="st">`</span><span class="at">Respiratory vaccines</span><span class="st">`</span>),</span>
<span id="cb42-1123"><a href="#cb42-1123" aria-hidden="true" tabindex="-1"></a>                         <span class="fu">paste0</span>(<span class="fu">comma</span>(<span class="st">`</span><span class="at">Respiratory vaccines</span><span class="st">`</span>), <span class="st">" ("</span>, <span class="fu">round</span>(<span class="dv">100</span> <span class="sc">*</span> <span class="st">`</span><span class="at">Respiratory vaccines</span><span class="st">`</span> <span class="sc">/</span> Total, <span class="dv">1</span>), <span class="st">")"</span>)),</span>
<span id="cb42-1124"><a href="#cb42-1124" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb42-1125"><a href="#cb42-1125" aria-hidden="true" tabindex="-1"></a>    <span class="at">Childhood =</span> <span class="fu">ifelse</span>(is_missing,</span>
<span id="cb42-1126"><a href="#cb42-1126" aria-hidden="true" tabindex="-1"></a>                       <span class="fu">comma</span>(<span class="st">`</span><span class="at">Childhood vaccines</span><span class="st">`</span>),</span>
<span id="cb42-1127"><a href="#cb42-1127" aria-hidden="true" tabindex="-1"></a>                       <span class="fu">paste0</span>(<span class="fu">comma</span>(<span class="st">`</span><span class="at">Childhood vaccines</span><span class="st">`</span>), <span class="st">" ("</span>, <span class="fu">round</span>(<span class="dv">100</span> <span class="sc">*</span> <span class="st">`</span><span class="at">Childhood vaccines</span><span class="st">`</span> <span class="sc">/</span> Total, <span class="dv">1</span>), <span class="st">")"</span>)),</span>
<span id="cb42-1128"><a href="#cb42-1128" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb42-1129"><a href="#cb42-1129" aria-hidden="true" tabindex="-1"></a>    <span class="at">Other_grp =</span> <span class="fu">ifelse</span>(is_missing,</span>
<span id="cb42-1130"><a href="#cb42-1130" aria-hidden="true" tabindex="-1"></a>                       <span class="fu">comma</span>(Other),</span>
<span id="cb42-1131"><a href="#cb42-1131" aria-hidden="true" tabindex="-1"></a>                       <span class="fu">paste0</span>(<span class="fu">comma</span>(Other), <span class="st">" ("</span>, <span class="fu">round</span>(<span class="dv">100</span> <span class="sc">*</span> Other <span class="sc">/</span> Total, <span class="dv">1</span>), <span class="st">")"</span>))</span>
<span id="cb42-1132"><a href="#cb42-1132" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb42-1133"><a href="#cb42-1133" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb42-1134"><a href="#cb42-1134" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Category, Label, Respiratory, Childhood, Other_grp)</span>
<span id="cb42-1135"><a href="#cb42-1135" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-1136"><a href="#cb42-1136" aria-hidden="true" tabindex="-1"></a><span class="co"># .................. Show Category only once per group ..................</span></span>
<span id="cb42-1137"><a href="#cb42-1137" aria-hidden="true" tabindex="-1"></a>tab_combined <span class="ot">&lt;-</span> tab_combined <span class="sc">%&gt;%</span></span>
<span id="cb42-1138"><a href="#cb42-1138" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Category) <span class="sc">%&gt;%</span></span>
<span id="cb42-1139"><a href="#cb42-1139" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Category =</span> <span class="fu">ifelse</span>(<span class="fu">row_number</span>() <span class="sc">==</span> <span class="dv">1</span>, Category, <span class="st">""</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb42-1140"><a href="#cb42-1140" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb42-1141"><a href="#cb42-1141" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-1142"><a href="#cb42-1142" aria-hidden="true" tabindex="-1"></a><span class="co"># .................. Get total counts per vaccine group ..................</span></span>
<span id="cb42-1143"><a href="#cb42-1143" aria-hidden="true" tabindex="-1"></a>totals <span class="ot">&lt;-</span> vacc_1524 <span class="sc">%&gt;%</span></span>
<span id="cb42-1144"><a href="#cb42-1144" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(vacc_group3) <span class="sc">%&gt;%</span></span>
<span id="cb42-1145"><a href="#cb42-1145" aria-hidden="true" tabindex="-1"></a>  <span class="fu">deframe</span>()</span>
<span id="cb42-1146"><a href="#cb42-1146" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-1147"><a href="#cb42-1147" aria-hidden="true" tabindex="-1"></a><span class="co"># .................. Create flextable ..................</span></span>
<span id="cb42-1148"><a href="#cb42-1148" aria-hidden="true" tabindex="-1"></a>ft_vacc_summary <span class="ot">&lt;-</span> tab_combined <span class="sc">%&gt;%</span></span>
<span id="cb42-1149"><a href="#cb42-1149" aria-hidden="true" tabindex="-1"></a>  <span class="fu">flextable</span>() <span class="sc">%&gt;%</span></span>
<span id="cb42-1150"><a href="#cb42-1150" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_header_labels</span>(</span>
<span id="cb42-1151"><a href="#cb42-1151" aria-hidden="true" tabindex="-1"></a>    <span class="at">Category =</span> <span class="st">"Variable type"</span>,</span>
<span id="cb42-1152"><a href="#cb42-1152" aria-hidden="true" tabindex="-1"></a>    <span class="at">Label =</span> <span class="st">"Values"</span>,</span>
<span id="cb42-1153"><a href="#cb42-1153" aria-hidden="true" tabindex="-1"></a>    <span class="at">Respiratory =</span> <span class="st">"Number (%)·µÉ"</span>,</span>
<span id="cb42-1154"><a href="#cb42-1154" aria-hidden="true" tabindex="-1"></a>    <span class="at">Childhood =</span> <span class="st">"Number (%)·µÉ"</span>,</span>
<span id="cb42-1155"><a href="#cb42-1155" aria-hidden="true" tabindex="-1"></a>    <span class="at">Other_grp =</span> <span class="st">"Number (%)·µÉ"</span></span>
<span id="cb42-1156"><a href="#cb42-1156" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb42-1157"><a href="#cb42-1157" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_header_row</span>(</span>
<span id="cb42-1158"><a href="#cb42-1158" aria-hidden="true" tabindex="-1"></a>    <span class="at">values =</span> <span class="fu">c</span>(</span>
<span id="cb42-1159"><a href="#cb42-1159" aria-hidden="true" tabindex="-1"></a>      <span class="st">""</span>, <span class="st">""</span>,</span>
<span id="cb42-1160"><a href="#cb42-1160" aria-hidden="true" tabindex="-1"></a>      <span class="fu">paste0</span>(<span class="st">"Respiratory vaccines (N = "</span>, <span class="fu">format</span>(totals[<span class="st">"Respiratory vaccines"</span>], <span class="at">big.mark =</span> <span class="st">","</span>), <span class="st">")"</span>),</span>
<span id="cb42-1161"><a href="#cb42-1161" aria-hidden="true" tabindex="-1"></a>      <span class="fu">paste0</span>(<span class="st">"Childhood vaccines (N = "</span>, <span class="fu">format</span>(totals[<span class="st">"Childhood vaccines"</span>], <span class="at">big.mark =</span> <span class="st">","</span>), <span class="st">")"</span>),</span>
<span id="cb42-1162"><a href="#cb42-1162" aria-hidden="true" tabindex="-1"></a>      <span class="fu">paste0</span>(<span class="st">"Other (N = "</span>, <span class="fu">format</span>(totals[<span class="st">"Other"</span>], <span class="at">big.mark =</span> <span class="st">","</span>), <span class="st">")"</span>)</span>
<span id="cb42-1163"><a href="#cb42-1163" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb42-1164"><a href="#cb42-1164" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb42-1165"><a href="#cb42-1165" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_header_row</span>(</span>
<span id="cb42-1166"><a href="#cb42-1166" aria-hidden="true" tabindex="-1"></a>    <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"Description"</span>, <span class="st">"Vaccination uptake"</span>),</span>
<span id="cb42-1167"><a href="#cb42-1167" aria-hidden="true" tabindex="-1"></a>    <span class="at">colwidths =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">3</span>)</span>
<span id="cb42-1168"><a href="#cb42-1168" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb42-1169"><a href="#cb42-1169" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_box</span>() <span class="sc">%&gt;%</span></span>
<span id="cb42-1170"><a href="#cb42-1170" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_table_properties</span>(<span class="at">layout =</span> <span class="st">"autofit"</span>, <span class="at">width =</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb42-1171"><a href="#cb42-1171" aria-hidden="true" tabindex="-1"></a>  <span class="fu">width</span>(<span class="at">j =</span> <span class="dv">1</span>, <span class="at">width =</span> <span class="fl">1.5</span>) <span class="sc">%&gt;%</span></span>
<span id="cb42-1172"><a href="#cb42-1172" aria-hidden="true" tabindex="-1"></a>  <span class="fu">width</span>(<span class="at">j =</span> <span class="dv">2</span>, <span class="at">width =</span> <span class="fl">2.5</span>) <span class="sc">%&gt;%</span></span>
<span id="cb42-1173"><a href="#cb42-1173" aria-hidden="true" tabindex="-1"></a>  <span class="fu">width</span>(<span class="at">j =</span> <span class="dv">3</span><span class="sc">:</span><span class="dv">5</span>, <span class="at">width =</span> <span class="fl">1.5</span>) <span class="sc">%&gt;%</span></span>
<span id="cb42-1174"><a href="#cb42-1174" aria-hidden="true" tabindex="-1"></a>  <span class="fu">align</span>(<span class="at">align =</span> <span class="st">"justify"</span>, <span class="at">part =</span> <span class="st">"all"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb42-1175"><a href="#cb42-1175" aria-hidden="true" tabindex="-1"></a>  <span class="fu">border_inner_h</span>(<span class="at">border =</span> <span class="fu">fp_border</span>(<span class="at">color =</span> <span class="st">"black"</span>, <span class="at">width =</span> <span class="dv">1</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb42-1176"><a href="#cb42-1176" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_caption</span>(<span class="st">"Table: Vaccination uptake across service year, quarter, and weekday"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb42-1177"><a href="#cb42-1177" aria-hidden="true" tabindex="-1"></a>  <span class="fu">footnote</span>(<span class="at">i =</span> <span class="dv">1</span>, </span>
<span id="cb42-1178"><a href="#cb42-1178" aria-hidden="true" tabindex="-1"></a>           <span class="at">value =</span> <span class="fu">as_paragraph</span>(<span class="st">"Vaccination proportions were calculated row-wise (i.e., by row)."</span>),</span>
<span id="cb42-1179"><a href="#cb42-1179" aria-hidden="true" tabindex="-1"></a>           <span class="at">ref_symbols =</span> <span class="st">"·µÉ"</span>, </span>
<span id="cb42-1180"><a href="#cb42-1180" aria-hidden="true" tabindex="-1"></a>           <span class="at">part =</span> <span class="st">"header"</span>)</span>
<span id="cb42-1181"><a href="#cb42-1181" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-1182"><a href="#cb42-1182" aria-hidden="true" tabindex="-1"></a><span class="co"># .................. Show the table ..................</span></span>
<span id="cb42-1183"><a href="#cb42-1183" aria-hidden="true" tabindex="-1"></a>ft_vacc_summary</span>
<span id="cb42-1184"><a href="#cb42-1184" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-1185"><a href="#cb42-1185" aria-hidden="true" tabindex="-1"></a><span class="co"># .................. Clean up ..................</span></span>
<span id="cb42-1186"><a href="#cb42-1186" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(tab_age, tab_sex, tab_marital_status, tab_year, tab_quarter, tab_weekday, </span>
<span id="cb42-1187"><a href="#cb42-1187" aria-hidden="true" tabindex="-1"></a>   tab_combined, ft_vacc_summary, totals, create_tab)</span>
<span id="cb42-1188"><a href="#cb42-1188" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-1189"><a href="#cb42-1189" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb42-1190"><a href="#cb42-1190" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-1191"><a href="#cb42-1191" aria-hidden="true" tabindex="-1"></a><span class="fu">## **8. Font Formatting: Colour and Font Options**</span></span>
<span id="cb42-1192"><a href="#cb42-1192" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-1193"><a href="#cb42-1193" aria-hidden="true" tabindex="-1"></a>Here, I demonstrate how to:</span>
<span id="cb42-1194"><a href="#cb42-1194" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-1195"><a href="#cb42-1195" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Set font types (e.g., Times New Roman)</span>
<span id="cb42-1196"><a href="#cb42-1196" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-1197"><a href="#cb42-1197" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Control font size</span>
<span id="cb42-1198"><a href="#cb42-1198" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-1199"><a href="#cb42-1199" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Apply alternating row colors and header backgrounds</span>
<span id="cb42-1200"><a href="#cb42-1200" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-1201"><a href="#cb42-1201" aria-hidden="true" tabindex="-1"></a>üé® *Why this is valuable*:</span>
<span id="cb42-1202"><a href="#cb42-1202" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-1203"><a href="#cb42-1203" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Enhances visual appeal and professionalism.</span>
<span id="cb42-1204"><a href="#cb42-1204" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-1205"><a href="#cb42-1205" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Aligns with publication or organizational branding requirements.</span>
<span id="cb42-1206"><a href="#cb42-1206" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-1207"><a href="#cb42-1207" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>*Best for*: Reports to stakeholders, executive summaries, or printed materials.</span>
<span id="cb42-1208"><a href="#cb42-1208" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-1211"><a href="#cb42-1211" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb42-1212"><a href="#cb42-1212" aria-hidden="true" tabindex="-1"></a><span class="co"># ------------ 7. Font Formating: Colour and Font type options adding in the Table -------------------------------------------</span></span>
<span id="cb42-1213"><a href="#cb42-1213" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-1214"><a href="#cb42-1214" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb42-1215"><a href="#cb42-1215" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(janitor)</span>
<span id="cb42-1216"><a href="#cb42-1216" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tibble)</span>
<span id="cb42-1217"><a href="#cb42-1217" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(scales)</span>
<span id="cb42-1218"><a href="#cb42-1218" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(flextable)</span>
<span id="cb42-1219"><a href="#cb42-1219" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-1220"><a href="#cb42-1220" aria-hidden="true" tabindex="-1"></a><span class="co"># .................. Convert grouping vars to character ..................</span></span>
<span id="cb42-1221"><a href="#cb42-1221" aria-hidden="true" tabindex="-1"></a>vacc_1524 <span class="ot">&lt;-</span> vacc_1524 <span class="sc">%&gt;%</span></span>
<span id="cb42-1222"><a href="#cb42-1222" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">c</span>(age_group, gender, marital_status,</span>
<span id="cb42-1223"><a href="#cb42-1223" aria-hidden="true" tabindex="-1"></a>                  vacc_service_year, vacc_quarter, vacc_weekday), as.character))</span>
<span id="cb42-1224"><a href="#cb42-1224" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-1225"><a href="#cb42-1225" aria-hidden="true" tabindex="-1"></a><span class="co"># .................. Table generation function with Missing ..................</span></span>
<span id="cb42-1226"><a href="#cb42-1226" aria-hidden="true" tabindex="-1"></a>create_tab <span class="ot">&lt;-</span> <span class="cf">function</span>(data, var, label) {</span>
<span id="cb42-1227"><a href="#cb42-1227" aria-hidden="true" tabindex="-1"></a>  tab_main <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span></span>
<span id="cb42-1228"><a href="#cb42-1228" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>({{ var }})) <span class="sc">%&gt;%</span></span>
<span id="cb42-1229"><a href="#cb42-1229" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tabyl</span>({{ var }}, vacc_group3) <span class="sc">%&gt;%</span></span>
<span id="cb42-1230"><a href="#cb42-1230" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">Category =</span> label, <span class="at">.before =</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb42-1231"><a href="#cb42-1231" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rename</span>(<span class="at">Label =</span> {{ var }}) <span class="sc">%&gt;%</span></span>
<span id="cb42-1232"><a href="#cb42-1232" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">Label =</span> <span class="fu">as.character</span>(Label))</span>
<span id="cb42-1233"><a href="#cb42-1233" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb42-1234"><a href="#cb42-1234" aria-hidden="true" tabindex="-1"></a>  na_count <span class="ot">&lt;-</span> <span class="fu">sum</span>(<span class="fu">is.na</span>(<span class="fu">pull</span>(data, {{ var }})))</span>
<span id="cb42-1235"><a href="#cb42-1235" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb42-1236"><a href="#cb42-1236" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (na_count <span class="sc">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb42-1237"><a href="#cb42-1237" aria-hidden="true" tabindex="-1"></a>    missing_row <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb42-1238"><a href="#cb42-1238" aria-hidden="true" tabindex="-1"></a>      <span class="at">Category =</span> label,</span>
<span id="cb42-1239"><a href="#cb42-1239" aria-hidden="true" tabindex="-1"></a>      <span class="at">Label =</span> <span class="st">"Missing"</span>,</span>
<span id="cb42-1240"><a href="#cb42-1240" aria-hidden="true" tabindex="-1"></a>      <span class="st">`</span><span class="at">Respiratory vaccines</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">sum</span>(data<span class="sc">$</span>vacc_group3 <span class="sc">==</span> <span class="st">"Respiratory vaccines"</span> <span class="sc">&amp;</span> <span class="fu">is.na</span>(<span class="fu">pull</span>(data, {{ var }})), <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb42-1241"><a href="#cb42-1241" aria-hidden="true" tabindex="-1"></a>      <span class="st">`</span><span class="at">Childhood vaccines</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">sum</span>(data<span class="sc">$</span>vacc_group3 <span class="sc">==</span> <span class="st">"Childhood vaccines"</span> <span class="sc">&amp;</span> <span class="fu">is.na</span>(<span class="fu">pull</span>(data, {{ var }})), <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb42-1242"><a href="#cb42-1242" aria-hidden="true" tabindex="-1"></a>      <span class="at">Other =</span> <span class="fu">sum</span>(data<span class="sc">$</span>vacc_group3 <span class="sc">==</span> <span class="st">"Other"</span> <span class="sc">&amp;</span> <span class="fu">is.na</span>(<span class="fu">pull</span>(data, {{ var }})), <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb42-1243"><a href="#cb42-1243" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb42-1244"><a href="#cb42-1244" aria-hidden="true" tabindex="-1"></a>    tab_final <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(tab_main, missing_row)</span>
<span id="cb42-1245"><a href="#cb42-1245" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb42-1246"><a href="#cb42-1246" aria-hidden="true" tabindex="-1"></a>    tab_final <span class="ot">&lt;-</span> tab_main</span>
<span id="cb42-1247"><a href="#cb42-1247" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb42-1248"><a href="#cb42-1248" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb42-1249"><a href="#cb42-1249" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(tab_final)</span>
<span id="cb42-1250"><a href="#cb42-1250" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb42-1251"><a href="#cb42-1251" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-1252"><a href="#cb42-1252" aria-hidden="true" tabindex="-1"></a><span class="co"># .................. Create summary tables ..................</span></span>
<span id="cb42-1253"><a href="#cb42-1253" aria-hidden="true" tabindex="-1"></a>tab_age            <span class="ot">&lt;-</span> <span class="fu">create_tab</span>(vacc_1524, age_group, <span class="st">"Age"</span>)</span>
<span id="cb42-1254"><a href="#cb42-1254" aria-hidden="true" tabindex="-1"></a>tab_sex            <span class="ot">&lt;-</span> <span class="fu">create_tab</span>(vacc_1524, gender, <span class="st">"Gender"</span>)</span>
<span id="cb42-1255"><a href="#cb42-1255" aria-hidden="true" tabindex="-1"></a>tab_marital_status <span class="ot">&lt;-</span> <span class="fu">create_tab</span>(vacc_1524, marital_status, <span class="st">"Marital status"</span>)</span>
<span id="cb42-1256"><a href="#cb42-1256" aria-hidden="true" tabindex="-1"></a>tab_year           <span class="ot">&lt;-</span> <span class="fu">create_tab</span>(vacc_1524, vacc_service_year, <span class="st">"Year"</span>)</span>
<span id="cb42-1257"><a href="#cb42-1257" aria-hidden="true" tabindex="-1"></a>tab_quarter        <span class="ot">&lt;-</span> <span class="fu">create_tab</span>(vacc_1524, vacc_quarter, <span class="st">"Quarter"</span>)</span>
<span id="cb42-1258"><a href="#cb42-1258" aria-hidden="true" tabindex="-1"></a>tab_weekday        <span class="ot">&lt;-</span> <span class="fu">create_tab</span>(vacc_1524, vacc_weekday, <span class="st">"Weekday"</span>)</span>
<span id="cb42-1259"><a href="#cb42-1259" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-1260"><a href="#cb42-1260" aria-hidden="true" tabindex="-1"></a><span class="co"># .................. Combine all tables ..................</span></span>
<span id="cb42-1261"><a href="#cb42-1261" aria-hidden="true" tabindex="-1"></a>tab_combined <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(tab_sex, tab_age, tab_marital_status, tab_year, tab_quarter, tab_weekday)</span>
<span id="cb42-1262"><a href="#cb42-1262" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-1263"><a href="#cb42-1263" aria-hidden="true" tabindex="-1"></a><span class="co"># .................. Calculate row-wise percentages (skip for Missing) ..................</span></span>
<span id="cb42-1264"><a href="#cb42-1264" aria-hidden="true" tabindex="-1"></a>tab_combined <span class="ot">&lt;-</span> tab_combined <span class="sc">%&gt;%</span></span>
<span id="cb42-1265"><a href="#cb42-1265" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rowwise</span>() <span class="sc">%&gt;%</span></span>
<span id="cb42-1266"><a href="#cb42-1266" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb42-1267"><a href="#cb42-1267" aria-hidden="true" tabindex="-1"></a>    <span class="at">Total =</span> <span class="fu">sum</span>(<span class="st">`</span><span class="at">Respiratory vaccines</span><span class="st">`</span>, <span class="st">`</span><span class="at">Childhood vaccines</span><span class="st">`</span>, Other, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb42-1268"><a href="#cb42-1268" aria-hidden="true" tabindex="-1"></a>    <span class="at">is_missing =</span> <span class="fu">trimws</span>(<span class="fu">tolower</span>(Label)) <span class="sc">==</span> <span class="st">"missing"</span>,</span>
<span id="cb42-1269"><a href="#cb42-1269" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb42-1270"><a href="#cb42-1270" aria-hidden="true" tabindex="-1"></a>    <span class="at">Respiratory =</span> <span class="fu">ifelse</span>(is_missing,</span>
<span id="cb42-1271"><a href="#cb42-1271" aria-hidden="true" tabindex="-1"></a>                         <span class="fu">comma</span>(<span class="st">`</span><span class="at">Respiratory vaccines</span><span class="st">`</span>),</span>
<span id="cb42-1272"><a href="#cb42-1272" aria-hidden="true" tabindex="-1"></a>                         <span class="fu">paste0</span>(<span class="fu">comma</span>(<span class="st">`</span><span class="at">Respiratory vaccines</span><span class="st">`</span>), <span class="st">" ("</span>, <span class="fu">round</span>(<span class="dv">100</span> <span class="sc">*</span> <span class="st">`</span><span class="at">Respiratory vaccines</span><span class="st">`</span> <span class="sc">/</span> Total, <span class="dv">1</span>), <span class="st">")"</span>)),</span>
<span id="cb42-1273"><a href="#cb42-1273" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb42-1274"><a href="#cb42-1274" aria-hidden="true" tabindex="-1"></a>    <span class="at">Childhood =</span> <span class="fu">ifelse</span>(is_missing,</span>
<span id="cb42-1275"><a href="#cb42-1275" aria-hidden="true" tabindex="-1"></a>                       <span class="fu">comma</span>(<span class="st">`</span><span class="at">Childhood vaccines</span><span class="st">`</span>),</span>
<span id="cb42-1276"><a href="#cb42-1276" aria-hidden="true" tabindex="-1"></a>                       <span class="fu">paste0</span>(<span class="fu">comma</span>(<span class="st">`</span><span class="at">Childhood vaccines</span><span class="st">`</span>), <span class="st">" ("</span>, <span class="fu">round</span>(<span class="dv">100</span> <span class="sc">*</span> <span class="st">`</span><span class="at">Childhood vaccines</span><span class="st">`</span> <span class="sc">/</span> Total, <span class="dv">1</span>), <span class="st">")"</span>)),</span>
<span id="cb42-1277"><a href="#cb42-1277" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb42-1278"><a href="#cb42-1278" aria-hidden="true" tabindex="-1"></a>    <span class="at">Other_grp =</span> <span class="fu">ifelse</span>(is_missing,</span>
<span id="cb42-1279"><a href="#cb42-1279" aria-hidden="true" tabindex="-1"></a>                       <span class="fu">comma</span>(Other),</span>
<span id="cb42-1280"><a href="#cb42-1280" aria-hidden="true" tabindex="-1"></a>                       <span class="fu">paste0</span>(<span class="fu">comma</span>(Other), <span class="st">" ("</span>, <span class="fu">round</span>(<span class="dv">100</span> <span class="sc">*</span> Other <span class="sc">/</span> Total, <span class="dv">1</span>), <span class="st">")"</span>))</span>
<span id="cb42-1281"><a href="#cb42-1281" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb42-1282"><a href="#cb42-1282" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb42-1283"><a href="#cb42-1283" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Category, Label, Respiratory, Childhood, Other_grp)</span>
<span id="cb42-1284"><a href="#cb42-1284" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-1285"><a href="#cb42-1285" aria-hidden="true" tabindex="-1"></a><span class="co"># .................. Show Category only once per group ..................</span></span>
<span id="cb42-1286"><a href="#cb42-1286" aria-hidden="true" tabindex="-1"></a>tab_combined <span class="ot">&lt;-</span> tab_combined <span class="sc">%&gt;%</span></span>
<span id="cb42-1287"><a href="#cb42-1287" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Category) <span class="sc">%&gt;%</span></span>
<span id="cb42-1288"><a href="#cb42-1288" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Category =</span> <span class="fu">ifelse</span>(<span class="fu">row_number</span>() <span class="sc">==</span> <span class="dv">1</span>, Category, <span class="st">""</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb42-1289"><a href="#cb42-1289" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb42-1290"><a href="#cb42-1290" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-1291"><a href="#cb42-1291" aria-hidden="true" tabindex="-1"></a><span class="co"># .................. Get total counts per vaccine group ..................</span></span>
<span id="cb42-1292"><a href="#cb42-1292" aria-hidden="true" tabindex="-1"></a>totals <span class="ot">&lt;-</span> vacc_1524 <span class="sc">%&gt;%</span></span>
<span id="cb42-1293"><a href="#cb42-1293" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(vacc_group3) <span class="sc">%&gt;%</span></span>
<span id="cb42-1294"><a href="#cb42-1294" aria-hidden="true" tabindex="-1"></a>  <span class="fu">deframe</span>()</span>
<span id="cb42-1295"><a href="#cb42-1295" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-1296"><a href="#cb42-1296" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-1297"><a href="#cb42-1297" aria-hidden="true" tabindex="-1"></a>ft_vacc_summary <span class="ot">&lt;-</span> tab_combined <span class="sc">%&gt;%</span></span>
<span id="cb42-1298"><a href="#cb42-1298" aria-hidden="true" tabindex="-1"></a>  <span class="fu">flextable</span>() <span class="sc">%&gt;%</span></span>
<span id="cb42-1299"><a href="#cb42-1299" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_header_labels</span>(</span>
<span id="cb42-1300"><a href="#cb42-1300" aria-hidden="true" tabindex="-1"></a>    <span class="at">Category =</span> <span class="st">"Variable type"</span>,</span>
<span id="cb42-1301"><a href="#cb42-1301" aria-hidden="true" tabindex="-1"></a>    <span class="at">Label =</span> <span class="st">"Values"</span>,</span>
<span id="cb42-1302"><a href="#cb42-1302" aria-hidden="true" tabindex="-1"></a>    <span class="at">Respiratory =</span> <span class="st">"Number (%)·µÉ"</span>,</span>
<span id="cb42-1303"><a href="#cb42-1303" aria-hidden="true" tabindex="-1"></a>    <span class="at">Childhood =</span> <span class="st">"Number (%)·µÉ"</span>,</span>
<span id="cb42-1304"><a href="#cb42-1304" aria-hidden="true" tabindex="-1"></a>    <span class="at">Other_grp =</span> <span class="st">"Number (%)·µÉ"</span></span>
<span id="cb42-1305"><a href="#cb42-1305" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb42-1306"><a href="#cb42-1306" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_header_row</span>(</span>
<span id="cb42-1307"><a href="#cb42-1307" aria-hidden="true" tabindex="-1"></a>    <span class="at">values =</span> <span class="fu">c</span>(</span>
<span id="cb42-1308"><a href="#cb42-1308" aria-hidden="true" tabindex="-1"></a>      <span class="st">""</span>, <span class="st">""</span>,</span>
<span id="cb42-1309"><a href="#cb42-1309" aria-hidden="true" tabindex="-1"></a>      <span class="fu">paste0</span>(<span class="st">"Respiratory vaccines (N = "</span>, <span class="fu">format</span>(totals[<span class="st">"Respiratory vaccines"</span>], <span class="at">big.mark =</span> <span class="st">","</span>), <span class="st">")"</span>),</span>
<span id="cb42-1310"><a href="#cb42-1310" aria-hidden="true" tabindex="-1"></a>      <span class="fu">paste0</span>(<span class="st">"Childhood vaccines (N = "</span>, <span class="fu">format</span>(totals[<span class="st">"Childhood vaccines"</span>], <span class="at">big.mark =</span> <span class="st">","</span>), <span class="st">")"</span>),</span>
<span id="cb42-1311"><a href="#cb42-1311" aria-hidden="true" tabindex="-1"></a>      <span class="fu">paste0</span>(<span class="st">"Other (N = "</span>, <span class="fu">format</span>(totals[<span class="st">"Other"</span>], <span class="at">big.mark =</span> <span class="st">","</span>), <span class="st">")"</span>)</span>
<span id="cb42-1312"><a href="#cb42-1312" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb42-1313"><a href="#cb42-1313" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb42-1314"><a href="#cb42-1314" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_header_row</span>(</span>
<span id="cb42-1315"><a href="#cb42-1315" aria-hidden="true" tabindex="-1"></a>    <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"Description"</span>, <span class="st">"Vaccination uptake"</span>),</span>
<span id="cb42-1316"><a href="#cb42-1316" aria-hidden="true" tabindex="-1"></a>    <span class="at">colwidths =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">3</span>)</span>
<span id="cb42-1317"><a href="#cb42-1317" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb42-1318"><a href="#cb42-1318" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_box</span>() <span class="sc">%&gt;%</span></span>
<span id="cb42-1319"><a href="#cb42-1319" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_table_properties</span>(<span class="at">layout =</span> <span class="st">"autofit"</span>, <span class="at">width =</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb42-1320"><a href="#cb42-1320" aria-hidden="true" tabindex="-1"></a>  <span class="fu">width</span>(<span class="at">j =</span> <span class="dv">1</span>, <span class="at">width =</span> <span class="fl">1.5</span>) <span class="sc">%&gt;%</span></span>
<span id="cb42-1321"><a href="#cb42-1321" aria-hidden="true" tabindex="-1"></a>  <span class="fu">width</span>(<span class="at">j =</span> <span class="dv">2</span>, <span class="at">width =</span> <span class="fl">2.5</span>) <span class="sc">%&gt;%</span></span>
<span id="cb42-1322"><a href="#cb42-1322" aria-hidden="true" tabindex="-1"></a>  <span class="fu">width</span>(<span class="at">j =</span> <span class="dv">3</span><span class="sc">:</span><span class="dv">5</span>, <span class="at">width =</span> <span class="fl">1.5</span>) <span class="sc">%&gt;%</span></span>
<span id="cb42-1323"><a href="#cb42-1323" aria-hidden="true" tabindex="-1"></a>  <span class="fu">align</span>(<span class="at">align =</span> <span class="st">"justify"</span>, <span class="at">part =</span> <span class="st">"all"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb42-1324"><a href="#cb42-1324" aria-hidden="true" tabindex="-1"></a>  <span class="fu">border_remove</span>() <span class="sc">%&gt;%</span></span>
<span id="cb42-1325"><a href="#cb42-1325" aria-hidden="true" tabindex="-1"></a>  <span class="fu">border</span>(<span class="at">part =</span> <span class="st">"header"</span>, <span class="at">i =</span> <span class="dv">1</span>, <span class="at">border.top =</span> <span class="fu">fp_border</span>(<span class="at">color =</span> <span class="st">"black"</span>, <span class="at">width =</span> <span class="dv">1</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb42-1326"><a href="#cb42-1326" aria-hidden="true" tabindex="-1"></a>  <span class="fu">border</span>(<span class="at">part =</span> <span class="st">"header"</span>, <span class="at">i =</span> <span class="dv">3</span>, <span class="at">border.bottom =</span> <span class="fu">fp_border</span>(<span class="at">color =</span> <span class="st">"black"</span>, <span class="at">width =</span> <span class="dv">1</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb42-1327"><a href="#cb42-1327" aria-hidden="true" tabindex="-1"></a>  <span class="fu">border_inner_h</span>(<span class="at">part =</span> <span class="st">"header"</span>, <span class="at">border =</span> <span class="fu">fp_border</span>(<span class="at">color =</span> <span class="st">"black"</span>, <span class="at">width =</span> <span class="fl">0.8</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb42-1328"><a href="#cb42-1328" aria-hidden="true" tabindex="-1"></a>  <span class="fu">border_inner_h</span>(<span class="at">part =</span> <span class="st">"body"</span>, <span class="at">border =</span> <span class="fu">fp_border</span>(<span class="at">color =</span> <span class="st">"black"</span>, <span class="at">width =</span> <span class="fl">0.8</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb42-1329"><a href="#cb42-1329" aria-hidden="true" tabindex="-1"></a>  <span class="fu">border</span>(<span class="at">part =</span> <span class="st">"body"</span>, <span class="at">i =</span> <span class="fu">nrow</span>(tab_combined), <span class="at">border.bottom =</span> <span class="fu">fp_border</span>(<span class="at">color =</span> <span class="st">"black"</span>, <span class="at">width =</span> <span class="dv">1</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb42-1330"><a href="#cb42-1330" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb42-1331"><a href="#cb42-1331" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_caption</span>(<span class="fu">as_paragraph</span>(<span class="fu">as_chunk</span>(<span class="st">"Table: Vaccination uptake across service year, quarter, and weekday"</span>,</span>
<span id="cb42-1332"><a href="#cb42-1332" aria-hidden="true" tabindex="-1"></a>                                    <span class="at">props =</span> <span class="fu">fp_text</span>(<span class="at">font.size =</span> <span class="dv">14</span>, <span class="at">font.family =</span> <span class="st">"Times New Roman"</span>, <span class="at">bold =</span> <span class="cn">FALSE</span>)))) <span class="sc">%&gt;%</span></span>
<span id="cb42-1333"><a href="#cb42-1333" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fontsize</span>(<span class="at">part =</span> <span class="st">"header"</span>, <span class="at">size =</span> <span class="dv">12</span>) <span class="sc">%&gt;%</span></span>
<span id="cb42-1334"><a href="#cb42-1334" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fontsize</span>(<span class="at">part =</span> <span class="st">"body"</span>, <span class="at">size =</span> <span class="dv">11</span>) <span class="sc">%&gt;%</span></span>
<span id="cb42-1335"><a href="#cb42-1335" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fontsize</span>(<span class="at">part =</span> <span class="st">"footer"</span>, <span class="at">size =</span> <span class="dv">10</span>) <span class="sc">%&gt;%</span></span>
<span id="cb42-1336"><a href="#cb42-1336" aria-hidden="true" tabindex="-1"></a>  <span class="fu">font</span>(<span class="at">part =</span> <span class="st">"all"</span>, <span class="at">fontname =</span> <span class="st">"Times New Roman"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb42-1337"><a href="#cb42-1337" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bg</span>(<span class="at">part =</span> <span class="st">"header"</span>, <span class="at">bg =</span> <span class="st">"lightblue"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb42-1338"><a href="#cb42-1338" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bg</span>(<span class="at">j =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>, <span class="at">i =</span> <span class="fu">seq</span>(<span class="dv">1</span>, <span class="fu">nrow</span>(tab_combined), <span class="dv">2</span>), <span class="at">bg =</span> <span class="st">"lightgray"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb42-1339"><a href="#cb42-1339" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bg</span>(<span class="at">j =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>, <span class="at">i =</span> <span class="fu">seq</span>(<span class="dv">2</span>, <span class="fu">nrow</span>(tab_combined), <span class="dv">2</span>), <span class="at">bg =</span> <span class="st">"red"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb42-1340"><a href="#cb42-1340" aria-hidden="true" tabindex="-1"></a>  <span class="fu">footnote</span>(<span class="at">i =</span> <span class="dv">1</span>, </span>
<span id="cb42-1341"><a href="#cb42-1341" aria-hidden="true" tabindex="-1"></a>           <span class="at">value =</span> <span class="fu">as_paragraph</span>(<span class="st">"Vaccination proportions were calculated row-wise (i.e., by row)."</span>),</span>
<span id="cb42-1342"><a href="#cb42-1342" aria-hidden="true" tabindex="-1"></a>           <span class="at">ref_symbols =</span> <span class="st">"·µÉ"</span>, </span>
<span id="cb42-1343"><a href="#cb42-1343" aria-hidden="true" tabindex="-1"></a>           <span class="at">part =</span> <span class="st">"header"</span>)</span>
<span id="cb42-1344"><a href="#cb42-1344" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-1345"><a href="#cb42-1345" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-1346"><a href="#cb42-1346" aria-hidden="true" tabindex="-1"></a><span class="co"># .................. Show the table ..................</span></span>
<span id="cb42-1347"><a href="#cb42-1347" aria-hidden="true" tabindex="-1"></a>ft_vacc_summary</span>
<span id="cb42-1348"><a href="#cb42-1348" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-1349"><a href="#cb42-1349" aria-hidden="true" tabindex="-1"></a><span class="co"># .................. Clean up all new objects ..................</span></span>
<span id="cb42-1350"><a href="#cb42-1350" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(tab_age, tab_sex, tab_marital_status, tab_year, tab_quarter, tab_weekday, </span>
<span id="cb42-1351"><a href="#cb42-1351" aria-hidden="true" tabindex="-1"></a>   tab_combined, ft_vacc_summary, totals, create_tab)</span>
<span id="cb42-1352"><a href="#cb42-1352" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-1353"><a href="#cb42-1353" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb42-1354"><a href="#cb42-1354" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-1355"><a href="#cb42-1355" aria-hidden="true" tabindex="-1"></a><span class="fu">## **9. Rowwise Tables (Summary)**</span></span>
<span id="cb42-1356"><a href="#cb42-1356" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-1357"><a href="#cb42-1357" aria-hidden="true" tabindex="-1"></a>This is not a new table‚Äîrather, it's a **conceptual summary** of the row-wise percentage approaches applied in earlier sections.</span>
<span id="cb42-1358"><a href="#cb42-1358" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-1359"><a href="#cb42-1359" aria-hidden="true" tabindex="-1"></a>**Importance**:</span>
<span id="cb42-1360"><a href="#cb42-1360" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-1361"><a href="#cb42-1361" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Percentages sum to 100% per row, highlighting within-group distributions.</span>
<span id="cb42-1362"><a href="#cb42-1362" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-1363"><a href="#cb42-1363" aria-hidden="true" tabindex="-1"></a>**Implications**:</span>
<span id="cb42-1364"><a href="#cb42-1364" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-1365"><a href="#cb42-1365" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Answers: "Within age group X, what % received each vaccine?"</span>
<span id="cb42-1366"><a href="#cb42-1366" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-1367"><a href="#cb42-1367" aria-hidden="true" tabindex="-1"></a><span class="fu">## **10. Columnwise Tables**</span></span>
<span id="cb42-1368"><a href="#cb42-1368" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-1369"><a href="#cb42-1369" aria-hidden="true" tabindex="-1"></a>This version calculates **percentages down each vaccine group column**, rather than across each row.</span>
<span id="cb42-1370"><a href="#cb42-1370" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-1371"><a href="#cb42-1371" aria-hidden="true" tabindex="-1"></a>**Importance**:</span>
<span id="cb42-1372"><a href="#cb42-1372" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-1373"><a href="#cb42-1373" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Percentages sum to 100% per column, showing group contributions to totals.</span>
<span id="cb42-1374"><a href="#cb42-1374" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-1375"><a href="#cb42-1375" aria-hidden="true" tabindex="-1"></a>**Implications**:</span>
<span id="cb42-1376"><a href="#cb42-1376" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-1377"><a href="#cb42-1377" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Answers: "Among Respiratory vaccines, what % are from age group X?"</span>
<span id="cb42-1378"><a href="#cb42-1378" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>*Use this when*: You want to know, for example, what percentage of all Respiratory vaccine users were aged below 25 years.</span>
<span id="cb42-1379"><a href="#cb42-1379" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-1382"><a href="#cb42-1382" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb42-1383"><a href="#cb42-1383" aria-hidden="true" tabindex="-1"></a><span class="co"># ------------ 10. Columnwise Tables -------------------------------------------</span></span>
<span id="cb42-1384"><a href="#cb42-1384" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-1385"><a href="#cb42-1385" aria-hidden="true" tabindex="-1"></a><span class="co"># Prepare Vaccination Uptake Table (All Variables Using Column Percentages)</span></span>
<span id="cb42-1386"><a href="#cb42-1386" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-1387"><a href="#cb42-1387" aria-hidden="true" tabindex="-1"></a><span class="co"># --- Convert selected variables to character type for proper label handling ---</span></span>
<span id="cb42-1388"><a href="#cb42-1388" aria-hidden="true" tabindex="-1"></a>vacc_1524 <span class="ot">&lt;-</span> vacc_1524 <span class="sc">%&gt;%</span></span>
<span id="cb42-1389"><a href="#cb42-1389" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">c</span>(gender, age_3group, marital_2group, year_3group, vacc_quarter, race_grouped), as.character))</span>
<span id="cb42-1390"><a href="#cb42-1390" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-1391"><a href="#cb42-1391" aria-hidden="true" tabindex="-1"></a><span class="co"># --- Create general table-building function with optional column percentage flag ---</span></span>
<span id="cb42-1392"><a href="#cb42-1392" aria-hidden="true" tabindex="-1"></a><span class="co"># This function creates a summary count table of vaccination type by a categorical variable.</span></span>
<span id="cb42-1393"><a href="#cb42-1393" aria-hidden="true" tabindex="-1"></a><span class="co"># If use_col_percentage is TRUE, the summary will support column-based percentage formatting.</span></span>
<span id="cb42-1394"><a href="#cb42-1394" aria-hidden="true" tabindex="-1"></a>create_tab <span class="ot">&lt;-</span> <span class="cf">function</span>(data, var, label, <span class="at">use_col_percentage =</span> <span class="cn">TRUE</span>) {</span>
<span id="cb42-1395"><a href="#cb42-1395" aria-hidden="true" tabindex="-1"></a>  tab_main <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span></span>
<span id="cb42-1396"><a href="#cb42-1396" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>({{ var }})) <span class="sc">%&gt;%</span></span>
<span id="cb42-1397"><a href="#cb42-1397" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tabyl</span>({{ var }}, vacc_group3) <span class="sc">%&gt;%</span></span>
<span id="cb42-1398"><a href="#cb42-1398" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">Category =</span> label, <span class="at">.before =</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb42-1399"><a href="#cb42-1399" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rename</span>(<span class="at">Label =</span> {{ var }}) <span class="sc">%&gt;%</span></span>
<span id="cb42-1400"><a href="#cb42-1400" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">Label =</span> <span class="fu">as.character</span>(Label))</span>
<span id="cb42-1401"><a href="#cb42-1401" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb42-1402"><a href="#cb42-1402" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Add a row for "Unknown" if missing values are found</span></span>
<span id="cb42-1403"><a href="#cb42-1403" aria-hidden="true" tabindex="-1"></a>  na_count <span class="ot">&lt;-</span> <span class="fu">sum</span>(<span class="fu">is.na</span>(<span class="fu">pull</span>(data, {{ var }})))</span>
<span id="cb42-1404"><a href="#cb42-1404" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (na_count <span class="sc">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb42-1405"><a href="#cb42-1405" aria-hidden="true" tabindex="-1"></a>    na_row <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb42-1406"><a href="#cb42-1406" aria-hidden="true" tabindex="-1"></a>      <span class="at">Category =</span> label,</span>
<span id="cb42-1407"><a href="#cb42-1407" aria-hidden="true" tabindex="-1"></a>      <span class="at">Label =</span> <span class="st">"Unknown"</span>,</span>
<span id="cb42-1408"><a href="#cb42-1408" aria-hidden="true" tabindex="-1"></a>      <span class="st">`</span><span class="at">Respiratory vaccines</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">sum</span>(data<span class="sc">$</span>vacc_group3 <span class="sc">==</span> <span class="st">"Respiratory vaccines"</span> <span class="sc">&amp;</span> <span class="fu">is.na</span>(<span class="fu">pull</span>(data, {{ var }})), <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb42-1409"><a href="#cb42-1409" aria-hidden="true" tabindex="-1"></a>      <span class="st">`</span><span class="at">Childhood vaccines</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">sum</span>(data<span class="sc">$</span>vacc_group3 <span class="sc">==</span> <span class="st">"Childhood vaccines"</span> <span class="sc">&amp;</span> <span class="fu">is.na</span>(<span class="fu">pull</span>(data, {{ var }})), <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb42-1410"><a href="#cb42-1410" aria-hidden="true" tabindex="-1"></a>      <span class="at">Other =</span> <span class="fu">sum</span>(data<span class="sc">$</span>vacc_group3 <span class="sc">==</span> <span class="st">"Other"</span> <span class="sc">&amp;</span> <span class="fu">is.na</span>(<span class="fu">pull</span>(data, {{ var }})), <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb42-1411"><a href="#cb42-1411" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb42-1412"><a href="#cb42-1412" aria-hidden="true" tabindex="-1"></a>    tab_combined <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(tab_main, na_row)</span>
<span id="cb42-1413"><a href="#cb42-1413" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb42-1414"><a href="#cb42-1414" aria-hidden="true" tabindex="-1"></a>    tab_combined <span class="ot">&lt;-</span> tab_main</span>
<span id="cb42-1415"><a href="#cb42-1415" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb42-1416"><a href="#cb42-1416" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb42-1417"><a href="#cb42-1417" aria-hidden="true" tabindex="-1"></a>  tab_combined <span class="sc">%&gt;%</span></span>
<span id="cb42-1418"><a href="#cb42-1418" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">use_col_percentage =</span> use_col_percentage)</span>
<span id="cb42-1419"><a href="#cb42-1419" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb42-1420"><a href="#cb42-1420" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-1421"><a href="#cb42-1421" aria-hidden="true" tabindex="-1"></a><span class="co"># --- Generate summary tables for each variable using column percentages ---</span></span>
<span id="cb42-1422"><a href="#cb42-1422" aria-hidden="true" tabindex="-1"></a>tab_gender    <span class="ot">&lt;-</span> <span class="fu">create_tab</span>(vacc_1524, gender, <span class="st">"Gender"</span>)</span>
<span id="cb42-1423"><a href="#cb42-1423" aria-hidden="true" tabindex="-1"></a>tab_age       <span class="ot">&lt;-</span> <span class="fu">create_tab</span>(vacc_1524, age_3group, <span class="st">"Age group"</span>)</span>
<span id="cb42-1424"><a href="#cb42-1424" aria-hidden="true" tabindex="-1"></a>tab_marital   <span class="ot">&lt;-</span> <span class="fu">create_tab</span>(vacc_1524, marital_2group, <span class="st">"Marital status·µá"</span>)</span>
<span id="cb42-1425"><a href="#cb42-1425" aria-hidden="true" tabindex="-1"></a>tab_year      <span class="ot">&lt;-</span> <span class="fu">create_tab</span>(vacc_1524, year_3group, <span class="st">"Year group"</span>)</span>
<span id="cb42-1426"><a href="#cb42-1426" aria-hidden="true" tabindex="-1"></a>tab_quarter   <span class="ot">&lt;-</span> <span class="fu">create_tab</span>(vacc_1524, vacc_quarter, <span class="st">"Quarter"</span>)</span>
<span id="cb42-1427"><a href="#cb42-1427" aria-hidden="true" tabindex="-1"></a>tab_race      <span class="ot">&lt;-</span> <span class="fu">create_tab</span>(vacc_1524, race_grouped, <span class="st">"Race group"</span>)</span>
<span id="cb42-1428"><a href="#cb42-1428" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-1429"><a href="#cb42-1429" aria-hidden="true" tabindex="-1"></a><span class="co"># --- Combine all variable-level tables into one ---</span></span>
<span id="cb42-1430"><a href="#cb42-1430" aria-hidden="true" tabindex="-1"></a>tab_combined <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(</span>
<span id="cb42-1431"><a href="#cb42-1431" aria-hidden="true" tabindex="-1"></a>  tab_gender, tab_age, tab_marital,</span>
<span id="cb42-1432"><a href="#cb42-1432" aria-hidden="true" tabindex="-1"></a>  tab_year, tab_quarter, tab_race</span>
<span id="cb42-1433"><a href="#cb42-1433" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb42-1434"><a href="#cb42-1434" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-1435"><a href="#cb42-1435" aria-hidden="true" tabindex="-1"></a><span class="co"># --- Calculate percentages and format values into strings with "Number (%)" ---</span></span>
<span id="cb42-1436"><a href="#cb42-1436" aria-hidden="true" tabindex="-1"></a>tab_combined <span class="ot">&lt;-</span> tab_combined <span class="sc">%&gt;%</span></span>
<span id="cb42-1437"><a href="#cb42-1437" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Category) <span class="sc">%&gt;%</span></span>
<span id="cb42-1438"><a href="#cb42-1438" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb42-1439"><a href="#cb42-1439" aria-hidden="true" tabindex="-1"></a>    <span class="at">use_col =</span> <span class="cn">TRUE</span>,  <span class="co"># column percentages applied uniformly</span></span>
<span id="cb42-1440"><a href="#cb42-1440" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb42-1441"><a href="#cb42-1441" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Calculate denominators excluding "Unknown"</span></span>
<span id="cb42-1442"><a href="#cb42-1442" aria-hidden="true" tabindex="-1"></a>    <span class="at">Total_Resp =</span> <span class="fu">sum</span>(<span class="st">`</span><span class="at">Respiratory vaccines</span><span class="st">`</span>[Label <span class="sc">!=</span> <span class="st">"Unknown"</span>], <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb42-1443"><a href="#cb42-1443" aria-hidden="true" tabindex="-1"></a>    <span class="at">Total_Child =</span> <span class="fu">sum</span>(<span class="st">`</span><span class="at">Childhood vaccines</span><span class="st">`</span>[Label <span class="sc">!=</span> <span class="st">"Unknown"</span>], <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb42-1444"><a href="#cb42-1444" aria-hidden="true" tabindex="-1"></a>    <span class="at">Total_Other =</span> <span class="fu">sum</span>(Other[Label <span class="sc">!=</span> <span class="st">"Unknown"</span>], <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb42-1445"><a href="#cb42-1445" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb42-1446"><a href="#cb42-1446" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Calculate percentages</span></span>
<span id="cb42-1447"><a href="#cb42-1447" aria-hidden="true" tabindex="-1"></a>    <span class="at">Resp_prop =</span> <span class="fu">ifelse</span>(Label <span class="sc">!=</span> <span class="st">"Unknown"</span>, <span class="fu">round</span>(<span class="dv">100</span> <span class="sc">*</span> <span class="st">`</span><span class="at">Respiratory vaccines</span><span class="st">`</span> <span class="sc">/</span> Total_Resp, <span class="dv">1</span>), <span class="cn">NA</span>),</span>
<span id="cb42-1448"><a href="#cb42-1448" aria-hidden="true" tabindex="-1"></a>    <span class="at">Child_prop =</span> <span class="fu">ifelse</span>(Label <span class="sc">!=</span> <span class="st">"Unknown"</span>, <span class="fu">round</span>(<span class="dv">100</span> <span class="sc">*</span> <span class="st">`</span><span class="at">Childhood vaccines</span><span class="st">`</span> <span class="sc">/</span> Total_Child, <span class="dv">1</span>), <span class="cn">NA</span>),</span>
<span id="cb42-1449"><a href="#cb42-1449" aria-hidden="true" tabindex="-1"></a>    <span class="at">Other_prop =</span> <span class="fu">ifelse</span>(Label <span class="sc">!=</span> <span class="st">"Unknown"</span>, <span class="fu">round</span>(<span class="dv">100</span> <span class="sc">*</span> Other <span class="sc">/</span> Total_Other, <span class="dv">1</span>), <span class="cn">NA</span>),</span>
<span id="cb42-1450"><a href="#cb42-1450" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb42-1451"><a href="#cb42-1451" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Format final output as "number (percentage)"</span></span>
<span id="cb42-1452"><a href="#cb42-1452" aria-hidden="true" tabindex="-1"></a>    <span class="at">Respiratory =</span> <span class="fu">ifelse</span>(<span class="fu">is.na</span>(Resp_prop),</span>
<span id="cb42-1453"><a href="#cb42-1453" aria-hidden="true" tabindex="-1"></a>                         <span class="fu">paste0</span>(<span class="fu">comma</span>(<span class="st">`</span><span class="at">Respiratory vaccines</span><span class="st">`</span>)),</span>
<span id="cb42-1454"><a href="#cb42-1454" aria-hidden="true" tabindex="-1"></a>                         <span class="fu">paste0</span>(<span class="fu">comma</span>(<span class="st">`</span><span class="at">Respiratory vaccines</span><span class="st">`</span>), <span class="st">" ("</span>, Resp_prop, <span class="st">")"</span>)),</span>
<span id="cb42-1455"><a href="#cb42-1455" aria-hidden="true" tabindex="-1"></a>    <span class="at">Childhood =</span> <span class="fu">ifelse</span>(<span class="fu">is.na</span>(Child_prop),</span>
<span id="cb42-1456"><a href="#cb42-1456" aria-hidden="true" tabindex="-1"></a>                       <span class="fu">paste0</span>(<span class="fu">comma</span>(<span class="st">`</span><span class="at">Childhood vaccines</span><span class="st">`</span>)),</span>
<span id="cb42-1457"><a href="#cb42-1457" aria-hidden="true" tabindex="-1"></a>                       <span class="fu">paste0</span>(<span class="fu">comma</span>(<span class="st">`</span><span class="at">Childhood vaccines</span><span class="st">`</span>), <span class="st">" ("</span>, Child_prop, <span class="st">")"</span>)),</span>
<span id="cb42-1458"><a href="#cb42-1458" aria-hidden="true" tabindex="-1"></a>    <span class="at">Other_grp =</span> <span class="fu">ifelse</span>(<span class="fu">is.na</span>(Other_prop),</span>
<span id="cb42-1459"><a href="#cb42-1459" aria-hidden="true" tabindex="-1"></a>                       <span class="fu">paste0</span>(<span class="fu">comma</span>(Other)),</span>
<span id="cb42-1460"><a href="#cb42-1460" aria-hidden="true" tabindex="-1"></a>                       <span class="fu">paste0</span>(<span class="fu">comma</span>(Other), <span class="st">" ("</span>, Other_prop, <span class="st">")"</span>))</span>
<span id="cb42-1461"><a href="#cb42-1461" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb42-1462"><a href="#cb42-1462" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb42-1463"><a href="#cb42-1463" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-1464"><a href="#cb42-1464" aria-hidden="true" tabindex="-1"></a><span class="co"># --- Final clean-up: labels, superscripts, and hiding "0 (0)" from Unknown row ---</span></span>
<span id="cb42-1465"><a href="#cb42-1465" aria-hidden="true" tabindex="-1"></a>tab_combined <span class="ot">&lt;-</span> tab_combined <span class="sc">%&gt;%</span></span>
<span id="cb42-1466"><a href="#cb42-1466" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb42-1467"><a href="#cb42-1467" aria-hidden="true" tabindex="-1"></a>    <span class="at">Label =</span> <span class="fu">ifelse</span>(Label <span class="sc">==</span> <span class="st">"Other"</span>, <span class="st">"Other·∂ú"</span>, Label),</span>
<span id="cb42-1468"><a href="#cb42-1468" aria-hidden="true" tabindex="-1"></a>    <span class="at">Respiratory =</span> <span class="fu">ifelse</span>(Label <span class="sc">==</span> <span class="st">"Unknown"</span> <span class="sc">&amp;</span> <span class="st">`</span><span class="at">Respiratory vaccines</span><span class="st">`</span> <span class="sc">==</span> <span class="dv">0</span>, <span class="st">""</span>, Respiratory),</span>
<span id="cb42-1469"><a href="#cb42-1469" aria-hidden="true" tabindex="-1"></a>    <span class="at">Childhood   =</span> <span class="fu">ifelse</span>(Label <span class="sc">==</span> <span class="st">"Unknown"</span> <span class="sc">&amp;</span> <span class="st">`</span><span class="at">Childhood vaccines</span><span class="st">`</span> <span class="sc">==</span> <span class="dv">0</span>, <span class="st">""</span>, Childhood),</span>
<span id="cb42-1470"><a href="#cb42-1470" aria-hidden="true" tabindex="-1"></a>    <span class="at">Other_grp   =</span> <span class="fu">ifelse</span>(Label <span class="sc">==</span> <span class="st">"Unknown"</span> <span class="sc">&amp;</span> Other <span class="sc">==</span> <span class="dv">0</span>, <span class="st">""</span>, Other_grp)</span>
<span id="cb42-1471"><a href="#cb42-1471" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb42-1472"><a href="#cb42-1472" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Category) <span class="sc">%&gt;%</span></span>
<span id="cb42-1473"><a href="#cb42-1473" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Category =</span> <span class="fu">ifelse</span>(<span class="fu">row_number</span>() <span class="sc">==</span> <span class="dv">1</span>, Category, <span class="st">""</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb42-1474"><a href="#cb42-1474" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb42-1475"><a href="#cb42-1475" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Category, Label, Respiratory, Childhood, Other_grp)</span>
<span id="cb42-1476"><a href="#cb42-1476" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-1477"><a href="#cb42-1477" aria-hidden="true" tabindex="-1"></a><span class="co"># --- Get total N for each vaccine group to display in header ---</span></span>
<span id="cb42-1478"><a href="#cb42-1478" aria-hidden="true" tabindex="-1"></a>totals <span class="ot">&lt;-</span> <span class="fu">table</span>(vacc_1524<span class="sc">$</span>vacc_group3)</span>
<span id="cb42-1479"><a href="#cb42-1479" aria-hidden="true" tabindex="-1"></a>total_resp <span class="ot">&lt;-</span> totals[<span class="st">"Respiratory vaccines"</span>]</span>
<span id="cb42-1480"><a href="#cb42-1480" aria-hidden="true" tabindex="-1"></a>total_child <span class="ot">&lt;-</span> totals[<span class="st">"Childhood vaccines"</span>]</span>
<span id="cb42-1481"><a href="#cb42-1481" aria-hidden="true" tabindex="-1"></a>total_other <span class="ot">&lt;-</span> totals[<span class="st">"Other"</span>]</span>
<span id="cb42-1482"><a href="#cb42-1482" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-1483"><a href="#cb42-1483" aria-hidden="true" tabindex="-1"></a><span class="co"># --- Build flextable for formatted presentation ---</span></span>
<span id="cb42-1484"><a href="#cb42-1484" aria-hidden="true" tabindex="-1"></a>table_vacc_summary <span class="ot">&lt;-</span> <span class="fu">flextable</span>(tab_combined) <span class="sc">%&gt;%</span></span>
<span id="cb42-1485"><a href="#cb42-1485" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_header_labels</span>(</span>
<span id="cb42-1486"><a href="#cb42-1486" aria-hidden="true" tabindex="-1"></a>    <span class="at">Category =</span> <span class="st">"Variable type"</span>,</span>
<span id="cb42-1487"><a href="#cb42-1487" aria-hidden="true" tabindex="-1"></a>    <span class="at">Label =</span> <span class="st">"Values"</span>,</span>
<span id="cb42-1488"><a href="#cb42-1488" aria-hidden="true" tabindex="-1"></a>    <span class="at">Respiratory =</span> <span class="st">"Number (%)·µÉ"</span>,</span>
<span id="cb42-1489"><a href="#cb42-1489" aria-hidden="true" tabindex="-1"></a>    <span class="at">Childhood =</span> <span class="st">"Number (%)·µÉ"</span>,</span>
<span id="cb42-1490"><a href="#cb42-1490" aria-hidden="true" tabindex="-1"></a>    <span class="at">Other_grp =</span> <span class="st">"Number (%)·µÉ"</span></span>
<span id="cb42-1491"><a href="#cb42-1491" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb42-1492"><a href="#cb42-1492" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_header_row</span>(</span>
<span id="cb42-1493"><a href="#cb42-1493" aria-hidden="true" tabindex="-1"></a>    <span class="at">values =</span> <span class="fu">c</span>(<span class="st">""</span>, <span class="st">""</span>,</span>
<span id="cb42-1494"><a href="#cb42-1494" aria-hidden="true" tabindex="-1"></a>               <span class="fu">paste0</span>(<span class="st">"Respiratory vaccines (N = "</span>, <span class="fu">format</span>(total_resp, <span class="at">big.mark =</span> <span class="st">","</span>), <span class="st">")"</span>),</span>
<span id="cb42-1495"><a href="#cb42-1495" aria-hidden="true" tabindex="-1"></a>               <span class="fu">paste0</span>(<span class="st">"Childhood vaccines (N = "</span>, <span class="fu">format</span>(total_child, <span class="at">big.mark =</span> <span class="st">","</span>), <span class="st">")"</span>),</span>
<span id="cb42-1496"><a href="#cb42-1496" aria-hidden="true" tabindex="-1"></a>               <span class="fu">paste0</span>(<span class="st">"Other (N = "</span>, <span class="fu">format</span>(total_other, <span class="at">big.mark =</span> <span class="st">","</span>), <span class="st">")"</span>)),</span>
<span id="cb42-1497"><a href="#cb42-1497" aria-hidden="true" tabindex="-1"></a>    <span class="at">colwidths =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>),</span>
<span id="cb42-1498"><a href="#cb42-1498" aria-hidden="true" tabindex="-1"></a>    <span class="at">top =</span> <span class="cn">TRUE</span></span>
<span id="cb42-1499"><a href="#cb42-1499" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb42-1500"><a href="#cb42-1500" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_header_row</span>(</span>
<span id="cb42-1501"><a href="#cb42-1501" aria-hidden="true" tabindex="-1"></a>    <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"Description"</span>, <span class="st">"Vaccination uptake"</span>),</span>
<span id="cb42-1502"><a href="#cb42-1502" aria-hidden="true" tabindex="-1"></a>    <span class="at">colwidths =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">3</span>),</span>
<span id="cb42-1503"><a href="#cb42-1503" aria-hidden="true" tabindex="-1"></a>    <span class="at">top =</span> <span class="cn">TRUE</span></span>
<span id="cb42-1504"><a href="#cb42-1504" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb42-1505"><a href="#cb42-1505" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_box</span>() <span class="sc">%&gt;%</span></span>
<span id="cb42-1506"><a href="#cb42-1506" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_table_properties</span>(<span class="at">layout =</span> <span class="st">"autofit"</span>, <span class="at">width =</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb42-1507"><a href="#cb42-1507" aria-hidden="true" tabindex="-1"></a>  <span class="fu">width</span>(<span class="at">j =</span> <span class="dv">1</span>, <span class="at">width =</span> <span class="fl">1.5</span>) <span class="sc">%&gt;%</span></span>
<span id="cb42-1508"><a href="#cb42-1508" aria-hidden="true" tabindex="-1"></a>  <span class="fu">width</span>(<span class="at">j =</span> <span class="dv">2</span>, <span class="at">width =</span> <span class="fl">2.5</span>) <span class="sc">%&gt;%</span></span>
<span id="cb42-1509"><a href="#cb42-1509" aria-hidden="true" tabindex="-1"></a>  <span class="fu">width</span>(<span class="at">j =</span> <span class="dv">3</span><span class="sc">:</span><span class="dv">5</span>, <span class="at">width =</span> <span class="fl">1.5</span>) <span class="sc">%&gt;%</span></span>
<span id="cb42-1510"><a href="#cb42-1510" aria-hidden="true" tabindex="-1"></a>  <span class="fu">align</span>(<span class="at">align =</span> <span class="st">"justify"</span>, <span class="at">part =</span> <span class="st">"all"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb42-1511"><a href="#cb42-1511" aria-hidden="true" tabindex="-1"></a>  <span class="fu">border_remove</span>() <span class="sc">%&gt;%</span></span>
<span id="cb42-1512"><a href="#cb42-1512" aria-hidden="true" tabindex="-1"></a>  <span class="fu">border</span>(<span class="at">part =</span> <span class="st">"header"</span>, <span class="at">i =</span> <span class="dv">1</span>, <span class="at">border.top =</span> <span class="fu">fp_border</span>(<span class="at">color =</span> <span class="st">"black"</span>, <span class="at">width =</span> <span class="dv">1</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb42-1513"><a href="#cb42-1513" aria-hidden="true" tabindex="-1"></a>  <span class="fu">border</span>(<span class="at">part =</span> <span class="st">"header"</span>, <span class="at">i =</span> <span class="dv">3</span>, <span class="at">border.bottom =</span> <span class="fu">fp_border</span>(<span class="at">color =</span> <span class="st">"black"</span>, <span class="at">width =</span> <span class="dv">1</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb42-1514"><a href="#cb42-1514" aria-hidden="true" tabindex="-1"></a>  <span class="fu">border_inner_h</span>(<span class="at">part =</span> <span class="st">"header"</span>, <span class="at">border =</span> <span class="fu">fp_border</span>(<span class="at">color =</span> <span class="st">"black"</span>, <span class="at">width =</span> <span class="fl">0.8</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb42-1515"><a href="#cb42-1515" aria-hidden="true" tabindex="-1"></a>  <span class="fu">border_inner_h</span>(<span class="at">part =</span> <span class="st">"body"</span>, <span class="at">border =</span> <span class="fu">fp_border</span>(<span class="at">color =</span> <span class="st">"black"</span>, <span class="at">width =</span> <span class="fl">0.8</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb42-1516"><a href="#cb42-1516" aria-hidden="true" tabindex="-1"></a>  <span class="fu">border</span>(<span class="at">part =</span> <span class="st">"body"</span>, <span class="at">i =</span> <span class="fu">nrow</span>(tab_combined), <span class="at">border.bottom =</span> <span class="fu">fp_border</span>(<span class="at">color =</span> <span class="st">"black"</span>, <span class="at">width =</span> <span class="dv">1</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb42-1517"><a href="#cb42-1517" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_caption</span>(<span class="fu">as_paragraph</span>(<span class="fu">as_chunk</span>(</span>
<span id="cb42-1518"><a href="#cb42-1518" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Table xx: Column-percentage summary of vaccination uptake across all demographic variables, 2015‚Äì2024."</span>,</span>
<span id="cb42-1519"><a href="#cb42-1519" aria-hidden="true" tabindex="-1"></a>    <span class="at">props =</span> <span class="fu">fp_text</span>(<span class="at">font.size =</span> <span class="dv">12</span>, <span class="at">font.family =</span> <span class="st">"Times New Roman"</span>, <span class="at">bold =</span> <span class="cn">FALSE</span>)</span>
<span id="cb42-1520"><a href="#cb42-1520" aria-hidden="true" tabindex="-1"></a>  ))) <span class="sc">%&gt;%</span></span>
<span id="cb42-1521"><a href="#cb42-1521" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_footer_lines</span>(<span class="at">values =</span> <span class="fu">c</span>(</span>
<span id="cb42-1522"><a href="#cb42-1522" aria-hidden="true" tabindex="-1"></a>    <span class="st">"·µÉ Vaccination proportions were calculated using column percentages for all variables."</span>,</span>
<span id="cb42-1523"><a href="#cb42-1523" aria-hidden="true" tabindex="-1"></a>    <span class="st">"·µá Marital status was grouped into two: partnered (married) and not-partnered (divorced, widowed, single)."</span>,</span>
<span id="cb42-1524"><a href="#cb42-1524" aria-hidden="true" tabindex="-1"></a>    <span class="st">"·∂ú Other race refers to those identifying as native or other racial groups."</span></span>
<span id="cb42-1525"><a href="#cb42-1525" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">%&gt;%</span></span>
<span id="cb42-1526"><a href="#cb42-1526" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fontsize</span>(<span class="at">part =</span> <span class="st">"header"</span>, <span class="at">size =</span> <span class="dv">12</span>) <span class="sc">%&gt;%</span></span>
<span id="cb42-1527"><a href="#cb42-1527" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fontsize</span>(<span class="at">part =</span> <span class="st">"body"</span>, <span class="at">size =</span> <span class="dv">11</span>) <span class="sc">%&gt;%</span></span>
<span id="cb42-1528"><a href="#cb42-1528" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fontsize</span>(<span class="at">part =</span> <span class="st">"footer"</span>, <span class="at">size =</span> <span class="dv">10</span>) <span class="sc">%&gt;%</span></span>
<span id="cb42-1529"><a href="#cb42-1529" aria-hidden="true" tabindex="-1"></a>  <span class="fu">font</span>(<span class="at">part =</span> <span class="st">"all"</span>, <span class="at">fontname =</span> <span class="st">"Times New Roman"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb42-1530"><a href="#cb42-1530" aria-hidden="true" tabindex="-1"></a>  <span class="fu">color</span>(<span class="at">part =</span> <span class="st">"header"</span>, <span class="at">color =</span> <span class="st">"white"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb42-1531"><a href="#cb42-1531" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bg</span>(<span class="at">part =</span> <span class="st">"header"</span>, <span class="at">bg =</span> <span class="st">"black"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb42-1532"><a href="#cb42-1532" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bg</span>(<span class="at">j =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>, <span class="at">i =</span> <span class="fu">seq</span>(<span class="dv">2</span>, <span class="fu">nrow</span>(tab_combined), <span class="dv">2</span>), <span class="at">bg =</span> <span class="st">"white"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb42-1533"><a href="#cb42-1533" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bold</span>(<span class="at">j =</span> <span class="dv">1</span>, <span class="at">part =</span> <span class="st">"body"</span>)</span>
<span id="cb42-1534"><a href="#cb42-1534" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-1535"><a href="#cb42-1535" aria-hidden="true" tabindex="-1"></a><span class="co"># --- Display final table ---</span></span>
<span id="cb42-1536"><a href="#cb42-1536" aria-hidden="true" tabindex="-1"></a>table_vacc_summary</span>
<span id="cb42-1537"><a href="#cb42-1537" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-1538"><a href="#cb42-1538" aria-hidden="true" tabindex="-1"></a><span class="co"># --- Clean up temporary variables (optional good practice) ---</span></span>
<span id="cb42-1539"><a href="#cb42-1539" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(</span>
<span id="cb42-1540"><a href="#cb42-1540" aria-hidden="true" tabindex="-1"></a>  tab_gender, tab_age, tab_marital, tab_year, tab_quarter, tab_race,</span>
<span id="cb42-1541"><a href="#cb42-1541" aria-hidden="true" tabindex="-1"></a>  tab_combined, create_tab, totals, total_resp, total_child, total_other</span>
<span id="cb42-1542"><a href="#cb42-1542" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb42-1543"><a href="#cb42-1543" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb42-1544"><a href="#cb42-1544" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-1545"><a href="#cb42-1545" aria-hidden="true" tabindex="-1"></a><span class="fu">## **11. Columnwise Tables with NA values**</span></span>
<span id="cb42-1546"><a href="#cb42-1546" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-1547"><a href="#cb42-1547" aria-hidden="true" tabindex="-1"></a> Columnwise percentage table including NA where applicable</span>
<span id="cb42-1548"><a href="#cb42-1548" aria-hidden="true" tabindex="-1"></a><span class="ss"> - </span>All variables use column percentages (i.e., % down each vaccine group column)</span>
<span id="cb42-1549"><a href="#cb42-1549" aria-hidden="true" tabindex="-1"></a><span class="ss"> - </span>NA values are shown only where relevant (e.g., race group for Respiratory vaccines)</span>
<span id="cb42-1550"><a href="#cb42-1550" aria-hidden="true" tabindex="-1"></a><span class="ss"> - </span>"Unknown" variable categories are excluded from percentage calculations to maintain ~100% totals per column</span>
<span id="cb42-1551"><a href="#cb42-1551" aria-hidden="true" tabindex="-1"></a><span class="ss"> - </span>Useful for subgroup summaries where not all variables apply across all vaccine type</span>
<span id="cb42-1552"><a href="#cb42-1552" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-1555"><a href="#cb42-1555" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb42-1556"><a href="#cb42-1556" aria-hidden="true" tabindex="-1"></a><span class="co"># ------------ 11. Columnwise Tables with NA values-------------------------------------------</span></span>
<span id="cb42-1557"><a href="#cb42-1557" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-1558"><a href="#cb42-1558" aria-hidden="true" tabindex="-1"></a><span class="co"># Prepare Vaccination Uptake Table (All Variables Using Column Percentages)</span></span>
<span id="cb42-1559"><a href="#cb42-1559" aria-hidden="true" tabindex="-1"></a><span class="co"># ....................................................................................................</span></span>
<span id="cb42-1560"><a href="#cb42-1560" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-1561"><a href="#cb42-1561" aria-hidden="true" tabindex="-1"></a><span class="co"># --- Set working directory and load data (if needed) ---</span></span>
<span id="cb42-1562"><a href="#cb42-1562" aria-hidden="true" tabindex="-1"></a><span class="co"># setwd("C:/Users/User/Desktop/Materials_ Course and proposals/Course Related/DataCamp/Data/")</span></span>
<span id="cb42-1563"><a href="#cb42-1563" aria-hidden="true" tabindex="-1"></a><span class="co"># load("Vaccination_uptake.RDATA")</span></span>
<span id="cb42-1564"><a href="#cb42-1564" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-1565"><a href="#cb42-1565" aria-hidden="true" tabindex="-1"></a><span class="co"># --- Clean and prepare datasets ---</span></span>
<span id="cb42-1566"><a href="#cb42-1566" aria-hidden="true" tabindex="-1"></a>vacc_1524 <span class="ot">&lt;-</span> vacc_1524 <span class="sc">%&gt;%</span></span>
<span id="cb42-1567"><a href="#cb42-1567" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">c</span>(gender, age_3group, marital_2group, year_3group, vacc_quarter, race_grouped), as.character))</span>
<span id="cb42-1568"><a href="#cb42-1568" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-1569"><a href="#cb42-1569" aria-hidden="true" tabindex="-1"></a><span class="co"># Subset data for Respiratory vaccines to calculate column-based percentages (used for race)</span></span>
<span id="cb42-1570"><a href="#cb42-1570" aria-hidden="true" tabindex="-1"></a>respiratory_vaccines <span class="ot">&lt;-</span> vacc_1524 <span class="sc">%&gt;%</span></span>
<span id="cb42-1571"><a href="#cb42-1571" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(vacc_group3 <span class="sc">==</span> <span class="st">"Respiratory vaccines"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb42-1572"><a href="#cb42-1572" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(race_grouped, as.character))</span>
<span id="cb42-1573"><a href="#cb42-1573" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-1574"><a href="#cb42-1574" aria-hidden="true" tabindex="-1"></a><span class="co"># --- General table builder ---</span></span>
<span id="cb42-1575"><a href="#cb42-1575" aria-hidden="true" tabindex="-1"></a>create_tab <span class="ot">&lt;-</span> <span class="cf">function</span>(data, var, label, <span class="at">use_col_percentage =</span> <span class="cn">TRUE</span>) {</span>
<span id="cb42-1576"><a href="#cb42-1576" aria-hidden="true" tabindex="-1"></a>  tab_main <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span></span>
<span id="cb42-1577"><a href="#cb42-1577" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>({{ var }})) <span class="sc">%&gt;%</span></span>
<span id="cb42-1578"><a href="#cb42-1578" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tabyl</span>({{ var }}, vacc_group3) <span class="sc">%&gt;%</span></span>
<span id="cb42-1579"><a href="#cb42-1579" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">Category =</span> label, <span class="at">.before =</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb42-1580"><a href="#cb42-1580" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rename</span>(<span class="at">Label =</span> {{ var }}) <span class="sc">%&gt;%</span></span>
<span id="cb42-1581"><a href="#cb42-1581" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">Label =</span> <span class="fu">as.character</span>(Label))</span>
<span id="cb42-1582"><a href="#cb42-1582" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb42-1583"><a href="#cb42-1583" aria-hidden="true" tabindex="-1"></a>  na_count <span class="ot">&lt;-</span> <span class="fu">sum</span>(<span class="fu">is.na</span>(<span class="fu">pull</span>(data, {{ var }})))</span>
<span id="cb42-1584"><a href="#cb42-1584" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (na_count <span class="sc">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb42-1585"><a href="#cb42-1585" aria-hidden="true" tabindex="-1"></a>    na_row <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb42-1586"><a href="#cb42-1586" aria-hidden="true" tabindex="-1"></a>      <span class="at">Category =</span> label,</span>
<span id="cb42-1587"><a href="#cb42-1587" aria-hidden="true" tabindex="-1"></a>      <span class="at">Label =</span> <span class="st">"Unknown"</span>,</span>
<span id="cb42-1588"><a href="#cb42-1588" aria-hidden="true" tabindex="-1"></a>      <span class="st">`</span><span class="at">Respiratory vaccines</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">sum</span>(data<span class="sc">$</span>vacc_group3 <span class="sc">==</span> <span class="st">"Respiratory vaccines"</span> <span class="sc">&amp;</span> <span class="fu">is.na</span>(<span class="fu">pull</span>(data, {{ var }})), <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb42-1589"><a href="#cb42-1589" aria-hidden="true" tabindex="-1"></a>      <span class="st">`</span><span class="at">Childhood vaccines</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">sum</span>(data<span class="sc">$</span>vacc_group3 <span class="sc">==</span> <span class="st">"Childhood vaccines"</span> <span class="sc">&amp;</span> <span class="fu">is.na</span>(<span class="fu">pull</span>(data, {{ var }})), <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb42-1590"><a href="#cb42-1590" aria-hidden="true" tabindex="-1"></a>      <span class="at">Other =</span> <span class="fu">sum</span>(data<span class="sc">$</span>vacc_group3 <span class="sc">==</span> <span class="st">"Other"</span> <span class="sc">&amp;</span> <span class="fu">is.na</span>(<span class="fu">pull</span>(data, {{ var }})), <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb42-1591"><a href="#cb42-1591" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb42-1592"><a href="#cb42-1592" aria-hidden="true" tabindex="-1"></a>    tab_combined <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(tab_main, na_row)</span>
<span id="cb42-1593"><a href="#cb42-1593" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb42-1594"><a href="#cb42-1594" aria-hidden="true" tabindex="-1"></a>    tab_combined <span class="ot">&lt;-</span> tab_main</span>
<span id="cb42-1595"><a href="#cb42-1595" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb42-1596"><a href="#cb42-1596" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb42-1597"><a href="#cb42-1597" aria-hidden="true" tabindex="-1"></a>  tab_combined <span class="sc">%&gt;%</span></span>
<span id="cb42-1598"><a href="#cb42-1598" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">use_col_percentage =</span> use_col_percentage)</span>
<span id="cb42-1599"><a href="#cb42-1599" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb42-1600"><a href="#cb42-1600" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-1601"><a href="#cb42-1601" aria-hidden="true" tabindex="-1"></a><span class="co"># --- Create summary tables ---</span></span>
<span id="cb42-1602"><a href="#cb42-1602" aria-hidden="true" tabindex="-1"></a>tab_gender    <span class="ot">&lt;-</span> <span class="fu">create_tab</span>(vacc_1524, gender, <span class="st">"Gender"</span>)</span>
<span id="cb42-1603"><a href="#cb42-1603" aria-hidden="true" tabindex="-1"></a>tab_age       <span class="ot">&lt;-</span> <span class="fu">create_tab</span>(vacc_1524, age_3group, <span class="st">"Age group"</span>)</span>
<span id="cb42-1604"><a href="#cb42-1604" aria-hidden="true" tabindex="-1"></a>tab_marital   <span class="ot">&lt;-</span> <span class="fu">create_tab</span>(vacc_1524, marital_2group, <span class="st">"Marital status·µá"</span>)</span>
<span id="cb42-1605"><a href="#cb42-1605" aria-hidden="true" tabindex="-1"></a>tab_year      <span class="ot">&lt;-</span> <span class="fu">create_tab</span>(vacc_1524, year_3group, <span class="st">"Year group"</span>)</span>
<span id="cb42-1606"><a href="#cb42-1606" aria-hidden="true" tabindex="-1"></a>tab_quarter   <span class="ot">&lt;-</span> <span class="fu">create_tab</span>(vacc_1524, vacc_quarter, <span class="st">"Quarter"</span>)</span>
<span id="cb42-1607"><a href="#cb42-1607" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-1608"><a href="#cb42-1608" aria-hidden="true" tabindex="-1"></a><span class="co"># Race group from respiratory-only subset (denominator = respiratory group only)</span></span>
<span id="cb42-1609"><a href="#cb42-1609" aria-hidden="true" tabindex="-1"></a>tab_race      <span class="ot">&lt;-</span> <span class="fu">create_tab</span>(respiratory_vaccines, race_grouped, <span class="st">"Race group"</span>)</span>
<span id="cb42-1610"><a href="#cb42-1610" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-1611"><a href="#cb42-1611" aria-hidden="true" tabindex="-1"></a><span class="co"># --- Combine all tables ---</span></span>
<span id="cb42-1612"><a href="#cb42-1612" aria-hidden="true" tabindex="-1"></a>tab_combined <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(</span>
<span id="cb42-1613"><a href="#cb42-1613" aria-hidden="true" tabindex="-1"></a>  tab_gender, tab_age, tab_marital,</span>
<span id="cb42-1614"><a href="#cb42-1614" aria-hidden="true" tabindex="-1"></a>  tab_year, tab_quarter, tab_race</span>
<span id="cb42-1615"><a href="#cb42-1615" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb42-1616"><a href="#cb42-1616" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-1617"><a href="#cb42-1617" aria-hidden="true" tabindex="-1"></a><span class="co"># --- Calculate and format column percentages ---</span></span>
<span id="cb42-1618"><a href="#cb42-1618" aria-hidden="true" tabindex="-1"></a>tab_combined <span class="ot">&lt;-</span> tab_combined <span class="sc">%&gt;%</span></span>
<span id="cb42-1619"><a href="#cb42-1619" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Category) <span class="sc">%&gt;%</span></span>
<span id="cb42-1620"><a href="#cb42-1620" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb42-1621"><a href="#cb42-1621" aria-hidden="true" tabindex="-1"></a>    <span class="at">use_col =</span> <span class="cn">TRUE</span>,</span>
<span id="cb42-1622"><a href="#cb42-1622" aria-hidden="true" tabindex="-1"></a>    <span class="at">Total_Resp =</span> <span class="fu">sum</span>(<span class="st">`</span><span class="at">Respiratory vaccines</span><span class="st">`</span>[Label <span class="sc">!=</span> <span class="st">"Unknown"</span>], <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb42-1623"><a href="#cb42-1623" aria-hidden="true" tabindex="-1"></a>    <span class="at">Total_Child =</span> <span class="fu">sum</span>(<span class="st">`</span><span class="at">Childhood vaccines</span><span class="st">`</span>[Label <span class="sc">!=</span> <span class="st">"Unknown"</span>], <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb42-1624"><a href="#cb42-1624" aria-hidden="true" tabindex="-1"></a>    <span class="at">Total_Other =</span> <span class="fu">sum</span>(Other[Label <span class="sc">!=</span> <span class="st">"Unknown"</span>], <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb42-1625"><a href="#cb42-1625" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb42-1626"><a href="#cb42-1626" aria-hidden="true" tabindex="-1"></a>    <span class="at">Resp_prop =</span> <span class="fu">ifelse</span>(Label <span class="sc">!=</span> <span class="st">"Unknown"</span>, <span class="fu">round</span>(<span class="dv">100</span> <span class="sc">*</span> <span class="st">`</span><span class="at">Respiratory vaccines</span><span class="st">`</span> <span class="sc">/</span> Total_Resp, <span class="dv">1</span>), <span class="cn">NA</span>),</span>
<span id="cb42-1627"><a href="#cb42-1627" aria-hidden="true" tabindex="-1"></a>    <span class="at">Child_prop =</span> <span class="fu">ifelse</span>(Label <span class="sc">!=</span> <span class="st">"Unknown"</span>, <span class="fu">round</span>(<span class="dv">100</span> <span class="sc">*</span> <span class="st">`</span><span class="at">Childhood vaccines</span><span class="st">`</span> <span class="sc">/</span> Total_Child, <span class="dv">1</span>), <span class="cn">NA</span>),</span>
<span id="cb42-1628"><a href="#cb42-1628" aria-hidden="true" tabindex="-1"></a>    <span class="at">Other_prop =</span> <span class="fu">ifelse</span>(Label <span class="sc">!=</span> <span class="st">"Unknown"</span>, <span class="fu">round</span>(<span class="dv">100</span> <span class="sc">*</span> Other <span class="sc">/</span> Total_Other, <span class="dv">1</span>), <span class="cn">NA</span>),</span>
<span id="cb42-1629"><a href="#cb42-1629" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb42-1630"><a href="#cb42-1630" aria-hidden="true" tabindex="-1"></a>    <span class="at">Respiratory =</span> <span class="fu">ifelse</span>(<span class="fu">is.na</span>(Resp_prop),</span>
<span id="cb42-1631"><a href="#cb42-1631" aria-hidden="true" tabindex="-1"></a>                         <span class="fu">paste0</span>(<span class="fu">comma</span>(<span class="st">`</span><span class="at">Respiratory vaccines</span><span class="st">`</span>)),</span>
<span id="cb42-1632"><a href="#cb42-1632" aria-hidden="true" tabindex="-1"></a>                         <span class="fu">paste0</span>(<span class="fu">comma</span>(<span class="st">`</span><span class="at">Respiratory vaccines</span><span class="st">`</span>), <span class="st">" ("</span>, Resp_prop, <span class="st">")"</span>)),</span>
<span id="cb42-1633"><a href="#cb42-1633" aria-hidden="true" tabindex="-1"></a>    <span class="at">Childhood =</span> <span class="fu">ifelse</span>(<span class="fu">is.na</span>(Child_prop),</span>
<span id="cb42-1634"><a href="#cb42-1634" aria-hidden="true" tabindex="-1"></a>                       <span class="fu">paste0</span>(<span class="fu">comma</span>(<span class="st">`</span><span class="at">Childhood vaccines</span><span class="st">`</span>)),</span>
<span id="cb42-1635"><a href="#cb42-1635" aria-hidden="true" tabindex="-1"></a>                       <span class="fu">paste0</span>(<span class="fu">comma</span>(<span class="st">`</span><span class="at">Childhood vaccines</span><span class="st">`</span>), <span class="st">" ("</span>, Child_prop, <span class="st">")"</span>)),</span>
<span id="cb42-1636"><a href="#cb42-1636" aria-hidden="true" tabindex="-1"></a>    <span class="at">Other_grp =</span> <span class="fu">ifelse</span>(<span class="fu">is.na</span>(Other_prop),</span>
<span id="cb42-1637"><a href="#cb42-1637" aria-hidden="true" tabindex="-1"></a>                       <span class="fu">paste0</span>(<span class="fu">comma</span>(Other)),</span>
<span id="cb42-1638"><a href="#cb42-1638" aria-hidden="true" tabindex="-1"></a>                       <span class="fu">paste0</span>(<span class="fu">comma</span>(Other), <span class="st">" ("</span>, Other_prop, <span class="st">")"</span>))</span>
<span id="cb42-1639"><a href="#cb42-1639" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb42-1640"><a href="#cb42-1640" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb42-1641"><a href="#cb42-1641" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-1642"><a href="#cb42-1642" aria-hidden="true" tabindex="-1"></a><span class="co"># --- Format labels and rows ---</span></span>
<span id="cb42-1643"><a href="#cb42-1643" aria-hidden="true" tabindex="-1"></a>tab_combined <span class="ot">&lt;-</span> tab_combined <span class="sc">%&gt;%</span></span>
<span id="cb42-1644"><a href="#cb42-1644" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb42-1645"><a href="#cb42-1645" aria-hidden="true" tabindex="-1"></a>    <span class="at">Label =</span> <span class="fu">ifelse</span>(Label <span class="sc">==</span> <span class="st">"Other"</span>, <span class="st">"Other·∂ú"</span>, Label),</span>
<span id="cb42-1646"><a href="#cb42-1646" aria-hidden="true" tabindex="-1"></a>    <span class="at">Respiratory =</span> <span class="fu">ifelse</span>(Label <span class="sc">==</span> <span class="st">"Unknown"</span> <span class="sc">&amp;</span> <span class="st">`</span><span class="at">Respiratory vaccines</span><span class="st">`</span> <span class="sc">==</span> <span class="dv">0</span>, <span class="st">""</span>, Respiratory),</span>
<span id="cb42-1647"><a href="#cb42-1647" aria-hidden="true" tabindex="-1"></a>    <span class="at">Childhood   =</span> <span class="fu">ifelse</span>(Label <span class="sc">==</span> <span class="st">"Unknown"</span> <span class="sc">&amp;</span> <span class="st">`</span><span class="at">Childhood vaccines</span><span class="st">`</span> <span class="sc">==</span> <span class="dv">0</span>, <span class="st">""</span>, Childhood),</span>
<span id="cb42-1648"><a href="#cb42-1648" aria-hidden="true" tabindex="-1"></a>    <span class="at">Other_grp   =</span> <span class="fu">ifelse</span>(Label <span class="sc">==</span> <span class="st">"Unknown"</span> <span class="sc">&amp;</span> Other <span class="sc">==</span> <span class="dv">0</span>, <span class="st">""</span>, Other_grp)</span>
<span id="cb42-1649"><a href="#cb42-1649" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb42-1650"><a href="#cb42-1650" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Category) <span class="sc">%&gt;%</span></span>
<span id="cb42-1651"><a href="#cb42-1651" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Category =</span> <span class="fu">ifelse</span>(<span class="fu">row_number</span>() <span class="sc">==</span> <span class="dv">1</span>, Category, <span class="st">""</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb42-1652"><a href="#cb42-1652" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb42-1653"><a href="#cb42-1653" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Category, Label, Respiratory, Childhood, Other_grp)</span>
<span id="cb42-1654"><a href="#cb42-1654" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-1655"><a href="#cb42-1655" aria-hidden="true" tabindex="-1"></a><span class="co"># --- Prepare column Ns for header ---</span></span>
<span id="cb42-1656"><a href="#cb42-1656" aria-hidden="true" tabindex="-1"></a>totals <span class="ot">&lt;-</span> <span class="fu">table</span>(vacc_1524<span class="sc">$</span>vacc_group3)</span>
<span id="cb42-1657"><a href="#cb42-1657" aria-hidden="true" tabindex="-1"></a>total_resp <span class="ot">&lt;-</span> totals[<span class="st">"Respiratory vaccines"</span>]</span>
<span id="cb42-1658"><a href="#cb42-1658" aria-hidden="true" tabindex="-1"></a>total_child <span class="ot">&lt;-</span> totals[<span class="st">"Childhood vaccines"</span>]</span>
<span id="cb42-1659"><a href="#cb42-1659" aria-hidden="true" tabindex="-1"></a>total_other <span class="ot">&lt;-</span> totals[<span class="st">"Other"</span>]</span>
<span id="cb42-1660"><a href="#cb42-1660" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-1661"><a href="#cb42-1661" aria-hidden="true" tabindex="-1"></a><span class="co"># --- Build Flextable ---</span></span>
<span id="cb42-1662"><a href="#cb42-1662" aria-hidden="true" tabindex="-1"></a>table_vacc_summary <span class="ot">&lt;-</span> <span class="fu">flextable</span>(tab_combined) <span class="sc">%&gt;%</span></span>
<span id="cb42-1663"><a href="#cb42-1663" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_header_labels</span>(</span>
<span id="cb42-1664"><a href="#cb42-1664" aria-hidden="true" tabindex="-1"></a>    <span class="at">Category =</span> <span class="st">"Variable type"</span>,</span>
<span id="cb42-1665"><a href="#cb42-1665" aria-hidden="true" tabindex="-1"></a>    <span class="at">Label =</span> <span class="st">"Values"</span>,</span>
<span id="cb42-1666"><a href="#cb42-1666" aria-hidden="true" tabindex="-1"></a>    <span class="at">Respiratory =</span> <span class="st">"Number (%)·µÉ"</span>,</span>
<span id="cb42-1667"><a href="#cb42-1667" aria-hidden="true" tabindex="-1"></a>    <span class="at">Childhood =</span> <span class="st">"Number (%)·µÉ"</span>,</span>
<span id="cb42-1668"><a href="#cb42-1668" aria-hidden="true" tabindex="-1"></a>    <span class="at">Other_grp =</span> <span class="st">"Number (%)·µÉ"</span></span>
<span id="cb42-1669"><a href="#cb42-1669" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb42-1670"><a href="#cb42-1670" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_header_row</span>(</span>
<span id="cb42-1671"><a href="#cb42-1671" aria-hidden="true" tabindex="-1"></a>    <span class="at">values =</span> <span class="fu">c</span>(<span class="st">""</span>, <span class="st">""</span>,</span>
<span id="cb42-1672"><a href="#cb42-1672" aria-hidden="true" tabindex="-1"></a>               <span class="fu">paste0</span>(<span class="st">"Respiratory vaccines (N = "</span>, <span class="fu">format</span>(total_resp, <span class="at">big.mark =</span> <span class="st">","</span>), <span class="st">")"</span>),</span>
<span id="cb42-1673"><a href="#cb42-1673" aria-hidden="true" tabindex="-1"></a>               <span class="fu">paste0</span>(<span class="st">"Childhood vaccines (N = "</span>, <span class="fu">format</span>(total_child, <span class="at">big.mark =</span> <span class="st">","</span>), <span class="st">")"</span>),</span>
<span id="cb42-1674"><a href="#cb42-1674" aria-hidden="true" tabindex="-1"></a>               <span class="fu">paste0</span>(<span class="st">"Other (N = "</span>, <span class="fu">format</span>(total_other, <span class="at">big.mark =</span> <span class="st">","</span>), <span class="st">")"</span>)),</span>
<span id="cb42-1675"><a href="#cb42-1675" aria-hidden="true" tabindex="-1"></a>    <span class="at">colwidths =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>),</span>
<span id="cb42-1676"><a href="#cb42-1676" aria-hidden="true" tabindex="-1"></a>    <span class="at">top =</span> <span class="cn">TRUE</span></span>
<span id="cb42-1677"><a href="#cb42-1677" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb42-1678"><a href="#cb42-1678" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_header_row</span>(</span>
<span id="cb42-1679"><a href="#cb42-1679" aria-hidden="true" tabindex="-1"></a>    <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"Description"</span>, <span class="st">"Vaccination uptake"</span>),</span>
<span id="cb42-1680"><a href="#cb42-1680" aria-hidden="true" tabindex="-1"></a>    <span class="at">colwidths =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">3</span>),</span>
<span id="cb42-1681"><a href="#cb42-1681" aria-hidden="true" tabindex="-1"></a>    <span class="at">top =</span> <span class="cn">TRUE</span></span>
<span id="cb42-1682"><a href="#cb42-1682" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb42-1683"><a href="#cb42-1683" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_box</span>() <span class="sc">%&gt;%</span></span>
<span id="cb42-1684"><a href="#cb42-1684" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_table_properties</span>(<span class="at">layout =</span> <span class="st">"autofit"</span>, <span class="at">width =</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb42-1685"><a href="#cb42-1685" aria-hidden="true" tabindex="-1"></a>  <span class="fu">width</span>(<span class="at">j =</span> <span class="dv">1</span>, <span class="at">width =</span> <span class="fl">1.5</span>) <span class="sc">%&gt;%</span></span>
<span id="cb42-1686"><a href="#cb42-1686" aria-hidden="true" tabindex="-1"></a>  <span class="fu">width</span>(<span class="at">j =</span> <span class="dv">2</span>, <span class="at">width =</span> <span class="fl">2.5</span>) <span class="sc">%&gt;%</span></span>
<span id="cb42-1687"><a href="#cb42-1687" aria-hidden="true" tabindex="-1"></a>  <span class="fu">width</span>(<span class="at">j =</span> <span class="dv">3</span><span class="sc">:</span><span class="dv">5</span>, <span class="at">width =</span> <span class="fl">1.5</span>) <span class="sc">%&gt;%</span></span>
<span id="cb42-1688"><a href="#cb42-1688" aria-hidden="true" tabindex="-1"></a>  <span class="fu">align</span>(<span class="at">align =</span> <span class="st">"justify"</span>, <span class="at">part =</span> <span class="st">"all"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb42-1689"><a href="#cb42-1689" aria-hidden="true" tabindex="-1"></a>  <span class="fu">border_remove</span>() <span class="sc">%&gt;%</span></span>
<span id="cb42-1690"><a href="#cb42-1690" aria-hidden="true" tabindex="-1"></a>  <span class="fu">border</span>(<span class="at">part =</span> <span class="st">"header"</span>, <span class="at">i =</span> <span class="dv">1</span>, <span class="at">border.top =</span> <span class="fu">fp_border</span>(<span class="at">color =</span> <span class="st">"black"</span>, <span class="at">width =</span> <span class="dv">1</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb42-1691"><a href="#cb42-1691" aria-hidden="true" tabindex="-1"></a>  <span class="fu">border</span>(<span class="at">part =</span> <span class="st">"header"</span>, <span class="at">i =</span> <span class="dv">3</span>, <span class="at">border.bottom =</span> <span class="fu">fp_border</span>(<span class="at">color =</span> <span class="st">"black"</span>, <span class="at">width =</span> <span class="dv">1</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb42-1692"><a href="#cb42-1692" aria-hidden="true" tabindex="-1"></a>  <span class="fu">border_inner_h</span>(<span class="at">part =</span> <span class="st">"header"</span>, <span class="at">border =</span> <span class="fu">fp_border</span>(<span class="at">color =</span> <span class="st">"black"</span>, <span class="at">width =</span> <span class="fl">0.8</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb42-1693"><a href="#cb42-1693" aria-hidden="true" tabindex="-1"></a>  <span class="fu">border_inner_h</span>(<span class="at">part =</span> <span class="st">"body"</span>, <span class="at">border =</span> <span class="fu">fp_border</span>(<span class="at">color =</span> <span class="st">"black"</span>, <span class="at">width =</span> <span class="fl">0.8</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb42-1694"><a href="#cb42-1694" aria-hidden="true" tabindex="-1"></a>  <span class="fu">border</span>(<span class="at">part =</span> <span class="st">"body"</span>, <span class="at">i =</span> <span class="fu">nrow</span>(tab_combined), <span class="at">border.bottom =</span> <span class="fu">fp_border</span>(<span class="at">color =</span> <span class="st">"black"</span>, <span class="at">width =</span> <span class="dv">1</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb42-1695"><a href="#cb42-1695" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_caption</span>(<span class="fu">as_paragraph</span>(<span class="fu">as_chunk</span>(</span>
<span id="cb42-1696"><a href="#cb42-1696" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Table xx: Column-percentage summary of vaccination uptake across all demographic variables, 2015‚Äì2024."</span>,</span>
<span id="cb42-1697"><a href="#cb42-1697" aria-hidden="true" tabindex="-1"></a>    <span class="at">props =</span> <span class="fu">fp_text</span>(<span class="at">font.size =</span> <span class="dv">12</span>, <span class="at">font.family =</span> <span class="st">"Times New Roman"</span>, <span class="at">bold =</span> <span class="cn">FALSE</span>)</span>
<span id="cb42-1698"><a href="#cb42-1698" aria-hidden="true" tabindex="-1"></a>  ))) <span class="sc">%&gt;%</span></span>
<span id="cb42-1699"><a href="#cb42-1699" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_footer_lines</span>(<span class="at">values =</span> <span class="fu">c</span>(</span>
<span id="cb42-1700"><a href="#cb42-1700" aria-hidden="true" tabindex="-1"></a>    <span class="st">"·µÉ Vaccination proportions were calculated using column percentages. Race group used respiratory vaccine subset only."</span>,</span>
<span id="cb42-1701"><a href="#cb42-1701" aria-hidden="true" tabindex="-1"></a>    <span class="st">"·µá Marital status was grouped into partnered (married) and non-partnered (single, divorced, widowed)."</span>,</span>
<span id="cb42-1702"><a href="#cb42-1702" aria-hidden="true" tabindex="-1"></a>    <span class="st">"·∂ú 'Other' race includes native or other less represented racial identities."</span></span>
<span id="cb42-1703"><a href="#cb42-1703" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">%&gt;%</span></span>
<span id="cb42-1704"><a href="#cb42-1704" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fontsize</span>(<span class="at">part =</span> <span class="st">"header"</span>, <span class="at">size =</span> <span class="dv">12</span>) <span class="sc">%&gt;%</span></span>
<span id="cb42-1705"><a href="#cb42-1705" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fontsize</span>(<span class="at">part =</span> <span class="st">"body"</span>, <span class="at">size =</span> <span class="dv">11</span>) <span class="sc">%&gt;%</span></span>
<span id="cb42-1706"><a href="#cb42-1706" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fontsize</span>(<span class="at">part =</span> <span class="st">"footer"</span>, <span class="at">size =</span> <span class="dv">10</span>) <span class="sc">%&gt;%</span></span>
<span id="cb42-1707"><a href="#cb42-1707" aria-hidden="true" tabindex="-1"></a>  <span class="fu">font</span>(<span class="at">part =</span> <span class="st">"all"</span>, <span class="at">fontname =</span> <span class="st">"Times New Roman"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb42-1708"><a href="#cb42-1708" aria-hidden="true" tabindex="-1"></a>  <span class="fu">color</span>(<span class="at">part =</span> <span class="st">"header"</span>, <span class="at">color =</span> <span class="st">"white"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb42-1709"><a href="#cb42-1709" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bg</span>(<span class="at">part =</span> <span class="st">"header"</span>, <span class="at">bg =</span> <span class="st">"#000000"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb42-1710"><a href="#cb42-1710" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bg</span>(<span class="at">j =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>, <span class="at">i =</span> <span class="fu">seq</span>(<span class="dv">2</span>, <span class="fu">nrow</span>(tab_combined), <span class="dv">2</span>), <span class="at">bg =</span> <span class="st">"white"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb42-1711"><a href="#cb42-1711" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bold</span>(<span class="at">j =</span> <span class="dv">1</span>, <span class="at">part =</span> <span class="st">"body"</span>)</span>
<span id="cb42-1712"><a href="#cb42-1712" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-1713"><a href="#cb42-1713" aria-hidden="true" tabindex="-1"></a><span class="co"># --- Display final table ---</span></span>
<span id="cb42-1714"><a href="#cb42-1714" aria-hidden="true" tabindex="-1"></a>table_vacc_summary</span>
<span id="cb42-1715"><a href="#cb42-1715" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-1716"><a href="#cb42-1716" aria-hidden="true" tabindex="-1"></a><span class="co"># --- Cleanup temporary objects ---</span></span>
<span id="cb42-1717"><a href="#cb42-1717" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(</span>
<span id="cb42-1718"><a href="#cb42-1718" aria-hidden="true" tabindex="-1"></a>  tab_gender, tab_age, tab_marital, tab_year, tab_quarter, tab_race,</span>
<span id="cb42-1719"><a href="#cb42-1719" aria-hidden="true" tabindex="-1"></a>  tab_combined, create_tab, totals, total_resp, total_child, total_other,</span>
<span id="cb42-1720"><a href="#cb42-1720" aria-hidden="true" tabindex="-1"></a>  respiratory_vaccines</span>
<span id="cb42-1721"><a href="#cb42-1721" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb42-1722"><a href="#cb42-1722" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-1723"><a href="#cb42-1723" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb42-1724"><a href="#cb42-1724" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-1725"><a href="#cb42-1725" aria-hidden="true" tabindex="-1"></a><span class="fu">## **12. Both Row wise and Column wise Tables**</span></span>
<span id="cb42-1726"><a href="#cb42-1726" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-1727"><a href="#cb42-1727" aria-hidden="true" tabindex="-1"></a>This table presents **both row and column percentages** for vaccination uptake:</span>
<span id="cb42-1728"><a href="#cb42-1728" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-1729"><a href="#cb42-1729" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Row percentages show how each category (e.g., age group, gender) distributes across vaccine types.</span>
<span id="cb42-1730"><a href="#cb42-1730" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Column percentages are applied only to the *race group*, highlighting the demographic makeup within the respiratory vaccine recipients.</span>
<span id="cb42-1731"><a href="#cb42-1731" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-1732"><a href="#cb42-1732" aria-hidden="true" tabindex="-1"></a>This format helps answer questions like:</span>
<span id="cb42-1733"><a href="#cb42-1733" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>*"What proportion of women in each age group received respiratory vaccines?"* (row %)</span>
<span id="cb42-1734"><a href="#cb42-1734" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>*"What proportion of respiratory vaccine recipients were Aboriginal?"* (column %)</span>
<span id="cb42-1735"><a href="#cb42-1735" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-1736"><a href="#cb42-1736" aria-hidden="true" tabindex="-1"></a>Unknown values are included but excluded from percentage calculations to avoid distorting group totals.</span>
<span id="cb42-1737"><a href="#cb42-1737" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-1738"><a href="#cb42-1738" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-1741"><a href="#cb42-1741" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb42-1742"><a href="#cb42-1742" aria-hidden="true" tabindex="-1"></a><span class="co"># ------------12. Both Row wise and Column wise Tables -------------------------------------------</span></span>
<span id="cb42-1743"><a href="#cb42-1743" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-1744"><a href="#cb42-1744" aria-hidden="true" tabindex="-1"></a><span class="co"># ....................................................................................................</span></span>
<span id="cb42-1745"><a href="#cb42-1745" aria-hidden="true" tabindex="-1"></a><span class="co"># Prepare Vaccination Uptake Table (Row and Column Percentages)</span></span>
<span id="cb42-1746"><a href="#cb42-1746" aria-hidden="true" tabindex="-1"></a><span class="co"># ....................................................................................................</span></span>
<span id="cb42-1747"><a href="#cb42-1747" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-1748"><a href="#cb42-1748" aria-hidden="true" tabindex="-1"></a><span class="co"># --- Step 1: Prepare data for table formatting ---</span></span>
<span id="cb42-1749"><a href="#cb42-1749" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert grouping variables to character for cleaner label handling</span></span>
<span id="cb42-1750"><a href="#cb42-1750" aria-hidden="true" tabindex="-1"></a>vacc_1524 <span class="ot">&lt;-</span> vacc_1524 <span class="sc">%&gt;%</span></span>
<span id="cb42-1751"><a href="#cb42-1751" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">c</span>(gender, age_3group, marital_2group, year_3group, vacc_quarter, race_grouped), as.character))</span>
<span id="cb42-1752"><a href="#cb42-1752" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-1753"><a href="#cb42-1753" aria-hidden="true" tabindex="-1"></a><span class="co"># Subset data for Respiratory vaccines to calculate column-based percentages (used for race)</span></span>
<span id="cb42-1754"><a href="#cb42-1754" aria-hidden="true" tabindex="-1"></a>respiratory_vaccines <span class="ot">&lt;-</span> vacc_1524 <span class="sc">%&gt;%</span></span>
<span id="cb42-1755"><a href="#cb42-1755" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(vacc_group3 <span class="sc">==</span> <span class="st">"Respiratory vaccines"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb42-1756"><a href="#cb42-1756" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(race_grouped, as.character))</span>
<span id="cb42-1757"><a href="#cb42-1757" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-1758"><a href="#cb42-1758" aria-hidden="true" tabindex="-1"></a><span class="co"># --- Step 2: Create table-building function ---</span></span>
<span id="cb42-1759"><a href="#cb42-1759" aria-hidden="true" tabindex="-1"></a><span class="co"># This function tabulates counts by category and optionally adds missing (Unknown) values</span></span>
<span id="cb42-1760"><a href="#cb42-1760" aria-hidden="true" tabindex="-1"></a>create_tab <span class="ot">&lt;-</span> <span class="cf">function</span>(data, var, label, <span class="at">use_col_percentage =</span> <span class="cn">FALSE</span>) {</span>
<span id="cb42-1761"><a href="#cb42-1761" aria-hidden="true" tabindex="-1"></a>  tab_main <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span></span>
<span id="cb42-1762"><a href="#cb42-1762" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>({{ var }})) <span class="sc">%&gt;%</span></span>
<span id="cb42-1763"><a href="#cb42-1763" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tabyl</span>({{ var }}, vacc_group3) <span class="sc">%&gt;%</span></span>
<span id="cb42-1764"><a href="#cb42-1764" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">Category =</span> label, <span class="at">.before =</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb42-1765"><a href="#cb42-1765" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rename</span>(<span class="at">Label =</span> {{ var }}) <span class="sc">%&gt;%</span></span>
<span id="cb42-1766"><a href="#cb42-1766" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">Label =</span> <span class="fu">as.character</span>(Label))</span>
<span id="cb42-1767"><a href="#cb42-1767" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb42-1768"><a href="#cb42-1768" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Add a row for missing/unknown if needed</span></span>
<span id="cb42-1769"><a href="#cb42-1769" aria-hidden="true" tabindex="-1"></a>  na_count <span class="ot">&lt;-</span> <span class="fu">sum</span>(<span class="fu">is.na</span>(<span class="fu">pull</span>(data, {{ var }})))</span>
<span id="cb42-1770"><a href="#cb42-1770" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (na_count <span class="sc">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb42-1771"><a href="#cb42-1771" aria-hidden="true" tabindex="-1"></a>    na_row <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb42-1772"><a href="#cb42-1772" aria-hidden="true" tabindex="-1"></a>      <span class="at">Category =</span> label,</span>
<span id="cb42-1773"><a href="#cb42-1773" aria-hidden="true" tabindex="-1"></a>      <span class="at">Label =</span> <span class="st">"Unknown"</span>,</span>
<span id="cb42-1774"><a href="#cb42-1774" aria-hidden="true" tabindex="-1"></a>      <span class="st">`</span><span class="at">Respiratory vaccines</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">sum</span>(data<span class="sc">$</span>vacc_group3 <span class="sc">==</span> <span class="st">"Respiratory vaccines"</span> <span class="sc">&amp;</span> <span class="fu">is.na</span>(<span class="fu">pull</span>(data, {{ var }})), <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb42-1775"><a href="#cb42-1775" aria-hidden="true" tabindex="-1"></a>      <span class="st">`</span><span class="at">Childhood vaccines</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">sum</span>(data<span class="sc">$</span>vacc_group3 <span class="sc">==</span> <span class="st">"Childhood vaccines"</span> <span class="sc">&amp;</span> <span class="fu">is.na</span>(<span class="fu">pull</span>(data, {{ var }})), <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb42-1776"><a href="#cb42-1776" aria-hidden="true" tabindex="-1"></a>      <span class="at">Other =</span> <span class="fu">sum</span>(data<span class="sc">$</span>vacc_group3 <span class="sc">==</span> <span class="st">"Other"</span> <span class="sc">&amp;</span> <span class="fu">is.na</span>(<span class="fu">pull</span>(data, {{ var }})), <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb42-1777"><a href="#cb42-1777" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb42-1778"><a href="#cb42-1778" aria-hidden="true" tabindex="-1"></a>    tab_combined <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(tab_main, na_row)</span>
<span id="cb42-1779"><a href="#cb42-1779" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb42-1780"><a href="#cb42-1780" aria-hidden="true" tabindex="-1"></a>    tab_combined <span class="ot">&lt;-</span> tab_main</span>
<span id="cb42-1781"><a href="#cb42-1781" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb42-1782"><a href="#cb42-1782" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb42-1783"><a href="#cb42-1783" aria-hidden="true" tabindex="-1"></a>  tab_combined <span class="sc">%&gt;%</span></span>
<span id="cb42-1784"><a href="#cb42-1784" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">use_col_percentage =</span> use_col_percentage)</span>
<span id="cb42-1785"><a href="#cb42-1785" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb42-1786"><a href="#cb42-1786" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-1787"><a href="#cb42-1787" aria-hidden="true" tabindex="-1"></a><span class="co"># --- Step 3: Generate frequency tables for each variable ---</span></span>
<span id="cb42-1788"><a href="#cb42-1788" aria-hidden="true" tabindex="-1"></a>tab_gender    <span class="ot">&lt;-</span> <span class="fu">create_tab</span>(vacc_1524, gender, <span class="st">"Gender"</span>)</span>
<span id="cb42-1789"><a href="#cb42-1789" aria-hidden="true" tabindex="-1"></a>tab_age       <span class="ot">&lt;-</span> <span class="fu">create_tab</span>(vacc_1524, age_3group, <span class="st">"Age group"</span>)</span>
<span id="cb42-1790"><a href="#cb42-1790" aria-hidden="true" tabindex="-1"></a>tab_marital   <span class="ot">&lt;-</span> <span class="fu">create_tab</span>(vacc_1524, marital_2group, <span class="st">"Marital status·µá"</span>)</span>
<span id="cb42-1791"><a href="#cb42-1791" aria-hidden="true" tabindex="-1"></a>tab_year      <span class="ot">&lt;-</span> <span class="fu">create_tab</span>(vacc_1524, year_3group, <span class="st">"Year group"</span>)</span>
<span id="cb42-1792"><a href="#cb42-1792" aria-hidden="true" tabindex="-1"></a>tab_quarter   <span class="ot">&lt;-</span> <span class="fu">create_tab</span>(vacc_1524, vacc_quarter, <span class="st">"Quarter"</span>)</span>
<span id="cb42-1793"><a href="#cb42-1793" aria-hidden="true" tabindex="-1"></a>tab_race      <span class="ot">&lt;-</span> <span class="fu">create_tab</span>(respiratory_vaccines, race_grouped, <span class="st">"Race group"</span>, <span class="at">use_col_percentage =</span> <span class="cn">TRUE</span>)</span>
<span id="cb42-1794"><a href="#cb42-1794" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-1795"><a href="#cb42-1795" aria-hidden="true" tabindex="-1"></a><span class="co"># --- Step 4: Combine all tables ---</span></span>
<span id="cb42-1796"><a href="#cb42-1796" aria-hidden="true" tabindex="-1"></a>tab_combined <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(</span>
<span id="cb42-1797"><a href="#cb42-1797" aria-hidden="true" tabindex="-1"></a>  tab_gender, tab_age, tab_marital,</span>
<span id="cb42-1798"><a href="#cb42-1798" aria-hidden="true" tabindex="-1"></a>  tab_year, tab_quarter, tab_race</span>
<span id="cb42-1799"><a href="#cb42-1799" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb42-1800"><a href="#cb42-1800" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-1801"><a href="#cb42-1801" aria-hidden="true" tabindex="-1"></a><span class="co"># --- Step 5: Calculate percentages and formatted string outputs ---</span></span>
<span id="cb42-1802"><a href="#cb42-1802" aria-hidden="true" tabindex="-1"></a>tab_combined <span class="ot">&lt;-</span> tab_combined <span class="sc">%&gt;%</span></span>
<span id="cb42-1803"><a href="#cb42-1803" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Category) <span class="sc">%&gt;%</span></span>
<span id="cb42-1804"><a href="#cb42-1804" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb42-1805"><a href="#cb42-1805" aria-hidden="true" tabindex="-1"></a>    <span class="at">use_col =</span> <span class="fu">first</span>(use_col_percentage),</span>
<span id="cb42-1806"><a href="#cb42-1806" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb42-1807"><a href="#cb42-1807" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Exclude "Unknown" when calculating column totals to ensure proportions sum to 100</span></span>
<span id="cb42-1808"><a href="#cb42-1808" aria-hidden="true" tabindex="-1"></a>    <span class="at">Total_Resp =</span> <span class="fu">ifelse</span>(use_col, <span class="fu">sum</span>(<span class="st">`</span><span class="at">Respiratory vaccines</span><span class="st">`</span>[Label <span class="sc">!=</span> <span class="st">"Unknown"</span>], <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb42-1809"><a href="#cb42-1809" aria-hidden="true" tabindex="-1"></a>                        <span class="st">`</span><span class="at">Respiratory vaccines</span><span class="st">`</span> <span class="sc">+</span> <span class="st">`</span><span class="at">Childhood vaccines</span><span class="st">`</span> <span class="sc">+</span> Other),</span>
<span id="cb42-1810"><a href="#cb42-1810" aria-hidden="true" tabindex="-1"></a>    <span class="at">Total_Child =</span> <span class="fu">ifelse</span>(use_col, <span class="fu">sum</span>(<span class="st">`</span><span class="at">Childhood vaccines</span><span class="st">`</span>[Label <span class="sc">!=</span> <span class="st">"Unknown"</span>], <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb42-1811"><a href="#cb42-1811" aria-hidden="true" tabindex="-1"></a>                         <span class="st">`</span><span class="at">Respiratory vaccines</span><span class="st">`</span> <span class="sc">+</span> <span class="st">`</span><span class="at">Childhood vaccines</span><span class="st">`</span> <span class="sc">+</span> Other),</span>
<span id="cb42-1812"><a href="#cb42-1812" aria-hidden="true" tabindex="-1"></a>    <span class="at">Total_Other =</span> <span class="fu">ifelse</span>(use_col, <span class="fu">sum</span>(Other[Label <span class="sc">!=</span> <span class="st">"Unknown"</span>], <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb42-1813"><a href="#cb42-1813" aria-hidden="true" tabindex="-1"></a>                         <span class="st">`</span><span class="at">Respiratory vaccines</span><span class="st">`</span> <span class="sc">+</span> <span class="st">`</span><span class="at">Childhood vaccines</span><span class="st">`</span> <span class="sc">+</span> Other),</span>
<span id="cb42-1814"><a href="#cb42-1814" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb42-1815"><a href="#cb42-1815" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Calculate proportions</span></span>
<span id="cb42-1816"><a href="#cb42-1816" aria-hidden="true" tabindex="-1"></a>    <span class="at">Resp_prop =</span> <span class="fu">ifelse</span>(Label <span class="sc">!=</span> <span class="st">"Unknown"</span>, <span class="fu">round</span>(<span class="dv">100</span> <span class="sc">*</span> <span class="st">`</span><span class="at">Respiratory vaccines</span><span class="st">`</span> <span class="sc">/</span> Total_Resp, <span class="dv">1</span>), <span class="cn">NA</span>),</span>
<span id="cb42-1817"><a href="#cb42-1817" aria-hidden="true" tabindex="-1"></a>    <span class="at">Child_prop =</span> <span class="fu">ifelse</span>(Label <span class="sc">!=</span> <span class="st">"Unknown"</span>, <span class="fu">round</span>(<span class="dv">100</span> <span class="sc">*</span> <span class="st">`</span><span class="at">Childhood vaccines</span><span class="st">`</span> <span class="sc">/</span> Total_Child, <span class="dv">1</span>), <span class="cn">NA</span>),</span>
<span id="cb42-1818"><a href="#cb42-1818" aria-hidden="true" tabindex="-1"></a>    <span class="at">Other_prop =</span> <span class="fu">ifelse</span>(Label <span class="sc">!=</span> <span class="st">"Unknown"</span>, <span class="fu">round</span>(<span class="dv">100</span> <span class="sc">*</span> Other <span class="sc">/</span> Total_Other, <span class="dv">1</span>), <span class="cn">NA</span>),</span>
<span id="cb42-1819"><a href="#cb42-1819" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb42-1820"><a href="#cb42-1820" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Format numbers and percentages</span></span>
<span id="cb42-1821"><a href="#cb42-1821" aria-hidden="true" tabindex="-1"></a>    <span class="at">Respiratory =</span> <span class="fu">ifelse</span>(<span class="fu">is.na</span>(Resp_prop),</span>
<span id="cb42-1822"><a href="#cb42-1822" aria-hidden="true" tabindex="-1"></a>                         <span class="fu">paste0</span>(<span class="fu">comma</span>(<span class="st">`</span><span class="at">Respiratory vaccines</span><span class="st">`</span>)),</span>
<span id="cb42-1823"><a href="#cb42-1823" aria-hidden="true" tabindex="-1"></a>                         <span class="fu">paste0</span>(<span class="fu">comma</span>(<span class="st">`</span><span class="at">Respiratory vaccines</span><span class="st">`</span>), <span class="st">" ("</span>, Resp_prop, <span class="st">")"</span>)),</span>
<span id="cb42-1824"><a href="#cb42-1824" aria-hidden="true" tabindex="-1"></a>    <span class="at">Childhood =</span> <span class="fu">ifelse</span>(<span class="fu">is.na</span>(Child_prop),</span>
<span id="cb42-1825"><a href="#cb42-1825" aria-hidden="true" tabindex="-1"></a>                       <span class="fu">paste0</span>(<span class="fu">comma</span>(<span class="st">`</span><span class="at">Childhood vaccines</span><span class="st">`</span>)),</span>
<span id="cb42-1826"><a href="#cb42-1826" aria-hidden="true" tabindex="-1"></a>                       <span class="fu">paste0</span>(<span class="fu">comma</span>(<span class="st">`</span><span class="at">Childhood vaccines</span><span class="st">`</span>), <span class="st">" ("</span>, Child_prop, <span class="st">")"</span>)),</span>
<span id="cb42-1827"><a href="#cb42-1827" aria-hidden="true" tabindex="-1"></a>    <span class="at">Other_grp =</span> <span class="fu">ifelse</span>(<span class="fu">is.na</span>(Other_prop),</span>
<span id="cb42-1828"><a href="#cb42-1828" aria-hidden="true" tabindex="-1"></a>                       <span class="fu">paste0</span>(<span class="fu">comma</span>(Other)),</span>
<span id="cb42-1829"><a href="#cb42-1829" aria-hidden="true" tabindex="-1"></a>                       <span class="fu">paste0</span>(<span class="fu">comma</span>(Other), <span class="st">" ("</span>, Other_prop, <span class="st">")"</span>))</span>
<span id="cb42-1830"><a href="#cb42-1830" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb42-1831"><a href="#cb42-1831" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb42-1832"><a href="#cb42-1832" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-1833"><a href="#cb42-1833" aria-hidden="true" tabindex="-1"></a><span class="co"># --- Step 6: Clean labels and fix formatting for final table ---</span></span>
<span id="cb42-1834"><a href="#cb42-1834" aria-hidden="true" tabindex="-1"></a>tab_combined <span class="ot">&lt;-</span> tab_combined <span class="sc">%&gt;%</span></span>
<span id="cb42-1835"><a href="#cb42-1835" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb42-1836"><a href="#cb42-1836" aria-hidden="true" tabindex="-1"></a>    <span class="at">Label =</span> <span class="fu">ifelse</span>(Label <span class="sc">==</span> <span class="st">"Other"</span>, <span class="st">"Other·∂ú"</span>, Label),</span>
<span id="cb42-1837"><a href="#cb42-1837" aria-hidden="true" tabindex="-1"></a>    <span class="at">Respiratory =</span> <span class="fu">ifelse</span>(Label <span class="sc">==</span> <span class="st">"Unknown"</span> <span class="sc">&amp;</span> <span class="st">`</span><span class="at">Respiratory vaccines</span><span class="st">`</span> <span class="sc">==</span> <span class="dv">0</span>, <span class="st">""</span>, Respiratory),</span>
<span id="cb42-1838"><a href="#cb42-1838" aria-hidden="true" tabindex="-1"></a>    <span class="at">Childhood   =</span> <span class="fu">ifelse</span>(Label <span class="sc">==</span> <span class="st">"Unknown"</span> <span class="sc">&amp;</span> <span class="st">`</span><span class="at">Childhood vaccines</span><span class="st">`</span> <span class="sc">==</span> <span class="dv">0</span>, <span class="st">""</span>, Childhood),</span>
<span id="cb42-1839"><a href="#cb42-1839" aria-hidden="true" tabindex="-1"></a>    <span class="at">Other_grp   =</span> <span class="fu">ifelse</span>(Label <span class="sc">==</span> <span class="st">"Unknown"</span> <span class="sc">&amp;</span> Other <span class="sc">==</span> <span class="dv">0</span>, <span class="st">""</span>, Other_grp)</span>
<span id="cb42-1840"><a href="#cb42-1840" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb42-1841"><a href="#cb42-1841" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Category) <span class="sc">%&gt;%</span></span>
<span id="cb42-1842"><a href="#cb42-1842" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Category =</span> <span class="fu">ifelse</span>(<span class="fu">row_number</span>() <span class="sc">==</span> <span class="dv">1</span>, Category, <span class="st">""</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb42-1843"><a href="#cb42-1843" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb42-1844"><a href="#cb42-1844" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Category, Label, Respiratory, Childhood, Other_grp)</span>
<span id="cb42-1845"><a href="#cb42-1845" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-1846"><a href="#cb42-1846" aria-hidden="true" tabindex="-1"></a><span class="co"># --- Step 7: Calculate group totals for header ---</span></span>
<span id="cb42-1847"><a href="#cb42-1847" aria-hidden="true" tabindex="-1"></a>totals <span class="ot">&lt;-</span> <span class="fu">table</span>(vacc_1524<span class="sc">$</span>vacc_group3)</span>
<span id="cb42-1848"><a href="#cb42-1848" aria-hidden="true" tabindex="-1"></a>total_resp <span class="ot">&lt;-</span> totals[<span class="st">"Respiratory vaccines"</span>]</span>
<span id="cb42-1849"><a href="#cb42-1849" aria-hidden="true" tabindex="-1"></a>total_child <span class="ot">&lt;-</span> totals[<span class="st">"Childhood vaccines"</span>]</span>
<span id="cb42-1850"><a href="#cb42-1850" aria-hidden="true" tabindex="-1"></a>total_other <span class="ot">&lt;-</span> totals[<span class="st">"Other"</span>]</span>
<span id="cb42-1851"><a href="#cb42-1851" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-1852"><a href="#cb42-1852" aria-hidden="true" tabindex="-1"></a><span class="co"># --- Step 8: Create styled summary table using flextable ---</span></span>
<span id="cb42-1853"><a href="#cb42-1853" aria-hidden="true" tabindex="-1"></a>table_vacc_summary <span class="ot">&lt;-</span> <span class="fu">flextable</span>(tab_combined) <span class="sc">%&gt;%</span></span>
<span id="cb42-1854"><a href="#cb42-1854" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_header_labels</span>(</span>
<span id="cb42-1855"><a href="#cb42-1855" aria-hidden="true" tabindex="-1"></a>    <span class="at">Category =</span> <span class="st">"Variable type"</span>,</span>
<span id="cb42-1856"><a href="#cb42-1856" aria-hidden="true" tabindex="-1"></a>    <span class="at">Label =</span> <span class="st">"Values"</span>,</span>
<span id="cb42-1857"><a href="#cb42-1857" aria-hidden="true" tabindex="-1"></a>    <span class="at">Respiratory =</span> <span class="st">"Number (%)·µÉ"</span>,</span>
<span id="cb42-1858"><a href="#cb42-1858" aria-hidden="true" tabindex="-1"></a>    <span class="at">Childhood =</span> <span class="st">"Number (%)·µÉ"</span>,</span>
<span id="cb42-1859"><a href="#cb42-1859" aria-hidden="true" tabindex="-1"></a>    <span class="at">Other_grp =</span> <span class="st">"Number (%)·µÉ"</span></span>
<span id="cb42-1860"><a href="#cb42-1860" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb42-1861"><a href="#cb42-1861" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_header_row</span>(</span>
<span id="cb42-1862"><a href="#cb42-1862" aria-hidden="true" tabindex="-1"></a>    <span class="at">values =</span> <span class="fu">c</span>(<span class="st">""</span>, <span class="st">""</span>,</span>
<span id="cb42-1863"><a href="#cb42-1863" aria-hidden="true" tabindex="-1"></a>               <span class="fu">paste0</span>(<span class="st">"Respiratory vaccines (N = "</span>, <span class="fu">format</span>(total_resp, <span class="at">big.mark =</span> <span class="st">","</span>), <span class="st">")"</span>),</span>
<span id="cb42-1864"><a href="#cb42-1864" aria-hidden="true" tabindex="-1"></a>               <span class="fu">paste0</span>(<span class="st">"Childhood vaccines (N = "</span>, <span class="fu">format</span>(total_child, <span class="at">big.mark =</span> <span class="st">","</span>), <span class="st">")"</span>),</span>
<span id="cb42-1865"><a href="#cb42-1865" aria-hidden="true" tabindex="-1"></a>               <span class="fu">paste0</span>(<span class="st">"Other (N = "</span>, <span class="fu">format</span>(total_other, <span class="at">big.mark =</span> <span class="st">","</span>), <span class="st">")"</span>)),</span>
<span id="cb42-1866"><a href="#cb42-1866" aria-hidden="true" tabindex="-1"></a>    <span class="at">colwidths =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>),</span>
<span id="cb42-1867"><a href="#cb42-1867" aria-hidden="true" tabindex="-1"></a>    <span class="at">top =</span> <span class="cn">TRUE</span></span>
<span id="cb42-1868"><a href="#cb42-1868" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb42-1869"><a href="#cb42-1869" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_header_row</span>(</span>
<span id="cb42-1870"><a href="#cb42-1870" aria-hidden="true" tabindex="-1"></a>    <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"Description"</span>, <span class="st">"Vaccination uptake"</span>),</span>
<span id="cb42-1871"><a href="#cb42-1871" aria-hidden="true" tabindex="-1"></a>    <span class="at">colwidths =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">3</span>),</span>
<span id="cb42-1872"><a href="#cb42-1872" aria-hidden="true" tabindex="-1"></a>    <span class="at">top =</span> <span class="cn">TRUE</span></span>
<span id="cb42-1873"><a href="#cb42-1873" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb42-1874"><a href="#cb42-1874" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_box</span>() <span class="sc">%&gt;%</span></span>
<span id="cb42-1875"><a href="#cb42-1875" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_table_properties</span>(<span class="at">layout =</span> <span class="st">"autofit"</span>, <span class="at">width =</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb42-1876"><a href="#cb42-1876" aria-hidden="true" tabindex="-1"></a>  <span class="fu">width</span>(<span class="at">j =</span> <span class="dv">1</span>, <span class="at">width =</span> <span class="fl">1.5</span>) <span class="sc">%&gt;%</span></span>
<span id="cb42-1877"><a href="#cb42-1877" aria-hidden="true" tabindex="-1"></a>  <span class="fu">width</span>(<span class="at">j =</span> <span class="dv">2</span>, <span class="at">width =</span> <span class="fl">2.5</span>) <span class="sc">%&gt;%</span></span>
<span id="cb42-1878"><a href="#cb42-1878" aria-hidden="true" tabindex="-1"></a>  <span class="fu">width</span>(<span class="at">j =</span> <span class="dv">3</span><span class="sc">:</span><span class="dv">5</span>, <span class="at">width =</span> <span class="fl">1.5</span>) <span class="sc">%&gt;%</span></span>
<span id="cb42-1879"><a href="#cb42-1879" aria-hidden="true" tabindex="-1"></a>  <span class="fu">align</span>(<span class="at">align =</span> <span class="st">"justify"</span>, <span class="at">part =</span> <span class="st">"all"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb42-1880"><a href="#cb42-1880" aria-hidden="true" tabindex="-1"></a>  <span class="fu">border_remove</span>() <span class="sc">%&gt;%</span></span>
<span id="cb42-1881"><a href="#cb42-1881" aria-hidden="true" tabindex="-1"></a>  <span class="fu">border</span>(<span class="at">part =</span> <span class="st">"header"</span>, <span class="at">i =</span> <span class="dv">1</span>, <span class="at">border.top =</span> <span class="fu">fp_border</span>(<span class="at">color =</span> <span class="st">"black"</span>, <span class="at">width =</span> <span class="dv">1</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb42-1882"><a href="#cb42-1882" aria-hidden="true" tabindex="-1"></a>  <span class="fu">border</span>(<span class="at">part =</span> <span class="st">"header"</span>, <span class="at">i =</span> <span class="dv">3</span>, <span class="at">border.bottom =</span> <span class="fu">fp_border</span>(<span class="at">color =</span> <span class="st">"black"</span>, <span class="at">width =</span> <span class="dv">1</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb42-1883"><a href="#cb42-1883" aria-hidden="true" tabindex="-1"></a>  <span class="fu">border_inner_h</span>(<span class="at">part =</span> <span class="st">"header"</span>, <span class="at">border =</span> <span class="fu">fp_border</span>(<span class="at">color =</span> <span class="st">"black"</span>, <span class="at">width =</span> <span class="fl">0.8</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb42-1884"><a href="#cb42-1884" aria-hidden="true" tabindex="-1"></a>  <span class="fu">border_inner_h</span>(<span class="at">part =</span> <span class="st">"body"</span>, <span class="at">border =</span> <span class="fu">fp_border</span>(<span class="at">color =</span> <span class="st">"black"</span>, <span class="at">width =</span> <span class="fl">0.8</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb42-1885"><a href="#cb42-1885" aria-hidden="true" tabindex="-1"></a>  <span class="fu">border</span>(<span class="at">part =</span> <span class="st">"body"</span>, <span class="at">i =</span> <span class="fu">nrow</span>(tab_combined), <span class="at">border.bottom =</span> <span class="fu">fp_border</span>(<span class="at">color =</span> <span class="st">"black"</span>, <span class="at">width =</span> <span class="dv">1</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb42-1886"><a href="#cb42-1886" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_caption</span>(<span class="fu">as_paragraph</span>(<span class="fu">as_chunk</span>(</span>
<span id="cb42-1887"><a href="#cb42-1887" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Table xx: Vaccination uptake by demographic, temporal, and race variables, 2015‚Äì2024."</span>,</span>
<span id="cb42-1888"><a href="#cb42-1888" aria-hidden="true" tabindex="-1"></a>    <span class="at">props =</span> <span class="fu">fp_text</span>(<span class="at">font.size =</span> <span class="dv">12</span>, <span class="at">font.family =</span> <span class="st">"Times New Roman"</span>, <span class="at">bold =</span> <span class="cn">FALSE</span>)</span>
<span id="cb42-1889"><a href="#cb42-1889" aria-hidden="true" tabindex="-1"></a>  ))) <span class="sc">%&gt;%</span></span>
<span id="cb42-1890"><a href="#cb42-1890" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_footer_lines</span>(<span class="at">values =</span> <span class="fu">c</span>(</span>
<span id="cb42-1891"><a href="#cb42-1891" aria-hidden="true" tabindex="-1"></a>    <span class="st">"·µÉ Vaccination proportions were calculated per row (row percentage) except for race group which used column percentages."</span>,</span>
<span id="cb42-1892"><a href="#cb42-1892" aria-hidden="true" tabindex="-1"></a>    <span class="st">"·µá Marital status was grouped into two: partnered for those married and non-partnered for those divorced, widowed or single."</span>,</span>
<span id="cb42-1893"><a href="#cb42-1893" aria-hidden="true" tabindex="-1"></a>    <span class="st">"·∂ú Other race refers to those who identify as native or other racial groups."</span></span>
<span id="cb42-1894"><a href="#cb42-1894" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">%&gt;%</span></span>
<span id="cb42-1895"><a href="#cb42-1895" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fontsize</span>(<span class="at">part =</span> <span class="st">"header"</span>, <span class="at">size =</span> <span class="dv">12</span>) <span class="sc">%&gt;%</span></span>
<span id="cb42-1896"><a href="#cb42-1896" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fontsize</span>(<span class="at">part =</span> <span class="st">"body"</span>, <span class="at">size =</span> <span class="dv">11</span>) <span class="sc">%&gt;%</span></span>
<span id="cb42-1897"><a href="#cb42-1897" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fontsize</span>(<span class="at">part =</span> <span class="st">"footer"</span>, <span class="at">size =</span> <span class="dv">10</span>) <span class="sc">%&gt;%</span></span>
<span id="cb42-1898"><a href="#cb42-1898" aria-hidden="true" tabindex="-1"></a>  <span class="fu">font</span>(<span class="at">part =</span> <span class="st">"all"</span>, <span class="at">fontname =</span> <span class="st">"Times New Roman"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb42-1899"><a href="#cb42-1899" aria-hidden="true" tabindex="-1"></a>  <span class="fu">color</span>(<span class="at">part =</span> <span class="st">"header"</span>, <span class="at">color =</span> <span class="st">"white"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb42-1900"><a href="#cb42-1900" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bg</span>(<span class="at">part =</span> <span class="st">"header"</span>, <span class="at">bg =</span> <span class="st">"black"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb42-1901"><a href="#cb42-1901" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bg</span>(<span class="at">j =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>, <span class="at">i =</span> <span class="fu">seq</span>(<span class="dv">2</span>, <span class="fu">nrow</span>(tab_combined), <span class="dv">2</span>), <span class="at">bg =</span> <span class="st">"white"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb42-1902"><a href="#cb42-1902" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bold</span>(<span class="at">j =</span> <span class="dv">1</span>, <span class="at">part =</span> <span class="st">"body"</span>)</span>
<span id="cb42-1903"><a href="#cb42-1903" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-1904"><a href="#cb42-1904" aria-hidden="true" tabindex="-1"></a><span class="co"># --- Step 9: Display table ---</span></span>
<span id="cb42-1905"><a href="#cb42-1905" aria-hidden="true" tabindex="-1"></a>table_vacc_summary</span>
<span id="cb42-1906"><a href="#cb42-1906" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-1907"><a href="#cb42-1907" aria-hidden="true" tabindex="-1"></a><span class="co"># --- Step 10: Clean up temporary objects (optional) ---</span></span>
<span id="cb42-1908"><a href="#cb42-1908" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(</span>
<span id="cb42-1909"><a href="#cb42-1909" aria-hidden="true" tabindex="-1"></a>  tab_gender, tab_age, tab_marital, tab_year, tab_quarter, tab_race,</span>
<span id="cb42-1910"><a href="#cb42-1910" aria-hidden="true" tabindex="-1"></a>  tab_combined, create_tab, respiratory_vaccines,</span>
<span id="cb42-1911"><a href="#cb42-1911" aria-hidden="true" tabindex="-1"></a>  totals, total_resp, total_child, total_other</span>
<span id="cb42-1912"><a href="#cb42-1912" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb42-1913"><a href="#cb42-1913" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-1914"><a href="#cb42-1914" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb42-1915"><a href="#cb42-1915" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-1916"><a href="#cb42-1916" aria-hidden="true" tabindex="-1"></a><span class="fu">## **13. Multiple Response Tables ‚Äì Rowwise Percentage**</span></span>
<span id="cb42-1917"><a href="#cb42-1917" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-1918"><a href="#cb42-1918" aria-hidden="true" tabindex="-1"></a>Here we simulate **multiple-response tables** by combining summary outputs from different variables side-by-side.</span>
<span id="cb42-1919"><a href="#cb42-1919" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-1920"><a href="#cb42-1920" aria-hidden="true" tabindex="-1"></a>üìö *What‚Äôs useful here?*</span>
<span id="cb42-1921"><a href="#cb42-1921" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-1922"><a href="#cb42-1922" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Shows how people responded with combinations of vaccine types (e.g., Both, Influenza, or None), where both here refers vaccination of influenza and other vaccine types.</span>
<span id="cb42-1923"><a href="#cb42-1923" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-1924"><a href="#cb42-1924" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>üôå *Applies to*: Any analysis involving response overlaps (e.g., co-morbidity, multiple treatments, combined exposures).</span>
<span id="cb42-1925"><a href="#cb42-1925" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-1928"><a href="#cb42-1928" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb42-1929"><a href="#cb42-1929" aria-hidden="true" tabindex="-1"></a><span class="co"># ------------ 10. Mutiple Response Tables: via appending: Rowwise -------------------------------------------</span></span>
<span id="cb42-1930"><a href="#cb42-1930" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-1931"><a href="#cb42-1931" aria-hidden="true" tabindex="-1"></a><span class="co"># .................. Create flextable summary by variable ..................</span></span>
<span id="cb42-1932"><a href="#cb42-1932" aria-hidden="true" tabindex="-1"></a>process_variable <span class="ot">&lt;-</span> <span class="cf">function</span>(data, group_var, group_label) {</span>
<span id="cb42-1933"><a href="#cb42-1933" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb42-1934"><a href="#cb42-1934" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Base pattern: Both and No</span></span>
<span id="cb42-1935"><a href="#cb42-1935" aria-hidden="true" tabindex="-1"></a>  df_base <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span></span>
<span id="cb42-1936"><a href="#cb42-1936" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(<span class="fu">across</span>(<span class="fu">all_of</span>(group_var)), vacc_pattern) <span class="sc">%&gt;%</span></span>
<span id="cb42-1937"><a href="#cb42-1937" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarise</span>(<span class="at">count =</span> <span class="fu">n</span>(), <span class="at">.groups =</span> <span class="st">"drop"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb42-1938"><a href="#cb42-1938" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(<span class="fu">across</span>(<span class="fu">all_of</span>(group_var))) <span class="sc">%&gt;%</span></span>
<span id="cb42-1939"><a href="#cb42-1939" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">total =</span> <span class="fu">sum</span>(count),</span>
<span id="cb42-1940"><a href="#cb42-1940" aria-hidden="true" tabindex="-1"></a>           <span class="at">proportion =</span> <span class="fu">round</span>((count <span class="sc">/</span> total) <span class="sc">*</span> <span class="dv">100</span>, <span class="dv">1</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb42-1941"><a href="#cb42-1941" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb42-1942"><a href="#cb42-1942" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(vacc_pattern <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"Both"</span>, <span class="st">"No"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb42-1943"><a href="#cb42-1943" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rename</span>(<span class="at">value =</span> <span class="sc">!!</span><span class="fu">sym</span>(group_var)) <span class="sc">%&gt;%</span></span>
<span id="cb42-1944"><a href="#cb42-1944" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">value =</span> <span class="fu">as.character</span>(value))</span>
<span id="cb42-1945"><a href="#cb42-1945" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb42-1946"><a href="#cb42-1946" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Influenza </span></span>
<span id="cb42-1947"><a href="#cb42-1947" aria-hidden="true" tabindex="-1"></a>  df_flu <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span></span>
<span id="cb42-1948"><a href="#cb42-1948" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(<span class="sc">!!</span><span class="fu">sym</span>(group_var))) <span class="sc">%&gt;%</span></span>
<span id="cb42-1949"><a href="#cb42-1949" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">flu_yes =</span> <span class="fu">recode</span>(flu_yes, <span class="st">"Yes"</span> <span class="ot">=</span> <span class="st">"Influenza"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb42-1950"><a href="#cb42-1950" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(<span class="fu">across</span>(<span class="fu">all_of</span>(group_var)), flu_yes) <span class="sc">%&gt;%</span></span>
<span id="cb42-1951"><a href="#cb42-1951" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarise</span>(<span class="at">count =</span> <span class="fu">n</span>(), <span class="at">.groups =</span> <span class="st">"drop"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb42-1952"><a href="#cb42-1952" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(<span class="fu">across</span>(<span class="fu">all_of</span>(group_var))) <span class="sc">%&gt;%</span></span>
<span id="cb42-1953"><a href="#cb42-1953" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">total =</span> <span class="fu">sum</span>(count),</span>
<span id="cb42-1954"><a href="#cb42-1954" aria-hidden="true" tabindex="-1"></a>           <span class="at">proportion =</span> <span class="fu">round</span>((count <span class="sc">/</span> total) <span class="sc">*</span> <span class="dv">100</span>, <span class="dv">1</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb42-1955"><a href="#cb42-1955" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb42-1956"><a href="#cb42-1956" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(flu_yes <span class="sc">==</span> <span class="st">"Influenza"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb42-1957"><a href="#cb42-1957" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rename</span>(<span class="at">vacc_pattern =</span> flu_yes, <span class="at">value =</span> <span class="sc">!!</span><span class="fu">sym</span>(group_var)) <span class="sc">%&gt;%</span></span>
<span id="cb42-1958"><a href="#cb42-1958" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">value =</span> <span class="fu">as.character</span>(value))</span>
<span id="cb42-1959"><a href="#cb42-1959" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb42-1960"><a href="#cb42-1960" aria-hidden="true" tabindex="-1"></a>  df_combined <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(df_base, df_flu) <span class="sc">%&gt;%</span></span>
<span id="cb42-1961"><a href="#cb42-1961" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">vacc_pattern =</span> <span class="fu">factor</span>(vacc_pattern, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"Both"</span>, <span class="st">"Influenza"</span>, <span class="st">"No"</span>)))</span>
<span id="cb42-1962"><a href="#cb42-1962" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb42-1963"><a href="#cb42-1963" aria-hidden="true" tabindex="-1"></a>  df_wide <span class="ot">&lt;-</span> df_combined <span class="sc">%&gt;%</span></span>
<span id="cb42-1964"><a href="#cb42-1964" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(value, vacc_pattern, count, proportion) <span class="sc">%&gt;%</span></span>
<span id="cb42-1965"><a href="#cb42-1965" aria-hidden="true" tabindex="-1"></a>    <span class="fu">pivot_wider</span>(</span>
<span id="cb42-1966"><a href="#cb42-1966" aria-hidden="true" tabindex="-1"></a>      <span class="at">names_from =</span> vacc_pattern,</span>
<span id="cb42-1967"><a href="#cb42-1967" aria-hidden="true" tabindex="-1"></a>      <span class="at">values_from =</span> <span class="fu">c</span>(count, proportion),</span>
<span id="cb42-1968"><a href="#cb42-1968" aria-hidden="true" tabindex="-1"></a>      <span class="at">values_fn =</span> <span class="fu">list</span>(<span class="at">count =</span> sum, <span class="at">proportion =</span> sum),</span>
<span id="cb42-1969"><a href="#cb42-1969" aria-hidden="true" tabindex="-1"></a>      <span class="at">values_fill =</span> <span class="fu">list</span>(<span class="at">count =</span> <span class="dv">0</span>, <span class="at">proportion =</span> <span class="dv">0</span>)</span>
<span id="cb42-1970"><a href="#cb42-1970" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span></span>
<span id="cb42-1971"><a href="#cb42-1971" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(</span>
<span id="cb42-1972"><a href="#cb42-1972" aria-hidden="true" tabindex="-1"></a>      <span class="at">Both =</span> <span class="fu">paste0</span>(<span class="fu">comma</span>(<span class="st">`</span><span class="at">count_Both</span><span class="st">`</span>), <span class="st">" ("</span>, <span class="st">`</span><span class="at">proportion_Both</span><span class="st">`</span>, <span class="st">")"</span>),</span>
<span id="cb42-1973"><a href="#cb42-1973" aria-hidden="true" tabindex="-1"></a>      <span class="st">`</span><span class="at">Influenza only</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">paste0</span>(<span class="fu">comma</span>(<span class="st">`</span><span class="at">count_Influenza</span><span class="st">`</span>), <span class="st">" ("</span>, <span class="st">`</span><span class="at">proportion_Influenza</span><span class="st">`</span>, <span class="st">")"</span>),</span>
<span id="cb42-1974"><a href="#cb42-1974" aria-hidden="true" tabindex="-1"></a>      <span class="at">No =</span> <span class="fu">paste0</span>(<span class="fu">comma</span>(<span class="st">`</span><span class="at">count_No</span><span class="st">`</span>), <span class="st">" ("</span>, <span class="st">`</span><span class="at">proportion_No</span><span class="st">`</span>, <span class="st">")"</span>),</span>
<span id="cb42-1975"><a href="#cb42-1975" aria-hidden="true" tabindex="-1"></a>      <span class="at">Variable =</span> group_label</span>
<span id="cb42-1976"><a href="#cb42-1976" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span></span>
<span id="cb42-1977"><a href="#cb42-1977" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(value, Both, <span class="st">`</span><span class="at">Influenza only</span><span class="st">`</span>, No, Variable)</span>
<span id="cb42-1978"><a href="#cb42-1978" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb42-1979"><a href="#cb42-1979" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(df_wide)</span>
<span id="cb42-1980"><a href="#cb42-1980" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb42-1981"><a href="#cb42-1981" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-1982"><a href="#cb42-1982" aria-hidden="true" tabindex="-1"></a><span class="co"># Run for selected grouping variables</span></span>
<span id="cb42-1983"><a href="#cb42-1983" aria-hidden="true" tabindex="-1"></a>df_year <span class="ot">&lt;-</span> <span class="fu">process_variable</span>(vacc_1524, <span class="st">"vacc_service_year"</span>, <span class="st">"Service year"</span>)</span>
<span id="cb42-1984"><a href="#cb42-1984" aria-hidden="true" tabindex="-1"></a>df_age <span class="ot">&lt;-</span> <span class="fu">process_variable</span>(vacc_1524, <span class="st">"age_group"</span>, <span class="st">"Age group"</span>)</span>
<span id="cb42-1985"><a href="#cb42-1985" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-1986"><a href="#cb42-1986" aria-hidden="true" tabindex="-1"></a><span class="co"># Combine and format for flextable</span></span>
<span id="cb42-1987"><a href="#cb42-1987" aria-hidden="true" tabindex="-1"></a>df_combined_long <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(df_year, df_age) <span class="sc">%&gt;%</span></span>
<span id="cb42-1988"><a href="#cb42-1988" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">Value =</span> value) <span class="sc">%&gt;%</span></span>
<span id="cb42-1989"><a href="#cb42-1989" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Variable, Value, Both, <span class="st">`</span><span class="at">Influenza only</span><span class="st">`</span>, No) <span class="sc">%&gt;%</span></span>
<span id="cb42-1990"><a href="#cb42-1990" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Variable) <span class="sc">%&gt;%</span></span>
<span id="cb42-1991"><a href="#cb42-1991" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Variable =</span> <span class="fu">ifelse</span>(<span class="fu">row_number</span>() <span class="sc">==</span> <span class="dv">1</span>, Variable, <span class="st">""</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb42-1992"><a href="#cb42-1992" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb42-1993"><a href="#cb42-1993" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-1994"><a href="#cb42-1994" aria-hidden="true" tabindex="-1"></a><span class="co"># Create flextable</span></span>
<span id="cb42-1995"><a href="#cb42-1995" aria-hidden="true" tabindex="-1"></a>final_table <span class="ot">&lt;-</span> <span class="fu">flextable</span>(df_combined_long) <span class="sc">%&gt;%</span></span>
<span id="cb42-1996"><a href="#cb42-1996" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_header_labels</span>(</span>
<span id="cb42-1997"><a href="#cb42-1997" aria-hidden="true" tabindex="-1"></a>    <span class="at">Variable =</span> <span class="st">"Variable"</span>,</span>
<span id="cb42-1998"><a href="#cb42-1998" aria-hidden="true" tabindex="-1"></a>    <span class="at">Value =</span> <span class="st">"Value"</span>,</span>
<span id="cb42-1999"><a href="#cb42-1999" aria-hidden="true" tabindex="-1"></a>    <span class="at">Both =</span> <span class="st">"Both (%)"</span>,</span>
<span id="cb42-2000"><a href="#cb42-2000" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">Influenza only</span><span class="st">`</span> <span class="ot">=</span> <span class="st">"Influenza (%)"</span>,</span>
<span id="cb42-2001"><a href="#cb42-2001" aria-hidden="true" tabindex="-1"></a>    <span class="at">No =</span> <span class="st">"No (%)"</span></span>
<span id="cb42-2002"><a href="#cb42-2002" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb42-2003"><a href="#cb42-2003" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_header_row</span>(</span>
<span id="cb42-2004"><a href="#cb42-2004" aria-hidden="true" tabindex="-1"></a>    <span class="at">values =</span> <span class="fu">c</span>(<span class="st">" "</span>, <span class="st">" "</span>, <span class="st">"Vaccination pattern·µÉ"</span>),</span>
<span id="cb42-2005"><a href="#cb42-2005" aria-hidden="true" tabindex="-1"></a>    <span class="at">colwidths =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">3</span>)</span>
<span id="cb42-2006"><a href="#cb42-2006" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb42-2007"><a href="#cb42-2007" aria-hidden="true" tabindex="-1"></a>  <span class="fu">align</span>(<span class="at">align =</span> <span class="st">"justify"</span>, <span class="at">part =</span> <span class="st">"all"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb42-2008"><a href="#cb42-2008" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bold</span>(<span class="at">part =</span> <span class="st">"header"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb42-2009"><a href="#cb42-2009" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bold</span>(<span class="at">i =</span> <span class="dv">1</span>, <span class="at">part =</span> <span class="st">"body"</span>, <span class="at">j =</span> <span class="st">"Variable"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb42-2010"><a href="#cb42-2010" aria-hidden="true" tabindex="-1"></a> <span class="fu">border_remove</span>() <span class="sc">%&gt;%</span></span>
<span id="cb42-2011"><a href="#cb42-2011" aria-hidden="true" tabindex="-1"></a>  <span class="fu">border_inner_h</span>(<span class="at">border =</span> <span class="fu">fp_border</span>(<span class="at">color =</span> <span class="st">"black"</span>, <span class="at">width =</span> <span class="dv">1</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb42-2012"><a href="#cb42-2012" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb42-2013"><a href="#cb42-2013" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_header_lines</span>(<span class="at">values =</span> <span class="st">"Table xx: Vaccination uptake pattern, 2015‚Äì2024."</span>) <span class="sc">%&gt;%</span></span>
<span id="cb42-2014"><a href="#cb42-2014" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_footer_lines</span>(<span class="at">values =</span> <span class="fu">c</span>(</span>
<span id="cb42-2015"><a href="#cb42-2015" aria-hidden="true" tabindex="-1"></a>    <span class="st">"·µÉ The pattern reflects those with influenza vaccination history, influenza, or both."</span></span>
<span id="cb42-2016"><a href="#cb42-2016" aria-hidden="true" tabindex="-1"></a>  ))</span>
<span id="cb42-2017"><a href="#cb42-2017" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-2018"><a href="#cb42-2018" aria-hidden="true" tabindex="-1"></a><span class="co"># Display table</span></span>
<span id="cb42-2019"><a href="#cb42-2019" aria-hidden="true" tabindex="-1"></a>final_table</span>
<span id="cb42-2020"><a href="#cb42-2020" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-2021"><a href="#cb42-2021" aria-hidden="true" tabindex="-1"></a><span class="co"># .................. Clean up ..................</span></span>
<span id="cb42-2022"><a href="#cb42-2022" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(df_year, df_age, df_combined_long, process_variable, final_table)</span>
<span id="cb42-2023"><a href="#cb42-2023" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-2024"><a href="#cb42-2024" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb42-2025"><a href="#cb42-2025" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-2026"><a href="#cb42-2026" aria-hidden="true" tabindex="-1"></a><span class="fu">## **14. Multiple Response Tables ‚Äì Columnwise Percentages**</span></span>
<span id="cb42-2027"><a href="#cb42-2027" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-2028"><a href="#cb42-2028" aria-hidden="true" tabindex="-1"></a>Similar to the rowwise example, this version presents the **column percentages** of multiple responses.</span>
<span id="cb42-2029"><a href="#cb42-2029" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-2030"><a href="#cb42-2030" aria-hidden="true" tabindex="-1"></a>üßæ *Key advantage*: Allows side-by-side comparison of proportions within each vaccine group across multiple demographics.</span>
<span id="cb42-2031"><a href="#cb42-2031" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-2032"><a href="#cb42-2032" aria-hidden="true" tabindex="-1"></a>üíº *Common in*: Survey analysis, patient preference studies, behavioral research.</span>
<span id="cb42-2033"><a href="#cb42-2033" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-2036"><a href="#cb42-2036" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb42-2037"><a href="#cb42-2037" aria-hidden="true" tabindex="-1"></a><span class="co"># ------------ 11. Mutiple Response Tables: via appending: Columnwise -------------------------------------------</span></span>
<span id="cb42-2038"><a href="#cb42-2038" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-2039"><a href="#cb42-2039" aria-hidden="true" tabindex="-1"></a><span class="co"># .................. Convert grouping vars to character ..................</span></span>
<span id="cb42-2040"><a href="#cb42-2040" aria-hidden="true" tabindex="-1"></a>vacc_1524 <span class="ot">&lt;-</span> vacc_1524 <span class="sc">%&gt;%</span></span>
<span id="cb42-2041"><a href="#cb42-2041" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">c</span>(age_group, gender, marital_status,</span>
<span id="cb42-2042"><a href="#cb42-2042" aria-hidden="true" tabindex="-1"></a>                  vacc_service_year, vacc_quarter, vacc_weekday), as.character))</span>
<span id="cb42-2043"><a href="#cb42-2043" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-2044"><a href="#cb42-2044" aria-hidden="true" tabindex="-1"></a><span class="co"># .................. Table generation function (column-wise %) ..................</span></span>
<span id="cb42-2045"><a href="#cb42-2045" aria-hidden="true" tabindex="-1"></a>create_tab <span class="ot">&lt;-</span> <span class="cf">function</span>(data, var, label) {</span>
<span id="cb42-2046"><a href="#cb42-2046" aria-hidden="true" tabindex="-1"></a>  tab_main <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span></span>
<span id="cb42-2047"><a href="#cb42-2047" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>({{ var }})) <span class="sc">%&gt;%</span></span>
<span id="cb42-2048"><a href="#cb42-2048" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tabyl</span>({{ var }}, vacc_group3) <span class="sc">%&gt;%</span></span>
<span id="cb42-2049"><a href="#cb42-2049" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">Category =</span> label, <span class="at">.before =</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb42-2050"><a href="#cb42-2050" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rename</span>(<span class="at">Label =</span> {{ var }}) <span class="sc">%&gt;%</span></span>
<span id="cb42-2051"><a href="#cb42-2051" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">Label =</span> <span class="fu">as.character</span>(Label))</span>
<span id="cb42-2052"><a href="#cb42-2052" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb42-2053"><a href="#cb42-2053" aria-hidden="true" tabindex="-1"></a>  na_count <span class="ot">&lt;-</span> <span class="fu">sum</span>(<span class="fu">is.na</span>(<span class="fu">pull</span>(data, {{ var }})))</span>
<span id="cb42-2054"><a href="#cb42-2054" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb42-2055"><a href="#cb42-2055" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (na_count <span class="sc">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb42-2056"><a href="#cb42-2056" aria-hidden="true" tabindex="-1"></a>    missing_row <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb42-2057"><a href="#cb42-2057" aria-hidden="true" tabindex="-1"></a>      <span class="at">Category =</span> label,</span>
<span id="cb42-2058"><a href="#cb42-2058" aria-hidden="true" tabindex="-1"></a>      <span class="at">Label =</span> <span class="st">"Missing"</span>,</span>
<span id="cb42-2059"><a href="#cb42-2059" aria-hidden="true" tabindex="-1"></a>      <span class="st">`</span><span class="at">Respiratory vaccines</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">sum</span>(data<span class="sc">$</span>vacc_group3 <span class="sc">==</span> <span class="st">"Respiratory vaccines"</span> <span class="sc">&amp;</span> <span class="fu">is.na</span>(<span class="fu">pull</span>(data, {{ var }})), <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb42-2060"><a href="#cb42-2060" aria-hidden="true" tabindex="-1"></a>      <span class="st">`</span><span class="at">Childhood vaccines</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">sum</span>(data<span class="sc">$</span>vacc_group3 <span class="sc">==</span> <span class="st">"Childhood vaccines"</span> <span class="sc">&amp;</span> <span class="fu">is.na</span>(<span class="fu">pull</span>(data, {{ var }})), <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb42-2061"><a href="#cb42-2061" aria-hidden="true" tabindex="-1"></a>      <span class="at">Other =</span> <span class="fu">sum</span>(data<span class="sc">$</span>vacc_group3 <span class="sc">==</span> <span class="st">"Other"</span> <span class="sc">&amp;</span> <span class="fu">is.na</span>(<span class="fu">pull</span>(data, {{ var }})), <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb42-2062"><a href="#cb42-2062" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb42-2063"><a href="#cb42-2063" aria-hidden="true" tabindex="-1"></a>    tab_final <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(tab_main, missing_row)</span>
<span id="cb42-2064"><a href="#cb42-2064" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb42-2065"><a href="#cb42-2065" aria-hidden="true" tabindex="-1"></a>    tab_final <span class="ot">&lt;-</span> tab_main</span>
<span id="cb42-2066"><a href="#cb42-2066" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb42-2067"><a href="#cb42-2067" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb42-2068"><a href="#cb42-2068" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(tab_final)</span>
<span id="cb42-2069"><a href="#cb42-2069" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb42-2070"><a href="#cb42-2070" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-2071"><a href="#cb42-2071" aria-hidden="true" tabindex="-1"></a><span class="co"># .................. Create summary tables ..................</span></span>
<span id="cb42-2072"><a href="#cb42-2072" aria-hidden="true" tabindex="-1"></a>tab_age            <span class="ot">&lt;-</span> <span class="fu">create_tab</span>(vacc_1524, age_group, <span class="st">"Age"</span>)</span>
<span id="cb42-2073"><a href="#cb42-2073" aria-hidden="true" tabindex="-1"></a>tab_sex            <span class="ot">&lt;-</span> <span class="fu">create_tab</span>(vacc_1524, gender, <span class="st">"Gender"</span>)</span>
<span id="cb42-2074"><a href="#cb42-2074" aria-hidden="true" tabindex="-1"></a>tab_marital_status <span class="ot">&lt;-</span> <span class="fu">create_tab</span>(vacc_1524, marital_status, <span class="st">"Marital status"</span>)</span>
<span id="cb42-2075"><a href="#cb42-2075" aria-hidden="true" tabindex="-1"></a>tab_year           <span class="ot">&lt;-</span> <span class="fu">create_tab</span>(vacc_1524, vacc_service_year, <span class="st">"Year"</span>)</span>
<span id="cb42-2076"><a href="#cb42-2076" aria-hidden="true" tabindex="-1"></a>tab_quarter        <span class="ot">&lt;-</span> <span class="fu">create_tab</span>(vacc_1524, vacc_quarter, <span class="st">"Quarter"</span>)</span>
<span id="cb42-2077"><a href="#cb42-2077" aria-hidden="true" tabindex="-1"></a>tab_weekday        <span class="ot">&lt;-</span> <span class="fu">create_tab</span>(vacc_1524, vacc_weekday, <span class="st">"Weekday"</span>)</span>
<span id="cb42-2078"><a href="#cb42-2078" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-2079"><a href="#cb42-2079" aria-hidden="true" tabindex="-1"></a><span class="co"># .................. Combine all tables ..................</span></span>
<span id="cb42-2080"><a href="#cb42-2080" aria-hidden="true" tabindex="-1"></a>tab_combined <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(tab_sex, tab_age, tab_marital_status, tab_year, tab_quarter, tab_weekday)</span>
<span id="cb42-2081"><a href="#cb42-2081" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-2082"><a href="#cb42-2082" aria-hidden="true" tabindex="-1"></a><span class="co"># .................. Calculate column-wise percentages within each Category group ..................</span></span>
<span id="cb42-2083"><a href="#cb42-2083" aria-hidden="true" tabindex="-1"></a>tab_combined <span class="ot">&lt;-</span> tab_combined <span class="sc">%&gt;%</span></span>
<span id="cb42-2084"><a href="#cb42-2084" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Category) <span class="sc">%&gt;%</span></span>
<span id="cb42-2085"><a href="#cb42-2085" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb42-2086"><a href="#cb42-2086" aria-hidden="true" tabindex="-1"></a>    <span class="at">Total_Resp =</span> <span class="fu">sum</span>(<span class="st">`</span><span class="at">Respiratory vaccines</span><span class="st">`</span>[Label <span class="sc">!=</span> <span class="st">"Missing"</span>], <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb42-2087"><a href="#cb42-2087" aria-hidden="true" tabindex="-1"></a>    <span class="at">Total_Child =</span> <span class="fu">sum</span>(<span class="st">`</span><span class="at">Childhood vaccines</span><span class="st">`</span>[Label <span class="sc">!=</span> <span class="st">"Missing"</span>], <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb42-2088"><a href="#cb42-2088" aria-hidden="true" tabindex="-1"></a>    <span class="at">Total_Other =</span> <span class="fu">sum</span>(Other[Label <span class="sc">!=</span> <span class="st">"Missing"</span>], <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb42-2089"><a href="#cb42-2089" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb42-2090"><a href="#cb42-2090" aria-hidden="true" tabindex="-1"></a>    <span class="at">is_missing =</span> <span class="fu">trimws</span>(<span class="fu">tolower</span>(Label)) <span class="sc">==</span> <span class="st">"missing"</span>,</span>
<span id="cb42-2091"><a href="#cb42-2091" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb42-2092"><a href="#cb42-2092" aria-hidden="true" tabindex="-1"></a>    <span class="at">Respiratory =</span> <span class="fu">ifelse</span>(is_missing,</span>
<span id="cb42-2093"><a href="#cb42-2093" aria-hidden="true" tabindex="-1"></a>                         <span class="fu">comma</span>(<span class="st">`</span><span class="at">Respiratory vaccines</span><span class="st">`</span>),</span>
<span id="cb42-2094"><a href="#cb42-2094" aria-hidden="true" tabindex="-1"></a>                         <span class="fu">paste0</span>(<span class="fu">comma</span>(<span class="st">`</span><span class="at">Respiratory vaccines</span><span class="st">`</span>), <span class="st">" ("</span>, <span class="fu">round</span>(<span class="dv">100</span> <span class="sc">*</span> <span class="st">`</span><span class="at">Respiratory vaccines</span><span class="st">`</span> <span class="sc">/</span> Total_Resp, <span class="dv">1</span>), <span class="st">"%)"</span>)),</span>
<span id="cb42-2095"><a href="#cb42-2095" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb42-2096"><a href="#cb42-2096" aria-hidden="true" tabindex="-1"></a>    <span class="at">Childhood =</span> <span class="fu">ifelse</span>(is_missing,</span>
<span id="cb42-2097"><a href="#cb42-2097" aria-hidden="true" tabindex="-1"></a>                       <span class="fu">comma</span>(<span class="st">`</span><span class="at">Childhood vaccines</span><span class="st">`</span>),</span>
<span id="cb42-2098"><a href="#cb42-2098" aria-hidden="true" tabindex="-1"></a>                       <span class="fu">paste0</span>(<span class="fu">comma</span>(<span class="st">`</span><span class="at">Childhood vaccines</span><span class="st">`</span>), <span class="st">" ("</span>, <span class="fu">round</span>(<span class="dv">100</span> <span class="sc">*</span> <span class="st">`</span><span class="at">Childhood vaccines</span><span class="st">`</span> <span class="sc">/</span> Total_Child, <span class="dv">1</span>), <span class="st">"%)"</span>)),</span>
<span id="cb42-2099"><a href="#cb42-2099" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb42-2100"><a href="#cb42-2100" aria-hidden="true" tabindex="-1"></a>    <span class="at">Other_grp =</span> <span class="fu">ifelse</span>(is_missing,</span>
<span id="cb42-2101"><a href="#cb42-2101" aria-hidden="true" tabindex="-1"></a>                       <span class="fu">comma</span>(Other),</span>
<span id="cb42-2102"><a href="#cb42-2102" aria-hidden="true" tabindex="-1"></a>                       <span class="fu">paste0</span>(<span class="fu">comma</span>(Other), <span class="st">" ("</span>, <span class="fu">round</span>(<span class="dv">100</span> <span class="sc">*</span> Other <span class="sc">/</span> Total_Other, <span class="dv">1</span>), <span class="st">"%)"</span>))</span>
<span id="cb42-2103"><a href="#cb42-2103" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb42-2104"><a href="#cb42-2104" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb42-2105"><a href="#cb42-2105" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Category, Label, Respiratory, Childhood, Other_grp)</span>
<span id="cb42-2106"><a href="#cb42-2106" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-2107"><a href="#cb42-2107" aria-hidden="true" tabindex="-1"></a><span class="co"># .................. Show Category only once per group ..................</span></span>
<span id="cb42-2108"><a href="#cb42-2108" aria-hidden="true" tabindex="-1"></a>tab_combined <span class="ot">&lt;-</span> tab_combined <span class="sc">%&gt;%</span></span>
<span id="cb42-2109"><a href="#cb42-2109" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Category) <span class="sc">%&gt;%</span></span>
<span id="cb42-2110"><a href="#cb42-2110" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Category =</span> <span class="fu">ifelse</span>(<span class="fu">row_number</span>() <span class="sc">==</span> <span class="dv">1</span>, Category, <span class="st">""</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb42-2111"><a href="#cb42-2111" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb42-2112"><a href="#cb42-2112" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-2113"><a href="#cb42-2113" aria-hidden="true" tabindex="-1"></a><span class="co"># .................. Get total counts per vaccine group ..................</span></span>
<span id="cb42-2114"><a href="#cb42-2114" aria-hidden="true" tabindex="-1"></a>totals <span class="ot">&lt;-</span> vacc_1524 <span class="sc">%&gt;%</span></span>
<span id="cb42-2115"><a href="#cb42-2115" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(vacc_group3) <span class="sc">%&gt;%</span></span>
<span id="cb42-2116"><a href="#cb42-2116" aria-hidden="true" tabindex="-1"></a>  <span class="fu">deframe</span>()</span>
<span id="cb42-2117"><a href="#cb42-2117" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-2118"><a href="#cb42-2118" aria-hidden="true" tabindex="-1"></a><span class="co"># .................. Create flextable ..................</span></span>
<span id="cb42-2119"><a href="#cb42-2119" aria-hidden="true" tabindex="-1"></a>ft_vacc_summary <span class="ot">&lt;-</span> tab_combined <span class="sc">%&gt;%</span></span>
<span id="cb42-2120"><a href="#cb42-2120" aria-hidden="true" tabindex="-1"></a>  <span class="fu">flextable</span>() <span class="sc">%&gt;%</span></span>
<span id="cb42-2121"><a href="#cb42-2121" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_header_labels</span>(</span>
<span id="cb42-2122"><a href="#cb42-2122" aria-hidden="true" tabindex="-1"></a>    <span class="at">Category =</span> <span class="st">"Variable type"</span>,</span>
<span id="cb42-2123"><a href="#cb42-2123" aria-hidden="true" tabindex="-1"></a>    <span class="at">Label =</span> <span class="st">"Values"</span>,</span>
<span id="cb42-2124"><a href="#cb42-2124" aria-hidden="true" tabindex="-1"></a>    <span class="at">Respiratory =</span> <span class="st">"Number (%)·µÉ"</span>,</span>
<span id="cb42-2125"><a href="#cb42-2125" aria-hidden="true" tabindex="-1"></a>    <span class="at">Childhood =</span> <span class="st">"Number (%)·µÉ"</span>,</span>
<span id="cb42-2126"><a href="#cb42-2126" aria-hidden="true" tabindex="-1"></a>    <span class="at">Other_grp =</span> <span class="st">"Number (%)·µÉ"</span></span>
<span id="cb42-2127"><a href="#cb42-2127" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb42-2128"><a href="#cb42-2128" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_header_row</span>(</span>
<span id="cb42-2129"><a href="#cb42-2129" aria-hidden="true" tabindex="-1"></a>    <span class="at">values =</span> <span class="fu">c</span>(</span>
<span id="cb42-2130"><a href="#cb42-2130" aria-hidden="true" tabindex="-1"></a>      <span class="st">""</span>, <span class="st">""</span>,</span>
<span id="cb42-2131"><a href="#cb42-2131" aria-hidden="true" tabindex="-1"></a>      <span class="fu">paste0</span>(<span class="st">"Respiratory vaccines (N = "</span>, <span class="fu">format</span>(totals[<span class="st">"Respiratory vaccines"</span>], <span class="at">big.mark =</span> <span class="st">","</span>), <span class="st">")"</span>),</span>
<span id="cb42-2132"><a href="#cb42-2132" aria-hidden="true" tabindex="-1"></a>      <span class="fu">paste0</span>(<span class="st">"Childhood vaccines (N = "</span>, <span class="fu">format</span>(totals[<span class="st">"Childhood vaccines"</span>], <span class="at">big.mark =</span> <span class="st">","</span>), <span class="st">")"</span>),</span>
<span id="cb42-2133"><a href="#cb42-2133" aria-hidden="true" tabindex="-1"></a>      <span class="fu">paste0</span>(<span class="st">"Other (N = "</span>, <span class="fu">format</span>(totals[<span class="st">"Other"</span>], <span class="at">big.mark =</span> <span class="st">","</span>), <span class="st">")"</span>)</span>
<span id="cb42-2134"><a href="#cb42-2134" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb42-2135"><a href="#cb42-2135" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb42-2136"><a href="#cb42-2136" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_header_row</span>(</span>
<span id="cb42-2137"><a href="#cb42-2137" aria-hidden="true" tabindex="-1"></a>    <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"Description"</span>, <span class="st">"Vaccination uptake"</span>),</span>
<span id="cb42-2138"><a href="#cb42-2138" aria-hidden="true" tabindex="-1"></a>    <span class="at">colwidths =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">3</span>)</span>
<span id="cb42-2139"><a href="#cb42-2139" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb42-2140"><a href="#cb42-2140" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_box</span>() <span class="sc">%&gt;%</span></span>
<span id="cb42-2141"><a href="#cb42-2141" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_table_properties</span>(<span class="at">layout =</span> <span class="st">"autofit"</span>, <span class="at">width =</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb42-2142"><a href="#cb42-2142" aria-hidden="true" tabindex="-1"></a>  <span class="fu">width</span>(<span class="at">j =</span> <span class="dv">1</span>, <span class="at">width =</span> <span class="fl">1.5</span>) <span class="sc">%&gt;%</span></span>
<span id="cb42-2143"><a href="#cb42-2143" aria-hidden="true" tabindex="-1"></a>  <span class="fu">width</span>(<span class="at">j =</span> <span class="dv">2</span>, <span class="at">width =</span> <span class="fl">2.5</span>) <span class="sc">%&gt;%</span></span>
<span id="cb42-2144"><a href="#cb42-2144" aria-hidden="true" tabindex="-1"></a>  <span class="fu">width</span>(<span class="at">j =</span> <span class="dv">3</span><span class="sc">:</span><span class="dv">5</span>, <span class="at">width =</span> <span class="fl">1.5</span>) <span class="sc">%&gt;%</span></span>
<span id="cb42-2145"><a href="#cb42-2145" aria-hidden="true" tabindex="-1"></a>  <span class="fu">align</span>(<span class="at">align =</span> <span class="st">"justify"</span>, <span class="at">part =</span> <span class="st">"all"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb42-2146"><a href="#cb42-2146" aria-hidden="true" tabindex="-1"></a>  <span class="fu">border_remove</span>() <span class="sc">%&gt;%</span></span>
<span id="cb42-2147"><a href="#cb42-2147" aria-hidden="true" tabindex="-1"></a>  <span class="fu">border_inner_h</span>(<span class="at">border =</span> <span class="fu">fp_border</span>(<span class="at">color =</span> <span class="st">"black"</span>, <span class="at">width =</span> <span class="dv">1</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb42-2148"><a href="#cb42-2148" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb42-2149"><a href="#cb42-2149" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_caption</span>(<span class="st">"Table: Vaccination uptake (column percentage) across service year, quarter, and weekday"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb42-2150"><a href="#cb42-2150" aria-hidden="true" tabindex="-1"></a>  <span class="fu">footnote</span>(<span class="at">i =</span> <span class="dv">1</span>, </span>
<span id="cb42-2151"><a href="#cb42-2151" aria-hidden="true" tabindex="-1"></a>           <span class="at">value =</span> <span class="fu">as_paragraph</span>(<span class="st">"Vaccination proportions were calculated column-wise (i.e., within each vaccine group)."</span>),</span>
<span id="cb42-2152"><a href="#cb42-2152" aria-hidden="true" tabindex="-1"></a>           <span class="at">ref_symbols =</span> <span class="st">"·µÉ"</span>, </span>
<span id="cb42-2153"><a href="#cb42-2153" aria-hidden="true" tabindex="-1"></a>           <span class="at">part =</span> <span class="st">"header"</span>)</span>
<span id="cb42-2154"><a href="#cb42-2154" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-2155"><a href="#cb42-2155" aria-hidden="true" tabindex="-1"></a><span class="co"># .................. Show the table ..................</span></span>
<span id="cb42-2156"><a href="#cb42-2156" aria-hidden="true" tabindex="-1"></a>ft_vacc_summary</span>
<span id="cb42-2157"><a href="#cb42-2157" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-2158"><a href="#cb42-2158" aria-hidden="true" tabindex="-1"></a><span class="co"># .................. Clean up environment ..................</span></span>
<span id="cb42-2159"><a href="#cb42-2159" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(tab_age, tab_sex, tab_marital_status, tab_year, tab_quarter, tab_weekday,</span>
<span id="cb42-2160"><a href="#cb42-2160" aria-hidden="true" tabindex="-1"></a>   tab_combined, ft_vacc_summary, totals, create_tab)</span>
<span id="cb42-2161"><a href="#cb42-2161" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-2162"><a href="#cb42-2162" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb42-2163"><a href="#cb42-2163" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-2164"><a href="#cb42-2164" aria-hidden="true" tabindex="-1"></a><span class="fu">## **15. Interactive and Print-Ready Table**</span></span>
<span id="cb42-2165"><a href="#cb42-2165" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-2166"><a href="#cb42-2166" aria-hidden="true" tabindex="-1"></a>Finally, we build an **interactive table using the DT package** with export options (CSV, Excel, Print).</span>
<span id="cb42-2167"><a href="#cb42-2167" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-2168"><a href="#cb42-2168" aria-hidden="true" tabindex="-1"></a>üñ±Ô∏è *Why use this*:</span>
<span id="cb42-2169"><a href="#cb42-2169" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-2170"><a href="#cb42-2170" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Offers flexibility for exploratory review or end-user interaction.</span>
<span id="cb42-2171"><a href="#cb42-2171" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-2172"><a href="#cb42-2172" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Enables printing or downloading filtered subsets.</span>
<span id="cb42-2173"><a href="#cb42-2173" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-2174"><a href="#cb42-2174" aria-hidden="true" tabindex="-1"></a>üåç *Perfect for*: Dashboards, websites, or when publishing to HTML via Quarto/GitHub.</span>
<span id="cb42-2175"><a href="#cb42-2175" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-2176"><a href="#cb42-2176" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, echo=FALSE}</span></span>
<span id="cb42-2177"><a href="#cb42-2177" aria-hidden="true" tabindex="-1"></a><span class="in"># Load required libraries</span></span>
<span id="cb42-2178"><a href="#cb42-2178" aria-hidden="true" tabindex="-1"></a><span class="in">library(dplyr)</span></span>
<span id="cb42-2179"><a href="#cb42-2179" aria-hidden="true" tabindex="-1"></a><span class="in">library(janitor)</span></span>
<span id="cb42-2180"><a href="#cb42-2180" aria-hidden="true" tabindex="-1"></a><span class="in">library(tibble)</span></span>
<span id="cb42-2181"><a href="#cb42-2181" aria-hidden="true" tabindex="-1"></a><span class="in">library(scales)</span></span>
<span id="cb42-2182"><a href="#cb42-2182" aria-hidden="true" tabindex="-1"></a><span class="in">library(DT)</span></span>
<span id="cb42-2183"><a href="#cb42-2183" aria-hidden="true" tabindex="-1"></a><span class="in">library(htmltools)</span></span>
<span id="cb42-2184"><a href="#cb42-2184" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb42-2185"><a href="#cb42-2185" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-2188"><a href="#cb42-2188" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb42-2189"><a href="#cb42-2189" aria-hidden="true" tabindex="-1"></a><span class="co"># ------------ 12. Interactive and Print ready: Table  -------------------------------------------</span></span>
<span id="cb42-2190"><a href="#cb42-2190" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-2191"><a href="#cb42-2191" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-2192"><a href="#cb42-2192" aria-hidden="true" tabindex="-1"></a><span class="co"># .................. Convert grouping vars to character ..................</span></span>
<span id="cb42-2193"><a href="#cb42-2193" aria-hidden="true" tabindex="-1"></a>vacc_1524 <span class="ot">&lt;-</span> vacc_1524 <span class="sc">%&gt;%</span></span>
<span id="cb42-2194"><a href="#cb42-2194" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">c</span>(age_group, gender, marital_status,</span>
<span id="cb42-2195"><a href="#cb42-2195" aria-hidden="true" tabindex="-1"></a>                  vacc_service_year, vacc_quarter, vacc_weekday), as.character))</span>
<span id="cb42-2196"><a href="#cb42-2196" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-2197"><a href="#cb42-2197" aria-hidden="true" tabindex="-1"></a><span class="co"># .................. Table generation function with Missing ..................</span></span>
<span id="cb42-2198"><a href="#cb42-2198" aria-hidden="true" tabindex="-1"></a>create_tab <span class="ot">&lt;-</span> <span class="cf">function</span>(data, var, label) {</span>
<span id="cb42-2199"><a href="#cb42-2199" aria-hidden="true" tabindex="-1"></a>  tab_main <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span></span>
<span id="cb42-2200"><a href="#cb42-2200" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>({{ var }})) <span class="sc">%&gt;%</span></span>
<span id="cb42-2201"><a href="#cb42-2201" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tabyl</span>({{ var }}, vacc_group3) <span class="sc">%&gt;%</span></span>
<span id="cb42-2202"><a href="#cb42-2202" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">Category =</span> label, <span class="at">.before =</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb42-2203"><a href="#cb42-2203" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rename</span>(<span class="at">Label =</span> {{ var }}) <span class="sc">%&gt;%</span></span>
<span id="cb42-2204"><a href="#cb42-2204" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">Label =</span> <span class="fu">as.character</span>(Label))</span>
<span id="cb42-2205"><a href="#cb42-2205" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb42-2206"><a href="#cb42-2206" aria-hidden="true" tabindex="-1"></a>  na_count <span class="ot">&lt;-</span> <span class="fu">sum</span>(<span class="fu">is.na</span>(<span class="fu">pull</span>(data, {{ var }})))</span>
<span id="cb42-2207"><a href="#cb42-2207" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb42-2208"><a href="#cb42-2208" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (na_count <span class="sc">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb42-2209"><a href="#cb42-2209" aria-hidden="true" tabindex="-1"></a>    missing_row <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb42-2210"><a href="#cb42-2210" aria-hidden="true" tabindex="-1"></a>      <span class="at">Category =</span> label,</span>
<span id="cb42-2211"><a href="#cb42-2211" aria-hidden="true" tabindex="-1"></a>      <span class="at">Label =</span> <span class="st">"Missing"</span>,</span>
<span id="cb42-2212"><a href="#cb42-2212" aria-hidden="true" tabindex="-1"></a>      <span class="st">`</span><span class="at">Respiratory vaccines</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">sum</span>(data<span class="sc">$</span>vacc_group3 <span class="sc">==</span> <span class="st">"Respiratory vaccines"</span> <span class="sc">&amp;</span> <span class="fu">is.na</span>(<span class="fu">pull</span>(data, {{ var }})), <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb42-2213"><a href="#cb42-2213" aria-hidden="true" tabindex="-1"></a>      <span class="st">`</span><span class="at">Childhood vaccines</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">sum</span>(data<span class="sc">$</span>vacc_group3 <span class="sc">==</span> <span class="st">"Childhood vaccines"</span> <span class="sc">&amp;</span> <span class="fu">is.na</span>(<span class="fu">pull</span>(data, {{ var }})), <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb42-2214"><a href="#cb42-2214" aria-hidden="true" tabindex="-1"></a>      <span class="at">Other =</span> <span class="fu">sum</span>(data<span class="sc">$</span>vacc_group3 <span class="sc">==</span> <span class="st">"Other"</span> <span class="sc">&amp;</span> <span class="fu">is.na</span>(<span class="fu">pull</span>(data, {{ var }})), <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb42-2215"><a href="#cb42-2215" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb42-2216"><a href="#cb42-2216" aria-hidden="true" tabindex="-1"></a>    tab_final <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(tab_main, missing_row)</span>
<span id="cb42-2217"><a href="#cb42-2217" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb42-2218"><a href="#cb42-2218" aria-hidden="true" tabindex="-1"></a>    tab_final <span class="ot">&lt;-</span> tab_main</span>
<span id="cb42-2219"><a href="#cb42-2219" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb42-2220"><a href="#cb42-2220" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb42-2221"><a href="#cb42-2221" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(tab_final)</span>
<span id="cb42-2222"><a href="#cb42-2222" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb42-2223"><a href="#cb42-2223" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-2224"><a href="#cb42-2224" aria-hidden="true" tabindex="-1"></a><span class="co"># .................. Create summary tables ..................</span></span>
<span id="cb42-2225"><a href="#cb42-2225" aria-hidden="true" tabindex="-1"></a>tab_age            <span class="ot">&lt;-</span> <span class="fu">create_tab</span>(vacc_1524, age_group, <span class="st">"Age"</span>)</span>
<span id="cb42-2226"><a href="#cb42-2226" aria-hidden="true" tabindex="-1"></a>tab_sex            <span class="ot">&lt;-</span> <span class="fu">create_tab</span>(vacc_1524, gender, <span class="st">"Gender"</span>)</span>
<span id="cb42-2227"><a href="#cb42-2227" aria-hidden="true" tabindex="-1"></a>tab_marital_status <span class="ot">&lt;-</span> <span class="fu">create_tab</span>(vacc_1524, marital_status, <span class="st">"Marital status"</span>)</span>
<span id="cb42-2228"><a href="#cb42-2228" aria-hidden="true" tabindex="-1"></a>tab_year           <span class="ot">&lt;-</span> <span class="fu">create_tab</span>(vacc_1524, vacc_service_year, <span class="st">"Year"</span>)</span>
<span id="cb42-2229"><a href="#cb42-2229" aria-hidden="true" tabindex="-1"></a>tab_quarter        <span class="ot">&lt;-</span> <span class="fu">create_tab</span>(vacc_1524, vacc_quarter, <span class="st">"Quarter"</span>)</span>
<span id="cb42-2230"><a href="#cb42-2230" aria-hidden="true" tabindex="-1"></a>tab_weekday        <span class="ot">&lt;-</span> <span class="fu">create_tab</span>(vacc_1524, vacc_weekday, <span class="st">"Weekday"</span>)</span>
<span id="cb42-2231"><a href="#cb42-2231" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-2232"><a href="#cb42-2232" aria-hidden="true" tabindex="-1"></a><span class="co"># .................. Combine all tables ..................</span></span>
<span id="cb42-2233"><a href="#cb42-2233" aria-hidden="true" tabindex="-1"></a>tab_combined <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(tab_sex, tab_age, tab_marital_status, tab_year, tab_quarter, tab_weekday)</span>
<span id="cb42-2234"><a href="#cb42-2234" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-2235"><a href="#cb42-2235" aria-hidden="true" tabindex="-1"></a><span class="co"># .................. Calculate row-wise percentages (skip for Missing) ..................</span></span>
<span id="cb42-2236"><a href="#cb42-2236" aria-hidden="true" tabindex="-1"></a>tab_combined <span class="ot">&lt;-</span> tab_combined <span class="sc">%&gt;%</span></span>
<span id="cb42-2237"><a href="#cb42-2237" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rowwise</span>() <span class="sc">%&gt;%</span></span>
<span id="cb42-2238"><a href="#cb42-2238" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb42-2239"><a href="#cb42-2239" aria-hidden="true" tabindex="-1"></a>    <span class="at">Total =</span> <span class="fu">sum</span>(<span class="st">`</span><span class="at">Respiratory vaccines</span><span class="st">`</span>, <span class="st">`</span><span class="at">Childhood vaccines</span><span class="st">`</span>, Other, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb42-2240"><a href="#cb42-2240" aria-hidden="true" tabindex="-1"></a>    <span class="at">is_missing =</span> <span class="fu">trimws</span>(<span class="fu">tolower</span>(Label)) <span class="sc">==</span> <span class="st">"missing"</span>,</span>
<span id="cb42-2241"><a href="#cb42-2241" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb42-2242"><a href="#cb42-2242" aria-hidden="true" tabindex="-1"></a>    <span class="at">Respiratory =</span> <span class="fu">ifelse</span>(is_missing,</span>
<span id="cb42-2243"><a href="#cb42-2243" aria-hidden="true" tabindex="-1"></a>                         <span class="fu">comma</span>(<span class="st">`</span><span class="at">Respiratory vaccines</span><span class="st">`</span>),</span>
<span id="cb42-2244"><a href="#cb42-2244" aria-hidden="true" tabindex="-1"></a>                         <span class="fu">paste0</span>(<span class="fu">comma</span>(<span class="st">`</span><span class="at">Respiratory vaccines</span><span class="st">`</span>), <span class="st">" ("</span>, <span class="fu">round</span>(<span class="dv">100</span> <span class="sc">*</span> <span class="st">`</span><span class="at">Respiratory vaccines</span><span class="st">`</span> <span class="sc">/</span> Total, <span class="dv">1</span>), <span class="st">")"</span>)),</span>
<span id="cb42-2245"><a href="#cb42-2245" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb42-2246"><a href="#cb42-2246" aria-hidden="true" tabindex="-1"></a>    <span class="at">Childhood =</span> <span class="fu">ifelse</span>(is_missing,</span>
<span id="cb42-2247"><a href="#cb42-2247" aria-hidden="true" tabindex="-1"></a>                       <span class="fu">comma</span>(<span class="st">`</span><span class="at">Childhood vaccines</span><span class="st">`</span>),</span>
<span id="cb42-2248"><a href="#cb42-2248" aria-hidden="true" tabindex="-1"></a>                       <span class="fu">paste0</span>(<span class="fu">comma</span>(<span class="st">`</span><span class="at">Childhood vaccines</span><span class="st">`</span>), <span class="st">" ("</span>, <span class="fu">round</span>(<span class="dv">100</span> <span class="sc">*</span> <span class="st">`</span><span class="at">Childhood vaccines</span><span class="st">`</span> <span class="sc">/</span> Total, <span class="dv">1</span>), <span class="st">")"</span>)),</span>
<span id="cb42-2249"><a href="#cb42-2249" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb42-2250"><a href="#cb42-2250" aria-hidden="true" tabindex="-1"></a>    <span class="at">Other_grp =</span> <span class="fu">ifelse</span>(is_missing,</span>
<span id="cb42-2251"><a href="#cb42-2251" aria-hidden="true" tabindex="-1"></a>                       <span class="fu">comma</span>(Other),</span>
<span id="cb42-2252"><a href="#cb42-2252" aria-hidden="true" tabindex="-1"></a>                       <span class="fu">paste0</span>(<span class="fu">comma</span>(Other), <span class="st">" ("</span>, <span class="fu">round</span>(<span class="dv">100</span> <span class="sc">*</span> Other <span class="sc">/</span> Total, <span class="dv">1</span>), <span class="st">")"</span>))</span>
<span id="cb42-2253"><a href="#cb42-2253" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb42-2254"><a href="#cb42-2254" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb42-2255"><a href="#cb42-2255" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Category, Label, Respiratory, Childhood, Other_grp)</span>
<span id="cb42-2256"><a href="#cb42-2256" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-2257"><a href="#cb42-2257" aria-hidden="true" tabindex="-1"></a><span class="co"># .................. Show Category only once per group ..................</span></span>
<span id="cb42-2258"><a href="#cb42-2258" aria-hidden="true" tabindex="-1"></a>tab_combined <span class="ot">&lt;-</span> tab_combined <span class="sc">%&gt;%</span></span>
<span id="cb42-2259"><a href="#cb42-2259" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Category) <span class="sc">%&gt;%</span></span>
<span id="cb42-2260"><a href="#cb42-2260" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Category =</span> <span class="fu">ifelse</span>(<span class="fu">row_number</span>() <span class="sc">==</span> <span class="dv">1</span>, Category, <span class="st">""</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb42-2261"><a href="#cb42-2261" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb42-2262"><a href="#cb42-2262" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-2263"><a href="#cb42-2263" aria-hidden="true" tabindex="-1"></a><span class="co"># .................. Create interactive table with DT ..................</span></span>
<span id="cb42-2264"><a href="#cb42-2264" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-2265"><a href="#cb42-2265" aria-hidden="true" tabindex="-1"></a><span class="fu">datatable</span>(</span>
<span id="cb42-2266"><a href="#cb42-2266" aria-hidden="true" tabindex="-1"></a>  tab_combined,</span>
<span id="cb42-2267"><a href="#cb42-2267" aria-hidden="true" tabindex="-1"></a>  <span class="at">rownames =</span> <span class="cn">FALSE</span>,</span>
<span id="cb42-2268"><a href="#cb42-2268" aria-hidden="true" tabindex="-1"></a>  <span class="at">extensions =</span> <span class="st">'Buttons'</span>,</span>
<span id="cb42-2269"><a href="#cb42-2269" aria-hidden="true" tabindex="-1"></a>  <span class="at">options =</span> <span class="fu">list</span>(</span>
<span id="cb42-2270"><a href="#cb42-2270" aria-hidden="true" tabindex="-1"></a>    <span class="at">dom =</span> <span class="st">'Bfrtip'</span>,</span>
<span id="cb42-2271"><a href="#cb42-2271" aria-hidden="true" tabindex="-1"></a>    <span class="at">buttons =</span> <span class="fu">c</span>(<span class="st">'copy'</span>, <span class="st">'csv'</span>, <span class="st">'excel'</span>, <span class="st">'pdf'</span>, <span class="st">'print'</span>),</span>
<span id="cb42-2272"><a href="#cb42-2272" aria-hidden="true" tabindex="-1"></a>    <span class="at">pageLength =</span> <span class="dv">25</span>,</span>
<span id="cb42-2273"><a href="#cb42-2273" aria-hidden="true" tabindex="-1"></a>    <span class="at">autoWidth =</span> <span class="cn">TRUE</span>,</span>
<span id="cb42-2274"><a href="#cb42-2274" aria-hidden="true" tabindex="-1"></a>    <span class="at">columnDefs =</span> <span class="fu">list</span>(<span class="fu">list</span>(<span class="at">width =</span> <span class="st">'200px'</span>, <span class="at">targets =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>)))</span>
<span id="cb42-2275"><a href="#cb42-2275" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb42-2276"><a href="#cb42-2276" aria-hidden="true" tabindex="-1"></a>  <span class="at">caption =</span> htmltools<span class="sc">::</span>tags<span class="sc">$</span><span class="fu">caption</span>(</span>
<span id="cb42-2277"><a href="#cb42-2277" aria-hidden="true" tabindex="-1"></a>    <span class="at">style =</span> <span class="st">'caption-side: top; font-size: 18px; font-family: "Times New Roman"; font-weight: bold;'</span>,</span>
<span id="cb42-2278"><a href="#cb42-2278" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Table: Vaccination uptake across service year, quarter, and weekday'</span></span>
<span id="cb42-2279"><a href="#cb42-2279" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb42-2280"><a href="#cb42-2280" aria-hidden="true" tabindex="-1"></a>  <span class="at">class =</span> <span class="st">'stripe hover cell-border'</span></span>
<span id="cb42-2281"><a href="#cb42-2281" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb42-2282"><a href="#cb42-2282" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-2283"><a href="#cb42-2283" aria-hidden="true" tabindex="-1"></a><span class="co"># .................. Clean up all new objects ..................</span></span>
<span id="cb42-2284"><a href="#cb42-2284" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(tab_age, tab_sex, tab_marital_status, tab_year, tab_quarter, tab_weekday,</span>
<span id="cb42-2285"><a href="#cb42-2285" aria-hidden="true" tabindex="-1"></a>   tab_combined, create_tab)</span>
<span id="cb42-2286"><a href="#cb42-2286" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-2287"><a href="#cb42-2287" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb42-2288"><a href="#cb42-2288" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-2289"><a href="#cb42-2289" aria-hidden="true" tabindex="-1"></a><span class="fu"># Brief summary</span></span>
<span id="cb42-2290"><a href="#cb42-2290" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-2291"><a href="#cb42-2291" aria-hidden="true" tabindex="-1"></a>Automating table generation is crucial for improving reproducibility, consistency, and efficiency in health data reporting. It reduces the need for repetitive formatting and enables streamlined integration with reporting tools such as Quarto and GitHub. This document demonstrates various approaches to creating publication-ready tables using R.</span>
<span id="cb42-2292"><a href="#cb42-2292" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-2293"><a href="#cb42-2293" aria-hidden="true" tabindex="-1"></a><span class="fu">### Row-Wise Tables</span></span>
<span id="cb42-2294"><a href="#cb42-2294" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-2295"><a href="#cb42-2295" aria-hidden="true" tabindex="-1"></a>This method calculates percentages across rows, meaning each row adds up to 100%. Ideal for summarizing characteristics such as age, gender, or quarter.</span>
<span id="cb42-2296"><a href="#cb42-2296" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-2297"><a href="#cb42-2297" aria-hidden="true" tabindex="-1"></a><span class="fu">### Column-Wise Tables</span></span>
<span id="cb42-2298"><a href="#cb42-2298" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-2299"><a href="#cb42-2299" aria-hidden="true" tabindex="-1"></a>This variation calculates percentages within each vaccine group (i.e., by column). Each column totals 100%.</span>
<span id="cb42-2300"><a href="#cb42-2300" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-2301"><a href="#cb42-2301" aria-hidden="true" tabindex="-1"></a><span class="fu">### Handling Missing Data</span></span>
<span id="cb42-2302"><a href="#cb42-2302" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-2303"><a href="#cb42-2303" aria-hidden="true" tabindex="-1"></a>Tables optionally include rows labeled "Missing" to account for unreported values.</span>
<span id="cb42-2304"><a href="#cb42-2304" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-2305"><a href="#cb42-2305" aria-hidden="true" tabindex="-1"></a><span class="fu">### Table Styles, Fonts and Border Options</span></span>
<span id="cb42-2306"><a href="#cb42-2306" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-2307"><a href="#cb42-2307" aria-hidden="true" tabindex="-1"></a>Apply different styling configurations:</span>
<span id="cb42-2308"><a href="#cb42-2308" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-2309"><a href="#cb42-2309" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**No lines** ‚Äì minimal look for Word docs</span>
<span id="cb42-2310"><a href="#cb42-2310" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-2311"><a href="#cb42-2311" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**Horizontal lines only** ‚Äì readable and clean for print</span>
<span id="cb42-2312"><a href="#cb42-2312" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-2313"><a href="#cb42-2313" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**All lines visible** ‚Äì structured look for Excel-style documents</span>
<span id="cb42-2314"><a href="#cb42-2314" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-2315"><a href="#cb42-2315" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>The goal is to adapt the visual format to your output medium.</span>
<span id="cb42-2316"><a href="#cb42-2316" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-2317"><a href="#cb42-2317" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Font selection (e.g., Times New Roman)</span>
<span id="cb42-2318"><a href="#cb42-2318" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-2319"><a href="#cb42-2319" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Font sizes (header, body, footer)</span>
<span id="cb42-2320"><a href="#cb42-2320" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-2321"><a href="#cb42-2321" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Color-coding headers and alternating rows</span>
<span id="cb42-2322"><a href="#cb42-2322" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-2323"><a href="#cb42-2323" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Setting captions and custom footnotes</span>
<span id="cb42-2324"><a href="#cb42-2324" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-2325"><a href="#cb42-2325" aria-hidden="true" tabindex="-1"></a>    &lt;div&gt;</span>
<span id="cb42-2326"><a href="#cb42-2326" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-2327"><a href="#cb42-2327" aria-hidden="true" tabindex="-1"></a>    ## Interactive Tables</span>
<span id="cb42-2328"><a href="#cb42-2328" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-2329"><a href="#cb42-2329" aria-hidden="true" tabindex="-1"></a>    &lt;/div&gt;</span>
<span id="cb42-2330"><a href="#cb42-2330" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-2331"><a href="#cb42-2331" aria-hidden="true" tabindex="-1"></a>Interactive tables are created using <span class="in">`DT::datatable()`</span> for HTML outputs. Key features:</span>
<span id="cb42-2332"><a href="#cb42-2332" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-2333"><a href="#cb42-2333" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Searchable and filterable</span>
<span id="cb42-2334"><a href="#cb42-2334" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-2335"><a href="#cb42-2335" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Buttons for export (CSV, Excel, PDF)</span>
<span id="cb42-2336"><a href="#cb42-2336" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-2337"><a href="#cb42-2337" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Caption styling using <span class="in">`htmltools`</span></span>
<span id="cb42-2338"><a href="#cb42-2338" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-2339"><a href="#cb42-2339" aria-hidden="true" tabindex="-1"></a><span class="in">```         </span></span>
<span id="cb42-2340"><a href="#cb42-2340" aria-hidden="true" tabindex="-1"></a><span class="in">## Summary Table: Style and Purpose</span></span>
<span id="cb42-2341"><a href="#cb42-2341" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb42-2342"><a href="#cb42-2342" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-2343"><a href="#cb42-2343" aria-hidden="true" tabindex="-1"></a>| Style         | Use Case            | Best For                  |</span>
<span id="cb42-2344"><a href="#cb42-2344" aria-hidden="true" tabindex="-1"></a>|---------------|---------------------|---------------------------|</span>
<span id="cb42-2345"><a href="#cb42-2345" aria-hidden="true" tabindex="-1"></a>| Row-wise %    | Compare categories  | Epidemiological summaries |</span>
<span id="cb42-2346"><a href="#cb42-2346" aria-hidden="true" tabindex="-1"></a>| Column-wise % | Within group totals | Vaccine distribution      |</span>
<span id="cb42-2347"><a href="#cb42-2347" aria-hidden="true" tabindex="-1"></a>| Missing shown | Transparency        | Data audits               |</span>
<span id="cb42-2348"><a href="#cb42-2348" aria-hidden="true" tabindex="-1"></a>| No borders    | Word reports        | Clean look                |</span>
<span id="cb42-2349"><a href="#cb42-2349" aria-hidden="true" tabindex="-1"></a>| Full borders  | Technical           | Detailed analysis         |</span>
<span id="cb42-2350"><a href="#cb42-2350" aria-hidden="true" tabindex="-1"></a>| Interactive   | HTML export         | User engagement           |</span>
<span id="cb42-2351"><a href="#cb42-2351" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-2352"><a href="#cb42-2352" aria-hidden="true" tabindex="-1"></a><span class="fu"># Key Takeaways</span></span>
<span id="cb42-2353"><a href="#cb42-2353" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-2354"><a href="#cb42-2354" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Automated table generation is efficient, reproducible, and customizable.</span>
<span id="cb42-2355"><a href="#cb42-2355" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-2356"><a href="#cb42-2356" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="in">`flextable`</span>, <span class="in">`janitor`</span>, and <span class="in">`dplyr`</span> form a powerful combination for health data summarization.</span>
<span id="cb42-2357"><a href="#cb42-2357" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-2358"><a href="#cb42-2358" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Style your tables based on your audience‚Äîminimal for reports, interactive for dashboards.</span>
<span id="cb42-2359"><a href="#cb42-2359" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-2360"><a href="#cb42-2360" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Table Automation reduces manual error and allows rapid updates to underlying data.</span>
<span id="cb42-2361"><a href="#cb42-2361" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-2362"><a href="#cb42-2362" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>You can extend this workflow to support additional data types, link it to Shiny dashboards, or convert it for LaTeX outputs.</span>
<span id="cb42-2363"><a href="#cb42-2363" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-2364"><a href="#cb42-2364" aria-hidden="true" tabindex="-1"></a>*This project is hosted on GitHub and supports reproducible outcomes using Quarto.*</span>
</code><button title="Copy to Clipboard" class="code-copy-button" data-in-quarto-modal=""><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->




</body></html>