[
  {
    "objectID": "index.html#explore-learn-and-connect",
    "href": "index.html#explore-learn-and-connect",
    "title": "Habtamu Mellie Bizuayehu",
    "section": "üß† Explore, Learn, and Connect",
    "text": "üß† Explore, Learn, and Connect\nThis website is a space to share knowledge, support emerging epidemiologists, data analysts, and public health experts, and promote the value of health data and evidence-based public health interventions.\nFeel free to explore and connect‚Äîwhether you‚Äôre here to learn, collaborate, or get inspired.\nI invite you to be part of this journey where evidence meets impact, and insight drives change.\nüåü If you have questions or want to collaborate, get in touch!"
  },
  {
    "objectID": "work_experience.html",
    "href": "work_experience.html",
    "title": "work_experience",
    "section": "",
    "text": "H. Mellie B"
  },
  {
    "objectID": "Publication_report.html#publications-reports",
    "href": "Publication_report.html#publications-reports",
    "title": "Publication | Report | Conference Presentation",
    "section": "",
    "text": "I have authored over 40 peer-reviewed journal articles, more than two major reports, and a book chapter. My work has been cited more than 10,000 times, with over 35% ranking in the top 1% journals globally. Many publications have directly informed policy and guidelines. I have presented my research outputs at 18 conferences, including those hosted by the Public Health Association of Australia, Australasian Epidemiological Association, and World Indigenous Cancer Conference."
  },
  {
    "objectID": "Post_Blog/Date and Time Data analysis.html#weekday-heatmap",
    "href": "Post_Blog/Date and Time Data analysis.html#weekday-heatmap",
    "title": "Date-Time Data Analysis in R",
    "section": "9.1 Weekday Heatmap",
    "text": "9.1 Weekday Heatmap\nThe heatmap identifies temporal service patterns. Higher intensity on Wednesdays/Thursdays may reflect clinic scheduling norms, while weekend gaps could indicate access barriers.\n\nvacc_1524 %&gt;%\n  count(vacc_month_name, vacc_weekday) %&gt;%\n  ggplot(aes(x = vacc_weekday, y = vacc_month_name, fill = n)) +\n  geom_tile(color = \"white\") +\n  scale_fill_gradient(low = \"#f7fbff\", high = \"#08306b\") +\n  labs(title = \"Vaccination Intensity by Weekday and Month\",\n       x = \"Weekday\", y = \"Month\") +\n  theme_minimal() +\n  theme(legend.position = \"bottom\")"
  },
  {
    "objectID": "Post_Blog/Date and Time Data analysis.html#seasonal-vaccination-distribution",
    "href": "Post_Blog/Date and Time Data analysis.html#seasonal-vaccination-distribution",
    "title": "Date-Time Data Analysis in R",
    "section": "9.2 Seasonal Vaccination Distribution",
    "text": "9.2 Seasonal Vaccination Distribution\nExplore how vaccination services vary by season.\n\nvacc_1524 %&gt;%\n  mutate(month = as.numeric(format(vacc_date, \"%m\")),\n         season = case_when(\n           month %in% c(12, 1, 2) ~ \"Summer\",\n           month %in% c(3, 4, 5) ~ \"Autumn\",\n           month %in% c(6, 7, 8) ~ \"Winter\",\n           month %in% c(9, 10, 11) ~ \"Spring\"\n         )) %&gt;%\n  count(season) %&gt;%\n  ggplot(aes(x = season, y = n, fill = season)) +\n  geom_col() +\n  labs(\n    title = \"Seasonal Vaccination Distribution\",\n    x = \"Season\",\n    y = \"Vaccination Count\"\n  ) +\n  theme_minimal()"
  },
  {
    "objectID": "Post_Blog/Date and Time Data analysis.html#vaccination-proportion-by-year-and-race",
    "href": "Post_Blog/Date and Time Data analysis.html#vaccination-proportion-by-year-and-race",
    "title": "Date-Time Data Analysis in R",
    "section": "9.3 Vaccination proportion by year and race",
    "text": "9.3 Vaccination proportion by year and race\nIf we‚Äôd like a stacked bar plot of the proportions\n\n# Proportion by vacc_year and race with cleaned race labels\ndf_plot_race &lt;- vacc_1524 %&gt;%\n  mutate(\n    race = ifelse(race %in% c(\"native\", \"other\"), \"Other\", race),\n    race = str_to_title(race),\n    vacc_year = as.integer(floor(as.numeric(vacc_year)))  # Ensure whole number\n  ) %&gt;%\n  group_by(race, vacc_year) %&gt;%\n  summarise(count = n(), .groups = \"drop\") %&gt;%\n  group_by(race) %&gt;%\n  mutate(\n    total = sum(count),\n    proportion = (count / total) * 100\n  ) %&gt;%\n  ungroup()\n\n# Line plot\nggplot(df_plot_race, aes(x = vacc_year, y = proportion, color = race)) +\n  geom_line(linewidth = 1) +\n  geom_point(size = 2) +\n  scale_x_continuous(breaks = seq(min(df_plot_race$vacc_year), max(df_plot_race$vacc_year), by = 2)) +\n  labs(\n    title = \"Vaccination Proportion by Race and Year\",\n    x = \"Vaccination Year\",\n    y = \"Proportion (%)\",\n    color = \"Race\"\n  ) +\n  theme_minimal() +\n  theme(\n    legend.position = \"right\",\n    plot.title = element_text(hjust = 0.5)\n  )\n\n\n\n\n\n\n\n# Bar plot\nggplot(df_plot_race, aes(x = vacc_year, y = proportion, fill = race)) +\n  geom_bar(stat = \"identity\", position = \"stack\") +\n  scale_x_continuous(breaks = seq(min(df_plot_race$vacc_year), max(df_plot_race$vacc_year), by = 2)) +\n  labs(\n    title = \"Vaccination Proportion by Race and Year\",\n    x = \"Vaccination Year\",\n    y = \"Proportion (%)\",\n    fill = \"Race\"\n  ) +\n  theme_minimal()\n\n\n\n\n\n\n\n\n\n# Proportion by vacc_year and gender\nvacc_1524 %&gt;%\n  mutate(\n    gender = case_when(\n      gender == \"M\" ~ \"Male\",\n      gender == \"F\" ~ \"Female\",\n      TRUE ~ gender\n    ),\n    vacc_year = as.integer(vacc_year)  # Ensure year is whole number\n  ) %&gt;%\n  group_by(gender, vacc_year) %&gt;%\n  summarise(count = n(), .groups = \"drop\") %&gt;%\n  group_by(gender) %&gt;%\n  mutate(\n    total = sum(count),\n    proportion = (count / total) * 100\n  ) %&gt;%\n  ungroup() %&gt;% \n  \n  ggplot(aes(x = vacc_year, y = proportion, color = gender)) +\n  geom_line(linewidth = 1) +\n  geom_point(size = 2) +\n  scale_x_continuous(breaks = scales::pretty_breaks()) +  # Ensures whole number years\n  labs(\n    title = \"Vaccination Proportion by Gender and Year\",\n    x = \"Vaccination Year\",\n    y = \"Proportion (%)\",\n    color = \"Gender\"\n  ) +\n  scale_color_manual(values = c(\"Male\" = \"#1f77b4\", \"Female\" = \"#ff7f0e\")) +\n  theme_minimal() +\n  theme(\n    legend.position = \"right\",\n    plot.title = element_text(hjust = 0.5, size = 14, face = \"bold\"),\n    axis.title = element_text(size = 12),\n    legend.title = element_text(size = 12)\n  )"
  },
  {
    "objectID": "Post_Blog/Date and Time Data analysis.html#vaccination-proportion-by-month-and-year",
    "href": "Post_Blog/Date and Time Data analysis.html#vaccination-proportion-by-month-and-year",
    "title": "Date-Time Data Analysis in R",
    "section": "9.4 Vaccination proportion by month and year",
    "text": "9.4 Vaccination proportion by month and year"
  },
  {
    "objectID": "Post_Blog/Date and Time Data analysis.html#summary-and-key-takeaways",
    "href": "Post_Blog/Date and Time Data analysis.html#summary-and-key-takeaways",
    "title": "Date-Time Data Analysis in R",
    "section": "9.5 Summary and Key Takeaways",
    "text": "9.5 Summary and Key Takeaways\nKey techniques covered:\n\nProper date conversion from character strings\nAccurate age and time difference calculations\nSeasonal and temporal pattern analysis\nVisualization of date-based trends\nSurvival analysis for time-to-event data\n\nBest practices:\n\nAlways validate date conversions\nDocument time units clearly (days vs.¬†months vs.¬†years)\nHandle missing dates explicitly\nConsider time zones for multi-center studies\n\nReferences\n\nhttps://CRAN.R-project.org/package=dplyr\nhttps://www.jstatsoft.org/article/view/v103i01\nhttps://r4ds.hadley.nz/"
  },
  {
    "objectID": "Podcast_Blog.html",
    "href": "Podcast_Blog.html",
    "title": "Projects & Blog",
    "section": "",
    "text": "Print first 10 rows\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nInteractive Dashboard: Shiny App\n\n\nInteractive Dashboard via R Shiny application: breast cancer screening.\n\n\n\nHabtamu Bizuayehu\n\n\nAug 5, 2025\n\n\n\n\n\n\n\n\n\n\n\n\n\nAutomating Publication-Ready Tables in R\n\n\nAutomatically Creating Report and Publication reday summary tables.\n\n\n\nHabtamu Bizuayehu\n\n\nMay 25, 2025\n\n\n\n\n\n\n\n\n\n\n\n\n\nDate Manipulation and Wrangling using R\n\n\nA guide for essential R techniques for data cleaning, transformation, and visualization.\n\n\n\nHabtamu Bizuayehu\n\n\nMay 20, 2025\n\n\n\n\n\n\n\n\n\n\n\n\n\nDate Manipulation and Wrangling using R\n\n\nA guide for essential R techniques for data cleaning, transformation, and visualization.\n\n\n\nHabtamu Bizuayehu\n\n\nMay 20, 2025\n\n\n\n\n\n\n\n\n\n\n\n\n\nDate Manipulation and Wrangling using R\n\n\nA guide for essential R techniques for data cleaning, transformation, and visualization.\n\n\n\nHabtamu Bizuayehu\n\n\nMay 20, 2025\n\n\n\n\n\n\n\n\n\n\n\n\n\nDashboard: User-Controlled Shiny App\n\n\nDashboard is user-controlled i.e.¬†Results update when you click a button, giving you more control over what you see.\n\n\n\nHabtamu Bizuayehu\n\n\nApr 25, 2025\n\n\n\n\n\n\n\n\n\n\n\n\n\nDate-Time Data Analysis in R\n\n\nA practical guide to working with date and time data.\n\n\n\nHabtamu Bizuayehu\n\n\nApr 14, 2025\n\n\n\n\n\n\n\n\n\n\n\n\n\nLongitudinal and Large Data Analysis: A 20 Years of Australian Prospective Cohort Data\n\n\nLongitudinal and Big data management and modelling: wave-by-wave variable management, reshaping, harmonisation, missing data analysis (MI/LOCF/NOCB), GLMM/GEE and Maternal‚Ä¶\n\n\n\nHabtamu Bizuayehu\n\n\nMay 20, 2024\n\n\n\n\n\n\n\n\n\n\n\n\n\nMissing Data Management and Analysis\n\n\nMissing data diagnostics and imputation strategies, R and STATA. Mechanism classification (MCAR/MAR/MNAR), multiple imputation, mean Imputation and LOCF/NOCB.\n\n\n\nHabtamu Bizuayehu\n\n\nMay 20, 2024\n\n\n\n\n\n\nNo matching items"
  },
  {
    "objectID": "contact.html#contact-form",
    "href": "contact.html#contact-form",
    "title": "üì¨ Get in Touch",
    "section": "üì© Contact Form",
    "text": "üì© Contact Form\n\n\n\n\n\n\n\nName \nEmail (required) \nMessage\n\n\nSend\n\n\n\n\n‚úÖ Thank you for your message! We will be in touch with you shortly."
  },
  {
    "objectID": "about.html#about-me",
    "href": "about.html#about-me",
    "title": "Experience | Qualifications | Skills and Expertise",
    "section": "",
    "text": "I‚Äôm an Epidemiologist and Data Analyst with over a decade of experience across government health departments, academic institutions, and public health projects. My expertise lies in transforming complex administrative and surveillance data into actionable evidence that improves public health policy, clinical practice, and health equity. I am passionate about data-driven decision-making, inclusive stakeholder engagement, and translating research into practice.\nI currently work as a Project Officer (Epidemiologist) at the Western Australia Department of Health, where I lead surveillance and reporting initiatives using linked health datasets such as the Australian Immunisation Register (AIR) and the Western Australian Notifiable Infectious Diseases Database (WANIDD). I design and manage REDCap databases, automate data processing in R, and develop interactive Shiny dashboards that support timely public health responses.\nPreviously, I worked as a Research Fellow at The University of Queensland, where I led cancer epidemiology projects with the First Nations Cancer & Wellbeing Research Program. At Cancer Council Queensland, I managed the nationally recognised Australian Cancer Atlas project, led a cancer epidemiology study, and contributed to the First Nations Advisory Group. My career reflects a strong commitment to data transparency and evidence-informed decision."
  },
  {
    "objectID": "about.html#expertise-skills",
    "href": "about.html#expertise-skills",
    "title": "Experience | Qualifications | Skills and Expertise",
    "section": " Expertise & Skills",
    "text": "Expertise & Skills\n\nStatistical & Data Tools: R, STATA, Python, SQL, Power BI, REDCap\n\nData Visualisation: Dashboards, Spatial analysis, R Shiny, ggplot2, leaflet, treemaps, heatmaps\n\nEpidemiology & Surveillance: Communicable diseases, immunisation, cancer, maternal and child health\n\nMethods & Modelling: Trend and longitudinal analysis, multilevel models, survival analysis, causal modelling, systematic reviews, meta-analysis\n\nData Sources Experience: Medicare Benefits Schedule (MBS), Pharmaceutical Benefits Scheme (PBS), Western Australian Notifiable Infectious Diseases Database (WANIDD), Australian Immunisation Register (AIR), Queensland Cancer Register, Australian Longitudinal Study on Women‚Äôs Health (ALSWH), hospital and community health datasets\n\nTeaching & Supervision: Courses in Epidemiology, Biostatistics, and Public Health; supervision of Honours and Master‚Äôs students\n\nResearch & Collaboration: Scientific writing, grant writing and management, project leadership, ethics applications, collaboration with First Nations Peoples, and engagement with state and federal health stakeholders"
  },
  {
    "objectID": "about.html#work-experience",
    "href": "about.html#work-experience",
    "title": "Experience | Qualifications | Skills and Expertise",
    "section": " Work Experience",
    "text": "Work Experience\n\nProject Officer (Epidemiologist) ‚Äì WA Department of Health\nLed disease surveillance, report automation, project management, and data visualisation for communicable disease and immunisation data.\nPostdoctoral Research Fellow ‚Äì The University of Queensland\nLed cancer epidemiology research, analysed linked data, managed state and national datasets, and contributed to Indigenous-led research strategy.\nSenior Research Officer ‚Äì Cancer Council Queensland\nLed cancer Epidemiology research project, Managed the Australian Cancer Atlas data visualisation project, applied and granted ethics approval, and coordinated with national advisory groups, project teams, and data custodians.\nResearcher and Lecturer ‚Äì Debre Markos University and Queensland University of Technology\nTaught Public Health, Epidemiology, and Biostatistics courses, assessed student work, conducted applied research, and contributed to academic leadership."
  },
  {
    "objectID": "about.html#qualifications",
    "href": "about.html#qualifications",
    "title": "Experience | Qualifications | Skills and Expertise",
    "section": " Qualifications",
    "text": "Qualifications\nI hold a PhD in Public Health and Behavioural Sciences from the University of Newcastle, Australia, and have been awarded a Master of Public Health in Epidemiology and a Bachelor of Science in Public Health.\nMy PhD research focused on adverse pregnancy outcomes in Australia using longitudinal data from the Australian Longitudinal Study on Women‚Äôs Health (ALSWH) and a systematic review. This work sharpened my skills in large data management, causal modelling, multilevel analysis, missing data analysis techniques, and statistical programming using STATA and R. I published four first-author peer-reviewed articles and presented at national conferences.\nMy postgraduate and undergraduate training provided solid foundations in Public Health, advanced epidemiology, biostatistics, disease prevention, program evaluation, and ethics. I conducted research using clinical and administrative hospital data, applied analytical tools such as STATA, SPSS, and Epi Info, and gained hands-on experience through field placements in healthcare facilities. I graduated top of my undergraduate cohort and was recruited as a junior lecturer based on academic performance.\nüí° I use data to inform decisions, advance equity, and drive actionable change in health systems."
  },
  {
    "objectID": "CV.html",
    "href": "CV.html",
    "title": "H. Mellie B",
    "section": "",
    "text": "H. Mellie B"
  },
  {
    "objectID": "Post_Blog/Data Manipulation and Wrangling.html#part-i-foundations-and-introduction",
    "href": "Post_Blog/Data Manipulation and Wrangling.html#part-i-foundations-and-introduction",
    "title": "Date Manipulation and Wrangling using R",
    "section": "1.1 PART I: FOUNDATIONS AND INTRODUCTION",
    "text": "1.1 PART I: FOUNDATIONS AND INTRODUCTION\n\n1.1.1 1.1 Getting Started with R\nThis section will cover the following contents\n- Installing R and RStudio\n- Setting working directories\n- Clearing environment and console\n- Installing and loading packages (eg tidyverse, janitor, etc.)\n\nInstalling R and RStudio\n\nWhen we begin working with R, the very first step we take is installing two important tools: R itself (the engine) and RStudio (the friendly interface we use every day). I recommend that we install R first and then RStudio immediately after.\nTo make this clear, I have prepared a complete video tutorial that you can watch step-by-step:\nWathc at AnalyticsHub YouTube\nThe video, shows:\n\nHow to Download R from the CRAN website.\nInstall RStudio, which gives us a powerful yet simple environment to work in.\nBriefly explore basic options like font size, theme (dark/light mode), and code editor settings to make RStudio comfortable for coding.\nSetting working directories\nWhen we work in R, it‚Äôs very important that we know where R is reading from and saving to.\nI often think of the working directory as the ‚Äúhome folder‚Äù where all my files live during an R session.\nWe can easily check our current working directory by typing:\n\ngetwd() \n\n[1] \"C:/Users/User/Desktop/Materials_ Course and proposals/VIP collection for Syntax code or project titles/R codes/Website profile Mod 2/Post_Blog\"\n\n\n\nThis command tells us exactly where R is currently looking for files.\nIf we want to change the working directory to a folder we are working on (for example, a project folder or a course material folder), we can use:\n\nsetwd(\"C:/Users/User/Desktop/Materials_ Course and proposals/\")\n\nAlways make sure the folder path is in quotation marks and I use forward slashes / or double backslashes \\\\ when typing the path.\nüìå We can also set the working directory easily by clicking:\n\nSession ‚ûî Set Working Directory ‚ûî Choose Directory‚Ä¶\n\nüìö Note about API tokens and special folders:\nIf you are using R for connecting to APIs, cloud storage, or services like GitHub, Dropbox, or Google Drive,\nsometimes you will need to set a working directory where your API token file is stored (for authentication).\n\nsetwd(\"C:/Users/YourName/.credentials/\") \n\n‚ö†Ô∏è Important: Always make sure API tokens and confidential files are in a secure private directory.\n\nClearing environment and console\n\n# Clear environment and console\nrm(list = ls()) # To clear the environment (remove all objects in memory)\ncat(\"\\014\") # To clear the console (like wiping a whiteboard)\n\n\nBefore starting fresh in any R session, I like to clear out everything‚Äîall variables, data, and even the clutter in the console.\nInstalling and loading packages\nWe rely on a range of packages in R for data wrangling, visualization, dashboards, and reporting.\nI typically create a vector of required packages and write a small loop to install any missing ones.\n\n\n# ------------------ Set CRAN Repository ------------------\n\noptions(repos = c(CRAN = \"https://cran.rstudio.com\"))\n\n# ------------------ List of required packages for Data Wrangling and Analysis ------------------\npackages &lt;- c(\n  \"lubridate\", \"dplyr\", \"stringr\", \"zoo\", \"tsibble\", \"ggplot2\", \"plotly\", \n  \"readr\", \"readxl\", \"haven\", \"openxlsx\", \"labelled\", \"forecast\",\n  \"prettydoc\", \"janitor\", \"knitr\", \"rmarkdown\", \"yaml\", \n  \"flextable\", \"scales\", \"gt\", \"reactable\", \"DT\", \"gmodels\", \"Hmisc\",\n  \"tidyverse\", \"tidyr\", \"officer\",\n  \"shiny\", \"shinydashboard\", \"shinythemes\", \"mice\", \"shinyWidgets\", \"bslib\", \"quarto\"\n)\n\n# ------------------ Install and load packages ------------------\nfor (pkg in packages) {\n  if (!require(pkg, character.only = TRUE)) {\n    install.packages(pkg)\n  }\n}\n\n# ------------------ Load required libraries with descriptions ------------------\nlibrary(lubridate)     # Simplifies the manipulation of dates and times in R (e.g., formatting, extracting components)\nlibrary(dplyr)         # Data manipulation: filtering, summarizing, and transforming data\nlibrary(stringr)       # Simplifies string manipulation\nlibrary(tidyr)         # Data tidying: reshaping with pivot_longer, pivot_wider, etc.\nlibrary(purrr)         # Functional programming: map functions over lists/vectors\nlibrary(forcats)       # Categorical data: reordering and labeling factor levels\n\nlibrary(zoo)           # Infrastructure for time series objects\nlibrary(tsibble)       # Tidy temporal data frames and time series modeling\nlibrary(forecast)      # Forecasting functions for time series models\n\nlibrary(readr)         # Read rectangular data like CSVs\nlibrary(readxl)        # Read Excel files (.xls and .xlsx)\nlibrary(haven)         # Import data from SAS, SPSS, and Stata\nlibrary(openxlsx)      # Write to Excel with more control\nlibrary(labelled)      # Attach and work with variable labels\n\nlibrary(ggplot2)       # Create elegant data visualizations using the grammar of graphics\nlibrary(plotly)        # Interactive visualizations using ggplot2 or standalone plotly\nlibrary(scales)        # Provides scale functions for ggplot2 (e.g., log, percent)\n\nlibrary(janitor)       # Clean data: make column names nice, tabulate, etc.\nlibrary(gmodels)       # CrossTables and other classic stats tools\nlibrary(Hmisc)         # Summarization and advanced table/label handling\nlibrary(mice)           # missing data imputation\n\nlibrary(knitr)         # Dynamic report generation in R\nlibrary(rmarkdown)     # Convert R scripts to reports in various formats\nlibrary(prettydoc)     # Beautiful HTML document templates\nlibrary(yaml)          # Read and write YAML files (used in R Markdown, Quarto)\nlibrary(officer)       # Export tables and reports to Word/PowerPoint\n\nlibrary(flextable)     # Create nicely formatted tables\nlibrary(gt)            # Grammar of tables for HTML and PDF output\nlibrary(reactable)     # Interactive data tables\nlibrary(DT)            # Wrapper of JavaScript DataTables for R\n\nlibrary(shiny)         # Build interactive web applications directly from R\nlibrary(shinydashboard)# Create dashboard layouts for Shiny apps\nlibrary(shinythemes)   # Prebuilt UI themes for Shiny apps\nlibrary(shinyWidgets)  # Enhanced UI widgets for Shiny\nlibrary(bslib)         # Bootstrap themes for Shiny and rmarkdown\n\nlibrary(quarto)        # Rendering Quarto documents\n\n\n\n1.1.2 1.2 R Syntax Symbols and Essentials\n\nOperators: &lt;-, %&gt;%, ==, &, |, ~\nAdditional Operators: %in%, ::, %&lt;&gt;%, |&gt;\nSymbols: (), [], {}, \"\", #\nCommenting, structure, and help functions (?function, args())\nUsing R scripts vs.¬†R Markdown vs.¬†Quarto\n\nIn this section, we walk through the fundamental syntax building blocks of R.\nMastering these basics helps write cleaner, more efficient, and more readable code.\nüîπ Operators\nIn R, operators are used to perform operations on objects and values:\n\nAssignment operators (&lt;-, =) store values into objects.\nPipe operators (%&gt;%, %&lt;&gt;%, |&gt;) allow chaining multiple commands together.\nComparison operators (==, !=, &lt;, &gt;) compare values for equality or relational logic.\nLogical operators (&, |, !) build logical expressions (AND, OR, NOT).\nFormula operator (~) defines models and formulas, e.g., y ~ x1 + x2.\nMembership operator (%in%) checks whether an element belongs to a set.\nPackage access operator (::) calls a function from a package without loading the full package.\n\nüîπ Symbols\nSymbols are special characters used in structuring R code:\n\n() : Used for function calls and setting arguments.\n[] : Indexing vectors, matrices, or data frames.\n{} : Grouping multiple expressions into a code block.\n\"\" or '' : Define character strings.\n# : Create comments that are ignored during code execution.\n\nüîπ Help Functions\n\n?function_name : Access the help documentation for any function.\nargs(function_name) : Display the arguments a function accepts.\nüîπ Scripting in .R, .Rmd, .qmd\n\n\n\n\n\n\n\n\nFormat\nDescription\nBest Use Case\n\n\n\n\n.R\nBasic R script. Contains code only, no formatting or output.\nExploratory coding, testing snippets\n\n\n.Rmd\nR Markdown file. Supports code + text + output in one file.\nReproducible reports, presentations, notebooks\n\n\n.qmd\nQuarto document. Successor to R Markdown with more flexible publishing.\nPolished reports, web publishing, multi-language\n\n\n\n\nüìä R Syntax Essentials Summary\n\n\n\n\n\n\n\n\nElement\nSymbol / Syntax\nWhat It Does\n\n\n\n\nAssignment\n&lt;-, =\nAssign a value to a variable (e.g., x &lt;- 5)\n\n\nPipe\n%&gt;%, %&lt;&gt;%, |&gt;\nPass or transform results between functions\n\n\nComparison\n==, !=, &lt;, &gt;\nCompare values (equal, not equal, less than, etc.)\n\n\nLogical\n&, |, !\nLogical conditions: AND, OR, NOT\n\n\nFormula\n~\nDefine model formulas (e.g., y ~ x1 + x2)\n\n\nMembership Test\n%in%\nCheck if an element exists within a vector\n\n\nPackage Function Access\n::\nCall a function from a specific package without loading it\n\n\nFunction Call\n()\nCall a function with arguments (e.g., mean(x))\n\n\nIndexing\n[]\nAccess parts of data structures (e.g., x[1], df[2,3])\n\n\nCode Block\n{}\nGroup multiple lines (loops, conditionals)\n\n\nStrings\n\"text\", 'text'\nDefine character strings\n\n\nCommenting\n#\nInsert a comment ignored by R\n\n\nHelp Functions\n?function, args(function)\nAccess help or check function arguments\n\n\nOutput Format\n.R, .Rmd, .qmd\nFile formats for scripting or reporting\n\n\n\n?mean # Opens the help page for the ‚Äòmean‚Äô function\nargs(mean) # Lists input arguments for ‚Äòmean‚Äô\n\n\n1.1.3 1.3 Keyboard Shortcut and Functions\nIn this section, I highlight essential RStudio shortcut keys that improve coding efficiency and simplify the workflow for scripting and reporting.\n\n\n\nShortcut\nAction\n\n\n\n\nCtrl + Z\nUndo the last action\n\n\nCtrl + Shift + Z\nRedo the undone action\n\n\nCtrl + Enter\nExecute the current line or selected block\n\n\nAlt + -\nInsert assignment operator &lt;-\n\n\nCtrl + Shift + M\nInsert pipe operator %&gt;%\n\n\nCtrl + L\nClear the console output\n\n\nCtrl + Shift + C\nComment or uncomment selected lines\n\n\nCtrl + Shift + S\nSource and run the entire script\n\n\nCtrl + Alt + I\nInsert a new R Markdown or Quarto code chunk\n\n\n\n\n\n\n1.1.4 1.4. Terms and Definitions: R Objects\nElement | Vector | Matrix | |Data Frame | Data Table | List | Factor | Variable | Object\nThis section provides a brief overview of foundational R data structures.\nFor more detailed explanations and demonstrations, refer to:\n\nYouTube: AnalyticsHub\nGitHub: HabtamuBizuayehu Repositories\n\nUnderstanding these fundamental terms is essential for working effectively with R data analysis and wrangling.\nüîπ Brief Narration of Key Terms\n\nElement: A single piece of data, such as a number or a character.\nVector: An ordered collection of elements of the same type (numeric, character, logical).\nMatrix: A two-dimensional collection of elements arranged by rows and columns, all of the same type.\nData Frame: A two-dimensional table where each column can contain different types of data (numeric, character, factor).\nData Table: A high-performance extension from the data.table package ‚Äî for very large datasets and faster manipulation.\nList: A flexible container that can hold elements of different types and structures (vectors, data frames, even other lists).\nFactor: A special type of vector used for categorical data, storing levels internally.\nVariable: A named object that holds data (vectors, lists, data frames, etc.).\nObject: A general term for any data structure stored in R.\n\n\nüîç Summary Table: R Objects\n\n\n\n\n\n\n\nTerm\nDefinition\n\n\n\n\nElement\nA single unit of data (e.g., 5, \"apple\")\n\n\nVector\nA sequence of elements of the same type\n\n\nMatrix\nA two-dimensional collection of homogeneous elements\n\n\nData Frame\nA two-dimensional table with heterogeneous column types\n\n\nData Table\nA fast and memory-efficient data frame extension (data.table package)\n\n\nList\nA flexible container for different types of elements\n\n\nFactor\nA categorical variable with predefined levels\n\n\nVariable\nA named object that stores data\n\n\nObject\nAny entity stored in R (data, functions, models, etc.)\n\n\n\n\n\n1.1.5 1.5. Quarto and R Markdown Options\nThis section summarizes key chunk options and syntax used in Quarto and R Markdown.\nThese settings allow flexible control over code execution, output display, figure formatting, and reporting behavior."
  },
  {
    "objectID": "Post_Blog/Data Manipulation and Wrangling.html#summary-quarto-and-r-markdown-chunk-options",
    "href": "Post_Blog/Data Manipulation and Wrangling.html#summary-quarto-and-r-markdown-chunk-options",
    "title": "Date Manipulation and Wrangling using R",
    "section": "1.2 üîç Summary: Quarto and R Markdown Chunk Options",
    "text": "1.2 üîç Summary: Quarto and R Markdown Chunk Options\n\n\n\n\n\n\n\n\nFeature\nQuarto Syntax\nDescription\n\n\n\n\nCode Chunks\n{r}\nUsed to write and execute R code. You can specify options like echo, results.\n\n\nEchoing Code\necho: true\nDisplays the code in the output (default is true). Set to false to hide the code.\n\n\nInclude Code\ninclude: false\nExecutes code but does not show the code in the final output.\n\n\nEvaluating Code\neval: false\nPrevents the code from running but still displays the code in the output.\n\n\nResults Control\nresults: 'markup' or results: 'asis'\nControls how output results are displayed (formatted or raw).\n\n\nMessage and Warnings\nmessage: false, warning: false\nControls whether messages and warnings appear in the output.\n\n\nOutput File Format\noutput: html\nSpecifies output format (html, pdf, word). Default is html.\n\n\nTable Output\nresults: 'asis' or results: 'markup'\nEnsures clean table rendering for formatted output.\n\n\nChunk Labeling\n# Label\nLabels help organize and reference code chunks easily.\n\n\nInline Code\nYour value is 2 times.\nEmbeds live code inside text for dynamic reporting.\n\n\nCaching Results\ncache: true\nSaves chunk results to avoid rerunning unchanged code. It stores the output (like objects, plots, and printed results) in a cache directory\n\n\nFigure Options\nfig.width: 7, fig.height: 5, fig.align: 'center'\nAdjusts figure size and alignment in output documents.\n\n\nOutput as LaTeX\nlatex: true\nAllows LaTeX formatting (mainly for PDFs and math expressions).\n\n\nCommenting Code\n# (within chunks)\nStandard way to comment within R code chunks.\n\n\n\n‚û°Ô∏è Mastering these options ensures smoother report generation, cleaner outputs, and faster rendering when building professional documents in Quarto or R Markdown."
  },
  {
    "objectID": "Post_Blog/Data Manipulation and Wrangling.html#part-ii-data-loading-and-exploration",
    "href": "Post_Blog/Data Manipulation and Wrangling.html#part-ii-data-loading-and-exploration",
    "title": "Date Manipulation and Wrangling using R",
    "section": "1.3 PART II: DATA LOADING AND EXPLORATION",
    "text": "1.3 PART II: DATA LOADING AND EXPLORATION\n\n1.3.1 2.1 Reading and Importing Data\n\nFile path setup and working with getwd(), paste()\nread_csv(), read_excel(), read.delim(), readRDS()\nReading .tsv, .dta, and .sav files (foreign and haven packages)\nReading from ZIP Files\n\nBefore we begin analyzing data in R, we need to bring it in from where it‚Äôs stored‚Äîyour computer, the cloud, or an online source.\nThere are many formats we commonly work with in public health and analytics: CSV, Excel, text files, RDS, SPSS, and others.\nBelow is a summary table of functions used to read each data type.\nüìä Reading Common Data Types in R\n\n\n\n\n\n\n\n\n\nData Type\nFunction\nPackage\nExample\n\n\n\n\nCSV\nread_csv(), read.csv()\nreadr / base\nread_csv(\"file.csv\")\n\n\nExcel (.xls/.xlsx)\nread_excel()\nreadxl\nread_excel(\"file.xlsx\")\n\n\nTab-separated (.tsv)\nread_tsv()\nreadr\nread_tsv(\"file.tsv\")\n\n\nText (.txt)\nread.delim()\nbase\nread.delim(\"file.txt\")\n\n\nStata (.dta)\nread_dta()\nhaven\nread_dta(\"file.dta\")\n\n\nSPSS (.sav)\nread_sav()\nhaven\nread_sav(\"file.sav\")\n\n\nRDS (R object)\nreadRDS()\nbase\nreadRDS(\"object.rds\")\n\n\nZIP archives\nunzip()\nutils (base)\nunzip(\"data.zip\", exdir = \"folder\")\n\n\nOnline Excel/CSV\ndownload.file() + reader\nbase + readxl\nDownload file, then read_excel(temp_file)\n\n\n\nBefore reading files, I usually set the working directory to the folder where my files are saved. This avoids typing full file paths every time.\nTo combine folder names and filenames dynamically: paste(getwd(), ‚Äúmy_data.csv‚Äù, sep = ‚Äú/‚Äù)\nReading Local Files\nOnce you‚Äôre in the right working directory, you can read in your files like below:\n\nsetwd(\"C:/Users/User/Desktop/Materials_ Course and proposals/Course Related/DataCamp/Data/Synthetic_data\")\n\npatients &lt;- read.csv(\"patients.csv\")\nvaccination &lt;- read.csv(\"immunizations.csv\")\n\nmedications &lt;- read.csv (paste(getwd(), \"medications.csv\", sep = \"/\"))\n\nThese are standard CSVs and can be read using read.csv() from base R, or read_csv() from the readr package for cleaner output.\nReading from ZIP Files\nSometimes, especially when downloading from government databases or health systems, data is compressed into .zip files. In R, we can easily unzip these files and extract their contents.\nSet working directory to the folder where the zip file is located\n\n# --- Define base folder manually (safe way without setwd)\nbase_folder &lt;- \"C:/Users/User/Desktop/Materials_ Course and proposals/Course Related/DataCamp/Data/Synthetic_data\"\n\n# --- Extract ZIP file into 'procedures' folder inside base\nunzip(file.path(base_folder, \"procedures.zip\"), exdir = file.path(base_folder, \"procedures\"))\n\n# --- List extracted files\nlist.files(file.path(base_folder, \"procedures\"))\n\n[1] \"procedures\"     \"procedures.csv\"\n\n# --- Read extracted CSV\nprocedures &lt;- read.csv(file.path(base_folder, \"procedures\", \"procedures.csv\"))\n\nReading Online Files\nIf the file is online, we first download it, save it to a temporary file, and then read it:\nIt is useful when working with shared datasets, APIs, or GitHub repos.\n\n# Upload Online data\n\nurl &lt;- \"https://raw.githubusercontent.com/HabtamuBizuayehu/Data-sources/main/Breast_cancer_screening.xls\"\ntemp_file &lt;- tempfile(fileext = \".xls\")\ndownload.file(url, temp_file, mode = \"wb\")\n\nbreast_cancer_data &lt;- read_excel(temp_file)\n\n2.2 Exploring Data\n\nstr(), summary(), glimpse(), head(), tail(), count()\nViewing data: view(), nrow(), ncol()\nCleaning variable names: janitor::clean_names()\nCreating a data dictionary\nWorking with column names and types\n\nOnce we load data into R, it‚Äôs important to explore it properly before doing any analysis.\nThis step helps us understand:\n\nWhat variables we have\nHow the data is structured\nIf there are any issues (like missing values, wrong data types, weird names)\n\nIn this part, we‚Äôll look at some essential functions we often use at the very beginning of a project.\nüîç Key Tools for Exploring Data (with Important Details and Tips)\n1. str(), summary(), glimpse(), head(), tail(), count()\n\nstr(df) shows the structure of the entire dataset: number of observations (rows), number of variables (columns), and data types.\nstr(df$var) shows the structure of a specific variable (single column), useful to quickly check type and contents.\nsummary(df) gives basic descriptive statistics for all variables at once.\nsummary(df$var) gives a summary for one specific variable.\nglimpse(df) (from dplyr) provides a compact sideways overview showing each variable name, type, and preview of values.\nhead(df) shows the first 6 rows of the dataset by default.\nhead(df, n = 10) shows the first 10 rows (you can customize the number with n =).\ntail(df) shows the last 6 rows of the dataset.\ntail(df, n = 8) shows the last 8 rows.\ncount(df, var) (from dplyr) counts occurrences of each unique value in a variable.\n\n‚û°Ô∏è Using str(df$var) and summary(df$var) is a fast way to inspect just one column without needing the whole dataset.\n\n2. Viewing Data\n\nview(df) opens an Excel-like data viewer window inside RStudio for easy manual exploration.\nnrow(df) returns the number of rows.\nncol(df) returns the number of columns.\ndim(df) returns a two-number vector: (rows, columns).\n\n‚û°Ô∏è Use view(df) when you want to sort/filter manually without coding.\n\n3. Cleaning Variable Names\n\njanitor::clean_names(df) standardizes messy variable names:\n\nMakes all names lowercase\nReplaces spaces and special characters with underscores\nRemoves parentheses, punctuation, etc.\n\n\n‚û°Ô∏è Run clean_names() immediately after loading raw survey, registry, or administrative datasets.\nExample:\n\nnames(patients)\n\n [1] \"Id\"                  \"BIRTHDATE\"           \"DEATHDATE\"          \n [4] \"SSN\"                 \"DRIVERS\"             \"PASSPORT\"           \n [7] \"PREFIX\"              \"FIRST\"               \"MIDDLE\"             \n[10] \"LAST\"                \"SUFFIX\"              \"MAIDEN\"             \n[13] \"MARITAL\"             \"RACE\"                \"ETHNICITY\"          \n[16] \"GENDER\"              \"BIRTHPLACE\"          \"ADDRESS\"            \n[19] \"CITY\"                \"STATE\"               \"COUNTY\"             \n[22] \"FIPS\"                \"ZIP\"                 \"LAT\"                \n[25] \"LON\"                 \"HEALTHCARE_EXPENSES\" \"HEALTHCARE_COVERAGE\"\n[28] \"INCOME\"             \n\ntemp &lt;- janitor::clean_names(patients)\ncolnames(temp)\n\n [1] \"id\"                  \"birthdate\"           \"deathdate\"          \n [4] \"ssn\"                 \"drivers\"             \"passport\"           \n [7] \"prefix\"              \"first\"               \"middle\"             \n[10] \"last\"                \"suffix\"              \"maiden\"             \n[13] \"marital\"             \"race\"                \"ethnicity\"          \n[16] \"gender\"              \"birthplace\"          \"address\"            \n[19] \"city\"                \"state\"               \"county\"             \n[22] \"fips\"                \"zip\"                 \"lat\"                \n[25] \"lon\"                 \"healthcare_expenses\" \"healthcare_coverage\"\n[28] \"income\"             \n\nrm(temp)\n\nüîç Listing All Data Frames and Variables\nTo organize and review datasets loaded in the environment, the following workflow lists all data frames and their variables:\n\nrm (breast_cancer_data, patients)\n\n# 1. List all data frames in the environment\ndfs &lt;- ls(envir = .GlobalEnv)[sapply(ls(envir = .GlobalEnv), function(x) is.data.frame(get(x)))]\n\n# 2. For each data frame, list its variable (column) names\ndf_variables &lt;- lapply(dfs, function(df_name) {\n  vars &lt;- names(get(df_name))\n  data.frame(\n    DataFrame = df_name,\n    Variable = vars,\n    stringsAsFactors = FALSE\n  )\n})\n\n# 3. Combine into one clean table\ndf_variables_all &lt;- do.call(rbind, df_variables)\n\n# View the result\nprint(df_variables_all)\n\n     DataFrame          Variable\n1  medications             START\n2  medications              STOP\n3  medications           PATIENT\n4  medications             PAYER\n5  medications         ENCOUNTER\n6  medications              CODE\n7  medications       DESCRIPTION\n8  medications         BASE_COST\n9  medications    PAYER_COVERAGE\n10 medications         DISPENSES\n11 medications         TOTALCOST\n12 medications        REASONCODE\n13 medications REASONDESCRIPTION\n14  procedures             START\n15  procedures              STOP\n16  procedures           PATIENT\n17  procedures         ENCOUNTER\n18  procedures            SYSTEM\n19  procedures              CODE\n20  procedures       DESCRIPTION\n21  procedures         BASE_COST\n22  procedures        REASONCODE\n23  procedures REASONDESCRIPTION\n24 vaccination              DATE\n25 vaccination           PATIENT\n26 vaccination         ENCOUNTER\n27 vaccination              CODE\n28 vaccination       DESCRIPTION\n29 vaccination         BASE_COST\n\nrm (df_variables_all, df_variables) # clean working enviroment \n\n4. Creating a Data Dictionary\nA data dictionary is a simple but critical table that documents:\n\nVariable names (column names)\nDescriptions (what each variable represents)\nTypes (numeric, character, factor)\n\n‚û°Ô∏è We can automate building a basic data dictionary by combining names(), sapply(), and class() functions.\n\ndata_dictionary &lt;- data.frame(\n  Variable = names(patients),\n  Type = sapply(patients, class)\n)\n\nThe dictionary can be expanded by manually adding descriptions, coding instructions, or value mappings where necessary.\n5. Working with Column Names and Types\n\nnames(df) or colnames(df) retrieves a list of all column names.\nclass(df$var) reveals the data type of a specific variable.\nsapply(df, class) applies class() across all variables and summarizes their types.\nIf needed, variables can be recast to appropriate types.\n\nüìä Summary Table: Key Functions for Exploring Data\n\n\n\n\n\n\n\n\nTask\nFunction\nPurpose / What It Does\n\n\n\n\nView structure of dataset\nstr(df)\nShows structure: number of rows, columns, and variable types\n\n\nView structure of variable\nstr(df$var)\nShows structure/type of a specific variable\n\n\nSummarize statistics (dataset)\nsummary(df)\nProvides summary stats (min, max, mean, NA count) for all variables\n\n\nSummarize statistics (variable)\nsummary(df$var)\nSummary stats for a specific variable\n\n\nCompact structure overview\nglimpse(df)\nQuick, sideways compact view of dataset (from dplyr)\n\n\nPreview first rows\nhead(df), head(df, n = 10)\nDisplays first 6 or specified number of rows\n\n\nPreview last rows\ntail(df), tail(df, n = 8)\nDisplays last 6 or specified number of rows\n\n\nCount frequencies\ncount(df, var)\nCounts unique values and frequency of a specified variable\n\n\nOpen full viewer\nview(df)\nOpens Excel-style data viewer window (RStudio)\n\n\nCheck number of rows\nnrow(df)\nReturns number of rows (observations)\n\n\nCheck number of columns\nncol(df)\nReturns number of columns (variables)\n\n\nCheck both dimensions\ndim(df)\nReturns (rows, columns) as a two-number vector\n\n\nClean column names\njanitor::clean_names(df)\nConverts messy names into lowercase, underscore-separated names\n\n\nList variable names\nnames(df), colnames(df)\nLists all column names in a data frame\n\n\nCheck variable type\nclass(df$var)\nReturns data type of a specific variable\n\n\nCheck types for all variables\nsapply(df, class)\nReturns data types for every column in the dataset\n\n\nCreate basic data dictionary\ndata.frame(Variable = names(df), Type = sapply(df, class))\nTable summarizing variable names and types\n\n\nList all data frames in environment\ndfs &lt;- ls(...)[sapply(...)]\nIdentifies and lists all data frames currently loaded\n\n\nList all variables from all data frames\nlapply(dfs, function(x) names(get(x)))\nCreates table listing data frames and their variables\n\n\n\nNow I can apply some of the above to my datasets (df): such as breast_cancer_data, vaccination, patients\n\nbreast_cancer_data_demo &lt;- breast_cancer_data %&gt;%\n  select(sa3name, state, year, part50_74, rate50_74)\n\n# Structure of the demo dataset\nstr(breast_cancer_data_demo)\n\n'data.frame':   1364 obs. of  5 variables:\n $ sa3name  : chr  \"Queanbeyan\" \"Queanbeyan\" \"Queanbeyan\" \"Queanbeyan\" ...\n $ state    : chr  \"NSW\" \"NSW\" \"NSW\" \"NSW\" ...\n $ year     : int  201617 201718 201819 201920 201617 201718 201819 201920 201617 201718 ...\n $ part50_74: num  4875 5048 5276 5179 1850 ...\n $ rate50_74: num  60.5 60.8 61.4 58.2 59.7 ...\n\n# Summary statistics for rate50_74\nsummary(breast_cancer_data_demo$rate50_74)\n\n   Min. 1st Qu.  Median    Mean 3rd Qu.    Max.    NA's \n   5.40   50.07   54.50   53.63   57.88   80.20     135 \n\n# Display first 10 rows\nhead(breast_cancer_data_demo, 10)\n\n           sa3name state   year part50_74 rate50_74\n1       Queanbeyan   NSW 201617      4875  60.50000\n2       Queanbeyan   NSW 201718      5048  60.75961\n3       Queanbeyan   NSW 201819      5276  61.43839\n4       Queanbeyan   NSW 201920      5179  58.16834\n5  Snowy Mountains   NSW 201617      1850  59.70000\n6  Snowy Mountains   NSW 201718      1910  61.54862\n7  Snowy Mountains   NSW 201819      2039  65.12912\n8  Snowy Mountains   NSW 201920      1979  62.23419\n9      South Coast   NSW 201617      9469  62.80000\n10     South Coast   NSW 201718      9565  62.94230\n\n# Count number of records\ncount(breast_cancer_data_demo)\n\n     n\n1 1364\n\n# Show variable names\nnames(breast_cancer_data_demo)\n\n[1] \"sa3name\"   \"state\"     \"year\"      \"part50_74\" \"rate50_74\""
  },
  {
    "objectID": "Post_Blog/Data Manipulation and Wrangling.html#part-iii-wrangling-with-dplyr",
    "href": "Post_Blog/Data Manipulation and Wrangling.html#part-iii-wrangling-with-dplyr",
    "title": "Date Manipulation and Wrangling using R",
    "section": "1.4 PART III: WRANGLING WITH dplyr",
    "text": "1.4 PART III: WRANGLING WITH dplyr\nIn this part, we focus on mastering core data wrangling skills using the dplyr package, one of the most powerful tools in R for data manipulation.\nWe will learn how to select, rename, create, modify, group, sort, slice, and reshape datasets.\nThese operations form the foundation for preparing clean, organized, and analysis-ready data.\nEach subsection introduces a set of essential verbs (select(), mutate(), group_by(), etc.) that allow for data transformation pipelines. Examples and practical applications will be provided throughout to demonstrate how to use dplyr.\n\n\n1.4.1 3.1 Selecting, Dropping, Reordering, and Renaming Variables (Columns)\n\nselect(), rename(), relocate()`\nColumn helpers: starts_with(), ends_with(), contains(), last_clos, matches\nAllow modifying entire groups of column names by adding prefixes or suffixes\nHandling null/missing column names\n\nSelecting, reordering, and renaming variables is often the first step when preparing a dataset for analysis.\nIn dplyr, we use functions such as select(), rename(), and relocate() to organize variables, clean up data, and prepare for transformations.\nDropping unnecessary columns or reordering variables can make the data cleaner, faster to work with, and easier to understand.\nAdditional tools allow modifying groups of column names by adding prefixes or suffixes, and safely handling missing columns during selection.\n\nüîπ Summary of Functions for Selecting, Reordering, Dropping, and Renaming\n\n\n\n\n\n\n\n\nTask\nFunction\nPurpose\n\n\n\n\nSelect specific columns\nselect()\nChoose a subset of columns based on name or condition\n\n\nRename columns\nrename()\nRename one or multiple columns\n\n\nRelocate columns\nrelocate()\nMove selected columns to a new position\n\n\nReorder manually\nselect(a, b, c, everything())\nExplicitly define column order\n\n\nFind columns by pattern\nstarts_with(), ends_with(), contains(), matches()\nSelect columns matching a pattern\n\n\nDrop single column\nselect(-col1)\nRemove one variable\n\n\nDrop multiple columns\nselect(-col1, -col2)\nRemove several variables\n\n\nDrop by pattern\nselect(-starts_with(\"temp\")), select(-contains(\"score\"))\nRemove variables based on naming patterns\n\n\nAdd prefix to column names\nrename_with(~ paste0(\"prefix_\", .x))\nAdd a prefix to selected columns\n\n\nAdd suffix to column names\nrename_with(~ paste0(.x, \"_suffix\"))\nAdd a suffix to selected columns\n\n\nHandle missing columns safely\nif(\"var\" %in% names(df)) {}\nAvoid errors when column does not exist\n\n\n\n\n‚û°Ô∏è These techniques allow quick restructuring of datasets, improving workflow efficiency and clarity.\n\nüîπ Examples Using the vaccination Dataset\n\n# Selecting specific columns manually\nbreast_selected &lt;- breast_cancer_data %&gt;%\n  select(sa3code, sa3name, year, part50_74, pop50_74)\n\nhead(breast_selected, n = 3)\n\n  sa3code    sa3name   year part50_74 pop50_74\n1   10102 Queanbeyan 201617      4875     8052\n2   10102 Queanbeyan 201718      5048     8309\n3   10102 Queanbeyan 201819      5276     8588\n\n# Reordering columns manually (bring year, sa3name, state first)\nbc_reorder_manual &lt;- breast_cancer_data %&gt;%\n  select(year, sa3name, state, everything())\n\nhead(bc_reorder_manual, n = 3)\n\n    year    sa3name state sa3code sa3coden part50_74 pop50_74 rate50_74\n1 201617 Queanbeyan   NSW   10102    10102      4875     8052  60.50000\n2 201718 Queanbeyan   NSW   10102    10102      5048     8309  60.75961\n3 201819 Queanbeyan   NSW   10102    10102      5276     8588  61.43839\n  agen50_74 expct50_74 part50_69 pop50_69 rate50_69 agen50_69 expct50_69\n1         3       4428      4309     7145  60.30000         2       3929\n2         3       4553      4448     7338  60.62238         2       4013\n3         3       4706      4629     7548  61.33203         2       4113\n  part50_54 pop50_54 rate50_54 agen50_54 expct50_54 part55_59 pop55_59\n1      1284     2251  57.00000         1       1118      1188     1970\n2      1285     2306  55.72035         1       1143      1260     2030\n3      1375     2342  58.70977         1       1166      1252     2093\n  rate55_59 agen55_59 expct55_59 part60_64 pop60_64 rate60_64 agen60_64\n1  60.30000         4       1046      1012     1625  62.30000         5\n2  62.09035         4       1069      1048     1646  63.69947         5\n3  59.81504         4       1098      1105     1689  65.43657         5\n  expct60_64 part65_69 pop65_69 rate65_69 agen65_69 expct65_69 part70_74\n1        950       826     1300  63.50000         6        781       566\n2        953       855     1357  63.02558         6        812       600\n3        967       898     1426  63.00429         6        849       647\n  pop70_74 rate70_74 agen70_74 expct70_74\n1      907  62.40000         7        498\n2      971  61.79725         7        541\n3     1040  62.21032         7        585\n\n# Relocating specific columns before another variable\nbc_relocate_before &lt;- breast_cancer_data %&gt;%\n  relocate(part50_74, pop50_74, .before = rate50_74)\n\nhead(bc_relocate_before, n = 3)\n\n  sa3code sa3coden    sa3name state   year part50_74 pop50_74 rate50_74\n1   10102    10102 Queanbeyan   NSW 201617      4875     8052  60.50000\n2   10102    10102 Queanbeyan   NSW 201718      5048     8309  60.75961\n3   10102    10102 Queanbeyan   NSW 201819      5276     8588  61.43839\n  agen50_74 expct50_74 part50_69 pop50_69 rate50_69 agen50_69 expct50_69\n1         3       4428      4309     7145  60.30000         2       3929\n2         3       4553      4448     7338  60.62238         2       4013\n3         3       4706      4629     7548  61.33203         2       4113\n  part50_54 pop50_54 rate50_54 agen50_54 expct50_54 part55_59 pop55_59\n1      1284     2251  57.00000         1       1118      1188     1970\n2      1285     2306  55.72035         1       1143      1260     2030\n3      1375     2342  58.70977         1       1166      1252     2093\n  rate55_59 agen55_59 expct55_59 part60_64 pop60_64 rate60_64 agen60_64\n1  60.30000         4       1046      1012     1625  62.30000         5\n2  62.09035         4       1069      1048     1646  63.69947         5\n3  59.81504         4       1098      1105     1689  65.43657         5\n  expct60_64 part65_69 pop65_69 rate65_69 agen65_69 expct65_69 part70_74\n1        950       826     1300  63.50000         6        781       566\n2        953       855     1357  63.02558         6        812       600\n3        967       898     1426  63.00429         6        849       647\n  pop70_74 rate70_74 agen70_74 expct70_74\n1      907  62.40000         7        498\n2      971  61.79725         7        541\n3     1040  62.21032         7        585\n\n# Relocating specific columns after another variable\nbc_relocate_after &lt;- breast_cancer_data %&gt;%\n  relocate(sa3name, state, .after = year)\n\nhead(bc_relocate_after, n = 3)\n\n  sa3code sa3coden   year    sa3name state part50_74 pop50_74 rate50_74\n1   10102    10102 201617 Queanbeyan   NSW      4875     8052  60.50000\n2   10102    10102 201718 Queanbeyan   NSW      5048     8309  60.75961\n3   10102    10102 201819 Queanbeyan   NSW      5276     8588  61.43839\n  agen50_74 expct50_74 part50_69 pop50_69 rate50_69 agen50_69 expct50_69\n1         3       4428      4309     7145  60.30000         2       3929\n2         3       4553      4448     7338  60.62238         2       4013\n3         3       4706      4629     7548  61.33203         2       4113\n  part50_54 pop50_54 rate50_54 agen50_54 expct50_54 part55_59 pop55_59\n1      1284     2251  57.00000         1       1118      1188     1970\n2      1285     2306  55.72035         1       1143      1260     2030\n3      1375     2342  58.70977         1       1166      1252     2093\n  rate55_59 agen55_59 expct55_59 part60_64 pop60_64 rate60_64 agen60_64\n1  60.30000         4       1046      1012     1625  62.30000         5\n2  62.09035         4       1069      1048     1646  63.69947         5\n3  59.81504         4       1098      1105     1689  65.43657         5\n  expct60_64 part65_69 pop65_69 rate65_69 agen65_69 expct65_69 part70_74\n1        950       826     1300  63.50000         6        781       566\n2        953       855     1357  63.02558         6        812       600\n3        967       898     1426  63.00429         6        849       647\n  pop70_74 rate70_74 agen70_74 expct70_74\n1      907  62.40000         7        498\n2      971  61.79725         7        541\n3     1040  62.21032         7        585\n\n# Dropping one variable\nbc_drop_one &lt;- breast_cancer_data %&gt;%\n  select(-expct50_74)\n\nhead(bc_drop_one, n = 3)\n\n  sa3code sa3coden    sa3name state   year part50_74 pop50_74 rate50_74\n1   10102    10102 Queanbeyan   NSW 201617      4875     8052  60.50000\n2   10102    10102 Queanbeyan   NSW 201718      5048     8309  60.75961\n3   10102    10102 Queanbeyan   NSW 201819      5276     8588  61.43839\n  agen50_74 part50_69 pop50_69 rate50_69 agen50_69 expct50_69 part50_54\n1         3      4309     7145  60.30000         2       3929      1284\n2         3      4448     7338  60.62238         2       4013      1285\n3         3      4629     7548  61.33203         2       4113      1375\n  pop50_54 rate50_54 agen50_54 expct50_54 part55_59 pop55_59 rate55_59\n1     2251  57.00000         1       1118      1188     1970  60.30000\n2     2306  55.72035         1       1143      1260     2030  62.09035\n3     2342  58.70977         1       1166      1252     2093  59.81504\n  agen55_59 expct55_59 part60_64 pop60_64 rate60_64 agen60_64 expct60_64\n1         4       1046      1012     1625  62.30000         5        950\n2         4       1069      1048     1646  63.69947         5        953\n3         4       1098      1105     1689  65.43657         5        967\n  part65_69 pop65_69 rate65_69 agen65_69 expct65_69 part70_74 pop70_74\n1       826     1300  63.50000         6        781       566      907\n2       855     1357  63.02558         6        812       600      971\n3       898     1426  63.00429         6        849       647     1040\n  rate70_74 agen70_74 expct70_74\n1  62.40000         7        498\n2  61.79725         7        541\n3  62.21032         7        585\n\n# Dropping multiple variables\nbc_drop_multiple &lt;- breast_cancer_data %&gt;%\n  select(-expct50_74, -expct50_69)\n\nhead(bc_drop_multiple, n = 3)\n\n  sa3code sa3coden    sa3name state   year part50_74 pop50_74 rate50_74\n1   10102    10102 Queanbeyan   NSW 201617      4875     8052  60.50000\n2   10102    10102 Queanbeyan   NSW 201718      5048     8309  60.75961\n3   10102    10102 Queanbeyan   NSW 201819      5276     8588  61.43839\n  agen50_74 part50_69 pop50_69 rate50_69 agen50_69 part50_54 pop50_54 rate50_54\n1         3      4309     7145  60.30000         2      1284     2251  57.00000\n2         3      4448     7338  60.62238         2      1285     2306  55.72035\n3         3      4629     7548  61.33203         2      1375     2342  58.70977\n  agen50_54 expct50_54 part55_59 pop55_59 rate55_59 agen55_59 expct55_59\n1         1       1118      1188     1970  60.30000         4       1046\n2         1       1143      1260     2030  62.09035         4       1069\n3         1       1166      1252     2093  59.81504         4       1098\n  part60_64 pop60_64 rate60_64 agen60_64 expct60_64 part65_69 pop65_69\n1      1012     1625  62.30000         5        950       826     1300\n2      1048     1646  63.69947         5        953       855     1357\n3      1105     1689  65.43657         5        967       898     1426\n  rate65_69 agen65_69 expct65_69 part70_74 pop70_74 rate70_74 agen70_74\n1  63.50000         6        781       566      907  62.40000         7\n2  63.02558         6        812       600      971  61.79725         7\n3  63.00429         6        849       647     1040  62.21032         7\n  expct70_74\n1        498\n2        541\n3        585\n\n# Dropping variables by pattern (e.g., columns ending with \"_69\")\nbc_drop_by_pattern &lt;- breast_cancer_data %&gt;%\n  select(-ends_with(\"_69\"))\n\nhead(bc_drop_by_pattern, n = 3)\n\n  sa3code sa3coden    sa3name state   year part50_74 pop50_74 rate50_74\n1   10102    10102 Queanbeyan   NSW 201617      4875     8052  60.50000\n2   10102    10102 Queanbeyan   NSW 201718      5048     8309  60.75961\n3   10102    10102 Queanbeyan   NSW 201819      5276     8588  61.43839\n  agen50_74 expct50_74 part50_54 pop50_54 rate50_54 agen50_54 expct50_54\n1         3       4428      1284     2251  57.00000         1       1118\n2         3       4553      1285     2306  55.72035         1       1143\n3         3       4706      1375     2342  58.70977         1       1166\n  part55_59 pop55_59 rate55_59 agen55_59 expct55_59 part60_64 pop60_64\n1      1188     1970  60.30000         4       1046      1012     1625\n2      1260     2030  62.09035         4       1069      1048     1646\n3      1252     2093  59.81504         4       1098      1105     1689\n  rate60_64 agen60_64 expct60_64 part70_74 pop70_74 rate70_74 agen70_74\n1  62.30000         5        950       566      907  62.40000         7\n2  63.69947         5        953       600      971  61.79725         7\n3  65.43657         5        967       647     1040  62.21032         7\n  expct70_74\n1        498\n2        541\n3        585\n\n# Renaming a column for clarity\nbreast_renamed &lt;- breast_selected %&gt;%\n  rename(SA3_Code = sa3code, SA3_Name = sa3name, Year = year)\n\nhead(breast_renamed, n = 3)\n\n  SA3_Code   SA3_Name   Year part50_74 pop50_74\n1    10102 Queanbeyan 201617      4875     8052\n2    10102 Queanbeyan 201718      5048     8309\n3    10102 Queanbeyan 201819      5276     8588\n\n# Adding a prefix to all column names\nbc_prefixed &lt;- breast_cancer_data %&gt;%\n  rename_with(~ paste0(\"bc_\", .x))\n\nhead(bc_prefixed, n = 3)\n\n  bc_sa3code bc_sa3coden bc_sa3name bc_state bc_year bc_part50_74 bc_pop50_74\n1      10102       10102 Queanbeyan      NSW  201617         4875        8052\n2      10102       10102 Queanbeyan      NSW  201718         5048        8309\n3      10102       10102 Queanbeyan      NSW  201819         5276        8588\n  bc_rate50_74 bc_agen50_74 bc_expct50_74 bc_part50_69 bc_pop50_69 bc_rate50_69\n1     60.50000            3          4428         4309        7145     60.30000\n2     60.75961            3          4553         4448        7338     60.62238\n3     61.43839            3          4706         4629        7548     61.33203\n  bc_agen50_69 bc_expct50_69 bc_part50_54 bc_pop50_54 bc_rate50_54 bc_agen50_54\n1            2          3929         1284        2251     57.00000            1\n2            2          4013         1285        2306     55.72035            1\n3            2          4113         1375        2342     58.70977            1\n  bc_expct50_54 bc_part55_59 bc_pop55_59 bc_rate55_59 bc_agen55_59\n1          1118         1188        1970     60.30000            4\n2          1143         1260        2030     62.09035            4\n3          1166         1252        2093     59.81504            4\n  bc_expct55_59 bc_part60_64 bc_pop60_64 bc_rate60_64 bc_agen60_64\n1          1046         1012        1625     62.30000            5\n2          1069         1048        1646     63.69947            5\n3          1098         1105        1689     65.43657            5\n  bc_expct60_64 bc_part65_69 bc_pop65_69 bc_rate65_69 bc_agen65_69\n1           950          826        1300     63.50000            6\n2           953          855        1357     63.02558            6\n3           967          898        1426     63.00429            6\n  bc_expct65_69 bc_part70_74 bc_pop70_74 bc_rate70_74 bc_agen70_74\n1           781          566         907     62.40000            7\n2           812          600         971     61.79725            7\n3           849          647        1040     62.21032            7\n  bc_expct70_74\n1           498\n2           541\n3           585\n\n# Adding a suffix to all column names\nbc_suffixed &lt;- breast_cancer_data %&gt;%\n  rename_with(~ paste0(.x, \"_info\"))\n\nhead(bc_suffixed, n = 3)\n\n  sa3code_info sa3coden_info sa3name_info state_info year_info part50_74_info\n1        10102         10102   Queanbeyan        NSW    201617           4875\n2        10102         10102   Queanbeyan        NSW    201718           5048\n3        10102         10102   Queanbeyan        NSW    201819           5276\n  pop50_74_info rate50_74_info agen50_74_info expct50_74_info part50_69_info\n1          8052       60.50000              3            4428           4309\n2          8309       60.75961              3            4553           4448\n3          8588       61.43839              3            4706           4629\n  pop50_69_info rate50_69_info agen50_69_info expct50_69_info part50_54_info\n1          7145       60.30000              2            3929           1284\n2          7338       60.62238              2            4013           1285\n3          7548       61.33203              2            4113           1375\n  pop50_54_info rate50_54_info agen50_54_info expct50_54_info part55_59_info\n1          2251       57.00000              1            1118           1188\n2          2306       55.72035              1            1143           1260\n3          2342       58.70977              1            1166           1252\n  pop55_59_info rate55_59_info agen55_59_info expct55_59_info part60_64_info\n1          1970       60.30000              4            1046           1012\n2          2030       62.09035              4            1069           1048\n3          2093       59.81504              4            1098           1105\n  pop60_64_info rate60_64_info agen60_64_info expct60_64_info part65_69_info\n1          1625       62.30000              5             950            826\n2          1646       63.69947              5             953            855\n3          1689       65.43657              5             967            898\n  pop65_69_info rate65_69_info agen65_69_info expct65_69_info part70_74_info\n1          1300       63.50000              6             781            566\n2          1357       63.02558              6             812            600\n3          1426       63.00429              6             849            647\n  pop70_74_info rate70_74_info agen70_74_info expct70_74_info\n1           907       62.40000              7             498\n2           971       61.79725              7             541\n3          1040       62.21032              7             585\n\n# Handling missing columns safely during selection\nif (\"non_existing_column\" %in% names(breast_cancer_data)) {\n  bc_safe_select &lt;- breast_cancer_data %&gt;%\n    select(non_existing_column)\n  head(bc_safe_select, n = 3)\n} else {\n  message(\"Column 'non_existing_column' not found in breast_cancer_data.\")\n}\n\nColumn 'non_existing_column' not found in breast_cancer_data.\n\n# ....................................................\n# Remove all temporary objects created in this chunk\n# ....................................................\nrm(breast_selected, breast_renamed, bc_drop_one, bc_drop_multiple, bc_drop_by_pattern,\n   bc_reorder_manual, bc_relocate_before, bc_relocate_after,\n   bc_prefixed, bc_suffixed)\n\n\n\n1.4.2 3.2 Creating and Modifying Variables (Columns)\n\nmutate(), transmute(), recoding, case_when(), if_else()\nstr_detect(), regex(), %in%\nCreating dummy/flag variables\nString manipulation: strsplit(), sub(), gsub(), tolower(), `janitor::clean_names()`\n\nCreating new variables or modifying existing ones is a key part of preparing data for analysis.\nIn dplyr, we use functions like mutate() and transmute() to add, transform, or recode variables.\nWe can also create conditional variables with case_when() or if_else(), and apply string operations such as splitting, replacing, or converting text.\nThese steps help structure the data more logically, highlight important features, or derive new indicators for analysis.\n\nüîπ Summary of Functions for Creating and Modifying Variables\n\n\n\n\n\n\n\n\nTask\nFunction\nPurpose\n\n\n\n\nCreate or modify variables\nmutate()\nAdd or transform variables, keeping all columns\n\n\nCreate new variables only\ntransmute()\nKeep only new variables created\n\n\nConditional variable creation\ncase_when()\nCreate new variables based on multiple conditions\n\n\nSimple conditional assignment\nif_else()\nAssign based on TRUE/FALSE logic\n\n\nSplit strings into parts\nstrsplit()\nSplit a string into components\n\n\nReplace text (first occurrence)\nsub()\nReplace first match of a pattern\n\n\nReplace text (all occurrences)\ngsub()\nReplace all matches of a pattern\n\n\nConvert text to lowercase\ntolower()\nStandardize text to lowercase\n\n\nDetect text patterns\nstr_detect()\nCheck if a pattern exists in text\n\n\nFlexible pattern matching\nregex()\nUse regular expressions for complex patterns\n\n\nMembership check\n%in%\nTest if a value is part of a group\n\n\n\n\n‚û°Ô∏è These functions allow transforming the dataset systematically to extract new features, categorize information, or clean fields.\n\n# Creating and Modifying Variables (patients dataset)\n\n# Creating a new age group variable\npatients_mutated &lt;- patients %&gt;%\n  mutate(age_group = if_else(BIRTHDATE &lt;= as.Date(\"1970-01-01\"), \"Below 70\", \"70+\")) %&gt;%\n  relocate(age_group, .after = BIRTHDATE) %&gt;%\n  select(-Id, -DEATHDATE, -SSN, -LAT, -LON, -SUFFIX, -ZIP)\n\nhead(patients_mutated, 10)\n\n    BIRTHDATE age_group   DRIVERS   PASSPORT PREFIX       FIRST       MIDDLE\n1  1994-02-06       70+ S99996852 X47758697X    Mr.   Joshua658      Alvin56\n2  1968-08-06  Below 70 S99993577 X28173268X    Mr.   Bennie663             \n3  2008-12-21       70+                               Hunter736  Mckinley734\n4  1994-01-27       70+ S99995100 X83694889X   Mrs.   Carlyn477 Florencia449\n5  2019-07-27       70+                                 Robin66    Jeramy610\n6  2019-04-18       70+                               Arthur650             \n7  2013-08-10       70+                                 Caryl47     Lelia627\n8  1968-08-06  Below 70 S99911538 X37637991X    Mr.  Willian804    Shelton25\n9  2006-07-02       70+ S99943171               Ms. Domenica436             \n10 1948-05-28  Below 70 S99941458 X59458953X    Mr.  Arnulfo253    Jordan900\n            LAST   MAIDEN MARITAL  RACE   ETHNICITY GENDER\n1       Kunde533                M white nonhispanic      M\n2       Ebert178                D white nonhispanic      M\n3     Gerlach374                  white nonhispanic      M\n4  Williamson769 Rogahn59       M asian nonhispanic      F\n5   Gleichner915                  white nonhispanic      M\n6     Roberts511                  white nonhispanic      M\n7    Kassulke119                  white nonhispanic      F\n8      Keeling57                M white nonhispanic      M\n9         Rau926                  white    hispanic      F\n10  Jaskolski867                D white nonhispanic      M\n                         BIRTHPLACE                     ADDRESS         CITY\n1         Boston  Massachusetts  US            811 Kihn Viaduct    Braintree\n2       Chicopee  Massachusetts  US 975 Pfannerstill Throughway    Braintree\n3        Spencer  Massachusetts  US             548 Heller Lane Mattapoisett\n4       Franklin  Massachusetts  US  160 Fadel Crossroad Apt 65      Wareham\n5       Brockton  Massachusetts  US      766 Grant Loaf Unit 15    Groveland\n6       Plymouth  Massachusetts  US            866 Kulas Harbor    Cambridge\n7  East Falmouth  Massachusetts  US            578 Dickens Camp    Arlington\n8        Methuen  Massachusetts  US      848 Ebert Knoll Unit 7    Braintree\n9        Maynard  Massachusetts  US             963 Senger Fort    Haverhill\n10        Boston  Massachusetts  US    757 Lockman Annex Apt 10   Georgetown\n           STATE           COUNTY  FIPS HEALTHCARE_EXPENSES HEALTHCARE_COVERAGE\n1  Massachusetts   Norfolk County 25021            56904.96            18019.99\n2  Massachusetts   Norfolk County 25021           124024.12             1075.06\n3  Massachusetts  Plymouth County    NA            45645.06             6154.94\n4  Massachusetts  Plymouth County    NA            12895.15           659951.61\n5  Massachusetts     Essex County    NA            18500.02             5493.57\n6  Massachusetts Middlesex County 25017            14478.23              693.39\n7  Massachusetts Middlesex County 25017             9821.14            27142.51\n8  Massachusetts   Norfolk County 25021           175817.63            55473.97\n9  Massachusetts     Essex County 25009            52933.16            11941.44\n10 Massachusetts     Essex County    NA           242013.44           322768.97\n   INCOME\n1  100511\n2   49737\n3  133816\n4   17382\n5   52159\n6   75767\n7   58294\n8   49737\n9   77756\n10  35255\n\n# extract month and year from date in form of date is YYYY-MM-DD HH:MM:SS\nstr (vaccination$DATE) # date is YYYY-MM-DD HH:MM:SS format.\n\n chr [1:1619] \"2016-04-10T09:04:48Z\" \"2016-04-10T09:04:48Z\" ...\n\nvaccination &lt;- vaccination %&gt;%\n  mutate(\n    vacc_date = as.Date(strptime(DATE, format = \"%Y-%m-%dT%H:%M:%SZ\")),  # First create vacc_date\n    year = format(vacc_date, \"%Y\"),         # Extract year\n    month = format(vacc_date, \"%B\")          # Extract full month name (January, February, etc.)\n  )\n\ncolnames(vaccination)\n\n[1] \"DATE\"        \"PATIENT\"     \"ENCOUNTER\"   \"CODE\"        \"DESCRIPTION\"\n[6] \"BASE_COST\"   \"vacc_date\"   \"year\"        \"month\"      \n\nhead(vaccination)\n\n                  DATE                              PATIENT\n1 2016-04-10T09:04:48Z 30a6452c-4297-a1ac-977a-6a23237c7b46\n2 2016-04-10T09:04:48Z 30a6452c-4297-a1ac-977a-6a23237c7b46\n3 2016-04-10T09:04:48Z 30a6452c-4297-a1ac-977a-6a23237c7b46\n4 2016-04-10T09:04:48Z 30a6452c-4297-a1ac-977a-6a23237c7b46\n5 2002-10-29T19:07:21Z 34a4dcc4-35fb-6ad5-ab98-be285c586a4f\n6 2005-11-01T19:07:21Z 34a4dcc4-35fb-6ad5-ab98-be285c586a4f\n                             ENCOUNTER CODE\n1 0b03e41b-06a6-66fa-b972-acc5a83b134a  140\n2 0b03e41b-06a6-66fa-b972-acc5a83b134a  113\n3 0b03e41b-06a6-66fa-b972-acc5a83b134a   43\n4 0b03e41b-06a6-66fa-b972-acc5a83b134a  114\n5 30ab48ec-35a7-7704-86e5-113ef6a90c03  140\n6 d00bda57-b134-0654-e152-831ef486da53  140\n                                                   DESCRIPTION BASE_COST\n1           Influenza  seasonal  injectable  preservative free       136\n2 Td (adult)  5 Lf tetanus toxoid  preservative free  adsorbed       136\n3                                                 Hep B  adult       136\n4                                          meningococcal MCV4P       136\n5           Influenza  seasonal  injectable  preservative free       136\n6           Influenza  seasonal  injectable  preservative free       136\n   vacc_date year    month\n1 2016-04-10 2016    April\n2 2016-04-10 2016    April\n3 2016-04-10 2016    April\n4 2016-04-10 2016    April\n5 2002-10-29 2002  October\n6 2005-11-01 2005 November\n\n# Creating a dataset keeping only new variables (transmute)\npatients_transmuted &lt;- patients %&gt;%\n  transmute(\n    full_name = paste(FIRST, LAST, sep = \" \"), \n    birth_year = format(as.Date(BIRTHDATE), \"%Y\")\n  )\n\nhead (patients_transmuted)\n\n                full_name birth_year\n1      Joshua658 Kunde533       1994\n2      Bennie663 Ebert178       1968\n3    Hunter736 Gerlach374       2008\n4 Carlyn477 Williamson769       1994\n5    Robin66 Gleichner915       2019\n6    Arthur650 Roberts511       2019\n\n# generate a birth_year_group variable based on birth_year values\n\npatients_transmuted &lt;- patients_transmuted %&gt;%\n  mutate(birth_year_group = case_when(\n    birth_year &lt; 1940 ~ \"Before 1940\",\n    birth_year &gt;= 1940 & birth_year &lt;= 1959 ~ \"1940‚Äì1959\",\n    birth_year &gt;= 1960 & birth_year &lt;= 1979 ~ \"1960‚Äì1979\",\n    birth_year &gt;= 1980 & birth_year &lt;= 1999 ~ \"1980‚Äì1999\",\n    birth_year &gt;= 2000 ~ \"2000 and later\",\n    TRUE ~ NA_character_\n  ))\n\nhead(patients_transmuted)\n\n                full_name birth_year birth_year_group\n1      Joshua658 Kunde533       1994        1980‚Äì1999\n2      Bennie663 Ebert178       1968        1960‚Äì1979\n3    Hunter736 Gerlach374       2008   2000 and later\n4 Carlyn477 Williamson769       1994        1980‚Äì1999\n5    Robin66 Gleichner915       2019   2000 and later\n6    Arthur650 Roberts511       2019   2000 and later\n\n# other option to achieve similar result for the above \n\npatients_transmuted &lt;- patients_transmuted %&gt;%\n  mutate(birth_year = as.numeric(birth_year),   # Convert to numeric\n         birth_year_group = cut(birth_year,     # Apply cut()\n                                breaks = c(0, 1939, 1959, 1979, 1999, Inf),\n                                labels = c(\"Before 1940\", \"1940‚Äì1959\", \"1960‚Äì1979\", \"1980‚Äì1999\", \"2000 and later\"),\n                                right = TRUE\n         ))\n\n\nhead(patients_transmuted)\n\n                full_name birth_year birth_year_group\n1      Joshua658 Kunde533       1994        1980‚Äì1999\n2      Bennie663 Ebert178       1968        1960‚Äì1979\n3    Hunter736 Gerlach374       2008   2000 and later\n4 Carlyn477 Williamson769       1994        1980‚Äì1999\n5    Robin66 Gleichner915       2019   2000 and later\n6    Arthur650 Roberts511       2019   2000 and later\n\n# Using case_when to assign marital status values\npatients_case_when &lt;- patients %&gt;%\n  mutate(marital_status_group = case_when(\n    MARITAL == \"M\" ~ \"Married\",\n    MARITAL == \"S\" ~ \"Single\",\n    MARITAL == \"D\" ~ \"Divorced\",\n    TRUE ~ \"Unknown\"\n  )) %&gt;% \n  select(MARITAL, marital_status_group, RACE)\n\nhead(patients_case_when, n = 10)\n\n   MARITAL marital_status_group  RACE\n1        M              Married white\n2        D             Divorced white\n3                       Unknown white\n4        M              Married asian\n5                       Unknown white\n6                       Unknown white\n7                       Unknown white\n8        M              Married white\n9                       Unknown white\n10       D             Divorced white\n\ntable(patients_case_when$marital_status, useNA = \"ifany\")  # Show missing values in the table\n\n\nDivorced  Married   Single  Unknown \n      15       33       12       46 \n\n# Recode marital status while leaving unknown values as missing\npatients_case_when &lt;- patients_case_when %&gt;%\n  mutate(marital_2group = case_when(\n    MARITAL == \"M\" ~ \"Partnered\",\n    MARITAL == \"D\" | MARITAL == \"S\" | MARITAL == \"W\" ~ \"Not partnered\",\n    TRUE ~ NA_character_  # Replaces unknown values with missing (NA)\n  )) \n\nhead(patients_case_when)\n\n  MARITAL marital_status_group  RACE marital_2group\n1       M              Married white      Partnered\n2       D             Divorced white  Not partnered\n3                      Unknown white           &lt;NA&gt;\n4       M              Married asian      Partnered\n5                      Unknown white           &lt;NA&gt;\n6                      Unknown white           &lt;NA&gt;\n\n# Recode race status while leaving unknown values as missing\npatients_case_when &lt;- patients_case_when %&gt;%\n  mutate(race_grouped = case_when(\n    RACE == 'white' ~ \"White\",\n    RACE == \"asian\" ~ \"Asian\",\n    RACE == \"native\" | RACE == \"other\" ~ \"Other\",\n    TRUE ~ NA_character_\n  )) %&gt;% \n  select(RACE, race_grouped)\n\nhead(patients_case_when, n=10)\n\n    RACE race_grouped\n1  white        White\n2  white        White\n3  white        White\n4  asian        Asian\n5  white        White\n6  white        White\n7  white        White\n8  white        White\n9  white        White\n10 white        White\n\n# Simple conditional assignment with if_else\npatients$PASSPORT[patients$PASSPORT == \"\"] &lt;- NA # formatting the variable to know missing values\nprint(sum(is.na(patients$PASSPORT))) #  31 missing value\n\n[1] 31\n\npatients_if_else &lt;- patients %&gt;%\n  mutate(has_passport = if_else(!is.na(PASSPORT), \"Yes\", \"No\")) %&gt;% \n  select(PASSPORT, has_passport)\n\nhead(patients_if_else, n = 10)\n\n     PASSPORT has_passport\n1  X47758697X          Yes\n2  X28173268X          Yes\n3        &lt;NA&gt;           No\n4  X83694889X          Yes\n5        &lt;NA&gt;           No\n6        &lt;NA&gt;           No\n7        &lt;NA&gt;           No\n8  X37637991X          Yes\n9        &lt;NA&gt;           No\n10 X59458953X          Yes\n\n# Replace the first occurrence (e.g., fix misspelled city name)\npatients_sub &lt;- patients %&gt;%\n  mutate(city_fixed = sub(\"Nwe York\", \"New York\", CITY)) %&gt;% \n  select(-Id, -DEATHDATE, -SSN, -LAT, -LON, -SUFFIX, -ZIP)\n\nhead(patients_sub, n = 3)\n\n   BIRTHDATE   DRIVERS   PASSPORT PREFIX     FIRST      MIDDLE       LAST\n1 1994-02-06 S99996852 X47758697X    Mr. Joshua658     Alvin56   Kunde533\n2 1968-08-06 S99993577 X28173268X    Mr. Bennie663               Ebert178\n3 2008-12-21                 &lt;NA&gt;        Hunter736 Mckinley734 Gerlach374\n  MAIDEN MARITAL  RACE   ETHNICITY GENDER                  BIRTHPLACE\n1              M white nonhispanic      M   Boston  Massachusetts  US\n2              D white nonhispanic      M Chicopee  Massachusetts  US\n3                white nonhispanic      M  Spencer  Massachusetts  US\n                      ADDRESS         CITY         STATE          COUNTY  FIPS\n1            811 Kihn Viaduct    Braintree Massachusetts  Norfolk County 25021\n2 975 Pfannerstill Throughway    Braintree Massachusetts  Norfolk County 25021\n3             548 Heller Lane Mattapoisett Massachusetts Plymouth County    NA\n  HEALTHCARE_EXPENSES HEALTHCARE_COVERAGE INCOME   city_fixed\n1            56904.96            18019.99 100511    Braintree\n2           124024.12             1075.06  49737    Braintree\n3            45645.06             6154.94 133816 Mattapoisett\n\n# Replace all occurrences (e.g., replace spaces with underscores)\npatients_gsub &lt;- patients %&gt;%\n  mutate(birthplace_clean = gsub(\" \", \"_\", BIRTHPLACE)) %&gt;% \n  select(BIRTHPLACE, birthplace_clean)\n\nhead(patients_gsub, n = 3)\n\n                   BIRTHPLACE            birthplace_clean\n1   Boston  Massachusetts  US   Boston__Massachusetts__US\n2 Chicopee  Massachusetts  US Chicopee__Massachusetts__US\n3  Spencer  Massachusetts  US  Spencer__Massachusetts__US\n\n# Convert last names to lowercase\ntemp &lt;- patients %&gt;% \n  select(-Id, -DEATHDATE, -SSN, -LAT, -LON, -SUFFIX, -ZIP)\n\npatients_tolower &lt;- temp \ncolnames(patients_tolower) &lt;- tolower(colnames(patients_tolower)) \n\nhead(patients_tolower, n = 3)\n\n   birthdate   drivers   passport prefix     first      middle       last\n1 1994-02-06 S99996852 X47758697X    Mr. Joshua658     Alvin56   Kunde533\n2 1968-08-06 S99993577 X28173268X    Mr. Bennie663               Ebert178\n3 2008-12-21                 &lt;NA&gt;        Hunter736 Mckinley734 Gerlach374\n  maiden marital  race   ethnicity gender                  birthplace\n1              M white nonhispanic      M   Boston  Massachusetts  US\n2              D white nonhispanic      M Chicopee  Massachusetts  US\n3                white nonhispanic      M  Spencer  Massachusetts  US\n                      address         city         state          county  fips\n1            811 Kihn Viaduct    Braintree Massachusetts  Norfolk County 25021\n2 975 Pfannerstill Throughway    Braintree Massachusetts  Norfolk County 25021\n3             548 Heller Lane Mattapoisett Massachusetts Plymouth County    NA\n  healthcare_expenses healthcare_coverage income\n1            56904.96            18019.99 100511\n2           124024.12             1075.06  49737\n3            45645.06             6154.94 133816\n\nrm(temp)\n\n#`janitor::clean_names(df)` standardizes variable names:\n\nnames(patients)\n\n [1] \"Id\"                  \"BIRTHDATE\"           \"DEATHDATE\"          \n [4] \"SSN\"                 \"DRIVERS\"             \"PASSPORT\"           \n [7] \"PREFIX\"              \"FIRST\"               \"MIDDLE\"             \n[10] \"LAST\"                \"SUFFIX\"              \"MAIDEN\"             \n[13] \"MARITAL\"             \"RACE\"                \"ETHNICITY\"          \n[16] \"GENDER\"              \"BIRTHPLACE\"          \"ADDRESS\"            \n[19] \"CITY\"                \"STATE\"               \"COUNTY\"             \n[22] \"FIPS\"                \"ZIP\"                 \"LAT\"                \n[25] \"LON\"                 \"HEALTHCARE_EXPENSES\" \"HEALTHCARE_COVERAGE\"\n[28] \"INCOME\"             \n\ntemp &lt;- janitor::clean_names(patients)\ncolnames(temp)\n\n [1] \"id\"                  \"birthdate\"           \"deathdate\"          \n [4] \"ssn\"                 \"drivers\"             \"passport\"           \n [7] \"prefix\"              \"first\"               \"middle\"             \n[10] \"last\"                \"suffix\"              \"maiden\"             \n[13] \"marital\"             \"race\"                \"ethnicity\"          \n[16] \"gender\"              \"birthplace\"          \"address\"            \n[19] \"city\"                \"state\"               \"county\"             \n[22] \"fips\"                \"zip\"                 \"lat\"                \n[25] \"lon\"                 \"healthcare_expenses\" \"healthcare_coverage\"\n[28] \"income\"             \n\n# Remove all temporary objects created in this chunk\nrm(patients_mutated, patients_transmuted, patients_case_when, patients_if_else,\n   patients_split, patients_sub, patients_gsub, patients_tolower, temp)\n\nWarning in rm(patients_mutated, patients_transmuted, patients_case_when, :\nobject 'patients_split' not found\n\n\n\n1.4.2.1 3.2.1 Creating variable from long text: Splitting text: Extracting words in to different variables\nParsing Text Fields in R: Handling Multi-Word Names\nIn real-world datasets, it‚Äôs common to encounter text fields where multiple data elements‚Äîsuch as city, state, and country‚Äîare embedded within a single string. These entries often include inconsistent spacing, making them challenging to analyze directly.\nParsing refers to the process of systematically breaking down these complex text fields into structured, usable components.\nparsing involves\n\nDetecting patterns in spacing‚Äîfor instance, identifying how many spaces exist between different parts of a string.\nDeciding where to split the string. For example, a single space might separate words within a single name such as city name (e.g., \"East Falmouth\"), while two or more spaces might indicate the boundary between city, state, and country (e.g., \"East Falmouth  Massachusetts  US\").\nCreating new variables or columns such as city, state, and country for cleaner and more structured data representation.\n\nparsing is important\n\nMany administrative or imported datasets contain combined or messy fields that hinder direct analysis.\nProper parsing helps to standardize and clean these fields, which is a critical step for effective data management, visualization, and analysis.\nIt enables downstream tasks such as geographic grouping, mapping, and report generation.\n\nSummary Table\n\n\n\n\n\n\n\nStep\nPurpose\n\n\n\n\nstr_view()\nVisually inspect spacing patterns between components\n\n\nstr_extract_all(\" +\")\nExtract all space sequences\n\n\nmap_int(..., length)\nCount the number of space groups per entry\n\n\nstr_count(\"\\\\S+\")\nCount the number of words\n\n\nnchar() with map_chr()\nShow the length of each space between words\n\n\narrange(desc(word_count))\nIdentify rows with the most words (potential outliers)\n\n\n\nDetecting and Understanding Space Patterns\nTo begin, I used example data from the patients$BIRTHPLACE column to identify how different rows are structured and where inconsistencies might exist.\n1. Visual Inspection of Spacing We can use str_view() from the stringr package to highlight space sequences:\n\nstr_view(patients$BIRTHPLACE[1:15], pattern = \" +\", match = TRUE)\n\n [1] ‚îÇ Boston&lt;  &gt;Massachusetts&lt;  &gt;US\n [2] ‚îÇ Chicopee&lt;  &gt;Massachusetts&lt;  &gt;US\n [3] ‚îÇ Spencer&lt;  &gt;Massachusetts&lt;  &gt;US\n [4] ‚îÇ Franklin&lt;  &gt;Massachusetts&lt;  &gt;US\n [5] ‚îÇ Brockton&lt;  &gt;Massachusetts&lt;  &gt;US\n [6] ‚îÇ Plymouth&lt;  &gt;Massachusetts&lt;  &gt;US\n [7] ‚îÇ East&lt; &gt;Falmouth&lt;  &gt;Massachusetts&lt;  &gt;US\n [8] ‚îÇ Methuen&lt;  &gt;Massachusetts&lt;  &gt;US\n [9] ‚îÇ Maynard&lt;  &gt;Massachusetts&lt;  &gt;US\n[10] ‚îÇ Boston&lt;  &gt;Massachusetts&lt;  &gt;US\n[11] ‚îÇ Framingham&lt;  &gt;Massachusetts&lt;  &gt;US\n[12] ‚îÇ Wayland&lt;  &gt;Massachusetts&lt;  &gt;US\n[13] ‚îÇ Toulouse&lt;  &gt;Occitanie&lt;  &gt;FR\n[14] ‚îÇ Framingham&lt;  &gt;Massachusetts&lt;  &gt;US\n[15] ‚îÇ Lynn&lt;  &gt;Massachusetts&lt;  &gt;US\n\n\nThis shows, for example: East&lt; &gt;Falmouth&lt; &gt;Massachusetts&lt; &gt;US Where: - One space connects city words (‚ÄúEast Falmouth‚Äù) - Two spaces separate city, state, and country\n2. Extract and Inspect Space Sequences Each row shows the space segments between words. This helps us detect whether extra or inconsistent spacing is present.\n\npatients %&gt;%\n  mutate(space_groups = str_extract_all(BIRTHPLACE, \" +\")) %&gt;%\n  select(BIRTHPLACE, space_groups) %&gt;%\n  head()\n\n                   BIRTHPLACE space_groups\n1   Boston  Massachusetts  US         ,   \n2 Chicopee  Massachusetts  US         ,   \n3  Spencer  Massachusetts  US         ,   \n4 Franklin  Massachusetts  US         ,   \n5 Brockton  Massachusetts  US         ,   \n6 Plymouth  Massachusetts  US         ,   \n\n\n3. Count Number of Space Groups This gives a frequency table showing how many rows have 2, 3, 4, or more space groups. A row with more than 2 groups may have extra words or inconsistent formatting.\n\npatients %&gt;%\n  mutate(\n    space_groups = str_extract_all(BIRTHPLACE, \" +\"),\n    n_spaces = map_int(space_groups, length)\n  ) %&gt;%\n  count(n_spaces)\n\n  n_spaces  n\n1        2 84\n2        3 15\n3        4  4\n4        5  3\n\n\n4. Count the Number of Words This confirms how many ‚Äúword segments‚Äù are in each row and helps identify malformed entries.\n\npatients %&gt;%\n  mutate(space_count = str_count(BIRTHPLACE, \" +\")) %&gt;%\n  count(space_count)\n\n  space_count  n\n1           2 84\n2           3 15\n3           4  4\n4           5  3\n\n\n5. Combine Word Count and Space Width To fully understand the complexity of each row, I extracted the number of words and the exact space widths between them:\nThis helps in identifying patterns like:\n‚ÄúEast Falmouth Massachusetts US‚Äù ‚Üí 4 words, with spacing like 1 | 2 | 1\n‚ÄúBoston Massachusetts US‚Äù ‚Üí 3 words, spacing 2 | 2\n\npatients %&gt;%\n  mutate(\n    word_count = str_count(BIRTHPLACE, \"\\\\S+\"),  # count non-space words\n    space_groups = str_extract_all(BIRTHPLACE, \" +\"),\n    space_lengths = map_chr(space_groups, ~ paste(nchar(.x), collapse = \" | \"))  # lengths of spaces\n  ) %&gt;%\n  arrange(desc(word_count)) %&gt;%\n  select(BIRTHPLACE, word_count, space_lengths) %&gt;%\n  head(20)\n\n                                 BIRTHPLACE word_count     space_lengths\n1  Santiago de los Caballeros  Santiago  DO          6 1 | 1 | 1 | 2 | 2\n2  Santiago de los Caballeros  Santiago  DO          6 1 | 1 | 1 | 2 | 2\n3  Santiago de los Caballeros  Santiago  DO          6 1 | 1 | 1 | 2 | 2\n4             San Salvador  El Salvador  SV          5     1 | 2 | 1 | 2\n5      Santo Domingo  National District  DO          5     1 | 2 | 1 | 2\n6         Portsmouth  Saint John Parish  DM          5     2 | 1 | 1 | 2\n7           Wesley  Saint Andrew Parish  DM          5     2 | 1 | 1 | 2\n8          East Falmouth  Massachusetts  US          4         1 | 2 | 2\n9       West Springfield  Massachusetts  US          4         1 | 2 | 2\n10        North Pembroke  Massachusetts  US          4         1 | 2 | 2\n11    North Attleborough  Massachusetts  US          4         1 | 2 | 2\n12                   Ponce  Puerto Rico  PR          4         2 | 1 | 2\n13            Fall River  Massachusetts  US          4         1 | 2 | 2\n14       South Deerfield  Massachusetts  US          4         1 | 2 | 2\n15                 Bayamon  Puerto Rico  PR          4         2 | 1 | 2\n16            Oak Bluffs  Massachusetts  US          4         1 | 2 | 2\n17       North Lakeville  Massachusetts  US          4         1 | 2 | 2\n18            Guatemala City  Guatemala  GT          4         1 | 2 | 2\n19         North Andover  Massachusetts  US          4         1 | 2 | 2\n20         North Reading  Massachusetts  US          4         1 | 2 | 2\n\n\nFrom observations in the data, split BIRTHPLACE by 2+ spaces would be more appropriate. Those two words having one space are the names for a city, state or country\n\n# Clean and split birthplace into city, state/region, and country\npatients_clean &lt;- patients %&gt;%\n  mutate(\n    parts = str_split(BIRTHPLACE, \" {2,}\"),             # split BIRTHPLACE by 2+ spaces\n    # %||% is a shorthand from the rlang package (used implicitly here via purrr) that returns the left-hand side if it exists, otherwise returns the right-hand side.\n    # eg If .x[2] exists, use it; otherwise, use NA (missing character).\n    city = map_chr(parts, ~ .x[1] %||% NA_character_),  # city name (first part)\n    state = map_chr(parts, ~ .x[2] %||% NA_character_), # state or region (second part)\n    country = map_chr(parts, ~ .x[3] %||% NA_character_)# country code (third part)\n  ) %&gt;%\n  select(BIRTHPLACE, city, state, country)\nhead(patients_clean, 10)\n\n                         BIRTHPLACE          city         state country\n1         Boston  Massachusetts  US        Boston Massachusetts      US\n2       Chicopee  Massachusetts  US      Chicopee Massachusetts      US\n3        Spencer  Massachusetts  US       Spencer Massachusetts      US\n4       Franklin  Massachusetts  US      Franklin Massachusetts      US\n5       Brockton  Massachusetts  US      Brockton Massachusetts      US\n6       Plymouth  Massachusetts  US      Plymouth Massachusetts      US\n7  East Falmouth  Massachusetts  US East Falmouth Massachusetts      US\n8        Methuen  Massachusetts  US       Methuen Massachusetts      US\n9        Maynard  Massachusetts  US       Maynard Massachusetts      US\n10        Boston  Massachusetts  US        Boston Massachusetts      US\n\ntail(patients_clean, 10)\n\n                                  BIRTHPLACE                       city\n97                 Boston  Massachusetts  US                     Boston\n98     North Attleborough  Massachusetts  US         North Attleborough\n99                Taunton  Massachusetts  US                    Taunton\n100            Chelmsford  Massachusetts  US                 Chelmsford\n101                Boston  Massachusetts  US                     Boston\n102             Holliston  Massachusetts  US                  Holliston\n103 Santiago de los Caballeros  Santiago  DO Santiago de los Caballeros\n104           Springfield  Massachusetts  US                Springfield\n105             Fitchburg  Massachusetts  US                  Fitchburg\n106       Millis-Clicquot  Massachusetts  US            Millis-Clicquot\n            state country\n97  Massachusetts      US\n98  Massachusetts      US\n99  Massachusetts      US\n100 Massachusetts      US\n101 Massachusetts      US\n102 Massachusetts      US\n103      Santiago      DO\n104 Massachusetts      US\n105 Massachusetts      US\n106 Massachusetts      US\n\n\nConclusion From this exploration, we observe that:\n\nMost entries use single spaces within city names (e.g., ‚ÄúEast Falmouth‚Äù)\nTwo or more spaces are commonly used to separate city, state, and country names\nParsing using a split on ‚Äú{2,}‚Äù (two or more spaces) is a reliable strategy\n\n\n\n1.4.2.2 3.2.2 Text Pattern Analysis and Variable Extraction from Free/unstructured Text\nFree-text fields are common in public-health, administrative, and clinical datasets. While they are rich in information, the lack of structure and consistent vocabulary can limit their usefulness. In real-world datasets, especially in health, administration, and survey data, free-text fields often contain rich information hidden in inconsistent or varied language. A single concept (e.g., ‚ÄúCOVID-19 vaccine‚Äù) might appear in many forms such as ‚Äúcovid jab‚Äù, ‚Äúcovid-19 injection‚Äù, or ‚ÄúSARS-CoV-2 shot‚Äù. This presentation demonstrates how to transform unstructured text into structured, analyzable data using R. The workflow covers\n\ntokenization,\nword-frequency analysis,\nstop-word removal,\nTF‚ÄìIDF to highlight context-specific terms,\nword-cloud visualisation,\nbigram and trigram extraction, and\npattern detection with regular expressions to create categorical variables.\n\nBasic Tokenisation and Word-Frequency Table\nTokenisation splits long strings of text into individual words or terms (‚Äútokens‚Äù). This enables us to calculate how often each word appears, which is essential for understanding vocabulary patterns.\nWe begin by loading the necessary R packages. If a package is not already installed.\n\n# Install packages when they are not already available\nif (!require(\"tidytext\")) install.packages(\"tidytext\", dependencies = TRUE)\nif (!require(\"wordcloud\")) install.packages(\"wordcloud\", dependencies = TRUE)\nif (!require(\"tm\"))        install.packages(\"tm\",        dependencies = TRUE)\n\nlibrary(tidytext)   # text mining utilities\nlibrary(wordcloud)  # word-cloud plots\nlibrary(tm)         # text-mining helpers used by wordcloud\n\n\nword_freq &lt;- vaccination %&gt;%\n  unnest_tokens(word, DESCRIPTION) %&gt;%\n  count(word, sort = TRUE) %&gt;%\n  filter(!is.na(word) & word != \"\")\n\nhead(word_freq)\n\n          word   n\n1         free 929\n2 preservative 929\n3    influenza 859\n4   injectable 859\n5     seasonal 859\n6         dose 230\n\n\nRemove Stop Words\nStop words are common terms like ‚Äúand‚Äù, ‚Äúthe‚Äù, or ‚Äúin‚Äù that typically do not contribute meaningful information in analysis. Removing these helps us focus on content-rich terms.\n\ndata(\"stop_words\")          # built-in tidytext stop-word list\n\nword_freq_clean &lt;- vaccination %&gt;%\n  unnest_tokens(word, DESCRIPTION) %&gt;%\n  anti_join(stop_words, by = \"word\") %&gt;%\n  count(word, sort = TRUE)\n\nhead(word_freq_clean)\n\n          word   n\n1         free 929\n2 preservative 929\n3    influenza 859\n4   injectable 859\n5     seasonal 859\n6         dose 230\n\n\n\nVisualise Word Frequencies\nThis bar chart provides a visual overview of the most common meaningful words in the dataset after stop-word removal.\n\nword_freq_clean %&gt;%\n  filter(n &gt; 20) %&gt;%\n  ggplot(aes(x = reorder(word, n), y = n)) +\n  geom_col() +\n  coord_flip() +\n  labs(title = \"Most Frequent Words After Stop-Word Removal\",\n       x = \"Word\",\n       y = \"Count\")\n\n\n\n\n\n\n\n\n\nCreate a Word Cloud\nA word cloud presents word frequencies visually, with more frequent words appearing larger. It offers a quick snapshot of key terms in the dataset.\n\npar(mar = c(1, 1, 1, 1))  # reduce plot margins\nwordcloud(words = word_freq_clean$word,\n          freq = word_freq_clean$n,\n          min.freq = 1,\n          max.words = 100,\n          random.order = FALSE)\n\n\n\n\n\n\n\n\n\nTF‚ÄìIDF Analysis\nTF‚ÄìIDF (Term Frequency‚ÄìInverse Document Frequency) highlights words that are common within a group but rare across groups. This helps identify terms that are contextually important for specific subgroups.\n\n# Example assumes a column called 'source_id' identifies individual documents\n\ntfidf_result &lt;- vaccination %&gt;%\n  select(source_id, DESCRIPTION) %&gt;%\n  unnest_tokens(word, DESCRIPTION) %&gt;%\n  anti_join(stop_words, by = \"word\") %&gt;%\n  count(source_id, word, sort = TRUE) %&gt;%\n  bind_tf_idf(word, source_id, n) %&gt;%\n  arrange(desc(tf_idf))\n\nhead(tfidf_result)\n\n\nBigrams and Trigrams (n-grams)\nSometimes the context of words matters more than individual terms. N-grams (bigrams, trigrams, etc.) allow us to capture meaningful phrases instead of isolated words.\nBigrams ‚Äì two-word phrases\n\nbigrams &lt;- vaccination %&gt;%\n  unnest_tokens(bigram, DESCRIPTION, token = \"ngrams\", n = 2) %&gt;%\n  count(bigram, sort = TRUE)\n\nhead(bigrams)\n\n                   bigram   n\n1       preservative free 929\n2      influenza seasonal 859\n3 injectable preservative 859\n4     seasonal injectable 859\n5                    &lt;NA&gt; 185\n6                covid 19 144\n\n\nTrigrams ‚Äì three-word phrases\n\ntrigrams &lt;- vaccination %&gt;%\n  unnest_tokens(trigram, DESCRIPTION, token = \"ngrams\", n = 3) %&gt;%\n  count(trigram, sort = TRUE)\n\nhead(trigrams)\n\n                           trigram   n\n1    influenza seasonal injectable 859\n2     injectable preservative free 859\n3 seasonal injectable preservative 859\n4                             &lt;NA&gt; 319\n5                      19 mrna lnp 142\n6                    covid 19 mrna 142\n\n\n\nCreate Categorical Variables from free and unstructured Text\nWe use regular expressions to classify unstructured free-text values into consistent categories. This transformation is critical for summarising or modelling based on text. We can identify and map all words that contain a certain substring (like ‚Äúcovid‚Äù in ‚ÄúCOVID-19‚Äù, ‚Äúcovid_19‚Äù, or ‚Äúcovid‚Äù). You can use str_detect() with a case-insensitive regular expression to filter your word frequency table.\n\nvaccination &lt;- vaccination %&gt;%\n  mutate(vaccine_group = case_when(\n    str_detect(DESCRIPTION, regex(\"covid|sars-cov-2\", ignore_case = TRUE)) ~ \"COVID-19\",\n    str_detect(DESCRIPTION, regex(\"influenza\", ignore_case = TRUE)) ~ \"Influenza\",\n    str_detect(DESCRIPTION, regex(\"hepatitis|hep a|hep b\", ignore_case = TRUE)) ~ \"Hepatitis\",\n    str_detect(DESCRIPTION, regex(\"hpv\", ignore_case = TRUE)) ~ \"HPV\",\n    str_detect(DESCRIPTION, regex(\"mmr\", ignore_case = TRUE)) ~ \"MMR\",\n    str_detect(DESCRIPTION, regex(\"dtap|tdap|tetanus|td \\\\(?adult\\\\)?\", ignore_case = TRUE)) ~ \"DTP group\",\n    str_detect(DESCRIPTION, regex(\"ipv\", ignore_case = TRUE)) ~ \"IPV\",\n    str_detect(DESCRIPTION, regex(\"hib\", ignore_case = TRUE)) ~ \"Hib\",\n    str_detect(DESCRIPTION, regex(\"meningococcal|mcv4\", ignore_case = TRUE)) ~ \"Meningococcal\",\n    str_detect(DESCRIPTION, regex(\"pneumococcal.*13\", ignore_case = TRUE)) ~ \"Pneumococcal PCV13\",\n    str_detect(DESCRIPTION, regex(\"pneumococcal.*23\", ignore_case = TRUE)) ~ \"Pneumococcal PPV23\",\n    str_detect(DESCRIPTION, regex(\"rotavirus\", ignore_case = TRUE)) ~ \"Rotavirus\",\n    str_detect(DESCRIPTION, regex(\"varicella\", ignore_case = TRUE)) ~ \"Varicella\",\n    str_detect(DESCRIPTION, regex(\"zoster\", ignore_case = TRUE)) ~ \"Zoster\",\n    TRUE ~ \"Other\"\n  ))\n\n# Frequency check\n\ntable(vaccination$vaccine_group)\n\n\n          COVID-19          DTP group          Hepatitis                Hib \n               144                152                114                 32 \n               HPV          Influenza                IPV      Meningococcal \n                61                859                 51                 52 \n               MMR Pneumococcal PCV13 Pneumococcal PPV23          Rotavirus \n                26                 52                  8                 21 \n         Varicella             Zoster \n                26                 21 \n\n# Grouping Values Using %in% Inside case_when()\n\nvaccination &lt;- vaccination %&gt;%\n  mutate(vacc_group3 = case_when(\n    vaccine_group %in% c(\"COVID-19\", \"Influenza\") ~ \"Respiratory vaccines\",\n    vaccine_group %in% c(\"DTP group\", \"Hepatitis\", \"HPV\", \"Hib\", \"IPV\", \n                         \"Meningococcal\", \"MMR\") ~ \"Childhood vaccines\",\n    TRUE ~ \"Other\"\n  )) %&gt;% \n  select(-ENCOUNTER, -CODE)\n\nhead (vaccination)\n\n                  DATE                              PATIENT\n1 2016-04-10T09:04:48Z 30a6452c-4297-a1ac-977a-6a23237c7b46\n2 2016-04-10T09:04:48Z 30a6452c-4297-a1ac-977a-6a23237c7b46\n3 2016-04-10T09:04:48Z 30a6452c-4297-a1ac-977a-6a23237c7b46\n4 2016-04-10T09:04:48Z 30a6452c-4297-a1ac-977a-6a23237c7b46\n5 2002-10-29T19:07:21Z 34a4dcc4-35fb-6ad5-ab98-be285c586a4f\n6 2005-11-01T19:07:21Z 34a4dcc4-35fb-6ad5-ab98-be285c586a4f\n                                                   DESCRIPTION BASE_COST\n1           Influenza  seasonal  injectable  preservative free       136\n2 Td (adult)  5 Lf tetanus toxoid  preservative free  adsorbed       136\n3                                                 Hep B  adult       136\n4                                          meningococcal MCV4P       136\n5           Influenza  seasonal  injectable  preservative free       136\n6           Influenza  seasonal  injectable  preservative free       136\n   vacc_date year    month vaccine_group          vacc_group3\n1 2016-04-10 2016    April     Influenza Respiratory vaccines\n2 2016-04-10 2016    April     DTP group   Childhood vaccines\n3 2016-04-10 2016    April     Hepatitis   Childhood vaccines\n4 2016-04-10 2016    April Meningococcal   Childhood vaccines\n5 2002-10-29 2002  October     Influenza Respiratory vaccines\n6 2005-11-01 2005 November     Influenza Respiratory vaccines\n\n\nConclusion\nBy combining the tidytext, stringr, and dplyr packages we converted messy free-text into structured data ready for analysis. This approach supports reproducible work, clearer insights, and more robust statistical modelling.\n\n\n\n1.4.3 3.3 Factors and Labels\n\nCreating factor levels and relabeling\n\nApplying labels with label() and val_labels()\n\nDescriptive summaries with describe()\n\nIn R, categorical variables can be represented as factors to support grouping, modeling, and formatting for reporting. Factor variables store both the value and its associated level label.\nThis section introduces key functions to:\n\nConvert variables into factors\n\nRename or reorder levels for clarity\n\nApply variable-level labels using label() or var_label()\n\nAssign value labels using val_labels() (e.g., 1 = Male)\n\nGenerate descriptive metadata summaries using Hmisc::describe()\n\nValue labels are especially useful when numeric codes represent categorical responses. These can be shown in summaries or retained for export and display.\nYou can choose to display or hide value labels:\noptions(labelled::val_labels_visible = TRUE) # Show values like ‚Äú1 = Male‚Äù options(labelled::val_labels_visible = FALSE) # Show only ‚ÄúMale‚Äù\nüîπ Summary of Functions for Working with Factors and Labels\n\n\n\n\n\n\n\n\nTask\nFunction\nDescription\n\n\n\n\nConvert to factor\nas.factor(x)\nConvert a character or numeric variable into a factor\n\n\nReorder levels\nfactor(x, levels = ...)\nDefine a specific order for levels\n\n\nRename factor levels\nlevels(x) &lt;- c(...)\nManually change the displayed names of factor levels\n\n\nRecode with forcats\nfct_recode(), fct_relevel()\nRelabel, reorder, or collapse factor levels using tidyverse tools\n\n\nApply variable label\nlabel(x) &lt;- \"...\" or var_label(x) &lt;- \"...\"\nAssign a description to a variable\n\n\nApply value labels\nval_labels(x) &lt;- c(\"Label\" = code)\nDefine how codes map to category names (e.g., 1 = Male)\n\n\nRetrieve labels\nlabel(x), val_labels(x)\nView current labels or mappings\n\n\nGenerate summary with labels\nHmisc::describe(df)\nReturn a summary including variable names, labels, types, and distributions\n\n\n\n\n# Select two categorical variables\nvacc_factor &lt;- vacc_pt_merged %&gt;%\n  select(gender, marital)\n\n# Convert character to factor\nvacc_factor &lt;- vacc_factor %&gt;%\n  mutate(\n    gender = factor(gender),\n    marital = factor(marital)\n  )\n\n# Relabel factor levels using fct_recode()\nvacc_factor &lt;- vacc_factor %&gt;%\n  mutate(\n    gender = fct_recode(gender, \"Male\" = \"M\", \"Female\" = \"F\"),\n    marital = fct_recode(marital,\n                         \"Married\" = \"M\",\n                         \"Divorced\" = \"D\",\n                         \"Single\" = \"S\",\n                         \"Widowed\" = \"W\")\n  )\n\ntail(vacc_factor)\n\n     gender marital\n1614 Female  Single\n1615 Female  Single\n1616 Female  Single\n1617 Female  Single\n1618 Female  Single\n1619 Female  Single\n\n# Assign variable labels\nvar_label(vacc_factor$gender) &lt;- \"Biological Sex\"\nvar_label(vacc_factor$marital) &lt;- \"Marital Status\"\n\n# Assign value labels\nvacc_factor$gender_chr &lt;- as.character(vacc_factor$gender) # Convert factor to character\nval_labels(vacc_factor$gender_chr) &lt;- c(\"1\" = \"Male\", \"2\" = \"Female\")\n\n\n# View internal structure and label info\nstr(vacc_factor)\n\n'data.frame':   1619 obs. of  3 variables:\n $ gender    : Factor w/ 2 levels \"Female\",\"Male\": 2 2 2 2 2 2 2 2 2 2 ...\n  ..- attr(*, \"label\")= chr \"Biological Sex\"\n $ marital   : Factor w/ 5 levels \"\",\"Divorced\",..: 3 3 3 3 3 3 2 2 2 2 ...\n  ..- attr(*, \"label\")= chr \"Marital Status\"\n $ gender_chr: chr+lbl [1:1619] Male  , Male  , Male  , Male  , Male  , Male  , Male ...\n   ..@ labels: Named chr  \"Male\" \"Female\"\n   .. ..- attr(*, \"names\")= chr [1:2] \"1\" \"2\"\n\n# Remove bad labels if needed:\nvar_label(vacc_factor$gender) &lt;- NULL\n\n# Remove temporary object\nrm(vacc_factor)\n\n\n\n1.4.4 3.4 Grouping and Summarizing Data\n\n# Select two categorical variables\nvacc_factor &lt;- vacc_pt_merged %&gt;%\n  select(gender, marital)\n\n# Convert character to factor\nvacc_factor &lt;- vacc_factor %&gt;%\n  mutate(\n    gender = factor(gender),\n    marital = factor(marital)\n  )\n\n# Relabel factor levels using fct_recode()\nvacc_factor &lt;- vacc_factor %&gt;%\n  mutate(\n    gender = fct_recode(gender, \"Male\" = \"M\", \"Female\" = \"F\"),\n    marital = fct_recode(marital,\n                         \"Married\" = \"M\",\n                         \"Divorced\" = \"D\",\n                         \"Single\" = \"S\",\n                         \"Widowed\" = \"W\")\n  )\n\ntail(vacc_factor)\n\n     gender marital\n1614 Female  Single\n1615 Female  Single\n1616 Female  Single\n1617 Female  Single\n1618 Female  Single\n1619 Female  Single\n\n# Assign variable labels\nvar_label(vacc_factor$gender) &lt;- \"Biological Sex\"\nvar_label(vacc_factor$marital) &lt;- \"Marital Status\"\n\n# Assign value labels\nvacc_factor$gender_chr &lt;- as.character(vacc_factor$gender) # Convert factor to character\nval_labels(vacc_factor$gender_chr) &lt;- c(\"1\" = \"Male\", \"2\" = \"Female\")\n\n\n# View internal structure and label info\nstr(vacc_factor)\n\n'data.frame':   1619 obs. of  3 variables:\n $ gender    : Factor w/ 2 levels \"Female\",\"Male\": 2 2 2 2 2 2 2 2 2 2 ...\n  ..- attr(*, \"label\")= chr \"Biological Sex\"\n $ marital   : Factor w/ 5 levels \"\",\"Divorced\",..: 3 3 3 3 3 3 2 2 2 2 ...\n  ..- attr(*, \"label\")= chr \"Marital Status\"\n $ gender_chr: chr+lbl [1:1619] Male  , Male  , Male  , Male  , Male  , Male  , Male ...\n   ..@ labels: Named chr  \"Male\" \"Female\"\n   .. ..- attr(*, \"names\")= chr [1:2] \"1\" \"2\"\n\n# Remove bad labels if needed:\nvar_label(vacc_factor$gender) &lt;- NULL\n\n# Remove temporary object\nrm(vacc_factor)\n\n\ngroup_by(), summarize(), ungroup()\nRow and column percentages: details presented in section 7.2 below\nWeighted summaries with wt =\n\nGrouping and summarizing data is fundamental for understanding patterns, distributions, and relationships within datasets.\nIn dplyr, the functions group_by() and summarize() are used together to calculate statistics across different groups.\nWe can also calculate proportions (row-wise or column-wise) and perform weighted summaries when necessary. The details regarding row and column percentages are presented in section 7.2 below.\nThese steps are critical for aggregating information into meaningful insights, especially when working with categorical, grouped, or longitudinal data.\n\nüîπ Summary of Functions for Grouping and Summarizing\n\n\n\n\n\n\n\n\nTask\nFunction\nPurpose\n\n\n\n\nGroup data by one or more variables\ngroup_by()\nDefine groups for aggregation\n\n\nSummarize grouped data\nsummarize()\nApply aggregation functions (e.g., mean, sum, count)\n\n\nRemove grouping structure\nungroup()\nReturn to ungrouped state after summary\n\n\nCalculate row-wise or column-wise proportions\nManual with mutate(), prop.table(), etc.\nUnderstand percentage distribution within/between groups\n\n\nWeighted summaries\nsummarize(wt = )\nCompute weighted means, sums, or percentages when different rows contribute differently\n\n\n\n\n‚û°Ô∏è Grouping and summarization allow efficient exploration of key relationships and preparation of clean summary tables.\n\n\n# ....................................................\n# Grouping and Summarizing Breast Cancer Data\n# ....................................................\n\n# Grouping by SA3 name, State, and Year, and summarizing participation\nbc_summary_year &lt;- breast_cancer_data %&gt;%\n  group_by(year) %&gt;%\n  summarise(\n    total_participants = sum(part50_74, na.rm = TRUE),\n    total_population = sum(pop50_74, na.rm = TRUE),\n    mean_screening_rate = mean(rate50_74, na.rm = TRUE),\n    .groups = \"drop\"\n  )\nhead(bc_summary_year, n = 3)\n\n# A tibble: 3 √ó 4\n    year total_participants total_population mean_screening_rate\n   &lt;int&gt;              &lt;dbl&gt;            &lt;dbl&gt;               &lt;dbl&gt;\n1 201617            1720463          3127749                54.9\n2 201718            1748606          3187574                54.7\n3 201819            1781484          3247470                54.6\n\n# --- Create Vaccination Pattern Dataset ---\ndf_vaccination_plot &lt;- vaccination %&gt;%\n  group_by(year, month, vaccine_group) %&gt;%\n  summarise(\n    count = n(),  # Number of records per year-month-vaccine_group combination\n    .groups = \"drop\"\n  ) %&gt;%\n  ungroup() %&gt;%\n  group_by(year, month) %&gt;%\n  mutate(\n    count_month = sum(count)  # Total vaccines in that year-month across all groups\n  ) %&gt;%\n  ungroup() %&gt;%\n  mutate(\n    proportion_month = round((count / count_month) * 100, 1)  # % per vaccine group within month\n  ) %&gt;%\n  group_by(year) %&gt;%\n  mutate(\n    total_year = sum(count)  # Total vaccines across the year\n  ) %&gt;%\n  mutate(\n    proportion_year = round((count / total_year) * 100, 1)  # % per vaccine group within year\n  ) %&gt;%\n  ungroup()\n\n# View first few rows\ntail(df_vaccination_plot)\n\n# A tibble: 6 √ó 8\n  year  month     vaccine_group count count_month proportion_month total_year\n  &lt;chr&gt; &lt;chr&gt;     &lt;chr&gt;         &lt;int&gt;       &lt;int&gt;            &lt;dbl&gt;      &lt;int&gt;\n1 2024  October   Zoster            1          15              6.7        122\n2 2024  September COVID-19          1          15              6.7        122\n3 2024  September DTP group         2          15             13.3        122\n4 2024  September HPV               2          15             13.3        122\n5 2024  September Influenza         9          15             60          122\n6 2024  September Meningococcal     1          15              6.7        122\n# ‚Ñπ 1 more variable: proportion_year &lt;dbl&gt;\n\n# Enhanced summary of breast cancer screening data with SA3, State, and National Year-level proportions\n# use na.rm = TRUE to remove (ignore) missing values (NA) when calculating\n\nbc_summary &lt;- breast_cancer_data %&gt;%\n  # Group by SA3 area, State, and Year\n  group_by(sa3name, state, year) %&gt;%\n  summarise(\n    total_participants = sum(part50_74, na.rm = TRUE),  # Sum of screened participants\n    total_population = sum(pop50_74, na.rm = TRUE),     # Sum of target population\n    .groups = \"drop\"\n  ) %&gt;%\n  # Calculate SA3-level screening rate and proportion\n  mutate(\n    screening_rate = round((total_participants / total_population) * 100, 1),  # % screened in that SA3\n    proportion_area = round((total_participants / sum(total_participants)) * 100, 1)  # % contribution to national participants\n  ) %&gt;%\n  # Add State-level aggregated summaries\n  group_by(state, year) %&gt;%\n  mutate(\n    state_sa3 = n(),  # Number of SA3 areas within each State-Year\n    state_total_participants = sum(total_participants, na.rm = TRUE),  # State-wide participants\n    state_total_population = sum(total_population, na.rm = TRUE),      # State-wide target population\n    state_screening_rate = round((state_total_participants / state_total_population) * 100, 1),  # % screened at State level\n    state_proportion = round((state_total_participants / sum(total_participants)) * 100, 1)  # State share of total participants\n  ) %&gt;%\n  ungroup() %&gt;%\n  # Add National Year-level aggregated summaries\n  group_by(year) %&gt;%\n  mutate(\n    year_sa3 = n(),  # Number of SA3 areas within each Year\n    year_total_participants = sum(total_participants, na.rm = TRUE),  # Australia-wide participants for that year\n    year_total_population = sum(total_population, na.rm = TRUE),      # Australia-wide target population for that year\n    year_screening_rate = round((year_total_participants / year_total_population) * 100, 1),  # National % screened\n    year_proportion = round((year_total_participants / sum(total_participants)) * 100, 1)  # National share\n  ) %&gt;%\n  ungroup() %&gt;%\n  arrange(year, state, sa3name)   # Final arrangement for neat viewing\n\n# View the last few rows\ntail(bc_summary)\n\n# A tibble: 6 √ó 17\n  sa3name        state   year total_participants total_population screening_rate\n  &lt;chr&gt;          &lt;chr&gt;  &lt;int&gt;              &lt;dbl&gt;            &lt;dbl&gt;          &lt;dbl&gt;\n1 Stirling       WA    201920              13878            27265           50.9\n2 Swan           WA    201920               8513            17274           49.3\n3 Wanneroo       WA    201920              12032            24345           49.4\n4 West Pilbara   WA    201920                828             2409           34.4\n5 Wheat Belt - ‚Ä¶ WA    201920               4947             9813           50.4\n6 Wheat Belt - ‚Ä¶ WA    201920               1446             3342           43.3\n# ‚Ñπ 11 more variables: proportion_area &lt;dbl&gt;, state_sa3 &lt;int&gt;,\n#   state_total_participants &lt;dbl&gt;, state_total_population &lt;dbl&gt;,\n#   state_screening_rate &lt;dbl&gt;, state_proportion &lt;dbl&gt;, year_sa3 &lt;int&gt;,\n#   year_total_participants &lt;dbl&gt;, year_total_population &lt;dbl&gt;,\n#   year_screening_rate &lt;dbl&gt;, year_proportion &lt;dbl&gt;\n\n# ....................................................\n# Calculating Proportions: details presented in section 7.2 below\n# ....................................................\n\n# Adding participation proportion within each SA3-year group\nbc_summary_with_prop &lt;- bc_summary %&gt;%\n  mutate(\n    participation_rate = (total_participants / total_population) * 100\n  ) %&gt;% \n  select(participation_rate)\n\nhead(bc_summary_with_prop)\n\n# A tibble: 6 √ó 1\n  participation_rate\n               &lt;dbl&gt;\n1               56.1\n2              NaN  \n3               53.8\n4              NaN  \n5               54.5\n6               55.1\n\n# ....................................................\n# Weighted Summarization (Weighted Average Screening Rate)\n# ....................................................\n\n# Calculate weighted mean screening rate by SA3\nbc_weighted_summary &lt;- breast_cancer_data %&gt;%\n  group_by(sa3name, state, year) %&gt;%\n  summarise(\n    total_participants = sum(part50_74, na.rm = TRUE),\n    total_population = sum(pop50_74, na.rm = TRUE),\n    weighted_screening_rate = round(sum(rate50_74 * pop50_74, na.rm = TRUE) / sum(pop50_74, na.rm = TRUE), 1),\n    .groups = \"drop\"\n  )\n\nhead(bc_weighted_summary)\n\n# A tibble: 6 √ó 6\n  sa3name        state   year total_participants total_population\n  &lt;chr&gt;          &lt;chr&gt;  &lt;int&gt;              &lt;dbl&gt;            &lt;dbl&gt;\n1 Adelaide City  SA    201617               1280             2537\n2 Adelaide City  SA    201718               1314             2608\n3 Adelaide City  SA    201819               1368             2642\n4 Adelaide City  SA    201920               1208             2707\n5 Adelaide Hills SA    201617               7010            11636\n6 Adelaide Hills SA    201718               7096            11876\n# ‚Ñπ 1 more variable: weighted_screening_rate &lt;dbl&gt;\n\n# ....................................................\n# Remove all temporary objects created in this chunk\n# ....................................................\nrm(bc_summary, bc_summary_with_prop, bc_weighted_summary)\n\n\n\n1.4.5 3.5 Sorting, Reordering, Slicing, and Arranging\n\narrange(), desc()\nslice_max(), slice_min(), top_n()\nRanking data and filtering top/bottom groups\n\nSorting and reordering data is important for finding trends, identifying extremes (top or bottom performers), and preparing tables for reporting or visualization.\nIn dplyr, the arrange() function sorts datasets by one or more variables, while desc() allows descending (reverse) order.\nFor selecting specific rows like top N or bottom N values, slice_max() and slice_min() are commonly used.\nThese techniques allow focusing on key records, comparing rankings across groups, and making datasets easier to review.\n\nüîπ Summary of Functions for Sorting and Reordering\n\n\n\n\n\n\n\n\nTask\nFunction\nPurpose\n\n\n\n\nSort ascending order\narrange()\nSort rows by one or more variables (lowest to highest)\n\n\nSort descending order\narrange(desc())\nSort rows highest to lowest\n\n\nSelect top N rows by a variable\nslice_max()\nKeep top N records based on a variable\n\n\nSelect bottom N rows by a variable\nslice_min()\nKeep bottom N records based on a variable\n\n\nSelect top N rows (old method)\ntop_n()\nDeprecated alternative to slice_max() (not recommended now)\n\n\nRank within groups\nmutate(rank = row_number())\nCreate custom ranking inside grouped data\n\n\n\n\n‚û°Ô∏è Sorting and slicing help prioritize key data points and create targeted outputs for decision-making or visualization.\n\n\n# ....................................................\n# Sorting, Reordering, Slicing, and Arranging (Breast Cancer Data)\n# ....................................................\n\n# Sorting by Screening Rate in Ascending Order\nbc_sorted_rate &lt;- breast_cancer_data %&gt;%\n  arrange(rate50_74) %&gt;%\n  select(sa3code, sa3coden, sa3name, state, year,\n         part50_74, pop50_74, rate50_74, agen50_74, expct50_74)\n\nhead(bc_sorted_rate)\n\n  sa3code sa3coden        sa3name state   year part50_74 pop50_74 rate50_74\n1   90104    90104 Norfolk Island Other 201920        24      441   5.40000\n2   90104    90104 Norfolk Island Other 201819        31      422   7.30000\n3   90104    90104 Norfolk Island Other 201718        39      401   9.70000\n4   70205    70205      Katherine    NT 201920       412     2011  20.51335\n5   51002    51002   East Pilbara    WA 201920       562     1987  28.26220\n6   51002    51002   East Pilbara    WA 201819       567     1918  29.55425\n  agen50_74 expct50_74\n1         3        220\n2         3        231\n3         3        219\n4         3       1003\n5         3        991\n6         3       1051\n\n# Sorting by Screening Rate in Descending Order\nbc_sorted_rate_desc &lt;- breast_cancer_data %&gt;%\n  arrange(desc(rate50_74)) %&gt;%\n  select(sa3code, sa3coden, sa3name, state, year,\n         part50_74, pop50_74, rate50_74, agen50_74, expct50_74)\n\nhead(bc_sorted_rate_desc)\n\n  sa3code sa3coden                        sa3name state   year part50_74\n1   90102    90102        Cocos (Keeling) Islands Other 201920        81\n2   31801    31801 Charters Towers - Ayr - Ingham   Qld 201617      4628\n3   60102    60102            Hobart - North East   Tas 201718      5856\n4   60104    60104        Hobart - South and West   Tas 201718      3643\n5   11004    11004            Tamworth - Gunnedah   NSW 201819      8426\n6   31801    31801 Charters Towers - Ayr - Ingham   Qld 201718      4612\n  pop50_74 rate50_74 agen50_74 expct50_74\n1      101  80.20000         3         50\n2     6713  68.90000         3       3692\n3     8566  68.36348         3       4694\n4     5331  68.34190         3       2921\n5    12333  68.32168         3       6758\n6     6759  68.23824         3       3703\n\n# Slicing Top 10 SA3s with Highest Screening Rates\nbc_top_screening &lt;- breast_cancer_data %&gt;%\n  slice_max(order_by = rate50_74, n = 10) %&gt;%\n  select(sa3code, sa3coden, sa3name, state, year,\n         part50_74, pop50_74, rate50_74, agen50_74, expct50_74)\n\nbc_top_screening\n\n   sa3code sa3coden                        sa3name state   year part50_74\n1    90102    90102        Cocos (Keeling) Islands Other 201920        81\n2    31801    31801 Charters Towers - Ayr - Ingham   Qld 201617      4628\n3    60102    60102            Hobart - North East   Tas 201718      5856\n4    60104    60104        Hobart - South and West   Tas 201718      3643\n5    11004    11004            Tamworth - Gunnedah   NSW 201819      8426\n6    31801    31801 Charters Towers - Ayr - Ingham   Qld 201718      4612\n7    11001    11001                       Armidale   NSW 201617      3810\n8    60102    60102            Hobart - North East   Tas 201819      5881\n9    31801    31801 Charters Towers - Ayr - Ingham   Qld 201819      4588\n10   31801    31801 Charters Towers - Ayr - Ingham   Qld 201920      4580\n   pop50_74 rate50_74 agen50_74 expct50_74\n1       101  80.20000         3         50\n2      6713  68.90000         3       3692\n3      8566  68.36348         3       4694\n4      5331  68.34190         3       2921\n5     12333  68.32168         3       6758\n6      6759  68.23824         3       3703\n7      5602  68.00000         3       3081\n8      8698  67.61016         3       4766\n9      6797  67.49974         3       3724\n10     6818  67.17431         3       3402\n\n# Slicing Bottom 5 SA3s with Lowest Screening Rates\nbc_bottom_screening &lt;- breast_cancer_data %&gt;%\n  slice_min(order_by = rate50_74, n = 5) %&gt;%\n  select(sa3code, sa3coden, sa3name, state, year,\n         part50_74, pop50_74, rate50_74, agen50_74, expct50_74)\n\nbc_bottom_screening\n\n  sa3code sa3coden        sa3name state   year part50_74 pop50_74 rate50_74\n1   90104    90104 Norfolk Island Other 201920        24      441   5.40000\n2   90104    90104 Norfolk Island Other 201819        31      422   7.30000\n3   90104    90104 Norfolk Island Other 201718        39      401   9.70000\n4   70205    70205      Katherine    NT 201920       412     2011  20.51335\n5   51002    51002   East Pilbara    WA 201920       562     1987  28.26220\n  agen50_74 expct50_74\n1         3        220\n2         3        231\n3         3        219\n4         3       1003\n5         3        991\n\n# Ranking Within Each State\nbc_ranked &lt;- breast_cancer_data %&gt;%\n  group_by(state) %&gt;%\n  arrange(desc(rate50_74), .by_group = TRUE) %&gt;%\n  mutate(screening_rank = row_number()) %&gt;%\n  select(screening_rank, rate50_74, state) %&gt;% \n  ungroup()\n\nhead(bc_ranked, n = 10)\n\n# A tibble: 10 √ó 3\n   screening_rank rate50_74 state\n            &lt;int&gt;     &lt;dbl&gt; &lt;chr&gt;\n 1              1      59.9 ACT  \n 2              2      58.8 ACT  \n 3              3      58.4 ACT  \n 4              4      58   ACT  \n 5              5      57.7 ACT  \n 6              6      57.4 ACT  \n 7              7      57.2 ACT  \n 8              8      57.1 ACT  \n 9              9      57.0 ACT  \n10             10      56.7 ACT  \n\n# ....................................................\n# Remove all temporary objects created in this chunk\n# ....................................................\nrm(bc_sorted_rate, bc_sorted_rate_desc, bc_top_screening, bc_bottom_screening, bc_ranked)\n\n\n\n1.4.6 3.6 Reshaping and Tidy Data\n\npivot_longer(), pivot_wider()\nWide-to-long and long-to-wide transformations\nSeparating and uniting columns with separate() and unite()\n\n\nIn data analysis, datasets often need to be reorganized ‚Äî from wide format to long format, or vice versa ‚Äî to suit different types of analysis or visualization.\nThe goal is to follow Tidy Data principles where: - Each variable forms a column - Each observation forms a row - Each type of observational unit forms a table\ndplyr and tidyr provide key functions for reshaping: - pivot_longer() turns many columns into two columns (variable name and value). - pivot_wider() spreads one column into multiple columns. - separate() splits one column into multiple columns based on a separator. - unite() combines multiple columns into one.\nThese tools help create clean, organized datasets ready for efficient analysis and plotting.\n\nüîπ Summary of Functions for Reshaping and Tidy Data\n\n\n\n\n\n\n\n\nTask\nFunction\nPurpose\n\n\n\n\nReshape wide to long\npivot_longer()\nCollapse multiple columns into key-value pairs\n\n\nReshape long to wide\npivot_wider()\nSpread key-value pairs across multiple columns\n\n\nSplit a column into multiple parts\nseparate()\nSeparate one column into several columns by a delimiter\n\n\nCombine multiple columns into one\nunite()\nMerge several columns into a single column\n\n\n\n\n‚û°Ô∏è These reshaping techniques make it easy to transform datasets into a tidy structure for summaries, modeling, or visualization.\n\n** üîé Regular Expression Tip for names_pattern**\n\n\nIn pivot_longer(), we use a regular expression to split the column names into two components: - part, pop, rate, or expct ‚Üí measure - 50_54, 55_59, etc. ‚Üí age group The pattern ([0-9]{2}_[0-9]{2}) works as follows:\n\n\n\n\n\nComponent\nMeaning\n\n\n\n\n[0-9]\nMatch any digit (0‚Äì9)\n\n\n{2}\nExactly two digits\n\n\n_\nAn underscore\n\n\n[0-9]{2}\nAnother two digits\n\n\n\n‚û°Ô∏è This captures typical age formats like 50_54, 60_64, etc.\n\nOriginal Column Name: rate50_54\nComponents: ‚îå‚îÄ‚îÄ‚îÄ‚îê ‚îå‚îÄ‚îÄ‚îÄ‚îê ‚Ä¶.&gt; ‚îÇrate ‚îÇ ‚îÇ50_54 ‚îÇ &gt; ‚îî‚îÄ‚îò ‚îî‚îÄ‚îÄ‚îò\n\n# ....................................................\n# Reshaping, Separate and Unite Columns: Breast Cancer Data\n# ....................................................\n\n# Pivot longer by extracting measure type and age group separately\nbreast_cancer_long &lt;- breast_cancer_data %&gt;%\n  pivot_longer(\n    cols = starts_with(\"part\") | starts_with(\"pop\") | starts_with(\"rate\") | starts_with(\"expct\"),\n    names_to = c(\"measure\", \"age_group\"),\n    names_pattern = \"(part|pop|rate|expct)([0-9]{2}_[0-9]{2})\",\n    values_to = \"value\"\n  ) %&gt;%\n  relocate(measure, age_group, .before = sa3code)\n\nhead(breast_cancer_long, n = 10)\n\n# A tibble: 10 √ó 15\n   measure age_group sa3code sa3coden sa3name   state   year agen50_74 agen50_69\n   &lt;chr&gt;   &lt;chr&gt;       &lt;int&gt;    &lt;int&gt; &lt;chr&gt;     &lt;chr&gt;  &lt;int&gt;     &lt;int&gt;     &lt;int&gt;\n 1 part    50_74       10102    10102 Queanbey‚Ä¶ NSW   201617         3         2\n 2 part    50_69       10102    10102 Queanbey‚Ä¶ NSW   201617         3         2\n 3 part    50_54       10102    10102 Queanbey‚Ä¶ NSW   201617         3         2\n 4 part    55_59       10102    10102 Queanbey‚Ä¶ NSW   201617         3         2\n 5 part    60_64       10102    10102 Queanbey‚Ä¶ NSW   201617         3         2\n 6 part    65_69       10102    10102 Queanbey‚Ä¶ NSW   201617         3         2\n 7 part    70_74       10102    10102 Queanbey‚Ä¶ NSW   201617         3         2\n 8 pop     50_74       10102    10102 Queanbey‚Ä¶ NSW   201617         3         2\n 9 pop     50_69       10102    10102 Queanbey‚Ä¶ NSW   201617         3         2\n10 pop     50_54       10102    10102 Queanbey‚Ä¶ NSW   201617         3         2\n# ‚Ñπ 6 more variables: agen50_54 &lt;int&gt;, agen55_59 &lt;int&gt;, agen60_64 &lt;int&gt;,\n#   agen65_69 &lt;int&gt;, agen70_74 &lt;int&gt;, value &lt;dbl&gt;\n\n# Pivot wider to spread measures into separate columns\nbreast_cancer_final &lt;- breast_cancer_long %&gt;%\n  pivot_wider(\n    names_from = measure,\n    values_from = value\n  ) %&gt;%\n  relocate(part, pop, rate, expct, .before = sa3code)\n\nhead(breast_cancer_final, n = 5)\n\n# A tibble: 5 √ó 17\n  age_group  part   pop  rate expct sa3code sa3coden sa3name    state   year\n  &lt;chr&gt;     &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;   &lt;int&gt;    &lt;int&gt; &lt;chr&gt;      &lt;chr&gt;  &lt;int&gt;\n1 50_74      4875  8052  60.5  4428   10102    10102 Queanbeyan NSW   201617\n2 50_69      4309  7145  60.3  3929   10102    10102 Queanbeyan NSW   201617\n3 50_54      1284  2251  57    1118   10102    10102 Queanbeyan NSW   201617\n4 55_59      1188  1970  60.3  1046   10102    10102 Queanbeyan NSW   201617\n5 60_64      1012  1625  62.3   950   10102    10102 Queanbeyan NSW   201617\n# ‚Ñπ 7 more variables: agen50_74 &lt;int&gt;, agen50_69 &lt;int&gt;, agen50_54 &lt;int&gt;,\n#   agen55_59 &lt;int&gt;, agen60_64 &lt;int&gt;, agen65_69 &lt;int&gt;, agen70_74 &lt;int&gt;\n\n# Separate 'age_group' into two new columns: start and end age\nbreast_cancer_separated &lt;- breast_cancer_long %&gt;%\n  separate(\n    col = age_group,\n    into = c(\"age_start\", \"age_end\"),\n    sep = \"_\",\n    convert = TRUE\n  ) %&gt;% \n  select(\"age_start\", \"age_end\", everything())\n\nhead(breast_cancer_separated, n = 3)\n\n# A tibble: 3 √ó 16\n  age_start age_end measure sa3code sa3coden sa3name    state   year agen50_74\n      &lt;int&gt;   &lt;int&gt; &lt;chr&gt;     &lt;int&gt;    &lt;int&gt; &lt;chr&gt;      &lt;chr&gt;  &lt;int&gt;     &lt;int&gt;\n1        50      74 part      10102    10102 Queanbeyan NSW   201617         3\n2        50      69 part      10102    10102 Queanbeyan NSW   201617         3\n3        50      54 part      10102    10102 Queanbeyan NSW   201617         3\n# ‚Ñπ 7 more variables: agen50_69 &lt;int&gt;, agen50_54 &lt;int&gt;, agen55_59 &lt;int&gt;,\n#   agen60_64 &lt;int&gt;, agen65_69 &lt;int&gt;, agen70_74 &lt;int&gt;, value &lt;dbl&gt;\n\n# Unite 'age_start' and 'age_end' into a single age group label\nbreast_cancer_united &lt;- breast_cancer_separated %&gt;%\n  unite(\n    col = age_group_combined,\n    age_start, age_end,\n    sep = \"-\",\n    remove = FALSE\n  )\n\nhead(breast_cancer_united, n = 3)\n\n# A tibble: 3 √ó 17\n  age_group_combined age_start age_end measure sa3code sa3coden sa3name    state\n  &lt;chr&gt;                  &lt;int&gt;   &lt;int&gt; &lt;chr&gt;     &lt;int&gt;    &lt;int&gt; &lt;chr&gt;      &lt;chr&gt;\n1 50-74                     50      74 part      10102    10102 Queanbeyan NSW  \n2 50-69                     50      69 part      10102    10102 Queanbeyan NSW  \n3 50-54                     50      54 part      10102    10102 Queanbeyan NSW  \n# ‚Ñπ 9 more variables: year &lt;int&gt;, agen50_74 &lt;int&gt;, agen50_69 &lt;int&gt;,\n#   agen50_54 &lt;int&gt;, agen55_59 &lt;int&gt;, agen60_64 &lt;int&gt;, agen65_69 &lt;int&gt;,\n#   agen70_74 &lt;int&gt;, value &lt;dbl&gt;\n\n# ....................................................\n# Remove temporary objects created in this chunk\n# ....................................................\nrm(breast_cancer_long, breast_cancer_separated, breast_cancer_united, breast_cancer_final)"
  },
  {
    "objectID": "Post_Blog/Data Manipulation and Wrangling.html#part-iv-advanced-wrangling-and-integration",
    "href": "Post_Blog/Data Manipulation and Wrangling.html#part-iv-advanced-wrangling-and-integration",
    "title": "Date Manipulation and Wrangling using R",
    "section": "1.5 PART IV: ADVANCED WRANGLING AND INTEGRATION",
    "text": "1.5 PART IV: ADVANCED WRANGLING AND INTEGRATION\n\n1.5.1 4.1 Date and Time data manipulation\n\nlubridate::ymd(), as_date(), format(), %p, weekdays()\nExtracting date components: year, month, quarter\n\nWorking with dates is essential in many datasets, particularly for time-based trends, age calculations, seasonal effects, and survival analysis.\nWe use the lubridate package to parse, extract, and manipulate dates efficiently. The details about time and date data has been presented separately.\n‚û°Ô∏è For full tutorials and videos: - YouTube (AnalyticsHub): Watch Full Video - GitHub: Access Here\nSummary of Functions for Date Handling\n\n\n\n\n\n\n\n\nTask\nFunction\nPurpose\n\n\n\n\nParse ISO dates\nas.Date(), strptime()\nRead and convert raw string timestamps\n\n\nFormat date output\nformat()\nCustomize how dates are displayed\n\n\nExtract components\nyear(), month(), day(), quarter(), week()\nPull year, month, day, quarter, week from dates\n\n\nWeekday labels\nwday(label = TRUE)\nGet day of week in text form\n\n\nDate arithmetic\ndifftime(), -\nCalculate differences between dates\n\n\nLogical operations\n&lt;, &gt;, between()\nFilter by date ranges\n\n\nFiscal/seasonal grouping\ncase_when()\nCategorize based on seasons or financial years\n\n\n\n\nDemonstration using Vaccination Dataset\n\n# Convert DATE into usable R date format\nvaccination &lt;- vaccination %&gt;%\n  mutate(\n    vacc_date = as.Date(strptime(date, format = \"%Y-%m-%dT%H:%M:%SZ\")),\n    vacc_year = year(vacc_date),\n    vacc_month = month(vacc_date, label = TRUE, abbr = FALSE)\n  ) %&gt;% \n  select(-description, base_cost)\n\nhead(vaccination)\n\n                  date                              patient base_cost\n1 2016-04-10T09:04:48Z 30a6452c-4297-a1ac-977a-6a23237c7b46       136\n2 2016-04-10T09:04:48Z 30a6452c-4297-a1ac-977a-6a23237c7b46       136\n3 2016-04-10T09:04:48Z 30a6452c-4297-a1ac-977a-6a23237c7b46       136\n4 2016-04-10T09:04:48Z 30a6452c-4297-a1ac-977a-6a23237c7b46       136\n5 2002-10-29T19:07:21Z 34a4dcc4-35fb-6ad5-ab98-be285c586a4f       136\n6 2005-11-01T19:07:21Z 34a4dcc4-35fb-6ad5-ab98-be285c586a4f       136\n   vacc_date year    month vaccine_group          vacc_group3 vacc_year\n1 2016-04-10 2016    April     Influenza Respiratory vaccines      2016\n2 2016-04-10 2016    April     DTP group   Childhood vaccines      2016\n3 2016-04-10 2016    April     Hepatitis   Childhood vaccines      2016\n4 2016-04-10 2016    April Meningococcal   Childhood vaccines      2016\n5 2002-10-29 2002  October     Influenza Respiratory vaccines      2002\n6 2005-11-01 2005 November     Influenza Respiratory vaccines      2005\n  vacc_month\n1      April\n2      April\n3      April\n4      April\n5    October\n6   November\n\n\nCalculating Time Differences\n\n# Calculating Time Differences\n\n# Convert column names to lowercase\ncolnames(patients) &lt;- tolower(colnames(patients))\ncolnames(vaccination) &lt;- tolower(colnames(vaccination))\n\n# vacc_pt_merged &lt;- left_join(patients, vaccination, by = \"id\" )\nvacc_pt_merged &lt;- left_join(patients, vaccination, by = c(\"id\" = \"patient\"))\n\nstr (vacc_pt_merged)\n\n'data.frame':   1619 obs. of  37 variables:\n $ id                 : chr  \"30a6452c-4297-a1ac-977a-6a23237c7b46\" \"30a6452c-4297-a1ac-977a-6a23237c7b46\" \"30a6452c-4297-a1ac-977a-6a23237c7b46\" \"30a6452c-4297-a1ac-977a-6a23237c7b46\" ...\n $ birthdate          : chr  \"1994-02-06\" \"1994-02-06\" \"1994-02-06\" \"1994-02-06\" ...\n $ deathdate          : chr  \"\" \"\" \"\" \"\" ...\n $ ssn                : chr  \"999-52-8591\" \"999-52-8591\" \"999-52-8591\" \"999-52-8591\" ...\n $ drivers            : chr  \"S99996852\" \"S99996852\" \"S99996852\" \"S99996852\" ...\n $ passport           : chr  \"X47758697X\" \"X47758697X\" \"X47758697X\" \"X47758697X\" ...\n $ prefix             : chr  \"Mr.\" \"Mr.\" \"Mr.\" \"Mr.\" ...\n $ first              : chr  \"Joshua658\" \"Joshua658\" \"Joshua658\" \"Joshua658\" ...\n $ middle             : chr  \"Alvin56\" \"Alvin56\" \"Alvin56\" \"Alvin56\" ...\n $ last               : chr  \"Kunde533\" \"Kunde533\" \"Kunde533\" \"Kunde533\" ...\n $ suffix             : logi  NA NA NA NA NA NA ...\n $ maiden             : chr  \"\" \"\" \"\" \"\" ...\n $ marital            : chr  \"M\" \"M\" \"M\" \"M\" ...\n $ race               : chr  \"white\" \"white\" \"white\" \"white\" ...\n $ ethnicity          : chr  \"nonhispanic\" \"nonhispanic\" \"nonhispanic\" \"nonhispanic\" ...\n $ gender             : chr  \"M\" \"M\" \"M\" \"M\" ...\n $ birthplace         : chr  \"Boston  Massachusetts  US\" \"Boston  Massachusetts  US\" \"Boston  Massachusetts  US\" \"Boston  Massachusetts  US\" ...\n $ address            : chr  \"811 Kihn Viaduct\" \"811 Kihn Viaduct\" \"811 Kihn Viaduct\" \"811 Kihn Viaduct\" ...\n $ city               : chr  \"Braintree\" \"Braintree\" \"Braintree\" \"Braintree\" ...\n $ state              : chr  \"Massachusetts\" \"Massachusetts\" \"Massachusetts\" \"Massachusetts\" ...\n $ county             : chr  \"Norfolk County\" \"Norfolk County\" \"Norfolk County\" \"Norfolk County\" ...\n $ fips               : int  25021 25021 25021 25021 25021 25021 25021 25021 25021 25021 ...\n $ zip                : int  2184 2184 2184 2184 2184 2184 2184 2184 2184 2184 ...\n $ lat                : num  42.2 42.2 42.2 42.2 42.2 ...\n $ lon                : num  -71 -71 -71 -71 -71 ...\n $ healthcare_expenses: num  56905 56905 56905 56905 56905 ...\n $ healthcare_coverage: num  18020 18020 18020 18020 18020 ...\n $ income             : int  100511 100511 100511 100511 100511 100511 49737 49737 49737 49737 ...\n $ date               : chr  \"2016-04-10T09:04:48Z\" \"2016-04-10T09:04:48Z\" \"2016-04-10T09:04:48Z\" \"2016-04-10T09:04:48Z\" ...\n $ base_cost          : num  136 136 136 136 136 136 136 136 136 136 ...\n $ vacc_date          : Date, format: \"2016-04-10\" \"2016-04-10\" ...\n $ year               : chr  \"2016\" \"2016\" \"2016\" \"2016\" ...\n $ month              : chr  \"April\" \"April\" \"April\" \"April\" ...\n $ vaccine_group      : chr  \"Influenza\" \"DTP group\" \"Hepatitis\" \"Meningococcal\" ...\n $ vacc_group3        : chr  \"Respiratory vaccines\" \"Childhood vaccines\" \"Childhood vaccines\" \"Childhood vaccines\" ...\n $ vacc_year          : num  2016 2016 2016 2016 2019 ...\n $ vacc_month         : Ord.factor w/ 12 levels \"January\"&lt;\"February\"&lt;..: 4 4 4 4 4 4 10 11 8 8 ...\n\nvacc_pt_merged %&gt;% \n  mutate(\n    vacc_date = as.Date(strptime(date, format = \"%Y-%m-%dT%H:%M:%SZ\")),\n    birthdate = as.Date(birthdate),\n    days_to_vax = as.numeric(difftime(vacc_date, birthdate, units = \"days\")),\n    weeks_to_vax = as.numeric(difftime(vacc_date, birthdate, units = \"weeks\")),\n    months_to_vax = as.numeric(difftime(vacc_date, birthdate, units = \"days\")) / 30.44,\n    years_to_vax = floor(as.numeric(difftime(vacc_date, birthdate, units = \"days\")) / 365.25)\n  ) -&gt; vacc_pt_merged\n\nsummary(vacc_pt_merged$days_to_vax)\n\n   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. \n      0    2548    7742   10375   18263   36813 \n\nsummary(vacc_pt_merged$years_to_vax)\n\n   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. \n   0.00    6.00   21.00   28.02   50.00  100.00 \n\n\nExtracting Date Components\n\nvacc_pt_merged &lt;- vacc_pt_merged %&gt;%\n  mutate(\n    vacc_day = day(vacc_date),\n    vacc_month_num = month(vacc_date),\n    vacc_month_name = month(vacc_date, label = TRUE, abbr = FALSE),\n    vacc_weekday = wday(vacc_date, label = TRUE, abbr = FALSE),\n    vacc_week = week(vacc_date),\n    vacc_quarter = quarter(vacc_date),\n    vacc_year = year(vacc_date),  # Define vacc_year first\n    vacc_fy = if_else(vacc_month_num &gt;= 7, vacc_year, vacc_year - 1),  # FY starts 1 July in Australia\n    vacc_season = case_when(\n      vacc_month_num %in% 12:2 ~ \"Summer\",\n      vacc_month_num %in% 3:5  ~ \"Autumn\",\n      vacc_month_num %in% 6:8  ~ \"Winter\",\n      vacc_month_num %in% 9:11 ~ \"Spring\"\n    ),\n    is_weekend = wday(vacc_date) %in% c(1, 7),\n    days_since_ref = floor(as.numeric(difftime(vacc_date, as.Date(\"2020-01-01\"), units = \"days\")))\n  )\n\ntemp &lt;- vacc_pt_merged %&gt;%\n  select(vacc_day, vacc_month_num, vacc_month_name, vacc_weekday, vacc_week,\n         vacc_quarter, vacc_year, vacc_fy, vacc_season, is_weekend, days_since_ref)\n\nhead(temp, n = 8)\n\n  vacc_day vacc_month_num vacc_month_name vacc_weekday vacc_week vacc_quarter\n1       10              4           April       Sunday        15            2\n2       10              4           April       Sunday        15            2\n3       10              4           April       Sunday        15            2\n4       10              4           April       Sunday        15            2\n5       14              4           April       Sunday        15            2\n6       17              4           April       Sunday        16            2\n7       29             10         October      Tuesday        44            4\n8        1             11        November      Tuesday        44            4\n  vacc_year vacc_fy vacc_season is_weekend days_since_ref\n1      2016    2015      Summer       TRUE          -1361\n2      2016    2015      Summer       TRUE          -1361\n3      2016    2015      Summer       TRUE          -1361\n4      2016    2015      Summer       TRUE          -1361\n5      2019    2018      Summer       TRUE           -262\n6      2022    2021      Summer       TRUE            837\n7      2002    2002      Summer      FALSE          -6273\n8      2005    2005      Summer      FALSE          -5174\n\nrm (temp)\n\nFiltering Between Date Ranges\n\n# Calculate Age as of 31 December 2024\n# str(vacc_pt_merged$birthdate) \n\nvacc_pt_merged &lt;- vacc_pt_merged %&gt;%\n  mutate(\n    age = floor(time_length(difftime(as.Date(\"2024-12-31\"), birthdate), unit = \"years\"))\n  )\n\ntable (vacc_pt_merged$age)\n\n\n  1   2   5   6   7  10  11  12  13  14  15  16  17  18  19  20  21  23  24  25 \n 46  24  64  66  34 102  38  59  21  21  34  83  18  36  18  34  48  13  12  47 \n 27  28  29  30  33  34  36  37  38  40  41  42  43  44  45  46  47  48  49  50 \n 17  30   9  38   4   7   6   8   6  20  37  16   9  17  15  13   9  21  30  15 \n 51  52  53  55  56  58  60  61  62  63  64  65  68  69  71  73  74  76  78  80 \n 13  30  16  30  30  14  12  27  49  13  26  14  14  57  15  27  15  14  12  13 \n 85  97 110 \n 12  20   1 \n\n# Categorize into Age Groups\nvacc_pt_merged &lt;- vacc_pt_merged %&gt;%\n  mutate(\n    age_group = cut(\n      age,\n      breaks = c(0, 9, 19, 29, 49, 100),\n      labels = c(\"0‚Äì9\", \"10‚Äì19\", \"20‚Äì29\", \"30‚Äì49\", \"50+\"),\n      right = TRUE\n    )\n  )\n\ntable (vacc_pt_merged$age_group)\n\n\n  0‚Äì9 10‚Äì19 20‚Äì29 30‚Äì49   50+ \n  234   430   210   256   488 \n\n# Vaccinations only in 2022\nvacc_2022 &lt;- vacc_pt_merged %&gt;%\n  filter(vacc_date &gt;= ymd(\"2022-01-01\") & vacc_date &lt;= ymd(\"2022-12-31\"))\n\n# Vaccinations between 2015 and 2024\nvacc_1524 &lt;- vacc_pt_merged %&gt;%\n  filter(vacc_year &gt;= 2015 & vacc_year &lt;= 2024)\n\ntable(vacc_1524$vacc_year)\n\n\n2015 2016 2017 2018 2019 2020 2021 2022 2023 2024 \n 153  139  137  151  161  137  263  120  170  122 \n\nrm(vacc_2022)\n\n\n\n1.5.2 4.2 Duplicate Observations and Creating ID\n\nID Creation (if missing): paste(), substr(), as.Date(), unite()\nDetecting Duplicates: duplicated(), distinct(), n_distinct(), row_number(), count(distinct(‚Ä¶))\nTagging Duplicates: row_number(), duplicated(), mutate(dup = row_number())\nValidating Duplicates: group_by() + filter(n() &gt; 1), arrange(), subset()\nRemoving Duplicates: filter(dup == 1), distinct(), summarise()\nOptional Filtering Rules: Keep first/last by date, non-missing only, domain-specific logic\n\nDuplicate records in health or survey data can compromise the integrity of analyses. A critical first step is ensuring each individual has a consistent and unique identifier (ID). When explicit IDs are missing or unreliable, they can be constructed using combinations of variables such as names, dates of birth, and location (e.g., using paste(), substr(), or unite()). Once IDs are established, duplicates can be detected, reviewed, and resolved systematically through tagging (row_number()), visual inspection, and appropriate retention or removal strategies.\n\nüîπ Key Aspects of Duplicate Management\n\n\n\n\n\n\n\n\nAspect\nWhat to Address\nWhy It Matters\n\n\n\n\nDetection Methods\nUse duplicated(), distinct(), n_distinct(), row_number() by ID or keys\nHelps quantify and locate potential duplicates\n\n\nValidation\nVisual/manual review using arrange(), group_by() + filter()\nPrevents removal of legitimate but similar entries\n\n\nTagging Duplicates\nLabel using row_number() or duplicated()\nAllows flexible filtering or analysis of repeats\n\n\nDeciding What to Keep\nKeep first, latest (by date), or non-missing based on rules\nAvoids loss of useful or most complete records\n\n\nRemoval or Aggregation\nDrop with filter(), or use summarise() to collapse duplicates\nDepends on context: reporting vs.¬†recordkeeping\n\n\nID Creation / Fixing\nUse mutate() to create or correct IDs\nEnables future joins and tracking\n\n\n\n\nThe following table shows the summary with some data manipulation options\n\n\n\n\n\n\n\n\nTask\nFunction / Code\nPurpose\n\n\n\n\nIdentify blank IDs or fields\nx[x == \"\"] &lt;- NA\nConvert empty strings to NA for proper detection\n\n\nCount missing values\nsum(is.na(x))\nCheck how many values are missing\n\n\nCount unique observations\ncount(distinct(df, id))\nDetermine the number of unique records\n\n\nGenerate row numbers per group\ngroup_by(id) %&gt;% mutate(dup = row_number())\nLabel duplicates within each ID\n\n\nCheck duplication status\ntable(df$dup) or sum(dup &gt;= 2)\nSummarise duplication pattern\n\n\nSubset for review\nsubset(df, dup == 2)\nView specific duplicates for manual inspection\n\n\nFilter duplicated individuals\nfilter(n() &gt; 1)\nExtract only duplicated IDs\n\n\nRemove duplicates\nfilter(!(dup &gt;= 2))\nKeep only the first instance per group (if needed)\n\n\nClean temporary object\nrm()\nRemove intermediate datasets from environment\n\n\n\nThis setup ensures duplicates are clearly identified, reviewed, and removed where appropriate.\n\npatients &lt;- patients %&gt;%\n  mutate(\n    birthdate = as.Date(birthdate),\n    id_text = paste0(substr(first, 1, 4), \"|\", substr(last, 1, 4), \"|\", birthdate)\n  )\n# Preview new ID\nhead(patients$id_text, n = 3)\n\n[1] \"Josh|Kund|1994-02-06\" \"Benn|Eber|1968-08-06\" \"Hunt|Gerl|2008-12-21\"\n\n# --- Step 2: Create random numeric ID per individual ---\nset.seed(1234)  # for reproducibility\npatients &lt;- patients %&gt;%\n  mutate(id_num = sample(100000:999999, n(), replace = FALSE))\n\n# Preview both ID columns\npatients %&gt;%\n  select(first, last, birthdate, id_text, id_num) %&gt;%\n  head(5)\n\n      first          last  birthdate              id_text id_num\n1 Joshua658      Kunde533 1994-02-06 Josh|Kund|1994-02-06 861679\n2 Bennie663      Ebert178 1968-08-06 Benn|Eber|1968-08-06 730677\n3 Hunter736    Gerlach374 2008-12-21 Hunt|Gerl|2008-12-21 404107\n4 Carlyn477 Williamson769 1994-01-27 Carl|Will|1994-01-27 395845\n5   Robin66  Gleichner915 2019-07-27 Robi|Glei|2019-07-27 226054\n\n# ....................................................\n# Clean-up if needed\n# ....................................................\n# rm(id_text, id_num) # optional if you store externally\n\ntable (patients$race)\n\n\n asian  black native  other  white \n     8      6      1      3     88 \n\notherrace &lt;- patients %&gt;%\n  filter(race != \"white\")\n\npatients &lt;- rbind(patients, otherrace)\n\n# Count total and unique records\nn_total &lt;- nrow(patients)\nn_unique &lt;- n_distinct(patients$id_text)\nmessage(glue::glue(\"Total records: {n_total}, Unique IDs: {n_unique}\"))\n\nTotal records: 124, Unique IDs: 106\n\n# Tag duplicates using row_number()\npatients &lt;- patients %&gt;%\n  arrange(id_text) %&gt;%\n  group_by(id_text) %&gt;%\n  mutate(dup = row_number()) %&gt;%\n  ungroup()\n# Count number of true duplicates\ntable(patients$dup)\n\n\n  1   2 \n106  18 \n\nprint(sum(patients$dup &gt;= 2))\n\n[1] 18\n\n# Keep only records from individuals who have duplicates\nduplicates &lt;- patients %&gt;%\n  group_by(id_text) %&gt;%\n  filter(n() &gt;= 2) %&gt;%\n  select(id_text, id_num, race, marital, gender, birthdate) %&gt;%\n  ungroup()\n\n# Preview records from duplicated individuals\nhead(duplicates)\n\n# A tibble: 6 √ó 6\n  id_text              id_num race  marital gender birthdate \n  &lt;chr&gt;                 &lt;int&gt; &lt;chr&gt; &lt;chr&gt;   &lt;chr&gt;  &lt;date&gt;    \n1 Alen|Gusi|1927-03-20 361202 other M       F      1927-03-20\n2 Alen|Gusi|1927-03-20 361202 other M       F      1927-03-20\n3 Bert|Alem|1983-05-07 513589 black M       F      1983-05-07\n4 Bert|Alem|1983-05-07 513589 black M       F      1983-05-07\n5 Blan|Rein|1951-11-22 465318 asian S       F      1951-11-22\n6 Blan|Rein|1951-11-22 465318 asian S       F      1951-11-22\n\nrm(duplicates, n_total, n_unique)\n\n\n\n1.5.3 4.3 Merging (Joining) and Appending Datasets\n\nleft_join(), right_join(), inner_join(), full_join()\nsemi_join() and anti_join()\nbind_rows(), rbind() , bind_cols() and cbind()\n\nWhen analyzing real-world datasets, it‚Äôs often necessary to merge or append multiple datasets.\nThis could involve matching rows based on common identifiers, appending additional cases, or combining variables side-by-side.\nWe can join, bind, or filter datasets efficiently using dplyr and base R techniques.\nBrief Descriptions\n\nleft_join(): Keep all records from the left (main) table; bring matching records from the right table.\nright_join(): Keep all records from the right table; bring matching records from the left.\ninner_join(): Keep only rows where keys match in both tables.\nfull_join(): Keep all records from both tables; missing matches filled with NA.\nsemi_join(): Keep rows from the left table where a match exists in the right.\nanti_join(): Keep only rows from the left table that don‚Äôt match the right.\n\n‚û°Ô∏è bind_rows() and rbind() are used for stacking datasets.\n‚û°Ô∏è bind_cols() and cbind() are used for attaching new columns horizontally.\nSummary Table: Key Functions for Joining and Appending\n\n\n\n\n\n\n\n\nTask\nFunction\nPurpose\n\n\n\n\nMerge by common key\nleft_join(), right_join(), inner_join(), full_join()\nMerge datasets using common variables\n\n\nFilter matching rows\nsemi_join()\nKeep rows from left table that have matches in right table\n\n\nFilter non-matching rows\nanti_join()\nKeep rows from left table with no match in right table\n\n\nRow-wise append\nbind_rows()\nStack two datasets vertically (must have same columns)\n\n\nColumn-wise append\nbind_cols()\nAdd columns side-by-side (matching by row position)\n\n\nBasic base R row bind\nrbind()\nAppend rows (base R equivalent to bind_rows)\n\n\nBasic base R column bind\ncbind()\nAppend columns (base R equivalent to bind_cols)\n\n\nJoin a table to itself\nSelf-join\nAnalyze relationships within a single dataset (e.g., hierarchy)\n\n\n\n\nImportant Reminders - Joins (left_join, etc.) match based on a key (column/s). - bind_rows() assumes same column names and types. - bind_cols() assumes same number of rows. - rbind() and cbind() are base R methods but dplyr::bind_*() are more flexible. ‚Äî\nDemonstrating Different Types of Joins with Brief Descriptions\nStandardizing variable Names\nBefore performing joins, it is essential to ensure column names match in both datasets.\nThis avoids errors caused by case differences or inconsistent naming.\n\n# ......................................\n# Full Join: Keep everything from both datasets\n# ......................................\nvacc_full_join &lt;- full_join(\n  patients,\n  vaccination,\n  by = c(\"id\" = \"patient\")\n)\n\nhead(vacc_full_join, n = 3)\n\n                                    id  birthdate deathdate         ssn\n1 30a6452c-4297-a1ac-977a-6a23237c7b46 1994-02-06           999-52-8591\n2 30a6452c-4297-a1ac-977a-6a23237c7b46 1994-02-06           999-52-8591\n3 30a6452c-4297-a1ac-977a-6a23237c7b46 1994-02-06           999-52-8591\n    drivers   passport prefix     first  middle     last suffix maiden marital\n1 S99996852 X47758697X    Mr. Joshua658 Alvin56 Kunde533     NA              M\n2 S99996852 X47758697X    Mr. Joshua658 Alvin56 Kunde533     NA              M\n3 S99996852 X47758697X    Mr. Joshua658 Alvin56 Kunde533     NA              M\n   race   ethnicity gender                birthplace          address      city\n1 white nonhispanic      M Boston  Massachusetts  US 811 Kihn Viaduct Braintree\n2 white nonhispanic      M Boston  Massachusetts  US 811 Kihn Viaduct Braintree\n3 white nonhispanic      M Boston  Massachusetts  US 811 Kihn Viaduct Braintree\n          state         county  fips  zip      lat      lon healthcare_expenses\n1 Massachusetts Norfolk County 25021 2184 42.21114 -71.0458            56904.96\n2 Massachusetts Norfolk County 25021 2184 42.21114 -71.0458            56904.96\n3 Massachusetts Norfolk County 25021 2184 42.21114 -71.0458            56904.96\n  healthcare_coverage income                 date\n1            18019.99 100511 2016-04-10T09:04:48Z\n2            18019.99 100511 2016-04-10T09:04:48Z\n3            18019.99 100511 2016-04-10T09:04:48Z\n                             encounter code\n1 0b03e41b-06a6-66fa-b972-acc5a83b134a  140\n2 0b03e41b-06a6-66fa-b972-acc5a83b134a  113\n3 0b03e41b-06a6-66fa-b972-acc5a83b134a   43\n                                                   description base_cost\n1           Influenza  seasonal  injectable  preservative free       136\n2 Td (adult)  5 Lf tetanus toxoid  preservative free  adsorbed       136\n3                                                 Hep B  adult       136\n\n# ......................................\n# Left Join: Keep all patients, add vaccination if available\n# ......................................\nvacc_left_join &lt;- left_join(\n  patients,\n  vaccination,\n  by = c(\"id\" = \"patient\")\n)\n\nhead(vacc_left_join, n = 3)\n\n                                    id  birthdate deathdate         ssn\n1 30a6452c-4297-a1ac-977a-6a23237c7b46 1994-02-06           999-52-8591\n2 30a6452c-4297-a1ac-977a-6a23237c7b46 1994-02-06           999-52-8591\n3 30a6452c-4297-a1ac-977a-6a23237c7b46 1994-02-06           999-52-8591\n    drivers   passport prefix     first  middle     last suffix maiden marital\n1 S99996852 X47758697X    Mr. Joshua658 Alvin56 Kunde533     NA              M\n2 S99996852 X47758697X    Mr. Joshua658 Alvin56 Kunde533     NA              M\n3 S99996852 X47758697X    Mr. Joshua658 Alvin56 Kunde533     NA              M\n   race   ethnicity gender                birthplace          address      city\n1 white nonhispanic      M Boston  Massachusetts  US 811 Kihn Viaduct Braintree\n2 white nonhispanic      M Boston  Massachusetts  US 811 Kihn Viaduct Braintree\n3 white nonhispanic      M Boston  Massachusetts  US 811 Kihn Viaduct Braintree\n          state         county  fips  zip      lat      lon healthcare_expenses\n1 Massachusetts Norfolk County 25021 2184 42.21114 -71.0458            56904.96\n2 Massachusetts Norfolk County 25021 2184 42.21114 -71.0458            56904.96\n3 Massachusetts Norfolk County 25021 2184 42.21114 -71.0458            56904.96\n  healthcare_coverage income                 date\n1            18019.99 100511 2016-04-10T09:04:48Z\n2            18019.99 100511 2016-04-10T09:04:48Z\n3            18019.99 100511 2016-04-10T09:04:48Z\n                             encounter code\n1 0b03e41b-06a6-66fa-b972-acc5a83b134a  140\n2 0b03e41b-06a6-66fa-b972-acc5a83b134a  113\n3 0b03e41b-06a6-66fa-b972-acc5a83b134a   43\n                                                   description base_cost\n1           Influenza  seasonal  injectable  preservative free       136\n2 Td (adult)  5 Lf tetanus toxoid  preservative free  adsorbed       136\n3                                                 Hep B  adult       136\n\n# ......................................\n# Right Join: Keep all vaccinations, add patients if available\n# ......................................\nvacc_right_join &lt;- right_join(\n  patients,\n  vaccination,\n  by = c(\"id\" = \"patient\")\n)\n\nhead(vacc_right_join, n = 3)\n\n                                    id  birthdate deathdate         ssn\n1 30a6452c-4297-a1ac-977a-6a23237c7b46 1994-02-06           999-52-8591\n2 30a6452c-4297-a1ac-977a-6a23237c7b46 1994-02-06           999-52-8591\n3 30a6452c-4297-a1ac-977a-6a23237c7b46 1994-02-06           999-52-8591\n    drivers   passport prefix     first  middle     last suffix maiden marital\n1 S99996852 X47758697X    Mr. Joshua658 Alvin56 Kunde533     NA              M\n2 S99996852 X47758697X    Mr. Joshua658 Alvin56 Kunde533     NA              M\n3 S99996852 X47758697X    Mr. Joshua658 Alvin56 Kunde533     NA              M\n   race   ethnicity gender                birthplace          address      city\n1 white nonhispanic      M Boston  Massachusetts  US 811 Kihn Viaduct Braintree\n2 white nonhispanic      M Boston  Massachusetts  US 811 Kihn Viaduct Braintree\n3 white nonhispanic      M Boston  Massachusetts  US 811 Kihn Viaduct Braintree\n          state         county  fips  zip      lat      lon healthcare_expenses\n1 Massachusetts Norfolk County 25021 2184 42.21114 -71.0458            56904.96\n2 Massachusetts Norfolk County 25021 2184 42.21114 -71.0458            56904.96\n3 Massachusetts Norfolk County 25021 2184 42.21114 -71.0458            56904.96\n  healthcare_coverage income                 date\n1            18019.99 100511 2016-04-10T09:04:48Z\n2            18019.99 100511 2016-04-10T09:04:48Z\n3            18019.99 100511 2016-04-10T09:04:48Z\n                             encounter code\n1 0b03e41b-06a6-66fa-b972-acc5a83b134a  140\n2 0b03e41b-06a6-66fa-b972-acc5a83b134a  113\n3 0b03e41b-06a6-66fa-b972-acc5a83b134a   43\n                                                   description base_cost\n1           Influenza  seasonal  injectable  preservative free       136\n2 Td (adult)  5 Lf tetanus toxoid  preservative free  adsorbed       136\n3                                                 Hep B  adult       136\n\n# ......................................\n# Inner Join: Keep only matched patients and vaccinations\n# ......................................\nvacc_inner_join &lt;- inner_join(\n  patients,\n  vaccination,\n  by = c(\"id\" = \"patient\"))\n\nhead(vacc_inner_join, n = 3)\n\n                                    id  birthdate deathdate         ssn\n1 30a6452c-4297-a1ac-977a-6a23237c7b46 1994-02-06           999-52-8591\n2 30a6452c-4297-a1ac-977a-6a23237c7b46 1994-02-06           999-52-8591\n3 30a6452c-4297-a1ac-977a-6a23237c7b46 1994-02-06           999-52-8591\n    drivers   passport prefix     first  middle     last suffix maiden marital\n1 S99996852 X47758697X    Mr. Joshua658 Alvin56 Kunde533     NA              M\n2 S99996852 X47758697X    Mr. Joshua658 Alvin56 Kunde533     NA              M\n3 S99996852 X47758697X    Mr. Joshua658 Alvin56 Kunde533     NA              M\n   race   ethnicity gender                birthplace          address      city\n1 white nonhispanic      M Boston  Massachusetts  US 811 Kihn Viaduct Braintree\n2 white nonhispanic      M Boston  Massachusetts  US 811 Kihn Viaduct Braintree\n3 white nonhispanic      M Boston  Massachusetts  US 811 Kihn Viaduct Braintree\n          state         county  fips  zip      lat      lon healthcare_expenses\n1 Massachusetts Norfolk County 25021 2184 42.21114 -71.0458            56904.96\n2 Massachusetts Norfolk County 25021 2184 42.21114 -71.0458            56904.96\n3 Massachusetts Norfolk County 25021 2184 42.21114 -71.0458            56904.96\n  healthcare_coverage income                 date\n1            18019.99 100511 2016-04-10T09:04:48Z\n2            18019.99 100511 2016-04-10T09:04:48Z\n3            18019.99 100511 2016-04-10T09:04:48Z\n                             encounter code\n1 0b03e41b-06a6-66fa-b972-acc5a83b134a  140\n2 0b03e41b-06a6-66fa-b972-acc5a83b134a  113\n3 0b03e41b-06a6-66fa-b972-acc5a83b134a   43\n                                                   description base_cost\n1           Influenza  seasonal  injectable  preservative free       136\n2 Td (adult)  5 Lf tetanus toxoid  preservative free  adsorbed       136\n3                                                 Hep B  adult       136\n\n# ......................................\n# Semi Join: Keep only patients that have a vaccination match\n# (Only patient columns are kept)\n# ......................................\n\nvacc_semi_join &lt;- semi_join(\n  patients,\n  vaccination,\n  by = c(\"id\" = \"patient\"))\n\nhead(vacc_semi_join, n = 3)\n\n                                    id  birthdate  deathdate         ssn\n1 30a6452c-4297-a1ac-977a-6a23237c7b46 1994-02-06            999-52-8591\n2 34a4dcc4-35fb-6ad5-ab98-be285c586a4f 1968-08-06 2009-12-11 999-75-3953\n3 7179458e-d6e3-c723-2530-d4acfe1c2668 2008-12-21            999-70-1925\n    drivers   passport prefix     first      middle       last suffix maiden\n1 S99996852 X47758697X    Mr. Joshua658     Alvin56   Kunde533     NA       \n2 S99993577 X28173268X    Mr. Bennie663               Ebert178     NA       \n3                             Hunter736 Mckinley734 Gerlach374     NA       \n  marital  race   ethnicity gender                  birthplace\n1       M white nonhispanic      M   Boston  Massachusetts  US\n2       D white nonhispanic      M Chicopee  Massachusetts  US\n3         white nonhispanic      M  Spencer  Massachusetts  US\n                      address         city         state          county  fips\n1            811 Kihn Viaduct    Braintree Massachusetts  Norfolk County 25021\n2 975 Pfannerstill Throughway    Braintree Massachusetts  Norfolk County 25021\n3             548 Heller Lane Mattapoisett Massachusetts Plymouth County    NA\n   zip      lat       lon healthcare_expenses healthcare_coverage income\n1 2184 42.21114 -71.04580            56904.96            18019.99 100511\n2 2184 42.25542 -70.97102           124024.12             1075.06  49737\n3    0 41.64829 -70.85062            45645.06             6154.94 133816\n\n# ......................................\n# Anti Join: Keep only patients that do not have a vaccination match\n# ......................................\nvacc_anti_join &lt;- anti_join(\n  patients,\n  vaccination,\n  by = c(\"id\" = \"patient\"))\n\nhead(vacc_anti_join, n = 3)\n\n [1] id                  birthdate           deathdate          \n [4] ssn                 drivers             passport           \n [7] prefix              first               middle             \n[10] last                suffix              maiden             \n[13] marital             race                ethnicity          \n[16] gender              birthplace          address            \n[19] city                state               county             \n[22] fips                zip                 lat                \n[25] lon                 healthcare_expenses healthcare_coverage\n[28] income             \n&lt;0 rows&gt; (or 0-length row.names)\n\n# ......................................\n# Remove temporary datasets\n# ......................................\nrm(vacc_left_join, vacc_right_join, vacc_inner_join, vacc_full_join, vacc_semi_join, vacc_anti_join)\n\nAppending (Binding) DataFrames: Rows and Columns\n\n# Binding Rows Together (bind_rows): Combine NSW, WA, and Others into one dataset\n\nbc_combined_rows &lt;- bind_rows(\n  breast_cancer_NSW,\n  breast_cancer_WA,\n  breast_cancer_others\n)\n\n# Check result\nhead(bc_combined_rows, n = 3)\n\n  sa3code sa3coden    sa3name state   year part50_74 pop50_74 rate50_74\n1   10102    10102 Queanbeyan   NSW 201617      4875     8052  60.50000\n2   10102    10102 Queanbeyan   NSW 201718      5048     8309  60.75961\n3   10102    10102 Queanbeyan   NSW 201819      5276     8588  61.43839\n  agen50_74 expct50_74 part50_69 pop50_69 rate50_69 agen50_69 expct50_69\n1         3       4428      4309     7145  60.30000         2       3929\n2         3       4553      4448     7338  60.62238         2       4013\n3         3       4706      4629     7548  61.33203         2       4113\n  part50_54 pop50_54 rate50_54 agen50_54 expct50_54 part55_59 pop55_59\n1      1284     2251  57.00000         1       1118      1188     1970\n2      1285     2306  55.72035         1       1143      1260     2030\n3      1375     2342  58.70977         1       1166      1252     2093\n  rate55_59 agen55_59 expct55_59 part60_64 pop60_64 rate60_64 agen60_64\n1  60.30000         4       1046      1012     1625  62.30000         5\n2  62.09035         4       1069      1048     1646  63.69947         5\n3  59.81504         4       1098      1105     1689  65.43657         5\n  expct60_64 part65_69 pop65_69 rate65_69 agen65_69 expct65_69 part70_74\n1        950       826     1300  63.50000         6        781       566\n2        953       855     1357  63.02558         6        812       600\n3        967       898     1426  63.00429         6        849       647\n  pop70_74 rate70_74 agen70_74 expct70_74\n1      907  62.40000         7        498\n2      971  61.79725         7        541\n3     1040  62.21032         7        585\n\n# Confirm number of rows\nnrow(bc_combined_rows)\n\n[1] 1364\n\n# Binding Columns Together (bind_cols): Combine Participation Data with SA3 metadata\n# (needs same number of rows)\n\nbc_combined_cols &lt;- bind_cols(\n  participation,\n  breast_cancer_SA3_info )\n# Check result\nhead(bc_combined_cols, n = 3)\n\n    year part50_74 pop50_74 rate50_74 agen50_74 expct50_74 part50_69 pop50_69\n1 201617      4875     8052  60.50000         3       4428      4309     7145\n2 201718      5048     8309  60.75961         3       4553      4448     7338\n3 201819      5276     8588  61.43839         3       4706      4629     7548\n  rate50_69 agen50_69 expct50_69 part50_54 pop50_54 rate50_54 agen50_54\n1  60.30000         2       3929      1284     2251  57.00000         1\n2  60.62238         2       4013      1285     2306  55.72035         1\n3  61.33203         2       4113      1375     2342  58.70977         1\n  expct50_54 part55_59 pop55_59 rate55_59 agen55_59 expct55_59 part60_64\n1       1118      1188     1970  60.30000         4       1046      1012\n2       1143      1260     2030  62.09035         4       1069      1048\n3       1166      1252     2093  59.81504         4       1098      1105\n  pop60_64 rate60_64 agen60_64 expct60_64 part65_69 pop65_69 rate65_69\n1     1625  62.30000         5        950       826     1300  63.50000\n2     1646  63.69947         5        953       855     1357  63.02558\n3     1689  65.43657         5        967       898     1426  63.00429\n  agen65_69 expct65_69 part70_74 pop70_74 rate70_74 agen70_74 expct70_74\n1         6        781       566      907  62.40000         7        498\n2         6        812       600      971  61.79725         7        541\n3         6        849       647     1040  62.21032         7        585\n  sa3code sa3coden    sa3name state\n1   10102    10102 Queanbeyan   NSW\n2   10102    10102 Queanbeyan   NSW\n3   10102    10102 Queanbeyan   NSW\n\n# Appending Rows Using Base R rbind()\n# (Equivalent to bind_rows but simpler cases, needs identical columns)\nbc_combined_rbind &lt;- rbind(\n  breast_cancer_NSW,\n  breast_cancer_WA\n)\n\n# Check result\nhead(bc_combined_rbind, n = 3)\n\n  sa3code sa3coden    sa3name state   year part50_74 pop50_74 rate50_74\n1   10102    10102 Queanbeyan   NSW 201617      4875     8052  60.50000\n2   10102    10102 Queanbeyan   NSW 201718      5048     8309  60.75961\n3   10102    10102 Queanbeyan   NSW 201819      5276     8588  61.43839\n  agen50_74 expct50_74 part50_69 pop50_69 rate50_69 agen50_69 expct50_69\n1         3       4428      4309     7145  60.30000         2       3929\n2         3       4553      4448     7338  60.62238         2       4013\n3         3       4706      4629     7548  61.33203         2       4113\n  part50_54 pop50_54 rate50_54 agen50_54 expct50_54 part55_59 pop55_59\n1      1284     2251  57.00000         1       1118      1188     1970\n2      1285     2306  55.72035         1       1143      1260     2030\n3      1375     2342  58.70977         1       1166      1252     2093\n  rate55_59 agen55_59 expct55_59 part60_64 pop60_64 rate60_64 agen60_64\n1  60.30000         4       1046      1012     1625  62.30000         5\n2  62.09035         4       1069      1048     1646  63.69947         5\n3  59.81504         4       1098      1105     1689  65.43657         5\n  expct60_64 part65_69 pop65_69 rate65_69 agen65_69 expct65_69 part70_74\n1        950       826     1300  63.50000         6        781       566\n2        953       855     1357  63.02558         6        812       600\n3        967       898     1426  63.00429         6        849       647\n  pop70_74 rate70_74 agen70_74 expct70_74\n1      907  62.40000         7        498\n2      971  61.79725         7        541\n3     1040  62.21032         7        585\n\n# Appending Columns Using Base R cbind()\n# (Simple column binding, assumes same number of rows)\n\nbc_combined_cbind &lt;- cbind(\n  participation,\n  breast_cancer_SA3_info)\n\n# Check result\nhead(bc_combined_cbind, n = 3)\n\n    year part50_74 pop50_74 rate50_74 agen50_74 expct50_74 part50_69 pop50_69\n1 201617      4875     8052  60.50000         3       4428      4309     7145\n2 201718      5048     8309  60.75961         3       4553      4448     7338\n3 201819      5276     8588  61.43839         3       4706      4629     7548\n  rate50_69 agen50_69 expct50_69 part50_54 pop50_54 rate50_54 agen50_54\n1  60.30000         2       3929      1284     2251  57.00000         1\n2  60.62238         2       4013      1285     2306  55.72035         1\n3  61.33203         2       4113      1375     2342  58.70977         1\n  expct50_54 part55_59 pop55_59 rate55_59 agen55_59 expct55_59 part60_64\n1       1118      1188     1970  60.30000         4       1046      1012\n2       1143      1260     2030  62.09035         4       1069      1048\n3       1166      1252     2093  59.81504         4       1098      1105\n  pop60_64 rate60_64 agen60_64 expct60_64 part65_69 pop65_69 rate65_69\n1     1625  62.30000         5        950       826     1300  63.50000\n2     1646  63.69947         5        953       855     1357  63.02558\n3     1689  65.43657         5        967       898     1426  63.00429\n  agen65_69 expct65_69 part70_74 pop70_74 rate70_74 agen70_74 expct70_74\n1         6        781       566      907  62.40000         7        498\n2         6        812       600      971  61.79725         7        541\n3         6        849       647     1040  62.21032         7        585\n  sa3code sa3coden    sa3name state\n1   10102    10102 Queanbeyan   NSW\n2   10102    10102 Queanbeyan   NSW\n3   10102    10102 Queanbeyan   NSW\n\n# Important Notes:\n# - bind_rows() can handle different column orders safely\n# - rbind() requires identical column names and order\n# - bind_cols() simply pastes side-by-side, no matching by keys\n# - cbind() assumes same number of rows\n\n# ....................................................\n# Remove all temporary objects created in this chunk\n# ....................................................\nrm(\n  breast_cancer_NSW, breast_cancer_WA, breast_cancer_others, participation, breast_cancer_SA3_info,\n  bc_combined_rows, bc_combined_cols, bc_combined_rbind, bc_combined_cbind\n)\n\n\n\n1.5.4 4.4 Missing Value Identification and Imputations\nA. Identifying Missing Values\n\nis.na(), anyNA(), sum(is.na(x)), colSums() ‚Äì detect/count missing values\ncomplete.cases() ‚Äì filter complete rows\nConvert blanks to NA: x[x == ‚Äú‚Äú] &lt;- NA\n\nB. Handling Missing Values\n\nBasic Removal/Replacement: na.omit(), replace_na() (tidyr), ifelse()\nForward/Backward Fill: fill() (tidyr) with .direction = ‚Äúdown‚Äù / ‚Äúup‚Äù\nStatistical Imputation:\n\n-Simple: mean/median imputation\n-Multiple: mice::mice()()\n-Advanced: Hmisc::aregImpute, missForest, Amelia, zoo::na.fill\nMissing data is a common issue in real-world datasets. In R, handling missing values properly is essential to ensure the integrity of analyses and avoid misleading results.\nThis section covers how to identify, clean, and impute missing values using base R and tidyverse tools. Techniques range from basic filtering to advanced imputation models.\n‚û°Ô∏è Missing values are typically represented as NA in R. Empty strings (e.g., \"\") or special codes (e.g., -99, \"missing\") may also indicate missingness and need conversion before analysis.\nüîπ Summary of Functions for Handling Missing Values\n\n\n\n\n\n\n\n\nTask\nFunction / Code\nPurpose\n\n\n\n\nDetect missing values\nis.na(x), anyNA(x), sum(is.na(x))\nIdentify/count missing values\n\n\nMissing per column\ncolSums(is.na(df))\nCount NAs per column\n\n\nFilter complete rows\ncomplete.cases(df)\nKeep only rows without any missing values\n\n\nConvert blanks to NA\nx[x == \"\"] &lt;- NA\nConvert empty strings to missing values\n\n\nRemove missing rows\nna.omit(df)\nRemove rows with any missing value\n\n\nReplace missing values\nreplace_na(df, list(...)), ifelse(is.na(x), ...)\nImpute or replace NA with custom logic\n\n\nForward/backward fill\nfill(df, .direction = \"down\" / \"up\")\nFill NA using nearby values\n\n\nMean/median imputation\nx[is.na(x)] &lt;- mean(x, na.rm = TRUE)\nReplace NA with summary statistic\n\n\nMultiple imputation\nmice::mice(df)\nCreate multiple imputed datasets using chained equations\n\n\nAdvanced imputation\nHmisc::aregImpute, missForest, Amelia, zoo::na.fill()\nSpecialized techniques for complex imputations\n\n\n\nüìö Further Learning and Resources\nAdditional tutorials, demonstrations, and datasets are available on:\n\nYouTube Channel ‚Äì AnalyticsHub\nhttps://studio.youtube.com/channel/UCLVKP0g8GvHhOh0kn20T8eg/videos/upload?filter=%5B%5D&sort=%7B%22columnType%22%3A%22date%22%2C%22sortOrder%22%3A%22DESCENDING%22%7D\nGitHub Repository\nhttps://github.com/HabtamuBizuayehu?tab=repositories\n\n\n\n\n                                    id  birthdate deathdate         ssn\n1 898a6256-7ffb-dbe2-e24d-12fda2fedcfd 1966-06-23           999-98-5513\n2 5e0a6984-38d7-c604-f55f-f1de5e933768 1986-07-04           999-58-5560\n3 e335de09-0994-4111-3c15-6edcc17ae4bc 2005-04-25           999-48-3846\n4 45b89342-dc05-8e57-8eee-9ed68ec42378 1984-08-24           999-40-3433\n5 916b1ac8-56c8-ec1b-3b9a-721336a74912 1953-05-10           999-16-3735\n6 dc323bce-e583-d903-303e-9c865bc87e67 2012-09-02           999-90-3605\n    drivers   passport prefix     first     middle          last suffix\n1 S99971131 X62454905X   Mrs.  Maris768              Lindgren255     NA\n2 S99931679 X61479569X   Mrs. Hattie299  Reatha769      Nader710     NA\n3 S99958413               Ms.  Jimmie93 Towanda270      Doyle959     NA\n4 S99985178 X27670495X    Mr. Dwight645  Marlin805      Hilll811     NA\n5 S99968840 X83646024X    Ms.  Tambra47 Brittni468 Balistreri607     NA\n6                             Carson894 Raphael767     Littel644     NA\n     maiden marital  race   ethnicity gender                       birthplace\n1   Dach178       D white nonhispanic      F        Oxford  Massachusetts  US\n2 Harber290       M white nonhispanic      F North Reading  Massachusetts  US\n3                   white nonhispanic      F        Boston  Massachusetts  US\n4                 M white nonhispanic      M    Framingham  Massachusetts  US\n5                 S white nonhispanic      F     Lexington  Massachusetts  US\n6                   white nonhispanic      M      Plymouth  Massachusetts  US\n                        address        city         state           county\n1          962 Stiedemann Vista    Aquinnah Massachusetts     Dukes County\n2            720 O'Keefe Arcade      Newton Massachusetts Middlesex County\n3       493 Cruickshank Mission   Holliston Massachusetts Middlesex County\n4              810 Wolf Pathway      Malden Massachusetts Middlesex County\n5      146 Rowe Village Suite 3 New Bedford Massachusetts   Bristol County\n6 467 Collier Stravenue Unit 12   Attleboro Massachusetts   Bristol County\n   fips  zip      lat       lon healthcare_expenses healthcare_coverage income\n1    NA    0 41.29618 -70.77458           343608.18           884243.46 178323\n2 25017 2468 42.29180 -71.14930           169293.06           801407.90  86384\n3    NA    0 42.24196 -71.46440            64178.99             5906.14 198522\n4 25017 2148 42.43610 -71.14328            36010.63           472861.90  25909\n5 25005 2743 41.69576 -71.01391           281198.90           310261.21 140772\n6 44007 2861 41.94870 -71.30420            45972.75                0.00  71169\n  visit\n1     1\n2     1\n3     1\n4     1\n5     1\n6     1\n\n\n\n# Summarise missing values across all columns\nmissing_summary &lt;- colSums(is.na(visits_all))\nprint(missing_summary[missing_summary &gt; 0])\n\n          deathdate             drivers            passport              prefix \n                 40                   4                  12                   8 \n             middle              suffix              maiden             marital \n                  4                  40                  28                  16 \n               race                fips                 zip healthcare_coverage \n                 20                  12                  12                   4 \n             income \n                 20 \n\n# Total number of missing cells\ntotal_missing &lt;- sum(is.na(visits_all))\ncat(\"Total missing values in dataset:\", total_missing, \"\\n\")\n\nTotal missing values in dataset: 220 \n\n# Count of individuals with at least one missing value\nn_missing_individuals &lt;- sum(!complete.cases(visits_all))\ncat(\"Number of individuals with at least one missing value:\", n_missing_individuals, \"\\n\")\n\nNumber of individuals with at least one missing value: 40 \n\n# Sort records by patient ID and visit number\nvisits_all &lt;- visits_all %&gt;%\n  arrange(id_text, visit)\n\n# View rows with any missing values\nmissing_rows &lt;- visits_all %&gt;%\n  filter(!complete.cases(.))\nhead(missing_rows, n = 12) %&gt;% select(id_text, race, income, passport)\n\n                id_text  race income   passport\n1  Anit|S√°nc|1960-05-07 white  61016  X9157439X\n2  Anit|S√°nc|1960-05-07  &lt;NA&gt;     NA  X9157439X\n3  Anit|S√°nc|1960-05-07 white     NA  X9157439X\n4  Anit|S√°nc|1960-05-07  &lt;NA&gt;  60016  X9157439X\n5  Aure|Weis|2003-11-12 white   8752 X17586296X\n6  Aure|Weis|2003-11-12  &lt;NA&gt;     NA X17586296X\n7  Aure|Weis|2003-11-12 white     NA X17586296X\n8  Aure|Weis|2003-11-12  &lt;NA&gt;   7752 X17586296X\n9  Cars|Litt|2012-09-02 white  71169       &lt;NA&gt;\n10 Cars|Litt|2012-09-02  &lt;NA&gt;     NA       &lt;NA&gt;\n11 Cars|Litt|2012-09-02  &lt;NA&gt;  70169       &lt;NA&gt;\n12 Cars|Litt|2012-09-02 white     NA       &lt;NA&gt;\n\n# Impute passport with \"UNKNOWN\"\ndf_passport &lt;- visits_all %&gt;%\n  mutate(passport_imputed = replace_na(passport, \"UNKNOWN\")) %&gt;%\n  filter(is.na(passport)) %&gt;%\n  select(id, id_text, visit, passport, passport_imputed)\n\nhead(df_passport, n = 12)\n\n                                     id              id_text visit passport\n1  dc323bce-e583-d903-303e-9c865bc87e67 Cars|Litt|2012-09-02     1     &lt;NA&gt;\n2  dc323bce-e583-d903-303e-9c865bc87e67 Cars|Litt|2012-09-02     2     &lt;NA&gt;\n3  dc323bce-e583-d903-303e-9c865bc87e67 Cars|Litt|2012-09-02     3     &lt;NA&gt;\n4  dc323bce-e583-d903-303e-9c865bc87e67 Cars|Litt|2012-09-02     4     &lt;NA&gt;\n5  da7b1f55-c782-544f-ba8c-fe69d519dc85 Doll|Fran|2008-10-04     1     &lt;NA&gt;\n6  da7b1f55-c782-544f-ba8c-fe69d519dc85 Doll|Fran|2008-10-04     2     &lt;NA&gt;\n7  da7b1f55-c782-544f-ba8c-fe69d519dc85 Doll|Fran|2008-10-04     3     &lt;NA&gt;\n8  da7b1f55-c782-544f-ba8c-fe69d519dc85 Doll|Fran|2008-10-04     4     &lt;NA&gt;\n9  e335de09-0994-4111-3c15-6edcc17ae4bc Jimm|Doyl|2005-04-25     1     &lt;NA&gt;\n10 e335de09-0994-4111-3c15-6edcc17ae4bc Jimm|Doyl|2005-04-25     2     &lt;NA&gt;\n11 e335de09-0994-4111-3c15-6edcc17ae4bc Jimm|Doyl|2005-04-25     3     &lt;NA&gt;\n12 e335de09-0994-4111-3c15-6edcc17ae4bc Jimm|Doyl|2005-04-25     4     &lt;NA&gt;\n   passport_imputed\n1           UNKNOWN\n2           UNKNOWN\n3           UNKNOWN\n4           UNKNOWN\n5           UNKNOWN\n6           UNKNOWN\n7           UNKNOWN\n8           UNKNOWN\n9           UNKNOWN\n10          UNKNOWN\n11          UNKNOWN\n12          UNKNOWN\n\n# Sort records by patient ID and visit number (to prepare for forward/backward fill)\nvisits_all &lt;- visits_all %&gt;%\n  arrange(id_text, visit)\n\n# Preview sorted data (tail)\ntail(visits_all %&gt;% select(id_text, visit, race, income), n = 12)\n\n                id_text visit  race income\n29 Jimm|Doyl|2005-04-25     1 white 198522\n30 Jimm|Doyl|2005-04-25     2  &lt;NA&gt;     NA\n31 Jimm|Doyl|2005-04-25     3  &lt;NA&gt; 197522\n32 Jimm|Doyl|2005-04-25     4 white     NA\n33 Mari|Lind|1966-06-23     1 white 178323\n34 Mari|Lind|1966-06-23     2  &lt;NA&gt;     NA\n35 Mari|Lind|1966-06-23     3 white     NA\n36 Mari|Lind|1966-06-23     4  &lt;NA&gt; 177323\n37 Tamb|Bali|1953-05-10     1 white 140772\n38 Tamb|Bali|1953-05-10     2  &lt;NA&gt;     NA\n39 Tamb|Bali|1953-05-10     3 white     NA\n40 Tamb|Bali|1953-05-10     4  &lt;NA&gt; 139772\n\n# Forward fill missing race values within each patient (downward)\nvisits_all &lt;- visits_all %&gt;%\n  group_by(id_text) %&gt;%\n  mutate(race_forward = race) %&gt;%\n  fill(race_forward, .direction = \"down\") %&gt;%\n  ungroup()\n\n# Preview forward-filled race values (head)\nhead(visits_all %&gt;% select(id_text, visit, race, race_forward), n = 12)\n\n# A tibble: 12 √ó 4\n   id_text              visit race  race_forward\n   &lt;chr&gt;                &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt;       \n 1 Anit|S√°nc|1960-05-07     1 white white       \n 2 Anit|S√°nc|1960-05-07     2 &lt;NA&gt;  white       \n 3 Anit|S√°nc|1960-05-07     3 white white       \n 4 Anit|S√°nc|1960-05-07     4 &lt;NA&gt;  white       \n 5 Aure|Weis|2003-11-12     1 white white       \n 6 Aure|Weis|2003-11-12     2 &lt;NA&gt;  white       \n 7 Aure|Weis|2003-11-12     3 white white       \n 8 Aure|Weis|2003-11-12     4 &lt;NA&gt;  white       \n 9 Cars|Litt|2012-09-02     1 white white       \n10 Cars|Litt|2012-09-02     2 &lt;NA&gt;  white       \n11 Cars|Litt|2012-09-02     3 &lt;NA&gt;  white       \n12 Cars|Litt|2012-09-02     4 white white       \n\n# Backward fill missing race values within each patient (upward)\nvisits_all &lt;- visits_all %&gt;%\n  group_by(id_text) %&gt;%\n  mutate(race_backward = race) %&gt;%\n  fill(race_backward, .direction = \"up\") %&gt;%\n  ungroup()\n\n# Preview backward-filled race values (tail)\ntail(visits_all %&gt;% select(id_text, visit, race, race_backward), n = 12)\n\n# A tibble: 12 √ó 4\n   id_text              visit race  race_backward\n   &lt;chr&gt;                &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt;        \n 1 Jimm|Doyl|2005-04-25     1 white white        \n 2 Jimm|Doyl|2005-04-25     2 &lt;NA&gt;  white        \n 3 Jimm|Doyl|2005-04-25     3 &lt;NA&gt;  white        \n 4 Jimm|Doyl|2005-04-25     4 white white        \n 5 Mari|Lind|1966-06-23     1 white white        \n 6 Mari|Lind|1966-06-23     2 &lt;NA&gt;  white        \n 7 Mari|Lind|1966-06-23     3 white white        \n 8 Mari|Lind|1966-06-23     4 &lt;NA&gt;  &lt;NA&gt;         \n 9 Tamb|Bali|1953-05-10     1 white white        \n10 Tamb|Bali|1953-05-10     2 &lt;NA&gt;  white        \n11 Tamb|Bali|1953-05-10     3 white white        \n12 Tamb|Bali|1953-05-10     4 &lt;NA&gt;  &lt;NA&gt;         \n\n# Calculate the global (overall) mean income\nglobal_mean_income &lt;- mean(visits_all$income, na.rm = TRUE)\n\n# Use global mean to impute missing income values\nvisits_all &lt;- visits_all %&gt;%\n  mutate(income_global_mean = ifelse(is.na(income), global_mean_income, income))\n\n# Preview global mean-imputed income (head)\nhead(visits_all %&gt;% select(id_text, visit, income, income_global_mean), n = 12)\n\n# A tibble: 12 √ó 4\n   id_text              visit income income_global_mean\n   &lt;chr&gt;                &lt;dbl&gt;  &lt;dbl&gt;              &lt;dbl&gt;\n 1 Anit|S√°nc|1960-05-07     1  61016             61016 \n 2 Anit|S√°nc|1960-05-07     2     NA             96123.\n 3 Anit|S√°nc|1960-05-07     3     NA             96123.\n 4 Anit|S√°nc|1960-05-07     4  60016             60016 \n 5 Aure|Weis|2003-11-12     1   8752              8752 \n 6 Aure|Weis|2003-11-12     2     NA             96123.\n 7 Aure|Weis|2003-11-12     3     NA             96123.\n 8 Aure|Weis|2003-11-12     4   7752              7752 \n 9 Cars|Litt|2012-09-02     1  71169             71169 \n10 Cars|Litt|2012-09-02     2     NA             96123.\n11 Cars|Litt|2012-09-02     3  70169             70169 \n12 Cars|Litt|2012-09-02     4     NA             96123.\n\n# Calculate mean income per participant (id_text)\nparticipant_mean_income &lt;- visits_all %&gt;%\n  group_by(id_text) %&gt;%\n  summarise(mean_income_id = mean(income, na.rm = TRUE), .groups = \"drop\")\n\n# Use participant-level mean to impute missing income values\nvisits_all &lt;- visits_all %&gt;%\n  left_join(participant_mean_income, by = \"id_text\") %&gt;%\n  mutate(income_participant_mean = ifelse(is.na(income), mean_income_id, income))\n\n# Preview participant mean-imputed income (tail)\ntail(visits_all %&gt;% select(id_text, visit, income, income_participant_mean), n = 12)\n\n# A tibble: 12 √ó 4\n   id_text              visit income income_participant_mean\n   &lt;chr&gt;                &lt;dbl&gt;  &lt;dbl&gt;                   &lt;dbl&gt;\n 1 Jimm|Doyl|2005-04-25     1 198522                  198522\n 2 Jimm|Doyl|2005-04-25     2     NA                  198022\n 3 Jimm|Doyl|2005-04-25     3 197522                  197522\n 4 Jimm|Doyl|2005-04-25     4     NA                  198022\n 5 Mari|Lind|1966-06-23     1 178323                  178323\n 6 Mari|Lind|1966-06-23     2     NA                  177823\n 7 Mari|Lind|1966-06-23     3     NA                  177823\n 8 Mari|Lind|1966-06-23     4 177323                  177323\n 9 Tamb|Bali|1953-05-10     1 140772                  140772\n10 Tamb|Bali|1953-05-10     2     NA                  140272\n11 Tamb|Bali|1953-05-10     3     NA                  140272\n12 Tamb|Bali|1953-05-10     4 139772                  139772\n\n# Multiple imputation for fips, zip, healthcare_coverage, and income\npatients_mice &lt;- visits_all %&gt;%\n  select(id_text, fips, zip, healthcare_coverage, income)\n\n# Apply mice\nimputed &lt;- mice(patients_mice %&gt;% select(-id_text), method = \"pmm\", m = 1, printFlag = FALSE)\n\nWarning: Number of logged events: 1\n\n# Retrieve completed dataset\nmice_result &lt;- complete(imputed)\ncolnames(mice_result) &lt;- paste0(colnames(mice_result), \"_imputed\")\n\n# Join ID and filter rows with original missing values\ndf_mice &lt;- bind_cols(patients_mice, mice_result) %&gt;%\n  filter(is.na(fips) | is.na(zip) | is.na(healthcare_coverage) | is.na(income)) %&gt;%\n  select(id_text,\n         fips, fips_imputed,\n         zip, zip_imputed,\n         healthcare_coverage, healthcare_coverage_imputed,\n         income, income_imputed)\n\nhead(df_mice, n = 12)\n\n# A tibble: 12 √ó 9\n   id_text               fips fips_imputed   zip zip_imputed healthcare_coverage\n   &lt;chr&gt;                &lt;int&gt;        &lt;int&gt; &lt;int&gt;       &lt;int&gt;               &lt;dbl&gt;\n 1 Anit|S√°nc|1960-05-07 25009        25009  1915        1915            1280070.\n 2 Anit|S√°nc|1960-05-07 25009        25009  1915        1915            1280070.\n 3 Aure|Weis|2003-11-12 25027        25027  1606        1606             253645.\n 4 Aure|Weis|2003-11-12 25027        25027  1606        1606             253645.\n 5 Cars|Litt|2012-09-02 44007        44007  2861        2861                 NA \n 6 Cars|Litt|2012-09-02 44007        44007  2861        2861                 NA \n 7 Cars|Litt|2012-09-02 44007        44007  2861        2861                 NA \n 8 Cars|Litt|2012-09-02 44007        44007  2861        2861                 NA \n 9 Doll|Fran|2008-10-04    NA        25013    NA        2468             422516.\n10 Doll|Fran|2008-10-04    NA        25027    NA        1030             422516.\n11 Doll|Fran|2008-10-04    NA        25017    NA        2861             422516.\n12 Doll|Fran|2008-10-04    NA        25017    NA        1606             422516.\n# ‚Ñπ 3 more variables: healthcare_coverage_imputed &lt;dbl&gt;, income &lt;dbl&gt;,\n#   income_imputed &lt;dbl&gt;\n\n# Optional: Inspect logged events from mice\nimputed$loggedEvents\n\n  it im                 dep meth\n1  3  1 healthcare_coverage  pmm\n                                                                                                                                                                                                                                                       out\n1 mice detected that your data are (nearly) multi-collinear.\\nIt applied a ridge penalty to continue calculations, but the results can be unstable.\\nDoes your dataset contain duplicates, linear transformation, or factors with unique respondent names?\n\n# Final summary: compare original and imputed values for rows with missingness\n\nfinal_impute_check &lt;- visits_all %&gt;%\n  filter(is.na(race) | is.na(income)) %&gt;%\n  select(id_text, visit,\n         race, race_forward, race_backward,\n         income, income_global_mean, income_participant_mean)\n\n# Preview top 12\nhead(final_impute_check, n = 12)\n\n# A tibble: 12 √ó 8\n   id_text      visit race  race_forward race_backward income income_global_mean\n   &lt;chr&gt;        &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt;        &lt;chr&gt;          &lt;dbl&gt;              &lt;dbl&gt;\n 1 Anit|S√°nc|1‚Ä¶     2 &lt;NA&gt;  white        white             NA             96123.\n 2 Anit|S√°nc|1‚Ä¶     3 white white        white             NA             96123.\n 3 Anit|S√°nc|1‚Ä¶     4 &lt;NA&gt;  white        &lt;NA&gt;           60016             60016 \n 4 Aure|Weis|2‚Ä¶     2 &lt;NA&gt;  white        white             NA             96123.\n 5 Aure|Weis|2‚Ä¶     3 white white        white             NA             96123.\n 6 Aure|Weis|2‚Ä¶     4 &lt;NA&gt;  white        &lt;NA&gt;            7752              7752 \n 7 Cars|Litt|2‚Ä¶     2 &lt;NA&gt;  white        white             NA             96123.\n 8 Cars|Litt|2‚Ä¶     3 &lt;NA&gt;  white        white          70169             70169 \n 9 Cars|Litt|2‚Ä¶     4 white white        white             NA             96123.\n10 Doll|Fran|2‚Ä¶     2 &lt;NA&gt;  white        white             NA             96123.\n11 Doll|Fran|2‚Ä¶     3 &lt;NA&gt;  white        white         187023            187023 \n12 Doll|Fran|2‚Ä¶     4 white white        white             NA             96123.\n# ‚Ñπ 1 more variable: income_participant_mean &lt;dbl&gt;\n\n# Preview bottom 12\ntail(final_impute_check, n = 12)\n\n# A tibble: 12 √ó 8\n   id_text      visit race  race_forward race_backward income income_global_mean\n   &lt;chr&gt;        &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt;        &lt;chr&gt;          &lt;dbl&gt;              &lt;dbl&gt;\n 1 Home|Qui√±|1‚Ä¶     2 &lt;NA&gt;  white        white             NA             96123.\n 2 Home|Qui√±|1‚Ä¶     3 &lt;NA&gt;  white        white           6361              6361 \n 3 Home|Qui√±|1‚Ä¶     4 white white        white             NA             96123.\n 4 Jimm|Doyl|2‚Ä¶     2 &lt;NA&gt;  white        white             NA             96123.\n 5 Jimm|Doyl|2‚Ä¶     3 &lt;NA&gt;  white        white         197522            197522 \n 6 Jimm|Doyl|2‚Ä¶     4 white white        white             NA             96123.\n 7 Mari|Lind|1‚Ä¶     2 &lt;NA&gt;  white        white             NA             96123.\n 8 Mari|Lind|1‚Ä¶     3 white white        white             NA             96123.\n 9 Mari|Lind|1‚Ä¶     4 &lt;NA&gt;  white        &lt;NA&gt;          177323            177323 \n10 Tamb|Bali|1‚Ä¶     2 &lt;NA&gt;  white        white             NA             96123.\n11 Tamb|Bali|1‚Ä¶     3 white white        white             NA             96123.\n12 Tamb|Bali|1‚Ä¶     4 &lt;NA&gt;  white        &lt;NA&gt;          139772            139772 \n# ‚Ñπ 1 more variable: income_participant_mean &lt;dbl&gt;\n\n# Clean up temporary objects \nrm( participant_mean_income, final_impute_check, global_mean_income, df_passport, df_mice,\n    patients_mice, imputed, mice_result, missing_summary, total_missing, n_missing_individuals, missing_rows\n)"
  },
  {
    "objectID": "Post_Blog/Data Manipulation and Wrangling.html#part-vi-descriptive-statistics-and-tabulation",
    "href": "Post_Blog/Data Manipulation and Wrangling.html#part-vi-descriptive-statistics-and-tabulation",
    "title": "Date Manipulation and Wrangling using R",
    "section": "1.6 üî¢ PART VI: Descriptive Statistics and Tabulation",
    "text": "1.6 üî¢ PART VI: Descriptive Statistics and Tabulation\nIn data analysis, summarising and tabulating variables is often the first step before conducting modelling or drawing conclusions. Descriptive statistics reveal the central tendency, variability, distribution shape, and frequency patterns in your dataset.\nThis section provides an overview of the most commonly used R functions for summarising both numeric and categorical variables. These tools help detect outliers, missing data, or skewed distributions and are essential for generating publication-ready summary tables.\nüìö Further are available via:\n\nYouTube: AnalyticsHub\n\nGithub: Summary Tools Repository\n\n\nSome of the contents essential for this section are presented below.\nBasic Summary Statistics\nsummary(), mean(), median(), min(), max(), sd(), var(), range(), quantile(), IQR()\nDistribution Shape / Skewness: skewness(), kurtosis() Extended Descriptive Summaries: describe() ,stat.desc(), skim() Tabulation (Frequencies and Proportions)\ntable(), prop.table(), addmargins(), xtabs()\nTidy Summary and Tabulations\ntabyl(), adorn_percentages(), adorn_totals() ‚Äì From janitor\ncount(), group_by() + summarise() ‚Äì From dplyr\npivot_wider(), pivot_longer() ‚Äì From tidyr\nCross Tabulations: CrossTable() ‚Äì From gmodels\n\n1.6.1 üîπ 1. Basic Summary Statistics\nThese functions are useful for summarising continuous variables such as age, vaccine cost, or time intervals:\n\nsummary() ‚Äì 5-number summary + mean\n\nmean(), median() ‚Äì Measures of central tendency\n\nsd(), var() ‚Äì Measures of spread\n\nmin(), max() ‚Äì Extremes\n\nrange() ‚Äì Min and max in one\n\nquantile() ‚Äì Percentiles (e.g., 25th, 75th)\nIQR() ‚Äì Interquartile range\n\n\n\n\n  Childhood Respiratory       Other \n        472         955         126 \n\n\n\nFemale   Male \n   798    755 \n\n\n\n# ....................................................\n# Basic Summary Statistics Using Base R\n# ....................................................\n\n# Select key numeric variables\nsummary_vars &lt;- vacc_1524 %&gt;% \n  select(age, base_cost, healthcare_expenses)\n\n# View summary() for a quick five-number summary + mean\nsummary(summary_vars)\n\n      age          base_cost   healthcare_expenses\n Min.   : 1.00   Min.   :136   Min.   :    527.5  \n 1st Qu.:12.00   1st Qu.:136   1st Qu.:  14478.2  \n Median :25.00   Median :136   Median :  56729.2  \n Mean   :32.42   Mean   :136   Mean   : 156656.2  \n 3rd Qu.:52.00   3rd Qu.:136   3rd Qu.: 195830.8  \n Max.   :97.00   Max.   :136   Max.   :1157947.0  \n\n# Individual statistics for 'age'\nmean(vacc_1524$age, na.rm = TRUE)             # Mean age\n\n[1] 32.41661\n\nmedian(vacc_1524$age, na.rm = TRUE)           # Median age\n\n[1] 25\n\nmin(vacc_1524$age, na.rm = TRUE)              # Minimum age\n\n[1] 1\n\nmax(vacc_1524$age, na.rm = TRUE)              # Maximum age\n\n[1] 97\n\nsd(vacc_1524$age, na.rm = TRUE)               # Standard deviation of age\n\n[1] 23.76926\n\nvar(vacc_1524$age, na.rm = TRUE)              # Variance of age\n\n[1] 564.9777\n\nrange(vacc_1524$age, na.rm = TRUE)            # Range: min and max\n\n[1]  1 97\n\nquantile(vacc_1524$age, probs = c(0.25, 0.5, 0.75), na.rm = TRUE)  # Quartiles\n\n25% 50% 75% \n 12  25  52 \n\nIQR(vacc_1524$age, na.rm = TRUE)              # Interquartile range\n\n[1] 40\n\n# ....................................................\n# Clean up temporary object\n# ....................................................\nrm(summary_vars)\n\n\n\n1.6.2 üîπ 2. Shape of Distribution (Skewness and Kurtosis)\nThese indicators describe the shape of a numeric variable‚Äôs distribution. They help identify when a variable is:\n\nSkewed (not symmetric)\nHeavy-tailed (high kurtosis)\n\nDistribution Shape: Skewness and Kurtosis\n\n\n\n\n\n\n\n\nValue Range\nSkewness\nKurtosis (Excess)\n\n\n\n\n‚âà 0\nSymmetrical\nMesokurtic (normal-tailed)\n\n\n¬±0.5\nApproximately symmetrical\nSlight deviation\n\n\n¬±0.5 ‚Äì ¬±1\nModerate skew\nModerate peakedness or flatness\n\n\n&gt; ¬±1\nHigh skew (strong asymmetry)\nSubstantial deviation from normality\n\n\n&gt; 0 (kurtosis - 3 &gt; 0)\n‚Äì\nLeptokurtic (peaked, heavy tails)\n\n\n&lt; 0 (kurtosis - 3 &lt; 0)\n‚Äì\nPlatykurtic (flat, light tails)\n\n\n\n\n# Ensure the 'moments' package is installed\nif (!requireNamespace(\"moments\", quietly = TRUE)) {install.packages(\"moments\")}\nlibrary(moments)\n\n\n# Calculate distribution shape statistics\nskewness(vacc_1524$age, na.rm = TRUE)     # Skewness: +ve = right-skewed, -ve = left-skewed\n\n[1] 0.5301022\n\nkurtosis(vacc_1524$age, na.rm = TRUE)     # Kurtosis: &gt;3 = heavy tails, &lt;3 = flat distribution\n\n[1] 2.059686\n\nkurtosis(vacc_1524$age, na.rm = TRUE) - 3  # Excess kurtosis\n\n[1] -0.940314\n\n# ....................................................\n# Histogram to Visualize Distribution Shape\n# ....................................................\nhist(vacc_1524$age, \n     main = \"Histogram of Age\",\n     xlab = \"Age (Years)\", \n     col = \"#69b3a2\", \n     border = \"white\")\n\n\n\n\n\n\n\n\n\n\n\n1.6.3 üîπ 3. Extended Descriptive Summaries\nTo produce a comprehensive summary of all variables (especially helpful in surveys or health system datasets), use:\n\ndescribe() ‚Äì From Hmisc: includes labels, missing %, and stats\n\nstat.desc() ‚Äì From pastecs: full statistical description with skew/kurtosis\n\nskim() ‚Äì From skimr: summary with inline histograms and types\n\n\n\n# Install required packages if missing\npackages &lt;- c(\"Hmisc\", \"pastecs\", \"skimr\")\nfor (p in packages) {if (!requireNamespace(p, quietly = TRUE)) install.packages(p)}\n\n# Explicitly load the packages\nlibrary(Hmisc)     # for describe()\nlibrary(pastecs)   # for stat.desc()\nlibrary(skimr)     # for skim()\n\nrm (packages)\n\n\n# ------------------------------\n# Extended Descriptive Summaries\n# ------------------------------\n\n# Hmisc::describe() ‚Äì Detailed variable summary\ndescribe(vacc_1524[, c(\"age\", \"gender\", \"race\")])\n\nvacc_1524[, c(\"age\", \"gender\", \"race\")] \n\n 3  Variables      1553  Observations\n--------------------------------------------------------------------------------\nage \n       n  missing distinct     Info     Mean  pMedian      Gmd      .05 \n    1553        0       62    0.999    32.42       32    26.76      5.0 \n     .10      .25      .50      .75      .90      .95 \n     6.0     12.0     25.0     52.0     68.8     73.0 \n\nlowest :  1  2  5  6  7, highest: 76 78 80 85 97\n--------------------------------------------------------------------------------\ngender \n       n  missing distinct \n    1553        0        2 \n                        \nValue      Female   Male\nFrequency     798    755\nProportion  0.514  0.486\n--------------------------------------------------------------------------------\nrace \n       n  missing distinct \n    1553        0        5 \n                                             \nValue       asian  black native  other  white\nFrequency     111     94     13     29   1306\nProportion  0.071  0.061  0.008  0.019  0.841\n--------------------------------------------------------------------------------\n\n# pastecs::stat.desc() ‚Äì Full statistics with skewness/kurtosis\nstat.desc(vacc_1524$age)\n\n     nbr.val     nbr.null       nbr.na          min          max        range \n1.553000e+03 0.000000e+00 0.000000e+00 1.000000e+00 9.700000e+01 9.600000e+01 \n         sum       median         mean      SE.mean CI.mean.0.95          var \n5.034300e+04 2.500000e+01 3.241661e+01 6.031564e-01 1.183087e+00 5.649777e+02 \n     std.dev     coef.var \n2.376926e+01 7.332432e-01 \n\n# skimr::skim() ‚Äì Tidy summary with histograms and data types\nskim(vacc_1524[, c(\"age\", \"gender\", \"income\")])\n\n\nData summary\n\n\nName\nvacc_1524[, c(‚Äúage‚Äù, ‚Äúgen‚Ä¶\n\n\nNumber of rows\n1553\n\n\nNumber of columns\n3\n\n\n_______________________\n\n\n\nColumn type frequency:\n\n\n\nfactor\n1\n\n\nnumeric\n2\n\n\n________________________\n\n\n\nGroup variables\nNone\n\n\n\nVariable type: factor\n\n\n\n\n\n\n\n\n\n\n\nskim_variable\nn_missing\ncomplete_rate\nordered\nn_unique\ntop_counts\n\n\n\n\ngender\n0\n1\nFALSE\n2\nFem: 798, Mal: 755\n\n\n\nVariable type: numeric\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nskim_variable\nn_missing\ncomplete_rate\nmean\nsd\np0\np25\np50\np75\np100\nhist\n\n\n\n\nage\n0\n1\n32.42\n23.77\n1\n12\n25\n52\n97\n‚ñá‚ñÉ‚ñÉ‚ñÉ‚ñÅ\n\n\nincome\n0\n1\n108887.58\n139702.07\n7361\n35860\n75767\n124775\n816851\n‚ñá‚ñÅ‚ñÅ‚ñÅ‚ñÅ\n\n\n\n\n\n\n\n1.6.4 üîπ 4. Tabulation (Frequencies and Proportions)\nUsed for categorical variables like gender, race, or vaccine group:\n\ntable() ‚Äì Basic frequency counts\n\nprop.table() ‚Äì Row/column proportions\n\naddmargins() ‚Äì Adds totals to tables\n\nxtabs() ‚Äì Cross-tabulation formula interface\n\n\n\n# --------------------------------------------\n# üîπ Categorical Variable Summary \n# --------------------------------------------\n\n# Basic frequency counts for individual vaccine types\ntable(vacc_1524$vaccine_group)\n\n\n          COVID-19          DTP group          Hepatitis                Hib \n               144                147                111                 32 \n               HPV          Influenza                IPV      Meningococcal \n                59                811                 47                 50 \n               MMR Pneumococcal PCV13 Pneumococcal PPV23          Rotavirus \n                26                 52                  8                 21 \n         Varicella             Zoster \n                26                 19 \n\n# Frequency counts for grouped vaccine categories\ntable(vacc_1524$vacc_group3)\n\n\n  Childhood Respiratory       Other \n        472         955         126 \n\n# Proportion of grouped vaccine categories\nprop.table(table(vacc_1524$vacc_group3))  # Overall proportions\n\n\n  Childhood Respiratory       Other \n 0.30392788  0.61493883  0.08113329 \n\n# Frequency table with row/column totals added\naddmargins(table(vacc_1524$vacc_group3))\n\n\n  Childhood Respiratory       Other         Sum \n        472         955         126        1553 \n\n# Cross-tabulation between vaccine group and gender\nxtabs(~ vacc_group3 + gender, data = vacc_1524)\n\n             gender\nvacc_group3   Female Male\n  Childhood      233  239\n  Respiratory    511  444\n  Other           54   72\n\n\n\n\n1.6.5 üîπ 5. Tidy Summary and Tabulations\nModern workflows prefer tidy-format summaries using:\n\ntabyl() ‚Äì From janitor: clean frequency tables\n\nadorn_totals(), adorn_percentages() ‚Äì Add percentages and totals\n\ncount() ‚Äì From dplyr: group-level counts\n\ngroup_by() + summarise() ‚Äì Group-wise summary\npivot_wider(), pivot_longer() ‚Äì Reshape tables\n\nThe section below demonstrates tabulations using janitor::tabyl() and tidyverse functions for grouped summaries and table reshaping.\n\n# --------------------------------------------\n# üîπ Tabulation and Table Reshaping \n# --------------------------------------------\n\n# 1. Basic clean frequency table with janitor::tabyl()\nvacc_1524 %&gt;%\n  tabyl(vacc_group3)\n\n vacc_group3   n    percent\n   Childhood 472 0.30392788\n Respiratory 955 0.61493883\n       Other 126 0.08113329\n\n# 2. Add column percentages and total row\nvacc_1524 %&gt;%\n  tabyl(vacc_group3, gender) %&gt;%\n  adorn_percentages(\"col\") %&gt;%\n  adorn_totals(\"row\") %&gt;%\n  adorn_title(\"combined\")  # Cleaner column names\n\n vacc_group3/gender     Female       Male\n          Childhood 0.29197995 0.31655629\n        Respiratory 0.64035088 0.58807947\n              Other 0.06766917 0.09536424\n              Total 1.00000000 1.00000000\n\n# 3. Group-level count using dplyr::count()\nvacc_1524 %&gt;%\n  count(vacc_group3, gender)\n\n  vacc_group3 gender   n\n1   Childhood Female 233\n2   Childhood   Male 239\n3 Respiratory Female 511\n4 Respiratory   Male 444\n5       Other Female  54\n6       Other   Male  72\n\n# 4. Group-wise summary using group_by + summarise\nvacc_1524 %&gt;%\n  group_by(vacc_group3) %&gt;%\n  summarise(n = n(), .groups = \"drop\") %&gt;%\n  mutate(prop = n / sum(n))\n\n# A tibble: 3 √ó 3\n  vacc_group3     n   prop\n  &lt;fct&gt;       &lt;int&gt;  &lt;dbl&gt;\n1 Childhood     472 0.304 \n2 Respiratory   955 0.615 \n3 Other         126 0.0811\n\n# 5. Pivot table to wide format (e.g., for display or reporting)\nvacc_1524 %&gt;%\n  count(vacc_group3, gender) %&gt;%\n  pivot_wider(names_from = gender, values_from = n, values_fill = 0)\n\n# A tibble: 3 √ó 3\n  vacc_group3 Female  Male\n  &lt;fct&gt;        &lt;int&gt; &lt;int&gt;\n1 Childhood      233   239\n2 Respiratory    511   444\n3 Other           54    72\n\n# 6. Optional: Pivot longer to return to tidy format\nvacc_1524 %&gt;%\n  count(vacc_group3, gender) %&gt;%\n  pivot_wider(names_from = gender, values_from = n, values_fill = 0) %&gt;%\n  pivot_longer(-vacc_group3, names_to = \"gender\", values_to = \"count\")\n\n# A tibble: 6 √ó 3\n  vacc_group3 gender count\n  &lt;fct&gt;       &lt;chr&gt;  &lt;int&gt;\n1 Childhood   Female   233\n2 Childhood   Male     239\n3 Respiratory Female   511\n4 Respiratory Male     444\n5 Other       Female    54\n6 Other       Male      72\n\n\n\n\n1.6.6 üîπ 6. Cross Tabulations\nUsed to explore the relationship between two or more categorical variables.\n\nCrossTable() ‚Äì From gmodels: produces detailed cross-tabs with row %, column %, and counts\n\n\n# Install and load the gmodels package for cross-tabulation\nif (!requireNamespace(\"gmodels\", quietly = TRUE)) {\n  install.packages(\"gmodels\")\n}\nlibrary(gmodels)\n\n\n# ------------------------------\n# Cross Tabulation Example\n# ------------------------------\n\n# Generate a contingency table between gender and vaccine group\nCrossTable(vacc_1524$vacc_group3, vacc_1524$gender,\n           prop.r = FALSE,     # Row proportions\n           prop.c = TRUE,     # Column proportions\n           prop.t = FALSE,    # Overall proportion (optional)\n           chisq = TRUE)      # Include chi-square test for independence\n\n\n \n   Cell Contents\n|-------------------------|\n|                       N |\n| Chi-square contribution |\n|           N / Col Total |\n|-------------------------|\n\n \nTotal Observations in Table:  1553 \n\n \n                      | vacc_1524$gender \nvacc_1524$vacc_group3 |    Female |      Male | Row Total | \n----------------------|-----------|-----------|-----------|\n            Childhood |       233 |       239 |       472 | \n                      |     0.375 |     0.396 |           | \n                      |     0.292 |     0.317 |           | \n----------------------|-----------|-----------|-----------|\n          Respiratory |       511 |       444 |       955 | \n                      |     0.838 |     0.886 |           | \n                      |     0.640 |     0.588 |           | \n----------------------|-----------|-----------|-----------|\n                Other |        54 |        72 |       126 | \n                      |     1.783 |     1.885 |           | \n                      |     0.068 |     0.095 |           | \n----------------------|-----------|-----------|-----------|\n         Column Total |       798 |       755 |      1553 | \n                      |     0.514 |     0.486 |           | \n----------------------|-----------|-----------|-----------|\n\n \nStatistics for All Table Factors\n\n\nPearson's Chi-squared test \n------------------------------------------------------------\nChi^2 =  6.162349     d.f. =  2     p =  0.04590531 \n\n\n \n\n\n\nüîπ Summary Table: Descriptive Statistics and Tabulation Functions\n\n\n\n\n\n\n\n\nTask\nFunction\nPackage\n\n\n\n\nBasic numeric summaries\nsummary(), mean(), sd(), IQR()\nbase\n\n\nPercentiles and range\nquantile(), range()\nbase\n\n\nSkewness / Kurtosis\nskewness(), kurtosis()\ne1071, moments\n\n\nExtended profiling\ndescribe(), stat.desc(), skim()\nHmisc, pastecs, skimr\n\n\nFrequency tables\ntable(), xtabs(), prop.table()\nbase\n\n\nClean tables (tidy)\ntabyl(), adorn_*(), count()\njanitor, dplyr\n\n\nGroup summaries\ngroup_by() + summarise()\ndplyr\n\n\nReshape for tables\npivot_wider(), pivot_longer()\ntidyr\n\n\nRich cross-tabulation\nCrossTable()\ngmodels\n\n\n\n\n\n\n1.6.7 7.2 Saving and Writing Data\n\nwrite.csv(), write_xlsx(), saveRDS(), write_tsv()\nExporting interactive tables with DT::datatable()\nSaving and loading the entire R workspace (save.image(), load())"
  },
  {
    "objectID": "Post_Blog/Data Manipulation and Wrangling.html#part-vii-data-visualization-with-ggplot2",
    "href": "Post_Blog/Data Manipulation and Wrangling.html#part-vii-data-visualization-with-ggplot2",
    "title": "Date Manipulation and Wrangling using R",
    "section": "1.7 PART VII: DATA VISUALIZATION WITH ggplot2",
    "text": "1.7 PART VII: DATA VISUALIZATION WITH ggplot2\nVisualization Contents and Types Overview\n\nLayers: Theme, Coordinates, Facets, Statistics, Geometries, Aesthetics, Data\nChart Types: line, histogram, boxplot, bar, area, density, violin, dotplot, ECDF, scatter, bubble, QQ plot\nComparative & Multivariate: faceted plot, pair plot, heatmap, treemap, radar chart, ridgeline plot, forest plot\nGeospatial Visualization: choropleth map, point map, heatmap overlay\nStatistical Overlays: error bars, confidence intervals, regression lines, smoothers\nInteractive Visualization: scatter/line/bar (Plotly), interactive tables (DT), interactive maps (Leaflet), dashboards (Shiny, flexdashboard)\n\nEffective visualizations help uncover patterns, trends, and insights in data. In R, we commonly use the ggplot2 package for static plots and tools like plotly, DT, and leaflet for interactive dashboards and graphics.\nThe sections below summarize different types of visualizations and how they fit into analysis workflows.\n\n\n1.7.1 üîπ Visualization Layer Components\nEvery ggplot chart is built using multiple composable layers: - Data: The dataset to visualize. - Aesthetics (aes()): Mappings between variables and visual elements (e.g., x, y, color). - Geometries (geom_*): Plot types (e.g., geom_line(), geom_bar()). - Statistics (stat_*): Summaries or transformations (e.g., stat_smooth()). - Facets: Create multiple plots by group (facet_wrap(), facet_grid()). - Coordinates: Set axis and aspect ratio (coord_cartesian(), coord_flip()). - Themes: Control overall appearance (e.g., theme_minimal(), theme_bw()).\n\n\n1.7.2 üîπ Common Chart Types\n\n\n\n\n\n\n\n\nChart Type\nFunction\nUsed For\n\n\n\n\nLine Chart\ngeom_line()\nTrends over time\n\n\nHistogram\ngeom_histogram()\nDistribution of continuous variables\n\n\nBoxplot\ngeom_boxplot()\nDistribution & outliers\n\n\nBar Plot\ngeom_bar()\nCounts or categorical comparison\n\n\nArea Plot\ngeom_area()\nCumulative trends\n\n\nDensity Plot\ngeom_density()\nSmoothed distribution\n\n\nViolin Plot\ngeom_violin()\nCombination of boxplot + density\n\n\nDot Plot\ngeom_dotplot()\nCount-based plots\n\n\nECDF Plot\nstat_ecdf()\nCumulative distribution\n\n\nScatter Plot\ngeom_point()\nBivariate relationships\n\n\nBubble Plot\ngeom_point(aes(size = ...))\n3-variable comparison using size\n\n\n\n\n\n\n1.7.3 üîπ Comparative & Multivariate Visuals\n\n\n\n\n\n\n\nVisual Type\nPurpose\n\n\n\n\nFaceted Plot (facet_wrap)\nCompare subgroups in separate panels\n\n\nPair Plot (GGally::ggpairs)\nExplore all pairwise relationships\n\n\nHeatmap (geom_tile, heatmap())\nShow intensity using color\n\n\nTreemap (treemapify)\nHierarchical categories and values\n\n\nRadar Chart (fmsb)\nCompare multivariate profiles\n\n\nRidgeline Plot (ggridges)\nDistribution comparison across groups\n\n\nForest Plot (forestplot, ggforestplot)\nConfidence intervals and effect sizes\n\n\n\n\n\n\n1.7.4 üîπ Geospatial Visualizations\n\n\n\n\n\n\n\nMap Type\nFunction/Use\n\n\n\n\nChoropleth Map\nShow values by region (e.g., geom_sf(), tmap)\n\n\nPoint Map\nLocations with coordinates (e.g., geom_point(), leaflet::addMarkers)\n\n\nHeatmap Overlay\nDensity of spatial events (e.g., leaflet::addHeatmap())\n\n\n\n\n\n\n1.7.5 üîπ Statistical Enhancements (Overlays)\n\nError bars: geom_errorbar() for confidence or SD intervals\nRegression lines: geom_smooth(method = \"lm\")\nTrend smoothing: geom_smooth() with method = \"loess\"\nLabeling: geom_text(), geom_label() to annotate plots\n\n\nThis section demonstrates how to visualize breast cancer screening and vaccination data. We‚Äôll walk through common chart types such as line plots, bar charts, boxplots, and faceted views. Each example is designed with annotations and descriptions to aid understanding.\n\n\n\n1.7.6 üîπ Visualization Layer Components with Examples\nEach chart demonstrates how different ggplot2 components come together using real health datasets.\n\n# Install if not already installed\nif (!requireNamespace(\"treemapify\", quietly = TRUE)) {install.packages(\"treemapify\")}\nif (!requireNamespace(\"ggridges\", quietly = TRUE)) {install.packages(\"ggridges\")}\nif (!requireNamespace(\"gganimate\", quietly = TRUE)) install.packages(\"gganimate\")\nif (!requireNamespace(\"gifski\", quietly = TRUE)) install.packages(\"gifski\")\n\nlibrary(gganimate)\nlibrary(gifski)\nlibrary(ggridges)\nlibrary(dplyr)\nlibrary(ggplot2)\nlibrary(plotly)\nlibrary(treemapify)\nlibrary(stringr)  # for str_to_title()\nlibrary(tidyr)\n\n\n\n Date[1:1553], format: \"1994-02-06\" \"1994-02-06\" \"1994-02-06\" \"1994-02-06\" \"1994-02-06\" ...\n\n\n\n  1   2   5   6   7  10  11  12  13  14  15  16  17  18  19  20  21  23  24  25 \n 46  24  64  66  34 100  38  59  21  21  34  81  18  36  18  34  40  13  12  47 \n 27  28  29  30  33  34  36  37  38  40  41  42  43  44  45  46  47  48  49  50 \n 17  30   9  35   4   7   6   8   6  20  37  16   9  17  15  13   9  21  30  15 \n 51  52  53  55  56  58  60  61  62  63  64  65  68  69  71  73  74  76  78  80 \n 13  30  16  30  26  14  12  24  36  13  25  14  14  47  14  19  15  14  12  13 \n 85  97 \n 12  10 \n\n\n\n  0‚Äì9 10‚Äì19 20‚Äì29 30‚Äì49   50+ \n  234   426   202   253   438 \n\n\n\n2016 2017 2018 2019 \n 341  341  341  341 \n\n\nLine Chart ‚Äì Breast Cancer Screening Trends by Region in Australia\nThe example below shows a line chart illustrating trends in breast cancer screening rates across Australian states from 2016 to 2019.\n\nBreast cancer screening rates across most Australian states appeared relatively consistent from 2016 to 2018, with minor year-to-year variations.\nA notable decline in screening rates is evident after 2018 and particularly in 2019, coinciding with the early stages of the COVID-19 pandemic\n\nState-specific Observations:\n\nTasmania (Tas) consistently had the highest screening rate, around 60%, but showed a clear decline post-2018.\nThe Northern Territory (NT) had the lowest rates, around 40%, also experiencing a slight decline during this period.\nOther states (ACT, NSW, Qld, SA, Vic, WA) maintained relatively stable rates (around 55%) until 2018, after which a distinct downturn is noticeable, particularly in Western Australia (WA) and Victoria (Vic).\n\nImpact of COVID-19:\n\nThe observed decline in breast cancer screening from 2019 onwards aligns with the emergence of the COVID-19 pandemic, which disrupted routine healthcare services globally.\n\nThis analysis underscores the importance of maintaining consistent access to healthcare services, particularly preventive screenings, even during periods of significant healthcare disruption.\n\n# Visualizing changes in screening rates (50‚Äì74 years) over time by state\n\nbreast_cancer_data %&gt;%\n  group_by(state, year_4digit) %&gt;%  # group by state and year\n  summarise(mean_rate = mean(rate50_74, na.rm = TRUE), .groups = \"drop\") %&gt;%\n  ggplot(aes(x = year_4digit, y = mean_rate, color = state)) +  # map axes and color\n  geom_line(size = 1.2) +  # trend lines\n  geom_point(size = 2) +   # points for each year\n  labs(\n    title = \"Breast Cancer Screening Rates (50‚Äì74 yrs)\",  \n    subtitle = \"Aggregated by State and Year\",           \n    x = \"Year\", y = \"Screening Rate (%)\",  # Axis labels\n    color = \"State\"   # Legend title\n  ) +\n  \n  theme_minimal()  \n\nWarning: Using `size` aesthetic for lines was deprecated in ggplot2 3.4.0.\n‚Ñπ Please use `linewidth` instead.\n\n\nWarning: Removed 4 rows containing missing values or values outside the scale range\n(`geom_line()`).\n\n\nWarning: Removed 4 rows containing missing values or values outside the scale range\n(`geom_point()`).\n\n\n\n\n\n\n\n\n\nHistogram ‚Äì Distribution of Age\nDisplays the frequency of vaccinated individuals by age, with a density line overlay to visualize the distribution shape.\nThe example below shows a histogram illustrating the age distribution within our studied population. The distribution highlights a clear bimodal pattern, indicating two main age groups. The largest group comprises younger adults, predominantly around 20‚Äì30 years old, suggesting a significant representation of young adults. A smaller secondary group emerges around 55‚Äì65 years old, reflecting a noticeable segment of older adults. This pattern may indicate specific target groups or demographic characteristics relevant to the population from which the data was collected. Understanding these age clusters can help tailor appropriate health strategies, services, or interventions accordingly.\n\nvacc_1524 %&gt;%\n  ggplot(aes(x = age)) +\n  geom_histogram(aes(y = ..density..), binwidth = 5, fill = \"darkblue\", color = \"white\", alpha = 0.7) +\n  geom_density(color = \"red\", size = 1.2) +\n  labs(title = \"Age Distribution with Density Curve\", x = \"Age\", y = \"Density\") +\n  theme_minimal()\n\nWarning: The dot-dot notation (`..density..`) was deprecated in ggplot2 3.4.0.\n‚Ñπ Please use `after_stat(density)` instead.\n\n\n\n\n\n\n\n\n\nPie Chart ‚Äì Proportion by Vaccine Group\nShows how vaccine groups are proportionally represented in the dataset. Useful for visualizing categorical outcomes.\nIn the example below, the pie chart represents the proportion of vaccinations grouped into three categories:\n\nRespiratory vaccines account for the largest proportion, comprising 61% of all vaccines administered.\nChildhood vaccines represent a significant portion as well, making up 30%.\nThe category labeled Other includes 8% of vaccines administered, indicating a smaller but notable group of vaccinations outside the respiratory and childhood classifications.\n\n\nvacc_1524 %&gt;%\n  count(vacc_group3) %&gt;%\n  mutate(perc = n / sum(n), label = scales::percent(perc)) %&gt;%\n  ggplot(aes(x = \"\", y = perc, fill = vacc_group3)) +\n  geom_col(width = 1) +\n  coord_polar(theta = \"y\") +\n  geom_text(aes(label = label), position = position_stack(vjust = 0.5)) +\n  labs(title = \"Vaccine Group Proportions\", fill = \"Vaccine Group\") +\n  theme_void()\n\n\n\n\n\n\n\n\nBar Plot ‚Äì Vaccination Count by Vaccine Group\nThis plot compares the absolute count of vaccinations across groups, with horizontal bars for better readability of long labels.\nThe example below shows a horizontal bar chart illustrating the total number of vaccinations administered, grouped into three distinct categories:\n\nRespiratory vaccines clearly represent the largest group, indicating that these vaccines were administered most frequently within the population.\nThe Other category accounts for the smallest number of vaccinations, suggesting a relatively minor proportion of miscellaneous or specialized vaccines.\n\n\nvacc_1524 %&gt;%\n  count(vacc_group3) %&gt;%\n  ggplot(aes(x = reorder(vacc_group3, n), y = n, fill = vacc_group3)) +\n  geom_bar(stat = \"identity\") +\n  coord_flip() +\n  labs(title = \"Vaccination Count by Group\", x = NULL, y = \"Count\") +\n  theme_minimal() +\n  theme(legend.position = \"none\")\n\n\n\n\n\n\n\n\nGrouped Bar Plot ‚Äì Vaccination by Race and Vaccine Group\nThe example below shows a stacked bar chart presenting the distribution of vaccinations by race and vaccine category.\n\nRespiratory vaccines (represented in blue) dominate across all racial groups, consistently making up the largest proportion of administered vaccines, especially noticeable among Black and White groups.\nChildhood vaccines (represented in red) form a significant proportion of vaccinations among the Asian and Native groups, highlighting targeted or population-specific vaccination programs for younger age groups within these communities.\nThe Other vaccines category (represented in green) comprises a relatively minor proportion and appears more prominent among the Asian and White populations.\n\n**Implications:**\n\nThese patterns may suggest varying public health strategies, demographic factors, or differing healthcare access across racial groups. Understanding these variations can guide targeted healthcare interventions and improve vaccine coverage equity.\n\n# Prepare data: count vaccinations by race and vaccine group\n\nvacc_1524$race &lt;- tools::toTitleCase(vacc_1524$race)\n\nvacc_summary &lt;- vacc_1524 %&gt;%\n  count(race, vacc_group3) %&gt;%\n  group_by(race) %&gt;%\n  mutate(prop = n / sum(n)) %&gt;%\n  ungroup()\n\nggplot(vacc_summary, aes(x = race, y = prop, fill = vacc_group3)) +\n  geom_col(position = \"dodge\") +\n  labs(\n    title = \"Vaccination Distribution by Race and Vaccine Group\",\n    x = \"Race\", y = \"Proportion\",\n    fill = \"Vaccine Group\"\n  ) +\n  scale_y_continuous(labels = scales::percent_format()) +\n  theme_minimal() +\n  theme(axis.text.x = element_text(angle = 45, hjust = 1))\n\n\n\n\n\n\n\nrm(vacc_summary)\n\nStacked Bar Chart ‚Äì Race by Vaccine Group\nThe example below shows a stacked bar chart illustrating the number of vaccinations administered, grouped by vaccine type and categorized by racial groups.\n\nThe White population received the highest number of vaccinations across all vaccine categories (Childhood, Other, and Respiratory vaccines).\nOther racial groups (Asian, Black, Native, and Other) also received vaccinations, though in smaller numbers across each vaccine type, indicating ongoing efforts to reach diverse communities.\nRespiratory vaccines had the highest total number of vaccinations administered, suggesting these vaccines were a primary focus within the vaccination program.\n\nThis data helps to illustrate which groups have higher vaccine coverage and highlights the importance of ensuring equitable access and distribution across all communities.\n\nvacc_1524 %&gt;%\n  mutate(race = stringr::str_to_title(race)) %&gt;%\n  count(vacc_group3, race) %&gt;%\n  ggplot(aes(x = vacc_group3, y = n, fill = race)) +\n  geom_bar(stat = \"identity\") +\n  labs(title = \"Stacked Bar Chart: Race by Vaccine Group\", x = \"Vaccine Group\", y = \"Count\") +\n  theme_minimal()\n\n\n\n\n\n\n\n\nBoxplot ‚Äì Age Distribution by Vaccine Group\nVisualizes how age varies across vaccine groups using standard boxplots.\nThe example below shows a box plot depicting age distribution for three vaccine categories (Childhood vaccines, Other vaccines, and Respiratory vaccines):\nKey Observations:\n\nChildhood vaccines primarily cover younger ages, with most recipients under 25 years old. Some individuals beyond this age range appear as outliers, suggesting occasional vaccinations in older groups.\nRespiratory vaccines generally target an older age group, with the median age around 50 years, and a broad range from younger adults to elderly populations.\nThe Other vaccines category has a wider age distribution overall, suggesting these vaccines serve diverse age groups, though with fewer individuals compared to the other two groups.\n\nImplications:\nThis visualization highlights clear age-based targeting for different vaccine categories. Childhood vaccines are expectedly administered primarily to younger populations, while respiratory vaccines predominantly reach older adults. Understanding these age patterns helps to plan targeted public health campaigns and resource allocation effectively.\n\nvacc_1524 %&gt;%\n  ggplot(aes(x = vacc_group3, y = age, fill = vacc_group3)) +\n  geom_boxplot() +\n  labs(title = \"Age Distribution by Vaccine Group\",\n       x = \"Vaccine Group\", y = \"Age (Years)\") +\n  theme_minimal() +\n  theme(legend.position = \"none\")\n\n\n\n\n\n\n\n\nBoxplot with Jittered (Individual Data) Points\nCombines summary and raw data by overlaying individual age points on the boxplot.\nThe example below shows a boxplot with individual data points (jittered), displaying the age distribution of individuals across three vaccine groups: Childhood vaccines, Other vaccines, and Respiratory vaccines.\n\nChildhood vaccines:\nMost individuals who received childhood vaccines are young, with a median age around 10 years.\nThe distribution is tightly concentrated, though some older individuals (outliers) also received these vaccines.\nThe data points clearly cluster in younger age ranges, which is expected for this vaccine group.\n\nRespiratory vaccines:\n\nThis group has the highest median age, around 40‚Äì50 years.\nThe data points are more evenly spread out across a wide age range, with many individuals above 60 years, indicating respiratory vaccines are frequently administered to older populations.\n\n\nOther vaccines:\n\nThis group shows a wide range of ages, from infants to older adults.\nWhile the median age is still relatively low, the spread is broader compared to childhood vaccines, suggesting this category includes various vaccines administered across different age groups.\n\nImplications:\nBy combining summary statistics (boxplot) with individual-level data (dots), this chart offers a clear view of both overall trends and variation in vaccination by age. It confirms that vaccine distribution aligns with age-specific health needs‚Äîyoung children for childhood vaccines, and older adults for respiratory vaccines‚Äîwhile also showing the diversity within each group.\n\n\nvacc_1524 %&gt;%\n  ggplot(aes(x = vacc_group3, y = age, fill = vacc_group3)) +\n  geom_boxplot(outlier.shape = NA, alpha = 0.6) +\n  geom_point(position = position_jitter(width = 0.2),\n             alpha = 0.3, color = \"black\", size = 1.2) +\n  labs(title = \"Boxplot with Individual Data Points\",\n       x = \"Vaccine Group\", y = \"Age\") +\n  theme_minimal() +\n  theme(legend.position = \"none\")\n\n\n\n\n\n\n\n\nBoxplot with Violin Overlay\nAdds a violin plot to visualize the full distribution of ages while preserving boxplot summary stats.\nThe plot below combines a boxplot and violin plot to display the age distribution across different vaccine groups: Childhood vaccines, Other vaccines, and Respiratory vaccines.\n\nChildhood vaccines:\nThe age distribution is heavily concentrated among younger individuals, with most recipients under 25 years. The violin shape is widest near the lower ages, tapering quickly, which indicates that childhood vaccines are rarely given to older individuals.\nRespiratory vaccines:\nThe distribution leans toward older age groups, with the median age higher than in other categories. The violin is widest in the 40‚Äì70 age range, suggesting respiratory vaccines are more commonly administered to older adults.\n\n\n\nOther vaccines:\nThis group shows a broader age range. The shape suggests two areas of concentration: one among younger children and another around age 60‚Äì70, indicating this group includes vaccine types used across diverse age groups.\nOverall, this combined plot provides both statistical summaries (via boxplot) and full distribution shapes (via violin plot), helping to clearly distinguish the age-related usage patterns across vaccine types.\n\n\nvacc_1524 %&gt;%\n  ggplot(aes(x = vacc_group3, y = age, fill = vacc_group3)) +\n  geom_violin(alpha = 0.4, color = NA) +\n  geom_boxplot(width = 0.2, outlier.shape = NA) +\n  labs(title = \"Boxplot with Violin Overlay\", x = NULL, y = \"Age\") +\n  theme_minimal() +\n  theme(legend.position = \"none\")\n\n\n\n\n\n\n\n\nNotched Boxplot ‚Äì Median Comparison\nNotches allow a rough comparison of medians across groups. Non-overlapping notches suggest a significant difference.\nThe plot below presents a notched boxplot showing the age distribution for each vaccine group‚ÄîChildhood vaccines, Other vaccines, and Respiratory vaccines.\n\nThe notches around the medians provide a visual guide for comparing the central values (medians) across groups. If the notches do not overlap, it suggests that the medians are likely different in a statistically meaningful way.\n\nKey insights:\n\nChildhood vaccines show a younger age distribution, with a median age around 10 years and a narrow spread. Outliers indicate a few older individuals also received these vaccines.\nRespiratory vaccines are mainly administered to older age groups, with the highest median age among the three categories.\nOther vaccines span a wider range of ages, but the median remains lower than that of respiratory vaccines.\n\nMedian Comparison:\n\nThe non-overlapping notches between childhood and respiratory vaccines suggest a clear difference in median ages.\nThe other vaccines group overlaps slightly with both, indicating a more mixed age distribution and less pronounced difference.\n\n\nvacc_1524 %&gt;%\n  ggplot(aes(x = vacc_group3, y = age, fill = vacc_group3)) +\n  geom_boxplot(notch = TRUE) +\n  labs(title = \"Notched Boxplot: Vaccine Group vs Age\", x = \"Group\", y = \"Age\") +\n  theme_minimal() +\n  theme(legend.position = \"none\")\n\nNotch went outside hinges\n‚Ñπ Do you want `notch = FALSE`?\n\n\n\n\n\n\n\n\n\nFaceted Boxplot by Gender\nBreaks down the age distribution by vaccine group and gender to compare across subgroups.\nThe plot below shows boxplots of age distribution by vaccine group (Childhood, Respiratory, and Other vaccines), separated into two panels by gender (Female and Male).\nKey Observations:\n\nChildhood vaccines:\n\n-    Age distributions are similar for both females and males, with most recipients being under 25 years.\n\n-    A few older outliers are present, especially among females, but the bulk of vaccine recipients are children and adolescents.\n\nRespiratory vaccines:\n\n-    This group shows a wide age range in both genders, with median ages around 40‚Äì45 years.\n\n-    The distribution is slightly more spread out among males, but the overall trend remains consistent across genders.\n\nOther vaccines:\n\n-    A notable gender difference is visible here:\n\n    -   Among **females**, recipients span a broad age range, including many older adults.\n\n    -    Among **males**, the age distribution is narrower and skewed toward younger adults.\nSummary:\nThis faceted view helps highlight how age patterns differ by both vaccine group and gender. While childhood and respiratory vaccine distributions are generally similar across genders, the ‚ÄúOther‚Äù vaccine group shows more variation, possibly reflecting differences in vaccine eligibility, access, or health needs.\n\nvacc_1524 %&gt;%\n  ggplot(aes(x = vacc_group3, y = age, fill = vacc_group3)) +\n  geom_boxplot() +\n  facet_wrap(~ gender) +\n  labs(title = \"Age by Vaccine Group, Faceted by Gender\", x = NULL, y = \"Age\") +\n  theme_minimal() +\n  theme(legend.position = \"none\")\n\n\n\n\n\n\n\n\nOrdered Boxplot ‚Äì by Median Age\nReorders vaccine groups by median age to emphasize differences in distribution centrality.\nThe plot below shows age distributions by vaccine group, with the groups reordered by median age to highlight differences in central tendency.\nKey Observations:\n\nChildhood vaccines have the lowest median age, with most recipients being under 20 years. A small number of older individuals appear as outliers.\nOther vaccines show a moderate median age, but with a wide spread across age groups‚Äîranging from infants to older adults. This suggests these vaccines are used in more varied contexts.\nRespiratory vaccines have the highest median age, with recipients typically ranging from their 30s to older adulthood, reflecting their common use among older populations.\n\nConclusion:\nBy ordering the boxplots by median age, this visual emphasizes the different age profiles targeted by each vaccine group. This approach helps communicate age-related trends in vaccine administration more clearly .\n\nvacc_1524 %&gt;%\n  mutate(vacc_group3 = fct_reorder(vacc_group3, age, median, na.rm = TRUE)) %&gt;%\n  ggplot(aes(x = vacc_group3, y = age, fill = vacc_group3)) +\n  geom_boxplot() +\n  labs(title = \"Boxplot Ordered by Median Age\", x = NULL, y = \"Age\") +\n  theme_minimal() +\n  theme(legend.position = \"none\")\n\n\n\n\n\n\n\n\nArea Plot ‚Äì Monthly Vaccination Trends Over Years\nUses an area chart to show monthly vaccination volumes over multiple years, stacked by year.\nThe area chart below displays monthly vaccination counts over multiple years (2015‚Äì2024), helping visualize seasonal and annual trends in vaccine uptake.\nKey Observations:\n\n2020 stands out with the highest overall vaccination counts, especially between April and June, likely reflecting a surge due to public health responses such as the COVID-19 pandemic.\nIn other years, vaccination numbers are more evenly distributed, with moderate peaks around March‚ÄìApril or August‚ÄìSeptember, possibly aligning with seasonal vaccination programs (e.g., flu campaigns).\n2023 and 2024 show a relatively steady pattern throughout the year, with less fluctuation month-to-month.\nEarlier years (2015‚Äì2017) have lower and more variable volumes compared to recent years.\n\nConclusion:\nThis chart highlights both seasonal vaccination patterns and the impact of specific public health events, such as the elevated activity in 2020. Monitoring these trends over time supports planning for future vaccination campaigns and resource allocation.\n\nvacc_1524 %&gt;%\n  count(vacc_year, vacc_month_name) %&gt;%\n  ggplot(aes(x = vacc_month_name, y = n, group = vacc_year, fill = factor(vacc_year))) +\n  geom_area(alpha = 0.7, position = \"identity\") +\n  labs(title = \"Monthly Vaccination Trends by Year\",\n       x = \"Month\", y = \"Number of Vaccinations\", fill = \"Year\") +\n  theme_minimal()\n\n\n\n\n\n\n\n\nFaceted Plot ‚Äì Proportional Vaccination Trends by Group and Race\nDisplays how the proportion of vaccinations among different races changed across years, separately for each vaccine group.\nThe faceted line plot below shows how the proportion of vaccinations among different racial groups has changed over time (2015‚Äì2024), presented separately for each vaccine group: Childhood, Respiratory, and Other.\nKey Observations:\n\nChildhood vaccines:\n\n-   Proportions vary notably year to year, especially for **Asian**, **Black**, and **Native** groups.\n\n-   The **\"Other\"** and **White** groups show a more consistent presence but with modest fluctuations.\n\n-    Some groups (e.g., Native) show a steady rise in recent years.\n\n**Respiratory vaccines**:\n\n-    Several racial groups (notably **Native**, **Black**, and **Other**) show periods of very high proportions, including years where proportions reached **100%**, likely due to small subgroup sample sizes or data dominance.\n\n-    The **White** and **Asian** groups tend to remain stable, though proportions fluctuate in certain years (e.g., 2020‚Äì2022).\n\nOther vaccines:\n\n-   Representation is generally lower and more variable across all racial groups.\n\n-    The **White** group maintains a small but steady share throughout most years.\n\n**Interpretation:**\nThis faceted view enables comparisons within and between vaccine types, highlighting potential shifts in vaccine access, uptake, or data coverage by racial group over time. It also suggests where disparities or changes in focus may have occurred, helping to inform more equitable vaccination strategies.\n\n# Prepare data: floor year, count by group, compute proportions within each group\n\n# Clean and count total per race/year (for denominator)\ntotal_by_race_year &lt;- vacc_1524 %&gt;%\n  mutate(\n    age = as.integer(round(age)),\n    vacc_year = as.integer(floor(vacc_year)),\n    race = str_to_title(as.character(race))\n  ) %&gt;%\n  count(vacc_year, race, name = \"total_race_year\")\n\n#  Count per vaccine group (for numerator), then join\nvacc_plot_data &lt;- vacc_1524 %&gt;%\n  mutate(\n    age = as.integer(round(age)),\n    vacc_year = as.integer(floor(vacc_year)),\n    race = str_to_title(as.character(race))\n  ) %&gt;%\n  count(vacc_year, race, vacc_group3, name = \"n\") %&gt;%\n  left_join(total_by_race_year, by = c(\"vacc_year\", \"race\")) %&gt;%\n  mutate(prop = n / total_race_year)\n\n# Plot proportion by race within group\nggplot(vacc_plot_data, aes(x = vacc_year, y = prop, color = race)) +\n  geom_line(size = 1) +\n  facet_wrap(~ vacc_group3) +\n  scale_y_continuous(labels = percent_format()) +\n  scale_x_continuous(breaks = pretty(unique(vacc_plot_data$vacc_year))) +\n  labs(\n    title = \"Proportion of Race Within Vaccine Groups by Year\",\n    x = \"Year\", y = \"Proportion\", color = \"Race\"\n  ) +\n  theme_minimal() +\n  theme(axis.text.x = element_text(angle = 45, hjust = 1))\n\n\n\n\n\n\n\nrm(vacc_plot_data, total_by_race_year)\n\nStatistical Overlay ‚Äì Regression Line on Vaccination Age\nAdds a linear regression to examine the relationship between income and age at vaccination.\nThe scatterplot below visualizes the relationship between income (horizontal axis) and age at vaccination (vertical axis), with a linear regression line and confidence band overlaid to summarize the trend.\nKey Observations:\n\nThe fitted regression line shows a slight negative slope, suggesting that as income increases, the age at which individuals receive vaccination tends to decrease modestly.\nThe confidence band (shaded region) around the line is relatively narrow, indicating a fair level of certainty in the trend across the central range of income.\nThe majority of data points are concentrated in the lower income ranges, while higher income values are more sparsely populated and show greater variability.\n\n**Interpretation:**\nThis trend suggests a possible inverse relationship between income and vaccination age‚Äîindividuals with higher income may be more likely to receive vaccines at younger ages. This could reflect differences in healthcare access, awareness, or proactive health behaviors associated with income level.\n\nvacc_1524 %&gt;%\n  ggplot(aes(x = income, y = age)) +\n  geom_point(alpha = 0.3, color = \"gray50\") +\n  geom_smooth(method = \"lm\", se = TRUE, color = \"blue\") +\n  labs(\n    title = \"Association Between Income and Age at Vaccination\",\n    x = \"Income\", y = \"Age\"\n  ) +\n  theme_minimal()\n\n`geom_smooth()` using formula = 'y ~ x'\n\n\n\n\n\n\n\n\n\nRegression Plot ‚Äì Age vs Income by Vaccine Group (Log Scale)\nAdds linear regression and facets by vaccine group. The x-axis is log-scaled to handle skewed income data.\nThe plot below shows scatterplots with linear regression lines, examining the relationship between income and age at vaccination. The plots are faceted by vaccine group: Childhood, Other, and Respiratory. The x-axis uses a logarithmic scale to better handle the skewed distribution of income.\nKey Observations:\n\nChildhood vaccines:\n\n-    A **slight negative trend** is observed, indicating that as income increases, age at vaccination tends to decrease slightly.\n\n-    This may reflect earlier or more timely vaccinations among higher-income individuals for childhood vaccines.\n\nOther vaccines:\n\n-   The regression line is nearly flat with a wide confidence interval, suggesting **no strong or consistent relationship** between income and age at vaccination in this group.\n\n-    This likely reflects diverse vaccine purposes and use across a broad age and income range.\n\nRespiratory vaccines:\n\n-   A **mild negative trend** is also seen here, where higher-income individuals may receive respiratory vaccines at slightly younger ages.\n\n-    However, the relationship is subtle and the confidence interval overlaps considerably with the regression line.\n\n**Interpretation:**\nWhile the strength of association varies across groups, both the childhood and respiratory vaccine panels suggest a small trend where higher income is associated with younger age at vaccination. This may be related to differences in access, preventive health behaviors, or healthcare utilization by income level.\n\nvacc_1524 %&gt;%\n  mutate(vacc_group3 = str_to_title(vacc_group3)) %&gt;%\n  ggplot(aes(x = income, y = age)) +\n  geom_point(alpha = 0.3, color = \"gray50\") +\n  geom_smooth(method = \"lm\", se = TRUE, color = \"blue\") +\n  scale_x_log10(labels = scales::comma_format()) +\n  facet_wrap(~ vacc_group3) +\n  labs(\n    title = \"Association Between Income and Age at Vaccination\",\n    x = \"Income (log scale)\", y = \"Age\"\n  ) +\n  theme_minimal()\n\n`geom_smooth()` using formula = 'y ~ x'\n\n\n\n\n\n\n\n\n\nECDF ‚Äì Age at Vaccination\nThe empirical cumulative distribution function (ECDF) shows the proportion of individuals vaccinated at or below each age. This helps visualize the age distribution in a cumulative way.\nThe plot below presents shows the cumulative proportion of individuals who received a vaccination at or below each age.\nKey Observations:\n\nThe curve rises steeply in the early age range, indicating that a large proportion of individuals were vaccinated at younger ages (e.g., before 30).\nBy around age 50, approximately 80% of individuals had been vaccinated.\nThe curve flattens out after age 75, suggesting fewer vaccinations occur at older ages.\n\nInterpretation:\nThe ECDF provides an intuitive way to understand the distribution of vaccination ages. It highlights that most vaccinations occur in childhood and early adulthood, with fewer individuals vaccinated later in life. This cumulative view complements histograms and boxplots by showing the proportion of individuals affected up to each age.\n\nvacc_1524 &lt;- vacc_1524 %&gt;% filter(income &gt; 0, !is.na(age))\n\nvacc_1524 %&gt;%\n  ggplot(aes(x = age)) +\n  stat_ecdf(geom = \"step\", color = \"steelblue\") +\n  labs(title = \"ECDF of Age at Vaccination\", x = \"Age\", y = \"Cumulative Proportion\") +\n  theme_minimal()\n\n\n\n\n\n\n\n\nTreemap ‚Äì Vaccination by Race and Vaccine Group\nThis treemap visualizes the distribution of vaccinations by race and vaccine group. Larger areas indicate more individuals within each combination.\nThe treemap below displays the distribution of vaccinations across racial groups, further categorized by vaccine group (Childhood, Respiratory, and Other). Each rectangle represents a combination of race and vaccine type, with area size corresponding to the number of individuals vaccinated.\nKey Observations:\n\nThe White population accounts for the largest share overall, with:\n\n-    **788 individuals (50.7%)** in the **Respiratory** vaccine group.\n\n-    **404 individuals (26.0%)** in the **Childhood** vaccine group.\n\n-    **114 individuals (7.3%)** in the **Other** vaccine group.\n\nOther racial groups have smaller shares:\n\n-    **Black** individuals make up a modest proportion across groups, particularly **4.5%** in the Respiratory group and **1.4%** in Childhood vaccines.\n\n-    **Asian** individuals represent **4.4%** of Respiratory vaccines and **2.1%** of Childhood vaccines.\n\n-    **Native** and **Other** groups have minimal representation overall.\n\n**Interpretation:**\nThis treemap visually emphasizes the dominant contribution of the White population across all vaccine types, especially for respiratory vaccines. It also illustrates disparities in representation among racial groups, which can be important for assessing equity in vaccine access, uptake, and program targeting.\n\n# Cross-platform ‚Äúnew device‚Äù:\ndev.new(width = 8, height = 6)  \n\np &lt;- vacc_1524 %&gt;%\n  count(race, vacc_group3) %&gt;%\n  mutate(race = str_to_title(race)) %&gt;%\n  ggplot(aes(area = n, fill = vacc_group3, label = race)) +\n  geom_treemap() +\n  geom_treemap_text(colour = \"white\", place = \"centre\", grow = TRUE) +\n  labs(\n    title = \"Treemap: Vaccination by Race and Vaccine Group\",\n    fill  = \"Vaccine Group\"\n  ) +\n  theme_minimal()\n\nprint(p)\n\nrm (p)\n\n\n#  Treemap - with Labels Showing Counts and Proportions by Race and vaccine Group\nvacc_1524 %&gt;%\n  count(race, vacc_group3) %&gt;%\n  mutate(\n    race = str_to_title(race),\n    total = sum(n),\n    proportion = n / total,\n    label_text = paste0(race, \"\\n\", n, \" (\", percent(proportion, accuracy = 0.1), \")\")\n  ) %&gt;%\n  ggplot(aes(area = n, fill = vacc_group3, label = label_text)) +\n  geom_treemap() +\n  geom_treemap_text(colour = \"white\", place = \"centre\", grow = TRUE, reflow = TRUE) +\n  labs(\n    title = \"Treemap: Vaccination by Race and Vaccine Group\",\n    fill = \"Vaccine Group\"\n  ) +\n  theme_minimal()\n\n\n\n\n\n\n\n\nCorrelation Heatmap ‚Äì Numeric Variables\nThis heatmap displays Pearson correlation coefficients between selected numeric variables. Strong positive or negative values help identify relationships worth further analysis.\nThe heatmap below displays Pearson correlation coefficients between selected numeric variables: age, income, healthcare expenses, and healthcare coverage. Correlation values range from -1 to 1, where values closer to ¬±1 indicate stronger relationships.\nKey Observations:\n\nAge and healthcare coverage show a strong positive correlation (0.65), suggesting that as individuals age, they are more likely to have greater healthcare coverage.\nAge and healthcare expenses are also positively correlated (0.66), indicating that older individuals tend to incur higher healthcare costs.\nHealthcare coverage and healthcare expenses show a moderate positive correlation (0.44), which may reflect that those with more coverage also utilize healthcare services more frequently or thoroughly.\nIncome is not strongly correlated with any other variable in this set, with the highest being a negligible 0.02 with healthcare coverage and a slightly negative value with age (-0.04) and expenses (-0.05).\n\n**Interpretation:**\nThis heatmap highlights potential relationships that may inform further analysis‚Äîespecially the connections between age, coverage, and expenses. In contrast, income appears relatively independent of the other variables in this dataset.\n\nnumeric_vars &lt;- vacc_1524 %&gt;%\n  select(age, income, healthcare_expenses, healthcare_coverage) %&gt;%\n  na.omit()\n\ncor_matrix &lt;- round(cor(numeric_vars), 2)\n\nas.data.frame(as.table(cor_matrix)) %&gt;%\n  rename(Var1 = Var1, Var2 = Var2, Correlation = Freq) %&gt;%\n  ggplot(aes(x = Var1, y = Var2, fill = Correlation)) +\n  geom_tile(color = \"white\") +\n  geom_text(aes(label = Correlation), color = \"black\") +\n  scale_fill_gradient2(low = \"red\", high = \"blue\", mid = \"white\", midpoint = 0) +\n  labs(title = \"Correlation Heatmap of Numeric Variables\", x = NULL, y = NULL) +\n  theme_minimal()\n\n\n\n\n\n\n\n\nRidgeline Plot ‚Äì Age by Vaccine Group\nThis ridgeline plot shows the age distribution for each vaccine group. It highlights where age densities differ across categories.\nThe ridgeline plot below shows age distributions for three vaccine groups: Childhood, Other, and Respiratory. Each layer represents the density of ages within a vaccine category, allowing for visual comparison of where individuals are most commonly vaccinated within each group.\nKey Observations:\n\nChildhood vaccines show a clear peak at very young ages, as expected. The density drops rapidly as age increases, with a small secondary bump around middle age, possibly reflecting catch-up vaccinations or data irregularities.\nOther vaccines have a bimodal distribution with one peak in younger adults and another in older adults (around 70+ years), suggesting they are used across multiple life stages.\nRespiratory vaccines have a broad distribution, with a peak density around 60‚Äì70 years, consistent with routine respiratory vaccinations for older adults (e.g., influenza or pneumococcal vaccines).\n\n**Interpretation:**\nThis visualization effectively highlights differences in age targeting across vaccine groups. It shows that:\n\nChildhood vaccines are concentrated in early life,\nOther vaccines are used more broadly across age ranges, and\nRespiratory vaccines are predominantly administered to older populations.\n\n\nvacc_1524 %&gt;%\n  mutate(vacc_group3 = stringr::str_to_title(vacc_group3)) %&gt;%\n  ggplot(aes(x = age, y = vacc_group3, fill = vacc_group3)) +\n  geom_density_ridges(scale = 1.5, alpha = 0.6, color = \"white\") +\n  labs(title = \"Ridgeline Plot: Age Distribution by Vaccine Group\", x = \"Age\", y = \"Vaccine Group\") +\n  theme_minimal() +\n  theme(legend.position = \"none\")\n\nPicking joint bandwidth of 5.93\n\n\n\n\n\n\n\n\n\nInteractive Plot ‚Äì Income vs Age by Race\nThis interactive scatter plot shows the relationship between income and age, colored by race. Hovering reveals more details including group and income.\n\np &lt;- vacc_1524 %&gt;%\n  mutate(race = stringr::str_to_title(race)) %&gt;%\n  ggplot(aes(x = income, y = age, color = race,\n             text = paste(\"Race:\", race,\n                          \"&lt;br&gt;Group:\", vacc_group3,\n                          \"&lt;br&gt;Income:\", income,\n                          \"&lt;br&gt;Age:\", age))) +\n  geom_point(alpha = 0.6) +\n  geom_smooth(method = \"loess\", se = FALSE, color = \"gray30\") +\n  labs(title = \"Interactive: Income vs Age by Race\",\n       x = \"Income\", y = \"Age\", color = \"Race\") +\n  theme_minimal() +\n  theme(legend.position = \"bottom\")\n\nggplotly(p, tooltip = \"text\")\n\n`geom_smooth()` using formula = 'y ~ x'\n\n\n\n\n\nrm(p)\n\nAnimation ‚Äì Vaccination Trends Over Years\nThis animation shows how vaccination counts across vaccine groups change over time. It helps spot temporal trends and emerging patterns.\n\nanim_plot &lt;- vacc_1524 %&gt;%\n  mutate(vacc_year = as.integer(floor(vacc_year))) %&gt;%\n  count(vacc_year, vacc_group3) %&gt;%\n  ggplot(aes(x = vacc_group3, y = n, fill = vacc_group3)) +\n  geom_col(show.legend = FALSE) +\n  labs(title = 'Year: {frame_time}', x = 'Vaccine Group', y = 'Count') +\n  theme_minimal() +\n  transition_time(vacc_year) +\n  ease_aes('linear')\n\nanim_file &lt;- tempfile(fileext = \".gif\")\nanim &lt;- animate(anim_plot, nframes = 100, fps = 10, renderer = gifski_renderer(anim_file))\nprint(anim)\n\nrm(anim_plot, anim_file, anim)\n\nAnimation ‚Äì Breast Cancer Screening Uptake by State\nThis animated bar chart shows breast cancer screening uptake over time for each Australian state. It uses faceting to compare regional trends.\n\nbreast_anim &lt;- breast_cancer_data %&gt;%\n  filter(!state %in% c(\"Other\", \"Unknown\")) %&gt;%\n  mutate(year_4digit = as.integer(year_4digit)) %&gt;%\n  group_by(state, year_4digit) %&gt;%\n  summarise(total_screened = sum(part50_74, na.rm = TRUE), .groups = \"drop\") %&gt;%\n  ggplot(aes(x = year_4digit, y = total_screened, fill = state)) +\n  geom_col(show.legend = FALSE) +\n  facet_wrap(~ state) +\n  labs(title = 'Year: {frame_time}', x = 'Year', y = 'Women Screened (50‚Äì74 yrs)') +\n  theme_minimal() +\n  transition_time(year_4digit) +\n  ease_aes('linear')\n\nscreening_gif &lt;- tempfile(fileext = \".gif\")\nanim_screen &lt;- animate(breast_anim, nframes = 100, fps = 10, renderer = gifski_renderer(screening_gif))\nprint(anim_screen)\n\nrm(breast_anim, screening_gif, anim_screen)\n\n\n\n1.7.7 üîπ Formatting, themes and fonts of figures\nHeatmap ‚Äì Number of Vaccinations by Month and Weekday Highlights vaccination activity patterns by day of week and month. Darker tiles represent higher counts.\nThe heatmap below demonstrates the number of vaccinations administered across each day of the week and each calendar month. Color intensity indicates the relative number of vaccinations, with darker red representing higher uptake and pale yellow representing lower activity.\nKey Observations:\n\nSaturday consistently shows high uptake, particularly in October, September, and July, suggesting that weekends may be more accessible or preferred for vaccination appointments.\nTuesday in May and Wednesday in August also show pronounced peaks, likely linked to specific campaign efforts or seasonal programs.\nThursday and Friday generally have moderate activity, while Sunday and Monday tend to have lower vaccination counts across most months.\nOverall, the summer and early fall months (July to October) show increased uptake across several weekdays, possibly aligning with back-to-school vaccination drives or respiratory vaccine rollouts.\n\n**Interpretation:**\nThe plot reveals both seasonal and weekly rhythms in vaccination behavior. Recognizing these patterns can guide better scheduling of clinics, resource planning, and public messaging to align with high-demand periods and improve overall vaccine accessibility.\n\n# ................Without  Adding the long Title ........................................................\n# ..............................................................................................\n\n# --- Order weekday and month factors for proper axis display ---\n# --- Convert original vaccination date to Eastern Time (Massachusetts local time) ---\n# Assumes vacc_date is POSIXct or character in UTC or local system time\nvacc_1524 &lt;- vacc_1524 %&gt;%\n  mutate(\n    vacc_datetime_et = with_tz(as.POSIXct(vacc_date, tz = \"UTC\"), tzone = \"America/New_York\"),  # Adjust timezone to Eastern Time\n    vacc_weekday = wday(vacc_datetime_et, label = TRUE, abbr = FALSE),                          # Extract weekday (e.g., Monday)\n    vacc_month_name = month(vacc_datetime_et, label = TRUE, abbr = FALSE)                       # Extract month (e.g., January)\n  )\n\n# --- Order weekday and month factors for proper axis display ---\nvacc_1524 &lt;- vacc_1524 %&gt;%\n  mutate(\n    vacc_month_name = factor(vacc_month_name, levels = month.name),  # Ensure months are in calendar order\n    vacc_weekday = factor(vacc_weekday, levels = c(\"Monday\", \"Tuesday\", \"Wednesday\", \"Thursday\", \"Friday\", \"Saturday\", \"Sunday\"))  # Ensure weekdays are in logical order\n  )\n\n# --- Create heatmap of vaccination counts by weekday and month ---\nvacc_1524 %&gt;%\n  count(vacc_weekday, vacc_month_name) %&gt;%  # Count number of vaccinations by weekday and month\n  ggplot(aes(x = vacc_weekday, y = vacc_month_name, fill = n)) +     # Map weekday to x-axis, month to y-axis, and fill by count\n  geom_tile(color = \"white\") +                                       # Draw heatmap tiles with white border for readability\n  scale_fill_gradientn(                                              # Use custom yellow-to-red color scale\n    colors = c(\"#ffffcc\", \"#ffeda0\", \"#feb24c\", \"#f03b20\", \"#bd0026\"),\n    breaks = scales::pretty_breaks(n = 5),                           # Auto-select 5 good breakpoints for legend\n    name = \"Vaccinated Number\"                                       # Legend title\n  ) +\n  labs(\n    title = \"Vaccination Uptake by Weekday and Month\",               # Plot title\n    subtitle = \"Timestamps interpreted as US Eastern Time (Massachusetts)\",  # Timezone context\n    x = \"Weekday\", y = \"Month\", fill = \"Vaccinated Number\",          # Axis and legend labels\n    caption = \"Note: Original timestamps converted from UTC to America/New_York\"\n  ) +\n  theme_minimal() +\n  theme(\n    text = element_text(family = \"Times New Roman\"),                 # Font style\n    legend.position = \"bottom\",                                      # Move legend below the plot\n    axis.text.x = element_text(angle = 45, hjust = 1, size = 10, face = \"bold\"),  # X-axis label formatting\n    axis.text.y = element_text(size = 10, face = \"bold\"),            # Y-axis label formatting\n    axis.title.x = element_text(face = \"bold\", size = 11),\n    axis.title.y = element_text(face = \"bold\", size = 11),\n    plot.title = element_text(size = 12, face = \"bold\"),\n    legend.title = element_text(size = 10),\n    legend.text = element_text(size = 8)\n  )\n\n\n\n\n\n\n\n# Use figure title below to render in Quarto or Rmarkdown \n#\"Figure XX: Vaccination uptake by weekday and month among individuals aged 15‚Äì24, 2016‚Äì2024.\"\n\n\n# ................Adding the long Title ........................................................\n# ..............................................................................................\n\n# --- Convert original vaccination date to Eastern Time (Massachusetts local time) ---\n# Assumes vacc_date is POSIXct or character in UTC or local system time\nvacc_1524 &lt;- vacc_1524 %&gt;%\n  mutate(\n    vacc_datetime_et = with_tz(as.POSIXct(vacc_date, tz = \"UTC\"), tzone = \"America/New_York\"),  # Adjust timezone to Eastern Time\n    vacc_weekday = wday(vacc_datetime_et, label = TRUE, abbr = FALSE),                          # Extract weekday (e.g., Monday)\n    vacc_month_name = month(vacc_datetime_et, label = TRUE, abbr = FALSE)                       # Extract month (e.g., January)\n  )\n\n# --- Order weekday and month factors for proper axis display ---\nvacc_1524 &lt;- vacc_1524 %&gt;%\n  mutate(\n    vacc_month_name = factor(vacc_month_name, levels = month.name),  # Ensure months are in calendar order\n    vacc_weekday = factor(vacc_weekday, levels = c(\"Monday\", \"Tuesday\", \"Wednesday\", \"Thursday\", \"Friday\", \"Saturday\", \"Sunday\"))  # Ensure weekdays are in logical order\n  )\n\n# --- Create heatmap of vaccination counts by weekday and month ---\np &lt;- vacc_1524 %&gt;%\n  count(vacc_weekday, vacc_month_name) %&gt;%  # Count number of vaccinations by weekday and month\n  ggplot(aes(x = vacc_weekday, y = vacc_month_name, fill = n)) +     # Map weekday to x-axis, month to y-axis, and fill by count\n  geom_tile(color = \"white\") +                                       # Draw heatmap tiles with white border for readability\n  scale_fill_gradientn(                                              # Use custom yellow-to-red color scale\n    colors = c(\"#ffffcc\", \"#ffeda0\", \"#feb24c\", \"#f03b20\", \"#bd0026\"),\n    breaks = scales::pretty_breaks(n = 5),                           # Auto-select 5 good breakpoints for legend\n    name = \"Vaccinated Number\"                                       # Legend title\n  ) +\n  labs(\n    title = \"Vaccination Uptake by Weekday and Month\",               # Plot title\n    x = \"Weekday\", y = \"Month\", fill = \"Vaccinated Number\"           # Axis and legend labels\n  ) +\n  theme_minimal() +\n  theme(\n    text = element_text(family = \"Times New Roman\"),                 # Font style\n    legend.position = \"bottom\",                                      # Move legend below the plot\n    axis.text.x = element_text(angle = 45, hjust = 1, size = 10, face = \"bold\"),  # X-axis label formatting\n    axis.text.y = element_text(size = 10, face = \"bold\"),            # Y-axis label formatting\n    axis.title.x = element_text(face = \"bold\", size = 11),\n    axis.title.y = element_text(face = \"bold\", size = 11),\n    plot.title = element_text(size = 12, face = \"bold\"),\n    legend.title = element_text(size = 10),\n    legend.text = element_text(size = 8)\n  )\n\n# --- Add descriptive figure caption using patchwork's plot_annotation() ---\nfinal_plot &lt;- p + plot_annotation(\n  caption = \"Figure XX: Vaccination uptake by weekday and month among individuals aged 15‚Äì24, 2016‚Äì2024.\",\n  theme = theme(\n    plot.caption = element_text(\n      size = 10, family = \"Times New Roman\", hjust = 0\n    )\n  )\n)\n\n# --- Display the final plot with caption ---\nfinal_plot\n\n\n\n\n\n\n\n# setwd (\"C:/Users/User/Desktop/Materials_ Course and proposals/VIP collection for Syntax code or project titles/R codes/Data Manipulation and Wrangling\")\n# \n# # Save plots\n# ggsave(\"Heatmap_vaccination_pattern by day and month.TIFF\", plot = last_plot(), device = \"tiff\", width = 10, height = 6, units = \"in\")\n# ggsave(\"Heatmap_vaccination_pattern by day and month.svg\", plot = last_plot(), device = \"svg\", width = 10, height = 6, units = \"in\")\n\nrm (p, final_plot)"
  },
  {
    "objectID": "Post_Blog/Data Manipulation and Wrangling.html#part-viii-shiny-app-building-web-apps",
    "href": "Post_Blog/Data Manipulation and Wrangling.html#part-viii-shiny-app-building-web-apps",
    "title": "Date Manipulation and Wrangling using R",
    "section": "1.8 PART VIII: SHINY App: BUILDING WEB APPS",
    "text": "1.8 PART VIII: SHINY App: BUILDING WEB APPS\n8.1 UI fluidPage(), sidebarLayout(), sidebarPanel(), mainPanel(), tabsetPanel(), tags$style()\n8.2 Server reactive(), observeEvent(), req(), renderPlotly(), renderDT(), modalDialog(), showModal()\n8.3 App Launch shinyApp(ui, server)\n8.4 Inputs sliderInput(), selectInput(), colourInput(), actionButton(), downloadButton()\n8.5 Outputs plotlyOutput(), DTOutput(), datatable(), formatStyle()\n8.6 DT Features extensions = 'Buttons', export options: copy, csv, excel, pdf, print\n8.7 Styling and Themes tags$style(), (shinythemes::shinytheme() ‚Äì loaded but not applied)\nShiny is a web application framework for R that allows analysts to build interactive dashboards and tools using familiar syntax. It provides a structured approach to turning R scripts into accessible apps for broader audiences.\nA typical Shiny app includes two core components:\n\nUI (User Interface): Defines layout, inputs, and outputs shown on the screen interface.\nServer: Contains the logic that processes data and responds to user interactions.\n\nShiny apps can include multiple views (tabs), export buttons, dynamic filtering, charts, and customized design themes.\n\n\n1.8.1 üîπ UI Layout and Page Structure\n\nfluidPage(): Defines the page layout.\nsidebarLayout(), sidebarPanel(), mainPanel(): Organize inputs and outputs side-by-side.\ntabsetPanel(): Allows tab navigation for multi-page apps.\ntags$style(), shinythemes::shinytheme(): Add or apply custom styles/themes.\n\n\n\n\n1.8.2 üîπ Server Logic and Reactivity\n\nreactive(): Creates reactive data or expressions.\nobserveEvent(): Executes code when a trigger changes.\nreq(): Validates necessary input before proceeding.\nOutput functions: renderPlotly(), renderDT(), renderText(), renderTable().\n\n\n\n\n1.8.3 üîπ Inputs and Outputs\n\n\n\n\n\n\n\n\nType\nFunction\nPurpose\n\n\n\n\nInput\nsliderInput()\nSelect a numeric value or range\n\n\nInput\nselectInput()\nDropdown menu to choose a category\n\n\nInput\ncolourInput()\nSelect a color\n\n\nInput\nactionButton()\nTrigger processing on click\n\n\nInput\ndownloadButton()\nDownload output tables or data\n\n\nOutput\nplotlyOutput()\nRender interactive plots using Plotly\n\n\nOutput\nDTOutput(), datatable()\nRender interactive tables\n\n\nOutput\nformatStyle()\nApply styling (e.g., color, font) to tables\n\n\n\n\n\n\n1.8.4 üîπ Table Export Options (DT Extension)\n\nAdd extensions = 'Buttons' to enable table exports.\nExport types: \"copy\", \"csv\", \"excel\", \"pdf\", \"print\".\n\n\n\n\n1.8.5 üîπ Launching the App\n\nshinyApp(ui, server): Runs the Shiny app combining both UI and server logic.\nApps can be hosted on ShinyApps.io, internal servers, or embedded in R Markdown dashboards.\n\n\nThe Shiny app code below demonstrates how interactive visualizations can be built using R to present health data in an accessible and user-friendly format. Specifically, it explores breast cancer screening uptake across states, years, and age groups in Australia. The app enhances user engagement through customizable features and immediate feedback mechanisms.\nKey capabilities demonstrated include: - Dynamic UI generation using fluidPage(), sidebarLayout(), and interactive widgets - State selection using a dropdown (selectInput()), which scales better than radio buttons - Age group filtering with a multiple selection input - Quantile-based filtering with sliderInput() for rate grouping - Color customization of output using colourInput() for personalizing table aesthetics - A modal popup (modalDialog()) triggered by a help button to explain data sources - Export options via downloadButton() and DT export buttons for multiple file formats - Real-time data filtering using reactive() expressions to tailor output to user input - An interactive line plot rendered via plotly and ggplot2 for visualization - Fully styled, downloadable data table with DT::renderDT() and export capabilities\nSee the live app at the following platforms\n\nAnalyticsHub YouTube: https://studio.youtube.com/video/5V7SPBH-8BE/edit\nLive App: https://j9eu4e-habtamu-mellie0bizuayehu.shinyapps.io/Breast_Cancer_Screening_Shiny_App/\n\n\n# Install required packages if not already installed\nrequired_packages &lt;- c(\"shiny\", \"ggplot2\", \"plotly\", \"DT\", \"dplyr\", \"shinyjs\", \"shinyWidgets\", \"scales\", \"colourpicker\")\n\n# Install missing ones\nnew_packages &lt;- required_packages[!(required_packages %in% installed.packages()[,\"Package\"])]\nif(length(new_packages)) install.packages(new_packages)\n\n# Load packages\nlibrary(shiny)\nlibrary(ggplot2)\nlibrary(plotly)\nlibrary(DT)\nlibrary(dplyr)\nlibrary(shinyjs)\nlibrary(shinyWidgets)\nlibrary(scales)\nlibrary(colourpicker)\n\n\n# load the data\nload(\"C:/Users/User/Desktop/Materials_ Course and proposals/VIP collection for Syntax code or project titles/R codes/Shiny App BC Screening/Breast Cancer Screening.RData\")\n\n\n# -------------------Shiny Application for Breast Cancer Screening---------------------\n\n\n# ------------------- UI and Server Definition ---------------------\n\n# Define custom CSS for styling buttons and other UI elements\nui &lt;- fluidPage(\n  \n  # Application title displayed at the top of the app\n  h1(\"Breast Cancer Screening Uptake\"),\n\n  # Apply custom styling to the download button\n  tags$style(HTML(\"\n    #download_data {\n      background: orange;\n      font-size: 20px;\n    }\n  \")),  \n\n  # Layout structure: sidebar for inputs and main panel for outputs\n  sidebarLayout(\n    sidebarPanel(\n      \n      # Quantile-based slider to filter screening rate\n      sliderInput(\"rate_10_group\", \"Rate Group\", \n                  min = min(breast_cancer_long$rate_10_group, na.rm = TRUE), \n                  max = max(breast_cancer_long$rate_10_group, na.rm = TRUE), \n                  value = c(5, 7)),\n      \n      # Dropdown menu for state selection (simplifies and scales better than radio buttons)\n      selectInput(\"state\", \"Select State\",  \n                  choices = unique(breast_cancer_long$state), \n                  selected = \"WA\"),\n\n      # Multi-select dropdown for age groups (allows viewing multiple demographics)\n      selectInput(\"age_group\", \"Women's Age Group\", \n                  choices = unique(breast_cancer_long$age_group), \n                  multiple = TRUE,\n                  selected = unique(breast_cancer_long$age_group)[1]),\n\n      # Add colour input to allow users to control table font colour\n      colourInput(\"color\", \"Point color\", value = \"blue\"),\n\n      # Add a help button that triggers a modal popup for guidance\n      actionButton(\"show_help\", \"Help\"),\n\n      # Add a download button for exporting filtered dataset\n      downloadButton(\"download_data\", \"Download Data\")\n    ),\n\n    mainPanel(\n      # Render the interactive line chart\n      plotlyOutput(\"plot\"),\n\n      # Render the data table output\n      DTOutput(\"table\")\n    )\n  )\n)\n\n# Define server-side logic for rendering outputs and interactivity\nserver &lt;- function(input, output, session) {\n\n  # Show Help Modal: explains data source when help button is clicked\n  observeEvent(input$show_help, {\n    showModal(modalDialog(\n      title = \"Help\",\n      \"This data was compiled from the Australian Institute of Health and Welfare.\"\n    ))\n  })\n\n  # Reactive expression to filter and summarize the dataset based on inputs\n  filtered_data &lt;- reactive({\n    req(input$rate_10_group, input$state, input$age_group)  # Ensure all inputs are available\n\n    breast_cancer_long %&gt;%\n      filter(rate_10_group &gt;= input$rate_10_group[1] & \n               rate_10_group &lt;= input$rate_10_group[2],\n             state == input$state,\n             age_group %in% input$age_group) %&gt;%\n      group_by(year, state, age_group) %&gt;%\n      summarise(year = as.integer(year),  # Convert year to integer for plotting\n                rate = round(mean(rate, na.rm = TRUE), 1),  # Average screening rate\n                .groups = \"drop\") \n  })\n\n  # Render Table: displays filtered data in an interactive table with export options\n  output$table &lt;- renderDT({\n    datatable(filtered_data(), \n              options = list(\n                pageLength = 10,  # Show 10 rows per page\n                dom = 'Bfrtip',  # Include Buttons (copy, csv, pdf, etc.)\n                buttons = c('copy', 'csv', 'excel', 'pdf', 'print'),\n                class = \"display nowrap compact\"  # Responsive and compact table design\n              ),\n              extensions = 'Buttons',\n              style = \"bootstrap\", \n              class = \"table table-striped table-bordered\") %&gt;%\n      formatStyle(columns = names(filtered_data()), color = input$color)  # Use selected color\n  })\n\n  # Download Handler: enables users to download filtered data\n  output$download_data &lt;- downloadHandler(\n    filename = \"Breast_cancer_screening_data.csv\",\n    content = function(file) {\n      write.csv(filtered_data(), file, row.names = FALSE)\n    }\n  )\n\n  # Render Plot: displays line plot of screening rates over time by age group\n  output$plot &lt;- renderPlotly({\n    df &lt;- filtered_data()\n\n    p &lt;- ggplot(df, aes(x = year, y = rate, color = age_group, group = interaction(state, age_group))) +\n      geom_line(size = 1) +  # Draw lines to show trend\n      geom_point(size = 3) +  # Add points to emphasize data values\n      labs(title = \"Breast Cancer Screening Uptake\", \n           x = \"Year\", \n           y = \"Screening Rate\",\n           color = \"Age Group\") +\n      theme_minimal()\n\n    ggplotly(p)  # Convert ggplot to interactive plotly chart\n  })\n}\n\n# Launch the app\nshinyApp(ui, server)"
  },
  {
    "objectID": "Post_Blog/Table automation and Ideas.html#table-without-title-and-footer",
    "href": "Post_Blog/Table automation and Ideas.html#table-without-title-and-footer",
    "title": "Automating Publication-Ready Tables in R",
    "section": "1.1 1. Table Without Title and Footer",
    "text": "1.1 1. Table Without Title and Footer\nThis section introduces a basic version of the automated table‚Äîminimal and clean without captions or footnotes.\n\nWhy it matters: A stripped-down table is great for quick previews or inline summaries.\nWhen to use: Internal drafts, early analysis stages, or dashboards.\nEnsure grouping variables are characters to avoid formatting issues.\nBuild one reusable function (create_tab) to apply across multiple variables.\nBind all summary tables into a combined format.\nAdd row-wise percentages directly to the table.\n\n\n# ------------1. Table without title and footer -------------------------------------------+\n#.......................Ensure grouping variables are characters............................\nvacc_1524 &lt;- vacc_1524 %&gt;%\n  mutate(across(c(vacc_service_year, vacc_quarter, vacc_weekday), as.character))\n\n# ---------------- Table generation function ....................\ncreate_tab &lt;- function(data, var, label) {\n  data %&gt;%\n    filter(!is.na({{ var }})) %&gt;%\n    tabyl({{ var }}, vacc_group3) %&gt;%\n    mutate(Category = label, .before = 1) %&gt;%\n    rename(Label = {{ var }}) %&gt;%\n    mutate(Label = as.character(Label))\n}\n\n# .................... Create summary tables ....................\ntab_age &lt;- create_tab(vacc_1524, age_group, \"Age\")\ntab_sex &lt;- create_tab(vacc_1524, gender, \"Gender\")\ntab_marital_status &lt;- create_tab(vacc_1524, marital_status, \"Marital status\")\ntab_year    &lt;- create_tab(vacc_1524, vacc_service_year, \"Year\")\ntab_quarter &lt;- create_tab(vacc_1524, vacc_quarter, \"Quarter\")\ntab_weekday &lt;- create_tab(vacc_1524, vacc_weekday, \"Weekday\")\n\n# ......................Combine all tabs ....................\ntab_combined &lt;- bind_rows(tab_sex, tab_age, tab_marital_status, tab_year, tab_quarter, tab_weekday)\n\n# ....................... Create row % and format as text ....................\ntab_combined &lt;- tab_combined %&gt;%\n  rowwise() %&gt;%\n  mutate(\n    Total = sum(`Respiratory vaccines`, `Childhood vaccines`, Other, na.rm = TRUE),\n    Respiratory = paste0(comma(`Respiratory vaccines`), \" (\", round(100 * `Respiratory vaccines` / Total, 1), \")\"),\n    Childhood   = paste0(comma(`Childhood vaccines`), \" (\", round(100 * `Childhood vaccines` / Total, 1), \")\"),\n    Other_grp   = paste0(comma(Other), \" (\", round(100 * Other / Total, 1), \")\")\n  ) %&gt;%\n  ungroup()\n\n# ............................. Remove repeated variable names ....................\ntab_combined &lt;- tab_combined %&gt;%\n  group_by(Category) %&gt;%\n  mutate(Category = ifelse(row_number() == 1, Category, \"\")) %&gt;%\n  ungroup()\n\n# ........................... Get total counts per vaccine group ....................\ntotals &lt;- vacc_1524 %&gt;%\n  count(vacc_group3) %&gt;%\n  deframe()\n\n# .................... Create flextable ....................\nft_vacc_summary &lt;- tab_combined %&gt;%\n  select(Category, Label, Respiratory, Childhood, Other_grp) %&gt;%\n  flextable() %&gt;%\n  set_header_labels(\n    Category = \"Variable type\",\n    Label = \"Values\",\n    Respiratory = \"Number (%)·µÉ\",\n    Childhood = \"Number (%)·µÉ\",\n    Other_grp = \"Number (%)·µÉ\"\n  ) %&gt;%\n  add_header_row( # Second row\n    values = c(\n      \"\", \"\",\n      paste0(\"Respiratory vaccines (N = \", format(totals[\"Respiratory vaccines\"], big.mark = \",\"), \")\"),\n      paste0(\"Childhood vaccines (N = \", format(totals[\"Childhood vaccines\"], big.mark = \",\"), \")\"),\n      paste0(\"Other (N = \", format(totals[\"Other\"], big.mark = \",\"), \")\")\n    )\n  ) %&gt;%\n  add_header_row( # First row (merged header)\n    values = c(\"Description\", \"Vaccination uptake\"),\n    colwidths = c(2, 3)\n  ) %&gt;%\n  theme_box() %&gt;%\n  set_table_properties(layout = \"autofit\", width = 1) %&gt;%\n  width(j = 1, width = 1.5) %&gt;%\n  width(j = 2, width = 2.5) %&gt;%\n  width(j = 3:4, width = 1.5) %&gt;%\n  align(align = \"justify\", part = \"all\") %&gt;%\n  border_remove() %&gt;%\n  border(part = \"header\", i = 1, border.top = fp_border(color = \"black\", width = 1)) %&gt;%\n  border(part = \"header\", i = 3, border.bottom = fp_border(color = \"black\", width = 1)) %&gt;%\n  border_inner_h(part = \"header\", border = fp_border(color = \"black\", width = 0.8)) %&gt;%\n  border_inner_h(part = \"body\", border = fp_border(color = \"black\", width = 0.8)) %&gt;%\n  border(part = \"body\", i = nrow(tab_combined), border.bottom = fp_border(color = \"black\", width = 1)) \n  \n# --- Display the table ---\nft_vacc_summary\n\nDescriptionVaccination uptakeRespiratory vaccines (N = 955)Childhood vaccines (N = 472)Other (N = 126)Variable typeValuesNumber (%)·µÉNumber (%)·µÉNumber (%)·µÉGenderFemale511 (64)233 (29.2)54 (6.8)Male444 (58.8)239 (31.7)72 (9.5)Age0-19250 (38.9)302 (47)90 (14)20-29150 (68.2)70 (31.8)0 (0)30-3947 (71.2)19 (28.8)0 (0)40-49142 (75.9)45 (24.1)0 (0)50-59112 (77.8)14 (9.7)18 (12.5)60-69149 (87.6)13 (7.6)8 (4.7)70+105 (84.7)9 (7.3)10 (8.1)Marital statusDivorced136 (83.4)15 (9.2)12 (7.4)Married289 (79)59 (16.1)18 (4.9)Single/widowed150 (79.4)33 (17.5)6 (3.2)Year201578 (51)56 (36.6)19 (12.4)201684 (60.4)47 (33.8)8 (5.8)201775 (54.7)52 (38)10 (7.3)201881 (53.6)52 (34.4)18 (11.9)201983 (51.6)60 (37.3)18 (11.2)202082 (59.9)44 (32.1)11 (8)2021223 (84.8)34 (12.9)6 (2.3)202288 (73.3)25 (20.8)7 (5.8)202387 (51.2)63 (37.1)20 (11.8)202474 (60.7)39 (32)9 (7.4)Quarter1253 (62.8)120 (29.8)30 (7.4)2220 (58.5)117 (31.1)39 (10.4)3295 (63.2)139 (29.8)33 (7.1)4187 (60.9)96 (31.3)24 (7.8)WeekdayFriday141 (78.3)31 (17.2)8 (4.4)Monday114 (64.4)49 (27.7)14 (7.9)Saturday160 (63.2)81 (32)12 (4.7)Sunday156 (56.3)100 (36.1)21 (7.6)Thursday167 (66)66 (26.1)20 (7.9)Tuesday108 (65.5)43 (26.1)14 (8.5)Wednesday109 (44)102 (41.1)37 (14.9)\n\n# --- Clean up environment ---\nrm(tab_year, tab_quarter, tab_weekday, tab_combined, totals, create_tab, ft_vacc_summary)"
  },
  {
    "objectID": "Post_Blog/Table automation and Ideas.html#table-with-title-and-footer",
    "href": "Post_Blog/Table automation and Ideas.html#table-with-title-and-footer",
    "title": "Automating Publication-Ready Tables in R",
    "section": "1.2 2 Table With Title and Footer",
    "text": "1.2 2 Table With Title and Footer\nThis extends the previous section by including a clear table caption and an explanatory footnote.\nüßæ Why this is important:\n\nCaptions add context‚Äîespecially in reports.\nFootnotes help clarify how metrics are calculated (e.g., row percentages).\n\nüìò Best used when: Preparing for publication, stakeholder presentations, or final reports.\n\n# ------------2. Table with Title and Footer -------------------------------------------\n\n#.......................Ensure grouping variables are characters............................\nvacc_1524 &lt;- vacc_1524 %&gt;%\n  mutate(across(c(vacc_service_year, vacc_quarter, vacc_weekday), as.character))\n\n# ---------------- Table generation function ....................\ncreate_tab &lt;- function(data, var, label) {\n  data %&gt;%\n    filter(!is.na({{ var }})) %&gt;%\n    tabyl({{ var }}, vacc_group3) %&gt;%\n    mutate(Category = label, .before = 1) %&gt;%\n    rename(Label = {{ var }}) %&gt;%\n    mutate(Label = as.character(Label))\n}\n\n# .................... Create summary tables ....................\ntab_age &lt;- create_tab(vacc_1524, age_group, \"Age\")\ntab_sex &lt;- create_tab(vacc_1524, gender, \"Gender\")\ntab_marital_status &lt;- create_tab(vacc_1524, marital_status, \"Marital status\")\ntab_year    &lt;- create_tab(vacc_1524, vacc_service_year, \"Year\")\ntab_quarter &lt;- create_tab(vacc_1524, vacc_quarter, \"Quarter\")\ntab_weekday &lt;- create_tab(vacc_1524, vacc_weekday, \"Weekday\")\n\n# ......................Combine all tabs ....................\ntab_combined &lt;- bind_rows(tab_sex, tab_age, tab_marital_status, tab_year, tab_quarter, tab_weekday)\n\n# ....................... Create row % and format as text ....................\ntab_combined &lt;- tab_combined %&gt;%\n  rowwise() %&gt;%\n  mutate(\n    Total = sum(`Respiratory vaccines`, `Childhood vaccines`, Other, na.rm = TRUE),\n    Respiratory = paste0(comma(`Respiratory vaccines`), \" (\", round(100 * `Respiratory vaccines` / Total, 1), \")\"),\n    Childhood   = paste0(comma(`Childhood vaccines`), \" (\", round(100 * `Childhood vaccines` / Total, 1), \")\"),\n    Other_grp   = paste0(comma(Other), \" (\", round(100 * Other / Total, 1), \")\")\n  ) %&gt;%\n  ungroup()\n\n# ............................. Remove repeated variable names ....................\ntab_combined &lt;- tab_combined %&gt;%\n  group_by(Category) %&gt;%\n  mutate(Category = ifelse(row_number() == 1, Category, \"\")) %&gt;%\n  ungroup()\n\n# ........................... Get total counts per vaccine group ....................\ntotals &lt;- vacc_1524 %&gt;%\n  count(vacc_group3) %&gt;%\n  deframe()\n\n# .................... Create flextable ....................\nft_vacc_summary &lt;- tab_combined %&gt;%\n  select(Category, Label, Respiratory, Childhood, Other_grp) %&gt;%\n  flextable() %&gt;%\n  set_header_labels(\n    Category = \"Variable type\",\n    Label = \"Values\",\n    Respiratory = \"Number (%)·µÉ\",\n    Childhood = \"Number (%)·µÉ\",\n    Other_grp = \"Number (%)·µÉ\"\n  ) %&gt;%\n  add_header_row( # Second row\n    values = c(\n      \"\", \"\",\n      paste0(\"Respiratory vaccines (N = \", format(totals[\"Respiratory vaccines\"], big.mark = \",\"), \")\"),\n      paste0(\"Childhood vaccines (N = \", format(totals[\"Childhood vaccines\"], big.mark = \",\"), \")\"),\n      paste0(\"Other (N = \", format(totals[\"Other\"], big.mark = \",\"), \")\")\n    )\n  ) %&gt;%\n  add_header_row( # First row (merged header)\n    values = c(\"Description\", \"Vaccination uptake\"),\n    colwidths = c(2, 3)\n  ) %&gt;%\n  theme_box() %&gt;%\n  set_table_properties(layout = \"autofit\", width = 1) %&gt;%\n  width(j = 1, width = 1.5) %&gt;%\n  width(j = 2, width = 2.5) %&gt;%\n  width(j = 3:4, width = 1.5) %&gt;%\n  align(align = \"justify\", part = \"all\") %&gt;%\n  \n  border_remove() %&gt;%\n  border(part = \"header\", i = 1, border.top = fp_border(color = \"black\", width = 1)) %&gt;%\n  border(part = \"header\", i = 3, border.bottom = fp_border(color = \"black\", width = 1)) %&gt;%\n  border_inner_h(part = \"header\", border = fp_border(color = \"black\", width = 0.8)) %&gt;%\n  border_inner_h(part = \"body\", border = fp_border(color = \"black\", width = 0.8)) %&gt;%\n  border(part = \"body\", i = nrow(tab_combined), border.bottom = fp_border(color = \"black\", width = 1)) %&gt;%\n  \n  set_caption(\"Table: Vaccination uptake across service year, quarter, and weekday\") %&gt;%\n  footnote(i = 1, \n           value = as_paragraph(\" Vaccination proportions were calculated row-wise (i.e., by row).\"),\n           ref_symbols = \"·µÉ\", part = \"header\") \n# %&gt;%\n#   border_inner_h(border = fp_border(color = \"black\", width = 1))  %&gt;%\n#   add_header_lines(values = \"Table xx: Vaccination uptake across service year, quarter, and weekday.\") %&gt;%\n#   add_footer_lines(values = c(\n#     \"·µÉ Vaccination proportions were calculated per row (row percentage).\",\n#     paste0(\"·µá The vaccine provider type did not include unvaccinated (N = \", format(no_total, big.mark = \",\"), \").\"),\n#     \"·∂ú Vaccination proportions were calculated row-wise (i.e., by row).\",\n#     \"GP = General practitioner, PHU = Public Health Unit\"\n#   ))\n\n# Display the table\nft_vacc_summary\n\nDescription·µÉVaccination uptake·µÉRespiratory vaccines (N = 955)Childhood vaccines (N = 472)Other (N = 126)Variable typeValuesNumber (%)·µÉNumber (%)·µÉNumber (%)·µÉGenderFemale511 (64)233 (29.2)54 (6.8)Male444 (58.8)239 (31.7)72 (9.5)Age0-19250 (38.9)302 (47)90 (14)20-29150 (68.2)70 (31.8)0 (0)30-3947 (71.2)19 (28.8)0 (0)40-49142 (75.9)45 (24.1)0 (0)50-59112 (77.8)14 (9.7)18 (12.5)60-69149 (87.6)13 (7.6)8 (4.7)70+105 (84.7)9 (7.3)10 (8.1)Marital statusDivorced136 (83.4)15 (9.2)12 (7.4)Married289 (79)59 (16.1)18 (4.9)Single/widowed150 (79.4)33 (17.5)6 (3.2)Year201578 (51)56 (36.6)19 (12.4)201684 (60.4)47 (33.8)8 (5.8)201775 (54.7)52 (38)10 (7.3)201881 (53.6)52 (34.4)18 (11.9)201983 (51.6)60 (37.3)18 (11.2)202082 (59.9)44 (32.1)11 (8)2021223 (84.8)34 (12.9)6 (2.3)202288 (73.3)25 (20.8)7 (5.8)202387 (51.2)63 (37.1)20 (11.8)202474 (60.7)39 (32)9 (7.4)Quarter1253 (62.8)120 (29.8)30 (7.4)2220 (58.5)117 (31.1)39 (10.4)3295 (63.2)139 (29.8)33 (7.1)4187 (60.9)96 (31.3)24 (7.8)WeekdayFriday141 (78.3)31 (17.2)8 (4.4)Monday114 (64.4)49 (27.7)14 (7.9)Saturday160 (63.2)81 (32)12 (4.7)Sunday156 (56.3)100 (36.1)21 (7.6)Thursday167 (66)66 (26.1)20 (7.9)Tuesday108 (65.5)43 (26.1)14 (8.5)Wednesday109 (44)102 (41.1)37 (14.9)·µÉ Vaccination proportions were calculated row-wise (i.e., by row).\n\n# .................... Clean up environment ....................\nrm(tab_year, tab_quarter, tab_weekday, tab_combined, ft_vacc_summary, totals, create_tab)"
  },
  {
    "objectID": "Post_Blog/Table automation and Ideas.html#missing-values-with-n",
    "href": "Post_Blog/Table automation and Ideas.html#missing-values-with-n",
    "title": "Automating Publication-Ready Tables in R",
    "section": "1.3 3. Missing Values with n(%)",
    "text": "1.3 3. Missing Values with n(%)\nIn this version, we include ‚ÄúMissing‚Äù as a separate category and provide both counts and percentages.\nüß† Why this matters: Ignoring missing values can skew analysis. This format transparently highlights data completeness.\nüëç Recommended for: Health datasets, surveys, or administrative data where data quality assessment is key.\n\n# ------------3. Missing values with n(%)-------------------------------------------\n\n\n# .................. Convert grouping vars to character ..................\nvacc_1524 &lt;- vacc_1524 %&gt;%\n  mutate(across(c(age_group, gender, marital_status,\n                  vacc_service_year, vacc_quarter, vacc_weekday), as.character))\n\n# .................. Table generation function with Missing ..................\ncreate_tab &lt;- function(data, var, label) {\n  tab_main &lt;- data %&gt;%\n    filter(!is.na({{ var }})) %&gt;%\n    tabyl({{ var }}, vacc_group3) %&gt;%\n    mutate(Category = label, .before = 1) %&gt;%\n    rename(Label = {{ var }}) %&gt;%\n    mutate(Label = as.character(Label))\n  \n  na_count &lt;- sum(is.na(pull(data, {{ var }})))\n  \n  if (na_count &gt; 0) {\n    missing_row &lt;- tibble(\n      Category = label,\n      Label = \"Missing\",\n      `Respiratory vaccines` = sum(data$vacc_group3 == \"Respiratory vaccines\" & is.na(pull(data, {{ var }})), na.rm = TRUE),\n      `Childhood vaccines` = sum(data$vacc_group3 == \"Childhood vaccines\" & is.na(pull(data, {{ var }})), na.rm = TRUE),\n      Other = sum(data$vacc_group3 == \"Other\" & is.na(pull(data, {{ var }})), na.rm = TRUE)\n    )\n    tab_final &lt;- bind_rows(tab_main, missing_row)\n  } else {\n    tab_final &lt;- tab_main\n  }\n  \n  return(tab_final)\n}\n\n# .................. Create summary tables ..................\ntab_age            &lt;- create_tab(vacc_1524, age_group, \"Age\")\ntab_sex            &lt;- create_tab(vacc_1524, gender, \"Gender\")\ntab_marital_status &lt;- create_tab(vacc_1524, marital_status, \"Marital status\")\ntab_year           &lt;- create_tab(vacc_1524, vacc_service_year, \"Year\")\ntab_quarter        &lt;- create_tab(vacc_1524, vacc_quarter, \"Quarter\")\ntab_weekday        &lt;- create_tab(vacc_1524, vacc_weekday, \"Weekday\")\n\n# .................. Combine all tables ..................\ntab_combined &lt;- bind_rows(tab_sex, tab_age, tab_marital_status, tab_year, tab_quarter, tab_weekday)\n\n# .................. Calculate row-wise percentages ..................\ntab_combined &lt;- tab_combined %&gt;%\n  rowwise() %&gt;%\n  mutate(\n    Total = sum(`Respiratory vaccines`, `Childhood vaccines`, Other, na.rm = TRUE),\n    Respiratory = paste0(comma(`Respiratory vaccines`), \" (\", round(100 * `Respiratory vaccines` / Total, 1), \")\"),\n    Childhood   = paste0(comma(`Childhood vaccines`), \" (\", round(100 * `Childhood vaccines` / Total, 1), \")\"),\n    Other_grp   = paste0(comma(Other), \" (\", round(100 * Other / Total, 1), \")\")\n  ) %&gt;%\n  ungroup()\n\n\n# .................. Show Category only once per group ..................\ntab_combined &lt;- tab_combined %&gt;%\n  group_by(Category) %&gt;%\n  mutate(Category = ifelse(row_number() == 1, Category, \"\")) %&gt;%\n  ungroup()\n\n# .................. Get total counts per vaccine group ..................\ntotals &lt;- vacc_1524 %&gt;%\n  count(vacc_group3) %&gt;%\n  deframe()\n\n# .................. Create flextable ..................\nft_vacc_summary &lt;- tab_combined %&gt;%\n  select(Category, Label, Respiratory, Childhood, Other_grp) %&gt;%\n  flextable() %&gt;%\n  set_header_labels(\n    Category = \"Variable type\",\n    Label = \"Values\",\n    Respiratory = \"Number (%)·µÉ\",\n    Childhood = \"Number (%)·µÉ\",\n    Other_grp = \"Number (%)·µÉ\"\n  ) %&gt;%\n  add_header_row(\n    values = c(\n      \"\", \"\",\n      paste0(\"Respiratory vaccines (N = \", format(totals[\"Respiratory vaccines\"], big.mark = \",\"), \")\"),\n      paste0(\"Childhood vaccines (N = \", format(totals[\"Childhood vaccines\"], big.mark = \",\"), \")\"),\n      paste0(\"Other (N = \", format(totals[\"Other\"], big.mark = \",\"), \")\")\n    )\n  ) %&gt;%\n  add_header_row(\n    values = c(\"Description\", \"Vaccination uptake\"),\n    colwidths = c(2, 3)\n  ) %&gt;%\n  theme_box() %&gt;%\n  set_table_properties(layout = \"autofit\", width = 1) %&gt;%\n  width(j = 1, width = 1.5) %&gt;%\n  width(j = 2, width = 2.5) %&gt;%\n  width(j = 3:5, width = 1.5) %&gt;%\n  align(align = \"justify\", part = \"all\") %&gt;%\n  border_remove() %&gt;%\n  border(part = \"header\", i = 1, border.top = fp_border(color = \"black\", width = 1)) %&gt;%\n  border(part = \"header\", i = 3, border.bottom = fp_border(color = \"black\", width = 1)) %&gt;%\n  border_inner_h(part = \"header\", border = fp_border(color = \"black\", width = 0.8)) %&gt;%\n  border_inner_h(part = \"body\", border = fp_border(color = \"black\", width = 0.8)) %&gt;%\n  border(part = \"body\", i = nrow(tab_combined), border.bottom = fp_border(color = \"black\", width = 1)) %&gt;%\n  \n  set_caption(\"Table: Vaccination uptake across service year, quarter, and weekday\") %&gt;%\n  footnote(i = 1, \n           value = as_paragraph(\"Vaccination proportions were calculated row-wise (i.e., by row).\"),\n           ref_symbols = \"·µÉ\", \n           part = \"header\")\n# .................. Show the table ..................\nft_vacc_summary\n\nDescription·µÉVaccination uptake·µÉRespiratory vaccines (N = 955)Childhood vaccines (N = 472)Other (N = 126)Variable typeValuesNumber (%)·µÉNumber (%)·µÉNumber (%)·µÉGenderFemale511 (64)233 (29.2)54 (6.8)Male444 (58.8)239 (31.7)72 (9.5)Age0-19250 (38.9)302 (47)90 (14)20-29150 (68.2)70 (31.8)0 (0)30-3947 (71.2)19 (28.8)0 (0)40-49142 (75.9)45 (24.1)0 (0)50-59112 (77.8)14 (9.7)18 (12.5)60-69149 (87.6)13 (7.6)8 (4.7)70+105 (84.7)9 (7.3)10 (8.1)Marital statusDivorced136 (83.4)15 (9.2)12 (7.4)Married289 (79)59 (16.1)18 (4.9)Single/widowed150 (79.4)33 (17.5)6 (3.2)Missing380 (45.5)365 (43.7)90 (10.8)Year201578 (51)56 (36.6)19 (12.4)201684 (60.4)47 (33.8)8 (5.8)201775 (54.7)52 (38)10 (7.3)201881 (53.6)52 (34.4)18 (11.9)201983 (51.6)60 (37.3)18 (11.2)202082 (59.9)44 (32.1)11 (8)2021223 (84.8)34 (12.9)6 (2.3)202288 (73.3)25 (20.8)7 (5.8)202387 (51.2)63 (37.1)20 (11.8)202474 (60.7)39 (32)9 (7.4)Quarter1253 (62.8)120 (29.8)30 (7.4)2220 (58.5)117 (31.1)39 (10.4)3295 (63.2)139 (29.8)33 (7.1)4187 (60.9)96 (31.3)24 (7.8)WeekdayFriday141 (78.3)31 (17.2)8 (4.4)Monday114 (64.4)49 (27.7)14 (7.9)Saturday160 (63.2)81 (32)12 (4.7)Sunday156 (56.3)100 (36.1)21 (7.6)Thursday167 (66)66 (26.1)20 (7.9)Tuesday108 (65.5)43 (26.1)14 (8.5)Wednesday109 (44)102 (41.1)37 (14.9)·µÉVaccination proportions were calculated row-wise (i.e., by row).\n\n# .................. Clean up ..................\nrm(tab_age, tab_sex, tab_marital_status, tab_year, tab_quarter, tab_weekday, \n   tab_combined, ft_vacc_summary, totals, create_tab)"
  },
  {
    "objectID": "Post_Blog/Table automation and Ideas.html#missing-values-with-only-counts",
    "href": "Post_Blog/Table automation and Ideas.html#missing-values-with-only-counts",
    "title": "Automating Publication-Ready Tables in R",
    "section": "1.4 4. Missing Values with Only Counts",
    "text": "1.4 4. Missing Values with Only Counts\nThis variation includes missing data rows but only shows raw counts, not percentages.\n\n‚öñÔ∏è Why use this: It prevents misleading interpretations‚Äîespecially when the denominator for percentage is unclear or inconsistent.\nUse this when you want to acknowledge missing data but avoid implying proportional meaning.\n\n\n# ------------4. Missing values with only counts-------------------------------------------\n\n# .................. Convert grouping vars to character ..................\nvacc_1524 &lt;- vacc_1524 %&gt;%\n  mutate(across(c(age_group, gender, marital_status,\n                  vacc_service_year, vacc_quarter, vacc_weekday), as.character))\n\n# .................. Table generation function with Missing ..................\ncreate_tab &lt;- function(data, var, label) {\n  tab_main &lt;- data %&gt;%\n    filter(!is.na({{ var }})) %&gt;%\n    tabyl({{ var }}, vacc_group3) %&gt;%\n    mutate(Category = label, .before = 1) %&gt;%\n    rename(Label = {{ var }}) %&gt;%\n    mutate(Label = as.character(Label))\n  \n  na_count &lt;- sum(is.na(pull(data, {{ var }})))\n  \n  if (na_count &gt; 0) {\n    missing_row &lt;- tibble(\n      Category = label,\n      Label = \"Missing\",\n      `Respiratory vaccines` = sum(data$vacc_group3 == \"Respiratory vaccines\" & is.na(pull(data, {{ var }})), na.rm = TRUE),\n      `Childhood vaccines` = sum(data$vacc_group3 == \"Childhood vaccines\" & is.na(pull(data, {{ var }})), na.rm = TRUE),\n      Other = sum(data$vacc_group3 == \"Other\" & is.na(pull(data, {{ var }})), na.rm = TRUE)\n    )\n    tab_final &lt;- bind_rows(tab_main, missing_row)\n  } else {\n    tab_final &lt;- tab_main\n  }\n  \n  return(tab_final)\n}\n\n# .................. Create summary tables ..................\ntab_age            &lt;- create_tab(vacc_1524, age_group, \"Age\")\ntab_sex            &lt;- create_tab(vacc_1524, gender, \"Gender\")\ntab_marital_status &lt;- create_tab(vacc_1524, marital_status, \"Marital status\")\ntab_year           &lt;- create_tab(vacc_1524, vacc_service_year, \"Year\")\ntab_quarter        &lt;- create_tab(vacc_1524, vacc_quarter, \"Quarter\")\ntab_weekday        &lt;- create_tab(vacc_1524, vacc_weekday, \"Weekday\")\n\n# .................. Combine all tables ..................\ntab_combined &lt;- bind_rows(tab_sex, tab_age, tab_marital_status, tab_year, tab_quarter, tab_weekday)\n\n# .................. Calculate row-wise percentages (skip for Missing) ..................\ntab_combined &lt;- tab_combined %&gt;%\n  rowwise() %&gt;%\n  mutate(\n    Total = sum(`Respiratory vaccines`, `Childhood vaccines`, Other, na.rm = TRUE),\n    is_missing = trimws(tolower(Label)) == \"missing\",\n    \n    Respiratory = ifelse(is_missing,\n                         comma(`Respiratory vaccines`),\n                         paste0(comma(`Respiratory vaccines`), \" (\", round(100 * `Respiratory vaccines` / Total, 1), \")\")),\n    \n    Childhood = ifelse(is_missing,\n                       comma(`Childhood vaccines`),\n                       paste0(comma(`Childhood vaccines`), \" (\", round(100 * `Childhood vaccines` / Total, 1), \")\")),\n    \n    Other_grp = ifelse(is_missing,\n                       comma(Other),\n                       paste0(comma(Other), \" (\", round(100 * Other / Total, 1), \")\"))\n  ) %&gt;%\n  ungroup() %&gt;%\n  select(Category, Label, Respiratory, Childhood, Other_grp)\n\n# .................. Show Category only once per group ..................\ntab_combined &lt;- tab_combined %&gt;%\n  group_by(Category) %&gt;%\n  mutate(Category = ifelse(row_number() == 1, Category, \"\")) %&gt;%\n  ungroup()\n\n# .................. Get total counts per vaccine group ..................\ntotals &lt;- vacc_1524 %&gt;%\n  count(vacc_group3) %&gt;%\n  deframe()\n\n# .................. Create flextable ..................\nft_vacc_summary &lt;- tab_combined %&gt;%\n  flextable() %&gt;%\n  set_header_labels(\n    Category = \"Variable type\",\n    Label = \"Values\",\n    Respiratory = \"Number (%)·µÉ\",\n    Childhood = \"Number (%)·µÉ\",\n    Other_grp = \"Number (%)·µÉ\"\n  ) %&gt;%\n  add_header_row(\n    values = c(\n      \"\", \"\",\n      paste0(\"Respiratory vaccines (N = \", format(totals[\"Respiratory vaccines\"], big.mark = \",\"), \")\"),\n      paste0(\"Childhood vaccines (N = \", format(totals[\"Childhood vaccines\"], big.mark = \",\"), \")\"),\n      paste0(\"Other (N = \", format(totals[\"Other\"], big.mark = \",\"), \")\")\n    )\n  ) %&gt;%\n  add_header_row(\n    values = c(\"Description\", \"Vaccination uptake\"),\n    colwidths = c(2, 3)\n  ) %&gt;%\n  theme_box() %&gt;%\n  set_table_properties(layout = \"autofit\", width = 1) %&gt;%\n  width(j = 1, width = 1.5) %&gt;%\n  width(j = 2, width = 2.5) %&gt;%\n  width(j = 3:5, width = 1.5) %&gt;%\n  align(align = \"justify\", part = \"all\") %&gt;%\n  border_remove() %&gt;%\n  border(part = \"header\", i = 1, border.top = fp_border(color = \"black\", width = 1)) %&gt;%\n  border(part = \"header\", i = 3, border.bottom = fp_border(color = \"black\", width = 1)) %&gt;%\n  border_inner_h(part = \"header\", border = fp_border(color = \"black\", width = 0.8)) %&gt;%\n  border_inner_h(part = \"body\", border = fp_border(color = \"black\", width = 0.8)) %&gt;%\n  border(part = \"body\", i = nrow(tab_combined), border.bottom = fp_border(color = \"black\", width = 1)) %&gt;%\n  \n  set_caption(\"Table: Vaccination uptake across service year, quarter, and weekday\") %&gt;%\n  footnote(i = 1, \n           value = as_paragraph(\"Vaccination proportions were calculated row-wise (i.e., by row).\"),\n           ref_symbols = \"·µÉ\", \n           part = \"header\")\n\n# .................. Show the table ..................\nft_vacc_summary\n\nDescription·µÉVaccination uptake·µÉRespiratory vaccines (N = 955)Childhood vaccines (N = 472)Other (N = 126)Variable typeValuesNumber (%)·µÉNumber (%)·µÉNumber (%)·µÉGenderFemale511 (64)233 (29.2)54 (6.8)Male444 (58.8)239 (31.7)72 (9.5)Age0-19250 (38.9)302 (47)90 (14)20-29150 (68.2)70 (31.8)0 (0)30-3947 (71.2)19 (28.8)0 (0)40-49142 (75.9)45 (24.1)0 (0)50-59112 (77.8)14 (9.7)18 (12.5)60-69149 (87.6)13 (7.6)8 (4.7)70+105 (84.7)9 (7.3)10 (8.1)Marital statusDivorced136 (83.4)15 (9.2)12 (7.4)Married289 (79)59 (16.1)18 (4.9)Single/widowed150 (79.4)33 (17.5)6 (3.2)Missing38036590Year201578 (51)56 (36.6)19 (12.4)201684 (60.4)47 (33.8)8 (5.8)201775 (54.7)52 (38)10 (7.3)201881 (53.6)52 (34.4)18 (11.9)201983 (51.6)60 (37.3)18 (11.2)202082 (59.9)44 (32.1)11 (8)2021223 (84.8)34 (12.9)6 (2.3)202288 (73.3)25 (20.8)7 (5.8)202387 (51.2)63 (37.1)20 (11.8)202474 (60.7)39 (32)9 (7.4)Quarter1253 (62.8)120 (29.8)30 (7.4)2220 (58.5)117 (31.1)39 (10.4)3295 (63.2)139 (29.8)33 (7.1)4187 (60.9)96 (31.3)24 (7.8)WeekdayFriday141 (78.3)31 (17.2)8 (4.4)Monday114 (64.4)49 (27.7)14 (7.9)Saturday160 (63.2)81 (32)12 (4.7)Sunday156 (56.3)100 (36.1)21 (7.6)Thursday167 (66)66 (26.1)20 (7.9)Tuesday108 (65.5)43 (26.1)14 (8.5)Wednesday109 (44)102 (41.1)37 (14.9)·µÉVaccination proportions were calculated row-wise (i.e., by row).\n\n# .................. Clean up ..................\nrm(tab_age, tab_sex, tab_marital_status, tab_year, tab_quarter, tab_weekday, \n   tab_combined, ft_vacc_summary, totals, create_tab)"
  },
  {
    "objectID": "Post_Blog/Table automation and Ideas.html#remove-all-lines",
    "href": "Post_Blog/Table automation and Ideas.html#remove-all-lines",
    "title": "Automating Publication-Ready Tables in R",
    "section": "1.5 5. Remove All Lines",
    "text": "1.5 5. Remove All Lines\nThis version removes all border lines for a minimalist, text-friendly table.\n‚ú® Why this helps: It improves visual integration in Word documents or printed reports where borders may clutter formatting.\nüîç Ideal for: Inline reporting, Word exports, or journal submissions requiring custom styling.\n\n# ------------5. Lines: remove all lines -------------------------------------------\n\n\n# .................. Convert grouping vars to character ..................\nvacc_1524 &lt;- vacc_1524 %&gt;%\n  mutate(across(c(age_group, gender, marital_status,\n                  vacc_service_year, vacc_quarter, vacc_weekday), as.character))\n\n# .................. Table generation function with Missing ..................\ncreate_tab &lt;- function(data, var, label) {\n  tab_main &lt;- data %&gt;%\n    filter(!is.na({{ var }})) %&gt;%\n    tabyl({{ var }}, vacc_group3) %&gt;%\n    mutate(Category = label, .before = 1) %&gt;%\n    rename(Label = {{ var }}) %&gt;%\n    mutate(Label = as.character(Label))\n  \n  na_count &lt;- sum(is.na(pull(data, {{ var }})))\n  \n  if (na_count &gt; 0) {\n    missing_row &lt;- tibble(\n      Category = label,\n      Label = \"Missing\",\n      `Respiratory vaccines` = sum(data$vacc_group3 == \"Respiratory vaccines\" & is.na(pull(data, {{ var }})), na.rm = TRUE),\n      `Childhood vaccines` = sum(data$vacc_group3 == \"Childhood vaccines\" & is.na(pull(data, {{ var }})), na.rm = TRUE),\n      Other = sum(data$vacc_group3 == \"Other\" & is.na(pull(data, {{ var }})), na.rm = TRUE)\n    )\n    tab_final &lt;- bind_rows(tab_main, missing_row)\n  } else {\n    tab_final &lt;- tab_main\n  }\n  \n  return(tab_final)\n}\n\n# .................. Create summary tables ..................\ntab_age            &lt;- create_tab(vacc_1524, age_group, \"Age\")\ntab_sex            &lt;- create_tab(vacc_1524, gender, \"Gender\")\ntab_marital_status &lt;- create_tab(vacc_1524, marital_status, \"Marital status\")\ntab_year           &lt;- create_tab(vacc_1524, vacc_service_year, \"Year\")\ntab_quarter        &lt;- create_tab(vacc_1524, vacc_quarter, \"Quarter\")\ntab_weekday        &lt;- create_tab(vacc_1524, vacc_weekday, \"Weekday\")\n\n# .................. Combine all tables ..................\ntab_combined &lt;- bind_rows(tab_sex, tab_age, tab_marital_status, tab_year, tab_quarter, tab_weekday)\n\n# .................. Calculate row-wise percentages (skip for Missing) ..................\ntab_combined &lt;- tab_combined %&gt;%\n  rowwise() %&gt;%\n  mutate(\n    Total = sum(`Respiratory vaccines`, `Childhood vaccines`, Other, na.rm = TRUE),\n    is_missing = trimws(tolower(Label)) == \"missing\",\n    \n    Respiratory = ifelse(is_missing,\n                         comma(`Respiratory vaccines`),\n                         paste0(comma(`Respiratory vaccines`), \" (\", round(100 * `Respiratory vaccines` / Total, 1), \")\")),\n    \n    Childhood = ifelse(is_missing,\n                       comma(`Childhood vaccines`),\n                       paste0(comma(`Childhood vaccines`), \" (\", round(100 * `Childhood vaccines` / Total, 1), \")\")),\n    \n    Other_grp = ifelse(is_missing,\n                       comma(Other),\n                       paste0(comma(Other), \" (\", round(100 * Other / Total, 1), \")\"))\n  ) %&gt;%\n  ungroup() %&gt;%\n  select(Category, Label, Respiratory, Childhood, Other_grp)\n\n# .................. Show Category only once per group ..................\ntab_combined &lt;- tab_combined %&gt;%\n  group_by(Category) %&gt;%\n  mutate(Category = ifelse(row_number() == 1, Category, \"\")) %&gt;%\n  ungroup()\n\n# .................. Get total counts per vaccine group ..................\ntotals &lt;- vacc_1524 %&gt;%\n  count(vacc_group3) %&gt;%\n  deframe()\n\n# .................. Create flextable ..................\nft_vacc_summary &lt;- tab_combined %&gt;%\n  flextable() %&gt;%\n  set_header_labels(\n    Category = \"Variable type\",\n    Label = \"Values\",\n    Respiratory = \"Number (%)·µÉ\",\n    Childhood = \"Number (%)·µÉ\",\n    Other_grp = \"Number (%)·µÉ\"\n  ) %&gt;%\n  add_header_row(\n    values = c(\n      \"\", \"\",\n      paste0(\"Respiratory vaccines (N = \", format(totals[\"Respiratory vaccines\"], big.mark = \",\"), \")\"),\n      paste0(\"Childhood vaccines (N = \", format(totals[\"Childhood vaccines\"], big.mark = \",\"), \")\"),\n      paste0(\"Other (N = \", format(totals[\"Other\"], big.mark = \",\"), \")\")\n    )\n  ) %&gt;%\n  add_header_row(\n    values = c(\"Description\", \"Vaccination uptake\"),\n    colwidths = c(2, 3)\n  ) %&gt;%\n  theme_box() %&gt;%\n  set_table_properties(layout = \"autofit\", width = 1) %&gt;%\n  width(j = 1, width = 1.5) %&gt;%\n  width(j = 2, width = 2.5) %&gt;%\n  width(j = 3:5, width = 1.5) %&gt;%\n  align(align = \"justify\", part = \"all\") %&gt;%\n  border_remove() %&gt;%\n  #  border_inner_h(border = fp_border(color = \"black\", width = 1)) %&gt;%\n  set_caption(\"Table: Vaccination uptake across service year, quarter, and weekday\") %&gt;%\n  footnote(i = 1, \n           value = as_paragraph(\"Vaccination proportions were calculated row-wise (i.e., by row).\"),\n           ref_symbols = \"·µÉ\", \n           part = \"header\")\n\n# .................. Show the table ..................\nft_vacc_summary\n\nDescription·µÉVaccination uptake·µÉRespiratory vaccines (N = 955)Childhood vaccines (N = 472)Other (N = 126)Variable typeValuesNumber (%)·µÉNumber (%)·µÉNumber (%)·µÉGenderFemale511 (64)233 (29.2)54 (6.8)Male444 (58.8)239 (31.7)72 (9.5)Age0-19250 (38.9)302 (47)90 (14)20-29150 (68.2)70 (31.8)0 (0)30-3947 (71.2)19 (28.8)0 (0)40-49142 (75.9)45 (24.1)0 (0)50-59112 (77.8)14 (9.7)18 (12.5)60-69149 (87.6)13 (7.6)8 (4.7)70+105 (84.7)9 (7.3)10 (8.1)Marital statusDivorced136 (83.4)15 (9.2)12 (7.4)Married289 (79)59 (16.1)18 (4.9)Single/widowed150 (79.4)33 (17.5)6 (3.2)Missing38036590Year201578 (51)56 (36.6)19 (12.4)201684 (60.4)47 (33.8)8 (5.8)201775 (54.7)52 (38)10 (7.3)201881 (53.6)52 (34.4)18 (11.9)201983 (51.6)60 (37.3)18 (11.2)202082 (59.9)44 (32.1)11 (8)2021223 (84.8)34 (12.9)6 (2.3)202288 (73.3)25 (20.8)7 (5.8)202387 (51.2)63 (37.1)20 (11.8)202474 (60.7)39 (32)9 (7.4)Quarter1253 (62.8)120 (29.8)30 (7.4)2220 (58.5)117 (31.1)39 (10.4)3295 (63.2)139 (29.8)33 (7.1)4187 (60.9)96 (31.3)24 (7.8)WeekdayFriday141 (78.3)31 (17.2)8 (4.4)Monday114 (64.4)49 (27.7)14 (7.9)Saturday160 (63.2)81 (32)12 (4.7)Sunday156 (56.3)100 (36.1)21 (7.6)Thursday167 (66)66 (26.1)20 (7.9)Tuesday108 (65.5)43 (26.1)14 (8.5)Wednesday109 (44)102 (41.1)37 (14.9)·µÉVaccination proportions were calculated row-wise (i.e., by row).\n\n# .................. Clean up ..................\nrm(tab_age, tab_sex, tab_marital_status, tab_year, tab_quarter, tab_weekday, \n   tab_combined, ft_vacc_summary, totals, create_tab)"
  },
  {
    "objectID": "Post_Blog/Table automation and Ideas.html#only-horizontal-lines",
    "href": "Post_Blog/Table automation and Ideas.html#only-horizontal-lines",
    "title": "Automating Publication-Ready Tables in R",
    "section": "1.6 6 . Only Horizontal Lines",
    "text": "1.6 6 . Only Horizontal Lines\nThis style keeps only horizontal dividers to improve readability without overwhelming the user.\nüìè Implication: Helps guide the eye across wide tables while maintaining a clean aesthetic.\n‚úÖ Great for: Formal documents and slide decks where visual clarity is important.\n\n# ------------6. Lines: Only Horizantal Lines -------------------------------------------\n\n# .................. Convert grouping vars to character ..................\nvacc_1524 &lt;- vacc_1524 %&gt;%\n  mutate(across(c(age_3group, gender, marital_status,\n                  vacc_service_year, vacc_quarter, vacc_weekday), as.character))\n\n# .................. Table generation function with Missing ..................\ncreate_tab &lt;- function(data, var, label) {\n  tab_main &lt;- data %&gt;%\n    filter(!is.na({{ var }})) %&gt;%\n    tabyl({{ var }}, vacc_group3) %&gt;%\n    mutate(Category = label, .before = 1) %&gt;%\n    rename(Label = {{ var }}) %&gt;%\n    mutate(Label = as.character(Label))\n  \n  na_count &lt;- sum(is.na(pull(data, {{ var }})))\n  \n  if (na_count &gt; 0) {\n    missing_row &lt;- tibble(\n      Category = label,\n      Label = \"Missing\",\n      `Respiratory vaccines` = sum(data$vacc_group3 == \"Respiratory vaccines\" & is.na(pull(data, {{ var }})), na.rm = TRUE),\n      `Childhood vaccines` = sum(data$vacc_group3 == \"Childhood vaccines\" & is.na(pull(data, {{ var }})), na.rm = TRUE),\n      Other = sum(data$vacc_group3 == \"Other\" & is.na(pull(data, {{ var }})), na.rm = TRUE)\n    )\n    tab_final &lt;- bind_rows(tab_main, missing_row)\n  } else {\n    tab_final &lt;- tab_main\n  }\n  \n  return(tab_final)\n}\n\n# .................. Create summary tables ..................\ntab_age            &lt;- create_tab(vacc_1524, age_group, \"Age\")\ntab_sex            &lt;- create_tab(vacc_1524, gender, \"Gender\")\ntab_marital_status &lt;- create_tab(vacc_1524, marital_status, \"Marital status\")\ntab_year           &lt;- create_tab(vacc_1524, vacc_service_year, \"Year\")\ntab_quarter        &lt;- create_tab(vacc_1524, vacc_quarter, \"Quarter\")\ntab_weekday        &lt;- create_tab(vacc_1524, vacc_weekday, \"Weekday\")\n\n# .................. Combine all tables ..................\ntab_combined &lt;- bind_rows(tab_sex, tab_age, tab_marital_status, tab_year, tab_quarter, tab_weekday)\n\n# .................. Calculate row-wise percentages (skip for Missing) ..................\ntab_combined &lt;- tab_combined %&gt;%\n  rowwise() %&gt;%\n  mutate(\n    Total = sum(`Respiratory vaccines`, `Childhood vaccines`, Other, na.rm = TRUE),\n    is_missing = trimws(tolower(Label)) == \"missing\",\n    \n    Respiratory = ifelse(is_missing,\n                         comma(`Respiratory vaccines`),\n                         paste0(comma(`Respiratory vaccines`), \" (\", round(100 * `Respiratory vaccines` / Total, 1), \")\")),\n    \n    Childhood = ifelse(is_missing,\n                       comma(`Childhood vaccines`),\n                       paste0(comma(`Childhood vaccines`), \" (\", round(100 * `Childhood vaccines` / Total, 1), \")\")),\n    \n    Other_grp = ifelse(is_missing,\n                       comma(Other),\n                       paste0(comma(Other), \" (\", round(100 * Other / Total, 1), \")\"))\n  ) %&gt;%\n  ungroup() %&gt;%\n  select(Category, Label, Respiratory, Childhood, Other_grp)\n\n# .................. Show Category only once per group ..................\ntab_combined &lt;- tab_combined %&gt;%\n  group_by(Category) %&gt;%\n  mutate(Category = ifelse(row_number() == 1, Category, \"\")) %&gt;%\n  ungroup()\n\n# .................. Get total counts per vaccine group ..................\ntotals &lt;- vacc_1524 %&gt;%\n  count(vacc_group3) %&gt;%\n  deframe()\n\n# .................. Create flextable ..................\nft_vacc_summary &lt;- tab_combined %&gt;%\n  flextable() %&gt;%\n  set_header_labels(\n    Category = \"Variable type\",\n    Label = \"Values\",\n    Respiratory = \"Number (%)·µÉ\",\n    Childhood = \"Number (%)·µÉ\",\n    Other_grp = \"Number (%)·µÉ\"\n  ) %&gt;%\n  add_header_row(\n    values = c(\n      \"\", \"\",\n      paste0(\"Respiratory vaccines (N = \", format(totals[\"Respiratory vaccines\"], big.mark = \",\"), \")\"),\n      paste0(\"Childhood vaccines (N = \", format(totals[\"Childhood vaccines\"], big.mark = \",\"), \")\"),\n      paste0(\"Other (N = \", format(totals[\"Other\"], big.mark = \",\"), \")\")\n    )\n  ) %&gt;%\n  add_header_row(\n    values = c(\"Description\", \"Vaccination uptake\"),\n    colwidths = c(2, 3)\n  ) %&gt;%\n  theme_box() %&gt;%\n  set_table_properties(layout = \"autofit\", width = 1) %&gt;%\n  width(j = 1, width = 1.5) %&gt;%\n  width(j = 2, width = 2.5) %&gt;%\n  width(j = 3:5, width = 1.5) %&gt;%\n  align(align = \"justify\", part = \"all\") %&gt;%\n  border_remove() %&gt;%\n  border(part = \"header\", i = 1, border.top = fp_border(color = \"black\", width = 1)) %&gt;%\n  border(part = \"header\", i = 3, border.bottom = fp_border(color = \"black\", width = 1)) %&gt;%\n  border_inner_h(part = \"header\", border = fp_border(color = \"black\", width = 0.8)) %&gt;%\n  border_inner_h(part = \"body\", border = fp_border(color = \"black\", width = 0.8)) %&gt;%\n  border(part = \"body\", i = nrow(tab_combined), border.bottom = fp_border(color = \"black\", width = 1)) %&gt;%\n  \n  set_caption(\"Table: Vaccination uptake across service year, quarter, and weekday\") %&gt;%\n  footnote(i = 1, \n           value = as_paragraph(\"Vaccination proportions were calculated row-wise (i.e., by row).\"),\n           ref_symbols = \"·µÉ\", \n           part = \"header\")\n\n# .................. Show the table ..................\nft_vacc_summary\n\nDescription·µÉVaccination uptake·µÉRespiratory vaccines (N = 955)Childhood vaccines (N = 472)Other (N = 126)Variable typeValuesNumber (%)·µÉNumber (%)·µÉNumber (%)·µÉGenderFemale511 (64)233 (29.2)54 (6.8)Male444 (58.8)239 (31.7)72 (9.5)Age0-19250 (38.9)302 (47)90 (14)20-29150 (68.2)70 (31.8)0 (0)30-3947 (71.2)19 (28.8)0 (0)40-49142 (75.9)45 (24.1)0 (0)50-59112 (77.8)14 (9.7)18 (12.5)60-69149 (87.6)13 (7.6)8 (4.7)70+105 (84.7)9 (7.3)10 (8.1)Marital statusDivorced136 (83.4)15 (9.2)12 (7.4)Married289 (79)59 (16.1)18 (4.9)Single/widowed150 (79.4)33 (17.5)6 (3.2)Missing38036590Year201578 (51)56 (36.6)19 (12.4)201684 (60.4)47 (33.8)8 (5.8)201775 (54.7)52 (38)10 (7.3)201881 (53.6)52 (34.4)18 (11.9)201983 (51.6)60 (37.3)18 (11.2)202082 (59.9)44 (32.1)11 (8)2021223 (84.8)34 (12.9)6 (2.3)202288 (73.3)25 (20.8)7 (5.8)202387 (51.2)63 (37.1)20 (11.8)202474 (60.7)39 (32)9 (7.4)Quarter1253 (62.8)120 (29.8)30 (7.4)2220 (58.5)117 (31.1)39 (10.4)3295 (63.2)139 (29.8)33 (7.1)4187 (60.9)96 (31.3)24 (7.8)WeekdayFriday141 (78.3)31 (17.2)8 (4.4)Monday114 (64.4)49 (27.7)14 (7.9)Saturday160 (63.2)81 (32)12 (4.7)Sunday156 (56.3)100 (36.1)21 (7.6)Thursday167 (66)66 (26.1)20 (7.9)Tuesday108 (65.5)43 (26.1)14 (8.5)Wednesday109 (44)102 (41.1)37 (14.9)·µÉVaccination proportions were calculated row-wise (i.e., by row).\n\n# .................. Clean up ..................\nrm(tab_age, tab_sex, tab_marital_status, tab_year, tab_quarter, tab_weekday, \n   tab_combined, ft_vacc_summary, totals, create_tab)"
  },
  {
    "objectID": "Post_Blog/Table automation and Ideas.html#all-lines-visible",
    "href": "Post_Blog/Table automation and Ideas.html#all-lines-visible",
    "title": "Automating Publication-Ready Tables in R",
    "section": "1.7 7. All Lines Visible",
    "text": "1.7 7. All Lines Visible\nThis version includes both horizontal and vertical grid lines, mimicking Excel-style tables.\nüìä When to use: When presenting detailed tables where structure must be visually enforced.\nüì¶ Applicability: Regulatory reports, appendices, or complex data breakdowns.\n\n# ------------6. Lines: All Lines Visible-------------------------------------------\n\n# .................. Convert grouping vars to character ..................\nvacc_1524 &lt;- vacc_1524 %&gt;%\n  mutate(across(c(age_group, gender, marital_status,\n                  vacc_service_year, vacc_quarter, vacc_weekday), as.character))\n\n# .................. Table generation function with Missing ..................\ncreate_tab &lt;- function(data, var, label) {\n  tab_main &lt;- data %&gt;%\n    filter(!is.na({{ var }})) %&gt;%\n    tabyl({{ var }}, vacc_group3) %&gt;%\n    mutate(Category = label, .before = 1) %&gt;%\n    rename(Label = {{ var }}) %&gt;%\n    mutate(Label = as.character(Label))\n  \n  na_count &lt;- sum(is.na(pull(data, {{ var }})))\n  \n  if (na_count &gt; 0) {\n    missing_row &lt;- tibble(\n      Category = label,\n      Label = \"Missing\",\n      `Respiratory vaccines` = sum(data$vacc_group3 == \"Respiratory vaccines\" & is.na(pull(data, {{ var }})), na.rm = TRUE),\n      `Childhood vaccines` = sum(data$vacc_group3 == \"Childhood vaccines\" & is.na(pull(data, {{ var }})), na.rm = TRUE),\n      Other = sum(data$vacc_group3 == \"Other\" & is.na(pull(data, {{ var }})), na.rm = TRUE)\n    )\n    tab_final &lt;- bind_rows(tab_main, missing_row)\n  } else {\n    tab_final &lt;- tab_main\n  }\n  \n  return(tab_final)\n}\n\n# .................. Create summary tables ..................\ntab_age            &lt;- create_tab(vacc_1524, age_group, \"Age\")\ntab_sex            &lt;- create_tab(vacc_1524, gender, \"Gender\")\ntab_marital_status &lt;- create_tab(vacc_1524, marital_status, \"Marital status\")\ntab_year           &lt;- create_tab(vacc_1524, vacc_service_year, \"Year\")\ntab_quarter        &lt;- create_tab(vacc_1524, vacc_quarter, \"Quarter\")\ntab_weekday        &lt;- create_tab(vacc_1524, vacc_weekday, \"Weekday\")\n\n# .................. Combine all tables ..................\ntab_combined &lt;- bind_rows(tab_sex, tab_age, tab_marital_status, tab_year, tab_quarter, tab_weekday)\n\n# .................. Calculate row-wise percentages (skip for Missing) ..................\ntab_combined &lt;- tab_combined %&gt;%\n  rowwise() %&gt;%\n  mutate(\n    Total = sum(`Respiratory vaccines`, `Childhood vaccines`, Other, na.rm = TRUE),\n    is_missing = trimws(tolower(Label)) == \"missing\",\n    \n    Respiratory = ifelse(is_missing,\n                         comma(`Respiratory vaccines`),\n                         paste0(comma(`Respiratory vaccines`), \" (\", round(100 * `Respiratory vaccines` / Total, 1), \")\")),\n    \n    Childhood = ifelse(is_missing,\n                       comma(`Childhood vaccines`),\n                       paste0(comma(`Childhood vaccines`), \" (\", round(100 * `Childhood vaccines` / Total, 1), \")\")),\n    \n    Other_grp = ifelse(is_missing,\n                       comma(Other),\n                       paste0(comma(Other), \" (\", round(100 * Other / Total, 1), \")\"))\n  ) %&gt;%\n  ungroup() %&gt;%\n  select(Category, Label, Respiratory, Childhood, Other_grp)\n\n# .................. Show Category only once per group ..................\ntab_combined &lt;- tab_combined %&gt;%\n  group_by(Category) %&gt;%\n  mutate(Category = ifelse(row_number() == 1, Category, \"\")) %&gt;%\n  ungroup()\n\n# .................. Get total counts per vaccine group ..................\ntotals &lt;- vacc_1524 %&gt;%\n  count(vacc_group3) %&gt;%\n  deframe()\n\n# .................. Create flextable ..................\nft_vacc_summary &lt;- tab_combined %&gt;%\n  flextable() %&gt;%\n  set_header_labels(\n    Category = \"Variable type\",\n    Label = \"Values\",\n    Respiratory = \"Number (%)·µÉ\",\n    Childhood = \"Number (%)·µÉ\",\n    Other_grp = \"Number (%)·µÉ\"\n  ) %&gt;%\n  add_header_row(\n    values = c(\n      \"\", \"\",\n      paste0(\"Respiratory vaccines (N = \", format(totals[\"Respiratory vaccines\"], big.mark = \",\"), \")\"),\n      paste0(\"Childhood vaccines (N = \", format(totals[\"Childhood vaccines\"], big.mark = \",\"), \")\"),\n      paste0(\"Other (N = \", format(totals[\"Other\"], big.mark = \",\"), \")\")\n    )\n  ) %&gt;%\n  add_header_row(\n    values = c(\"Description\", \"Vaccination uptake\"),\n    colwidths = c(2, 3)\n  ) %&gt;%\n  theme_box() %&gt;%\n  set_table_properties(layout = \"autofit\", width = 1) %&gt;%\n  width(j = 1, width = 1.5) %&gt;%\n  width(j = 2, width = 2.5) %&gt;%\n  width(j = 3:5, width = 1.5) %&gt;%\n  align(align = \"justify\", part = \"all\") %&gt;%\n  border_inner_h(border = fp_border(color = \"black\", width = 1)) %&gt;%\n  set_caption(\"Table: Vaccination uptake across service year, quarter, and weekday\") %&gt;%\n  footnote(i = 1, \n           value = as_paragraph(\"Vaccination proportions were calculated row-wise (i.e., by row).\"),\n           ref_symbols = \"·µÉ\", \n           part = \"header\")\n\n# .................. Show the table ..................\nft_vacc_summary\n\nDescription·µÉVaccination uptake·µÉRespiratory vaccines (N = 955)Childhood vaccines (N = 472)Other (N = 126)Variable typeValuesNumber (%)·µÉNumber (%)·µÉNumber (%)·µÉGenderFemale511 (64)233 (29.2)54 (6.8)Male444 (58.8)239 (31.7)72 (9.5)Age0-19250 (38.9)302 (47)90 (14)20-29150 (68.2)70 (31.8)0 (0)30-3947 (71.2)19 (28.8)0 (0)40-49142 (75.9)45 (24.1)0 (0)50-59112 (77.8)14 (9.7)18 (12.5)60-69149 (87.6)13 (7.6)8 (4.7)70+105 (84.7)9 (7.3)10 (8.1)Marital statusDivorced136 (83.4)15 (9.2)12 (7.4)Married289 (79)59 (16.1)18 (4.9)Single/widowed150 (79.4)33 (17.5)6 (3.2)Missing38036590Year201578 (51)56 (36.6)19 (12.4)201684 (60.4)47 (33.8)8 (5.8)201775 (54.7)52 (38)10 (7.3)201881 (53.6)52 (34.4)18 (11.9)201983 (51.6)60 (37.3)18 (11.2)202082 (59.9)44 (32.1)11 (8)2021223 (84.8)34 (12.9)6 (2.3)202288 (73.3)25 (20.8)7 (5.8)202387 (51.2)63 (37.1)20 (11.8)202474 (60.7)39 (32)9 (7.4)Quarter1253 (62.8)120 (29.8)30 (7.4)2220 (58.5)117 (31.1)39 (10.4)3295 (63.2)139 (29.8)33 (7.1)4187 (60.9)96 (31.3)24 (7.8)WeekdayFriday141 (78.3)31 (17.2)8 (4.4)Monday114 (64.4)49 (27.7)14 (7.9)Saturday160 (63.2)81 (32)12 (4.7)Sunday156 (56.3)100 (36.1)21 (7.6)Thursday167 (66)66 (26.1)20 (7.9)Tuesday108 (65.5)43 (26.1)14 (8.5)Wednesday109 (44)102 (41.1)37 (14.9)·µÉVaccination proportions were calculated row-wise (i.e., by row).\n\n# .................. Clean up ..................\nrm(tab_age, tab_sex, tab_marital_status, tab_year, tab_quarter, tab_weekday, \n   tab_combined, ft_vacc_summary, totals, create_tab)"
  },
  {
    "objectID": "Post_Blog/Table automation and Ideas.html#font-formatting-colour-and-font-options",
    "href": "Post_Blog/Table automation and Ideas.html#font-formatting-colour-and-font-options",
    "title": "Automating Publication-Ready Tables in R",
    "section": "1.8 8. Font Formatting: Colour and Font Options",
    "text": "1.8 8. Font Formatting: Colour and Font Options\nHere, I demonstrate how to:\n\nSet font types (e.g., Times New Roman)\nControl font size\nApply alternating row colors and header backgrounds\n\nüé® Why this is valuable:\n\nEnhances visual appeal and professionalism.\nAligns with publication or organizational branding requirements.\nBest for: Reports to stakeholders, executive summaries, or printed materials.\n\n\n# ------------ 7. Font Formating: Colour and Font type options adding in the Table -------------------------------------------\n\nlibrary(dplyr)\nlibrary(janitor)\nlibrary(tibble)\nlibrary(scales)\nlibrary(flextable)\n\n# .................. Convert grouping vars to character ..................\nvacc_1524 &lt;- vacc_1524 %&gt;%\n  mutate(across(c(age_group, gender, marital_status,\n                  vacc_service_year, vacc_quarter, vacc_weekday), as.character))\n\n# .................. Table generation function with Missing ..................\ncreate_tab &lt;- function(data, var, label) {\n  tab_main &lt;- data %&gt;%\n    filter(!is.na({{ var }})) %&gt;%\n    tabyl({{ var }}, vacc_group3) %&gt;%\n    mutate(Category = label, .before = 1) %&gt;%\n    rename(Label = {{ var }}) %&gt;%\n    mutate(Label = as.character(Label))\n  \n  na_count &lt;- sum(is.na(pull(data, {{ var }})))\n  \n  if (na_count &gt; 0) {\n    missing_row &lt;- tibble(\n      Category = label,\n      Label = \"Missing\",\n      `Respiratory vaccines` = sum(data$vacc_group3 == \"Respiratory vaccines\" & is.na(pull(data, {{ var }})), na.rm = TRUE),\n      `Childhood vaccines` = sum(data$vacc_group3 == \"Childhood vaccines\" & is.na(pull(data, {{ var }})), na.rm = TRUE),\n      Other = sum(data$vacc_group3 == \"Other\" & is.na(pull(data, {{ var }})), na.rm = TRUE)\n    )\n    tab_final &lt;- bind_rows(tab_main, missing_row)\n  } else {\n    tab_final &lt;- tab_main\n  }\n  \n  return(tab_final)\n}\n\n# .................. Create summary tables ..................\ntab_age            &lt;- create_tab(vacc_1524, age_group, \"Age\")\ntab_sex            &lt;- create_tab(vacc_1524, gender, \"Gender\")\ntab_marital_status &lt;- create_tab(vacc_1524, marital_status, \"Marital status\")\ntab_year           &lt;- create_tab(vacc_1524, vacc_service_year, \"Year\")\ntab_quarter        &lt;- create_tab(vacc_1524, vacc_quarter, \"Quarter\")\ntab_weekday        &lt;- create_tab(vacc_1524, vacc_weekday, \"Weekday\")\n\n# .................. Combine all tables ..................\ntab_combined &lt;- bind_rows(tab_sex, tab_age, tab_marital_status, tab_year, tab_quarter, tab_weekday)\n\n# .................. Calculate row-wise percentages (skip for Missing) ..................\ntab_combined &lt;- tab_combined %&gt;%\n  rowwise() %&gt;%\n  mutate(\n    Total = sum(`Respiratory vaccines`, `Childhood vaccines`, Other, na.rm = TRUE),\n    is_missing = trimws(tolower(Label)) == \"missing\",\n    \n    Respiratory = ifelse(is_missing,\n                         comma(`Respiratory vaccines`),\n                         paste0(comma(`Respiratory vaccines`), \" (\", round(100 * `Respiratory vaccines` / Total, 1), \")\")),\n    \n    Childhood = ifelse(is_missing,\n                       comma(`Childhood vaccines`),\n                       paste0(comma(`Childhood vaccines`), \" (\", round(100 * `Childhood vaccines` / Total, 1), \")\")),\n    \n    Other_grp = ifelse(is_missing,\n                       comma(Other),\n                       paste0(comma(Other), \" (\", round(100 * Other / Total, 1), \")\"))\n  ) %&gt;%\n  ungroup() %&gt;%\n  select(Category, Label, Respiratory, Childhood, Other_grp)\n\n# .................. Show Category only once per group ..................\ntab_combined &lt;- tab_combined %&gt;%\n  group_by(Category) %&gt;%\n  mutate(Category = ifelse(row_number() == 1, Category, \"\")) %&gt;%\n  ungroup()\n\n# .................. Get total counts per vaccine group ..................\ntotals &lt;- vacc_1524 %&gt;%\n  count(vacc_group3) %&gt;%\n  deframe()\n\n\nft_vacc_summary &lt;- tab_combined %&gt;%\n  flextable() %&gt;%\n  set_header_labels(\n    Category = \"Variable type\",\n    Label = \"Values\",\n    Respiratory = \"Number (%)·µÉ\",\n    Childhood = \"Number (%)·µÉ\",\n    Other_grp = \"Number (%)·µÉ\"\n  ) %&gt;%\n  add_header_row(\n    values = c(\n      \"\", \"\",\n      paste0(\"Respiratory vaccines (N = \", format(totals[\"Respiratory vaccines\"], big.mark = \",\"), \")\"),\n      paste0(\"Childhood vaccines (N = \", format(totals[\"Childhood vaccines\"], big.mark = \",\"), \")\"),\n      paste0(\"Other (N = \", format(totals[\"Other\"], big.mark = \",\"), \")\")\n    )\n  ) %&gt;%\n  add_header_row(\n    values = c(\"Description\", \"Vaccination uptake\"),\n    colwidths = c(2, 3)\n  ) %&gt;%\n  theme_box() %&gt;%\n  set_table_properties(layout = \"autofit\", width = 1) %&gt;%\n  width(j = 1, width = 1.5) %&gt;%\n  width(j = 2, width = 2.5) %&gt;%\n  width(j = 3:5, width = 1.5) %&gt;%\n  align(align = \"justify\", part = \"all\") %&gt;%\n  border_remove() %&gt;%\n  border(part = \"header\", i = 1, border.top = fp_border(color = \"black\", width = 1)) %&gt;%\n  border(part = \"header\", i = 3, border.bottom = fp_border(color = \"black\", width = 1)) %&gt;%\n  border_inner_h(part = \"header\", border = fp_border(color = \"black\", width = 0.8)) %&gt;%\n  border_inner_h(part = \"body\", border = fp_border(color = \"black\", width = 0.8)) %&gt;%\n  border(part = \"body\", i = nrow(tab_combined), border.bottom = fp_border(color = \"black\", width = 1)) %&gt;%\n  \n  set_caption(as_paragraph(as_chunk(\"Table: Vaccination uptake across service year, quarter, and weekday\",\n                                    props = fp_text(font.size = 14, font.family = \"Times New Roman\", bold = FALSE)))) %&gt;%\n  fontsize(part = \"header\", size = 12) %&gt;%\n  fontsize(part = \"body\", size = 11) %&gt;%\n  fontsize(part = \"footer\", size = 10) %&gt;%\n  font(part = \"all\", fontname = \"Times New Roman\") %&gt;%\n  bg(part = \"header\", bg = \"lightblue\") %&gt;%\n  bg(j = 1:5, i = seq(1, nrow(tab_combined), 2), bg = \"lightgray\") %&gt;%\n  bg(j = 1:5, i = seq(2, nrow(tab_combined), 2), bg = \"red\") %&gt;%\n  footnote(i = 1, \n           value = as_paragraph(\"Vaccination proportions were calculated row-wise (i.e., by row).\"),\n           ref_symbols = \"·µÉ\", \n           part = \"header\")\n\n\n# .................. Show the table ..................\nft_vacc_summary\n\nDescription·µÉVaccination uptake·µÉRespiratory vaccines (N = 955)Childhood vaccines (N = 472)Other (N = 126)Variable typeValuesNumber (%)·µÉNumber (%)·µÉNumber (%)·µÉGenderFemale511 (64)233 (29.2)54 (6.8)Male444 (58.8)239 (31.7)72 (9.5)Age0-19250 (38.9)302 (47)90 (14)20-29150 (68.2)70 (31.8)0 (0)30-3947 (71.2)19 (28.8)0 (0)40-49142 (75.9)45 (24.1)0 (0)50-59112 (77.8)14 (9.7)18 (12.5)60-69149 (87.6)13 (7.6)8 (4.7)70+105 (84.7)9 (7.3)10 (8.1)Marital statusDivorced136 (83.4)15 (9.2)12 (7.4)Married289 (79)59 (16.1)18 (4.9)Single/widowed150 (79.4)33 (17.5)6 (3.2)Missing38036590Year201578 (51)56 (36.6)19 (12.4)201684 (60.4)47 (33.8)8 (5.8)201775 (54.7)52 (38)10 (7.3)201881 (53.6)52 (34.4)18 (11.9)201983 (51.6)60 (37.3)18 (11.2)202082 (59.9)44 (32.1)11 (8)2021223 (84.8)34 (12.9)6 (2.3)202288 (73.3)25 (20.8)7 (5.8)202387 (51.2)63 (37.1)20 (11.8)202474 (60.7)39 (32)9 (7.4)Quarter1253 (62.8)120 (29.8)30 (7.4)2220 (58.5)117 (31.1)39 (10.4)3295 (63.2)139 (29.8)33 (7.1)4187 (60.9)96 (31.3)24 (7.8)WeekdayFriday141 (78.3)31 (17.2)8 (4.4)Monday114 (64.4)49 (27.7)14 (7.9)Saturday160 (63.2)81 (32)12 (4.7)Sunday156 (56.3)100 (36.1)21 (7.6)Thursday167 (66)66 (26.1)20 (7.9)Tuesday108 (65.5)43 (26.1)14 (8.5)Wednesday109 (44)102 (41.1)37 (14.9)·µÉVaccination proportions were calculated row-wise (i.e., by row).\n\n# .................. Clean up all new objects ..................\nrm(tab_age, tab_sex, tab_marital_status, tab_year, tab_quarter, tab_weekday, \n   tab_combined, ft_vacc_summary, totals, create_tab)"
  },
  {
    "objectID": "Post_Blog/Table automation and Ideas.html#rowwise-tables-summary",
    "href": "Post_Blog/Table automation and Ideas.html#rowwise-tables-summary",
    "title": "Automating Publication-Ready Tables in R",
    "section": "1.9 9. Rowwise Tables (Summary)",
    "text": "1.9 9. Rowwise Tables (Summary)\nThis is not a new table‚Äîrather, it‚Äôs a conceptual summary of the row-wise percentage approaches applied in earlier sections.\nImportance:\n\nPercentages sum to 100% per row, highlighting within-group distributions.\n\nImplications:\n\nAnswers: ‚ÄúWithin age group X, what % received each vaccine?‚Äù"
  },
  {
    "objectID": "Post_Blog/Table automation and Ideas.html#columnwise-tables",
    "href": "Post_Blog/Table automation and Ideas.html#columnwise-tables",
    "title": "Automating Publication-Ready Tables in R",
    "section": "1.10 10. Columnwise Tables",
    "text": "1.10 10. Columnwise Tables\nThis version calculates percentages down each vaccine group column, rather than across each row.\nImportance:\n\nPercentages sum to 100% per column, showing group contributions to totals.\n\nImplications:\n\nAnswers: ‚ÄúAmong Respiratory vaccines, what % are from age group X?‚Äù\nUse this when: You want to know, for example, what percentage of all Respiratory vaccine users were aged below 25 years.\n\n\n# ------------ 10. Columnwise Tables -------------------------------------------\n\n# Prepare Vaccination Uptake Table (All Variables Using Column Percentages)\n\n# --- Convert selected variables to character type for proper label handling ---\nvacc_1524 &lt;- vacc_1524 %&gt;%\n  mutate(across(c(gender, age_3group, marital_2group, year_3group, vacc_quarter, race_grouped), as.character))\n\n# --- Create general table-building function with optional column percentage flag ---\n# This function creates a summary count table of vaccination type by a categorical variable.\n# If use_col_percentage is TRUE, the summary will support column-based percentage formatting.\ncreate_tab &lt;- function(data, var, label, use_col_percentage = TRUE) {\n  tab_main &lt;- data %&gt;%\n    filter(!is.na({{ var }})) %&gt;%\n    tabyl({{ var }}, vacc_group3) %&gt;%\n    mutate(Category = label, .before = 1) %&gt;%\n    rename(Label = {{ var }}) %&gt;%\n    mutate(Label = as.character(Label))\n  \n  # Add a row for \"Unknown\" if missing values are found\n  na_count &lt;- sum(is.na(pull(data, {{ var }})))\n  if (na_count &gt; 0) {\n    na_row &lt;- tibble(\n      Category = label,\n      Label = \"Unknown\",\n      `Respiratory vaccines` = sum(data$vacc_group3 == \"Respiratory vaccines\" & is.na(pull(data, {{ var }})), na.rm = TRUE),\n      `Childhood vaccines` = sum(data$vacc_group3 == \"Childhood vaccines\" & is.na(pull(data, {{ var }})), na.rm = TRUE),\n      Other = sum(data$vacc_group3 == \"Other\" & is.na(pull(data, {{ var }})), na.rm = TRUE)\n    )\n    tab_combined &lt;- bind_rows(tab_main, na_row)\n  } else {\n    tab_combined &lt;- tab_main\n  }\n  \n  tab_combined %&gt;%\n    mutate(use_col_percentage = use_col_percentage)\n}\n\n# --- Generate summary tables for each variable using column percentages ---\ntab_gender    &lt;- create_tab(vacc_1524, gender, \"Gender\")\ntab_age       &lt;- create_tab(vacc_1524, age_3group, \"Age group\")\ntab_marital   &lt;- create_tab(vacc_1524, marital_2group, \"Marital status·µá\")\ntab_year      &lt;- create_tab(vacc_1524, year_3group, \"Year group\")\ntab_quarter   &lt;- create_tab(vacc_1524, vacc_quarter, \"Quarter\")\ntab_race      &lt;- create_tab(vacc_1524, race_grouped, \"Race group\")\n\n# --- Combine all variable-level tables into one ---\ntab_combined &lt;- bind_rows(\n  tab_gender, tab_age, tab_marital,\n  tab_year, tab_quarter, tab_race\n)\n\n# --- Calculate percentages and format values into strings with \"Number (%)\" ---\ntab_combined &lt;- tab_combined %&gt;%\n  group_by(Category) %&gt;%\n  mutate(\n    use_col = TRUE,  # column percentages applied uniformly\n    \n    # Calculate denominators excluding \"Unknown\"\n    Total_Resp = sum(`Respiratory vaccines`[Label != \"Unknown\"], na.rm = TRUE),\n    Total_Child = sum(`Childhood vaccines`[Label != \"Unknown\"], na.rm = TRUE),\n    Total_Other = sum(Other[Label != \"Unknown\"], na.rm = TRUE),\n    \n    # Calculate percentages\n    Resp_prop = ifelse(Label != \"Unknown\", round(100 * `Respiratory vaccines` / Total_Resp, 1), NA),\n    Child_prop = ifelse(Label != \"Unknown\", round(100 * `Childhood vaccines` / Total_Child, 1), NA),\n    Other_prop = ifelse(Label != \"Unknown\", round(100 * Other / Total_Other, 1), NA),\n    \n    # Format final output as \"number (percentage)\"\n    Respiratory = ifelse(is.na(Resp_prop),\n                         paste0(comma(`Respiratory vaccines`)),\n                         paste0(comma(`Respiratory vaccines`), \" (\", Resp_prop, \")\")),\n    Childhood = ifelse(is.na(Child_prop),\n                       paste0(comma(`Childhood vaccines`)),\n                       paste0(comma(`Childhood vaccines`), \" (\", Child_prop, \")\")),\n    Other_grp = ifelse(is.na(Other_prop),\n                       paste0(comma(Other)),\n                       paste0(comma(Other), \" (\", Other_prop, \")\"))\n  ) %&gt;%\n  ungroup()\n\n# --- Final clean-up: labels, superscripts, and hiding \"0 (0)\" from Unknown row ---\ntab_combined &lt;- tab_combined %&gt;%\n  mutate(\n    Label = ifelse(Label == \"Other\", \"Other·∂ú\", Label),\n    Respiratory = ifelse(Label == \"Unknown\" & `Respiratory vaccines` == 0, \"\", Respiratory),\n    Childhood   = ifelse(Label == \"Unknown\" & `Childhood vaccines` == 0, \"\", Childhood),\n    Other_grp   = ifelse(Label == \"Unknown\" & Other == 0, \"\", Other_grp)\n  ) %&gt;%\n  group_by(Category) %&gt;%\n  mutate(Category = ifelse(row_number() == 1, Category, \"\")) %&gt;%\n  ungroup() %&gt;%\n  select(Category, Label, Respiratory, Childhood, Other_grp)\n\n# --- Get total N for each vaccine group to display in header ---\ntotals &lt;- table(vacc_1524$vacc_group3)\ntotal_resp &lt;- totals[\"Respiratory vaccines\"]\ntotal_child &lt;- totals[\"Childhood vaccines\"]\ntotal_other &lt;- totals[\"Other\"]\n\n# --- Build flextable for formatted presentation ---\ntable_vacc_summary &lt;- flextable(tab_combined) %&gt;%\n  set_header_labels(\n    Category = \"Variable type\",\n    Label = \"Values\",\n    Respiratory = \"Number (%)·µÉ\",\n    Childhood = \"Number (%)·µÉ\",\n    Other_grp = \"Number (%)·µÉ\"\n  ) %&gt;%\n  add_header_row(\n    values = c(\"\", \"\",\n               paste0(\"Respiratory vaccines (N = \", format(total_resp, big.mark = \",\"), \")\"),\n               paste0(\"Childhood vaccines (N = \", format(total_child, big.mark = \",\"), \")\"),\n               paste0(\"Other (N = \", format(total_other, big.mark = \",\"), \")\")),\n    colwidths = c(1, 1, 1, 1, 1),\n    top = TRUE\n  ) %&gt;%\n  add_header_row(\n    values = c(\"Description\", \"Vaccination uptake\"),\n    colwidths = c(2, 3),\n    top = TRUE\n  ) %&gt;%\n  theme_box() %&gt;%\n  set_table_properties(layout = \"autofit\", width = 1) %&gt;%\n  width(j = 1, width = 1.5) %&gt;%\n  width(j = 2, width = 2.5) %&gt;%\n  width(j = 3:5, width = 1.5) %&gt;%\n  align(align = \"justify\", part = \"all\") %&gt;%\n  border_remove() %&gt;%\n  border(part = \"header\", i = 1, border.top = fp_border(color = \"black\", width = 1)) %&gt;%\n  border(part = \"header\", i = 3, border.bottom = fp_border(color = \"black\", width = 1)) %&gt;%\n  border_inner_h(part = \"header\", border = fp_border(color = \"black\", width = 0.8)) %&gt;%\n  border_inner_h(part = \"body\", border = fp_border(color = \"black\", width = 0.8)) %&gt;%\n  border(part = \"body\", i = nrow(tab_combined), border.bottom = fp_border(color = \"black\", width = 1)) %&gt;%\n  set_caption(as_paragraph(as_chunk(\n    \"Table xx: Column-percentage summary of vaccination uptake across all demographic variables, 2015‚Äì2024.\",\n    props = fp_text(font.size = 12, font.family = \"Times New Roman\", bold = FALSE)\n  ))) %&gt;%\n  add_footer_lines(values = c(\n    \"·µÉ Vaccination proportions were calculated using column percentages for all variables.\",\n    \"·µá Marital status was grouped into two: partnered (married) and not-partnered (divorced, widowed, single).\",\n    \"·∂ú Other race refers to those identifying as native or other racial groups.\"\n  )) %&gt;%\n  fontsize(part = \"header\", size = 12) %&gt;%\n  fontsize(part = \"body\", size = 11) %&gt;%\n  fontsize(part = \"footer\", size = 10) %&gt;%\n  font(part = \"all\", fontname = \"Times New Roman\") %&gt;%\n  color(part = \"header\", color = \"white\") %&gt;%\n  bg(part = \"header\", bg = \"black\") %&gt;%\n  bg(j = 1:5, i = seq(2, nrow(tab_combined), 2), bg = \"white\") %&gt;%\n  bold(j = 1, part = \"body\")\n\n# --- Display final table ---\ntable_vacc_summary\n\nDescriptionVaccination uptakeRespiratory vaccines (N = 955)Childhood vaccines (N = 472)Other (N = 126)Variable typeValuesNumber (%)·µÉNumber (%)·µÉNumber (%)·µÉGenderFemale511 (53.5)233 (49.4)54 (42.9)Male444 (46.5)239 (50.6)72 (57.1)Age group&lt;25332 (34.8)337 (71.4)90 (71.4)25-3498 (10.3)51 (10.8)0 (0)35+525 (55)84 (17.8)36 (28.6)Marital status·µáNot partnered286 (49.7)48 (44.9)18 (50)Partnered289 (50.3)59 (55.1)18 (50)Unknown38036590Year group‚â§2020483 (50.6)311 (65.9)84 (66.7)2021-2022311 (32.6)59 (12.5)13 (10.3)2023+161 (16.9)102 (21.6)29 (23)Quarter1253 (26.5)120 (25.4)30 (23.8)2220 (23)117 (24.8)39 (31)3295 (30.9)139 (29.4)33 (26.2)4187 (19.6)96 (20.3)24 (19)Race groupAsian69 (7.8)33 (7.3)9 (7.3)Other·∂ú28 (3.2)13 (2.9)1 (0.8)White788 (89)404 (89.8)114 (91.9)Unknown70222·µÉ Vaccination proportions were calculated using column percentages for all variables.·µá Marital status was grouped into two: partnered (married) and not-partnered (divorced, widowed, single).·∂ú Other race refers to those identifying as native or other racial groups.\n\n# --- Clean up temporary variables (optional good practice) ---\nrm(\n  tab_gender, tab_age, tab_marital, tab_year, tab_quarter, tab_race,\n  tab_combined, create_tab, totals, total_resp, total_child, total_other\n)"
  },
  {
    "objectID": "Post_Blog/Table automation and Ideas.html#columnwise-tables-with-na-values",
    "href": "Post_Blog/Table automation and Ideas.html#columnwise-tables-with-na-values",
    "title": "Automating Publication-Ready Tables in R",
    "section": "1.11 11. Columnwise Tables with NA values",
    "text": "1.11 11. Columnwise Tables with NA values\nColumnwise percentage table including NA where applicable - All variables use column percentages (i.e., % down each vaccine group column) - NA values are shown only where relevant (e.g., race group for Respiratory vaccines) - ‚ÄúUnknown‚Äù variable categories are excluded from percentage calculations to maintain ~100% totals per column - Useful for subgroup summaries where not all variables apply across all vaccine type\n\n# ------------ 11. Columnwise Tables with NA values-------------------------------------------\n\n# Prepare Vaccination Uptake Table (All Variables Using Column Percentages)\n# ....................................................................................................\n\n# --- Set working directory and load data (if needed) ---\n# setwd(\"C:/Users/User/Desktop/Materials_ Course and proposals/Course Related/DataCamp/Data/\")\n# load(\"Vaccination_uptake.RDATA\")\n\n# --- Clean and prepare datasets ---\nvacc_1524 &lt;- vacc_1524 %&gt;%\n  mutate(across(c(gender, age_3group, marital_2group, year_3group, vacc_quarter, race_grouped), as.character))\n\n# Subset data for Respiratory vaccines to calculate column-based percentages (used for race)\nrespiratory_vaccines &lt;- vacc_1524 %&gt;%\n  filter(vacc_group3 == \"Respiratory vaccines\") %&gt;%\n  mutate(across(race_grouped, as.character))\n\n# --- General table builder ---\ncreate_tab &lt;- function(data, var, label, use_col_percentage = TRUE) {\n  tab_main &lt;- data %&gt;%\n    filter(!is.na({{ var }})) %&gt;%\n    tabyl({{ var }}, vacc_group3) %&gt;%\n    mutate(Category = label, .before = 1) %&gt;%\n    rename(Label = {{ var }}) %&gt;%\n    mutate(Label = as.character(Label))\n  \n  na_count &lt;- sum(is.na(pull(data, {{ var }})))\n  if (na_count &gt; 0) {\n    na_row &lt;- tibble(\n      Category = label,\n      Label = \"Unknown\",\n      `Respiratory vaccines` = sum(data$vacc_group3 == \"Respiratory vaccines\" & is.na(pull(data, {{ var }})), na.rm = TRUE),\n      `Childhood vaccines` = sum(data$vacc_group3 == \"Childhood vaccines\" & is.na(pull(data, {{ var }})), na.rm = TRUE),\n      Other = sum(data$vacc_group3 == \"Other\" & is.na(pull(data, {{ var }})), na.rm = TRUE)\n    )\n    tab_combined &lt;- bind_rows(tab_main, na_row)\n  } else {\n    tab_combined &lt;- tab_main\n  }\n  \n  tab_combined %&gt;%\n    mutate(use_col_percentage = use_col_percentage)\n}\n\n# --- Create summary tables ---\ntab_gender    &lt;- create_tab(vacc_1524, gender, \"Gender\")\ntab_age       &lt;- create_tab(vacc_1524, age_3group, \"Age group\")\ntab_marital   &lt;- create_tab(vacc_1524, marital_2group, \"Marital status·µá\")\ntab_year      &lt;- create_tab(vacc_1524, year_3group, \"Year group\")\ntab_quarter   &lt;- create_tab(vacc_1524, vacc_quarter, \"Quarter\")\n\n# Race group from respiratory-only subset (denominator = respiratory group only)\ntab_race      &lt;- create_tab(respiratory_vaccines, race_grouped, \"Race group\")\n\n# --- Combine all tables ---\ntab_combined &lt;- bind_rows(\n  tab_gender, tab_age, tab_marital,\n  tab_year, tab_quarter, tab_race\n)\n\n# --- Calculate and format column percentages ---\ntab_combined &lt;- tab_combined %&gt;%\n  group_by(Category) %&gt;%\n  mutate(\n    use_col = TRUE,\n    Total_Resp = sum(`Respiratory vaccines`[Label != \"Unknown\"], na.rm = TRUE),\n    Total_Child = sum(`Childhood vaccines`[Label != \"Unknown\"], na.rm = TRUE),\n    Total_Other = sum(Other[Label != \"Unknown\"], na.rm = TRUE),\n    \n    Resp_prop = ifelse(Label != \"Unknown\", round(100 * `Respiratory vaccines` / Total_Resp, 1), NA),\n    Child_prop = ifelse(Label != \"Unknown\", round(100 * `Childhood vaccines` / Total_Child, 1), NA),\n    Other_prop = ifelse(Label != \"Unknown\", round(100 * Other / Total_Other, 1), NA),\n    \n    Respiratory = ifelse(is.na(Resp_prop),\n                         paste0(comma(`Respiratory vaccines`)),\n                         paste0(comma(`Respiratory vaccines`), \" (\", Resp_prop, \")\")),\n    Childhood = ifelse(is.na(Child_prop),\n                       paste0(comma(`Childhood vaccines`)),\n                       paste0(comma(`Childhood vaccines`), \" (\", Child_prop, \")\")),\n    Other_grp = ifelse(is.na(Other_prop),\n                       paste0(comma(Other)),\n                       paste0(comma(Other), \" (\", Other_prop, \")\"))\n  ) %&gt;%\n  ungroup()\n\n# --- Format labels and rows ---\ntab_combined &lt;- tab_combined %&gt;%\n  mutate(\n    Label = ifelse(Label == \"Other\", \"Other·∂ú\", Label),\n    Respiratory = ifelse(Label == \"Unknown\" & `Respiratory vaccines` == 0, \"\", Respiratory),\n    Childhood   = ifelse(Label == \"Unknown\" & `Childhood vaccines` == 0, \"\", Childhood),\n    Other_grp   = ifelse(Label == \"Unknown\" & Other == 0, \"\", Other_grp)\n  ) %&gt;%\n  group_by(Category) %&gt;%\n  mutate(Category = ifelse(row_number() == 1, Category, \"\")) %&gt;%\n  ungroup() %&gt;%\n  select(Category, Label, Respiratory, Childhood, Other_grp)\n\n# --- Prepare column Ns for header ---\ntotals &lt;- table(vacc_1524$vacc_group3)\ntotal_resp &lt;- totals[\"Respiratory vaccines\"]\ntotal_child &lt;- totals[\"Childhood vaccines\"]\ntotal_other &lt;- totals[\"Other\"]\n\n# --- Build Flextable ---\ntable_vacc_summary &lt;- flextable(tab_combined) %&gt;%\n  set_header_labels(\n    Category = \"Variable type\",\n    Label = \"Values\",\n    Respiratory = \"Number (%)·µÉ\",\n    Childhood = \"Number (%)·µÉ\",\n    Other_grp = \"Number (%)·µÉ\"\n  ) %&gt;%\n  add_header_row(\n    values = c(\"\", \"\",\n               paste0(\"Respiratory vaccines (N = \", format(total_resp, big.mark = \",\"), \")\"),\n               paste0(\"Childhood vaccines (N = \", format(total_child, big.mark = \",\"), \")\"),\n               paste0(\"Other (N = \", format(total_other, big.mark = \",\"), \")\")),\n    colwidths = c(1, 1, 1, 1, 1),\n    top = TRUE\n  ) %&gt;%\n  add_header_row(\n    values = c(\"Description\", \"Vaccination uptake\"),\n    colwidths = c(2, 3),\n    top = TRUE\n  ) %&gt;%\n  theme_box() %&gt;%\n  set_table_properties(layout = \"autofit\", width = 1) %&gt;%\n  width(j = 1, width = 1.5) %&gt;%\n  width(j = 2, width = 2.5) %&gt;%\n  width(j = 3:5, width = 1.5) %&gt;%\n  align(align = \"justify\", part = \"all\") %&gt;%\n  border_remove() %&gt;%\n  border(part = \"header\", i = 1, border.top = fp_border(color = \"black\", width = 1)) %&gt;%\n  border(part = \"header\", i = 3, border.bottom = fp_border(color = \"black\", width = 1)) %&gt;%\n  border_inner_h(part = \"header\", border = fp_border(color = \"black\", width = 0.8)) %&gt;%\n  border_inner_h(part = \"body\", border = fp_border(color = \"black\", width = 0.8)) %&gt;%\n  border(part = \"body\", i = nrow(tab_combined), border.bottom = fp_border(color = \"black\", width = 1)) %&gt;%\n  set_caption(as_paragraph(as_chunk(\n    \"Table xx: Column-percentage summary of vaccination uptake across all demographic variables, 2015‚Äì2024.\",\n    props = fp_text(font.size = 12, font.family = \"Times New Roman\", bold = FALSE)\n  ))) %&gt;%\n  add_footer_lines(values = c(\n    \"·µÉ Vaccination proportions were calculated using column percentages. Race group used respiratory vaccine subset only.\",\n    \"·µá Marital status was grouped into partnered (married) and non-partnered (single, divorced, widowed).\",\n    \"·∂ú 'Other' race includes native or other less represented racial identities.\"\n  )) %&gt;%\n  fontsize(part = \"header\", size = 12) %&gt;%\n  fontsize(part = \"body\", size = 11) %&gt;%\n  fontsize(part = \"footer\", size = 10) %&gt;%\n  font(part = \"all\", fontname = \"Times New Roman\") %&gt;%\n  color(part = \"header\", color = \"white\") %&gt;%\n  bg(part = \"header\", bg = \"#000000\") %&gt;%\n  bg(j = 1:5, i = seq(2, nrow(tab_combined), 2), bg = \"white\") %&gt;%\n  bold(j = 1, part = \"body\")\n\n# --- Display final table ---\ntable_vacc_summary\n\nDescriptionVaccination uptakeRespiratory vaccines (N = 955)Childhood vaccines (N = 472)Other (N = 126)Variable typeValuesNumber (%)·µÉNumber (%)·µÉNumber (%)·µÉGenderFemale511 (53.5)233 (49.4)54 (42.9)Male444 (46.5)239 (50.6)72 (57.1)Age group&lt;25332 (34.8)337 (71.4)90 (71.4)25-3498 (10.3)51 (10.8)0 (0)35+525 (55)84 (17.8)36 (28.6)Marital status·µáNot partnered286 (49.7)48 (44.9)18 (50)Partnered289 (50.3)59 (55.1)18 (50)Unknown38036590Year group‚â§2020483 (50.6)311 (65.9)84 (66.7)2021-2022311 (32.6)59 (12.5)13 (10.3)2023+161 (16.9)102 (21.6)29 (23)Quarter1253 (26.5)120 (25.4)30 (23.8)2220 (23)117 (24.8)39 (31)3295 (30.9)139 (29.4)33 (26.2)4187 (19.6)96 (20.3)24 (19)Race groupAsian69 (7.8)NANAOther·∂ú28 (3.2)NANAWhite788 (89)NANAUnknown70·µÉ Vaccination proportions were calculated using column percentages. Race group used respiratory vaccine subset only.·µá Marital status was grouped into partnered (married) and non-partnered (single, divorced, widowed).·∂ú 'Other' race includes native or other less represented racial identities.\n\n# --- Cleanup temporary objects ---\nrm(\n  tab_gender, tab_age, tab_marital, tab_year, tab_quarter, tab_race,\n  tab_combined, create_tab, totals, total_resp, total_child, total_other,\n  respiratory_vaccines\n)"
  },
  {
    "objectID": "Post_Blog/Table automation and Ideas.html#both-row-wise-and-column-wise-tables",
    "href": "Post_Blog/Table automation and Ideas.html#both-row-wise-and-column-wise-tables",
    "title": "Automating Publication-Ready Tables in R",
    "section": "1.12 12. Both Row wise and Column wise Tables",
    "text": "1.12 12. Both Row wise and Column wise Tables\nThis table presents both row and column percentages for vaccination uptake:\n\nRow percentages show how each category (e.g., age group, gender) distributes across vaccine types.\nColumn percentages are applied only to the race group, highlighting the demographic makeup within the respiratory vaccine recipients.\n\nThis format helps answer questions like: - ‚ÄúWhat proportion of women in each age group received respiratory vaccines?‚Äù (row %) - ‚ÄúWhat proportion of respiratory vaccine recipients were Aboriginal?‚Äù (column %)\nUnknown values are included but excluded from percentage calculations to avoid distorting group totals.\n\n# ------------12. Both Row wise and Column wise Tables -------------------------------------------\n\n# ....................................................................................................\n# Prepare Vaccination Uptake Table (Row and Column Percentages)\n# ....................................................................................................\n\n# --- Step 1: Prepare data for table formatting ---\n# Convert grouping variables to character for cleaner label handling\nvacc_1524 &lt;- vacc_1524 %&gt;%\n  mutate(across(c(gender, age_3group, marital_2group, year_3group, vacc_quarter, race_grouped), as.character))\n\n# Subset data for Respiratory vaccines to calculate column-based percentages (used for race)\nrespiratory_vaccines &lt;- vacc_1524 %&gt;%\n  filter(vacc_group3 == \"Respiratory vaccines\") %&gt;%\n  mutate(across(race_grouped, as.character))\n\n# --- Step 2: Create table-building function ---\n# This function tabulates counts by category and optionally adds missing (Unknown) values\ncreate_tab &lt;- function(data, var, label, use_col_percentage = FALSE) {\n  tab_main &lt;- data %&gt;%\n    filter(!is.na({{ var }})) %&gt;%\n    tabyl({{ var }}, vacc_group3) %&gt;%\n    mutate(Category = label, .before = 1) %&gt;%\n    rename(Label = {{ var }}) %&gt;%\n    mutate(Label = as.character(Label))\n  \n  # Add a row for missing/unknown if needed\n  na_count &lt;- sum(is.na(pull(data, {{ var }})))\n  if (na_count &gt; 0) {\n    na_row &lt;- tibble(\n      Category = label,\n      Label = \"Unknown\",\n      `Respiratory vaccines` = sum(data$vacc_group3 == \"Respiratory vaccines\" & is.na(pull(data, {{ var }})), na.rm = TRUE),\n      `Childhood vaccines` = sum(data$vacc_group3 == \"Childhood vaccines\" & is.na(pull(data, {{ var }})), na.rm = TRUE),\n      Other = sum(data$vacc_group3 == \"Other\" & is.na(pull(data, {{ var }})), na.rm = TRUE)\n    )\n    tab_combined &lt;- bind_rows(tab_main, na_row)\n  } else {\n    tab_combined &lt;- tab_main\n  }\n  \n  tab_combined %&gt;%\n    mutate(use_col_percentage = use_col_percentage)\n}\n\n# --- Step 3: Generate frequency tables for each variable ---\ntab_gender    &lt;- create_tab(vacc_1524, gender, \"Gender\")\ntab_age       &lt;- create_tab(vacc_1524, age_3group, \"Age group\")\ntab_marital   &lt;- create_tab(vacc_1524, marital_2group, \"Marital status·µá\")\ntab_year      &lt;- create_tab(vacc_1524, year_3group, \"Year group\")\ntab_quarter   &lt;- create_tab(vacc_1524, vacc_quarter, \"Quarter\")\ntab_race      &lt;- create_tab(respiratory_vaccines, race_grouped, \"Race group\", use_col_percentage = TRUE)\n\n# --- Step 4: Combine all tables ---\ntab_combined &lt;- bind_rows(\n  tab_gender, tab_age, tab_marital,\n  tab_year, tab_quarter, tab_race\n)\n\n# --- Step 5: Calculate percentages and formatted string outputs ---\ntab_combined &lt;- tab_combined %&gt;%\n  group_by(Category) %&gt;%\n  mutate(\n    use_col = first(use_col_percentage),\n    \n    # Exclude \"Unknown\" when calculating column totals to ensure proportions sum to 100\n    Total_Resp = ifelse(use_col, sum(`Respiratory vaccines`[Label != \"Unknown\"], na.rm = TRUE),\n                        `Respiratory vaccines` + `Childhood vaccines` + Other),\n    Total_Child = ifelse(use_col, sum(`Childhood vaccines`[Label != \"Unknown\"], na.rm = TRUE),\n                         `Respiratory vaccines` + `Childhood vaccines` + Other),\n    Total_Other = ifelse(use_col, sum(Other[Label != \"Unknown\"], na.rm = TRUE),\n                         `Respiratory vaccines` + `Childhood vaccines` + Other),\n    \n    # Calculate proportions\n    Resp_prop = ifelse(Label != \"Unknown\", round(100 * `Respiratory vaccines` / Total_Resp, 1), NA),\n    Child_prop = ifelse(Label != \"Unknown\", round(100 * `Childhood vaccines` / Total_Child, 1), NA),\n    Other_prop = ifelse(Label != \"Unknown\", round(100 * Other / Total_Other, 1), NA),\n    \n    # Format numbers and percentages\n    Respiratory = ifelse(is.na(Resp_prop),\n                         paste0(comma(`Respiratory vaccines`)),\n                         paste0(comma(`Respiratory vaccines`), \" (\", Resp_prop, \")\")),\n    Childhood = ifelse(is.na(Child_prop),\n                       paste0(comma(`Childhood vaccines`)),\n                       paste0(comma(`Childhood vaccines`), \" (\", Child_prop, \")\")),\n    Other_grp = ifelse(is.na(Other_prop),\n                       paste0(comma(Other)),\n                       paste0(comma(Other), \" (\", Other_prop, \")\"))\n  ) %&gt;%\n  ungroup()\n\n# --- Step 6: Clean labels and fix formatting for final table ---\ntab_combined &lt;- tab_combined %&gt;%\n  mutate(\n    Label = ifelse(Label == \"Other\", \"Other·∂ú\", Label),\n    Respiratory = ifelse(Label == \"Unknown\" & `Respiratory vaccines` == 0, \"\", Respiratory),\n    Childhood   = ifelse(Label == \"Unknown\" & `Childhood vaccines` == 0, \"\", Childhood),\n    Other_grp   = ifelse(Label == \"Unknown\" & Other == 0, \"\", Other_grp)\n  ) %&gt;%\n  group_by(Category) %&gt;%\n  mutate(Category = ifelse(row_number() == 1, Category, \"\")) %&gt;%\n  ungroup() %&gt;%\n  select(Category, Label, Respiratory, Childhood, Other_grp)\n\n# --- Step 7: Calculate group totals for header ---\ntotals &lt;- table(vacc_1524$vacc_group3)\ntotal_resp &lt;- totals[\"Respiratory vaccines\"]\ntotal_child &lt;- totals[\"Childhood vaccines\"]\ntotal_other &lt;- totals[\"Other\"]\n\n# --- Step 8: Create styled summary table using flextable ---\ntable_vacc_summary &lt;- flextable(tab_combined) %&gt;%\n  set_header_labels(\n    Category = \"Variable type\",\n    Label = \"Values\",\n    Respiratory = \"Number (%)·µÉ\",\n    Childhood = \"Number (%)·µÉ\",\n    Other_grp = \"Number (%)·µÉ\"\n  ) %&gt;%\n  add_header_row(\n    values = c(\"\", \"\",\n               paste0(\"Respiratory vaccines (N = \", format(total_resp, big.mark = \",\"), \")\"),\n               paste0(\"Childhood vaccines (N = \", format(total_child, big.mark = \",\"), \")\"),\n               paste0(\"Other (N = \", format(total_other, big.mark = \",\"), \")\")),\n    colwidths = c(1, 1, 1, 1, 1),\n    top = TRUE\n  ) %&gt;%\n  add_header_row(\n    values = c(\"Description\", \"Vaccination uptake\"),\n    colwidths = c(2, 3),\n    top = TRUE\n  ) %&gt;%\n  theme_box() %&gt;%\n  set_table_properties(layout = \"autofit\", width = 1) %&gt;%\n  width(j = 1, width = 1.5) %&gt;%\n  width(j = 2, width = 2.5) %&gt;%\n  width(j = 3:5, width = 1.5) %&gt;%\n  align(align = \"justify\", part = \"all\") %&gt;%\n  border_remove() %&gt;%\n  border(part = \"header\", i = 1, border.top = fp_border(color = \"black\", width = 1)) %&gt;%\n  border(part = \"header\", i = 3, border.bottom = fp_border(color = \"black\", width = 1)) %&gt;%\n  border_inner_h(part = \"header\", border = fp_border(color = \"black\", width = 0.8)) %&gt;%\n  border_inner_h(part = \"body\", border = fp_border(color = \"black\", width = 0.8)) %&gt;%\n  border(part = \"body\", i = nrow(tab_combined), border.bottom = fp_border(color = \"black\", width = 1)) %&gt;%\n  set_caption(as_paragraph(as_chunk(\n    \"Table xx: Vaccination uptake by demographic, temporal, and race variables, 2015‚Äì2024.\",\n    props = fp_text(font.size = 12, font.family = \"Times New Roman\", bold = FALSE)\n  ))) %&gt;%\n  add_footer_lines(values = c(\n    \"·µÉ Vaccination proportions were calculated per row (row percentage) except for race group which used column percentages.\",\n    \"·µá Marital status was grouped into two: partnered for those married and non-partnered for those divorced, widowed or single.\",\n    \"·∂ú Other race refers to those who identify as native or other racial groups.\"\n  )) %&gt;%\n  fontsize(part = \"header\", size = 12) %&gt;%\n  fontsize(part = \"body\", size = 11) %&gt;%\n  fontsize(part = \"footer\", size = 10) %&gt;%\n  font(part = \"all\", fontname = \"Times New Roman\") %&gt;%\n  color(part = \"header\", color = \"white\") %&gt;%\n  bg(part = \"header\", bg = \"black\") %&gt;%\n  bg(j = 1:5, i = seq(2, nrow(tab_combined), 2), bg = \"white\") %&gt;%\n  bold(j = 1, part = \"body\")\n\n# --- Step 9: Display table ---\ntable_vacc_summary\n\nDescriptionVaccination uptakeRespiratory vaccines (N = 955)Childhood vaccines (N = 472)Other (N = 126)Variable typeValuesNumber (%)·µÉNumber (%)·µÉNumber (%)·µÉGenderFemale511 (64)233 (29.2)54 (6.8)Male444 (58.8)239 (31.7)72 (9.5)Age group&lt;25332 (43.7)337 (44.4)90 (11.9)25-3498 (65.8)51 (34.2)0 (0)35+525 (81.4)84 (13)36 (5.6)Marital status·µáNot partnered286 (81.2)48 (13.6)18 (5.1)Partnered289 (79)59 (16.1)18 (4.9)Unknown38036590Year group‚â§2020483 (55)311 (35.4)84 (9.6)2021-2022311 (81.2)59 (15.4)13 (3.4)2023+161 (55.1)102 (34.9)29 (9.9)Quarter1253 (62.8)120 (29.8)30 (7.4)2220 (58.5)117 (31.1)39 (10.4)3295 (63.2)139 (29.8)33 (7.1)4187 (60.9)96 (31.3)24 (7.8)Race groupAsian69 (7.8)NANAOther·∂ú28 (3.2)NANAWhite788 (89)NANAUnknown70·µÉ Vaccination proportions were calculated per row (row percentage) except for race group which used column percentages.·µá Marital status was grouped into two: partnered for those married and non-partnered for those divorced, widowed or single.·∂ú Other race refers to those who identify as native or other racial groups.\n\n# --- Step 10: Clean up temporary objects (optional) ---\nrm(\n  tab_gender, tab_age, tab_marital, tab_year, tab_quarter, tab_race,\n  tab_combined, create_tab, respiratory_vaccines,\n  totals, total_resp, total_child, total_other\n)"
  },
  {
    "objectID": "Post_Blog/Table automation and Ideas.html#multiple-response-tables-rowwise-percentage",
    "href": "Post_Blog/Table automation and Ideas.html#multiple-response-tables-rowwise-percentage",
    "title": "Automating Publication-Ready Tables in R",
    "section": "1.13 13. Multiple Response Tables ‚Äì Rowwise Percentage",
    "text": "1.13 13. Multiple Response Tables ‚Äì Rowwise Percentage\nHere we simulate multiple-response tables by combining summary outputs from different variables side-by-side.\nüìö What‚Äôs useful here?\n\nShows how people responded with combinations of vaccine types (e.g., Both, Influenza, or None), where both here refers vaccination of influenza and other vaccine types.\nüôå Applies to: Any analysis involving response overlaps (e.g., co-morbidity, multiple treatments, combined exposures).\n\n\n# ------------ 10. Mutiple Response Tables: via appending: Rowwise -------------------------------------------\n\n# .................. Create flextable summary by variable ..................\nprocess_variable &lt;- function(data, group_var, group_label) {\n  \n  # Base pattern: Both and No\n  df_base &lt;- data %&gt;%\n    group_by(across(all_of(group_var)), vacc_pattern) %&gt;%\n    summarise(count = n(), .groups = \"drop\") %&gt;%\n    group_by(across(all_of(group_var))) %&gt;%\n    mutate(total = sum(count),\n           proportion = round((count / total) * 100, 1)) %&gt;%\n    ungroup() %&gt;%\n    filter(vacc_pattern %in% c(\"Both\", \"No\")) %&gt;%\n    rename(value = !!sym(group_var)) %&gt;%\n    mutate(value = as.character(value))\n  \n  # Influenza \n  df_flu &lt;- data %&gt;%\n    filter(!is.na(!!sym(group_var))) %&gt;%\n    mutate(flu_yes = recode(flu_yes, \"Yes\" = \"Influenza\")) %&gt;%\n    group_by(across(all_of(group_var)), flu_yes) %&gt;%\n    summarise(count = n(), .groups = \"drop\") %&gt;%\n    group_by(across(all_of(group_var))) %&gt;%\n    mutate(total = sum(count),\n           proportion = round((count / total) * 100, 1)) %&gt;%\n    ungroup() %&gt;%\n    filter(flu_yes == \"Influenza\") %&gt;%\n    rename(vacc_pattern = flu_yes, value = !!sym(group_var)) %&gt;%\n    mutate(value = as.character(value))\n  \n  df_combined &lt;- bind_rows(df_base, df_flu) %&gt;%\n    mutate(vacc_pattern = factor(vacc_pattern, levels = c(\"Both\", \"Influenza\", \"No\")))\n  \n  df_wide &lt;- df_combined %&gt;%\n    select(value, vacc_pattern, count, proportion) %&gt;%\n    pivot_wider(\n      names_from = vacc_pattern,\n      values_from = c(count, proportion),\n      values_fn = list(count = sum, proportion = sum),\n      values_fill = list(count = 0, proportion = 0)\n    ) %&gt;%\n    mutate(\n      Both = paste0(comma(`count_Both`), \" (\", `proportion_Both`, \")\"),\n      `Influenza only` = paste0(comma(`count_Influenza`), \" (\", `proportion_Influenza`, \")\"),\n      No = paste0(comma(`count_No`), \" (\", `proportion_No`, \")\"),\n      Variable = group_label\n    ) %&gt;%\n    select(value, Both, `Influenza only`, No, Variable)\n  \n  return(df_wide)\n}\n\n# Run for selected grouping variables\ndf_year &lt;- process_variable(vacc_1524, \"vacc_service_year\", \"Service year\")\ndf_age &lt;- process_variable(vacc_1524, \"age_group\", \"Age group\")\n\n# Combine and format for flextable\ndf_combined_long &lt;- bind_rows(df_year, df_age) %&gt;%\n  rename(Value = value) %&gt;%\n  select(Variable, Value, Both, `Influenza only`, No) %&gt;%\n  group_by(Variable) %&gt;%\n  mutate(Variable = ifelse(row_number() == 1, Variable, \"\")) %&gt;%\n  ungroup()\n\n# Create flextable\nfinal_table &lt;- flextable(df_combined_long) %&gt;%\n  set_header_labels(\n    Variable = \"Variable\",\n    Value = \"Value\",\n    Both = \"Both (%)\",\n    `Influenza only` = \"Influenza (%)\",\n    No = \"No (%)\"\n  ) %&gt;%\n  add_header_row(\n    values = c(\" \", \" \", \"Vaccination pattern·µÉ\"),\n    colwidths = c(1, 1, 3)\n  ) %&gt;%\n  align(align = \"justify\", part = \"all\") %&gt;%\n  bold(part = \"header\") %&gt;%\n  bold(i = 1, part = \"body\", j = \"Variable\") %&gt;%\n border_remove() %&gt;%\n  border_inner_h(border = fp_border(color = \"black\", width = 1)) %&gt;%\n  \n  add_header_lines(values = \"Table xx: Vaccination uptake pattern, 2015‚Äì2024.\") %&gt;%\n  add_footer_lines(values = c(\n    \"·µÉ The pattern reflects those with influenza vaccination history, influenza, or both.\"\n  ))\n\n# Display table\nfinal_table\n\nTable xx: Vaccination uptake pattern, 2015‚Äì2024.  Vaccination pattern·µÉVariableValueBoth (%)Influenza (%)No (%)Service year20158 (5.2)27 (17.6)110 (71.9)201652 (37.4)81 (58.3)36 (25.9)201741 (29.9)74 (54)34 (24.8)201850 (33.1)73 (48.3)47 (31.1)201953 (32.9)85 (52.8)46 (28.6)202053 (38.7)82 (59.9)26 (19)202127 (10.3)109 (41.4)96 (36.5)202239 (32.5)57 (47.5)16 (13.3)202357 (33.5)86 (50.6)56 (32.9)202446 (37.7)73 (59.8)23 (18.9)Age group0-1999 (15.4)214 (33.3)308 (48)20-2953 (24.1)110 (50)51 (23.2)30-3911 (16.7)28 (42.4)24 (36.4)40-4964 (34.2)108 (57.8)40 (21.4)50-5950 (34.7)85 (59)25 (17.4)60-6992 (54.1)120 (70.6)24 (14.1)70+57 (46)82 (66.1)18 (14.5)·µÉ The pattern reflects those with influenza vaccination history, influenza, or both.\n\n# .................. Clean up ..................\nrm(df_year, df_age, df_combined_long, process_variable, final_table)"
  },
  {
    "objectID": "Post_Blog/Table automation and Ideas.html#multiple-response-tables-columnwise-percentages",
    "href": "Post_Blog/Table automation and Ideas.html#multiple-response-tables-columnwise-percentages",
    "title": "Automating Publication-Ready Tables in R",
    "section": "1.14 14. Multiple Response Tables ‚Äì Columnwise Percentages",
    "text": "1.14 14. Multiple Response Tables ‚Äì Columnwise Percentages\nSimilar to the rowwise example, this version presents the column percentages of multiple responses.\nüßæ Key advantage: Allows side-by-side comparison of proportions within each vaccine group across multiple demographics.\nüíº Common in: Survey analysis, patient preference studies, behavioral research.\n\n# ------------ 11. Mutiple Response Tables: via appending: Columnwise -------------------------------------------\n\n# .................. Convert grouping vars to character ..................\nvacc_1524 &lt;- vacc_1524 %&gt;%\n  mutate(across(c(age_group, gender, marital_status,\n                  vacc_service_year, vacc_quarter, vacc_weekday), as.character))\n\n# .................. Table generation function (column-wise %) ..................\ncreate_tab &lt;- function(data, var, label) {\n  tab_main &lt;- data %&gt;%\n    filter(!is.na({{ var }})) %&gt;%\n    tabyl({{ var }}, vacc_group3) %&gt;%\n    mutate(Category = label, .before = 1) %&gt;%\n    rename(Label = {{ var }}) %&gt;%\n    mutate(Label = as.character(Label))\n  \n  na_count &lt;- sum(is.na(pull(data, {{ var }})))\n  \n  if (na_count &gt; 0) {\n    missing_row &lt;- tibble(\n      Category = label,\n      Label = \"Missing\",\n      `Respiratory vaccines` = sum(data$vacc_group3 == \"Respiratory vaccines\" & is.na(pull(data, {{ var }})), na.rm = TRUE),\n      `Childhood vaccines` = sum(data$vacc_group3 == \"Childhood vaccines\" & is.na(pull(data, {{ var }})), na.rm = TRUE),\n      Other = sum(data$vacc_group3 == \"Other\" & is.na(pull(data, {{ var }})), na.rm = TRUE)\n    )\n    tab_final &lt;- bind_rows(tab_main, missing_row)\n  } else {\n    tab_final &lt;- tab_main\n  }\n  \n  return(tab_final)\n}\n\n# .................. Create summary tables ..................\ntab_age            &lt;- create_tab(vacc_1524, age_group, \"Age\")\ntab_sex            &lt;- create_tab(vacc_1524, gender, \"Gender\")\ntab_marital_status &lt;- create_tab(vacc_1524, marital_status, \"Marital status\")\ntab_year           &lt;- create_tab(vacc_1524, vacc_service_year, \"Year\")\ntab_quarter        &lt;- create_tab(vacc_1524, vacc_quarter, \"Quarter\")\ntab_weekday        &lt;- create_tab(vacc_1524, vacc_weekday, \"Weekday\")\n\n# .................. Combine all tables ..................\ntab_combined &lt;- bind_rows(tab_sex, tab_age, tab_marital_status, tab_year, tab_quarter, tab_weekday)\n\n# .................. Calculate column-wise percentages within each Category group ..................\ntab_combined &lt;- tab_combined %&gt;%\n  group_by(Category) %&gt;%\n  mutate(\n    Total_Resp = sum(`Respiratory vaccines`[Label != \"Missing\"], na.rm = TRUE),\n    Total_Child = sum(`Childhood vaccines`[Label != \"Missing\"], na.rm = TRUE),\n    Total_Other = sum(Other[Label != \"Missing\"], na.rm = TRUE),\n    \n    is_missing = trimws(tolower(Label)) == \"missing\",\n    \n    Respiratory = ifelse(is_missing,\n                         comma(`Respiratory vaccines`),\n                         paste0(comma(`Respiratory vaccines`), \" (\", round(100 * `Respiratory vaccines` / Total_Resp, 1), \"%)\")),\n    \n    Childhood = ifelse(is_missing,\n                       comma(`Childhood vaccines`),\n                       paste0(comma(`Childhood vaccines`), \" (\", round(100 * `Childhood vaccines` / Total_Child, 1), \"%)\")),\n    \n    Other_grp = ifelse(is_missing,\n                       comma(Other),\n                       paste0(comma(Other), \" (\", round(100 * Other / Total_Other, 1), \"%)\"))\n  ) %&gt;%\n  ungroup() %&gt;%\n  select(Category, Label, Respiratory, Childhood, Other_grp)\n\n# .................. Show Category only once per group ..................\ntab_combined &lt;- tab_combined %&gt;%\n  group_by(Category) %&gt;%\n  mutate(Category = ifelse(row_number() == 1, Category, \"\")) %&gt;%\n  ungroup()\n\n# .................. Get total counts per vaccine group ..................\ntotals &lt;- vacc_1524 %&gt;%\n  count(vacc_group3) %&gt;%\n  deframe()\n\n# .................. Create flextable ..................\nft_vacc_summary &lt;- tab_combined %&gt;%\n  flextable() %&gt;%\n  set_header_labels(\n    Category = \"Variable type\",\n    Label = \"Values\",\n    Respiratory = \"Number (%)·µÉ\",\n    Childhood = \"Number (%)·µÉ\",\n    Other_grp = \"Number (%)·µÉ\"\n  ) %&gt;%\n  add_header_row(\n    values = c(\n      \"\", \"\",\n      paste0(\"Respiratory vaccines (N = \", format(totals[\"Respiratory vaccines\"], big.mark = \",\"), \")\"),\n      paste0(\"Childhood vaccines (N = \", format(totals[\"Childhood vaccines\"], big.mark = \",\"), \")\"),\n      paste0(\"Other (N = \", format(totals[\"Other\"], big.mark = \",\"), \")\")\n    )\n  ) %&gt;%\n  add_header_row(\n    values = c(\"Description\", \"Vaccination uptake\"),\n    colwidths = c(2, 3)\n  ) %&gt;%\n  theme_box() %&gt;%\n  set_table_properties(layout = \"autofit\", width = 1) %&gt;%\n  width(j = 1, width = 1.5) %&gt;%\n  width(j = 2, width = 2.5) %&gt;%\n  width(j = 3:5, width = 1.5) %&gt;%\n  align(align = \"justify\", part = \"all\") %&gt;%\n  border_remove() %&gt;%\n  border_inner_h(border = fp_border(color = \"black\", width = 1)) %&gt;%\n  \n  set_caption(\"Table: Vaccination uptake (column percentage) across service year, quarter, and weekday\") %&gt;%\n  footnote(i = 1, \n           value = as_paragraph(\"Vaccination proportions were calculated column-wise (i.e., within each vaccine group).\"),\n           ref_symbols = \"·µÉ\", \n           part = \"header\")\n\n# .................. Show the table ..................\nft_vacc_summary\n\nDescription·µÉVaccination uptake·µÉRespiratory vaccines (N = 955)Childhood vaccines (N = 472)Other (N = 126)Variable typeValuesNumber (%)·µÉNumber (%)·µÉNumber (%)·µÉGenderFemale511 (53.5%)233 (49.4%)54 (42.9%)Male444 (46.5%)239 (50.6%)72 (57.1%)Age0-19250 (26.2%)302 (64%)90 (71.4%)20-29150 (15.7%)70 (14.8%)0 (0%)30-3947 (4.9%)19 (4%)0 (0%)40-49142 (14.9%)45 (9.5%)0 (0%)50-59112 (11.7%)14 (3%)18 (14.3%)60-69149 (15.6%)13 (2.8%)8 (6.3%)70+105 (11%)9 (1.9%)10 (7.9%)Marital statusDivorced136 (23.7%)15 (14%)12 (33.3%)Married289 (50.3%)59 (55.1%)18 (50%)Single/widowed150 (26.1%)33 (30.8%)6 (16.7%)Missing38036590Year201578 (8.2%)56 (11.9%)19 (15.1%)201684 (8.8%)47 (10%)8 (6.3%)201775 (7.9%)52 (11%)10 (7.9%)201881 (8.5%)52 (11%)18 (14.3%)201983 (8.7%)60 (12.7%)18 (14.3%)202082 (8.6%)44 (9.3%)11 (8.7%)2021223 (23.4%)34 (7.2%)6 (4.8%)202288 (9.2%)25 (5.3%)7 (5.6%)202387 (9.1%)63 (13.3%)20 (15.9%)202474 (7.7%)39 (8.3%)9 (7.1%)Quarter1253 (26.5%)120 (25.4%)30 (23.8%)2220 (23%)117 (24.8%)39 (31%)3295 (30.9%)139 (29.4%)33 (26.2%)4187 (19.6%)96 (20.3%)24 (19%)WeekdayFriday141 (14.8%)31 (6.6%)8 (6.3%)Monday114 (11.9%)49 (10.4%)14 (11.1%)Saturday160 (16.8%)81 (17.2%)12 (9.5%)Sunday156 (16.3%)100 (21.2%)21 (16.7%)Thursday167 (17.5%)66 (14%)20 (15.9%)Tuesday108 (11.3%)43 (9.1%)14 (11.1%)Wednesday109 (11.4%)102 (21.6%)37 (29.4%)·µÉVaccination proportions were calculated column-wise (i.e., within each vaccine group).\n\n# .................. Clean up environment ..................\nrm(tab_age, tab_sex, tab_marital_status, tab_year, tab_quarter, tab_weekday,\n   tab_combined, ft_vacc_summary, totals, create_tab)"
  },
  {
    "objectID": "Post_Blog/Table automation and Ideas.html#interactive-and-print-ready-table",
    "href": "Post_Blog/Table automation and Ideas.html#interactive-and-print-ready-table",
    "title": "Automating Publication-Ready Tables in R",
    "section": "1.15 15. Interactive and Print-Ready Table",
    "text": "1.15 15. Interactive and Print-Ready Table\nFinally, we build an interactive table using the DT package with export options (CSV, Excel, Print).\nüñ±Ô∏è Why use this:\n\nOffers flexibility for exploratory review or end-user interaction.\nEnables printing or downloading filtered subsets.\n\nüåç Perfect for: Dashboards, websites, or when publishing to HTML via Quarto/GitHub.\n\n# ------------ 12. Interactive and Print ready: Table  -------------------------------------------\n\n\n# .................. Convert grouping vars to character ..................\nvacc_1524 &lt;- vacc_1524 %&gt;%\n  mutate(across(c(age_group, gender, marital_status,\n                  vacc_service_year, vacc_quarter, vacc_weekday), as.character))\n\n# .................. Table generation function with Missing ..................\ncreate_tab &lt;- function(data, var, label) {\n  tab_main &lt;- data %&gt;%\n    filter(!is.na({{ var }})) %&gt;%\n    tabyl({{ var }}, vacc_group3) %&gt;%\n    mutate(Category = label, .before = 1) %&gt;%\n    rename(Label = {{ var }}) %&gt;%\n    mutate(Label = as.character(Label))\n  \n  na_count &lt;- sum(is.na(pull(data, {{ var }})))\n  \n  if (na_count &gt; 0) {\n    missing_row &lt;- tibble(\n      Category = label,\n      Label = \"Missing\",\n      `Respiratory vaccines` = sum(data$vacc_group3 == \"Respiratory vaccines\" & is.na(pull(data, {{ var }})), na.rm = TRUE),\n      `Childhood vaccines` = sum(data$vacc_group3 == \"Childhood vaccines\" & is.na(pull(data, {{ var }})), na.rm = TRUE),\n      Other = sum(data$vacc_group3 == \"Other\" & is.na(pull(data, {{ var }})), na.rm = TRUE)\n    )\n    tab_final &lt;- bind_rows(tab_main, missing_row)\n  } else {\n    tab_final &lt;- tab_main\n  }\n  \n  return(tab_final)\n}\n\n# .................. Create summary tables ..................\ntab_age            &lt;- create_tab(vacc_1524, age_group, \"Age\")\ntab_sex            &lt;- create_tab(vacc_1524, gender, \"Gender\")\ntab_marital_status &lt;- create_tab(vacc_1524, marital_status, \"Marital status\")\ntab_year           &lt;- create_tab(vacc_1524, vacc_service_year, \"Year\")\ntab_quarter        &lt;- create_tab(vacc_1524, vacc_quarter, \"Quarter\")\ntab_weekday        &lt;- create_tab(vacc_1524, vacc_weekday, \"Weekday\")\n\n# .................. Combine all tables ..................\ntab_combined &lt;- bind_rows(tab_sex, tab_age, tab_marital_status, tab_year, tab_quarter, tab_weekday)\n\n# .................. Calculate row-wise percentages (skip for Missing) ..................\ntab_combined &lt;- tab_combined %&gt;%\n  rowwise() %&gt;%\n  mutate(\n    Total = sum(`Respiratory vaccines`, `Childhood vaccines`, Other, na.rm = TRUE),\n    is_missing = trimws(tolower(Label)) == \"missing\",\n    \n    Respiratory = ifelse(is_missing,\n                         comma(`Respiratory vaccines`),\n                         paste0(comma(`Respiratory vaccines`), \" (\", round(100 * `Respiratory vaccines` / Total, 1), \")\")),\n    \n    Childhood = ifelse(is_missing,\n                       comma(`Childhood vaccines`),\n                       paste0(comma(`Childhood vaccines`), \" (\", round(100 * `Childhood vaccines` / Total, 1), \")\")),\n    \n    Other_grp = ifelse(is_missing,\n                       comma(Other),\n                       paste0(comma(Other), \" (\", round(100 * Other / Total, 1), \")\"))\n  ) %&gt;%\n  ungroup() %&gt;%\n  select(Category, Label, Respiratory, Childhood, Other_grp)\n\n# .................. Show Category only once per group ..................\ntab_combined &lt;- tab_combined %&gt;%\n  group_by(Category) %&gt;%\n  mutate(Category = ifelse(row_number() == 1, Category, \"\")) %&gt;%\n  ungroup()\n\n# .................. Create interactive table with DT ..................\n\ndatatable(\n  tab_combined,\n  rownames = FALSE,\n  extensions = 'Buttons',\n  options = list(\n    dom = 'Bfrtip',\n    buttons = c('copy', 'csv', 'excel', 'pdf', 'print'),\n    pageLength = 25,\n    autoWidth = TRUE,\n    columnDefs = list(list(width = '200px', targets = c(0, 1)))\n  ),\n  caption = htmltools::tags$caption(\n    style = 'caption-side: top; font-size: 18px; font-family: \"Times New Roman\"; font-weight: bold;',\n    'Table: Vaccination uptake across service year, quarter, and weekday'\n  ),\n  class = 'stripe hover cell-border'\n)\n\n\n\n\n# .................. Clean up all new objects ..................\nrm(tab_age, tab_sex, tab_marital_status, tab_year, tab_quarter, tab_weekday,\n   tab_combined, create_tab)"
  },
  {
    "objectID": "Skillsets.html#expertise-and-key-skill-sets",
    "href": "Skillsets.html#expertise-and-key-skill-sets",
    "title": "Expertise and Skill Sets",
    "section": "",
    "text": "With over a decade of experience in epidemiology, public health, and data science, I have developed a comprehensive skill set that spans software tools, data analysis, outbreak investigation, project management and research, Scientific writing, stakeholder engagement and problem solving. This section provides an overview of my technical proficiencies, analytical capabilities, teaching experience, and collaborative leadership across government, academic, and health sectors. Whether working with complex datasets and projects, I bring a rigorous, thoughtful, and impact-driven approach."
  },
  {
    "objectID": "Skillsets.html#project-portfolio",
    "href": "Skillsets.html#project-portfolio",
    "title": "Expertise and Skill Sets",
    "section": "üìÅ Project Portfolio",
    "text": "üìÅ Project Portfolio\n\nDashboard via R Shiny: click here\n\nSoftware Programming: R and other software programming projects are available at my GitHub or AnalyticsHub YouTube.\n\nScientific Writing & Leadership: Scientific writing, reports, peer-reviewed publications, grant awards, project management, and leadership are presented at my website, Google Scholar Profile, or ORCID Profile.\n\n\n\nüíª Data Tools & Statistical Software\n\nStatistical Programming: R, Python, SQL, Power BI, STATA\n\nDatabase Systems: REDCap (design, automation, data import/export), SQL\n\nDashboard & Visualisation: R Shiny, Power BI, ggplot2, leaflet, heatmaps, treemaps, spatial mapping"
  },
  {
    "objectID": "Skillsets.html#data-analysis-statistical-modelling",
    "href": "Skillsets.html#data-analysis-statistical-modelling",
    "title": "Expertise and Skill Sets",
    "section": "üìä Data Analysis & Statistical Modelling",
    "text": "üìä Data Analysis & Statistical Modelling\n\nPerformed advanced data cleaning, transformation, and preparation\n\nConducted causal modelling (e.g., path analysis, Directed Acyclic Graphs)\n\nCompleted longitudinal and survival analysis\n\nApplied multilevel modelling, Generalised Estimating Equations (GEE), Generalised Linear Mixed Models (GLMM)\n\nExecuted trend analysis and predictive modelling\n\nHandled and imputed missing data (e.g., mean imputation, multiple imputation, backward and forward imputation)\n\nConducted spatial analysis and geospatial statistics\n\nCompleted systematic reviews, meta-analysis, and evidence synthesis"
  },
  {
    "objectID": "Skillsets.html#linked-administrative-data-experience",
    "href": "Skillsets.html#linked-administrative-data-experience",
    "title": "Expertise and Skill Sets",
    "section": "üóÉÔ∏è Linked Administrative Data Experience",
    "text": "üóÉÔ∏è Linked Administrative Data Experience\nCarried out data analysis, data management, and data linkage using the following administrative and clinical databases.\n- Australian Immunisation Register (AIR)\n- The Western Australian Notifiable Infectious Diseases Database (WANIDD)\n- Medicare Benefits Schedule (MBS)\n- Pharmaceutical Benefits Scheme (PBS)\n- Queensland Admitted Patient Data Collection\n- Queensland Cancer Register\n- The Australian Longitudinal Study on Women‚Äôs Health (ALSWH)"
  },
  {
    "objectID": "Skillsets.html#research-knowledge-translation",
    "href": "Skillsets.html#research-knowledge-translation",
    "title": "Expertise and Skill Sets",
    "section": "üìö Research & Knowledge Translation",
    "text": "üìö Research & Knowledge Translation\n\nDesigned and managed large-scale research projects\n\nSecured and managed research grants\n\nObtained ethical approvals, developed protocols, and reported to stakeholders\n\nPublished in peer-reviewed journals and presented at conferences\n\nContributed to evidence-informed policy and program design\n\nApplied expertise in cancer epidemiology, maternal and child health, and communicable disease surveillance"
  },
  {
    "objectID": "Skillsets.html#teaching-mentorship-capacity-building",
    "href": "Skillsets.html#teaching-mentorship-capacity-building",
    "title": "Expertise and Skill Sets",
    "section": "üéì Teaching, Mentorship & Capacity Building",
    "text": "üéì Teaching, Mentorship & Capacity Building\n\nTaught Public Health, Epidemiology, and Biostatistics courses\n\nDeveloped curricula and coordinated courses\n\nSupervised Master‚Äôs and Honours students\n\nDelivered training in data analysis, REDCap, R programming, and visualisation\n\nSupported diverse student cohorts in academic and clinical settings"
  },
  {
    "objectID": "Skillsets.html#collaboration-stakeholder-engagement",
    "href": "Skillsets.html#collaboration-stakeholder-engagement",
    "title": "Expertise and Skill Sets",
    "section": "ü§ù Collaboration & Stakeholder Engagement",
    "text": "ü§ù Collaboration & Stakeholder Engagement\n\nWorked with multidisciplinary teams: clinicians, epidemiologists, Aboriginal Health services and community members\n\nServed as a member of the First Nations Advisory Group, Cancer Council Queensland\n\nLiaised with data custodians, ethics committees, and public health teams\n\nCommunicated findings to both technical and general audiences\n\nGained experience across low- and high-income country health systems"
  },
  {
    "objectID": "Skillsets.html#project-program-leadership",
    "href": "Skillsets.html#project-program-leadership",
    "title": "Expertise and Skill Sets",
    "section": "üß≠ Project & Program Leadership",
    "text": "üß≠ Project & Program Leadership\n\nTranslated analytical outputs into actionable policy and practice\n\nDeveloped, implemented, and maintained REDCap databases\n\nMapped processes, designed interfaces, configured alerts, and automated workflows\n\nCreated and applied monitoring and evaluation frameworks\n\nProvided strategic guidance for public health programs and interventions"
  },
  {
    "objectID": "about.html",
    "href": "about.html",
    "title": "Experience | Qualifications | Skills and Expertise",
    "section": "",
    "text": "I‚Äôm an Epidemiologist and Data Analyst with over a decade of experience across government health departments, academic institutions, and public health projects. My expertise lies in transforming complex administrative and surveillance data into actionable evidence that improves public health policy, clinical practice, and health equity. I am passionate about data-driven decision-making, inclusive stakeholder engagement, and translating research into practice.\nI currently work as a Project Officer (Epidemiologist) at the Western Australia Department of Health, where I lead surveillance and reporting initiatives using linked health datasets such as the Australian Immunisation Register (AIR) and the Western Australian Notifiable Infectious Diseases Database (WANIDD). I design and manage REDCap databases, automate data processing in R, and develop interactive Shiny dashboards that support timely public health responses.\nPreviously, I worked as a Research Fellow at The University of Queensland, where I led cancer epidemiology projects with the First Nations Cancer & Wellbeing Research Program. At Cancer Council Queensland, I managed the nationally recognised Australian Cancer Atlas project, led a cancer epidemiology study, and contributed to the First Nations Advisory Group. My career reflects a strong commitment to data transparency and evidence-informed decision."
  },
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "H. Mellie B",
    "section": "",
    "text": "H. Mellie B"
  },
  {
    "objectID": "Skillsets.html",
    "href": "Skillsets.html",
    "title": "Expertise and Skill Sets",
    "section": "",
    "text": "With over a decade of experience in epidemiology, public health, and data science, I have developed a comprehensive skill set that spans software tools, data analysis, outbreak investigation, project management and research, Scientific writing, stakeholder engagement and problem solving. This section provides an overview of my technical proficiencies, analytical capabilities, teaching experience, and collaborative leadership across government, academic, and health sectors. Whether working with complex datasets and projects, I bring a rigorous, thoughtful, and impact-driven approach."
  },
  {
    "objectID": "Publication_report.html",
    "href": "Publication_report.html",
    "title": "Publication | Report | Conference Presentation",
    "section": "",
    "text": "I have authored over 40 peer-reviewed journal articles, more than two major reports, and a book chapter. My work has been cited more than 10,000 times, with over 35% ranking in the top 1% journals globally. Many publications have directly informed policy and guidelines. I have presented my research outputs at 18 conferences, including those hosted by the Public Health Association of Australia, Australasian Epidemiological Association, and World Indigenous Cancer Conference."
  },
  {
    "objectID": "contact.html",
    "href": "contact.html",
    "title": "üì¨ Get in Touch",
    "section": "",
    "text": "I welcome any questions, potential collaborations, job opportunities, or consultation requests‚Äîplease feel free to get in touch."
  },
  {
    "objectID": "contact.html#get-in-touch",
    "href": "contact.html#get-in-touch",
    "title": "üì¨ Get in Touch",
    "section": "üì¨ Get in Touch",
    "text": "üì¨ Get in Touch\n\n\n\n\nüìß Email\n\n\nhmba2003@gmail.com\n\n\nüìû Phone\n\n\n+61 414 896 283\n\n\nüîó Connect Online\n\n\n\nLinkedIn: Habtamu Bizuayehu\n\n\nGitHub: Habtamu Bizuayehu\n\n\n\n\n\n\n \nName \nEmail \nMessage\n\n\nSend\n\n\n\n‚úÖ Thank you for your message!"
  },
  {
    "objectID": "Publication_report.html#reports",
    "href": "Publication_report.html#reports",
    "title": "Publication | Report | Conference Presentation",
    "section": "üìë Reports",
    "text": "üìë Reports\n\nBizuayehu‚ÄØH, Kenny‚ÄØT, Chong‚ÄØT, et al.¬†Trends and coverage of antenatal vaccination during pregnancy in Western Australia. WA Department of Health, 2025.\n\nBizuayehu‚ÄØH, Garvey‚ÄØG, Diaz‚ÄØA, Jahan‚ÄØS, et al.¬†Developing Consumer‚ÄëDriven Cancer Research with First Nations Peoples. . The First Nations Cancer and Wellbeing Research Program (FNCWR), The University of Queensland, 2024."
  },
  {
    "objectID": "Publication_report.html#book-chapter",
    "href": "Publication_report.html#book-chapter",
    "title": "Publication | Report | Conference Presentation",
    "section": "üìö Book Chapter",
    "text": "üìö Book Chapter\n\nBizuayehu‚ÄØHM, Belachew‚ÄØSA, Diaz‚ÄØA, Jahan‚ÄØS, Fong‚ÄØKM, Garvey‚ÄØG. Indigenous and Tribal Peoples and Cancer. In: Cancer and Society. Springer, 2024. View chapter"
  },
  {
    "objectID": "Publication_report.html#peer-reviewed-journal-articles",
    "href": "Publication_report.html#peer-reviewed-journal-articles",
    "title": "Publication | Report | Conference Presentation",
    "section": "üìù Peer-Reviewed Journal Articles",
    "text": "üìù Peer-Reviewed Journal Articles\nNB: My name in the publications is presented as either Bizuayehu HM or Mellie H.\n\nBizuayehu‚ÄØHM et al. Burden of 30 cancers among men: Global statistics in 2022 and projections for 2050 using population-based estimates.‚ÄØCancer. 2024 Aug 12. https://doi.org/10.1002/cncr.35458\n\nBizuayehu‚ÄØHM et al. Patterns of Labour Interventions and Associated Maternal Biopsychosocial Factors in Australia: a Path Analysis.‚ÄØReproductive Sciences. 2023;30:2767‚Äì2779. https://doi.org/10.1007/s43032-023-01219-7\n\nBizuayehu‚ÄØHM et al. Utilisation of endocrine therapy for cancer in Indigenous peoples: a systematic review and meta-analysis.‚ÄØBMC Cancer. 2024;24(1):882. https://doi.org/10.1186/s12885-024-12627-6\n\nBizuayehu‚ÄØHM et al. Maternal residential area effects on preterm birth, low birth weight and caesarean section in Australia: A systematic review.‚ÄØMidwifery. 2023;123:103704. https://doi.org/10.1016/j.midw.2023.103704\n\nBizuayehu‚ÄØHM et al. Low birth weight and its associated biopsychosocial factors over a 19-year period: findings from a national cohort study.‚ÄØEur J Public Health. 2021;31(4):786‚Äì793. doi: 10.1093/eurpub/ckab033\n\nBizuayehu‚ÄØHM et al. Global burden of 34 cancers among women in 2020 and projections to 2040: population-based data from 185 countries/territories.‚ÄØInt J Cancer. 2023;152(3):592‚Äì604. https://doi.org/10.1002/ijc.34247\n\nBore‚ÄØMG, Dadi‚ÄØAF, & Bizuayehu‚ÄØHM. Unmet supportive care needs among cancer patients in Sub‚ÄëSaharan Africa: a mixed-method systematic review and meta-analysis.‚ÄØJ Pain Symptom Manage. 2023;66(4):673‚Äì689.e1. https://doi.org/10.1016/j.jpainsymman.2023.03.012\n\nBizuayehu‚ÄØHM et al. A Review of the Application of Spatial Survival Methods in Cancer Research: Trends, Modeling, and Visualization Techniques.‚ÄØCancer Epidemiol Biomarkers Prev. 2023;32(6):761‚Äì775. DOI: 10.1158/1055-9965.EPI-23-0154\n\nHabte‚ÄØA, Bizuayehu‚ÄØHM, Lemma‚ÄØL, Sisay‚ÄØY. Road to maternal death: the pooled estimate of maternal near‚Äëmiss, its primary causes and determinants in Africa: a systematic review and meta-analysis.‚ÄØBMC Pregnancy Childbirth. 2024;24(1):1‚Äì22. https://doi.org/10.1186/s12884-024-06325-1\n\nHabte‚ÄØA, Bizuayehu‚ÄØHM, Haile‚ÄØY, et al. Spatial variation and predictors of composite index of HIV/AIDS knowledge, attitude and behaviours among Ethiopian women: A spatial and multilevel analyses of the 2016 Demographic Health Survey.‚ÄØPLOS ONE. 2024;19(6):e0304982. https://doi.org/10.1371/journal.pone.0304982\n\nAhmed‚ÄØKY, Dadi‚ÄØAF, Kibret‚ÄØGD, Bizuayehu‚ÄØHM, et al. Population modifiable risk factors associated with under‚Äë5 acute respiratory tract infections and diarrhoea in 25 countries in sub‚ÄëSaharan Africa (2014‚Äì2021): an analysis of data from demographic and health surveys.‚ÄØeClinicalMedicine. 2024;68:101998. DOI: 10.1016/j.eclinm.2024.102444\n\nBelete‚ÄØN, Tsige‚ÄØY, Mellie‚ÄØH. Willingness and acceptability of cervical cancer screening among women living with HIV/AIDS in Addis Ababa, Ethiopia: a cross sectional study.‚ÄØGynecol Oncol Res Pract. 2015;2(1):1‚Äì6. DOI:10.1186/s40661-015-0012-3\n\nMulat‚ÄØA, Bayu‚ÄØH, Mellie‚ÄØH, Alemu‚ÄØA. Induced second trimester abortion and associated factors in Amhara region referral hospitals.‚ÄØBiomed Res Int. 2015;2015:Article¬†ID¬†358062. DOI:10.1155/2015/256534\n\nMoges‚ÄØNA, Bizuayehu‚ÄØHM. Sexual Behaviour of Perinatally Infected Youth in Northwest Ethiopia: Implication for HIV Prevention Strategy.‚ÄØAIDS Res Treat. 2018;2018:Article¬†ID¬†5489787. DOI: 10.1155/2018/1573845\n\nBizuayehu‚ÄØHM et al. Biopsychosocial factors influencing the occurrence and recurrence of preterm singleton births among Australian women: A prospective cohort study.‚ÄØ*Midwifery. 2022;110:103334. https://doi.org/10.1016/j.midw.2022.103334\n\n\nFull publication list and additional links available via Google Scholar or ORCID."
  },
  {
    "objectID": "Publication_report.html#conference-presentations",
    "href": "Publication_report.html#conference-presentations",
    "title": "Publication | Report | Conference Presentation",
    "section": "üé§ Conference Presentations",
    "text": "üé§ Conference Presentations\nPresented 18 research outputs, including over seven research outputs in Australian conferences:\n\nBizuayehu HM, Belachew, S. A., Jahan, S., Diaz, A., Fong K. M., & Garvey G. The landscape of lung cancer screening among Indigenous peoples worldwide. World Indigenous Cancer Conference. Face-to-face presentation at Melbourne; 19/03/2024\nBizuayehu HM, Cameron JK, Dasgupta P, and Baade PD. Spatial survival methods application in cancer research: trends, modelling and visualisation techniques: Australasian Epidemiological Association conference. Face-to-face presentation at Melbourne; 19/10/2023\nBizuayehu HM, Harris ML, Chojenta C, et al. Labour interventions patterns and associated biopsychosocial factors: a path analysis of cohort study. Australasian Epidemiological Association conference. Face-to-face presentation at Melbourne; 20/10/2023\nBizuayehu HM, Cameron JK, Dasgupta P, and Baade PD. Spatial survival methods application in cancer research: trends, modelling and visualisation techniques. The 3rd Early Career Researcher Cancer Epidemiology Virtual Conference; 23 November 2023\nBizuayehu HM, Harris ML, Chojenta C, et al. Maternal residential area effects on preterm birth, low birth weight and caesarean section: A systematic review. The Australian-Based Ethiopian Researchers Network (ABReN) 4th Annual Virtual Conference, 12/08/2023"
  },
  {
    "objectID": "Post_Blog/Shiny_app_interactive/index.html",
    "href": "Post_Blog/Shiny_app_interactive/index.html",
    "title": "Interactive Dashboard: Shiny App",
    "section": "",
    "text": "‚ñ∂Ô∏è Click here for Live App\nThis version of the app responds instantly to any change in user input. Filtering options like state, age group, or rate thresholds immediately update the charts and tables ‚Äî no action button required.\nThis project is part of a broader effort to translate public health screening data into actionable insights. It demonstrates best practices in using R Shiny for health surveillance, offering visual tools to support policy development and outreach strategies.\n\n\n\nThis app is built using reactive() expressions that automatically track inputs and re-render outputs. It provides a seamless user experience designed for exploration and fast iteration.\n\n\n\nShiny Feature\nRole\n\n\n\n\nreactive()\nUpdates outputs automatically\n\n\nrenderPlotly()\nDisplays interactive plots\n\n\nrenderDT()\nFilters and formats tables\n\n\nsliderInput(), selectInput()\nCollect user filters\n\n\n\n\n\n\n\n\nInstant feedback with every change\n\nEncourages user exploration\n\nIdeal for training, teaching, and discovery\n\n\n\n\n\nPotentially heavier computation\n\nLess control over refresh timing\n\n\n\n\n\n‚ñ∂Ô∏è Live App (Fully Interactive)"
  },
  {
    "objectID": "Post_Blog/Shiny_app_interactive/index.html#real-time-breast-cancer-screening-explorer",
    "href": "Post_Blog/Shiny_app_interactive/index.html#real-time-breast-cancer-screening-explorer",
    "title": "Shiny app Interactive",
    "section": "",
    "text": "‚ñ∂Ô∏è Click here for Live App\nThis version of the app responds instantly to any change in user input. Filtering options like state, age group, or rate thresholds immediately update the charts and tables ‚Äî no action button required.\nThis project is part of a broader effort to translate public health screening data into actionable insights. It demonstrates best practices in using R Shiny for health surveillance, offering visual tools to support policy development and outreach strategies.\n\n\n\nThis app is built using reactive() expressions that automatically track inputs and re-render outputs. It provides a seamless user experience designed for exploration and fast iteration.\n\n\n\nShiny Feature\nRole\n\n\n\n\nreactive()\nUpdates outputs automatically\n\n\nrenderPlotly()\nDisplays interactive plots\n\n\nrenderDT()\nFilters and formats tables\n\n\nsliderInput(), selectInput()\nCollect user filters\n\n\n\n\n\n\n\n\nInstant feedback with every change\n\nEncourages user exploration\n\nIdeal for training, teaching, and discovery\n\n\n\n\n\nPotentially heavier computation\n\nLess control over refresh timing\n\n\n\n\n\n‚ñ∂Ô∏è Live App (Fully Interactive)"
  },
  {
    "objectID": "Post_Blog/Shiny_app_interactive/index.html#project-summary",
    "href": "Post_Blog/Shiny_app_interactive/index.html#project-summary",
    "title": "Interactive Dashboard: Shiny App",
    "section": "2 üóÇÔ∏è Project Summary",
    "text": "2 üóÇÔ∏è Project Summary\nThis interactive dashboard allows users to explore screening uptake across Australian states, age groups, and time. It includes real-time plot updates, table downloads, and color customization ‚Äî all running directly in the browser.\n\nSource code: GitHub ‚Äì Breast Cancer Screening Shiny App"
  },
  {
    "objectID": "Post_Blog/Shiny_app_User_controlled/index.html",
    "href": "Post_Blog/Shiny_app_User_controlled/index.html",
    "title": "Dashboard: User-Controlled Shiny App",
    "section": "",
    "text": "‚ñ∂Ô∏è Click here for Live App"
  },
  {
    "objectID": "Post_Blog/Shiny_app_User_controlled/index.html#breast-cancer-screening-in-australia-reactive-on-demand",
    "href": "Post_Blog/Shiny_app_User_controlled/index.html#breast-cancer-screening-in-australia-reactive-on-demand",
    "title": "User controlled Shiny Application",
    "section": "",
    "text": "‚ñ∂Ô∏è Click here for Live App"
  },
  {
    "objectID": "Post_Blog/Shiny_app_User_controlled/index.html#breast-cancer-screening-in-australia-reactive-on-demand-1",
    "href": "Post_Blog/Shiny_app_User_controlled/index.html#breast-cancer-screening-in-australia-reactive-on-demand-1",
    "title": "User controlled Shiny Application",
    "section": "ü©∫ Breast Cancer Screening in Australia (Reactive on Demand)",
    "text": "ü©∫ Breast Cancer Screening in Australia (Reactive on Demand)\nThis Shiny web application allows users to explore breast cancer screening data for Australian women. It uses observer-based logic, meaning updates occur only after users trigger an action, such as clicking a button.\nThis project is part of a broader effort to translate public health screening data into actionable insights. It demonstrates best practices in using R Shiny for health surveillance, offering visual tools to support policy development and outreach strategies.\n\n\nüìò App Behavior & Architecture\nThis app uses observeEvent() to control reactivity. Changes to filters (e.g.¬†age group or state) do not instantly update the outputs. Instead, results appear after the user explicitly clicks a ‚ÄúShow Results‚Äù or similar button.\n\n\n\nShiny Feature\nRole\n\n\n\n\nobserveEvent()\nTriggers server actions on button click\n\n\neventReactive()\nReactive expressions tied to events\n\n\nactionButton()\nManual trigger for output updates\n\n\nrenderPlotly() / renderDT()\nControlled output rendering\n\n\n\n\n\n\n‚úÖ Advantages\n\nReduces unnecessary computation\n\nAllows the user to finalize multiple input choices before updating\n\nPreferred for slower connections or complex datasets\n\n\n\n‚ö†Ô∏è Disadvantages\n\nLess fluid interaction for exploratory tasks\n\nRequires an extra click for every update\n\n\n\n\nüîó Try the App\n‚ñ∂Ô∏è Live App (Manual Updates)"
  },
  {
    "objectID": "Post_Blog/Shiny_app_User_controlled/index.html#project-summary",
    "href": "Post_Blog/Shiny_app_User_controlled/index.html#project-summary",
    "title": "Dashboard: User-Controlled Shiny App",
    "section": "2 üóÇÔ∏è Project Summary",
    "text": "2 üóÇÔ∏è Project Summary\nThis application emphasizes deliberate, user-controlled interaction, making it well-suited for presentations or analytical reporting. It is especially helpful when data loads are heavy or precise comparisons are required.\n\nSource code: GitHub ‚Äì Breast Cancer Screening Shiny App"
  },
  {
    "objectID": "Post_Blog/Data_Manipulation_and_Wrangling/index.html",
    "href": "Post_Blog/Data_Manipulation_and_Wrangling/index.html",
    "title": "Date Manipulation and Wrangling using R",
    "section": "",
    "text": "This presentation provides a comprehensive walkthrough of data manipulation and wrangling in R, covering foundational setup, core syntax, data importing, exploration, and transformation techniques. It systematically introduces essential R packages and functions for cleaning, summarizing, and visualizing data, followed by advanced topics such as working with dates and handling missing values. Practical sections on looping, writing functions, and building interactive Shiny applications are also included to enhance automation and interactivity. The presentation concludes with real-world case studies, demonstrating how to apply these techniques to healthcare and public health datasets. This guide is designed to build technical proficiency and practical confidence for effective data analysis using R.\nThis Presentation/Project Covers\n- Part I: FOUNDATIONS AND INTRODUCTION\nInstalling R and RStudio, setting working directories, clearing console, loading packages, R syntax and shortcuts, R object types, Quarto and R Markdown overview.\n- Part II: DATA LOADING AND EXPLORATION\nImporting CSV/Excel data, reading datasets into R.\n- Part III: WRANGLING WITH dplyr\nSelecting and renaming columns, creating variables, splitting text, extracting patterns, working with factors, grouping, sorting, reshaping data.\n- Part IV: ADVANCED WRANGLING AND INTEGRATION\nHandling dates, deduplication, merging datasets, identifying and imputing missing values.\n- Part V: DESCRIPTIVE STATISTICS AND TABULATION\nSummary stats, skewness/kurtosis, frequencies, cross tabulations, exporting summaries.\n- Part VI: DATA VISUALIZATION WITH ggplot2\nChart components, common plots, multivariate visuals, geospatial maps, overlays, themes and labels.\n- Part VII: SHINY APP ‚Äì BUILDING WEB APPS\nUI and server structure, reactive inputs/outputs, DT tables, app deployment.\n\n\n\n\n\nThis section will cover the following contents\n- Installing R and RStudio\n- Setting working directories\n- Clearing environment and console\n- Installing and loading packages (eg tidyverse, janitor, etc.)\n\nInstalling R and RStudio\n\nWhen we begin working with R, the very first step we take is installing two important tools: R itself (the engine) and RStudio (the friendly interface we use every day). I recommend that we install R first and then RStudio immediately after.\nTo make this clear, I have prepared a complete video tutorial that you can watch step-by-step:\nWathc at AnalyticsHub YouTube\nThe video, shows:\n\nHow to Download R from the CRAN website.\nInstall RStudio, which gives us a powerful yet simple environment to work in.\nBriefly explore basic options like font size, theme (dark/light mode), and code editor settings to make RStudio comfortable for coding.\nSetting working directories\nWhen we work in R, it‚Äôs very important that we know where R is reading from and saving to.\nI often think of the working directory as the ‚Äúhome folder‚Äù where all my files live during an R session.\nWe can easily check our current working directory by typing:\n\ngetwd() \n\n[1] \"C:/Users/User/Desktop/Materials_ Course and proposals/VIP collection for Syntax code or project titles/R codes/Website profile Mod 2/Post_Blog/Data_Manipulation_and_Wrangling\"\n\n\n\nThis command tells us exactly where R is currently looking for files.\nIf we want to change the working directory to a folder we are working on (for example, a project folder or a course material folder), we can use:\n\nsetwd(\"C:/Users/User/Desktop/Materials_ Course and proposals/\")\n\nAlways make sure the folder path is in quotation marks and I use forward slashes / or double backslashes \\\\ when typing the path.\nüìå We can also set the working directory easily by clicking:\n\nSession ‚ûî Set Working Directory ‚ûî Choose Directory‚Ä¶\n\nüìö Note about API tokens and special folders:\nIf you are using R for connecting to APIs, cloud storage, or services like GitHub, Dropbox, or Google Drive,\nsometimes you will need to set a working directory where your API token file is stored (for authentication).\n\nsetwd(\"C:/Users/YourName/.credentials/\") \n\n‚ö†Ô∏è Important: Always make sure API tokens and confidential files are in a secure private directory.\n\nClearing environment and console\n\n# Clear environment and console\nrm(list = ls()) # To clear the environment (remove all objects in memory)\ncat(\"\\014\") # To clear the console (like wiping a whiteboard)\n\n\nBefore starting fresh in any R session, I like to clear out everything‚Äîall variables, data, and even the clutter in the console.\nInstalling and loading packages\nWe rely on a range of packages in R for data wrangling, visualization, dashboards, and reporting.\nI typically create a vector of required packages and write a small loop to install any missing ones.\n\n\n# ------------------ Set CRAN Repository ------------------\n\noptions(repos = c(CRAN = \"https://cran.rstudio.com\"))\n\n# ------------------ List of required packages for Data Wrangling and Analysis ------------------\npackages &lt;- c(\n  \"lubridate\", \"dplyr\", \"stringr\", \"zoo\", \"tsibble\", \"ggplot2\", \"plotly\", \n  \"readr\", \"readxl\", \"haven\", \"openxlsx\", \"labelled\", \"forecast\",\n  \"prettydoc\", \"janitor\", \"knitr\", \"rmarkdown\", \"yaml\", \n  \"flextable\", \"scales\", \"gt\", \"reactable\", \"DT\", \"gmodels\", \"Hmisc\",\n  \"tidyverse\", \"tidyr\", \"officer\",\n  \"shiny\", \"shinydashboard\", \"shinythemes\", \"mice\", \"shinyWidgets\", \"bslib\", \"quarto\"\n)\n\n# ------------------ Install and load packages ------------------\nfor (pkg in packages) {\n  if (!require(pkg, character.only = TRUE)) {\n    install.packages(pkg)\n  }\n}\n\n# ------------------ Load required libraries with descriptions ------------------\nlibrary(lubridate)     # Simplifies the manipulation of dates and times in R (e.g., formatting, extracting components)\nlibrary(dplyr)         # Data manipulation: filtering, summarizing, and transforming data\nlibrary(stringr)       # Simplifies string manipulation\nlibrary(tidyr)         # Data tidying: reshaping with pivot_longer, pivot_wider, etc.\nlibrary(purrr)         # Functional programming: map functions over lists/vectors\nlibrary(forcats)       # Categorical data: reordering and labeling factor levels\n\nlibrary(zoo)           # Infrastructure for time series objects\nlibrary(tsibble)       # Tidy temporal data frames and time series modeling\nlibrary(forecast)      # Forecasting functions for time series models\n\nlibrary(readr)         # Read rectangular data like CSVs\nlibrary(readxl)        # Read Excel files (.xls and .xlsx)\nlibrary(haven)         # Import data from SAS, SPSS, and Stata\nlibrary(openxlsx)      # Write to Excel with more control\nlibrary(labelled)      # Attach and work with variable labels\n\nlibrary(ggplot2)       # Create elegant data visualizations using the grammar of graphics\nlibrary(plotly)        # Interactive visualizations using ggplot2 or standalone plotly\nlibrary(scales)        # Provides scale functions for ggplot2 (e.g., log, percent)\n\nlibrary(janitor)       # Clean data: make column names nice, tabulate, etc.\nlibrary(gmodels)       # CrossTables and other classic stats tools\nlibrary(Hmisc)         # Summarization and advanced table/label handling\nlibrary(mice)           # missing data imputation\n\nlibrary(knitr)         # Dynamic report generation in R\nlibrary(rmarkdown)     # Convert R scripts to reports in various formats\nlibrary(prettydoc)     # Beautiful HTML document templates\nlibrary(yaml)          # Read and write YAML files (used in R Markdown, Quarto)\nlibrary(officer)       # Export tables and reports to Word/PowerPoint\n\nlibrary(flextable)     # Create nicely formatted tables\nlibrary(gt)            # Grammar of tables for HTML and PDF output\nlibrary(reactable)     # Interactive data tables\nlibrary(DT)            # Wrapper of JavaScript DataTables for R\n\nlibrary(shiny)         # Build interactive web applications directly from R\nlibrary(shinydashboard)# Create dashboard layouts for Shiny apps\nlibrary(shinythemes)   # Prebuilt UI themes for Shiny apps\nlibrary(shinyWidgets)  # Enhanced UI widgets for Shiny\nlibrary(bslib)         # Bootstrap themes for Shiny and rmarkdown\n\nlibrary(quarto)        # Rendering Quarto documents\n\n\n\n\n\nOperators: &lt;-, %&gt;%, ==, &, |, ~\nAdditional Operators: %in%, ::, %&lt;&gt;%, |&gt;\nSymbols: (), [], {}, \"\", #\nCommenting, structure, and help functions (?function, args())\nUsing R scripts vs.¬†R Markdown vs.¬†Quarto\n\nIn this section, we walk through the fundamental syntax building blocks of R.\nMastering these basics helps write cleaner, more efficient, and more readable code.\nüîπ Operators\nIn R, operators are used to perform operations on objects and values:\n\nAssignment operators (&lt;-, =) store values into objects.\nPipe operators (%&gt;%, %&lt;&gt;%, |&gt;) allow chaining multiple commands together.\nComparison operators (==, !=, &lt;, &gt;) compare values for equality or relational logic.\nLogical operators (&, |, !) build logical expressions (AND, OR, NOT).\nFormula operator (~) defines models and formulas, e.g., y ~ x1 + x2.\nMembership operator (%in%) checks whether an element belongs to a set.\nPackage access operator (::) calls a function from a package without loading the full package.\n\nüîπ Symbols\nSymbols are special characters used in structuring R code:\n\n() : Used for function calls and setting arguments.\n[] : Indexing vectors, matrices, or data frames.\n{} : Grouping multiple expressions into a code block.\n\"\" or '' : Define character strings.\n# : Create comments that are ignored during code execution.\n\nüîπ Help Functions\n\n?function_name : Access the help documentation for any function.\nargs(function_name) : Display the arguments a function accepts.\nüîπ Scripting in .R, .Rmd, .qmd\n\n\n\n\n\n\n\n\nFormat\nDescription\nBest Use Case\n\n\n\n\n.R\nBasic R script. Contains code only, no formatting or output.\nExploratory coding, testing snippets\n\n\n.Rmd\nR Markdown file. Supports code + text + output in one file.\nReproducible reports, presentations, notebooks\n\n\n.qmd\nQuarto document. Successor to R Markdown with more flexible publishing.\nPolished reports, web publishing, multi-language\n\n\n\n\nüìä R Syntax Essentials Summary\n\n\n\n\n\n\n\n\nElement\nSymbol / Syntax\nWhat It Does\n\n\n\n\nAssignment\n&lt;-, =\nAssign a value to a variable (e.g., x &lt;- 5)\n\n\nPipe\n%&gt;%, %&lt;&gt;%, |&gt;\nPass or transform results between functions\n\n\nComparison\n==, !=, &lt;, &gt;\nCompare values (equal, not equal, less than, etc.)\n\n\nLogical\n&, |, !\nLogical conditions: AND, OR, NOT\n\n\nFormula\n~\nDefine model formulas (e.g., y ~ x1 + x2)\n\n\nMembership Test\n%in%\nCheck if an element exists within a vector\n\n\nPackage Function Access\n::\nCall a function from a specific package without loading it\n\n\nFunction Call\n()\nCall a function with arguments (e.g., mean(x))\n\n\nIndexing\n[]\nAccess parts of data structures (e.g., x[1], df[2,3])\n\n\nCode Block\n{}\nGroup multiple lines (loops, conditionals)\n\n\nStrings\n\"text\", 'text'\nDefine character strings\n\n\nCommenting\n#\nInsert a comment ignored by R\n\n\nHelp Functions\n?function, args(function)\nAccess help or check function arguments\n\n\nOutput Format\n.R, .Rmd, .qmd\nFile formats for scripting or reporting\n\n\n\n?mean # Opens the help page for the ‚Äòmean‚Äô function\nargs(mean) # Lists input arguments for ‚Äòmean‚Äô\n\n\n\nIn this section, I highlight essential RStudio shortcut keys that improve coding efficiency and simplify the workflow for scripting and reporting.\n\n\n\nShortcut\nAction\n\n\n\n\nCtrl + Z\nUndo the last action\n\n\nCtrl + Shift + Z\nRedo the undone action\n\n\nCtrl + Enter\nExecute the current line or selected block\n\n\nAlt + -\nInsert assignment operator &lt;-\n\n\nCtrl + Shift + M\nInsert pipe operator %&gt;%\n\n\nCtrl + L\nClear the console output\n\n\nCtrl + Shift + C\nComment or uncomment selected lines\n\n\nCtrl + Shift + S\nSource and run the entire script\n\n\nCtrl + Alt + I\nInsert a new R Markdown or Quarto code chunk\n\n\n\n\n\n\n\nElement | Vector | Matrix | |Data Frame | Data Table | List | Factor | Variable | Object\nThis section provides a brief overview of foundational R data structures.\nFor more detailed explanations and demonstrations, refer to:\n\nYouTube: AnalyticsHub\nGitHub: HabtamuBizuayehu Repositories\n\nUnderstanding these fundamental terms is essential for working effectively with R data analysis and wrangling.\nüîπ Brief Narration of Key Terms\n\nElement: A single piece of data, such as a number or a character.\nVector: An ordered collection of elements of the same type (numeric, character, logical).\nMatrix: A two-dimensional collection of elements arranged by rows and columns, all of the same type.\nData Frame: A two-dimensional table where each column can contain different types of data (numeric, character, factor).\nData Table: A high-performance extension from the data.table package ‚Äî for very large datasets and faster manipulation.\nList: A flexible container that can hold elements of different types and structures (vectors, data frames, even other lists).\nFactor: A special type of vector used for categorical data, storing levels internally.\nVariable: A named object that holds data (vectors, lists, data frames, etc.).\nObject: A general term for any data structure stored in R.\n\n\nüîç Summary Table: R Objects\n\n\n\n\n\n\n\nTerm\nDefinition\n\n\n\n\nElement\nA single unit of data (e.g., 5, \"apple\")\n\n\nVector\nA sequence of elements of the same type\n\n\nMatrix\nA two-dimensional collection of homogeneous elements\n\n\nData Frame\nA two-dimensional table with heterogeneous column types\n\n\nData Table\nA fast and memory-efficient data frame extension (data.table package)\n\n\nList\nA flexible container for different types of elements\n\n\nFactor\nA categorical variable with predefined levels\n\n\nVariable\nA named object that stores data\n\n\nObject\nAny entity stored in R (data, functions, models, etc.)\n\n\n\n\n\n\nThis section summarizes key chunk options and syntax used in Quarto and R Markdown.\nThese settings allow flexible control over code execution, output display, figure formatting, and reporting behavior.\n\n\n\n\n\n\n\n\n\n\n\n\nFeature\nQuarto Syntax\nDescription\n\n\n\n\nCode Chunks\n{r}\nUsed to write and execute R code. You can specify options like echo, results.\n\n\nEchoing Code\necho: true\nDisplays the code in the output (default is true). Set to false to hide the code.\n\n\nInclude Code\ninclude: false\nExecutes code but does not show the code in the final output.\n\n\nEvaluating Code\neval: false\nPrevents the code from running but still displays the code in the output.\n\n\nResults Control\nresults: 'markup' or results: 'asis'\nControls how output results are displayed (formatted or raw).\n\n\nMessage and Warnings\nmessage: false, warning: false\nControls whether messages and warnings appear in the output.\n\n\nOutput File Format\noutput: html\nSpecifies output format (html, pdf, word). Default is html.\n\n\nTable Output\nresults: 'asis' or results: 'markup'\nEnsures clean table rendering for formatted output.\n\n\nChunk Labeling\n# Label\nLabels help organize and reference code chunks easily.\n\n\nInline Code\nYour value is 2 times.\nEmbeds live code inside text for dynamic reporting.\n\n\nCaching Results\ncache: true\nSaves chunk results to avoid rerunning unchanged code. It stores the output (like objects, plots, and printed results) in a cache directory\n\n\nFigure Options\nfig.width: 7, fig.height: 5, fig.align: 'center'\nAdjusts figure size and alignment in output documents.\n\n\nOutput as LaTeX\nlatex: true\nAllows LaTeX formatting (mainly for PDFs and math expressions).\n\n\nCommenting Code\n# (within chunks)\nStandard way to comment within R code chunks.\n\n\n\n‚û°Ô∏è Mastering these options ensures smoother report generation, cleaner outputs, and faster rendering when building professional documents in Quarto or R Markdown.\n\n\n\n\n\n\nFile path setup and working with getwd(), paste()\nread_csv(), read_excel(), read.delim(), readRDS()\nReading .tsv, .dta, and .sav files (foreign and haven packages)\nReading from ZIP Files\n\nBefore we begin analyzing data in R, we need to bring it in from where it‚Äôs stored‚Äîyour computer, the cloud, or an online source.\nThere are many formats we commonly work with in public health and analytics: CSV, Excel, text files, RDS, SPSS, and others.\nBelow is a summary table of functions used to read each data type.\nüìä Reading Common Data Types in R\n\n\n\n\n\n\n\n\n\nData Type\nFunction\nPackage\nExample\n\n\n\n\nCSV\nread_csv(), read.csv()\nreadr / base\nread_csv(\"file.csv\")\n\n\nExcel (.xls/.xlsx)\nread_excel()\nreadxl\nread_excel(\"file.xlsx\")\n\n\nTab-separated (.tsv)\nread_tsv()\nreadr\nread_tsv(\"file.tsv\")\n\n\nText (.txt)\nread.delim()\nbase\nread.delim(\"file.txt\")\n\n\nStata (.dta)\nread_dta()\nhaven\nread_dta(\"file.dta\")\n\n\nSPSS (.sav)\nread_sav()\nhaven\nread_sav(\"file.sav\")\n\n\nRDS (R object)\nreadRDS()\nbase\nreadRDS(\"object.rds\")\n\n\nZIP archives\nunzip()\nutils (base)\nunzip(\"data.zip\", exdir = \"folder\")\n\n\nOnline Excel/CSV\ndownload.file() + reader\nbase + readxl\nDownload file, then read_excel(temp_file)\n\n\n\nBefore reading files, I usually set the working directory to the folder where my files are saved. This avoids typing full file paths every time.\nTo combine folder names and filenames dynamically: paste(getwd(), ‚Äúmy_data.csv‚Äù, sep = ‚Äú/‚Äù)\nReading Local Files\nOnce you‚Äôre in the right working directory, you can read in your files like below:\n\n# setwd(\"C:/Users/User/Desktop/Materials_ Course and proposals/Course Related/DataCamp/Data/Synthetic_data\")\n\npatients &lt;- read.csv(\"C:/Users/User/Desktop/Materials_ Course and proposals/Course Related/DataCamp/Data/Synthetic_data/patients.csv\")\nvaccination &lt;- read.csv(\"C:/Users/User/Desktop/Materials_ Course and proposals/Course Related/DataCamp/Data/Synthetic_data/immunizations.csv\")\n\n# medications &lt;- read.csv (paste(getwd(), \"medications.csv\", sep = \"/\"))\n\nmedications &lt;- read.csv(\"C:/Users/User/Desktop/Materials_ Course and proposals/Course Related/DataCamp/Data/Synthetic_data/medications.csv\")\n\nThese are standard CSVs and can be read using read.csv() from base R, or read_csv() from the readr package for cleaner output.\nReading from ZIP Files\nSometimes, especially when downloading from government databases or health systems, data is compressed into .zip files. In R, we can easily unzip these files and extract their contents.\nSet working directory to the folder where the zip file is located\n\n# --- Define base folder manually (safe way without setwd)\nbase_folder &lt;- \"C:/Users/User/Desktop/Materials_ Course and proposals/Course Related/DataCamp/Data/Synthetic_data\"\n\n# --- Extract ZIP file into 'procedures' folder inside base\nunzip(file.path(base_folder, \"procedures.zip\"), exdir = file.path(base_folder, \"procedures\"))\n\n# --- List extracted files\nlist.files(file.path(base_folder, \"procedures\"))\n\n[1] \"procedures\"     \"procedures.csv\"\n\n# --- Read extracted CSV\nprocedures &lt;- read.csv(file.path(base_folder, \"procedures\", \"procedures.csv\"))\n\nReading Online Files\nIf the file is online, we first download it, save it to a temporary file, and then read it:\nIt is useful when working with shared datasets, APIs, or GitHub repos.\n\n# Upload Online data\n\nurl &lt;- \"https://raw.githubusercontent.com/HabtamuBizuayehu/Data-sources/main/Breast_cancer_screening.xls\"\ntemp_file &lt;- tempfile(fileext = \".xls\")\ndownload.file(url, temp_file, mode = \"wb\")\n\nbreast_cancer_data &lt;- read_excel(temp_file)\n\n2.2 Exploring Data\n\nstr(), summary(), glimpse(), head(), tail(), count()\nViewing data: view(), nrow(), ncol()\nCleaning variable names: janitor::clean_names()\nCreating a data dictionary\nWorking with column names and types\n\nOnce we load data into R, it‚Äôs important to explore it properly before doing any analysis.\nThis step helps us understand:\n\nWhat variables we have\nHow the data is structured\nIf there are any issues (like missing values, wrong data types, weird names)\n\nIn this part, we‚Äôll look at some essential functions we often use at the very beginning of a project.\nüîç Key Tools for Exploring Data (with Important Details and Tips)\n1. str(), summary(), glimpse(), head(), tail(), count()\n\nstr(df) shows the structure of the entire dataset: number of observations (rows), number of variables (columns), and data types.\nstr(df$var) shows the structure of a specific variable (single column), useful to quickly check type and contents.\nsummary(df) gives basic descriptive statistics for all variables at once.\nsummary(df$var) gives a summary for one specific variable.\nglimpse(df) (from dplyr) provides a compact sideways overview showing each variable name, type, and preview of values.\nhead(df) shows the first 6 rows of the dataset by default.\nhead(df, n = 10) shows the first 10 rows (you can customize the number with n =).\ntail(df) shows the last 6 rows of the dataset.\ntail(df, n = 8) shows the last 8 rows.\ncount(df, var) (from dplyr) counts occurrences of each unique value in a variable.\n\n‚û°Ô∏è Using str(df$var) and summary(df$var) is a fast way to inspect just one column without needing the whole dataset.\n\n2. Viewing Data\n\nview(df) opens an Excel-like data viewer window inside RStudio for easy manual exploration.\nnrow(df) returns the number of rows.\nncol(df) returns the number of columns.\ndim(df) returns a two-number vector: (rows, columns).\n\n‚û°Ô∏è Use view(df) when you want to sort/filter manually without coding.\n\n3. Cleaning Variable Names\n\njanitor::clean_names(df) standardizes messy variable names:\n\nMakes all names lowercase\nReplaces spaces and special characters with underscores\nRemoves parentheses, punctuation, etc.\n\n\n‚û°Ô∏è Run clean_names() immediately after loading raw survey, registry, or administrative datasets.\nExample:\n\nnames(patients)\n\n [1] \"Id\"                  \"BIRTHDATE\"           \"DEATHDATE\"          \n [4] \"SSN\"                 \"DRIVERS\"             \"PASSPORT\"           \n [7] \"PREFIX\"              \"FIRST\"               \"MIDDLE\"             \n[10] \"LAST\"                \"SUFFIX\"              \"MAIDEN\"             \n[13] \"MARITAL\"             \"RACE\"                \"ETHNICITY\"          \n[16] \"GENDER\"              \"BIRTHPLACE\"          \"ADDRESS\"            \n[19] \"CITY\"                \"STATE\"               \"COUNTY\"             \n[22] \"FIPS\"                \"ZIP\"                 \"LAT\"                \n[25] \"LON\"                 \"HEALTHCARE_EXPENSES\" \"HEALTHCARE_COVERAGE\"\n[28] \"INCOME\"             \n\ntemp &lt;- janitor::clean_names(patients)\ncolnames(temp)\n\n [1] \"id\"                  \"birthdate\"           \"deathdate\"          \n [4] \"ssn\"                 \"drivers\"             \"passport\"           \n [7] \"prefix\"              \"first\"               \"middle\"             \n[10] \"last\"                \"suffix\"              \"maiden\"             \n[13] \"marital\"             \"race\"                \"ethnicity\"          \n[16] \"gender\"              \"birthplace\"          \"address\"            \n[19] \"city\"                \"state\"               \"county\"             \n[22] \"fips\"                \"zip\"                 \"lat\"                \n[25] \"lon\"                 \"healthcare_expenses\" \"healthcare_coverage\"\n[28] \"income\"             \n\nrm(temp)\n\nüîç Listing All Data Frames and Variables\nTo organize and review datasets loaded in the environment, the following workflow lists all data frames and their variables:\n\nrm (breast_cancer_data, patients)\n\n# 1. List all data frames in the environment\ndfs &lt;- ls(envir = .GlobalEnv)[sapply(ls(envir = .GlobalEnv), function(x) is.data.frame(get(x)))]\n\n# 2. For each data frame, list its variable (column) names\ndf_variables &lt;- lapply(dfs, function(df_name) {\n  vars &lt;- names(get(df_name))\n  data.frame(\n    DataFrame = df_name,\n    Variable = vars,\n    stringsAsFactors = FALSE\n  )\n})\n\n# 3. Combine into one clean table\ndf_variables_all &lt;- do.call(rbind, df_variables)\n\n# View the result\nprint(df_variables_all)\n\n     DataFrame          Variable\n1  medications             START\n2  medications              STOP\n3  medications           PATIENT\n4  medications             PAYER\n5  medications         ENCOUNTER\n6  medications              CODE\n7  medications       DESCRIPTION\n8  medications         BASE_COST\n9  medications    PAYER_COVERAGE\n10 medications         DISPENSES\n11 medications         TOTALCOST\n12 medications        REASONCODE\n13 medications REASONDESCRIPTION\n14  procedures             START\n15  procedures              STOP\n16  procedures           PATIENT\n17  procedures         ENCOUNTER\n18  procedures            SYSTEM\n19  procedures              CODE\n20  procedures       DESCRIPTION\n21  procedures         BASE_COST\n22  procedures        REASONCODE\n23  procedures REASONDESCRIPTION\n24 vaccination              DATE\n25 vaccination           PATIENT\n26 vaccination         ENCOUNTER\n27 vaccination              CODE\n28 vaccination       DESCRIPTION\n29 vaccination         BASE_COST\n\nrm (df_variables_all, df_variables) # clean working enviroment \n\n4. Creating a Data Dictionary\nA data dictionary is a simple but critical table that documents:\n\nVariable names (column names)\nDescriptions (what each variable represents)\nTypes (numeric, character, factor)\n\n‚û°Ô∏è We can automate building a basic data dictionary by combining names(), sapply(), and class() functions.\n\ndata_dictionary &lt;- data.frame(\n  Variable = names(patients),\n  Type = sapply(patients, class)\n)\n\nThe dictionary can be expanded by manually adding descriptions, coding instructions, or value mappings where necessary.\n5. Working with Column Names and Types\n\nnames(df) or colnames(df) retrieves a list of all column names.\nclass(df$var) reveals the data type of a specific variable.\nsapply(df, class) applies class() across all variables and summarizes their types.\nIf needed, variables can be recast to appropriate types.\n\nüìä Summary Table: Key Functions for Exploring Data\n\n\n\n\n\n\n\n\nTask\nFunction\nPurpose / What It Does\n\n\n\n\nView structure of dataset\nstr(df)\nShows structure: number of rows, columns, and variable types\n\n\nView structure of variable\nstr(df$var)\nShows structure/type of a specific variable\n\n\nSummarize statistics (dataset)\nsummary(df)\nProvides summary stats (min, max, mean, NA count) for all variables\n\n\nSummarize statistics (variable)\nsummary(df$var)\nSummary stats for a specific variable\n\n\nCompact structure overview\nglimpse(df)\nQuick, sideways compact view of dataset (from dplyr)\n\n\nPreview first rows\nhead(df), head(df, n = 10)\nDisplays first 6 or specified number of rows\n\n\nPreview last rows\ntail(df), tail(df, n = 8)\nDisplays last 6 or specified number of rows\n\n\nCount frequencies\ncount(df, var)\nCounts unique values and frequency of a specified variable\n\n\nOpen full viewer\nview(df)\nOpens Excel-style data viewer window (RStudio)\n\n\nCheck number of rows\nnrow(df)\nReturns number of rows (observations)\n\n\nCheck number of columns\nncol(df)\nReturns number of columns (variables)\n\n\nCheck both dimensions\ndim(df)\nReturns (rows, columns) as a two-number vector\n\n\nClean column names\njanitor::clean_names(df)\nConverts messy names into lowercase, underscore-separated names\n\n\nList variable names\nnames(df), colnames(df)\nLists all column names in a data frame\n\n\nCheck variable type\nclass(df$var)\nReturns data type of a specific variable\n\n\nCheck types for all variables\nsapply(df, class)\nReturns data types for every column in the dataset\n\n\nCreate basic data dictionary\ndata.frame(Variable = names(df), Type = sapply(df, class))\nTable summarizing variable names and types\n\n\nList all data frames in environment\ndfs &lt;- ls(...)[sapply(...)]\nIdentifies and lists all data frames currently loaded\n\n\nList all variables from all data frames\nlapply(dfs, function(x) names(get(x)))\nCreates table listing data frames and their variables\n\n\n\nNow I can apply some of the above to my datasets (df): such as breast_cancer_data, vaccination, patients\n\nbreast_cancer_data_demo &lt;- breast_cancer_data %&gt;%\n  select(sa3name, state, year, part50_74, rate50_74)\n\n# Structure of the demo dataset\nstr(breast_cancer_data_demo)\n\n'data.frame':   1364 obs. of  5 variables:\n $ sa3name  : chr  \"Queanbeyan\" \"Queanbeyan\" \"Queanbeyan\" \"Queanbeyan\" ...\n $ state    : chr  \"NSW\" \"NSW\" \"NSW\" \"NSW\" ...\n $ year     : int  201617 201718 201819 201920 201617 201718 201819 201920 201617 201718 ...\n $ part50_74: num  4875 5048 5276 5179 1850 ...\n $ rate50_74: num  60.5 60.8 61.4 58.2 59.7 ...\n\n# Summary statistics for rate50_74\nsummary(breast_cancer_data_demo$rate50_74)\n\n   Min. 1st Qu.  Median    Mean 3rd Qu.    Max.    NA's \n   5.40   50.07   54.50   53.63   57.88   80.20     135 \n\n# Display first 10 rows\nhead(breast_cancer_data_demo, 10)\n\n           sa3name state   year part50_74 rate50_74\n1       Queanbeyan   NSW 201617      4875  60.50000\n2       Queanbeyan   NSW 201718      5048  60.75961\n3       Queanbeyan   NSW 201819      5276  61.43839\n4       Queanbeyan   NSW 201920      5179  58.16834\n5  Snowy Mountains   NSW 201617      1850  59.70000\n6  Snowy Mountains   NSW 201718      1910  61.54862\n7  Snowy Mountains   NSW 201819      2039  65.12912\n8  Snowy Mountains   NSW 201920      1979  62.23419\n9      South Coast   NSW 201617      9469  62.80000\n10     South Coast   NSW 201718      9565  62.94230\n\n# Count number of records\ncount(breast_cancer_data_demo)\n\n     n\n1 1364\n\n# Show variable names\nnames(breast_cancer_data_demo)\n\n[1] \"sa3name\"   \"state\"     \"year\"      \"part50_74\" \"rate50_74\"\n\n\n\n\n\n\nIn this part, we focus on mastering core data wrangling skills using the dplyr package, one of the most powerful tools in R for data manipulation.\nWe will learn how to select, rename, create, modify, group, sort, slice, and reshape datasets.\nThese operations form the foundation for preparing clean, organized, and analysis-ready data.\nEach subsection introduces a set of essential verbs (select(), mutate(), group_by(), etc.) that allow for data transformation pipelines. Examples and practical applications will be provided throughout to demonstrate how to use dplyr.\n\n\n\n\nselect(), rename(), relocate()`\nColumn helpers: starts_with(), ends_with(), contains(), last_clos, matches\nAllow modifying entire groups of column names by adding prefixes or suffixes\nHandling null/missing column names\n\nSelecting, reordering, and renaming variables is often the first step when preparing a dataset for analysis.\nIn dplyr, we use functions such as select(), rename(), and relocate() to organize variables, clean up data, and prepare for transformations.\nDropping unnecessary columns or reordering variables can make the data cleaner, faster to work with, and easier to understand.\nAdditional tools allow modifying groups of column names by adding prefixes or suffixes, and safely handling missing columns during selection.\n\nüîπ Summary of Functions for Selecting, Reordering, Dropping, and Renaming\n\n\n\n\n\n\n\n\nTask\nFunction\nPurpose\n\n\n\n\nSelect specific columns\nselect()\nChoose a subset of columns based on name or condition\n\n\nRename columns\nrename()\nRename one or multiple columns\n\n\nRelocate columns\nrelocate()\nMove selected columns to a new position\n\n\nReorder manually\nselect(a, b, c, everything())\nExplicitly define column order\n\n\nFind columns by pattern\nstarts_with(), ends_with(), contains(), matches()\nSelect columns matching a pattern\n\n\nDrop single column\nselect(-col1)\nRemove one variable\n\n\nDrop multiple columns\nselect(-col1, -col2)\nRemove several variables\n\n\nDrop by pattern\nselect(-starts_with(\"temp\")), select(-contains(\"score\"))\nRemove variables based on naming patterns\n\n\nAdd prefix to column names\nrename_with(~ paste0(\"prefix_\", .x))\nAdd a prefix to selected columns\n\n\nAdd suffix to column names\nrename_with(~ paste0(.x, \"_suffix\"))\nAdd a suffix to selected columns\n\n\nHandle missing columns safely\nif(\"var\" %in% names(df)) {}\nAvoid errors when column does not exist\n\n\n\n\n‚û°Ô∏è These techniques allow quick restructuring of datasets, improving workflow efficiency and clarity.\n\nüîπ Examples Using the vaccination Dataset\n\n# Selecting specific columns manually\nbreast_selected &lt;- breast_cancer_data %&gt;%\n  select(sa3code, sa3name, year, part50_74, pop50_74)\n\nhead(breast_selected, n = 3)\n\n  sa3code    sa3name   year part50_74 pop50_74\n1   10102 Queanbeyan 201617      4875     8052\n2   10102 Queanbeyan 201718      5048     8309\n3   10102 Queanbeyan 201819      5276     8588\n\n# Reordering columns manually (bring year, sa3name, state first)\nbc_reorder_manual &lt;- breast_cancer_data %&gt;%\n  select(year, sa3name, state, everything())\n\nhead(bc_reorder_manual, n = 3)\n\n    year    sa3name state sa3code sa3coden part50_74 pop50_74 rate50_74\n1 201617 Queanbeyan   NSW   10102    10102      4875     8052  60.50000\n2 201718 Queanbeyan   NSW   10102    10102      5048     8309  60.75961\n3 201819 Queanbeyan   NSW   10102    10102      5276     8588  61.43839\n  agen50_74 expct50_74 part50_69 pop50_69 rate50_69 agen50_69 expct50_69\n1         3       4428      4309     7145  60.30000         2       3929\n2         3       4553      4448     7338  60.62238         2       4013\n3         3       4706      4629     7548  61.33203         2       4113\n  part50_54 pop50_54 rate50_54 agen50_54 expct50_54 part55_59 pop55_59\n1      1284     2251  57.00000         1       1118      1188     1970\n2      1285     2306  55.72035         1       1143      1260     2030\n3      1375     2342  58.70977         1       1166      1252     2093\n  rate55_59 agen55_59 expct55_59 part60_64 pop60_64 rate60_64 agen60_64\n1  60.30000         4       1046      1012     1625  62.30000         5\n2  62.09035         4       1069      1048     1646  63.69947         5\n3  59.81504         4       1098      1105     1689  65.43657         5\n  expct60_64 part65_69 pop65_69 rate65_69 agen65_69 expct65_69 part70_74\n1        950       826     1300  63.50000         6        781       566\n2        953       855     1357  63.02558         6        812       600\n3        967       898     1426  63.00429         6        849       647\n  pop70_74 rate70_74 agen70_74 expct70_74\n1      907  62.40000         7        498\n2      971  61.79725         7        541\n3     1040  62.21032         7        585\n\n# Relocating specific columns before another variable\nbc_relocate_before &lt;- breast_cancer_data %&gt;%\n  relocate(part50_74, pop50_74, .before = rate50_74)\n\nhead(bc_relocate_before, n = 3)\n\n  sa3code sa3coden    sa3name state   year part50_74 pop50_74 rate50_74\n1   10102    10102 Queanbeyan   NSW 201617      4875     8052  60.50000\n2   10102    10102 Queanbeyan   NSW 201718      5048     8309  60.75961\n3   10102    10102 Queanbeyan   NSW 201819      5276     8588  61.43839\n  agen50_74 expct50_74 part50_69 pop50_69 rate50_69 agen50_69 expct50_69\n1         3       4428      4309     7145  60.30000         2       3929\n2         3       4553      4448     7338  60.62238         2       4013\n3         3       4706      4629     7548  61.33203         2       4113\n  part50_54 pop50_54 rate50_54 agen50_54 expct50_54 part55_59 pop55_59\n1      1284     2251  57.00000         1       1118      1188     1970\n2      1285     2306  55.72035         1       1143      1260     2030\n3      1375     2342  58.70977         1       1166      1252     2093\n  rate55_59 agen55_59 expct55_59 part60_64 pop60_64 rate60_64 agen60_64\n1  60.30000         4       1046      1012     1625  62.30000         5\n2  62.09035         4       1069      1048     1646  63.69947         5\n3  59.81504         4       1098      1105     1689  65.43657         5\n  expct60_64 part65_69 pop65_69 rate65_69 agen65_69 expct65_69 part70_74\n1        950       826     1300  63.50000         6        781       566\n2        953       855     1357  63.02558         6        812       600\n3        967       898     1426  63.00429         6        849       647\n  pop70_74 rate70_74 agen70_74 expct70_74\n1      907  62.40000         7        498\n2      971  61.79725         7        541\n3     1040  62.21032         7        585\n\n# Relocating specific columns after another variable\nbc_relocate_after &lt;- breast_cancer_data %&gt;%\n  relocate(sa3name, state, .after = year)\n\nhead(bc_relocate_after, n = 3)\n\n  sa3code sa3coden   year    sa3name state part50_74 pop50_74 rate50_74\n1   10102    10102 201617 Queanbeyan   NSW      4875     8052  60.50000\n2   10102    10102 201718 Queanbeyan   NSW      5048     8309  60.75961\n3   10102    10102 201819 Queanbeyan   NSW      5276     8588  61.43839\n  agen50_74 expct50_74 part50_69 pop50_69 rate50_69 agen50_69 expct50_69\n1         3       4428      4309     7145  60.30000         2       3929\n2         3       4553      4448     7338  60.62238         2       4013\n3         3       4706      4629     7548  61.33203         2       4113\n  part50_54 pop50_54 rate50_54 agen50_54 expct50_54 part55_59 pop55_59\n1      1284     2251  57.00000         1       1118      1188     1970\n2      1285     2306  55.72035         1       1143      1260     2030\n3      1375     2342  58.70977         1       1166      1252     2093\n  rate55_59 agen55_59 expct55_59 part60_64 pop60_64 rate60_64 agen60_64\n1  60.30000         4       1046      1012     1625  62.30000         5\n2  62.09035         4       1069      1048     1646  63.69947         5\n3  59.81504         4       1098      1105     1689  65.43657         5\n  expct60_64 part65_69 pop65_69 rate65_69 agen65_69 expct65_69 part70_74\n1        950       826     1300  63.50000         6        781       566\n2        953       855     1357  63.02558         6        812       600\n3        967       898     1426  63.00429         6        849       647\n  pop70_74 rate70_74 agen70_74 expct70_74\n1      907  62.40000         7        498\n2      971  61.79725         7        541\n3     1040  62.21032         7        585\n\n# Dropping one variable\nbc_drop_one &lt;- breast_cancer_data %&gt;%\n  select(-expct50_74)\n\nhead(bc_drop_one, n = 3)\n\n  sa3code sa3coden    sa3name state   year part50_74 pop50_74 rate50_74\n1   10102    10102 Queanbeyan   NSW 201617      4875     8052  60.50000\n2   10102    10102 Queanbeyan   NSW 201718      5048     8309  60.75961\n3   10102    10102 Queanbeyan   NSW 201819      5276     8588  61.43839\n  agen50_74 part50_69 pop50_69 rate50_69 agen50_69 expct50_69 part50_54\n1         3      4309     7145  60.30000         2       3929      1284\n2         3      4448     7338  60.62238         2       4013      1285\n3         3      4629     7548  61.33203         2       4113      1375\n  pop50_54 rate50_54 agen50_54 expct50_54 part55_59 pop55_59 rate55_59\n1     2251  57.00000         1       1118      1188     1970  60.30000\n2     2306  55.72035         1       1143      1260     2030  62.09035\n3     2342  58.70977         1       1166      1252     2093  59.81504\n  agen55_59 expct55_59 part60_64 pop60_64 rate60_64 agen60_64 expct60_64\n1         4       1046      1012     1625  62.30000         5        950\n2         4       1069      1048     1646  63.69947         5        953\n3         4       1098      1105     1689  65.43657         5        967\n  part65_69 pop65_69 rate65_69 agen65_69 expct65_69 part70_74 pop70_74\n1       826     1300  63.50000         6        781       566      907\n2       855     1357  63.02558         6        812       600      971\n3       898     1426  63.00429         6        849       647     1040\n  rate70_74 agen70_74 expct70_74\n1  62.40000         7        498\n2  61.79725         7        541\n3  62.21032         7        585\n\n# Dropping multiple variables\nbc_drop_multiple &lt;- breast_cancer_data %&gt;%\n  select(-expct50_74, -expct50_69)\n\nhead(bc_drop_multiple, n = 3)\n\n  sa3code sa3coden    sa3name state   year part50_74 pop50_74 rate50_74\n1   10102    10102 Queanbeyan   NSW 201617      4875     8052  60.50000\n2   10102    10102 Queanbeyan   NSW 201718      5048     8309  60.75961\n3   10102    10102 Queanbeyan   NSW 201819      5276     8588  61.43839\n  agen50_74 part50_69 pop50_69 rate50_69 agen50_69 part50_54 pop50_54 rate50_54\n1         3      4309     7145  60.30000         2      1284     2251  57.00000\n2         3      4448     7338  60.62238         2      1285     2306  55.72035\n3         3      4629     7548  61.33203         2      1375     2342  58.70977\n  agen50_54 expct50_54 part55_59 pop55_59 rate55_59 agen55_59 expct55_59\n1         1       1118      1188     1970  60.30000         4       1046\n2         1       1143      1260     2030  62.09035         4       1069\n3         1       1166      1252     2093  59.81504         4       1098\n  part60_64 pop60_64 rate60_64 agen60_64 expct60_64 part65_69 pop65_69\n1      1012     1625  62.30000         5        950       826     1300\n2      1048     1646  63.69947         5        953       855     1357\n3      1105     1689  65.43657         5        967       898     1426\n  rate65_69 agen65_69 expct65_69 part70_74 pop70_74 rate70_74 agen70_74\n1  63.50000         6        781       566      907  62.40000         7\n2  63.02558         6        812       600      971  61.79725         7\n3  63.00429         6        849       647     1040  62.21032         7\n  expct70_74\n1        498\n2        541\n3        585\n\n# Dropping variables by pattern (e.g., columns ending with \"_69\")\nbc_drop_by_pattern &lt;- breast_cancer_data %&gt;%\n  select(-ends_with(\"_69\"))\n\nhead(bc_drop_by_pattern, n = 3)\n\n  sa3code sa3coden    sa3name state   year part50_74 pop50_74 rate50_74\n1   10102    10102 Queanbeyan   NSW 201617      4875     8052  60.50000\n2   10102    10102 Queanbeyan   NSW 201718      5048     8309  60.75961\n3   10102    10102 Queanbeyan   NSW 201819      5276     8588  61.43839\n  agen50_74 expct50_74 part50_54 pop50_54 rate50_54 agen50_54 expct50_54\n1         3       4428      1284     2251  57.00000         1       1118\n2         3       4553      1285     2306  55.72035         1       1143\n3         3       4706      1375     2342  58.70977         1       1166\n  part55_59 pop55_59 rate55_59 agen55_59 expct55_59 part60_64 pop60_64\n1      1188     1970  60.30000         4       1046      1012     1625\n2      1260     2030  62.09035         4       1069      1048     1646\n3      1252     2093  59.81504         4       1098      1105     1689\n  rate60_64 agen60_64 expct60_64 part70_74 pop70_74 rate70_74 agen70_74\n1  62.30000         5        950       566      907  62.40000         7\n2  63.69947         5        953       600      971  61.79725         7\n3  65.43657         5        967       647     1040  62.21032         7\n  expct70_74\n1        498\n2        541\n3        585\n\n# Renaming a column for clarity\nbreast_renamed &lt;- breast_selected %&gt;%\n  rename(SA3_Code = sa3code, SA3_Name = sa3name, Year = year)\n\nhead(breast_renamed, n = 3)\n\n  SA3_Code   SA3_Name   Year part50_74 pop50_74\n1    10102 Queanbeyan 201617      4875     8052\n2    10102 Queanbeyan 201718      5048     8309\n3    10102 Queanbeyan 201819      5276     8588\n\n# Adding a prefix to all column names\nbc_prefixed &lt;- breast_cancer_data %&gt;%\n  rename_with(~ paste0(\"bc_\", .x))\n\nhead(bc_prefixed, n = 3)\n\n  bc_sa3code bc_sa3coden bc_sa3name bc_state bc_year bc_part50_74 bc_pop50_74\n1      10102       10102 Queanbeyan      NSW  201617         4875        8052\n2      10102       10102 Queanbeyan      NSW  201718         5048        8309\n3      10102       10102 Queanbeyan      NSW  201819         5276        8588\n  bc_rate50_74 bc_agen50_74 bc_expct50_74 bc_part50_69 bc_pop50_69 bc_rate50_69\n1     60.50000            3          4428         4309        7145     60.30000\n2     60.75961            3          4553         4448        7338     60.62238\n3     61.43839            3          4706         4629        7548     61.33203\n  bc_agen50_69 bc_expct50_69 bc_part50_54 bc_pop50_54 bc_rate50_54 bc_agen50_54\n1            2          3929         1284        2251     57.00000            1\n2            2          4013         1285        2306     55.72035            1\n3            2          4113         1375        2342     58.70977            1\n  bc_expct50_54 bc_part55_59 bc_pop55_59 bc_rate55_59 bc_agen55_59\n1          1118         1188        1970     60.30000            4\n2          1143         1260        2030     62.09035            4\n3          1166         1252        2093     59.81504            4\n  bc_expct55_59 bc_part60_64 bc_pop60_64 bc_rate60_64 bc_agen60_64\n1          1046         1012        1625     62.30000            5\n2          1069         1048        1646     63.69947            5\n3          1098         1105        1689     65.43657            5\n  bc_expct60_64 bc_part65_69 bc_pop65_69 bc_rate65_69 bc_agen65_69\n1           950          826        1300     63.50000            6\n2           953          855        1357     63.02558            6\n3           967          898        1426     63.00429            6\n  bc_expct65_69 bc_part70_74 bc_pop70_74 bc_rate70_74 bc_agen70_74\n1           781          566         907     62.40000            7\n2           812          600         971     61.79725            7\n3           849          647        1040     62.21032            7\n  bc_expct70_74\n1           498\n2           541\n3           585\n\n# Adding a suffix to all column names\nbc_suffixed &lt;- breast_cancer_data %&gt;%\n  rename_with(~ paste0(.x, \"_info\"))\n\nhead(bc_suffixed, n = 3)\n\n  sa3code_info sa3coden_info sa3name_info state_info year_info part50_74_info\n1        10102         10102   Queanbeyan        NSW    201617           4875\n2        10102         10102   Queanbeyan        NSW    201718           5048\n3        10102         10102   Queanbeyan        NSW    201819           5276\n  pop50_74_info rate50_74_info agen50_74_info expct50_74_info part50_69_info\n1          8052       60.50000              3            4428           4309\n2          8309       60.75961              3            4553           4448\n3          8588       61.43839              3            4706           4629\n  pop50_69_info rate50_69_info agen50_69_info expct50_69_info part50_54_info\n1          7145       60.30000              2            3929           1284\n2          7338       60.62238              2            4013           1285\n3          7548       61.33203              2            4113           1375\n  pop50_54_info rate50_54_info agen50_54_info expct50_54_info part55_59_info\n1          2251       57.00000              1            1118           1188\n2          2306       55.72035              1            1143           1260\n3          2342       58.70977              1            1166           1252\n  pop55_59_info rate55_59_info agen55_59_info expct55_59_info part60_64_info\n1          1970       60.30000              4            1046           1012\n2          2030       62.09035              4            1069           1048\n3          2093       59.81504              4            1098           1105\n  pop60_64_info rate60_64_info agen60_64_info expct60_64_info part65_69_info\n1          1625       62.30000              5             950            826\n2          1646       63.69947              5             953            855\n3          1689       65.43657              5             967            898\n  pop65_69_info rate65_69_info agen65_69_info expct65_69_info part70_74_info\n1          1300       63.50000              6             781            566\n2          1357       63.02558              6             812            600\n3          1426       63.00429              6             849            647\n  pop70_74_info rate70_74_info agen70_74_info expct70_74_info\n1           907       62.40000              7             498\n2           971       61.79725              7             541\n3          1040       62.21032              7             585\n\n# Handling missing columns safely during selection\nif (\"non_existing_column\" %in% names(breast_cancer_data)) {\n  bc_safe_select &lt;- breast_cancer_data %&gt;%\n    select(non_existing_column)\n  head(bc_safe_select, n = 3)\n} else {\n  message(\"Column 'non_existing_column' not found in breast_cancer_data.\")\n}\n\nColumn 'non_existing_column' not found in breast_cancer_data.\n\n# ....................................................\n# Remove all temporary objects created in this chunk\n# ....................................................\nrm(breast_selected, breast_renamed, bc_drop_one, bc_drop_multiple, bc_drop_by_pattern,\n   bc_reorder_manual, bc_relocate_before, bc_relocate_after,\n   bc_prefixed, bc_suffixed)\n\n\n\n\n\nmutate(), transmute(), recoding, case_when(), if_else()\nstr_detect(), regex(), %in%\nCreating dummy/flag variables\nString manipulation: strsplit(), sub(), gsub(), tolower(), `janitor::clean_names()`\n\nCreating new variables or modifying existing ones is a key part of preparing data for analysis.\nIn dplyr, we use functions like mutate() and transmute() to add, transform, or recode variables.\nWe can also create conditional variables with case_when() or if_else(), and apply string operations such as splitting, replacing, or converting text.\nThese steps help structure the data more logically, highlight important features, or derive new indicators for analysis.\n\nüîπ Summary of Functions for Creating and Modifying Variables\n\n\n\n\n\n\n\n\nTask\nFunction\nPurpose\n\n\n\n\nCreate or modify variables\nmutate()\nAdd or transform variables, keeping all columns\n\n\nCreate new variables only\ntransmute()\nKeep only new variables created\n\n\nConditional variable creation\ncase_when()\nCreate new variables based on multiple conditions\n\n\nSimple conditional assignment\nif_else()\nAssign based on TRUE/FALSE logic\n\n\nSplit strings into parts\nstrsplit()\nSplit a string into components\n\n\nReplace text (first occurrence)\nsub()\nReplace first match of a pattern\n\n\nReplace text (all occurrences)\ngsub()\nReplace all matches of a pattern\n\n\nConvert text to lowercase\ntolower()\nStandardize text to lowercase\n\n\nDetect text patterns\nstr_detect()\nCheck if a pattern exists in text\n\n\nFlexible pattern matching\nregex()\nUse regular expressions for complex patterns\n\n\nMembership check\n%in%\nTest if a value is part of a group\n\n\n\n\n‚û°Ô∏è These functions allow transforming the dataset systematically to extract new features, categorize information, or clean fields.\n\n# Creating and Modifying Variables (patients dataset)\n\n# Creating a new age group variable\npatients_mutated &lt;- patients %&gt;%\n  mutate(age_group = if_else(BIRTHDATE &lt;= as.Date(\"1970-01-01\"), \"Below 70\", \"70+\")) %&gt;%\n  relocate(age_group, .after = BIRTHDATE) %&gt;%\n  select(-Id, -DEATHDATE, -SSN, -LAT, -LON, -SUFFIX, -ZIP)\n\nhead(patients_mutated, 10)\n\n    BIRTHDATE age_group   DRIVERS   PASSPORT PREFIX       FIRST       MIDDLE\n1  1994-02-06       70+ S99996852 X47758697X    Mr.   Joshua658      Alvin56\n2  1968-08-06  Below 70 S99993577 X28173268X    Mr.   Bennie663             \n3  2008-12-21       70+                               Hunter736  Mckinley734\n4  1994-01-27       70+ S99995100 X83694889X   Mrs.   Carlyn477 Florencia449\n5  2019-07-27       70+                                 Robin66    Jeramy610\n6  2019-04-18       70+                               Arthur650             \n7  2013-08-10       70+                                 Caryl47     Lelia627\n8  1968-08-06  Below 70 S99911538 X37637991X    Mr.  Willian804    Shelton25\n9  2006-07-02       70+ S99943171               Ms. Domenica436             \n10 1948-05-28  Below 70 S99941458 X59458953X    Mr.  Arnulfo253    Jordan900\n            LAST   MAIDEN MARITAL  RACE   ETHNICITY GENDER\n1       Kunde533                M white nonhispanic      M\n2       Ebert178                D white nonhispanic      M\n3     Gerlach374                  white nonhispanic      M\n4  Williamson769 Rogahn59       M asian nonhispanic      F\n5   Gleichner915                  white nonhispanic      M\n6     Roberts511                  white nonhispanic      M\n7    Kassulke119                  white nonhispanic      F\n8      Keeling57                M white nonhispanic      M\n9         Rau926                  white    hispanic      F\n10  Jaskolski867                D white nonhispanic      M\n                         BIRTHPLACE                     ADDRESS         CITY\n1         Boston  Massachusetts  US            811 Kihn Viaduct    Braintree\n2       Chicopee  Massachusetts  US 975 Pfannerstill Throughway    Braintree\n3        Spencer  Massachusetts  US             548 Heller Lane Mattapoisett\n4       Franklin  Massachusetts  US  160 Fadel Crossroad Apt 65      Wareham\n5       Brockton  Massachusetts  US      766 Grant Loaf Unit 15    Groveland\n6       Plymouth  Massachusetts  US            866 Kulas Harbor    Cambridge\n7  East Falmouth  Massachusetts  US            578 Dickens Camp    Arlington\n8        Methuen  Massachusetts  US      848 Ebert Knoll Unit 7    Braintree\n9        Maynard  Massachusetts  US             963 Senger Fort    Haverhill\n10        Boston  Massachusetts  US    757 Lockman Annex Apt 10   Georgetown\n           STATE           COUNTY  FIPS HEALTHCARE_EXPENSES HEALTHCARE_COVERAGE\n1  Massachusetts   Norfolk County 25021            56904.96            18019.99\n2  Massachusetts   Norfolk County 25021           124024.12             1075.06\n3  Massachusetts  Plymouth County    NA            45645.06             6154.94\n4  Massachusetts  Plymouth County    NA            12895.15           659951.61\n5  Massachusetts     Essex County    NA            18500.02             5493.57\n6  Massachusetts Middlesex County 25017            14478.23              693.39\n7  Massachusetts Middlesex County 25017             9821.14            27142.51\n8  Massachusetts   Norfolk County 25021           175817.63            55473.97\n9  Massachusetts     Essex County 25009            52933.16            11941.44\n10 Massachusetts     Essex County    NA           242013.44           322768.97\n   INCOME\n1  100511\n2   49737\n3  133816\n4   17382\n5   52159\n6   75767\n7   58294\n8   49737\n9   77756\n10  35255\n\n# extract month and year from date in form of date is YYYY-MM-DD HH:MM:SS\nstr (vaccination$DATE) # date is YYYY-MM-DD HH:MM:SS format.\n\n chr [1:1619] \"2016-04-10T09:04:48Z\" \"2016-04-10T09:04:48Z\" ...\n\nvaccination &lt;- vaccination %&gt;%\n  mutate(\n    vacc_date = as.Date(strptime(DATE, format = \"%Y-%m-%dT%H:%M:%SZ\")),  # First create vacc_date\n    year = format(vacc_date, \"%Y\"),         # Extract year\n    month = format(vacc_date, \"%B\")          # Extract full month name (January, February, etc.)\n  )\n\ncolnames(vaccination)\n\n[1] \"DATE\"        \"PATIENT\"     \"ENCOUNTER\"   \"CODE\"        \"DESCRIPTION\"\n[6] \"BASE_COST\"   \"vacc_date\"   \"year\"        \"month\"      \n\nhead(vaccination)\n\n                  DATE                              PATIENT\n1 2016-04-10T09:04:48Z 30a6452c-4297-a1ac-977a-6a23237c7b46\n2 2016-04-10T09:04:48Z 30a6452c-4297-a1ac-977a-6a23237c7b46\n3 2016-04-10T09:04:48Z 30a6452c-4297-a1ac-977a-6a23237c7b46\n4 2016-04-10T09:04:48Z 30a6452c-4297-a1ac-977a-6a23237c7b46\n5 2002-10-29T19:07:21Z 34a4dcc4-35fb-6ad5-ab98-be285c586a4f\n6 2005-11-01T19:07:21Z 34a4dcc4-35fb-6ad5-ab98-be285c586a4f\n                             ENCOUNTER CODE\n1 0b03e41b-06a6-66fa-b972-acc5a83b134a  140\n2 0b03e41b-06a6-66fa-b972-acc5a83b134a  113\n3 0b03e41b-06a6-66fa-b972-acc5a83b134a   43\n4 0b03e41b-06a6-66fa-b972-acc5a83b134a  114\n5 30ab48ec-35a7-7704-86e5-113ef6a90c03  140\n6 d00bda57-b134-0654-e152-831ef486da53  140\n                                                   DESCRIPTION BASE_COST\n1           Influenza  seasonal  injectable  preservative free       136\n2 Td (adult)  5 Lf tetanus toxoid  preservative free  adsorbed       136\n3                                                 Hep B  adult       136\n4                                          meningococcal MCV4P       136\n5           Influenza  seasonal  injectable  preservative free       136\n6           Influenza  seasonal  injectable  preservative free       136\n   vacc_date year    month\n1 2016-04-10 2016    April\n2 2016-04-10 2016    April\n3 2016-04-10 2016    April\n4 2016-04-10 2016    April\n5 2002-10-29 2002  October\n6 2005-11-01 2005 November\n\n# Creating a dataset keeping only new variables (transmute)\npatients_transmuted &lt;- patients %&gt;%\n  transmute(\n    full_name = paste(FIRST, LAST, sep = \" \"), \n    birth_year = format(as.Date(BIRTHDATE), \"%Y\")\n  )\n\nhead (patients_transmuted)\n\n                full_name birth_year\n1      Joshua658 Kunde533       1994\n2      Bennie663 Ebert178       1968\n3    Hunter736 Gerlach374       2008\n4 Carlyn477 Williamson769       1994\n5    Robin66 Gleichner915       2019\n6    Arthur650 Roberts511       2019\n\n# generate a birth_year_group variable based on birth_year values\n\npatients_transmuted &lt;- patients_transmuted %&gt;%\n  mutate(birth_year_group = case_when(\n    birth_year &lt; 1940 ~ \"Before 1940\",\n    birth_year &gt;= 1940 & birth_year &lt;= 1959 ~ \"1940‚Äì1959\",\n    birth_year &gt;= 1960 & birth_year &lt;= 1979 ~ \"1960‚Äì1979\",\n    birth_year &gt;= 1980 & birth_year &lt;= 1999 ~ \"1980‚Äì1999\",\n    birth_year &gt;= 2000 ~ \"2000 and later\",\n    TRUE ~ NA_character_\n  ))\n\nhead(patients_transmuted)\n\n                full_name birth_year birth_year_group\n1      Joshua658 Kunde533       1994        1980‚Äì1999\n2      Bennie663 Ebert178       1968        1960‚Äì1979\n3    Hunter736 Gerlach374       2008   2000 and later\n4 Carlyn477 Williamson769       1994        1980‚Äì1999\n5    Robin66 Gleichner915       2019   2000 and later\n6    Arthur650 Roberts511       2019   2000 and later\n\n# other option to achieve similar result for the above \n\npatients_transmuted &lt;- patients_transmuted %&gt;%\n  mutate(birth_year = as.numeric(birth_year),   # Convert to numeric\n         birth_year_group = cut(birth_year,     # Apply cut()\n                                breaks = c(0, 1939, 1959, 1979, 1999, Inf),\n                                labels = c(\"Before 1940\", \"1940‚Äì1959\", \"1960‚Äì1979\", \"1980‚Äì1999\", \"2000 and later\"),\n                                right = TRUE\n         ))\n\n\nhead(patients_transmuted)\n\n                full_name birth_year birth_year_group\n1      Joshua658 Kunde533       1994        1980‚Äì1999\n2      Bennie663 Ebert178       1968        1960‚Äì1979\n3    Hunter736 Gerlach374       2008   2000 and later\n4 Carlyn477 Williamson769       1994        1980‚Äì1999\n5    Robin66 Gleichner915       2019   2000 and later\n6    Arthur650 Roberts511       2019   2000 and later\n\n# Using case_when to assign marital status values\npatients_case_when &lt;- patients %&gt;%\n  mutate(marital_status_group = case_when(\n    MARITAL == \"M\" ~ \"Married\",\n    MARITAL == \"S\" ~ \"Single\",\n    MARITAL == \"D\" ~ \"Divorced\",\n    TRUE ~ \"Unknown\"\n  )) %&gt;% \n  select(MARITAL, marital_status_group, RACE)\n\nhead(patients_case_when, n = 10)\n\n   MARITAL marital_status_group  RACE\n1        M              Married white\n2        D             Divorced white\n3                       Unknown white\n4        M              Married asian\n5                       Unknown white\n6                       Unknown white\n7                       Unknown white\n8        M              Married white\n9                       Unknown white\n10       D             Divorced white\n\ntable(patients_case_when$marital_status, useNA = \"ifany\")  # Show missing values in the table\n\n\nDivorced  Married   Single  Unknown \n      15       33       12       46 \n\n# Recode marital status while leaving unknown values as missing\npatients_case_when &lt;- patients_case_when %&gt;%\n  mutate(marital_2group = case_when(\n    MARITAL == \"M\" ~ \"Partnered\",\n    MARITAL == \"D\" | MARITAL == \"S\" | MARITAL == \"W\" ~ \"Not partnered\",\n    TRUE ~ NA_character_  # Replaces unknown values with missing (NA)\n  )) \n\nhead(patients_case_when)\n\n  MARITAL marital_status_group  RACE marital_2group\n1       M              Married white      Partnered\n2       D             Divorced white  Not partnered\n3                      Unknown white           &lt;NA&gt;\n4       M              Married asian      Partnered\n5                      Unknown white           &lt;NA&gt;\n6                      Unknown white           &lt;NA&gt;\n\n# Recode race status while leaving unknown values as missing\npatients_case_when &lt;- patients_case_when %&gt;%\n  mutate(race_grouped = case_when(\n    RACE == 'white' ~ \"White\",\n    RACE == \"asian\" ~ \"Asian\",\n    RACE == \"native\" | RACE == \"other\" ~ \"Other\",\n    TRUE ~ NA_character_\n  )) %&gt;% \n  select(RACE, race_grouped)\n\nhead(patients_case_when, n=10)\n\n    RACE race_grouped\n1  white        White\n2  white        White\n3  white        White\n4  asian        Asian\n5  white        White\n6  white        White\n7  white        White\n8  white        White\n9  white        White\n10 white        White\n\n# Simple conditional assignment with if_else\npatients$PASSPORT[patients$PASSPORT == \"\"] &lt;- NA # formatting the variable to know missing values\nprint(sum(is.na(patients$PASSPORT))) #  31 missing value\n\n[1] 31\n\npatients_if_else &lt;- patients %&gt;%\n  mutate(has_passport = if_else(!is.na(PASSPORT), \"Yes\", \"No\")) %&gt;% \n  select(PASSPORT, has_passport)\n\nhead(patients_if_else, n = 10)\n\n     PASSPORT has_passport\n1  X47758697X          Yes\n2  X28173268X          Yes\n3        &lt;NA&gt;           No\n4  X83694889X          Yes\n5        &lt;NA&gt;           No\n6        &lt;NA&gt;           No\n7        &lt;NA&gt;           No\n8  X37637991X          Yes\n9        &lt;NA&gt;           No\n10 X59458953X          Yes\n\n# Replace the first occurrence (e.g., fix misspelled city name)\npatients_sub &lt;- patients %&gt;%\n  mutate(city_fixed = sub(\"Nwe York\", \"New York\", CITY)) %&gt;% \n  select(-Id, -DEATHDATE, -SSN, -LAT, -LON, -SUFFIX, -ZIP)\n\nhead(patients_sub, n = 3)\n\n   BIRTHDATE   DRIVERS   PASSPORT PREFIX     FIRST      MIDDLE       LAST\n1 1994-02-06 S99996852 X47758697X    Mr. Joshua658     Alvin56   Kunde533\n2 1968-08-06 S99993577 X28173268X    Mr. Bennie663               Ebert178\n3 2008-12-21                 &lt;NA&gt;        Hunter736 Mckinley734 Gerlach374\n  MAIDEN MARITAL  RACE   ETHNICITY GENDER                  BIRTHPLACE\n1              M white nonhispanic      M   Boston  Massachusetts  US\n2              D white nonhispanic      M Chicopee  Massachusetts  US\n3                white nonhispanic      M  Spencer  Massachusetts  US\n                      ADDRESS         CITY         STATE          COUNTY  FIPS\n1            811 Kihn Viaduct    Braintree Massachusetts  Norfolk County 25021\n2 975 Pfannerstill Throughway    Braintree Massachusetts  Norfolk County 25021\n3             548 Heller Lane Mattapoisett Massachusetts Plymouth County    NA\n  HEALTHCARE_EXPENSES HEALTHCARE_COVERAGE INCOME   city_fixed\n1            56904.96            18019.99 100511    Braintree\n2           124024.12             1075.06  49737    Braintree\n3            45645.06             6154.94 133816 Mattapoisett\n\n# Replace all occurrences (e.g., replace spaces with underscores)\npatients_gsub &lt;- patients %&gt;%\n  mutate(birthplace_clean = gsub(\" \", \"_\", BIRTHPLACE)) %&gt;% \n  select(BIRTHPLACE, birthplace_clean)\n\nhead(patients_gsub, n = 3)\n\n                   BIRTHPLACE            birthplace_clean\n1   Boston  Massachusetts  US   Boston__Massachusetts__US\n2 Chicopee  Massachusetts  US Chicopee__Massachusetts__US\n3  Spencer  Massachusetts  US  Spencer__Massachusetts__US\n\n# Convert last names to lowercase\ntemp &lt;- patients %&gt;% \n  select(-Id, -DEATHDATE, -SSN, -LAT, -LON, -SUFFIX, -ZIP)\n\npatients_tolower &lt;- temp \ncolnames(patients_tolower) &lt;- tolower(colnames(patients_tolower)) \n\nhead(patients_tolower, n = 3)\n\n   birthdate   drivers   passport prefix     first      middle       last\n1 1994-02-06 S99996852 X47758697X    Mr. Joshua658     Alvin56   Kunde533\n2 1968-08-06 S99993577 X28173268X    Mr. Bennie663               Ebert178\n3 2008-12-21                 &lt;NA&gt;        Hunter736 Mckinley734 Gerlach374\n  maiden marital  race   ethnicity gender                  birthplace\n1              M white nonhispanic      M   Boston  Massachusetts  US\n2              D white nonhispanic      M Chicopee  Massachusetts  US\n3                white nonhispanic      M  Spencer  Massachusetts  US\n                      address         city         state          county  fips\n1            811 Kihn Viaduct    Braintree Massachusetts  Norfolk County 25021\n2 975 Pfannerstill Throughway    Braintree Massachusetts  Norfolk County 25021\n3             548 Heller Lane Mattapoisett Massachusetts Plymouth County    NA\n  healthcare_expenses healthcare_coverage income\n1            56904.96            18019.99 100511\n2           124024.12             1075.06  49737\n3            45645.06             6154.94 133816\n\nrm(temp)\n\n#`janitor::clean_names(df)` standardizes variable names:\n\nnames(patients)\n\n [1] \"Id\"                  \"BIRTHDATE\"           \"DEATHDATE\"          \n [4] \"SSN\"                 \"DRIVERS\"             \"PASSPORT\"           \n [7] \"PREFIX\"              \"FIRST\"               \"MIDDLE\"             \n[10] \"LAST\"                \"SUFFIX\"              \"MAIDEN\"             \n[13] \"MARITAL\"             \"RACE\"                \"ETHNICITY\"          \n[16] \"GENDER\"              \"BIRTHPLACE\"          \"ADDRESS\"            \n[19] \"CITY\"                \"STATE\"               \"COUNTY\"             \n[22] \"FIPS\"                \"ZIP\"                 \"LAT\"                \n[25] \"LON\"                 \"HEALTHCARE_EXPENSES\" \"HEALTHCARE_COVERAGE\"\n[28] \"INCOME\"             \n\ntemp &lt;- janitor::clean_names(patients)\ncolnames(temp)\n\n [1] \"id\"                  \"birthdate\"           \"deathdate\"          \n [4] \"ssn\"                 \"drivers\"             \"passport\"           \n [7] \"prefix\"              \"first\"               \"middle\"             \n[10] \"last\"                \"suffix\"              \"maiden\"             \n[13] \"marital\"             \"race\"                \"ethnicity\"          \n[16] \"gender\"              \"birthplace\"          \"address\"            \n[19] \"city\"                \"state\"               \"county\"             \n[22] \"fips\"                \"zip\"                 \"lat\"                \n[25] \"lon\"                 \"healthcare_expenses\" \"healthcare_coverage\"\n[28] \"income\"             \n\n# Remove all temporary objects created in this chunk\nrm(patients_mutated, patients_transmuted, patients_case_when, patients_if_else,\n   patients_split, patients_sub, patients_gsub, patients_tolower, temp)\n\nWarning in rm(patients_mutated, patients_transmuted, patients_case_when, :\nobject 'patients_split' not found\n\n\n\n\nParsing Text Fields in R: Handling Multi-Word Names\nIn real-world datasets, it‚Äôs common to encounter text fields where multiple data elements‚Äîsuch as city, state, and country‚Äîare embedded within a single string. These entries often include inconsistent spacing, making them challenging to analyze directly.\nParsing refers to the process of systematically breaking down these complex text fields into structured, usable components.\nparsing involves\n\nDetecting patterns in spacing‚Äîfor instance, identifying how many spaces exist between different parts of a string.\nDeciding where to split the string. For example, a single space might separate words within a single name such as city name (e.g., \"East Falmouth\"), while two or more spaces might indicate the boundary between city, state, and country (e.g., \"East Falmouth  Massachusetts  US\").\nCreating new variables or columns such as city, state, and country for cleaner and more structured data representation.\n\nparsing is important\n\nMany administrative or imported datasets contain combined or messy fields that hinder direct analysis.\nProper parsing helps to standardize and clean these fields, which is a critical step for effective data management, visualization, and analysis.\nIt enables downstream tasks such as geographic grouping, mapping, and report generation.\n\nSummary Table\n\n\n\n\n\n\n\nStep\nPurpose\n\n\n\n\nstr_view()\nVisually inspect spacing patterns between components\n\n\nstr_extract_all(\" +\")\nExtract all space sequences\n\n\nmap_int(..., length)\nCount the number of space groups per entry\n\n\nstr_count(\"\\\\S+\")\nCount the number of words\n\n\nnchar() with map_chr()\nShow the length of each space between words\n\n\narrange(desc(word_count))\nIdentify rows with the most words (potential outliers)\n\n\n\nDetecting and Understanding Space Patterns\nTo begin, I used example data from the patients$BIRTHPLACE column to identify how different rows are structured and where inconsistencies might exist.\n1. Visual Inspection of Spacing We can use str_view() from the stringr package to highlight space sequences:\n\nstr_view(patients$BIRTHPLACE[1:15], pattern = \" +\", match = TRUE)\n\n [1] ‚îÇ Boston&lt;  &gt;Massachusetts&lt;  &gt;US\n [2] ‚îÇ Chicopee&lt;  &gt;Massachusetts&lt;  &gt;US\n [3] ‚îÇ Spencer&lt;  &gt;Massachusetts&lt;  &gt;US\n [4] ‚îÇ Franklin&lt;  &gt;Massachusetts&lt;  &gt;US\n [5] ‚îÇ Brockton&lt;  &gt;Massachusetts&lt;  &gt;US\n [6] ‚îÇ Plymouth&lt;  &gt;Massachusetts&lt;  &gt;US\n [7] ‚îÇ East&lt; &gt;Falmouth&lt;  &gt;Massachusetts&lt;  &gt;US\n [8] ‚îÇ Methuen&lt;  &gt;Massachusetts&lt;  &gt;US\n [9] ‚îÇ Maynard&lt;  &gt;Massachusetts&lt;  &gt;US\n[10] ‚îÇ Boston&lt;  &gt;Massachusetts&lt;  &gt;US\n[11] ‚îÇ Framingham&lt;  &gt;Massachusetts&lt;  &gt;US\n[12] ‚îÇ Wayland&lt;  &gt;Massachusetts&lt;  &gt;US\n[13] ‚îÇ Toulouse&lt;  &gt;Occitanie&lt;  &gt;FR\n[14] ‚îÇ Framingham&lt;  &gt;Massachusetts&lt;  &gt;US\n[15] ‚îÇ Lynn&lt;  &gt;Massachusetts&lt;  &gt;US\n\n\nThis shows, for example: East&lt; &gt;Falmouth&lt; &gt;Massachusetts&lt; &gt;US Where: - One space connects city words (‚ÄúEast Falmouth‚Äù) - Two spaces separate city, state, and country\n2. Extract and Inspect Space Sequences Each row shows the space segments between words. This helps us detect whether extra or inconsistent spacing is present.\n\npatients %&gt;%\n  mutate(space_groups = str_extract_all(BIRTHPLACE, \" +\")) %&gt;%\n  select(BIRTHPLACE, space_groups) %&gt;%\n  head()\n\n                   BIRTHPLACE space_groups\n1   Boston  Massachusetts  US         ,   \n2 Chicopee  Massachusetts  US         ,   \n3  Spencer  Massachusetts  US         ,   \n4 Franklin  Massachusetts  US         ,   \n5 Brockton  Massachusetts  US         ,   \n6 Plymouth  Massachusetts  US         ,   \n\n\n3. Count Number of Space Groups This gives a frequency table showing how many rows have 2, 3, 4, or more space groups. A row with more than 2 groups may have extra words or inconsistent formatting.\n\npatients %&gt;%\n  mutate(\n    space_groups = str_extract_all(BIRTHPLACE, \" +\"),\n    n_spaces = map_int(space_groups, length)\n  ) %&gt;%\n  count(n_spaces)\n\n  n_spaces  n\n1        2 84\n2        3 15\n3        4  4\n4        5  3\n\n\n4. Count the Number of Words This confirms how many ‚Äúword segments‚Äù are in each row and helps identify malformed entries.\n\npatients %&gt;%\n  mutate(space_count = str_count(BIRTHPLACE, \" +\")) %&gt;%\n  count(space_count)\n\n  space_count  n\n1           2 84\n2           3 15\n3           4  4\n4           5  3\n\n\n5. Combine Word Count and Space Width To fully understand the complexity of each row, I extracted the number of words and the exact space widths between them:\nThis helps in identifying patterns like:\n‚ÄúEast Falmouth Massachusetts US‚Äù ‚Üí 4 words, with spacing like 1 | 2 | 1\n‚ÄúBoston Massachusetts US‚Äù ‚Üí 3 words, spacing 2 | 2\n\npatients %&gt;%\n  mutate(\n    word_count = str_count(BIRTHPLACE, \"\\\\S+\"),  # count non-space words\n    space_groups = str_extract_all(BIRTHPLACE, \" +\"),\n    space_lengths = map_chr(space_groups, ~ paste(nchar(.x), collapse = \" | \"))  # lengths of spaces\n  ) %&gt;%\n  arrange(desc(word_count)) %&gt;%\n  select(BIRTHPLACE, word_count, space_lengths) %&gt;%\n  head(20)\n\n                                 BIRTHPLACE word_count     space_lengths\n1  Santiago de los Caballeros  Santiago  DO          6 1 | 1 | 1 | 2 | 2\n2  Santiago de los Caballeros  Santiago  DO          6 1 | 1 | 1 | 2 | 2\n3  Santiago de los Caballeros  Santiago  DO          6 1 | 1 | 1 | 2 | 2\n4             San Salvador  El Salvador  SV          5     1 | 2 | 1 | 2\n5      Santo Domingo  National District  DO          5     1 | 2 | 1 | 2\n6         Portsmouth  Saint John Parish  DM          5     2 | 1 | 1 | 2\n7           Wesley  Saint Andrew Parish  DM          5     2 | 1 | 1 | 2\n8          East Falmouth  Massachusetts  US          4         1 | 2 | 2\n9       West Springfield  Massachusetts  US          4         1 | 2 | 2\n10        North Pembroke  Massachusetts  US          4         1 | 2 | 2\n11    North Attleborough  Massachusetts  US          4         1 | 2 | 2\n12                   Ponce  Puerto Rico  PR          4         2 | 1 | 2\n13            Fall River  Massachusetts  US          4         1 | 2 | 2\n14       South Deerfield  Massachusetts  US          4         1 | 2 | 2\n15                 Bayamon  Puerto Rico  PR          4         2 | 1 | 2\n16            Oak Bluffs  Massachusetts  US          4         1 | 2 | 2\n17       North Lakeville  Massachusetts  US          4         1 | 2 | 2\n18            Guatemala City  Guatemala  GT          4         1 | 2 | 2\n19         North Andover  Massachusetts  US          4         1 | 2 | 2\n20         North Reading  Massachusetts  US          4         1 | 2 | 2\n\n\nFrom observations in the data, split BIRTHPLACE by 2+ spaces would be more appropriate. Those two words having one space are the names for a city, state or country\n\n# Clean and split birthplace into city, state/region, and country\npatients_clean &lt;- patients %&gt;%\n  mutate(\n    parts = str_split(BIRTHPLACE, \" {2,}\"),             # split BIRTHPLACE by 2+ spaces\n    # %||% is a shorthand from the rlang package (used implicitly here via purrr) that returns the left-hand side if it exists, otherwise returns the right-hand side.\n    # eg If .x[2] exists, use it; otherwise, use NA (missing character).\n    city = map_chr(parts, ~ .x[1] %||% NA_character_),  # city name (first part)\n    state = map_chr(parts, ~ .x[2] %||% NA_character_), # state or region (second part)\n    country = map_chr(parts, ~ .x[3] %||% NA_character_)# country code (third part)\n  ) %&gt;%\n  select(BIRTHPLACE, city, state, country)\nhead(patients_clean, 10)\n\n                         BIRTHPLACE          city         state country\n1         Boston  Massachusetts  US        Boston Massachusetts      US\n2       Chicopee  Massachusetts  US      Chicopee Massachusetts      US\n3        Spencer  Massachusetts  US       Spencer Massachusetts      US\n4       Franklin  Massachusetts  US      Franklin Massachusetts      US\n5       Brockton  Massachusetts  US      Brockton Massachusetts      US\n6       Plymouth  Massachusetts  US      Plymouth Massachusetts      US\n7  East Falmouth  Massachusetts  US East Falmouth Massachusetts      US\n8        Methuen  Massachusetts  US       Methuen Massachusetts      US\n9        Maynard  Massachusetts  US       Maynard Massachusetts      US\n10        Boston  Massachusetts  US        Boston Massachusetts      US\n\ntail(patients_clean, 10)\n\n                                  BIRTHPLACE                       city\n97                 Boston  Massachusetts  US                     Boston\n98     North Attleborough  Massachusetts  US         North Attleborough\n99                Taunton  Massachusetts  US                    Taunton\n100            Chelmsford  Massachusetts  US                 Chelmsford\n101                Boston  Massachusetts  US                     Boston\n102             Holliston  Massachusetts  US                  Holliston\n103 Santiago de los Caballeros  Santiago  DO Santiago de los Caballeros\n104           Springfield  Massachusetts  US                Springfield\n105             Fitchburg  Massachusetts  US                  Fitchburg\n106       Millis-Clicquot  Massachusetts  US            Millis-Clicquot\n            state country\n97  Massachusetts      US\n98  Massachusetts      US\n99  Massachusetts      US\n100 Massachusetts      US\n101 Massachusetts      US\n102 Massachusetts      US\n103      Santiago      DO\n104 Massachusetts      US\n105 Massachusetts      US\n106 Massachusetts      US\n\n\nConclusion From this exploration, we observe that:\n\nMost entries use single spaces within city names (e.g., ‚ÄúEast Falmouth‚Äù)\nTwo or more spaces are commonly used to separate city, state, and country names\nParsing using a split on ‚Äú{2,}‚Äù (two or more spaces) is a reliable strategy\n\n\n\n\nFree-text fields are common in public-health, administrative, and clinical datasets. While they are rich in information, the lack of structure and consistent vocabulary can limit their usefulness. In real-world datasets, especially in health, administration, and survey data, free-text fields often contain rich information hidden in inconsistent or varied language. A single concept (e.g., ‚ÄúCOVID-19 vaccine‚Äù) might appear in many forms such as ‚Äúcovid jab‚Äù, ‚Äúcovid-19 injection‚Äù, or ‚ÄúSARS-CoV-2 shot‚Äù. This presentation demonstrates how to transform unstructured text into structured, analyzable data using R. The workflow covers\n\ntokenization,\nword-frequency analysis,\nstop-word removal,\nTF‚ÄìIDF to highlight context-specific terms,\nword-cloud visualisation,\nbigram and trigram extraction, and\npattern detection with regular expressions to create categorical variables.\n\nBasic Tokenisation and Word-Frequency Table\nTokenisation splits long strings of text into individual words or terms (‚Äútokens‚Äù). This enables us to calculate how often each word appears, which is essential for understanding vocabulary patterns.\nWe begin by loading the necessary R packages. If a package is not already installed.\n\n# Install packages when they are not already available\nif (!require(\"tidytext\")) install.packages(\"tidytext\", dependencies = TRUE)\nif (!require(\"wordcloud\")) install.packages(\"wordcloud\", dependencies = TRUE)\nif (!require(\"tm\"))        install.packages(\"tm\",        dependencies = TRUE)\n\nlibrary(tidytext)   # text mining utilities\nlibrary(wordcloud)  # word-cloud plots\nlibrary(tm)         # text-mining helpers used by wordcloud\n\n\nword_freq &lt;- vaccination %&gt;%\n  unnest_tokens(word, DESCRIPTION) %&gt;%\n  count(word, sort = TRUE) %&gt;%\n  filter(!is.na(word) & word != \"\")\n\nhead(word_freq)\n\n          word   n\n1         free 929\n2 preservative 929\n3    influenza 859\n4   injectable 859\n5     seasonal 859\n6         dose 230\n\n\nRemove Stop Words\nStop words are common terms like ‚Äúand‚Äù, ‚Äúthe‚Äù, or ‚Äúin‚Äù that typically do not contribute meaningful information in analysis. Removing these helps us focus on content-rich terms.\n\ndata(\"stop_words\")          # built-in tidytext stop-word list\n\nword_freq_clean &lt;- vaccination %&gt;%\n  unnest_tokens(word, DESCRIPTION) %&gt;%\n  anti_join(stop_words, by = \"word\") %&gt;%\n  count(word, sort = TRUE)\n\nhead(word_freq_clean)\n\n          word   n\n1         free 929\n2 preservative 929\n3    influenza 859\n4   injectable 859\n5     seasonal 859\n6         dose 230\n\n\n\nVisualise Word Frequencies\nThis bar chart provides a visual overview of the most common meaningful words in the dataset after stop-word removal.\n\nword_freq_clean %&gt;%\n  filter(n &gt; 20) %&gt;%\n  ggplot(aes(x = reorder(word, n), y = n)) +\n  geom_col() +\n  coord_flip() +\n  labs(title = \"Most Frequent Words After Stop-Word Removal\",\n       x = \"Word\",\n       y = \"Count\")\n\n\n\n\n\n\n\n\n\nCreate a Word Cloud\nA word cloud presents word frequencies visually, with more frequent words appearing larger. It offers a quick snapshot of key terms in the dataset.\n\npar(mar = c(1, 1, 1, 1))  # reduce plot margins\nwordcloud(words = word_freq_clean$word,\n          freq = word_freq_clean$n,\n          min.freq = 1,\n          max.words = 100,\n          random.order = FALSE)\n\n\n\n\n\n\n\n\n\nTF‚ÄìIDF Analysis\nTF‚ÄìIDF (Term Frequency‚ÄìInverse Document Frequency) highlights words that are common within a group but rare across groups. This helps identify terms that are contextually important for specific subgroups.\n\n# Example assumes a column called 'source_id' identifies individual documents\n\ntfidf_result &lt;- vaccination %&gt;%\n  select(source_id, DESCRIPTION) %&gt;%\n  unnest_tokens(word, DESCRIPTION) %&gt;%\n  anti_join(stop_words, by = \"word\") %&gt;%\n  count(source_id, word, sort = TRUE) %&gt;%\n  bind_tf_idf(word, source_id, n) %&gt;%\n  arrange(desc(tf_idf))\n\nhead(tfidf_result)\n\n\nBigrams and Trigrams (n-grams)\nSometimes the context of words matters more than individual terms. N-grams (bigrams, trigrams, etc.) allow us to capture meaningful phrases instead of isolated words.\nBigrams ‚Äì two-word phrases\n\nbigrams &lt;- vaccination %&gt;%\n  unnest_tokens(bigram, DESCRIPTION, token = \"ngrams\", n = 2) %&gt;%\n  count(bigram, sort = TRUE)\n\nhead(bigrams)\n\n                   bigram   n\n1       preservative free 929\n2      influenza seasonal 859\n3 injectable preservative 859\n4     seasonal injectable 859\n5                    &lt;NA&gt; 185\n6                covid 19 144\n\n\nTrigrams ‚Äì three-word phrases\n\ntrigrams &lt;- vaccination %&gt;%\n  unnest_tokens(trigram, DESCRIPTION, token = \"ngrams\", n = 3) %&gt;%\n  count(trigram, sort = TRUE)\n\nhead(trigrams)\n\n                           trigram   n\n1    influenza seasonal injectable 859\n2     injectable preservative free 859\n3 seasonal injectable preservative 859\n4                             &lt;NA&gt; 319\n5                      19 mrna lnp 142\n6                    covid 19 mrna 142\n\n\n\nCreate Categorical Variables from free and unstructured Text\nWe use regular expressions to classify unstructured free-text values into consistent categories. This transformation is critical for summarising or modelling based on text. We can identify and map all words that contain a certain substring (like ‚Äúcovid‚Äù in ‚ÄúCOVID-19‚Äù, ‚Äúcovid_19‚Äù, or ‚Äúcovid‚Äù). You can use str_detect() with a case-insensitive regular expression to filter your word frequency table.\n\nvaccination &lt;- vaccination %&gt;%\n  mutate(vaccine_group = case_when(\n    str_detect(DESCRIPTION, regex(\"covid|sars-cov-2\", ignore_case = TRUE)) ~ \"COVID-19\",\n    str_detect(DESCRIPTION, regex(\"influenza\", ignore_case = TRUE)) ~ \"Influenza\",\n    str_detect(DESCRIPTION, regex(\"hepatitis|hep a|hep b\", ignore_case = TRUE)) ~ \"Hepatitis\",\n    str_detect(DESCRIPTION, regex(\"hpv\", ignore_case = TRUE)) ~ \"HPV\",\n    str_detect(DESCRIPTION, regex(\"mmr\", ignore_case = TRUE)) ~ \"MMR\",\n    str_detect(DESCRIPTION, regex(\"dtap|tdap|tetanus|td \\\\(?adult\\\\)?\", ignore_case = TRUE)) ~ \"DTP group\",\n    str_detect(DESCRIPTION, regex(\"ipv\", ignore_case = TRUE)) ~ \"IPV\",\n    str_detect(DESCRIPTION, regex(\"hib\", ignore_case = TRUE)) ~ \"Hib\",\n    str_detect(DESCRIPTION, regex(\"meningococcal|mcv4\", ignore_case = TRUE)) ~ \"Meningococcal\",\n    str_detect(DESCRIPTION, regex(\"pneumococcal.*13\", ignore_case = TRUE)) ~ \"Pneumococcal PCV13\",\n    str_detect(DESCRIPTION, regex(\"pneumococcal.*23\", ignore_case = TRUE)) ~ \"Pneumococcal PPV23\",\n    str_detect(DESCRIPTION, regex(\"rotavirus\", ignore_case = TRUE)) ~ \"Rotavirus\",\n    str_detect(DESCRIPTION, regex(\"varicella\", ignore_case = TRUE)) ~ \"Varicella\",\n    str_detect(DESCRIPTION, regex(\"zoster\", ignore_case = TRUE)) ~ \"Zoster\",\n    TRUE ~ \"Other\"\n  ))\n\n# Frequency check\n\ntable(vaccination$vaccine_group)\n\n\n          COVID-19          DTP group          Hepatitis                Hib \n               144                152                114                 32 \n               HPV          Influenza                IPV      Meningococcal \n                61                859                 51                 52 \n               MMR Pneumococcal PCV13 Pneumococcal PPV23          Rotavirus \n                26                 52                  8                 21 \n         Varicella             Zoster \n                26                 21 \n\n# Grouping Values Using %in% Inside case_when()\n\nvaccination &lt;- vaccination %&gt;%\n  mutate(vacc_group3 = case_when(\n    vaccine_group %in% c(\"COVID-19\", \"Influenza\") ~ \"Respiratory vaccines\",\n    vaccine_group %in% c(\"DTP group\", \"Hepatitis\", \"HPV\", \"Hib\", \"IPV\", \n                         \"Meningococcal\", \"MMR\") ~ \"Childhood vaccines\",\n    TRUE ~ \"Other\"\n  )) %&gt;% \n  select(-ENCOUNTER, -CODE)\n\nhead (vaccination)\n\n                  DATE                              PATIENT\n1 2016-04-10T09:04:48Z 30a6452c-4297-a1ac-977a-6a23237c7b46\n2 2016-04-10T09:04:48Z 30a6452c-4297-a1ac-977a-6a23237c7b46\n3 2016-04-10T09:04:48Z 30a6452c-4297-a1ac-977a-6a23237c7b46\n4 2016-04-10T09:04:48Z 30a6452c-4297-a1ac-977a-6a23237c7b46\n5 2002-10-29T19:07:21Z 34a4dcc4-35fb-6ad5-ab98-be285c586a4f\n6 2005-11-01T19:07:21Z 34a4dcc4-35fb-6ad5-ab98-be285c586a4f\n                                                   DESCRIPTION BASE_COST\n1           Influenza  seasonal  injectable  preservative free       136\n2 Td (adult)  5 Lf tetanus toxoid  preservative free  adsorbed       136\n3                                                 Hep B  adult       136\n4                                          meningococcal MCV4P       136\n5           Influenza  seasonal  injectable  preservative free       136\n6           Influenza  seasonal  injectable  preservative free       136\n   vacc_date year    month vaccine_group          vacc_group3\n1 2016-04-10 2016    April     Influenza Respiratory vaccines\n2 2016-04-10 2016    April     DTP group   Childhood vaccines\n3 2016-04-10 2016    April     Hepatitis   Childhood vaccines\n4 2016-04-10 2016    April Meningococcal   Childhood vaccines\n5 2002-10-29 2002  October     Influenza Respiratory vaccines\n6 2005-11-01 2005 November     Influenza Respiratory vaccines\n\n\nConclusion\nBy combining the tidytext, stringr, and dplyr packages we converted messy free-text into structured data ready for analysis. This approach supports reproducible work, clearer insights, and more robust statistical modelling.\n\n\n\n\n\nCreating factor levels and relabeling\n\nApplying labels with label() and val_labels()\n\nDescriptive summaries with describe()\n\nIn R, categorical variables can be represented as factors to support grouping, modeling, and formatting for reporting. Factor variables store both the value and its associated level label.\nThis section introduces key functions to:\n\nConvert variables into factors\n\nRename or reorder levels for clarity\n\nApply variable-level labels using label() or var_label()\n\nAssign value labels using val_labels() (e.g., 1 = Male)\n\nGenerate descriptive metadata summaries using Hmisc::describe()\n\nValue labels are especially useful when numeric codes represent categorical responses. These can be shown in summaries or retained for export and display.\nYou can choose to display or hide value labels:\noptions(labelled::val_labels_visible = TRUE) # Show values like ‚Äú1 = Male‚Äù options(labelled::val_labels_visible = FALSE) # Show only ‚ÄúMale‚Äù\nüîπ Summary of Functions for Working with Factors and Labels\n\n\n\n\n\n\n\n\nTask\nFunction\nDescription\n\n\n\n\nConvert to factor\nas.factor(x)\nConvert a character or numeric variable into a factor\n\n\nReorder levels\nfactor(x, levels = ...)\nDefine a specific order for levels\n\n\nRename factor levels\nlevels(x) &lt;- c(...)\nManually change the displayed names of factor levels\n\n\nRecode with forcats\nfct_recode(), fct_relevel()\nRelabel, reorder, or collapse factor levels using tidyverse tools\n\n\nApply variable label\nlabel(x) &lt;- \"...\" or var_label(x) &lt;- \"...\"\nAssign a description to a variable\n\n\nApply value labels\nval_labels(x) &lt;- c(\"Label\" = code)\nDefine how codes map to category names (e.g., 1 = Male)\n\n\nRetrieve labels\nlabel(x), val_labels(x)\nView current labels or mappings\n\n\nGenerate summary with labels\nHmisc::describe(df)\nReturn a summary including variable names, labels, types, and distributions\n\n\n\n\n# Select two categorical variables\nvacc_factor &lt;- vacc_pt_merged %&gt;%\n  select(gender, marital)\n\n# Convert character to factor\nvacc_factor &lt;- vacc_factor %&gt;%\n  mutate(\n    gender = factor(gender),\n    marital = factor(marital)\n  )\n\n# Relabel factor levels using fct_recode()\nvacc_factor &lt;- vacc_factor %&gt;%\n  mutate(\n    gender = fct_recode(gender, \"Male\" = \"M\", \"Female\" = \"F\"),\n    marital = fct_recode(marital,\n                         \"Married\" = \"M\",\n                         \"Divorced\" = \"D\",\n                         \"Single\" = \"S\",\n                         \"Widowed\" = \"W\")\n  )\n\ntail(vacc_factor)\n\n     gender marital\n1614 Female  Single\n1615 Female  Single\n1616 Female  Single\n1617 Female  Single\n1618 Female  Single\n1619 Female  Single\n\n# Assign variable labels\nvar_label(vacc_factor$gender) &lt;- \"Biological Sex\"\nvar_label(vacc_factor$marital) &lt;- \"Marital Status\"\n\n# Assign value labels\nvacc_factor$gender_chr &lt;- as.character(vacc_factor$gender) # Convert factor to character\nval_labels(vacc_factor$gender_chr) &lt;- c(\"1\" = \"Male\", \"2\" = \"Female\")\n\n\n# View internal structure and label info\nstr(vacc_factor)\n\n'data.frame':   1619 obs. of  3 variables:\n $ gender    : Factor w/ 2 levels \"Female\",\"Male\": 2 2 2 2 2 2 2 2 2 2 ...\n  ..- attr(*, \"label\")= chr \"Biological Sex\"\n $ marital   : Factor w/ 5 levels \"\",\"Divorced\",..: 3 3 3 3 3 3 2 2 2 2 ...\n  ..- attr(*, \"label\")= chr \"Marital Status\"\n $ gender_chr: chr+lbl [1:1619] Male  , Male  , Male  , Male  , Male  , Male  , Male ...\n   ..@ labels: Named chr  \"Male\" \"Female\"\n   .. ..- attr(*, \"names\")= chr [1:2] \"1\" \"2\"\n\n# Remove bad labels if needed:\nvar_label(vacc_factor$gender) &lt;- NULL\n\n# Remove temporary object\nrm(vacc_factor)\n\n\n\n\n\n# Select two categorical variables\nvacc_factor &lt;- vacc_pt_merged %&gt;%\n  select(gender, marital)\n\n# Convert character to factor\nvacc_factor &lt;- vacc_factor %&gt;%\n  mutate(\n    gender = factor(gender),\n    marital = factor(marital)\n  )\n\n# Relabel factor levels using fct_recode()\nvacc_factor &lt;- vacc_factor %&gt;%\n  mutate(\n    gender = fct_recode(gender, \"Male\" = \"M\", \"Female\" = \"F\"),\n    marital = fct_recode(marital,\n                         \"Married\" = \"M\",\n                         \"Divorced\" = \"D\",\n                         \"Single\" = \"S\",\n                         \"Widowed\" = \"W\")\n  )\n\ntail(vacc_factor)\n\n     gender marital\n1614 Female  Single\n1615 Female  Single\n1616 Female  Single\n1617 Female  Single\n1618 Female  Single\n1619 Female  Single\n\n# Assign variable labels\nvar_label(vacc_factor$gender) &lt;- \"Biological Sex\"\nvar_label(vacc_factor$marital) &lt;- \"Marital Status\"\n\n# Assign value labels\nvacc_factor$gender_chr &lt;- as.character(vacc_factor$gender) # Convert factor to character\nval_labels(vacc_factor$gender_chr) &lt;- c(\"1\" = \"Male\", \"2\" = \"Female\")\n\n\n# View internal structure and label info\nstr(vacc_factor)\n\n'data.frame':   1619 obs. of  3 variables:\n $ gender    : Factor w/ 2 levels \"Female\",\"Male\": 2 2 2 2 2 2 2 2 2 2 ...\n  ..- attr(*, \"label\")= chr \"Biological Sex\"\n $ marital   : Factor w/ 5 levels \"\",\"Divorced\",..: 3 3 3 3 3 3 2 2 2 2 ...\n  ..- attr(*, \"label\")= chr \"Marital Status\"\n $ gender_chr: chr+lbl [1:1619] Male  , Male  , Male  , Male  , Male  , Male  , Male ...\n   ..@ labels: Named chr  \"Male\" \"Female\"\n   .. ..- attr(*, \"names\")= chr [1:2] \"1\" \"2\"\n\n# Remove bad labels if needed:\nvar_label(vacc_factor$gender) &lt;- NULL\n\n# Remove temporary object\nrm(vacc_factor)\n\n\ngroup_by(), summarize(), ungroup()\nRow and column percentages: details presented in section 7.2 below\nWeighted summaries with wt =\n\nGrouping and summarizing data is fundamental for understanding patterns, distributions, and relationships within datasets.\nIn dplyr, the functions group_by() and summarize() are used together to calculate statistics across different groups.\nWe can also calculate proportions (row-wise or column-wise) and perform weighted summaries when necessary. The details regarding row and column percentages are presented in section 7.2 below.\nThese steps are critical for aggregating information into meaningful insights, especially when working with categorical, grouped, or longitudinal data.\n\nüîπ Summary of Functions for Grouping and Summarizing\n\n\n\n\n\n\n\n\nTask\nFunction\nPurpose\n\n\n\n\nGroup data by one or more variables\ngroup_by()\nDefine groups for aggregation\n\n\nSummarize grouped data\nsummarize()\nApply aggregation functions (e.g., mean, sum, count)\n\n\nRemove grouping structure\nungroup()\nReturn to ungrouped state after summary\n\n\nCalculate row-wise or column-wise proportions\nManual with mutate(), prop.table(), etc.\nUnderstand percentage distribution within/between groups\n\n\nWeighted summaries\nsummarize(wt = )\nCompute weighted means, sums, or percentages when different rows contribute differently\n\n\n\n\n‚û°Ô∏è Grouping and summarization allow efficient exploration of key relationships and preparation of clean summary tables.\n\n\n# ....................................................\n# Grouping and Summarizing Breast Cancer Data\n# ....................................................\n\n# Grouping by SA3 name, State, and Year, and summarizing participation\nbc_summary_year &lt;- breast_cancer_data %&gt;%\n  group_by(year) %&gt;%\n  summarise(\n    total_participants = sum(part50_74, na.rm = TRUE),\n    total_population = sum(pop50_74, na.rm = TRUE),\n    mean_screening_rate = mean(rate50_74, na.rm = TRUE),\n    .groups = \"drop\"\n  )\nhead(bc_summary_year, n = 3)\n\n# A tibble: 3 √ó 4\n    year total_participants total_population mean_screening_rate\n   &lt;int&gt;              &lt;dbl&gt;            &lt;dbl&gt;               &lt;dbl&gt;\n1 201617            1720463          3127749                54.9\n2 201718            1748606          3187574                54.7\n3 201819            1781484          3247470                54.6\n\n# --- Create Vaccination Pattern Dataset ---\ndf_vaccination_plot &lt;- vaccination %&gt;%\n  group_by(year, month, vaccine_group) %&gt;%\n  summarise(\n    count = n(),  # Number of records per year-month-vaccine_group combination\n    .groups = \"drop\"\n  ) %&gt;%\n  ungroup() %&gt;%\n  group_by(year, month) %&gt;%\n  mutate(\n    count_month = sum(count)  # Total vaccines in that year-month across all groups\n  ) %&gt;%\n  ungroup() %&gt;%\n  mutate(\n    proportion_month = round((count / count_month) * 100, 1)  # % per vaccine group within month\n  ) %&gt;%\n  group_by(year) %&gt;%\n  mutate(\n    total_year = sum(count)  # Total vaccines across the year\n  ) %&gt;%\n  mutate(\n    proportion_year = round((count / total_year) * 100, 1)  # % per vaccine group within year\n  ) %&gt;%\n  ungroup()\n\n# View first few rows\ntail(df_vaccination_plot)\n\n# A tibble: 6 √ó 8\n  year  month     vaccine_group count count_month proportion_month total_year\n  &lt;chr&gt; &lt;chr&gt;     &lt;chr&gt;         &lt;int&gt;       &lt;int&gt;            &lt;dbl&gt;      &lt;int&gt;\n1 2024  October   Zoster            1          15              6.7        122\n2 2024  September COVID-19          1          15              6.7        122\n3 2024  September DTP group         2          15             13.3        122\n4 2024  September HPV               2          15             13.3        122\n5 2024  September Influenza         9          15             60          122\n6 2024  September Meningococcal     1          15              6.7        122\n# ‚Ñπ 1 more variable: proportion_year &lt;dbl&gt;\n\n# Enhanced summary of breast cancer screening data with SA3, State, and National Year-level proportions\n# use na.rm = TRUE to remove (ignore) missing values (NA) when calculating\n\nbc_summary &lt;- breast_cancer_data %&gt;%\n  # Group by SA3 area, State, and Year\n  group_by(sa3name, state, year) %&gt;%\n  summarise(\n    total_participants = sum(part50_74, na.rm = TRUE),  # Sum of screened participants\n    total_population = sum(pop50_74, na.rm = TRUE),     # Sum of target population\n    .groups = \"drop\"\n  ) %&gt;%\n  # Calculate SA3-level screening rate and proportion\n  mutate(\n    screening_rate = round((total_participants / total_population) * 100, 1),  # % screened in that SA3\n    proportion_area = round((total_participants / sum(total_participants)) * 100, 1)  # % contribution to national participants\n  ) %&gt;%\n  # Add State-level aggregated summaries\n  group_by(state, year) %&gt;%\n  mutate(\n    state_sa3 = n(),  # Number of SA3 areas within each State-Year\n    state_total_participants = sum(total_participants, na.rm = TRUE),  # State-wide participants\n    state_total_population = sum(total_population, na.rm = TRUE),      # State-wide target population\n    state_screening_rate = round((state_total_participants / state_total_population) * 100, 1),  # % screened at State level\n    state_proportion = round((state_total_participants / sum(total_participants)) * 100, 1)  # State share of total participants\n  ) %&gt;%\n  ungroup() %&gt;%\n  # Add National Year-level aggregated summaries\n  group_by(year) %&gt;%\n  mutate(\n    year_sa3 = n(),  # Number of SA3 areas within each Year\n    year_total_participants = sum(total_participants, na.rm = TRUE),  # Australia-wide participants for that year\n    year_total_population = sum(total_population, na.rm = TRUE),      # Australia-wide target population for that year\n    year_screening_rate = round((year_total_participants / year_total_population) * 100, 1),  # National % screened\n    year_proportion = round((year_total_participants / sum(total_participants)) * 100, 1)  # National share\n  ) %&gt;%\n  ungroup() %&gt;%\n  arrange(year, state, sa3name)   # Final arrangement for neat viewing\n\n# View the last few rows\ntail(bc_summary)\n\n# A tibble: 6 √ó 17\n  sa3name        state   year total_participants total_population screening_rate\n  &lt;chr&gt;          &lt;chr&gt;  &lt;int&gt;              &lt;dbl&gt;            &lt;dbl&gt;          &lt;dbl&gt;\n1 Stirling       WA    201920              13878            27265           50.9\n2 Swan           WA    201920               8513            17274           49.3\n3 Wanneroo       WA    201920              12032            24345           49.4\n4 West Pilbara   WA    201920                828             2409           34.4\n5 Wheat Belt - ‚Ä¶ WA    201920               4947             9813           50.4\n6 Wheat Belt - ‚Ä¶ WA    201920               1446             3342           43.3\n# ‚Ñπ 11 more variables: proportion_area &lt;dbl&gt;, state_sa3 &lt;int&gt;,\n#   state_total_participants &lt;dbl&gt;, state_total_population &lt;dbl&gt;,\n#   state_screening_rate &lt;dbl&gt;, state_proportion &lt;dbl&gt;, year_sa3 &lt;int&gt;,\n#   year_total_participants &lt;dbl&gt;, year_total_population &lt;dbl&gt;,\n#   year_screening_rate &lt;dbl&gt;, year_proportion &lt;dbl&gt;\n\n# ....................................................\n# Calculating Proportions: details presented in section 7.2 below\n# ....................................................\n\n# Adding participation proportion within each SA3-year group\nbc_summary_with_prop &lt;- bc_summary %&gt;%\n  mutate(\n    participation_rate = (total_participants / total_population) * 100\n  ) %&gt;% \n  select(participation_rate)\n\nhead(bc_summary_with_prop)\n\n# A tibble: 6 √ó 1\n  participation_rate\n               &lt;dbl&gt;\n1               56.1\n2              NaN  \n3               53.8\n4              NaN  \n5               54.5\n6               55.1\n\n# ....................................................\n# Weighted Summarization (Weighted Average Screening Rate)\n# ....................................................\n\n# Calculate weighted mean screening rate by SA3\nbc_weighted_summary &lt;- breast_cancer_data %&gt;%\n  group_by(sa3name, state, year) %&gt;%\n  summarise(\n    total_participants = sum(part50_74, na.rm = TRUE),\n    total_population = sum(pop50_74, na.rm = TRUE),\n    weighted_screening_rate = round(sum(rate50_74 * pop50_74, na.rm = TRUE) / sum(pop50_74, na.rm = TRUE), 1),\n    .groups = \"drop\"\n  )\n\nhead(bc_weighted_summary)\n\n# A tibble: 6 √ó 6\n  sa3name        state   year total_participants total_population\n  &lt;chr&gt;          &lt;chr&gt;  &lt;int&gt;              &lt;dbl&gt;            &lt;dbl&gt;\n1 Adelaide City  SA    201617               1280             2537\n2 Adelaide City  SA    201718               1314             2608\n3 Adelaide City  SA    201819               1368             2642\n4 Adelaide City  SA    201920               1208             2707\n5 Adelaide Hills SA    201617               7010            11636\n6 Adelaide Hills SA    201718               7096            11876\n# ‚Ñπ 1 more variable: weighted_screening_rate &lt;dbl&gt;\n\n# ....................................................\n# Remove all temporary objects created in this chunk\n# ....................................................\nrm(bc_summary, bc_summary_with_prop, bc_weighted_summary)\n\n\n\n\n\narrange(), desc()\nslice_max(), slice_min(), top_n()\nRanking data and filtering top/bottom groups\n\nSorting and reordering data is important for finding trends, identifying extremes (top or bottom performers), and preparing tables for reporting or visualization.\nIn dplyr, the arrange() function sorts datasets by one or more variables, while desc() allows descending (reverse) order.\nFor selecting specific rows like top N or bottom N values, slice_max() and slice_min() are commonly used.\nThese techniques allow focusing on key records, comparing rankings across groups, and making datasets easier to review.\n\nüîπ Summary of Functions for Sorting and Reordering\n\n\n\n\n\n\n\n\nTask\nFunction\nPurpose\n\n\n\n\nSort ascending order\narrange()\nSort rows by one or more variables (lowest to highest)\n\n\nSort descending order\narrange(desc())\nSort rows highest to lowest\n\n\nSelect top N rows by a variable\nslice_max()\nKeep top N records based on a variable\n\n\nSelect bottom N rows by a variable\nslice_min()\nKeep bottom N records based on a variable\n\n\nSelect top N rows (old method)\ntop_n()\nDeprecated alternative to slice_max() (not recommended now)\n\n\nRank within groups\nmutate(rank = row_number())\nCreate custom ranking inside grouped data\n\n\n\n\n‚û°Ô∏è Sorting and slicing help prioritize key data points and create targeted outputs for decision-making or visualization.\n\n\n# ....................................................\n# Sorting, Reordering, Slicing, and Arranging (Breast Cancer Data)\n# ....................................................\n\n# Sorting by Screening Rate in Ascending Order\nbc_sorted_rate &lt;- breast_cancer_data %&gt;%\n  arrange(rate50_74) %&gt;%\n  select(sa3code, sa3coden, sa3name, state, year,\n         part50_74, pop50_74, rate50_74, agen50_74, expct50_74)\n\nhead(bc_sorted_rate)\n\n  sa3code sa3coden        sa3name state   year part50_74 pop50_74 rate50_74\n1   90104    90104 Norfolk Island Other 201920        24      441   5.40000\n2   90104    90104 Norfolk Island Other 201819        31      422   7.30000\n3   90104    90104 Norfolk Island Other 201718        39      401   9.70000\n4   70205    70205      Katherine    NT 201920       412     2011  20.51335\n5   51002    51002   East Pilbara    WA 201920       562     1987  28.26220\n6   51002    51002   East Pilbara    WA 201819       567     1918  29.55425\n  agen50_74 expct50_74\n1         3        220\n2         3        231\n3         3        219\n4         3       1003\n5         3        991\n6         3       1051\n\n# Sorting by Screening Rate in Descending Order\nbc_sorted_rate_desc &lt;- breast_cancer_data %&gt;%\n  arrange(desc(rate50_74)) %&gt;%\n  select(sa3code, sa3coden, sa3name, state, year,\n         part50_74, pop50_74, rate50_74, agen50_74, expct50_74)\n\nhead(bc_sorted_rate_desc)\n\n  sa3code sa3coden                        sa3name state   year part50_74\n1   90102    90102        Cocos (Keeling) Islands Other 201920        81\n2   31801    31801 Charters Towers - Ayr - Ingham   Qld 201617      4628\n3   60102    60102            Hobart - North East   Tas 201718      5856\n4   60104    60104        Hobart - South and West   Tas 201718      3643\n5   11004    11004            Tamworth - Gunnedah   NSW 201819      8426\n6   31801    31801 Charters Towers - Ayr - Ingham   Qld 201718      4612\n  pop50_74 rate50_74 agen50_74 expct50_74\n1      101  80.20000         3         50\n2     6713  68.90000         3       3692\n3     8566  68.36348         3       4694\n4     5331  68.34190         3       2921\n5    12333  68.32168         3       6758\n6     6759  68.23824         3       3703\n\n# Slicing Top 10 SA3s with Highest Screening Rates\nbc_top_screening &lt;- breast_cancer_data %&gt;%\n  slice_max(order_by = rate50_74, n = 10) %&gt;%\n  select(sa3code, sa3coden, sa3name, state, year,\n         part50_74, pop50_74, rate50_74, agen50_74, expct50_74)\n\nbc_top_screening\n\n   sa3code sa3coden                        sa3name state   year part50_74\n1    90102    90102        Cocos (Keeling) Islands Other 201920        81\n2    31801    31801 Charters Towers - Ayr - Ingham   Qld 201617      4628\n3    60102    60102            Hobart - North East   Tas 201718      5856\n4    60104    60104        Hobart - South and West   Tas 201718      3643\n5    11004    11004            Tamworth - Gunnedah   NSW 201819      8426\n6    31801    31801 Charters Towers - Ayr - Ingham   Qld 201718      4612\n7    11001    11001                       Armidale   NSW 201617      3810\n8    60102    60102            Hobart - North East   Tas 201819      5881\n9    31801    31801 Charters Towers - Ayr - Ingham   Qld 201819      4588\n10   31801    31801 Charters Towers - Ayr - Ingham   Qld 201920      4580\n   pop50_74 rate50_74 agen50_74 expct50_74\n1       101  80.20000         3         50\n2      6713  68.90000         3       3692\n3      8566  68.36348         3       4694\n4      5331  68.34190         3       2921\n5     12333  68.32168         3       6758\n6      6759  68.23824         3       3703\n7      5602  68.00000         3       3081\n8      8698  67.61016         3       4766\n9      6797  67.49974         3       3724\n10     6818  67.17431         3       3402\n\n# Slicing Bottom 5 SA3s with Lowest Screening Rates\nbc_bottom_screening &lt;- breast_cancer_data %&gt;%\n  slice_min(order_by = rate50_74, n = 5) %&gt;%\n  select(sa3code, sa3coden, sa3name, state, year,\n         part50_74, pop50_74, rate50_74, agen50_74, expct50_74)\n\nbc_bottom_screening\n\n  sa3code sa3coden        sa3name state   year part50_74 pop50_74 rate50_74\n1   90104    90104 Norfolk Island Other 201920        24      441   5.40000\n2   90104    90104 Norfolk Island Other 201819        31      422   7.30000\n3   90104    90104 Norfolk Island Other 201718        39      401   9.70000\n4   70205    70205      Katherine    NT 201920       412     2011  20.51335\n5   51002    51002   East Pilbara    WA 201920       562     1987  28.26220\n  agen50_74 expct50_74\n1         3        220\n2         3        231\n3         3        219\n4         3       1003\n5         3        991\n\n# Ranking Within Each State\nbc_ranked &lt;- breast_cancer_data %&gt;%\n  group_by(state) %&gt;%\n  arrange(desc(rate50_74), .by_group = TRUE) %&gt;%\n  mutate(screening_rank = row_number()) %&gt;%\n  select(screening_rank, rate50_74, state) %&gt;% \n  ungroup()\n\nhead(bc_ranked, n = 10)\n\n# A tibble: 10 √ó 3\n   screening_rank rate50_74 state\n            &lt;int&gt;     &lt;dbl&gt; &lt;chr&gt;\n 1              1      59.9 ACT  \n 2              2      58.8 ACT  \n 3              3      58.4 ACT  \n 4              4      58   ACT  \n 5              5      57.7 ACT  \n 6              6      57.4 ACT  \n 7              7      57.2 ACT  \n 8              8      57.1 ACT  \n 9              9      57.0 ACT  \n10             10      56.7 ACT  \n\n# ....................................................\n# Remove all temporary objects created in this chunk\n# ....................................................\nrm(bc_sorted_rate, bc_sorted_rate_desc, bc_top_screening, bc_bottom_screening, bc_ranked)\n\n\n\n\n\npivot_longer(), pivot_wider()\nWide-to-long and long-to-wide transformations\nSeparating and uniting columns with separate() and unite()\n\n\nIn data analysis, datasets often need to be reorganized ‚Äî from wide format to long format, or vice versa ‚Äî to suit different types of analysis or visualization.\nThe goal is to follow Tidy Data principles where: - Each variable forms a column - Each observation forms a row - Each type of observational unit forms a table\ndplyr and tidyr provide key functions for reshaping: - pivot_longer() turns many columns into two columns (variable name and value). - pivot_wider() spreads one column into multiple columns. - separate() splits one column into multiple columns based on a separator. - unite() combines multiple columns into one.\nThese tools help create clean, organized datasets ready for efficient analysis and plotting.\n\nüîπ Summary of Functions for Reshaping and Tidy Data\n\n\n\n\n\n\n\n\nTask\nFunction\nPurpose\n\n\n\n\nReshape wide to long\npivot_longer()\nCollapse multiple columns into key-value pairs\n\n\nReshape long to wide\npivot_wider()\nSpread key-value pairs across multiple columns\n\n\nSplit a column into multiple parts\nseparate()\nSeparate one column into several columns by a delimiter\n\n\nCombine multiple columns into one\nunite()\nMerge several columns into a single column\n\n\n\n\n‚û°Ô∏è These reshaping techniques make it easy to transform datasets into a tidy structure for summaries, modeling, or visualization.\n\n** üîé Regular Expression Tip for names_pattern**\n\n\nIn pivot_longer(), we use a regular expression to split the column names into two components: - part, pop, rate, or expct ‚Üí measure - 50_54, 55_59, etc. ‚Üí age group The pattern ([0-9]{2}_[0-9]{2}) works as follows:\n\n\n\n\n\nComponent\nMeaning\n\n\n\n\n[0-9]\nMatch any digit (0‚Äì9)\n\n\n{2}\nExactly two digits\n\n\n_\nAn underscore\n\n\n[0-9]{2}\nAnother two digits\n\n\n\n‚û°Ô∏è This captures typical age formats like 50_54, 60_64, etc.\n\nOriginal Column Name: rate50_54\nComponents: ‚îå‚îÄ‚îÄ‚îÄ‚îê ‚îå‚îÄ‚îÄ‚îÄ‚îê ‚Ä¶.&gt; ‚îÇrate ‚îÇ ‚îÇ50_54 ‚îÇ &gt; ‚îî‚îÄ‚îò ‚îî‚îÄ‚îÄ‚îò\n\n# ....................................................\n# Reshaping, Separate and Unite Columns: Breast Cancer Data\n# ....................................................\n\n# Pivot longer by extracting measure type and age group separately\nbreast_cancer_long &lt;- breast_cancer_data %&gt;%\n  pivot_longer(\n    cols = starts_with(\"part\") | starts_with(\"pop\") | starts_with(\"rate\") | starts_with(\"expct\"),\n    names_to = c(\"measure\", \"age_group\"),\n    names_pattern = \"(part|pop|rate|expct)([0-9]{2}_[0-9]{2})\",\n    values_to = \"value\"\n  ) %&gt;%\n  relocate(measure, age_group, .before = sa3code)\n\nhead(breast_cancer_long, n = 10)\n\n# A tibble: 10 √ó 15\n   measure age_group sa3code sa3coden sa3name   state   year agen50_74 agen50_69\n   &lt;chr&gt;   &lt;chr&gt;       &lt;int&gt;    &lt;int&gt; &lt;chr&gt;     &lt;chr&gt;  &lt;int&gt;     &lt;int&gt;     &lt;int&gt;\n 1 part    50_74       10102    10102 Queanbey‚Ä¶ NSW   201617         3         2\n 2 part    50_69       10102    10102 Queanbey‚Ä¶ NSW   201617         3         2\n 3 part    50_54       10102    10102 Queanbey‚Ä¶ NSW   201617         3         2\n 4 part    55_59       10102    10102 Queanbey‚Ä¶ NSW   201617         3         2\n 5 part    60_64       10102    10102 Queanbey‚Ä¶ NSW   201617         3         2\n 6 part    65_69       10102    10102 Queanbey‚Ä¶ NSW   201617         3         2\n 7 part    70_74       10102    10102 Queanbey‚Ä¶ NSW   201617         3         2\n 8 pop     50_74       10102    10102 Queanbey‚Ä¶ NSW   201617         3         2\n 9 pop     50_69       10102    10102 Queanbey‚Ä¶ NSW   201617         3         2\n10 pop     50_54       10102    10102 Queanbey‚Ä¶ NSW   201617         3         2\n# ‚Ñπ 6 more variables: agen50_54 &lt;int&gt;, agen55_59 &lt;int&gt;, agen60_64 &lt;int&gt;,\n#   agen65_69 &lt;int&gt;, agen70_74 &lt;int&gt;, value &lt;dbl&gt;\n\n# Pivot wider to spread measures into separate columns\nbreast_cancer_final &lt;- breast_cancer_long %&gt;%\n  pivot_wider(\n    names_from = measure,\n    values_from = value\n  ) %&gt;%\n  relocate(part, pop, rate, expct, .before = sa3code)\n\nhead(breast_cancer_final, n = 5)\n\n# A tibble: 5 √ó 17\n  age_group  part   pop  rate expct sa3code sa3coden sa3name    state   year\n  &lt;chr&gt;     &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;   &lt;int&gt;    &lt;int&gt; &lt;chr&gt;      &lt;chr&gt;  &lt;int&gt;\n1 50_74      4875  8052  60.5  4428   10102    10102 Queanbeyan NSW   201617\n2 50_69      4309  7145  60.3  3929   10102    10102 Queanbeyan NSW   201617\n3 50_54      1284  2251  57    1118   10102    10102 Queanbeyan NSW   201617\n4 55_59      1188  1970  60.3  1046   10102    10102 Queanbeyan NSW   201617\n5 60_64      1012  1625  62.3   950   10102    10102 Queanbeyan NSW   201617\n# ‚Ñπ 7 more variables: agen50_74 &lt;int&gt;, agen50_69 &lt;int&gt;, agen50_54 &lt;int&gt;,\n#   agen55_59 &lt;int&gt;, agen60_64 &lt;int&gt;, agen65_69 &lt;int&gt;, agen70_74 &lt;int&gt;\n\n# Separate 'age_group' into two new columns: start and end age\nbreast_cancer_separated &lt;- breast_cancer_long %&gt;%\n  separate(\n    col = age_group,\n    into = c(\"age_start\", \"age_end\"),\n    sep = \"_\",\n    convert = TRUE\n  ) %&gt;% \n  select(\"age_start\", \"age_end\", everything())\n\nhead(breast_cancer_separated, n = 3)\n\n# A tibble: 3 √ó 16\n  age_start age_end measure sa3code sa3coden sa3name    state   year agen50_74\n      &lt;int&gt;   &lt;int&gt; &lt;chr&gt;     &lt;int&gt;    &lt;int&gt; &lt;chr&gt;      &lt;chr&gt;  &lt;int&gt;     &lt;int&gt;\n1        50      74 part      10102    10102 Queanbeyan NSW   201617         3\n2        50      69 part      10102    10102 Queanbeyan NSW   201617         3\n3        50      54 part      10102    10102 Queanbeyan NSW   201617         3\n# ‚Ñπ 7 more variables: agen50_69 &lt;int&gt;, agen50_54 &lt;int&gt;, agen55_59 &lt;int&gt;,\n#   agen60_64 &lt;int&gt;, agen65_69 &lt;int&gt;, agen70_74 &lt;int&gt;, value &lt;dbl&gt;\n\n# Unite 'age_start' and 'age_end' into a single age group label\nbreast_cancer_united &lt;- breast_cancer_separated %&gt;%\n  unite(\n    col = age_group_combined,\n    age_start, age_end,\n    sep = \"-\",\n    remove = FALSE\n  )\n\nhead(breast_cancer_united, n = 3)\n\n# A tibble: 3 √ó 17\n  age_group_combined age_start age_end measure sa3code sa3coden sa3name    state\n  &lt;chr&gt;                  &lt;int&gt;   &lt;int&gt; &lt;chr&gt;     &lt;int&gt;    &lt;int&gt; &lt;chr&gt;      &lt;chr&gt;\n1 50-74                     50      74 part      10102    10102 Queanbeyan NSW  \n2 50-69                     50      69 part      10102    10102 Queanbeyan NSW  \n3 50-54                     50      54 part      10102    10102 Queanbeyan NSW  \n# ‚Ñπ 9 more variables: year &lt;int&gt;, agen50_74 &lt;int&gt;, agen50_69 &lt;int&gt;,\n#   agen50_54 &lt;int&gt;, agen55_59 &lt;int&gt;, agen60_64 &lt;int&gt;, agen65_69 &lt;int&gt;,\n#   agen70_74 &lt;int&gt;, value &lt;dbl&gt;\n\n# ....................................................\n# Remove temporary objects created in this chunk\n# ....................................................\nrm(breast_cancer_long, breast_cancer_separated, breast_cancer_united, breast_cancer_final)\n\n\n\n\n\n\n\n\n\nlubridate::ymd(), as_date(), format(), %p, weekdays()\nExtracting date components: year, month, quarter\n\nWorking with dates is essential in many datasets, particularly for time-based trends, age calculations, seasonal effects, and survival analysis.\nWe use the lubridate package to parse, extract, and manipulate dates efficiently. The details about time and date data has been presented separately.\n‚û°Ô∏è For full tutorials and videos: - YouTube (AnalyticsHub): Watch Full Video - GitHub: Access Here\nSummary of Functions for Date Handling\n\n\n\n\n\n\n\n\nTask\nFunction\nPurpose\n\n\n\n\nParse ISO dates\nas.Date(), strptime()\nRead and convert raw string timestamps\n\n\nFormat date output\nformat()\nCustomize how dates are displayed\n\n\nExtract components\nyear(), month(), day(), quarter(), week()\nPull year, month, day, quarter, week from dates\n\n\nWeekday labels\nwday(label = TRUE)\nGet day of week in text form\n\n\nDate arithmetic\ndifftime(), -\nCalculate differences between dates\n\n\nLogical operations\n&lt;, &gt;, between()\nFilter by date ranges\n\n\nFiscal/seasonal grouping\ncase_when()\nCategorize based on seasons or financial years\n\n\n\n\nDemonstration using Vaccination Dataset\n\n# Convert DATE into usable R date format\nvaccination &lt;- vaccination %&gt;%\n  mutate(\n    vacc_date = as.Date(strptime(date, format = \"%Y-%m-%dT%H:%M:%SZ\")),\n    vacc_year = year(vacc_date),\n    vacc_month = month(vacc_date, label = TRUE, abbr = FALSE)\n  ) %&gt;% \n  select(-description, base_cost)\n\nhead(vaccination)\n\n                  date                              patient base_cost\n1 2016-04-10T09:04:48Z 30a6452c-4297-a1ac-977a-6a23237c7b46       136\n2 2016-04-10T09:04:48Z 30a6452c-4297-a1ac-977a-6a23237c7b46       136\n3 2016-04-10T09:04:48Z 30a6452c-4297-a1ac-977a-6a23237c7b46       136\n4 2016-04-10T09:04:48Z 30a6452c-4297-a1ac-977a-6a23237c7b46       136\n5 2002-10-29T19:07:21Z 34a4dcc4-35fb-6ad5-ab98-be285c586a4f       136\n6 2005-11-01T19:07:21Z 34a4dcc4-35fb-6ad5-ab98-be285c586a4f       136\n   vacc_date year    month vaccine_group          vacc_group3 vacc_year\n1 2016-04-10 2016    April     Influenza Respiratory vaccines      2016\n2 2016-04-10 2016    April     DTP group   Childhood vaccines      2016\n3 2016-04-10 2016    April     Hepatitis   Childhood vaccines      2016\n4 2016-04-10 2016    April Meningococcal   Childhood vaccines      2016\n5 2002-10-29 2002  October     Influenza Respiratory vaccines      2002\n6 2005-11-01 2005 November     Influenza Respiratory vaccines      2005\n  vacc_month\n1      April\n2      April\n3      April\n4      April\n5    October\n6   November\n\n\nCalculating Time Differences\n\n# Calculating Time Differences\n\n# Convert column names to lowercase\ncolnames(patients) &lt;- tolower(colnames(patients))\ncolnames(vaccination) &lt;- tolower(colnames(vaccination))\n\n# vacc_pt_merged &lt;- left_join(patients, vaccination, by = \"id\" )\nvacc_pt_merged &lt;- left_join(patients, vaccination, by = c(\"id\" = \"patient\"))\n\nstr (vacc_pt_merged)\n\n'data.frame':   1619 obs. of  37 variables:\n $ id                 : chr  \"30a6452c-4297-a1ac-977a-6a23237c7b46\" \"30a6452c-4297-a1ac-977a-6a23237c7b46\" \"30a6452c-4297-a1ac-977a-6a23237c7b46\" \"30a6452c-4297-a1ac-977a-6a23237c7b46\" ...\n $ birthdate          : chr  \"1994-02-06\" \"1994-02-06\" \"1994-02-06\" \"1994-02-06\" ...\n $ deathdate          : chr  \"\" \"\" \"\" \"\" ...\n $ ssn                : chr  \"999-52-8591\" \"999-52-8591\" \"999-52-8591\" \"999-52-8591\" ...\n $ drivers            : chr  \"S99996852\" \"S99996852\" \"S99996852\" \"S99996852\" ...\n $ passport           : chr  \"X47758697X\" \"X47758697X\" \"X47758697X\" \"X47758697X\" ...\n $ prefix             : chr  \"Mr.\" \"Mr.\" \"Mr.\" \"Mr.\" ...\n $ first              : chr  \"Joshua658\" \"Joshua658\" \"Joshua658\" \"Joshua658\" ...\n $ middle             : chr  \"Alvin56\" \"Alvin56\" \"Alvin56\" \"Alvin56\" ...\n $ last               : chr  \"Kunde533\" \"Kunde533\" \"Kunde533\" \"Kunde533\" ...\n $ suffix             : logi  NA NA NA NA NA NA ...\n $ maiden             : chr  \"\" \"\" \"\" \"\" ...\n $ marital            : chr  \"M\" \"M\" \"M\" \"M\" ...\n $ race               : chr  \"white\" \"white\" \"white\" \"white\" ...\n $ ethnicity          : chr  \"nonhispanic\" \"nonhispanic\" \"nonhispanic\" \"nonhispanic\" ...\n $ gender             : chr  \"M\" \"M\" \"M\" \"M\" ...\n $ birthplace         : chr  \"Boston  Massachusetts  US\" \"Boston  Massachusetts  US\" \"Boston  Massachusetts  US\" \"Boston  Massachusetts  US\" ...\n $ address            : chr  \"811 Kihn Viaduct\" \"811 Kihn Viaduct\" \"811 Kihn Viaduct\" \"811 Kihn Viaduct\" ...\n $ city               : chr  \"Braintree\" \"Braintree\" \"Braintree\" \"Braintree\" ...\n $ state              : chr  \"Massachusetts\" \"Massachusetts\" \"Massachusetts\" \"Massachusetts\" ...\n $ county             : chr  \"Norfolk County\" \"Norfolk County\" \"Norfolk County\" \"Norfolk County\" ...\n $ fips               : int  25021 25021 25021 25021 25021 25021 25021 25021 25021 25021 ...\n $ zip                : int  2184 2184 2184 2184 2184 2184 2184 2184 2184 2184 ...\n $ lat                : num  42.2 42.2 42.2 42.2 42.2 ...\n $ lon                : num  -71 -71 -71 -71 -71 ...\n $ healthcare_expenses: num  56905 56905 56905 56905 56905 ...\n $ healthcare_coverage: num  18020 18020 18020 18020 18020 ...\n $ income             : int  100511 100511 100511 100511 100511 100511 49737 49737 49737 49737 ...\n $ date               : chr  \"2016-04-10T09:04:48Z\" \"2016-04-10T09:04:48Z\" \"2016-04-10T09:04:48Z\" \"2016-04-10T09:04:48Z\" ...\n $ base_cost          : num  136 136 136 136 136 136 136 136 136 136 ...\n $ vacc_date          : Date, format: \"2016-04-10\" \"2016-04-10\" ...\n $ year               : chr  \"2016\" \"2016\" \"2016\" \"2016\" ...\n $ month              : chr  \"April\" \"April\" \"April\" \"April\" ...\n $ vaccine_group      : chr  \"Influenza\" \"DTP group\" \"Hepatitis\" \"Meningococcal\" ...\n $ vacc_group3        : chr  \"Respiratory vaccines\" \"Childhood vaccines\" \"Childhood vaccines\" \"Childhood vaccines\" ...\n $ vacc_year          : num  2016 2016 2016 2016 2019 ...\n $ vacc_month         : Ord.factor w/ 12 levels \"January\"&lt;\"February\"&lt;..: 4 4 4 4 4 4 10 11 8 8 ...\n\nvacc_pt_merged %&gt;% \n  mutate(\n    vacc_date = as.Date(strptime(date, format = \"%Y-%m-%dT%H:%M:%SZ\")),\n    birthdate = as.Date(birthdate),\n    days_to_vax = as.numeric(difftime(vacc_date, birthdate, units = \"days\")),\n    weeks_to_vax = as.numeric(difftime(vacc_date, birthdate, units = \"weeks\")),\n    months_to_vax = as.numeric(difftime(vacc_date, birthdate, units = \"days\")) / 30.44,\n    years_to_vax = floor(as.numeric(difftime(vacc_date, birthdate, units = \"days\")) / 365.25)\n  ) -&gt; vacc_pt_merged\n\nsummary(vacc_pt_merged$days_to_vax)\n\n   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. \n      0    2548    7742   10375   18263   36813 \n\nsummary(vacc_pt_merged$years_to_vax)\n\n   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. \n   0.00    6.00   21.00   28.02   50.00  100.00 \n\n\nExtracting Date Components\n\nvacc_pt_merged &lt;- vacc_pt_merged %&gt;%\n  mutate(\n    vacc_day = day(vacc_date),\n    vacc_month_num = month(vacc_date),\n    vacc_month_name = month(vacc_date, label = TRUE, abbr = FALSE),\n    vacc_weekday = wday(vacc_date, label = TRUE, abbr = FALSE),\n    vacc_week = week(vacc_date),\n    vacc_quarter = quarter(vacc_date),\n    vacc_year = year(vacc_date),  # Define vacc_year first\n    vacc_fy = if_else(vacc_month_num &gt;= 7, vacc_year, vacc_year - 1),  # FY starts 1 July in Australia\n    vacc_season = case_when(\n      vacc_month_num %in% 12:2 ~ \"Summer\",\n      vacc_month_num %in% 3:5  ~ \"Autumn\",\n      vacc_month_num %in% 6:8  ~ \"Winter\",\n      vacc_month_num %in% 9:11 ~ \"Spring\"\n    ),\n    is_weekend = wday(vacc_date) %in% c(1, 7),\n    days_since_ref = floor(as.numeric(difftime(vacc_date, as.Date(\"2020-01-01\"), units = \"days\")))\n  )\n\ntemp &lt;- vacc_pt_merged %&gt;%\n  select(vacc_day, vacc_month_num, vacc_month_name, vacc_weekday, vacc_week,\n         vacc_quarter, vacc_year, vacc_fy, vacc_season, is_weekend, days_since_ref)\n\nhead(temp, n = 8)\n\n  vacc_day vacc_month_num vacc_month_name vacc_weekday vacc_week vacc_quarter\n1       10              4           April       Sunday        15            2\n2       10              4           April       Sunday        15            2\n3       10              4           April       Sunday        15            2\n4       10              4           April       Sunday        15            2\n5       14              4           April       Sunday        15            2\n6       17              4           April       Sunday        16            2\n7       29             10         October      Tuesday        44            4\n8        1             11        November      Tuesday        44            4\n  vacc_year vacc_fy vacc_season is_weekend days_since_ref\n1      2016    2015      Summer       TRUE          -1361\n2      2016    2015      Summer       TRUE          -1361\n3      2016    2015      Summer       TRUE          -1361\n4      2016    2015      Summer       TRUE          -1361\n5      2019    2018      Summer       TRUE           -262\n6      2022    2021      Summer       TRUE            837\n7      2002    2002      Summer      FALSE          -6273\n8      2005    2005      Summer      FALSE          -5174\n\nrm (temp)\n\nFiltering Between Date Ranges\n\n# Calculate Age as of 31 December 2024\n# str(vacc_pt_merged$birthdate) \n\nvacc_pt_merged &lt;- vacc_pt_merged %&gt;%\n  mutate(\n    age = floor(time_length(difftime(as.Date(\"2024-12-31\"), birthdate), unit = \"years\"))\n  )\n\ntable (vacc_pt_merged$age)\n\n\n  1   2   5   6   7  10  11  12  13  14  15  16  17  18  19  20  21  23  24  25 \n 46  24  64  66  34 102  38  59  21  21  34  83  18  36  18  34  48  13  12  47 \n 27  28  29  30  33  34  36  37  38  40  41  42  43  44  45  46  47  48  49  50 \n 17  30   9  38   4   7   6   8   6  20  37  16   9  17  15  13   9  21  30  15 \n 51  52  53  55  56  58  60  61  62  63  64  65  68  69  71  73  74  76  78  80 \n 13  30  16  30  30  14  12  27  49  13  26  14  14  57  15  27  15  14  12  13 \n 85  97 110 \n 12  20   1 \n\n# Categorize into Age Groups\nvacc_pt_merged &lt;- vacc_pt_merged %&gt;%\n  mutate(\n    age_group = cut(\n      age,\n      breaks = c(0, 9, 19, 29, 49, 100),\n      labels = c(\"0‚Äì9\", \"10‚Äì19\", \"20‚Äì29\", \"30‚Äì49\", \"50+\"),\n      right = TRUE\n    )\n  )\n\ntable (vacc_pt_merged$age_group)\n\n\n  0‚Äì9 10‚Äì19 20‚Äì29 30‚Äì49   50+ \n  234   430   210   256   488 \n\n# Vaccinations only in 2022\nvacc_2022 &lt;- vacc_pt_merged %&gt;%\n  filter(vacc_date &gt;= ymd(\"2022-01-01\") & vacc_date &lt;= ymd(\"2022-12-31\"))\n\n# Vaccinations between 2015 and 2024\nvacc_1524 &lt;- vacc_pt_merged %&gt;%\n  filter(vacc_year &gt;= 2015 & vacc_year &lt;= 2024)\n\ntable(vacc_1524$vacc_year)\n\n\n2015 2016 2017 2018 2019 2020 2021 2022 2023 2024 \n 153  139  137  151  161  137  263  120  170  122 \n\nrm(vacc_2022)\n\n\n\n\n\nID Creation (if missing): paste(), substr(), as.Date(), unite()\nDetecting Duplicates: duplicated(), distinct(), n_distinct(), row_number(), count(distinct(‚Ä¶))\nTagging Duplicates: row_number(), duplicated(), mutate(dup = row_number())\nValidating Duplicates: group_by() + filter(n() &gt; 1), arrange(), subset()\nRemoving Duplicates: filter(dup == 1), distinct(), summarise()\nOptional Filtering Rules: Keep first/last by date, non-missing only, domain-specific logic\n\nDuplicate records in health or survey data can compromise the integrity of analyses. A critical first step is ensuring each individual has a consistent and unique identifier (ID). When explicit IDs are missing or unreliable, they can be constructed using combinations of variables such as names, dates of birth, and location (e.g., using paste(), substr(), or unite()). Once IDs are established, duplicates can be detected, reviewed, and resolved systematically through tagging (row_number()), visual inspection, and appropriate retention or removal strategies.\n\nüîπ Key Aspects of Duplicate Management\n\n\n\n\n\n\n\n\nAspect\nWhat to Address\nWhy It Matters\n\n\n\n\nDetection Methods\nUse duplicated(), distinct(), n_distinct(), row_number() by ID or keys\nHelps quantify and locate potential duplicates\n\n\nValidation\nVisual/manual review using arrange(), group_by() + filter()\nPrevents removal of legitimate but similar entries\n\n\nTagging Duplicates\nLabel using row_number() or duplicated()\nAllows flexible filtering or analysis of repeats\n\n\nDeciding What to Keep\nKeep first, latest (by date), or non-missing based on rules\nAvoids loss of useful or most complete records\n\n\nRemoval or Aggregation\nDrop with filter(), or use summarise() to collapse duplicates\nDepends on context: reporting vs.¬†recordkeeping\n\n\nID Creation / Fixing\nUse mutate() to create or correct IDs\nEnables future joins and tracking\n\n\n\n\nThe following table shows the summary with some data manipulation options\n\n\n\n\n\n\n\n\nTask\nFunction / Code\nPurpose\n\n\n\n\nIdentify blank IDs or fields\nx[x == \"\"] &lt;- NA\nConvert empty strings to NA for proper detection\n\n\nCount missing values\nsum(is.na(x))\nCheck how many values are missing\n\n\nCount unique observations\ncount(distinct(df, id))\nDetermine the number of unique records\n\n\nGenerate row numbers per group\ngroup_by(id) %&gt;% mutate(dup = row_number())\nLabel duplicates within each ID\n\n\nCheck duplication status\ntable(df$dup) or sum(dup &gt;= 2)\nSummarise duplication pattern\n\n\nSubset for review\nsubset(df, dup == 2)\nView specific duplicates for manual inspection\n\n\nFilter duplicated individuals\nfilter(n() &gt; 1)\nExtract only duplicated IDs\n\n\nRemove duplicates\nfilter(!(dup &gt;= 2))\nKeep only the first instance per group (if needed)\n\n\nClean temporary object\nrm()\nRemove intermediate datasets from environment\n\n\n\nThis setup ensures duplicates are clearly identified, reviewed, and removed where appropriate.\n\npatients &lt;- patients %&gt;%\n  mutate(\n    birthdate = as.Date(birthdate),\n    id_text = paste0(substr(first, 1, 4), \"|\", substr(last, 1, 4), \"|\", birthdate)\n  )\n# Preview new ID\nhead(patients$id_text, n = 3)\n\n[1] \"Josh|Kund|1994-02-06\" \"Benn|Eber|1968-08-06\" \"Hunt|Gerl|2008-12-21\"\n\n# --- Step 2: Create random numeric ID per individual ---\nset.seed(1234)  # for reproducibility\npatients &lt;- patients %&gt;%\n  mutate(id_num = sample(100000:999999, n(), replace = FALSE))\n\n# Preview both ID columns\npatients %&gt;%\n  select(first, last, birthdate, id_text, id_num) %&gt;%\n  head(5)\n\n      first          last  birthdate              id_text id_num\n1 Joshua658      Kunde533 1994-02-06 Josh|Kund|1994-02-06 861679\n2 Bennie663      Ebert178 1968-08-06 Benn|Eber|1968-08-06 730677\n3 Hunter736    Gerlach374 2008-12-21 Hunt|Gerl|2008-12-21 404107\n4 Carlyn477 Williamson769 1994-01-27 Carl|Will|1994-01-27 395845\n5   Robin66  Gleichner915 2019-07-27 Robi|Glei|2019-07-27 226054\n\n# ....................................................\n# Clean-up if needed\n# ....................................................\n# rm(id_text, id_num) # optional if you store externally\n\ntable (patients$race)\n\n\n asian  black native  other  white \n     8      6      1      3     88 \n\notherrace &lt;- patients %&gt;%\n  filter(race != \"white\")\n\npatients &lt;- rbind(patients, otherrace)\n\n# Count total and unique records\nn_total &lt;- nrow(patients)\nn_unique &lt;- n_distinct(patients$id_text)\nmessage(glue::glue(\"Total records: {n_total}, Unique IDs: {n_unique}\"))\n\nTotal records: 124, Unique IDs: 106\n\n# Tag duplicates using row_number()\npatients &lt;- patients %&gt;%\n  arrange(id_text) %&gt;%\n  group_by(id_text) %&gt;%\n  mutate(dup = row_number()) %&gt;%\n  ungroup()\n# Count number of true duplicates\ntable(patients$dup)\n\n\n  1   2 \n106  18 \n\nprint(sum(patients$dup &gt;= 2))\n\n[1] 18\n\n# Keep only records from individuals who have duplicates\nduplicates &lt;- patients %&gt;%\n  group_by(id_text) %&gt;%\n  filter(n() &gt;= 2) %&gt;%\n  select(id_text, id_num, race, marital, gender, birthdate) %&gt;%\n  ungroup()\n\n# Preview records from duplicated individuals\nhead(duplicates)\n\n# A tibble: 6 √ó 6\n  id_text              id_num race  marital gender birthdate \n  &lt;chr&gt;                 &lt;int&gt; &lt;chr&gt; &lt;chr&gt;   &lt;chr&gt;  &lt;date&gt;    \n1 Alen|Gusi|1927-03-20 361202 other M       F      1927-03-20\n2 Alen|Gusi|1927-03-20 361202 other M       F      1927-03-20\n3 Bert|Alem|1983-05-07 513589 black M       F      1983-05-07\n4 Bert|Alem|1983-05-07 513589 black M       F      1983-05-07\n5 Blan|Rein|1951-11-22 465318 asian S       F      1951-11-22\n6 Blan|Rein|1951-11-22 465318 asian S       F      1951-11-22\n\nrm(duplicates, n_total, n_unique)\n\n\n\n\n\nleft_join(), right_join(), inner_join(), full_join()\nsemi_join() and anti_join()\nbind_rows(), rbind() , bind_cols() and cbind()\n\nWhen analyzing real-world datasets, it‚Äôs often necessary to merge or append multiple datasets.\nThis could involve matching rows based on common identifiers, appending additional cases, or combining variables side-by-side.\nWe can join, bind, or filter datasets efficiently using dplyr and base R techniques.\nBrief Descriptions\n\nleft_join(): Keep all records from the left (main) table; bring matching records from the right table.\nright_join(): Keep all records from the right table; bring matching records from the left.\ninner_join(): Keep only rows where keys match in both tables.\nfull_join(): Keep all records from both tables; missing matches filled with NA.\nsemi_join(): Keep rows from the left table where a match exists in the right.\nanti_join(): Keep only rows from the left table that don‚Äôt match the right.\n\n‚û°Ô∏è bind_rows() and rbind() are used for stacking datasets.\n‚û°Ô∏è bind_cols() and cbind() are used for attaching new columns horizontally.\nSummary Table: Key Functions for Joining and Appending\n\n\n\n\n\n\n\n\nTask\nFunction\nPurpose\n\n\n\n\nMerge by common key\nleft_join(), right_join(), inner_join(), full_join()\nMerge datasets using common variables\n\n\nFilter matching rows\nsemi_join()\nKeep rows from left table that have matches in right table\n\n\nFilter non-matching rows\nanti_join()\nKeep rows from left table with no match in right table\n\n\nRow-wise append\nbind_rows()\nStack two datasets vertically (must have same columns)\n\n\nColumn-wise append\nbind_cols()\nAdd columns side-by-side (matching by row position)\n\n\nBasic base R row bind\nrbind()\nAppend rows (base R equivalent to bind_rows)\n\n\nBasic base R column bind\ncbind()\nAppend columns (base R equivalent to bind_cols)\n\n\nJoin a table to itself\nSelf-join\nAnalyze relationships within a single dataset (e.g., hierarchy)\n\n\n\n\nImportant Reminders - Joins (left_join, etc.) match based on a key (column/s). - bind_rows() assumes same column names and types. - bind_cols() assumes same number of rows. - rbind() and cbind() are base R methods but dplyr::bind_*() are more flexible. ‚Äî\nDemonstrating Different Types of Joins with Brief Descriptions\nStandardizing variable Names\nBefore performing joins, it is essential to ensure column names match in both datasets.\nThis avoids errors caused by case differences or inconsistent naming.\n\n# ......................................\n# Full Join: Keep everything from both datasets\n# ......................................\nvacc_full_join &lt;- full_join(\n  patients,\n  vaccination,\n  by = c(\"id\" = \"patient\")\n)\n\nhead(vacc_full_join, n = 3)\n\n                                    id  birthdate deathdate         ssn\n1 30a6452c-4297-a1ac-977a-6a23237c7b46 1994-02-06           999-52-8591\n2 30a6452c-4297-a1ac-977a-6a23237c7b46 1994-02-06           999-52-8591\n3 30a6452c-4297-a1ac-977a-6a23237c7b46 1994-02-06           999-52-8591\n    drivers   passport prefix     first  middle     last suffix maiden marital\n1 S99996852 X47758697X    Mr. Joshua658 Alvin56 Kunde533     NA              M\n2 S99996852 X47758697X    Mr. Joshua658 Alvin56 Kunde533     NA              M\n3 S99996852 X47758697X    Mr. Joshua658 Alvin56 Kunde533     NA              M\n   race   ethnicity gender                birthplace          address      city\n1 white nonhispanic      M Boston  Massachusetts  US 811 Kihn Viaduct Braintree\n2 white nonhispanic      M Boston  Massachusetts  US 811 Kihn Viaduct Braintree\n3 white nonhispanic      M Boston  Massachusetts  US 811 Kihn Viaduct Braintree\n          state         county  fips  zip      lat      lon healthcare_expenses\n1 Massachusetts Norfolk County 25021 2184 42.21114 -71.0458            56904.96\n2 Massachusetts Norfolk County 25021 2184 42.21114 -71.0458            56904.96\n3 Massachusetts Norfolk County 25021 2184 42.21114 -71.0458            56904.96\n  healthcare_coverage income                 date\n1            18019.99 100511 2016-04-10T09:04:48Z\n2            18019.99 100511 2016-04-10T09:04:48Z\n3            18019.99 100511 2016-04-10T09:04:48Z\n                             encounter code\n1 0b03e41b-06a6-66fa-b972-acc5a83b134a  140\n2 0b03e41b-06a6-66fa-b972-acc5a83b134a  113\n3 0b03e41b-06a6-66fa-b972-acc5a83b134a   43\n                                                   description base_cost\n1           Influenza  seasonal  injectable  preservative free       136\n2 Td (adult)  5 Lf tetanus toxoid  preservative free  adsorbed       136\n3                                                 Hep B  adult       136\n\n# ......................................\n# Left Join: Keep all patients, add vaccination if available\n# ......................................\nvacc_left_join &lt;- left_join(\n  patients,\n  vaccination,\n  by = c(\"id\" = \"patient\")\n)\n\nhead(vacc_left_join, n = 3)\n\n                                    id  birthdate deathdate         ssn\n1 30a6452c-4297-a1ac-977a-6a23237c7b46 1994-02-06           999-52-8591\n2 30a6452c-4297-a1ac-977a-6a23237c7b46 1994-02-06           999-52-8591\n3 30a6452c-4297-a1ac-977a-6a23237c7b46 1994-02-06           999-52-8591\n    drivers   passport prefix     first  middle     last suffix maiden marital\n1 S99996852 X47758697X    Mr. Joshua658 Alvin56 Kunde533     NA              M\n2 S99996852 X47758697X    Mr. Joshua658 Alvin56 Kunde533     NA              M\n3 S99996852 X47758697X    Mr. Joshua658 Alvin56 Kunde533     NA              M\n   race   ethnicity gender                birthplace          address      city\n1 white nonhispanic      M Boston  Massachusetts  US 811 Kihn Viaduct Braintree\n2 white nonhispanic      M Boston  Massachusetts  US 811 Kihn Viaduct Braintree\n3 white nonhispanic      M Boston  Massachusetts  US 811 Kihn Viaduct Braintree\n          state         county  fips  zip      lat      lon healthcare_expenses\n1 Massachusetts Norfolk County 25021 2184 42.21114 -71.0458            56904.96\n2 Massachusetts Norfolk County 25021 2184 42.21114 -71.0458            56904.96\n3 Massachusetts Norfolk County 25021 2184 42.21114 -71.0458            56904.96\n  healthcare_coverage income                 date\n1            18019.99 100511 2016-04-10T09:04:48Z\n2            18019.99 100511 2016-04-10T09:04:48Z\n3            18019.99 100511 2016-04-10T09:04:48Z\n                             encounter code\n1 0b03e41b-06a6-66fa-b972-acc5a83b134a  140\n2 0b03e41b-06a6-66fa-b972-acc5a83b134a  113\n3 0b03e41b-06a6-66fa-b972-acc5a83b134a   43\n                                                   description base_cost\n1           Influenza  seasonal  injectable  preservative free       136\n2 Td (adult)  5 Lf tetanus toxoid  preservative free  adsorbed       136\n3                                                 Hep B  adult       136\n\n# ......................................\n# Right Join: Keep all vaccinations, add patients if available\n# ......................................\nvacc_right_join &lt;- right_join(\n  patients,\n  vaccination,\n  by = c(\"id\" = \"patient\")\n)\n\nhead(vacc_right_join, n = 3)\n\n                                    id  birthdate deathdate         ssn\n1 30a6452c-4297-a1ac-977a-6a23237c7b46 1994-02-06           999-52-8591\n2 30a6452c-4297-a1ac-977a-6a23237c7b46 1994-02-06           999-52-8591\n3 30a6452c-4297-a1ac-977a-6a23237c7b46 1994-02-06           999-52-8591\n    drivers   passport prefix     first  middle     last suffix maiden marital\n1 S99996852 X47758697X    Mr. Joshua658 Alvin56 Kunde533     NA              M\n2 S99996852 X47758697X    Mr. Joshua658 Alvin56 Kunde533     NA              M\n3 S99996852 X47758697X    Mr. Joshua658 Alvin56 Kunde533     NA              M\n   race   ethnicity gender                birthplace          address      city\n1 white nonhispanic      M Boston  Massachusetts  US 811 Kihn Viaduct Braintree\n2 white nonhispanic      M Boston  Massachusetts  US 811 Kihn Viaduct Braintree\n3 white nonhispanic      M Boston  Massachusetts  US 811 Kihn Viaduct Braintree\n          state         county  fips  zip      lat      lon healthcare_expenses\n1 Massachusetts Norfolk County 25021 2184 42.21114 -71.0458            56904.96\n2 Massachusetts Norfolk County 25021 2184 42.21114 -71.0458            56904.96\n3 Massachusetts Norfolk County 25021 2184 42.21114 -71.0458            56904.96\n  healthcare_coverage income                 date\n1            18019.99 100511 2016-04-10T09:04:48Z\n2            18019.99 100511 2016-04-10T09:04:48Z\n3            18019.99 100511 2016-04-10T09:04:48Z\n                             encounter code\n1 0b03e41b-06a6-66fa-b972-acc5a83b134a  140\n2 0b03e41b-06a6-66fa-b972-acc5a83b134a  113\n3 0b03e41b-06a6-66fa-b972-acc5a83b134a   43\n                                                   description base_cost\n1           Influenza  seasonal  injectable  preservative free       136\n2 Td (adult)  5 Lf tetanus toxoid  preservative free  adsorbed       136\n3                                                 Hep B  adult       136\n\n# ......................................\n# Inner Join: Keep only matched patients and vaccinations\n# ......................................\nvacc_inner_join &lt;- inner_join(\n  patients,\n  vaccination,\n  by = c(\"id\" = \"patient\"))\n\nhead(vacc_inner_join, n = 3)\n\n                                    id  birthdate deathdate         ssn\n1 30a6452c-4297-a1ac-977a-6a23237c7b46 1994-02-06           999-52-8591\n2 30a6452c-4297-a1ac-977a-6a23237c7b46 1994-02-06           999-52-8591\n3 30a6452c-4297-a1ac-977a-6a23237c7b46 1994-02-06           999-52-8591\n    drivers   passport prefix     first  middle     last suffix maiden marital\n1 S99996852 X47758697X    Mr. Joshua658 Alvin56 Kunde533     NA              M\n2 S99996852 X47758697X    Mr. Joshua658 Alvin56 Kunde533     NA              M\n3 S99996852 X47758697X    Mr. Joshua658 Alvin56 Kunde533     NA              M\n   race   ethnicity gender                birthplace          address      city\n1 white nonhispanic      M Boston  Massachusetts  US 811 Kihn Viaduct Braintree\n2 white nonhispanic      M Boston  Massachusetts  US 811 Kihn Viaduct Braintree\n3 white nonhispanic      M Boston  Massachusetts  US 811 Kihn Viaduct Braintree\n          state         county  fips  zip      lat      lon healthcare_expenses\n1 Massachusetts Norfolk County 25021 2184 42.21114 -71.0458            56904.96\n2 Massachusetts Norfolk County 25021 2184 42.21114 -71.0458            56904.96\n3 Massachusetts Norfolk County 25021 2184 42.21114 -71.0458            56904.96\n  healthcare_coverage income                 date\n1            18019.99 100511 2016-04-10T09:04:48Z\n2            18019.99 100511 2016-04-10T09:04:48Z\n3            18019.99 100511 2016-04-10T09:04:48Z\n                             encounter code\n1 0b03e41b-06a6-66fa-b972-acc5a83b134a  140\n2 0b03e41b-06a6-66fa-b972-acc5a83b134a  113\n3 0b03e41b-06a6-66fa-b972-acc5a83b134a   43\n                                                   description base_cost\n1           Influenza  seasonal  injectable  preservative free       136\n2 Td (adult)  5 Lf tetanus toxoid  preservative free  adsorbed       136\n3                                                 Hep B  adult       136\n\n# ......................................\n# Semi Join: Keep only patients that have a vaccination match\n# (Only patient columns are kept)\n# ......................................\n\nvacc_semi_join &lt;- semi_join(\n  patients,\n  vaccination,\n  by = c(\"id\" = \"patient\"))\n\nhead(vacc_semi_join, n = 3)\n\n                                    id  birthdate  deathdate         ssn\n1 30a6452c-4297-a1ac-977a-6a23237c7b46 1994-02-06            999-52-8591\n2 34a4dcc4-35fb-6ad5-ab98-be285c586a4f 1968-08-06 2009-12-11 999-75-3953\n3 7179458e-d6e3-c723-2530-d4acfe1c2668 2008-12-21            999-70-1925\n    drivers   passport prefix     first      middle       last suffix maiden\n1 S99996852 X47758697X    Mr. Joshua658     Alvin56   Kunde533     NA       \n2 S99993577 X28173268X    Mr. Bennie663               Ebert178     NA       \n3                             Hunter736 Mckinley734 Gerlach374     NA       \n  marital  race   ethnicity gender                  birthplace\n1       M white nonhispanic      M   Boston  Massachusetts  US\n2       D white nonhispanic      M Chicopee  Massachusetts  US\n3         white nonhispanic      M  Spencer  Massachusetts  US\n                      address         city         state          county  fips\n1            811 Kihn Viaduct    Braintree Massachusetts  Norfolk County 25021\n2 975 Pfannerstill Throughway    Braintree Massachusetts  Norfolk County 25021\n3             548 Heller Lane Mattapoisett Massachusetts Plymouth County    NA\n   zip      lat       lon healthcare_expenses healthcare_coverage income\n1 2184 42.21114 -71.04580            56904.96            18019.99 100511\n2 2184 42.25542 -70.97102           124024.12             1075.06  49737\n3    0 41.64829 -70.85062            45645.06             6154.94 133816\n\n# ......................................\n# Anti Join: Keep only patients that do not have a vaccination match\n# ......................................\nvacc_anti_join &lt;- anti_join(\n  patients,\n  vaccination,\n  by = c(\"id\" = \"patient\"))\n\nhead(vacc_anti_join, n = 3)\n\n [1] id                  birthdate           deathdate          \n [4] ssn                 drivers             passport           \n [7] prefix              first               middle             \n[10] last                suffix              maiden             \n[13] marital             race                ethnicity          \n[16] gender              birthplace          address            \n[19] city                state               county             \n[22] fips                zip                 lat                \n[25] lon                 healthcare_expenses healthcare_coverage\n[28] income             \n&lt;0 rows&gt; (or 0-length row.names)\n\n# ......................................\n# Remove temporary datasets\n# ......................................\nrm(vacc_left_join, vacc_right_join, vacc_inner_join, vacc_full_join, vacc_semi_join, vacc_anti_join)\n\nAppending (Binding) DataFrames: Rows and Columns\n\n# Binding Rows Together (bind_rows): Combine NSW, WA, and Others into one dataset\n\nbc_combined_rows &lt;- bind_rows(\n  breast_cancer_NSW,\n  breast_cancer_WA,\n  breast_cancer_others\n)\n\n# Check result\nhead(bc_combined_rows, n = 3)\n\n  sa3code sa3coden    sa3name state   year part50_74 pop50_74 rate50_74\n1   10102    10102 Queanbeyan   NSW 201617      4875     8052  60.50000\n2   10102    10102 Queanbeyan   NSW 201718      5048     8309  60.75961\n3   10102    10102 Queanbeyan   NSW 201819      5276     8588  61.43839\n  agen50_74 expct50_74 part50_69 pop50_69 rate50_69 agen50_69 expct50_69\n1         3       4428      4309     7145  60.30000         2       3929\n2         3       4553      4448     7338  60.62238         2       4013\n3         3       4706      4629     7548  61.33203         2       4113\n  part50_54 pop50_54 rate50_54 agen50_54 expct50_54 part55_59 pop55_59\n1      1284     2251  57.00000         1       1118      1188     1970\n2      1285     2306  55.72035         1       1143      1260     2030\n3      1375     2342  58.70977         1       1166      1252     2093\n  rate55_59 agen55_59 expct55_59 part60_64 pop60_64 rate60_64 agen60_64\n1  60.30000         4       1046      1012     1625  62.30000         5\n2  62.09035         4       1069      1048     1646  63.69947         5\n3  59.81504         4       1098      1105     1689  65.43657         5\n  expct60_64 part65_69 pop65_69 rate65_69 agen65_69 expct65_69 part70_74\n1        950       826     1300  63.50000         6        781       566\n2        953       855     1357  63.02558         6        812       600\n3        967       898     1426  63.00429         6        849       647\n  pop70_74 rate70_74 agen70_74 expct70_74\n1      907  62.40000         7        498\n2      971  61.79725         7        541\n3     1040  62.21032         7        585\n\n# Confirm number of rows\nnrow(bc_combined_rows)\n\n[1] 1364\n\n# Binding Columns Together (bind_cols): Combine Participation Data with SA3 metadata\n# (needs same number of rows)\n\nbc_combined_cols &lt;- bind_cols(\n  participation,\n  breast_cancer_SA3_info )\n# Check result\nhead(bc_combined_cols, n = 3)\n\n    year part50_74 pop50_74 rate50_74 agen50_74 expct50_74 part50_69 pop50_69\n1 201617      4875     8052  60.50000         3       4428      4309     7145\n2 201718      5048     8309  60.75961         3       4553      4448     7338\n3 201819      5276     8588  61.43839         3       4706      4629     7548\n  rate50_69 agen50_69 expct50_69 part50_54 pop50_54 rate50_54 agen50_54\n1  60.30000         2       3929      1284     2251  57.00000         1\n2  60.62238         2       4013      1285     2306  55.72035         1\n3  61.33203         2       4113      1375     2342  58.70977         1\n  expct50_54 part55_59 pop55_59 rate55_59 agen55_59 expct55_59 part60_64\n1       1118      1188     1970  60.30000         4       1046      1012\n2       1143      1260     2030  62.09035         4       1069      1048\n3       1166      1252     2093  59.81504         4       1098      1105\n  pop60_64 rate60_64 agen60_64 expct60_64 part65_69 pop65_69 rate65_69\n1     1625  62.30000         5        950       826     1300  63.50000\n2     1646  63.69947         5        953       855     1357  63.02558\n3     1689  65.43657         5        967       898     1426  63.00429\n  agen65_69 expct65_69 part70_74 pop70_74 rate70_74 agen70_74 expct70_74\n1         6        781       566      907  62.40000         7        498\n2         6        812       600      971  61.79725         7        541\n3         6        849       647     1040  62.21032         7        585\n  sa3code sa3coden    sa3name state\n1   10102    10102 Queanbeyan   NSW\n2   10102    10102 Queanbeyan   NSW\n3   10102    10102 Queanbeyan   NSW\n\n# Appending Rows Using Base R rbind()\n# (Equivalent to bind_rows but simpler cases, needs identical columns)\nbc_combined_rbind &lt;- rbind(\n  breast_cancer_NSW,\n  breast_cancer_WA\n)\n\n# Check result\nhead(bc_combined_rbind, n = 3)\n\n  sa3code sa3coden    sa3name state   year part50_74 pop50_74 rate50_74\n1   10102    10102 Queanbeyan   NSW 201617      4875     8052  60.50000\n2   10102    10102 Queanbeyan   NSW 201718      5048     8309  60.75961\n3   10102    10102 Queanbeyan   NSW 201819      5276     8588  61.43839\n  agen50_74 expct50_74 part50_69 pop50_69 rate50_69 agen50_69 expct50_69\n1         3       4428      4309     7145  60.30000         2       3929\n2         3       4553      4448     7338  60.62238         2       4013\n3         3       4706      4629     7548  61.33203         2       4113\n  part50_54 pop50_54 rate50_54 agen50_54 expct50_54 part55_59 pop55_59\n1      1284     2251  57.00000         1       1118      1188     1970\n2      1285     2306  55.72035         1       1143      1260     2030\n3      1375     2342  58.70977         1       1166      1252     2093\n  rate55_59 agen55_59 expct55_59 part60_64 pop60_64 rate60_64 agen60_64\n1  60.30000         4       1046      1012     1625  62.30000         5\n2  62.09035         4       1069      1048     1646  63.69947         5\n3  59.81504         4       1098      1105     1689  65.43657         5\n  expct60_64 part65_69 pop65_69 rate65_69 agen65_69 expct65_69 part70_74\n1        950       826     1300  63.50000         6        781       566\n2        953       855     1357  63.02558         6        812       600\n3        967       898     1426  63.00429         6        849       647\n  pop70_74 rate70_74 agen70_74 expct70_74\n1      907  62.40000         7        498\n2      971  61.79725         7        541\n3     1040  62.21032         7        585\n\n# Appending Columns Using Base R cbind()\n# (Simple column binding, assumes same number of rows)\n\nbc_combined_cbind &lt;- cbind(\n  participation,\n  breast_cancer_SA3_info)\n\n# Check result\nhead(bc_combined_cbind, n = 3)\n\n    year part50_74 pop50_74 rate50_74 agen50_74 expct50_74 part50_69 pop50_69\n1 201617      4875     8052  60.50000         3       4428      4309     7145\n2 201718      5048     8309  60.75961         3       4553      4448     7338\n3 201819      5276     8588  61.43839         3       4706      4629     7548\n  rate50_69 agen50_69 expct50_69 part50_54 pop50_54 rate50_54 agen50_54\n1  60.30000         2       3929      1284     2251  57.00000         1\n2  60.62238         2       4013      1285     2306  55.72035         1\n3  61.33203         2       4113      1375     2342  58.70977         1\n  expct50_54 part55_59 pop55_59 rate55_59 agen55_59 expct55_59 part60_64\n1       1118      1188     1970  60.30000         4       1046      1012\n2       1143      1260     2030  62.09035         4       1069      1048\n3       1166      1252     2093  59.81504         4       1098      1105\n  pop60_64 rate60_64 agen60_64 expct60_64 part65_69 pop65_69 rate65_69\n1     1625  62.30000         5        950       826     1300  63.50000\n2     1646  63.69947         5        953       855     1357  63.02558\n3     1689  65.43657         5        967       898     1426  63.00429\n  agen65_69 expct65_69 part70_74 pop70_74 rate70_74 agen70_74 expct70_74\n1         6        781       566      907  62.40000         7        498\n2         6        812       600      971  61.79725         7        541\n3         6        849       647     1040  62.21032         7        585\n  sa3code sa3coden    sa3name state\n1   10102    10102 Queanbeyan   NSW\n2   10102    10102 Queanbeyan   NSW\n3   10102    10102 Queanbeyan   NSW\n\n# Important Notes:\n# - bind_rows() can handle different column orders safely\n# - rbind() requires identical column names and order\n# - bind_cols() simply pastes side-by-side, no matching by keys\n# - cbind() assumes same number of rows\n\n# ....................................................\n# Remove all temporary objects created in this chunk\n# ....................................................\nrm(\n  breast_cancer_NSW, breast_cancer_WA, breast_cancer_others, participation, breast_cancer_SA3_info,\n  bc_combined_rows, bc_combined_cols, bc_combined_rbind, bc_combined_cbind\n)\n\n\n\n\nA. Identifying Missing Values\n\nis.na(), anyNA(), sum(is.na(x)), colSums() ‚Äì detect/count missing values\ncomplete.cases() ‚Äì filter complete rows\nConvert blanks to NA: x[x == ‚Äú‚Äú] &lt;- NA\n\nB. Handling Missing Values\n\nBasic Removal/Replacement: na.omit(), replace_na() (tidyr), ifelse()\nForward/Backward Fill: fill() (tidyr) with .direction = ‚Äúdown‚Äù / ‚Äúup‚Äù\nStatistical Imputation:\n\n-Simple: mean/median imputation\n-Multiple: mice::mice()()\n-Advanced: Hmisc::aregImpute, missForest, Amelia, zoo::na.fill\nMissing data is a common issue in real-world datasets. In R, handling missing values properly is essential to ensure the integrity of analyses and avoid misleading results.\nThis section covers how to identify, clean, and impute missing values using base R and tidyverse tools. Techniques range from basic filtering to advanced imputation models.\n‚û°Ô∏è Missing values are typically represented as NA in R. Empty strings (e.g., \"\") or special codes (e.g., -99, \"missing\") may also indicate missingness and need conversion before analysis.\nüîπ Summary of Functions for Handling Missing Values\n\n\n\n\n\n\n\n\nTask\nFunction / Code\nPurpose\n\n\n\n\nDetect missing values\nis.na(x), anyNA(x), sum(is.na(x))\nIdentify/count missing values\n\n\nMissing per column\ncolSums(is.na(df))\nCount NAs per column\n\n\nFilter complete rows\ncomplete.cases(df)\nKeep only rows without any missing values\n\n\nConvert blanks to NA\nx[x == \"\"] &lt;- NA\nConvert empty strings to missing values\n\n\nRemove missing rows\nna.omit(df)\nRemove rows with any missing value\n\n\nReplace missing values\nreplace_na(df, list(...)), ifelse(is.na(x), ...)\nImpute or replace NA with custom logic\n\n\nForward/backward fill\nfill(df, .direction = \"down\" / \"up\")\nFill NA using nearby values\n\n\nMean/median imputation\nx[is.na(x)] &lt;- mean(x, na.rm = TRUE)\nReplace NA with summary statistic\n\n\nMultiple imputation\nmice::mice(df)\nCreate multiple imputed datasets using chained equations\n\n\nAdvanced imputation\nHmisc::aregImpute, missForest, Amelia, zoo::na.fill()\nSpecialized techniques for complex imputations\n\n\n\nüìö Further Learning and Resources\nAdditional tutorials, demonstrations, and datasets are available on:\n\nYouTube Channel ‚Äì AnalyticsHub\nhttps://studio.youtube.com/channel/UCLVKP0g8GvHhOh0kn20T8eg/videos/upload?filter=%5B%5D&sort=%7B%22columnType%22%3A%22date%22%2C%22sortOrder%22%3A%22DESCENDING%22%7D\nGitHub Repository\nhttps://github.com/HabtamuBizuayehu?tab=repositories\n\n\n\n\n                                    id  birthdate deathdate         ssn\n1 898a6256-7ffb-dbe2-e24d-12fda2fedcfd 1966-06-23           999-98-5513\n2 5e0a6984-38d7-c604-f55f-f1de5e933768 1986-07-04           999-58-5560\n3 e335de09-0994-4111-3c15-6edcc17ae4bc 2005-04-25           999-48-3846\n4 45b89342-dc05-8e57-8eee-9ed68ec42378 1984-08-24           999-40-3433\n5 916b1ac8-56c8-ec1b-3b9a-721336a74912 1953-05-10           999-16-3735\n6 dc323bce-e583-d903-303e-9c865bc87e67 2012-09-02           999-90-3605\n    drivers   passport prefix     first     middle          last suffix\n1 S99971131 X62454905X   Mrs.  Maris768              Lindgren255     NA\n2 S99931679 X61479569X   Mrs. Hattie299  Reatha769      Nader710     NA\n3 S99958413               Ms.  Jimmie93 Towanda270      Doyle959     NA\n4 S99985178 X27670495X    Mr. Dwight645  Marlin805      Hilll811     NA\n5 S99968840 X83646024X    Ms.  Tambra47 Brittni468 Balistreri607     NA\n6                             Carson894 Raphael767     Littel644     NA\n     maiden marital  race   ethnicity gender                       birthplace\n1   Dach178       D white nonhispanic      F        Oxford  Massachusetts  US\n2 Harber290       M white nonhispanic      F North Reading  Massachusetts  US\n3                   white nonhispanic      F        Boston  Massachusetts  US\n4                 M white nonhispanic      M    Framingham  Massachusetts  US\n5                 S white nonhispanic      F     Lexington  Massachusetts  US\n6                   white nonhispanic      M      Plymouth  Massachusetts  US\n                        address        city         state           county\n1          962 Stiedemann Vista    Aquinnah Massachusetts     Dukes County\n2            720 O'Keefe Arcade      Newton Massachusetts Middlesex County\n3       493 Cruickshank Mission   Holliston Massachusetts Middlesex County\n4              810 Wolf Pathway      Malden Massachusetts Middlesex County\n5      146 Rowe Village Suite 3 New Bedford Massachusetts   Bristol County\n6 467 Collier Stravenue Unit 12   Attleboro Massachusetts   Bristol County\n   fips  zip      lat       lon healthcare_expenses healthcare_coverage income\n1    NA    0 41.29618 -70.77458           343608.18           884243.46 178323\n2 25017 2468 42.29180 -71.14930           169293.06           801407.90  86384\n3    NA    0 42.24196 -71.46440            64178.99             5906.14 198522\n4 25017 2148 42.43610 -71.14328            36010.63           472861.90  25909\n5 25005 2743 41.69576 -71.01391           281198.90           310261.21 140772\n6 44007 2861 41.94870 -71.30420            45972.75                0.00  71169\n  visit\n1     1\n2     1\n3     1\n4     1\n5     1\n6     1\n\n\n\n# Summarise missing values across all columns\nmissing_summary &lt;- colSums(is.na(visits_all))\nprint(missing_summary[missing_summary &gt; 0])\n\n          deathdate             drivers            passport              prefix \n                 40                   4                  12                   8 \n             middle              suffix              maiden             marital \n                  4                  40                  28                  16 \n               race                fips                 zip healthcare_coverage \n                 20                  12                  12                   4 \n             income \n                 20 \n\n# Total number of missing cells\ntotal_missing &lt;- sum(is.na(visits_all))\ncat(\"Total missing values in dataset:\", total_missing, \"\\n\")\n\nTotal missing values in dataset: 220 \n\n# Count of individuals with at least one missing value\nn_missing_individuals &lt;- sum(!complete.cases(visits_all))\ncat(\"Number of individuals with at least one missing value:\", n_missing_individuals, \"\\n\")\n\nNumber of individuals with at least one missing value: 40 \n\n# Sort records by patient ID and visit number\nvisits_all &lt;- visits_all %&gt;%\n  arrange(id_text, visit)\n\n# View rows with any missing values\nmissing_rows &lt;- visits_all %&gt;%\n  filter(!complete.cases(.))\nhead(missing_rows, n = 12) %&gt;% select(id_text, race, income, passport)\n\n                id_text  race income   passport\n1  Anit|S√°nc|1960-05-07 white  61016  X9157439X\n2  Anit|S√°nc|1960-05-07  &lt;NA&gt;     NA  X9157439X\n3  Anit|S√°nc|1960-05-07 white     NA  X9157439X\n4  Anit|S√°nc|1960-05-07  &lt;NA&gt;  60016  X9157439X\n5  Aure|Weis|2003-11-12 white   8752 X17586296X\n6  Aure|Weis|2003-11-12  &lt;NA&gt;     NA X17586296X\n7  Aure|Weis|2003-11-12 white     NA X17586296X\n8  Aure|Weis|2003-11-12  &lt;NA&gt;   7752 X17586296X\n9  Cars|Litt|2012-09-02 white  71169       &lt;NA&gt;\n10 Cars|Litt|2012-09-02  &lt;NA&gt;     NA       &lt;NA&gt;\n11 Cars|Litt|2012-09-02  &lt;NA&gt;  70169       &lt;NA&gt;\n12 Cars|Litt|2012-09-02 white     NA       &lt;NA&gt;\n\n# Impute passport with \"UNKNOWN\"\ndf_passport &lt;- visits_all %&gt;%\n  mutate(passport_imputed = replace_na(passport, \"UNKNOWN\")) %&gt;%\n  filter(is.na(passport)) %&gt;%\n  select(id, id_text, visit, passport, passport_imputed)\n\nhead(df_passport, n = 12)\n\n                                     id              id_text visit passport\n1  dc323bce-e583-d903-303e-9c865bc87e67 Cars|Litt|2012-09-02     1     &lt;NA&gt;\n2  dc323bce-e583-d903-303e-9c865bc87e67 Cars|Litt|2012-09-02     2     &lt;NA&gt;\n3  dc323bce-e583-d903-303e-9c865bc87e67 Cars|Litt|2012-09-02     3     &lt;NA&gt;\n4  dc323bce-e583-d903-303e-9c865bc87e67 Cars|Litt|2012-09-02     4     &lt;NA&gt;\n5  da7b1f55-c782-544f-ba8c-fe69d519dc85 Doll|Fran|2008-10-04     1     &lt;NA&gt;\n6  da7b1f55-c782-544f-ba8c-fe69d519dc85 Doll|Fran|2008-10-04     2     &lt;NA&gt;\n7  da7b1f55-c782-544f-ba8c-fe69d519dc85 Doll|Fran|2008-10-04     3     &lt;NA&gt;\n8  da7b1f55-c782-544f-ba8c-fe69d519dc85 Doll|Fran|2008-10-04     4     &lt;NA&gt;\n9  e335de09-0994-4111-3c15-6edcc17ae4bc Jimm|Doyl|2005-04-25     1     &lt;NA&gt;\n10 e335de09-0994-4111-3c15-6edcc17ae4bc Jimm|Doyl|2005-04-25     2     &lt;NA&gt;\n11 e335de09-0994-4111-3c15-6edcc17ae4bc Jimm|Doyl|2005-04-25     3     &lt;NA&gt;\n12 e335de09-0994-4111-3c15-6edcc17ae4bc Jimm|Doyl|2005-04-25     4     &lt;NA&gt;\n   passport_imputed\n1           UNKNOWN\n2           UNKNOWN\n3           UNKNOWN\n4           UNKNOWN\n5           UNKNOWN\n6           UNKNOWN\n7           UNKNOWN\n8           UNKNOWN\n9           UNKNOWN\n10          UNKNOWN\n11          UNKNOWN\n12          UNKNOWN\n\n# Sort records by patient ID and visit number (to prepare for forward/backward fill)\nvisits_all &lt;- visits_all %&gt;%\n  arrange(id_text, visit)\n\n# Preview sorted data (tail)\ntail(visits_all %&gt;% select(id_text, visit, race, income), n = 12)\n\n                id_text visit  race income\n29 Jimm|Doyl|2005-04-25     1 white 198522\n30 Jimm|Doyl|2005-04-25     2  &lt;NA&gt;     NA\n31 Jimm|Doyl|2005-04-25     3  &lt;NA&gt; 197522\n32 Jimm|Doyl|2005-04-25     4 white     NA\n33 Mari|Lind|1966-06-23     1 white 178323\n34 Mari|Lind|1966-06-23     2  &lt;NA&gt;     NA\n35 Mari|Lind|1966-06-23     3 white     NA\n36 Mari|Lind|1966-06-23     4  &lt;NA&gt; 177323\n37 Tamb|Bali|1953-05-10     1 white 140772\n38 Tamb|Bali|1953-05-10     2  &lt;NA&gt;     NA\n39 Tamb|Bali|1953-05-10     3 white     NA\n40 Tamb|Bali|1953-05-10     4  &lt;NA&gt; 139772\n\n# Forward fill missing race values within each patient (downward)\nvisits_all &lt;- visits_all %&gt;%\n  group_by(id_text) %&gt;%\n  mutate(race_forward = race) %&gt;%\n  fill(race_forward, .direction = \"down\") %&gt;%\n  ungroup()\n\n# Preview forward-filled race values (head)\nhead(visits_all %&gt;% select(id_text, visit, race, race_forward), n = 12)\n\n# A tibble: 12 √ó 4\n   id_text              visit race  race_forward\n   &lt;chr&gt;                &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt;       \n 1 Anit|S√°nc|1960-05-07     1 white white       \n 2 Anit|S√°nc|1960-05-07     2 &lt;NA&gt;  white       \n 3 Anit|S√°nc|1960-05-07     3 white white       \n 4 Anit|S√°nc|1960-05-07     4 &lt;NA&gt;  white       \n 5 Aure|Weis|2003-11-12     1 white white       \n 6 Aure|Weis|2003-11-12     2 &lt;NA&gt;  white       \n 7 Aure|Weis|2003-11-12     3 white white       \n 8 Aure|Weis|2003-11-12     4 &lt;NA&gt;  white       \n 9 Cars|Litt|2012-09-02     1 white white       \n10 Cars|Litt|2012-09-02     2 &lt;NA&gt;  white       \n11 Cars|Litt|2012-09-02     3 &lt;NA&gt;  white       \n12 Cars|Litt|2012-09-02     4 white white       \n\n# Backward fill missing race values within each patient (upward)\nvisits_all &lt;- visits_all %&gt;%\n  group_by(id_text) %&gt;%\n  mutate(race_backward = race) %&gt;%\n  fill(race_backward, .direction = \"up\") %&gt;%\n  ungroup()\n\n# Preview backward-filled race values (tail)\ntail(visits_all %&gt;% select(id_text, visit, race, race_backward), n = 12)\n\n# A tibble: 12 √ó 4\n   id_text              visit race  race_backward\n   &lt;chr&gt;                &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt;        \n 1 Jimm|Doyl|2005-04-25     1 white white        \n 2 Jimm|Doyl|2005-04-25     2 &lt;NA&gt;  white        \n 3 Jimm|Doyl|2005-04-25     3 &lt;NA&gt;  white        \n 4 Jimm|Doyl|2005-04-25     4 white white        \n 5 Mari|Lind|1966-06-23     1 white white        \n 6 Mari|Lind|1966-06-23     2 &lt;NA&gt;  white        \n 7 Mari|Lind|1966-06-23     3 white white        \n 8 Mari|Lind|1966-06-23     4 &lt;NA&gt;  &lt;NA&gt;         \n 9 Tamb|Bali|1953-05-10     1 white white        \n10 Tamb|Bali|1953-05-10     2 &lt;NA&gt;  white        \n11 Tamb|Bali|1953-05-10     3 white white        \n12 Tamb|Bali|1953-05-10     4 &lt;NA&gt;  &lt;NA&gt;         \n\n# Calculate the global (overall) mean income\nglobal_mean_income &lt;- mean(visits_all$income, na.rm = TRUE)\n\n# Use global mean to impute missing income values\nvisits_all &lt;- visits_all %&gt;%\n  mutate(income_global_mean = ifelse(is.na(income), global_mean_income, income))\n\n# Preview global mean-imputed income (head)\nhead(visits_all %&gt;% select(id_text, visit, income, income_global_mean), n = 12)\n\n# A tibble: 12 √ó 4\n   id_text              visit income income_global_mean\n   &lt;chr&gt;                &lt;dbl&gt;  &lt;dbl&gt;              &lt;dbl&gt;\n 1 Anit|S√°nc|1960-05-07     1  61016             61016 \n 2 Anit|S√°nc|1960-05-07     2     NA             96123.\n 3 Anit|S√°nc|1960-05-07     3     NA             96123.\n 4 Anit|S√°nc|1960-05-07     4  60016             60016 \n 5 Aure|Weis|2003-11-12     1   8752              8752 \n 6 Aure|Weis|2003-11-12     2     NA             96123.\n 7 Aure|Weis|2003-11-12     3     NA             96123.\n 8 Aure|Weis|2003-11-12     4   7752              7752 \n 9 Cars|Litt|2012-09-02     1  71169             71169 \n10 Cars|Litt|2012-09-02     2     NA             96123.\n11 Cars|Litt|2012-09-02     3  70169             70169 \n12 Cars|Litt|2012-09-02     4     NA             96123.\n\n# Calculate mean income per participant (id_text)\nparticipant_mean_income &lt;- visits_all %&gt;%\n  group_by(id_text) %&gt;%\n  summarise(mean_income_id = mean(income, na.rm = TRUE), .groups = \"drop\")\n\n# Use participant-level mean to impute missing income values\nvisits_all &lt;- visits_all %&gt;%\n  left_join(participant_mean_income, by = \"id_text\") %&gt;%\n  mutate(income_participant_mean = ifelse(is.na(income), mean_income_id, income))\n\n# Preview participant mean-imputed income (tail)\ntail(visits_all %&gt;% select(id_text, visit, income, income_participant_mean), n = 12)\n\n# A tibble: 12 √ó 4\n   id_text              visit income income_participant_mean\n   &lt;chr&gt;                &lt;dbl&gt;  &lt;dbl&gt;                   &lt;dbl&gt;\n 1 Jimm|Doyl|2005-04-25     1 198522                  198522\n 2 Jimm|Doyl|2005-04-25     2     NA                  198022\n 3 Jimm|Doyl|2005-04-25     3 197522                  197522\n 4 Jimm|Doyl|2005-04-25     4     NA                  198022\n 5 Mari|Lind|1966-06-23     1 178323                  178323\n 6 Mari|Lind|1966-06-23     2     NA                  177823\n 7 Mari|Lind|1966-06-23     3     NA                  177823\n 8 Mari|Lind|1966-06-23     4 177323                  177323\n 9 Tamb|Bali|1953-05-10     1 140772                  140772\n10 Tamb|Bali|1953-05-10     2     NA                  140272\n11 Tamb|Bali|1953-05-10     3     NA                  140272\n12 Tamb|Bali|1953-05-10     4 139772                  139772\n\n# Multiple imputation for fips, zip, healthcare_coverage, and income\npatients_mice &lt;- visits_all %&gt;%\n  select(id_text, fips, zip, healthcare_coverage, income)\n\n# Apply mice\nimputed &lt;- mice(patients_mice %&gt;% select(-id_text), method = \"pmm\", m = 1, printFlag = FALSE)\n\nWarning: Number of logged events: 1\n\n# Retrieve completed dataset\nmice_result &lt;- complete(imputed)\ncolnames(mice_result) &lt;- paste0(colnames(mice_result), \"_imputed\")\n\n# Join ID and filter rows with original missing values\ndf_mice &lt;- bind_cols(patients_mice, mice_result) %&gt;%\n  filter(is.na(fips) | is.na(zip) | is.na(healthcare_coverage) | is.na(income)) %&gt;%\n  select(id_text,\n         fips, fips_imputed,\n         zip, zip_imputed,\n         healthcare_coverage, healthcare_coverage_imputed,\n         income, income_imputed)\n\nhead(df_mice, n = 12)\n\n# A tibble: 12 √ó 9\n   id_text               fips fips_imputed   zip zip_imputed healthcare_coverage\n   &lt;chr&gt;                &lt;int&gt;        &lt;int&gt; &lt;int&gt;       &lt;int&gt;               &lt;dbl&gt;\n 1 Anit|S√°nc|1960-05-07 25009        25009  1915        1915            1280070.\n 2 Anit|S√°nc|1960-05-07 25009        25009  1915        1915            1280070.\n 3 Aure|Weis|2003-11-12 25027        25027  1606        1606             253645.\n 4 Aure|Weis|2003-11-12 25027        25027  1606        1606             253645.\n 5 Cars|Litt|2012-09-02 44007        44007  2861        2861                 NA \n 6 Cars|Litt|2012-09-02 44007        44007  2861        2861                 NA \n 7 Cars|Litt|2012-09-02 44007        44007  2861        2861                 NA \n 8 Cars|Litt|2012-09-02 44007        44007  2861        2861                 NA \n 9 Doll|Fran|2008-10-04    NA        25013    NA        2468             422516.\n10 Doll|Fran|2008-10-04    NA        25027    NA        1030             422516.\n11 Doll|Fran|2008-10-04    NA        25017    NA        2861             422516.\n12 Doll|Fran|2008-10-04    NA        25017    NA        1606             422516.\n# ‚Ñπ 3 more variables: healthcare_coverage_imputed &lt;dbl&gt;, income &lt;dbl&gt;,\n#   income_imputed &lt;dbl&gt;\n\n# Optional: Inspect logged events from mice\nimputed$loggedEvents\n\n  it im                 dep meth\n1  3  1 healthcare_coverage  pmm\n                                                                                                                                                                                                                                                       out\n1 mice detected that your data are (nearly) multi-collinear.\\nIt applied a ridge penalty to continue calculations, but the results can be unstable.\\nDoes your dataset contain duplicates, linear transformation, or factors with unique respondent names?\n\n# Final summary: compare original and imputed values for rows with missingness\n\nfinal_impute_check &lt;- visits_all %&gt;%\n  filter(is.na(race) | is.na(income)) %&gt;%\n  select(id_text, visit,\n         race, race_forward, race_backward,\n         income, income_global_mean, income_participant_mean)\n\n# Preview top 12\nhead(final_impute_check, n = 12)\n\n# A tibble: 12 √ó 8\n   id_text      visit race  race_forward race_backward income income_global_mean\n   &lt;chr&gt;        &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt;        &lt;chr&gt;          &lt;dbl&gt;              &lt;dbl&gt;\n 1 Anit|S√°nc|1‚Ä¶     2 &lt;NA&gt;  white        white             NA             96123.\n 2 Anit|S√°nc|1‚Ä¶     3 white white        white             NA             96123.\n 3 Anit|S√°nc|1‚Ä¶     4 &lt;NA&gt;  white        &lt;NA&gt;           60016             60016 \n 4 Aure|Weis|2‚Ä¶     2 &lt;NA&gt;  white        white             NA             96123.\n 5 Aure|Weis|2‚Ä¶     3 white white        white             NA             96123.\n 6 Aure|Weis|2‚Ä¶     4 &lt;NA&gt;  white        &lt;NA&gt;            7752              7752 \n 7 Cars|Litt|2‚Ä¶     2 &lt;NA&gt;  white        white             NA             96123.\n 8 Cars|Litt|2‚Ä¶     3 &lt;NA&gt;  white        white          70169             70169 \n 9 Cars|Litt|2‚Ä¶     4 white white        white             NA             96123.\n10 Doll|Fran|2‚Ä¶     2 &lt;NA&gt;  white        white             NA             96123.\n11 Doll|Fran|2‚Ä¶     3 &lt;NA&gt;  white        white         187023            187023 \n12 Doll|Fran|2‚Ä¶     4 white white        white             NA             96123.\n# ‚Ñπ 1 more variable: income_participant_mean &lt;dbl&gt;\n\n# Preview bottom 12\ntail(final_impute_check, n = 12)\n\n# A tibble: 12 √ó 8\n   id_text      visit race  race_forward race_backward income income_global_mean\n   &lt;chr&gt;        &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt;        &lt;chr&gt;          &lt;dbl&gt;              &lt;dbl&gt;\n 1 Home|Qui√±|1‚Ä¶     2 &lt;NA&gt;  white        white             NA             96123.\n 2 Home|Qui√±|1‚Ä¶     3 &lt;NA&gt;  white        white           6361              6361 \n 3 Home|Qui√±|1‚Ä¶     4 white white        white             NA             96123.\n 4 Jimm|Doyl|2‚Ä¶     2 &lt;NA&gt;  white        white             NA             96123.\n 5 Jimm|Doyl|2‚Ä¶     3 &lt;NA&gt;  white        white         197522            197522 \n 6 Jimm|Doyl|2‚Ä¶     4 white white        white             NA             96123.\n 7 Mari|Lind|1‚Ä¶     2 &lt;NA&gt;  white        white             NA             96123.\n 8 Mari|Lind|1‚Ä¶     3 white white        white             NA             96123.\n 9 Mari|Lind|1‚Ä¶     4 &lt;NA&gt;  white        &lt;NA&gt;          177323            177323 \n10 Tamb|Bali|1‚Ä¶     2 &lt;NA&gt;  white        white             NA             96123.\n11 Tamb|Bali|1‚Ä¶     3 white white        white             NA             96123.\n12 Tamb|Bali|1‚Ä¶     4 &lt;NA&gt;  white        &lt;NA&gt;          139772            139772 \n# ‚Ñπ 1 more variable: income_participant_mean &lt;dbl&gt;\n\n# Clean up temporary objects \nrm( participant_mean_income, final_impute_check, global_mean_income, df_passport, df_mice,\n    patients_mice, imputed, mice_result, missing_summary, total_missing, n_missing_individuals, missing_rows\n)\n\n\n\n\n\n\nIn data analysis, summarising and tabulating variables is often the first step before conducting modelling or drawing conclusions. Descriptive statistics reveal the central tendency, variability, distribution shape, and frequency patterns in your dataset.\nThis section provides an overview of the most commonly used R functions for summarising both numeric and categorical variables. These tools help detect outliers, missing data, or skewed distributions and are essential for generating publication-ready summary tables.\nüìö Further are available via:\n\nYouTube: AnalyticsHub\n\nGithub: Summary Tools Repository\n\n\nSome of the contents essential for this section are presented below.\nBasic Summary Statistics\nsummary(), mean(), median(), min(), max(), sd(), var(), range(), quantile(), IQR()\nDistribution Shape / Skewness: skewness(), kurtosis() Extended Descriptive Summaries: describe() ,stat.desc(), skim() Tabulation (Frequencies and Proportions)\ntable(), prop.table(), addmargins(), xtabs()\nTidy Summary and Tabulations\ntabyl(), adorn_percentages(), adorn_totals() ‚Äì From janitor\ncount(), group_by() + summarise() ‚Äì From dplyr\npivot_wider(), pivot_longer() ‚Äì From tidyr\nCross Tabulations: CrossTable() ‚Äì From gmodels\n\n\nThese functions are useful for summarising continuous variables such as age, vaccine cost, or time intervals:\n\nsummary() ‚Äì 5-number summary + mean\n\nmean(), median() ‚Äì Measures of central tendency\n\nsd(), var() ‚Äì Measures of spread\n\nmin(), max() ‚Äì Extremes\n\nrange() ‚Äì Min and max in one\n\nquantile() ‚Äì Percentiles (e.g., 25th, 75th)\nIQR() ‚Äì Interquartile range\n\n\n\n\n  Childhood Respiratory       Other \n        472         955         126 \n\n\n\nFemale   Male \n   798    755 \n\n\n\n# ....................................................\n# Basic Summary Statistics Using Base R\n# ....................................................\n\n# Select key numeric variables\nsummary_vars &lt;- vacc_1524 %&gt;% \n  select(age, base_cost, healthcare_expenses)\n\n# View summary() for a quick five-number summary + mean\nsummary(summary_vars)\n\n      age          base_cost   healthcare_expenses\n Min.   : 1.00   Min.   :136   Min.   :    527.5  \n 1st Qu.:12.00   1st Qu.:136   1st Qu.:  14478.2  \n Median :25.00   Median :136   Median :  56729.2  \n Mean   :32.42   Mean   :136   Mean   : 156656.2  \n 3rd Qu.:52.00   3rd Qu.:136   3rd Qu.: 195830.8  \n Max.   :97.00   Max.   :136   Max.   :1157946.9  \n\n# Individual statistics for 'age'\nmean(vacc_1524$age, na.rm = TRUE)             # Mean age\n\n[1] 32.41661\n\nmedian(vacc_1524$age, na.rm = TRUE)           # Median age\n\n[1] 25\n\nmin(vacc_1524$age, na.rm = TRUE)              # Minimum age\n\n[1] 1\n\nmax(vacc_1524$age, na.rm = TRUE)              # Maximum age\n\n[1] 97\n\nsd(vacc_1524$age, na.rm = TRUE)               # Standard deviation of age\n\n[1] 23.76926\n\nvar(vacc_1524$age, na.rm = TRUE)              # Variance of age\n\n[1] 564.9777\n\nrange(vacc_1524$age, na.rm = TRUE)            # Range: min and max\n\n[1]  1 97\n\nquantile(vacc_1524$age, probs = c(0.25, 0.5, 0.75), na.rm = TRUE)  # Quartiles\n\n25% 50% 75% \n 12  25  52 \n\nIQR(vacc_1524$age, na.rm = TRUE)              # Interquartile range\n\n[1] 40\n\n# ....................................................\n# Clean up temporary object\n# ....................................................\nrm(summary_vars)\n\n\n\n\nThese indicators describe the shape of a numeric variable‚Äôs distribution. They help identify when a variable is:\n\nSkewed (not symmetric)\nHeavy-tailed (high kurtosis)\n\nDistribution Shape: Skewness and Kurtosis\n\n\n\n\n\n\n\n\nValue Range\nSkewness\nKurtosis (Excess)\n\n\n\n\n‚âà 0\nSymmetrical\nMesokurtic (normal-tailed)\n\n\n¬±0.5\nApproximately symmetrical\nSlight deviation\n\n\n¬±0.5 ‚Äì ¬±1\nModerate skew\nModerate peakedness or flatness\n\n\n&gt; ¬±1\nHigh skew (strong asymmetry)\nSubstantial deviation from normality\n\n\n&gt; 0 (kurtosis - 3 &gt; 0)\n‚Äì\nLeptokurtic (peaked, heavy tails)\n\n\n&lt; 0 (kurtosis - 3 &lt; 0)\n‚Äì\nPlatykurtic (flat, light tails)\n\n\n\n\n# Ensure the 'moments' package is installed\nif (!requireNamespace(\"moments\", quietly = TRUE)) {install.packages(\"moments\")}\nlibrary(moments)\n\n\n# Calculate distribution shape statistics\nskewness(vacc_1524$age, na.rm = TRUE)     # Skewness: +ve = right-skewed, -ve = left-skewed\n\n[1] 0.5301022\n\nkurtosis(vacc_1524$age, na.rm = TRUE)     # Kurtosis: &gt;3 = heavy tails, &lt;3 = flat distribution\n\n[1] 2.059686\n\nkurtosis(vacc_1524$age, na.rm = TRUE) - 3  # Excess kurtosis\n\n[1] -0.940314\n\n# ....................................................\n# Histogram to Visualize Distribution Shape\n# ....................................................\nhist(vacc_1524$age, \n     main = \"Histogram of Age\",\n     xlab = \"Age (Years)\", \n     col = \"#69b3a2\", \n     border = \"white\")\n\n\n\n\n\n\n\n\n\n\n\n\nTo produce a comprehensive summary of all variables (especially helpful in surveys or health system datasets), use:\n\ndescribe() ‚Äì From Hmisc: includes labels, missing %, and stats\n\nstat.desc() ‚Äì From pastecs: full statistical description with skew/kurtosis\n\nskim() ‚Äì From skimr: summary with inline histograms and types\n\n\n\n# Install required packages if missing\npackages &lt;- c(\"Hmisc\", \"pastecs\", \"skimr\")\nfor (p in packages) {if (!requireNamespace(p, quietly = TRUE)) install.packages(p)}\n\n# Explicitly load the packages\nlibrary(Hmisc)     # for describe()\nlibrary(pastecs)   # for stat.desc()\nlibrary(skimr)     # for skim()\n\nrm (packages)\n\n\n# ------------------------------\n# Extended Descriptive Summaries\n# ------------------------------\n\n# Hmisc::describe() ‚Äì Detailed variable summary\ndescribe(vacc_1524[, c(\"age\", \"gender\", \"race\")])\n\nvacc_1524[, c(\"age\", \"gender\", \"race\")] \n\n 3  Variables      1553  Observations\n--------------------------------------------------------------------------------\nage \n       n  missing distinct     Info     Mean  pMedian      Gmd      .05 \n    1553        0       62    0.999    32.42       32    26.76      5.0 \n     .10      .25      .50      .75      .90      .95 \n     6.0     12.0     25.0     52.0     68.8     73.0 \n\nlowest :  1  2  5  6  7, highest: 76 78 80 85 97\n--------------------------------------------------------------------------------\ngender \n       n  missing distinct \n    1553        0        2 \n                        \nValue      Female   Male\nFrequency     798    755\nProportion  0.514  0.486\n--------------------------------------------------------------------------------\nrace \n       n  missing distinct \n    1553        0        5 \n                                             \nValue       asian  black native  other  white\nFrequency     111     94     13     29   1306\nProportion  0.071  0.061  0.008  0.019  0.841\n--------------------------------------------------------------------------------\n\n# pastecs::stat.desc() ‚Äì Full statistics with skewness/kurtosis\nstat.desc(vacc_1524$age)\n\n     nbr.val     nbr.null       nbr.na          min          max        range \n1.553000e+03 0.000000e+00 0.000000e+00 1.000000e+00 9.700000e+01 9.600000e+01 \n         sum       median         mean      SE.mean CI.mean.0.95          var \n5.034300e+04 2.500000e+01 3.241661e+01 6.031564e-01 1.183087e+00 5.649777e+02 \n     std.dev     coef.var \n2.376926e+01 7.332432e-01 \n\n# skimr::skim() ‚Äì Tidy summary with histograms and data types\nskim(vacc_1524[, c(\"age\", \"gender\", \"income\")])\n\n\nData summary\n\n\nName\nvacc_1524[, c(‚Äúage‚Äù, ‚Äúgen‚Ä¶\n\n\nNumber of rows\n1553\n\n\nNumber of columns\n3\n\n\n_______________________\n\n\n\nColumn type frequency:\n\n\n\nfactor\n1\n\n\nnumeric\n2\n\n\n________________________\n\n\n\nGroup variables\nNone\n\n\n\nVariable type: factor\n\n\n\n\n\n\n\n\n\n\n\nskim_variable\nn_missing\ncomplete_rate\nordered\nn_unique\ntop_counts\n\n\n\n\ngender\n0\n1\nFALSE\n2\nFem: 798, Mal: 755\n\n\n\nVariable type: numeric\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nskim_variable\nn_missing\ncomplete_rate\nmean\nsd\np0\np25\np50\np75\np100\nhist\n\n\n\n\nage\n0\n1\n32.42\n23.77\n1\n12\n25\n52\n97\n‚ñá‚ñÉ‚ñÉ‚ñÉ‚ñÅ\n\n\nincome\n0\n1\n108887.58\n139702.07\n7361\n35860\n75767\n124775\n816851\n‚ñá‚ñÅ‚ñÅ‚ñÅ‚ñÅ\n\n\n\n\n\n\n\n\nUsed for categorical variables like gender, race, or vaccine group:\n\ntable() ‚Äì Basic frequency counts\n\nprop.table() ‚Äì Row/column proportions\n\naddmargins() ‚Äì Adds totals to tables\n\nxtabs() ‚Äì Cross-tabulation formula interface\n\n\n\n# --------------------------------------------\n# üîπ Categorical Variable Summary \n# --------------------------------------------\n\n# Basic frequency counts for individual vaccine types\ntable(vacc_1524$vaccine_group)\n\n\n          COVID-19          DTP group          Hepatitis                Hib \n               144                147                111                 32 \n               HPV          Influenza                IPV      Meningococcal \n                59                811                 47                 50 \n               MMR Pneumococcal PCV13 Pneumococcal PPV23          Rotavirus \n                26                 52                  8                 21 \n         Varicella             Zoster \n                26                 19 \n\n# Frequency counts for grouped vaccine categories\ntable(vacc_1524$vacc_group3)\n\n\n  Childhood Respiratory       Other \n        472         955         126 \n\n# Proportion of grouped vaccine categories\nprop.table(table(vacc_1524$vacc_group3))  # Overall proportions\n\n\n  Childhood Respiratory       Other \n 0.30392788  0.61493883  0.08113329 \n\n# Frequency table with row/column totals added\naddmargins(table(vacc_1524$vacc_group3))\n\n\n  Childhood Respiratory       Other         Sum \n        472         955         126        1553 \n\n# Cross-tabulation between vaccine group and gender\nxtabs(~ vacc_group3 + gender, data = vacc_1524)\n\n             gender\nvacc_group3   Female Male\n  Childhood      233  239\n  Respiratory    511  444\n  Other           54   72\n\n\n\n\n\nModern workflows prefer tidy-format summaries using:\n\ntabyl() ‚Äì From janitor: clean frequency tables\n\nadorn_totals(), adorn_percentages() ‚Äì Add percentages and totals\n\ncount() ‚Äì From dplyr: group-level counts\n\ngroup_by() + summarise() ‚Äì Group-wise summary\npivot_wider(), pivot_longer() ‚Äì Reshape tables\n\nThe section below demonstrates tabulations using janitor::tabyl() and tidyverse functions for grouped summaries and table reshaping.\n\n# --------------------------------------------\n# üîπ Tabulation and Table Reshaping \n# --------------------------------------------\n\n# 1. Basic clean frequency table with janitor::tabyl()\nvacc_1524 %&gt;%\n  tabyl(vacc_group3)\n\n vacc_group3   n    percent\n   Childhood 472 0.30392788\n Respiratory 955 0.61493883\n       Other 126 0.08113329\n\n# 2. Add column percentages and total row\nvacc_1524 %&gt;%\n  tabyl(vacc_group3, gender) %&gt;%\n  adorn_percentages(\"col\") %&gt;%\n  adorn_totals(\"row\") %&gt;%\n  adorn_title(\"combined\")  # Cleaner column names\n\n vacc_group3/gender     Female       Male\n          Childhood 0.29197995 0.31655629\n        Respiratory 0.64035088 0.58807947\n              Other 0.06766917 0.09536424\n              Total 1.00000000 1.00000000\n\n# 3. Group-level count using dplyr::count()\nvacc_1524 %&gt;%\n  count(vacc_group3, gender)\n\n  vacc_group3 gender   n\n1   Childhood Female 233\n2   Childhood   Male 239\n3 Respiratory Female 511\n4 Respiratory   Male 444\n5       Other Female  54\n6       Other   Male  72\n\n# 4. Group-wise summary using group_by + summarise\nvacc_1524 %&gt;%\n  group_by(vacc_group3) %&gt;%\n  summarise(n = n(), .groups = \"drop\") %&gt;%\n  mutate(prop = n / sum(n))\n\n# A tibble: 3 √ó 3\n  vacc_group3     n   prop\n  &lt;fct&gt;       &lt;int&gt;  &lt;dbl&gt;\n1 Childhood     472 0.304 \n2 Respiratory   955 0.615 \n3 Other         126 0.0811\n\n# 5. Pivot table to wide format (e.g., for display or reporting)\nvacc_1524 %&gt;%\n  count(vacc_group3, gender) %&gt;%\n  pivot_wider(names_from = gender, values_from = n, values_fill = 0)\n\n# A tibble: 3 √ó 3\n  vacc_group3 Female  Male\n  &lt;fct&gt;        &lt;int&gt; &lt;int&gt;\n1 Childhood      233   239\n2 Respiratory    511   444\n3 Other           54    72\n\n# 6. Optional: Pivot longer to return to tidy format\nvacc_1524 %&gt;%\n  count(vacc_group3, gender) %&gt;%\n  pivot_wider(names_from = gender, values_from = n, values_fill = 0) %&gt;%\n  pivot_longer(-vacc_group3, names_to = \"gender\", values_to = \"count\")\n\n# A tibble: 6 √ó 3\n  vacc_group3 gender count\n  &lt;fct&gt;       &lt;chr&gt;  &lt;int&gt;\n1 Childhood   Female   233\n2 Childhood   Male     239\n3 Respiratory Female   511\n4 Respiratory Male     444\n5 Other       Female    54\n6 Other       Male      72\n\n\n\n\n\nUsed to explore the relationship between two or more categorical variables.\n\nCrossTable() ‚Äì From gmodels: produces detailed cross-tabs with row %, column %, and counts\n\n\n# Install and load the gmodels package for cross-tabulation\nif (!requireNamespace(\"gmodels\", quietly = TRUE)) {\n  install.packages(\"gmodels\")\n}\nlibrary(gmodels)\n\n\n# ------------------------------\n# Cross Tabulation Example\n# ------------------------------\n\n# Generate a contingency table between gender and vaccine group\nCrossTable(vacc_1524$vacc_group3, vacc_1524$gender,\n           prop.r = FALSE,     # Row proportions\n           prop.c = TRUE,     # Column proportions\n           prop.t = FALSE,    # Overall proportion (optional)\n           chisq = TRUE)      # Include chi-square test for independence\n\n\n \n   Cell Contents\n|-------------------------|\n|                       N |\n| Chi-square contribution |\n|           N / Col Total |\n|-------------------------|\n\n \nTotal Observations in Table:  1553 \n\n \n                      | vacc_1524$gender \nvacc_1524$vacc_group3 |    Female |      Male | Row Total | \n----------------------|-----------|-----------|-----------|\n            Childhood |       233 |       239 |       472 | \n                      |     0.375 |     0.396 |           | \n                      |     0.292 |     0.317 |           | \n----------------------|-----------|-----------|-----------|\n          Respiratory |       511 |       444 |       955 | \n                      |     0.838 |     0.886 |           | \n                      |     0.640 |     0.588 |           | \n----------------------|-----------|-----------|-----------|\n                Other |        54 |        72 |       126 | \n                      |     1.783 |     1.885 |           | \n                      |     0.068 |     0.095 |           | \n----------------------|-----------|-----------|-----------|\n         Column Total |       798 |       755 |      1553 | \n                      |     0.514 |     0.486 |           | \n----------------------|-----------|-----------|-----------|\n\n \nStatistics for All Table Factors\n\n\nPearson's Chi-squared test \n------------------------------------------------------------\nChi^2 =  6.162349     d.f. =  2     p =  0.04590531 \n\n\n \n\n\n\nüîπ Summary Table: Descriptive Statistics and Tabulation Functions\n\n\n\n\n\n\n\n\nTask\nFunction\nPackage\n\n\n\n\nBasic numeric summaries\nsummary(), mean(), sd(), IQR()\nbase\n\n\nPercentiles and range\nquantile(), range()\nbase\n\n\nSkewness / Kurtosis\nskewness(), kurtosis()\ne1071, moments\n\n\nExtended profiling\ndescribe(), stat.desc(), skim()\nHmisc, pastecs, skimr\n\n\nFrequency tables\ntable(), xtabs(), prop.table()\nbase\n\n\nClean tables (tidy)\ntabyl(), adorn_*(), count()\njanitor, dplyr\n\n\nGroup summaries\ngroup_by() + summarise()\ndplyr\n\n\nReshape for tables\npivot_wider(), pivot_longer()\ntidyr\n\n\nRich cross-tabulation\nCrossTable()\ngmodels\n\n\n\n\n\n\n\n\nwrite.csv(), write_xlsx(), saveRDS(), write_tsv()\nExporting interactive tables with DT::datatable()\nSaving and loading the entire R workspace (save.image(), load())\n\n\n\n\n\n\nVisualization Contents and Types Overview\n\nLayers: Theme, Coordinates, Facets, Statistics, Geometries, Aesthetics, Data\nChart Types: line, histogram, boxplot, bar, area, density, violin, dotplot, ECDF, scatter, bubble, QQ plot\nComparative & Multivariate: faceted plot, pair plot, heatmap, treemap, radar chart, ridgeline plot, forest plot\nGeospatial Visualization: choropleth map, point map, heatmap overlay\nStatistical Overlays: error bars, confidence intervals, regression lines, smoothers\nInteractive Visualization: scatter/line/bar (Plotly), interactive tables (DT), interactive maps (Leaflet), dashboards (Shiny, flexdashboard)\n\nEffective visualizations help uncover patterns, trends, and insights in data. In R, we commonly use the ggplot2 package for static plots and tools like plotly, DT, and leaflet for interactive dashboards and graphics.\nThe sections below summarize different types of visualizations and how they fit into analysis workflows.\n\n\n\nEvery ggplot chart is built using multiple composable layers: - Data: The dataset to visualize. - Aesthetics (aes()): Mappings between variables and visual elements (e.g., x, y, color). - Geometries (geom_*): Plot types (e.g., geom_line(), geom_bar()). - Statistics (stat_*): Summaries or transformations (e.g., stat_smooth()). - Facets: Create multiple plots by group (facet_wrap(), facet_grid()). - Coordinates: Set axis and aspect ratio (coord_cartesian(), coord_flip()). - Themes: Control overall appearance (e.g., theme_minimal(), theme_bw()).\n\n\n\n\n\n\n\n\n\n\n\nChart Type\nFunction\nUsed For\n\n\n\n\nLine Chart\ngeom_line()\nTrends over time\n\n\nHistogram\ngeom_histogram()\nDistribution of continuous variables\n\n\nBoxplot\ngeom_boxplot()\nDistribution & outliers\n\n\nBar Plot\ngeom_bar()\nCounts or categorical comparison\n\n\nArea Plot\ngeom_area()\nCumulative trends\n\n\nDensity Plot\ngeom_density()\nSmoothed distribution\n\n\nViolin Plot\ngeom_violin()\nCombination of boxplot + density\n\n\nDot Plot\ngeom_dotplot()\nCount-based plots\n\n\nECDF Plot\nstat_ecdf()\nCumulative distribution\n\n\nScatter Plot\ngeom_point()\nBivariate relationships\n\n\nBubble Plot\ngeom_point(aes(size = ...))\n3-variable comparison using size\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nVisual Type\nPurpose\n\n\n\n\nFaceted Plot (facet_wrap)\nCompare subgroups in separate panels\n\n\nPair Plot (GGally::ggpairs)\nExplore all pairwise relationships\n\n\nHeatmap (geom_tile, heatmap())\nShow intensity using color\n\n\nTreemap (treemapify)\nHierarchical categories and values\n\n\nRadar Chart (fmsb)\nCompare multivariate profiles\n\n\nRidgeline Plot (ggridges)\nDistribution comparison across groups\n\n\nForest Plot (forestplot, ggforestplot)\nConfidence intervals and effect sizes\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nMap Type\nFunction/Use\n\n\n\n\nChoropleth Map\nShow values by region (e.g., geom_sf(), tmap)\n\n\nPoint Map\nLocations with coordinates (e.g., geom_point(), leaflet::addMarkers)\n\n\nHeatmap Overlay\nDensity of spatial events (e.g., leaflet::addHeatmap())\n\n\n\n\n\n\n\n\nError bars: geom_errorbar() for confidence or SD intervals\nRegression lines: geom_smooth(method = \"lm\")\nTrend smoothing: geom_smooth() with method = \"loess\"\nLabeling: geom_text(), geom_label() to annotate plots\n\n\nThis section demonstrates how to visualize breast cancer screening and vaccination data. We‚Äôll walk through common chart types such as line plots, bar charts, boxplots, and faceted views. Each example is designed with annotations and descriptions to aid understanding.\n\n\n\n\nEach chart demonstrates how different ggplot2 components come together using real health datasets.\n\n# Install if not already installed\nif (!requireNamespace(\"treemapify\", quietly = TRUE)) {install.packages(\"treemapify\")}\nif (!requireNamespace(\"ggridges\", quietly = TRUE)) {install.packages(\"ggridges\")}\nif (!requireNamespace(\"gganimate\", quietly = TRUE)) install.packages(\"gganimate\")\nif (!requireNamespace(\"gifski\", quietly = TRUE)) install.packages(\"gifski\")\n\nlibrary(gganimate)\nlibrary(gifski)\nlibrary(ggridges)\nlibrary(dplyr)\nlibrary(ggplot2)\nlibrary(plotly)\nlibrary(treemapify)\nlibrary(stringr)  # for str_to_title()\nlibrary(tidyr)\n\n\n\n Date[1:1553], format: \"1994-02-06\" \"1994-02-06\" \"1994-02-06\" \"1994-02-06\" \"1994-02-06\" ...\n\n\n\n  1   2   5   6   7  10  11  12  13  14  15  16  17  18  19  20  21  23  24  25 \n 46  24  64  66  34 100  38  59  21  21  34  81  18  36  18  34  40  13  12  47 \n 27  28  29  30  33  34  36  37  38  40  41  42  43  44  45  46  47  48  49  50 \n 17  30   9  35   4   7   6   8   6  20  37  16   9  17  15  13   9  21  30  15 \n 51  52  53  55  56  58  60  61  62  63  64  65  68  69  71  73  74  76  78  80 \n 13  30  16  30  26  14  12  24  36  13  25  14  14  47  14  19  15  14  12  13 \n 85  97 \n 12  10 \n\n\n\n  0‚Äì9 10‚Äì19 20‚Äì29 30‚Äì49   50+ \n  234   426   202   253   438 \n\n\n\n2016 2017 2018 2019 \n 341  341  341  341 \n\n\nLine Chart ‚Äì Breast Cancer Screening Trends by Region in Australia\nThe example below shows a line chart illustrating trends in breast cancer screening rates across Australian states from 2016 to 2019.\n\nBreast cancer screening rates across most Australian states appeared relatively consistent from 2016 to 2018, with minor year-to-year variations.\nA notable decline in screening rates is evident after 2018 and particularly in 2019, coinciding with the early stages of the COVID-19 pandemic\n\nState-specific Observations:\n\nTasmania (Tas) consistently had the highest screening rate, around 60%, but showed a clear decline post-2018.\nThe Northern Territory (NT) had the lowest rates, around 40%, also experiencing a slight decline during this period.\nOther states (ACT, NSW, Qld, SA, Vic, WA) maintained relatively stable rates (around 55%) until 2018, after which a distinct downturn is noticeable, particularly in Western Australia (WA) and Victoria (Vic).\n\nImpact of COVID-19:\n\nThe observed decline in breast cancer screening from 2019 onwards aligns with the emergence of the COVID-19 pandemic, which disrupted routine healthcare services globally.\n\nThis analysis underscores the importance of maintaining consistent access to healthcare services, particularly preventive screenings, even during periods of significant healthcare disruption.\n\n# Visualizing changes in screening rates (50‚Äì74 years) over time by state\n\nbreast_cancer_data %&gt;%\n  group_by(state, year_4digit) %&gt;%  # group by state and year\n  summarise(mean_rate = mean(rate50_74, na.rm = TRUE), .groups = \"drop\") %&gt;%\n  ggplot(aes(x = year_4digit, y = mean_rate, color = state)) +  # map axes and color\n  geom_line(size = 1.2) +  # trend lines\n  geom_point(size = 2) +   # points for each year\n  labs(\n    title = \"Breast Cancer Screening Rates (50‚Äì74 yrs)\",  \n    subtitle = \"Aggregated by State and Year\",           \n    x = \"Year\", y = \"Screening Rate (%)\",  # Axis labels\n    color = \"State\"   # Legend title\n  ) +\n  \n  theme_minimal()  \n\nWarning: Using `size` aesthetic for lines was deprecated in ggplot2 3.4.0.\n‚Ñπ Please use `linewidth` instead.\n\n\nWarning: Removed 4 rows containing missing values or values outside the scale range\n(`geom_line()`).\n\n\nWarning: Removed 4 rows containing missing values or values outside the scale range\n(`geom_point()`).\n\n\n\n\n\n\n\n\n\nHistogram ‚Äì Distribution of Age\nDisplays the frequency of vaccinated individuals by age, with a density line overlay to visualize the distribution shape.\nThe example below shows a histogram illustrating the age distribution within our studied population. The distribution highlights a clear bimodal pattern, indicating two main age groups. The largest group comprises younger adults, predominantly around 20‚Äì30 years old, suggesting a significant representation of young adults. A smaller secondary group emerges around 55‚Äì65 years old, reflecting a noticeable segment of older adults. This pattern may indicate specific target groups or demographic characteristics relevant to the population from which the data was collected. Understanding these age clusters can help tailor appropriate health strategies, services, or interventions accordingly.\n\nvacc_1524 %&gt;%\n  ggplot(aes(x = age)) +\n  geom_histogram(aes(y = ..density..), binwidth = 5, fill = \"darkblue\", color = \"white\", alpha = 0.7) +\n  geom_density(color = \"red\", size = 1.2) +\n  labs(title = \"Age Distribution with Density Curve\", x = \"Age\", y = \"Density\") +\n  theme_minimal()\n\nWarning: The dot-dot notation (`..density..`) was deprecated in ggplot2 3.4.0.\n‚Ñπ Please use `after_stat(density)` instead.\n\n\n\n\n\n\n\n\n\nPie Chart ‚Äì Proportion by Vaccine Group\nShows how vaccine groups are proportionally represented in the dataset. Useful for visualizing categorical outcomes.\nIn the example below, the pie chart represents the proportion of vaccinations grouped into three categories:\n\nRespiratory vaccines account for the largest proportion, comprising 61% of all vaccines administered.\nChildhood vaccines represent a significant portion as well, making up 30%.\nThe category labeled Other includes 8% of vaccines administered, indicating a smaller but notable group of vaccinations outside the respiratory and childhood classifications.\n\n\nvacc_1524 %&gt;%\n  count(vacc_group3) %&gt;%\n  mutate(perc = n / sum(n), label = scales::percent(perc)) %&gt;%\n  ggplot(aes(x = \"\", y = perc, fill = vacc_group3)) +\n  geom_col(width = 1) +\n  coord_polar(theta = \"y\") +\n  geom_text(aes(label = label), position = position_stack(vjust = 0.5)) +\n  labs(title = \"Vaccine Group Proportions\", fill = \"Vaccine Group\") +\n  theme_void()\n\n\n\n\n\n\n\n\nBar Plot ‚Äì Vaccination Count by Vaccine Group\nThis plot compares the absolute count of vaccinations across groups, with horizontal bars for better readability of long labels.\nThe example below shows a horizontal bar chart illustrating the total number of vaccinations administered, grouped into three distinct categories:\n\nRespiratory vaccines clearly represent the largest group, indicating that these vaccines were administered most frequently within the population.\nThe Other category accounts for the smallest number of vaccinations, suggesting a relatively minor proportion of miscellaneous or specialized vaccines.\n\n\nvacc_1524 %&gt;%\n  count(vacc_group3) %&gt;%\n  ggplot(aes(x = reorder(vacc_group3, n), y = n, fill = vacc_group3)) +\n  geom_bar(stat = \"identity\") +\n  coord_flip() +\n  labs(title = \"Vaccination Count by Group\", x = NULL, y = \"Count\") +\n  theme_minimal() +\n  theme(legend.position = \"none\")\n\n\n\n\n\n\n\n\nGrouped Bar Plot ‚Äì Vaccination by Race and Vaccine Group\nThe example below shows a stacked bar chart presenting the distribution of vaccinations by race and vaccine category.\n\nRespiratory vaccines (represented in blue) dominate across all racial groups, consistently making up the largest proportion of administered vaccines, especially noticeable among Black and White groups.\nChildhood vaccines (represented in red) form a significant proportion of vaccinations among the Asian and Native groups, highlighting targeted or population-specific vaccination programs for younger age groups within these communities.\nThe Other vaccines category (represented in green) comprises a relatively minor proportion and appears more prominent among the Asian and White populations.\n\n**Implications:**\n\nThese patterns may suggest varying public health strategies, demographic factors, or differing healthcare access across racial groups. Understanding these variations can guide targeted healthcare interventions and improve vaccine coverage equity.\n\n# Prepare data: count vaccinations by race and vaccine group\n\nvacc_1524$race &lt;- tools::toTitleCase(vacc_1524$race)\n\nvacc_summary &lt;- vacc_1524 %&gt;%\n  count(race, vacc_group3) %&gt;%\n  group_by(race) %&gt;%\n  mutate(prop = n / sum(n)) %&gt;%\n  ungroup()\n\nggplot(vacc_summary, aes(x = race, y = prop, fill = vacc_group3)) +\n  geom_col(position = \"dodge\") +\n  labs(\n    title = \"Vaccination Distribution by Race and Vaccine Group\",\n    x = \"Race\", y = \"Proportion\",\n    fill = \"Vaccine Group\"\n  ) +\n  scale_y_continuous(labels = scales::percent_format()) +\n  theme_minimal() +\n  theme(axis.text.x = element_text(angle = 45, hjust = 1))\n\n\n\n\n\n\n\nrm(vacc_summary)\n\nStacked Bar Chart ‚Äì Race by Vaccine Group\nThe example below shows a stacked bar chart illustrating the number of vaccinations administered, grouped by vaccine type and categorized by racial groups.\n\nThe White population received the highest number of vaccinations across all vaccine categories (Childhood, Other, and Respiratory vaccines).\nOther racial groups (Asian, Black, Native, and Other) also received vaccinations, though in smaller numbers across each vaccine type, indicating ongoing efforts to reach diverse communities.\nRespiratory vaccines had the highest total number of vaccinations administered, suggesting these vaccines were a primary focus within the vaccination program.\n\nThis data helps to illustrate which groups have higher vaccine coverage and highlights the importance of ensuring equitable access and distribution across all communities.\n\nvacc_1524 %&gt;%\n  mutate(race = stringr::str_to_title(race)) %&gt;%\n  count(vacc_group3, race) %&gt;%\n  ggplot(aes(x = vacc_group3, y = n, fill = race)) +\n  geom_bar(stat = \"identity\") +\n  labs(title = \"Stacked Bar Chart: Race by Vaccine Group\", x = \"Vaccine Group\", y = \"Count\") +\n  theme_minimal()\n\n\n\n\n\n\n\n\nBoxplot ‚Äì Age Distribution by Vaccine Group\nVisualizes how age varies across vaccine groups using standard boxplots.\nThe example below shows a box plot depicting age distribution for three vaccine categories (Childhood vaccines, Other vaccines, and Respiratory vaccines):\nKey Observations:\n\nChildhood vaccines primarily cover younger ages, with most recipients under 25 years old. Some individuals beyond this age range appear as outliers, suggesting occasional vaccinations in older groups.\nRespiratory vaccines generally target an older age group, with the median age around 50 years, and a broad range from younger adults to elderly populations.\nThe Other vaccines category has a wider age distribution overall, suggesting these vaccines serve diverse age groups, though with fewer individuals compared to the other two groups.\n\nImplications:\nThis visualization highlights clear age-based targeting for different vaccine categories. Childhood vaccines are expectedly administered primarily to younger populations, while respiratory vaccines predominantly reach older adults. Understanding these age patterns helps to plan targeted public health campaigns and resource allocation effectively.\n\nvacc_1524 %&gt;%\n  ggplot(aes(x = vacc_group3, y = age, fill = vacc_group3)) +\n  geom_boxplot() +\n  labs(title = \"Age Distribution by Vaccine Group\",\n       x = \"Vaccine Group\", y = \"Age (Years)\") +\n  theme_minimal() +\n  theme(legend.position = \"none\")\n\n\n\n\n\n\n\n\nBoxplot with Jittered (Individual Data) Points\nCombines summary and raw data by overlaying individual age points on the boxplot.\nThe example below shows a boxplot with individual data points (jittered), displaying the age distribution of individuals across three vaccine groups: Childhood vaccines, Other vaccines, and Respiratory vaccines.\n\nChildhood vaccines:\nMost individuals who received childhood vaccines are young, with a median age around 10 years.\nThe distribution is tightly concentrated, though some older individuals (outliers) also received these vaccines.\nThe data points clearly cluster in younger age ranges, which is expected for this vaccine group.\n\nRespiratory vaccines:\n\nThis group has the highest median age, around 40‚Äì50 years.\nThe data points are more evenly spread out across a wide age range, with many individuals above 60 years, indicating respiratory vaccines are frequently administered to older populations.\n\n\nOther vaccines:\n\nThis group shows a wide range of ages, from infants to older adults.\nWhile the median age is still relatively low, the spread is broader compared to childhood vaccines, suggesting this category includes various vaccines administered across different age groups.\n\nImplications:\nBy combining summary statistics (boxplot) with individual-level data (dots), this chart offers a clear view of both overall trends and variation in vaccination by age. It confirms that vaccine distribution aligns with age-specific health needs‚Äîyoung children for childhood vaccines, and older adults for respiratory vaccines‚Äîwhile also showing the diversity within each group.\n\n\nvacc_1524 %&gt;%\n  ggplot(aes(x = vacc_group3, y = age, fill = vacc_group3)) +\n  geom_boxplot(outlier.shape = NA, alpha = 0.6) +\n  geom_point(position = position_jitter(width = 0.2),\n             alpha = 0.3, color = \"black\", size = 1.2) +\n  labs(title = \"Boxplot with Individual Data Points\",\n       x = \"Vaccine Group\", y = \"Age\") +\n  theme_minimal() +\n  theme(legend.position = \"none\")\n\n\n\n\n\n\n\n\nBoxplot with Violin Overlay\nAdds a violin plot to visualize the full distribution of ages while preserving boxplot summary stats.\nThe plot below combines a boxplot and violin plot to display the age distribution across different vaccine groups: Childhood vaccines, Other vaccines, and Respiratory vaccines.\n\nChildhood vaccines:\nThe age distribution is heavily concentrated among younger individuals, with most recipients under 25 years. The violin shape is widest near the lower ages, tapering quickly, which indicates that childhood vaccines are rarely given to older individuals.\nRespiratory vaccines:\nThe distribution leans toward older age groups, with the median age higher than in other categories. The violin is widest in the 40‚Äì70 age range, suggesting respiratory vaccines are more commonly administered to older adults.\n\n\n\nOther vaccines:\nThis group shows a broader age range. The shape suggests two areas of concentration: one among younger children and another around age 60‚Äì70, indicating this group includes vaccine types used across diverse age groups.\nOverall, this combined plot provides both statistical summaries (via boxplot) and full distribution shapes (via violin plot), helping to clearly distinguish the age-related usage patterns across vaccine types.\n\n\nvacc_1524 %&gt;%\n  ggplot(aes(x = vacc_group3, y = age, fill = vacc_group3)) +\n  geom_violin(alpha = 0.4, color = NA) +\n  geom_boxplot(width = 0.2, outlier.shape = NA) +\n  labs(title = \"Boxplot with Violin Overlay\", x = NULL, y = \"Age\") +\n  theme_minimal() +\n  theme(legend.position = \"none\")\n\n\n\n\n\n\n\n\nNotched Boxplot ‚Äì Median Comparison\nNotches allow a rough comparison of medians across groups. Non-overlapping notches suggest a significant difference.\nThe plot below presents a notched boxplot showing the age distribution for each vaccine group‚ÄîChildhood vaccines, Other vaccines, and Respiratory vaccines.\n\nThe notches around the medians provide a visual guide for comparing the central values (medians) across groups. If the notches do not overlap, it suggests that the medians are likely different in a statistically meaningful way.\n\nKey insights:\n\nChildhood vaccines show a younger age distribution, with a median age around 10 years and a narrow spread. Outliers indicate a few older individuals also received these vaccines.\nRespiratory vaccines are mainly administered to older age groups, with the highest median age among the three categories.\nOther vaccines span a wider range of ages, but the median remains lower than that of respiratory vaccines.\n\nMedian Comparison:\n\nThe non-overlapping notches between childhood and respiratory vaccines suggest a clear difference in median ages.\nThe other vaccines group overlaps slightly with both, indicating a more mixed age distribution and less pronounced difference.\n\n\nvacc_1524 %&gt;%\n  ggplot(aes(x = vacc_group3, y = age, fill = vacc_group3)) +\n  geom_boxplot(notch = TRUE) +\n  labs(title = \"Notched Boxplot: Vaccine Group vs Age\", x = \"Group\", y = \"Age\") +\n  theme_minimal() +\n  theme(legend.position = \"none\")\n\nNotch went outside hinges\n‚Ñπ Do you want `notch = FALSE`?\n\n\n\n\n\n\n\n\n\nFaceted Boxplot by Gender\nBreaks down the age distribution by vaccine group and gender to compare across subgroups.\nThe plot below shows boxplots of age distribution by vaccine group (Childhood, Respiratory, and Other vaccines), separated into two panels by gender (Female and Male).\nKey Observations:\n\nChildhood vaccines:\n\n-    Age distributions are similar for both females and males, with most recipients being under 25 years.\n\n-    A few older outliers are present, especially among females, but the bulk of vaccine recipients are children and adolescents.\n\nRespiratory vaccines:\n\n-    This group shows a wide age range in both genders, with median ages around 40‚Äì45 years.\n\n-    The distribution is slightly more spread out among males, but the overall trend remains consistent across genders.\n\nOther vaccines:\n\n-    A notable gender difference is visible here:\n\n    -   Among **females**, recipients span a broad age range, including many older adults.\n\n    -    Among **males**, the age distribution is narrower and skewed toward younger adults.\nSummary:\nThis faceted view helps highlight how age patterns differ by both vaccine group and gender. While childhood and respiratory vaccine distributions are generally similar across genders, the ‚ÄúOther‚Äù vaccine group shows more variation, possibly reflecting differences in vaccine eligibility, access, or health needs.\n\nvacc_1524 %&gt;%\n  ggplot(aes(x = vacc_group3, y = age, fill = vacc_group3)) +\n  geom_boxplot() +\n  facet_wrap(~ gender) +\n  labs(title = \"Age by Vaccine Group, Faceted by Gender\", x = NULL, y = \"Age\") +\n  theme_minimal() +\n  theme(legend.position = \"none\")\n\n\n\n\n\n\n\n\nOrdered Boxplot ‚Äì by Median Age\nReorders vaccine groups by median age to emphasize differences in distribution centrality.\nThe plot below shows age distributions by vaccine group, with the groups reordered by median age to highlight differences in central tendency.\nKey Observations:\n\nChildhood vaccines have the lowest median age, with most recipients being under 20 years. A small number of older individuals appear as outliers.\nOther vaccines show a moderate median age, but with a wide spread across age groups‚Äîranging from infants to older adults. This suggests these vaccines are used in more varied contexts.\nRespiratory vaccines have the highest median age, with recipients typically ranging from their 30s to older adulthood, reflecting their common use among older populations.\n\nConclusion:\nBy ordering the boxplots by median age, this visual emphasizes the different age profiles targeted by each vaccine group. This approach helps communicate age-related trends in vaccine administration more clearly .\n\nvacc_1524 %&gt;%\n  mutate(vacc_group3 = fct_reorder(vacc_group3, age, median, na.rm = TRUE)) %&gt;%\n  ggplot(aes(x = vacc_group3, y = age, fill = vacc_group3)) +\n  geom_boxplot() +\n  labs(title = \"Boxplot Ordered by Median Age\", x = NULL, y = \"Age\") +\n  theme_minimal() +\n  theme(legend.position = \"none\")\n\n\n\n\n\n\n\n\nArea Plot ‚Äì Monthly Vaccination Trends Over Years\nUses an area chart to show monthly vaccination volumes over multiple years, stacked by year.\nThe area chart below displays monthly vaccination counts over multiple years (2015‚Äì2024), helping visualize seasonal and annual trends in vaccine uptake.\nKey Observations:\n\n2020 stands out with the highest overall vaccination counts, especially between April and June, likely reflecting a surge due to public health responses such as the COVID-19 pandemic.\nIn other years, vaccination numbers are more evenly distributed, with moderate peaks around March‚ÄìApril or August‚ÄìSeptember, possibly aligning with seasonal vaccination programs (e.g., flu campaigns).\n2023 and 2024 show a relatively steady pattern throughout the year, with less fluctuation month-to-month.\nEarlier years (2015‚Äì2017) have lower and more variable volumes compared to recent years.\n\nConclusion:\nThis chart highlights both seasonal vaccination patterns and the impact of specific public health events, such as the elevated activity in 2020. Monitoring these trends over time supports planning for future vaccination campaigns and resource allocation.\n\nvacc_1524 %&gt;%\n  count(vacc_year, vacc_month_name) %&gt;%\n  ggplot(aes(x = vacc_month_name, y = n, group = vacc_year, fill = factor(vacc_year))) +\n  geom_area(alpha = 0.7, position = \"identity\") +\n  labs(title = \"Monthly Vaccination Trends by Year\",\n       x = \"Month\", y = \"Number of Vaccinations\", fill = \"Year\") +\n  theme_minimal()\n\n\n\n\n\n\n\n\nFaceted Plot ‚Äì Proportional Vaccination Trends by Group and Race\nDisplays how the proportion of vaccinations among different races changed across years, separately for each vaccine group.\nThe faceted line plot below shows how the proportion of vaccinations among different racial groups has changed over time (2015‚Äì2024), presented separately for each vaccine group: Childhood, Respiratory, and Other.\nKey Observations:\n\nChildhood vaccines:\n\n-   Proportions vary notably year to year, especially for **Asian**, **Black**, and **Native** groups.\n\n-   The **\"Other\"** and **White** groups show a more consistent presence but with modest fluctuations.\n\n-    Some groups (e.g., Native) show a steady rise in recent years.\n\n**Respiratory vaccines**:\n\n-    Several racial groups (notably **Native**, **Black**, and **Other**) show periods of very high proportions, including years where proportions reached **100%**, likely due to small subgroup sample sizes or data dominance.\n\n-    The **White** and **Asian** groups tend to remain stable, though proportions fluctuate in certain years (e.g., 2020‚Äì2022).\n\nOther vaccines:\n\n-   Representation is generally lower and more variable across all racial groups.\n\n-    The **White** group maintains a small but steady share throughout most years.\n\n**Interpretation:**\nThis faceted view enables comparisons within and between vaccine types, highlighting potential shifts in vaccine access, uptake, or data coverage by racial group over time. It also suggests where disparities or changes in focus may have occurred, helping to inform more equitable vaccination strategies.\n\n# Prepare data: floor year, count by group, compute proportions within each group\n\n# Clean and count total per race/year (for denominator)\ntotal_by_race_year &lt;- vacc_1524 %&gt;%\n  mutate(\n    age = as.integer(round(age)),\n    vacc_year = as.integer(floor(vacc_year)),\n    race = str_to_title(as.character(race))\n  ) %&gt;%\n  count(vacc_year, race, name = \"total_race_year\")\n\n#  Count per vaccine group (for numerator), then join\nvacc_plot_data &lt;- vacc_1524 %&gt;%\n  mutate(\n    age = as.integer(round(age)),\n    vacc_year = as.integer(floor(vacc_year)),\n    race = str_to_title(as.character(race))\n  ) %&gt;%\n  count(vacc_year, race, vacc_group3, name = \"n\") %&gt;%\n  left_join(total_by_race_year, by = c(\"vacc_year\", \"race\")) %&gt;%\n  mutate(prop = n / total_race_year)\n\n# Plot proportion by race within group\nggplot(vacc_plot_data, aes(x = vacc_year, y = prop, color = race)) +\n  geom_line(size = 1) +\n  facet_wrap(~ vacc_group3) +\n  scale_y_continuous(labels = percent_format()) +\n  scale_x_continuous(breaks = pretty(unique(vacc_plot_data$vacc_year))) +\n  labs(\n    title = \"Proportion of Race Within Vaccine Groups by Year\",\n    x = \"Year\", y = \"Proportion\", color = \"Race\"\n  ) +\n  theme_minimal() +\n  theme(axis.text.x = element_text(angle = 45, hjust = 1))\n\n\n\n\n\n\n\nrm(vacc_plot_data, total_by_race_year)\n\nStatistical Overlay ‚Äì Regression Line on Vaccination Age\nAdds a linear regression to examine the relationship between income and age at vaccination.\nThe scatterplot below visualizes the relationship between income (horizontal axis) and age at vaccination (vertical axis), with a linear regression line and confidence band overlaid to summarize the trend.\nKey Observations:\n\nThe fitted regression line shows a slight negative slope, suggesting that as income increases, the age at which individuals receive vaccination tends to decrease modestly.\nThe confidence band (shaded region) around the line is relatively narrow, indicating a fair level of certainty in the trend across the central range of income.\nThe majority of data points are concentrated in the lower income ranges, while higher income values are more sparsely populated and show greater variability.\n\n**Interpretation:**\nThis trend suggests a possible inverse relationship between income and vaccination age‚Äîindividuals with higher income may be more likely to receive vaccines at younger ages. This could reflect differences in healthcare access, awareness, or proactive health behaviors associated with income level.\n\nvacc_1524 %&gt;%\n  ggplot(aes(x = income, y = age)) +\n  geom_point(alpha = 0.3, color = \"gray50\") +\n  geom_smooth(method = \"lm\", se = TRUE, color = \"blue\") +\n  labs(\n    title = \"Association Between Income and Age at Vaccination\",\n    x = \"Income\", y = \"Age\"\n  ) +\n  theme_minimal()\n\n`geom_smooth()` using formula = 'y ~ x'\n\n\n\n\n\n\n\n\n\nRegression Plot ‚Äì Age vs Income by Vaccine Group (Log Scale)\nAdds linear regression and facets by vaccine group. The x-axis is log-scaled to handle skewed income data.\nThe plot below shows scatterplots with linear regression lines, examining the relationship between income and age at vaccination. The plots are faceted by vaccine group: Childhood, Other, and Respiratory. The x-axis uses a logarithmic scale to better handle the skewed distribution of income.\nKey Observations:\n\nChildhood vaccines:\n\n-    A **slight negative trend** is observed, indicating that as income increases, age at vaccination tends to decrease slightly.\n\n-    This may reflect earlier or more timely vaccinations among higher-income individuals for childhood vaccines.\n\nOther vaccines:\n\n-   The regression line is nearly flat with a wide confidence interval, suggesting **no strong or consistent relationship** between income and age at vaccination in this group.\n\n-    This likely reflects diverse vaccine purposes and use across a broad age and income range.\n\nRespiratory vaccines:\n\n-   A **mild negative trend** is also seen here, where higher-income individuals may receive respiratory vaccines at slightly younger ages.\n\n-    However, the relationship is subtle and the confidence interval overlaps considerably with the regression line.\n\n**Interpretation:**\nWhile the strength of association varies across groups, both the childhood and respiratory vaccine panels suggest a small trend where higher income is associated with younger age at vaccination. This may be related to differences in access, preventive health behaviors, or healthcare utilization by income level.\n\nvacc_1524 %&gt;%\n  mutate(vacc_group3 = str_to_title(vacc_group3)) %&gt;%\n  ggplot(aes(x = income, y = age)) +\n  geom_point(alpha = 0.3, color = \"gray50\") +\n  geom_smooth(method = \"lm\", se = TRUE, color = \"blue\") +\n  scale_x_log10(labels = scales::comma_format()) +\n  facet_wrap(~ vacc_group3) +\n  labs(\n    title = \"Association Between Income and Age at Vaccination\",\n    x = \"Income (log scale)\", y = \"Age\"\n  ) +\n  theme_minimal()\n\n`geom_smooth()` using formula = 'y ~ x'\n\n\n\n\n\n\n\n\n\nECDF ‚Äì Age at Vaccination\nThe empirical cumulative distribution function (ECDF) shows the proportion of individuals vaccinated at or below each age. This helps visualize the age distribution in a cumulative way.\nThe plot below presents shows the cumulative proportion of individuals who received a vaccination at or below each age.\nKey Observations:\n\nThe curve rises steeply in the early age range, indicating that a large proportion of individuals were vaccinated at younger ages (e.g., before 30).\nBy around age 50, approximately 80% of individuals had been vaccinated.\nThe curve flattens out after age 75, suggesting fewer vaccinations occur at older ages.\n\nInterpretation:\nThe ECDF provides an intuitive way to understand the distribution of vaccination ages. It highlights that most vaccinations occur in childhood and early adulthood, with fewer individuals vaccinated later in life. This cumulative view complements histograms and boxplots by showing the proportion of individuals affected up to each age.\n\nvacc_1524 &lt;- vacc_1524 %&gt;% filter(income &gt; 0, !is.na(age))\n\nvacc_1524 %&gt;%\n  ggplot(aes(x = age)) +\n  stat_ecdf(geom = \"step\", color = \"steelblue\") +\n  labs(title = \"ECDF of Age at Vaccination\", x = \"Age\", y = \"Cumulative Proportion\") +\n  theme_minimal()\n\n\n\n\n\n\n\n\nTreemap ‚Äì Vaccination by Race and Vaccine Group\nThis treemap visualizes the distribution of vaccinations by race and vaccine group. Larger areas indicate more individuals within each combination.\nThe treemap below displays the distribution of vaccinations across racial groups, further categorized by vaccine group (Childhood, Respiratory, and Other). Each rectangle represents a combination of race and vaccine type, with area size corresponding to the number of individuals vaccinated.\nKey Observations:\n\nThe White population accounts for the largest share overall, with:\n\n-    **788 individuals (50.7%)** in the **Respiratory** vaccine group.\n\n-    **404 individuals (26.0%)** in the **Childhood** vaccine group.\n\n-    **114 individuals (7.3%)** in the **Other** vaccine group.\n\nOther racial groups have smaller shares:\n\n-    **Black** individuals make up a modest proportion across groups, particularly **4.5%** in the Respiratory group and **1.4%** in Childhood vaccines.\n\n-    **Asian** individuals represent **4.4%** of Respiratory vaccines and **2.1%** of Childhood vaccines.\n\n-    **Native** and **Other** groups have minimal representation overall.\n\n**Interpretation:**\nThis treemap visually emphasizes the dominant contribution of the White population across all vaccine types, especially for respiratory vaccines. It also illustrates disparities in representation among racial groups, which can be important for assessing equity in vaccine access, uptake, and program targeting.\n\n# Cross-platform ‚Äúnew device‚Äù:\ndev.new(width = 8, height = 6)  \n\np &lt;- vacc_1524 %&gt;%\n  count(race, vacc_group3) %&gt;%\n  mutate(race = str_to_title(race)) %&gt;%\n  ggplot(aes(area = n, fill = vacc_group3, label = race)) +\n  geom_treemap() +\n  geom_treemap_text(colour = \"white\", place = \"centre\", grow = TRUE) +\n  labs(\n    title = \"Treemap: Vaccination by Race and Vaccine Group\",\n    fill  = \"Vaccine Group\"\n  ) +\n  theme_minimal()\n\nprint(p)\n\nrm (p)\n\n\n#  Treemap - with Labels Showing Counts and Proportions by Race and vaccine Group\nvacc_1524 %&gt;%\n  count(race, vacc_group3) %&gt;%\n  mutate(\n    race = str_to_title(race),\n    total = sum(n),\n    proportion = n / total,\n    label_text = paste0(race, \"\\n\", n, \" (\", percent(proportion, accuracy = 0.1), \")\")\n  ) %&gt;%\n  ggplot(aes(area = n, fill = vacc_group3, label = label_text)) +\n  geom_treemap() +\n  geom_treemap_text(colour = \"white\", place = \"centre\", grow = TRUE, reflow = TRUE) +\n  labs(\n    title = \"Treemap: Vaccination by Race and Vaccine Group\",\n    fill = \"Vaccine Group\"\n  ) +\n  theme_minimal()\n\n\n\n\n\n\n\n\nCorrelation Heatmap ‚Äì Numeric Variables\nThis heatmap displays Pearson correlation coefficients between selected numeric variables. Strong positive or negative values help identify relationships worth further analysis.\nThe heatmap below displays Pearson correlation coefficients between selected numeric variables: age, income, healthcare expenses, and healthcare coverage. Correlation values range from -1 to 1, where values closer to ¬±1 indicate stronger relationships.\nKey Observations:\n\nAge and healthcare coverage show a strong positive correlation (0.65), suggesting that as individuals age, they are more likely to have greater healthcare coverage.\nAge and healthcare expenses are also positively correlated (0.66), indicating that older individuals tend to incur higher healthcare costs.\nHealthcare coverage and healthcare expenses show a moderate positive correlation (0.44), which may reflect that those with more coverage also utilize healthcare services more frequently or thoroughly.\nIncome is not strongly correlated with any other variable in this set, with the highest being a negligible 0.02 with healthcare coverage and a slightly negative value with age (-0.04) and expenses (-0.05).\n\n**Interpretation:**\nThis heatmap highlights potential relationships that may inform further analysis‚Äîespecially the connections between age, coverage, and expenses. In contrast, income appears relatively independent of the other variables in this dataset.\n\nnumeric_vars &lt;- vacc_1524 %&gt;%\n  select(age, income, healthcare_expenses, healthcare_coverage) %&gt;%\n  na.omit()\n\ncor_matrix &lt;- round(cor(numeric_vars), 2)\n\nas.data.frame(as.table(cor_matrix)) %&gt;%\n  rename(Var1 = Var1, Var2 = Var2, Correlation = Freq) %&gt;%\n  ggplot(aes(x = Var1, y = Var2, fill = Correlation)) +\n  geom_tile(color = \"white\") +\n  geom_text(aes(label = Correlation), color = \"black\") +\n  scale_fill_gradient2(low = \"red\", high = \"blue\", mid = \"white\", midpoint = 0) +\n  labs(title = \"Correlation Heatmap of Numeric Variables\", x = NULL, y = NULL) +\n  theme_minimal()\n\n\n\n\n\n\n\n\nRidgeline Plot ‚Äì Age by Vaccine Group\nThis ridgeline plot shows the age distribution for each vaccine group. It highlights where age densities differ across categories.\nThe ridgeline plot below shows age distributions for three vaccine groups: Childhood, Other, and Respiratory. Each layer represents the density of ages within a vaccine category, allowing for visual comparison of where individuals are most commonly vaccinated within each group.\nKey Observations:\n\nChildhood vaccines show a clear peak at very young ages, as expected. The density drops rapidly as age increases, with a small secondary bump around middle age, possibly reflecting catch-up vaccinations or data irregularities.\nOther vaccines have a bimodal distribution with one peak in younger adults and another in older adults (around 70+ years), suggesting they are used across multiple life stages.\nRespiratory vaccines have a broad distribution, with a peak density around 60‚Äì70 years, consistent with routine respiratory vaccinations for older adults (e.g., influenza or pneumococcal vaccines).\n\n**Interpretation:**\nThis visualization effectively highlights differences in age targeting across vaccine groups. It shows that:\n\nChildhood vaccines are concentrated in early life,\nOther vaccines are used more broadly across age ranges, and\nRespiratory vaccines are predominantly administered to older populations.\n\n\nvacc_1524 %&gt;%\n  mutate(vacc_group3 = stringr::str_to_title(vacc_group3)) %&gt;%\n  ggplot(aes(x = age, y = vacc_group3, fill = vacc_group3)) +\n  geom_density_ridges(scale = 1.5, alpha = 0.6, color = \"white\") +\n  labs(title = \"Ridgeline Plot: Age Distribution by Vaccine Group\", x = \"Age\", y = \"Vaccine Group\") +\n  theme_minimal() +\n  theme(legend.position = \"none\")\n\nPicking joint bandwidth of 5.93\n\n\n\n\n\n\n\n\n\nInteractive Plot ‚Äì Income vs Age by Race\nThis interactive scatter plot shows the relationship between income and age, colored by race. Hovering reveals more details including group and income.\n\np &lt;- vacc_1524 %&gt;%\n  mutate(race = stringr::str_to_title(race)) %&gt;%\n  ggplot(aes(x = income, y = age, color = race,\n             text = paste(\"Race:\", race,\n                          \"&lt;br&gt;Group:\", vacc_group3,\n                          \"&lt;br&gt;Income:\", income,\n                          \"&lt;br&gt;Age:\", age))) +\n  geom_point(alpha = 0.6) +\n  geom_smooth(method = \"loess\", se = FALSE, color = \"gray30\") +\n  labs(title = \"Interactive: Income vs Age by Race\",\n       x = \"Income\", y = \"Age\", color = \"Race\") +\n  theme_minimal() +\n  theme(legend.position = \"bottom\")\n\nggplotly(p, tooltip = \"text\")\n\n`geom_smooth()` using formula = 'y ~ x'\n\n\n\n\n\nrm(p)\n\nAnimation ‚Äì Vaccination Trends Over Years\nThis animation shows how vaccination counts across vaccine groups change over time. It helps spot temporal trends and emerging patterns.\n\nanim_plot &lt;- vacc_1524 %&gt;%\n  mutate(vacc_year = as.integer(floor(vacc_year))) %&gt;%\n  count(vacc_year, vacc_group3) %&gt;%\n  ggplot(aes(x = vacc_group3, y = n, fill = vacc_group3)) +\n  geom_col(show.legend = FALSE) +\n  labs(title = 'Year: {frame_time}', x = 'Vaccine Group', y = 'Count') +\n  theme_minimal() +\n  transition_time(vacc_year) +\n  ease_aes('linear')\n\nanim_file &lt;- tempfile(fileext = \".gif\")\nanim &lt;- animate(anim_plot, nframes = 100, fps = 10, renderer = gifski_renderer(anim_file))\n# print(anim)\n\nrm(anim_plot, anim_file, anim)\n\nAnimation ‚Äì Breast Cancer Screening Uptake by State\nThis animated bar chart shows breast cancer screening uptake over time for each Australian state. It uses faceting to compare regional trends.\n\nbreast_anim &lt;- breast_cancer_data %&gt;%\n  filter(!state %in% c(\"Other\", \"Unknown\")) %&gt;%\n  mutate(year_4digit = as.integer(year_4digit)) %&gt;%\n  group_by(state, year_4digit) %&gt;%\n  summarise(total_screened = sum(part50_74, na.rm = TRUE), .groups = \"drop\") %&gt;%\n  ggplot(aes(x = year_4digit, y = total_screened, fill = state)) +\n  geom_col(show.legend = FALSE) +\n  facet_wrap(~ state) +\n  labs(title = 'Year: {frame_time}', x = 'Year', y = 'Women Screened (50‚Äì74 yrs)') +\n  theme_minimal() +\n  transition_time(year_4digit) +\n  ease_aes('linear')\n\nscreening_gif &lt;- tempfile(fileext = \".gif\")\nanim_screen &lt;- animate(breast_anim, nframes = 100, fps = 10, renderer = gifski_renderer(screening_gif))\n# print(anim_screen)\n\nrm(breast_anim, screening_gif, anim_screen)\n\n\n\n\nHeatmap ‚Äì Number of Vaccinations by Month and Weekday Highlights vaccination activity patterns by day of week and month. Darker tiles represent higher counts.\nThe heatmap below demonstrates the number of vaccinations administered across each day of the week and each calendar month. Color intensity indicates the relative number of vaccinations, with darker red representing higher uptake and pale yellow representing lower activity.\nKey Observations:\n\nSaturday consistently shows high uptake, particularly in October, September, and July, suggesting that weekends may be more accessible or preferred for vaccination appointments.\nTuesday in May and Wednesday in August also show pronounced peaks, likely linked to specific campaign efforts or seasonal programs.\nThursday and Friday generally have moderate activity, while Sunday and Monday tend to have lower vaccination counts across most months.\nOverall, the summer and early fall months (July to October) show increased uptake across several weekdays, possibly aligning with back-to-school vaccination drives or respiratory vaccine rollouts.\n\n**Interpretation:**\nThe plot reveals both seasonal and weekly rhythms in vaccination behavior. Recognizing these patterns can guide better scheduling of clinics, resource planning, and public messaging to align with high-demand periods and improve overall vaccine accessibility.\n\n# ................Without  Adding the long Title ........................................................\n# ..............................................................................................\n\n# --- Order weekday and month factors for proper axis display ---\n# --- Convert original vaccination date to Eastern Time (Massachusetts local time) ---\n# Assumes vacc_date is POSIXct or character in UTC or local system time\nvacc_1524 &lt;- vacc_1524 %&gt;%\n  mutate(\n    vacc_datetime_et = with_tz(as.POSIXct(vacc_date, tz = \"UTC\"), tzone = \"America/New_York\"),  # Adjust timezone to Eastern Time\n    vacc_weekday = wday(vacc_datetime_et, label = TRUE, abbr = FALSE),                          # Extract weekday (e.g., Monday)\n    vacc_month_name = month(vacc_datetime_et, label = TRUE, abbr = FALSE)                       # Extract month (e.g., January)\n  )\n\n# --- Order weekday and month factors for proper axis display ---\nvacc_1524 &lt;- vacc_1524 %&gt;%\n  mutate(\n    vacc_month_name = factor(vacc_month_name, levels = month.name),  # Ensure months are in calendar order\n    vacc_weekday = factor(vacc_weekday, levels = c(\"Monday\", \"Tuesday\", \"Wednesday\", \"Thursday\", \"Friday\", \"Saturday\", \"Sunday\"))  # Ensure weekdays are in logical order\n  )\n\n# --- Create heatmap of vaccination counts by weekday and month ---\nvacc_1524 %&gt;%\n  count(vacc_weekday, vacc_month_name) %&gt;%  # Count number of vaccinations by weekday and month\n  ggplot(aes(x = vacc_weekday, y = vacc_month_name, fill = n)) +     # Map weekday to x-axis, month to y-axis, and fill by count\n  geom_tile(color = \"white\") +                                       # Draw heatmap tiles with white border for readability\n  scale_fill_gradientn(                                              # Use custom yellow-to-red color scale\n    colors = c(\"#ffffcc\", \"#ffeda0\", \"#feb24c\", \"#f03b20\", \"#bd0026\"),\n    breaks = scales::pretty_breaks(n = 5),                           # Auto-select 5 good breakpoints for legend\n    name = \"Vaccinated Number\"                                       # Legend title\n  ) +\n  labs(\n    title = \"Vaccination Uptake by Weekday and Month\",               # Plot title\n    subtitle = \"Timestamps interpreted as US Eastern Time (Massachusetts)\",  # Timezone context\n    x = \"Weekday\", y = \"Month\", fill = \"Vaccinated Number\",          # Axis and legend labels\n    caption = \"Note: Original timestamps converted from UTC to America/New_York\"\n  ) +\n  theme_minimal() +\n  theme(\n    text = element_text(family = \"Times New Roman\"),                 # Font style\n    legend.position = \"bottom\",                                      # Move legend below the plot\n    axis.text.x = element_text(angle = 45, hjust = 1, size = 10, face = \"bold\"),  # X-axis label formatting\n    axis.text.y = element_text(size = 10, face = \"bold\"),            # Y-axis label formatting\n    axis.title.x = element_text(face = \"bold\", size = 11),\n    axis.title.y = element_text(face = \"bold\", size = 11),\n    plot.title = element_text(size = 12, face = \"bold\"),\n    legend.title = element_text(size = 10),\n    legend.text = element_text(size = 8)\n  )\n\n\n\n\n\n\n\n# Use figure title below to render in Quarto or Rmarkdown \n#\"Figure XX: Vaccination uptake by weekday and month among individuals aged 15‚Äì24, 2016‚Äì2024.\"\n\n\n# ................Adding the long Title ........................................................\n# ..............................................................................................\n\n# --- Convert original vaccination date to Eastern Time (Massachusetts local time) ---\n# Assumes vacc_date is POSIXct or character in UTC or local system time\nvacc_1524 &lt;- vacc_1524 %&gt;%\n  mutate(\n    vacc_datetime_et = with_tz(as.POSIXct(vacc_date, tz = \"UTC\"), tzone = \"America/New_York\"),  # Adjust timezone to Eastern Time\n    vacc_weekday = wday(vacc_datetime_et, label = TRUE, abbr = FALSE),                          # Extract weekday (e.g., Monday)\n    vacc_month_name = month(vacc_datetime_et, label = TRUE, abbr = FALSE)                       # Extract month (e.g., January)\n  )\n\n# --- Order weekday and month factors for proper axis display ---\nvacc_1524 &lt;- vacc_1524 %&gt;%\n  mutate(\n    vacc_month_name = factor(vacc_month_name, levels = month.name),  # Ensure months are in calendar order\n    vacc_weekday = factor(vacc_weekday, levels = c(\"Monday\", \"Tuesday\", \"Wednesday\", \"Thursday\", \"Friday\", \"Saturday\", \"Sunday\"))  # Ensure weekdays are in logical order\n  )\n\n# --- Create heatmap of vaccination counts by weekday and month ---\np &lt;- vacc_1524 %&gt;%\n  count(vacc_weekday, vacc_month_name) %&gt;%  # Count number of vaccinations by weekday and month\n  ggplot(aes(x = vacc_weekday, y = vacc_month_name, fill = n)) +     # Map weekday to x-axis, month to y-axis, and fill by count\n  geom_tile(color = \"white\") +                                       # Draw heatmap tiles with white border for readability\n  scale_fill_gradientn(                                              # Use custom yellow-to-red color scale\n    colors = c(\"#ffffcc\", \"#ffeda0\", \"#feb24c\", \"#f03b20\", \"#bd0026\"),\n    breaks = scales::pretty_breaks(n = 5),                           # Auto-select 5 good breakpoints for legend\n    name = \"Vaccinated Number\"                                       # Legend title\n  ) +\n  labs(\n    title = \"Vaccination Uptake by Weekday and Month\",               # Plot title\n    x = \"Weekday\", y = \"Month\", fill = \"Vaccinated Number\"           # Axis and legend labels\n  ) +\n  theme_minimal() +\n  theme(\n    text = element_text(family = \"Times New Roman\"),                 # Font style\n    legend.position = \"bottom\",                                      # Move legend below the plot\n    axis.text.x = element_text(angle = 45, hjust = 1, size = 10, face = \"bold\"),  # X-axis label formatting\n    axis.text.y = element_text(size = 10, face = \"bold\"),            # Y-axis label formatting\n    axis.title.x = element_text(face = \"bold\", size = 11),\n    axis.title.y = element_text(face = \"bold\", size = 11),\n    plot.title = element_text(size = 12, face = \"bold\"),\n    legend.title = element_text(size = 10),\n    legend.text = element_text(size = 8)\n  )\n\n# --- Add descriptive figure caption using patchwork's plot_annotation() ---\nfinal_plot &lt;- p + plot_annotation(\n  caption = \"Figure XX: Vaccination uptake by weekday and month among individuals aged 15‚Äì24, 2016‚Äì2024.\",\n  theme = theme(\n    plot.caption = element_text(\n      size = 10, family = \"Times New Roman\", hjust = 0\n    )\n  )\n)\n\n# --- Display the final plot with caption ---\nfinal_plot\n\n\n\n\n\n\n\n# setwd (\"C:/Users/User/Desktop/Materials_ Course and proposals/VIP collection for Syntax code or project titles/R codes/Data Manipulation and Wrangling\")\n# \n# # Save plots\n# ggsave(\"Heatmap_vaccination_pattern by day and month.TIFF\", plot = last_plot(), device = \"tiff\", width = 10, height = 6, units = \"in\")\n# ggsave(\"Heatmap_vaccination_pattern by day and month.svg\", plot = last_plot(), device = \"svg\", width = 10, height = 6, units = \"in\")\n\nrm (p, final_plot)\n\n\n\n\n\n8.1 UI fluidPage(), sidebarLayout(), sidebarPanel(), mainPanel(), tabsetPanel(), tags$style()\n8.2 Server reactive(), observeEvent(), req(), renderPlotly(), renderDT(), modalDialog(), showModal()\n8.3 App Launch shinyApp(ui, server)\n8.4 Inputs sliderInput(), selectInput(), colourInput(), actionButton(), downloadButton()\n8.5 Outputs plotlyOutput(), DTOutput(), datatable(), formatStyle()\n8.6 DT Features extensions = 'Buttons', export options: copy, csv, excel, pdf, print\n8.7 Styling and Themes tags$style(), (shinythemes::shinytheme() ‚Äì loaded but not applied)\nShiny is a web application framework for R that allows analysts to build interactive dashboards and tools using familiar syntax. It provides a structured approach to turning R scripts into accessible apps for broader audiences.\nA typical Shiny app includes two core components:\n\nUI (User Interface): Defines layout, inputs, and outputs shown on the screen interface.\nServer: Contains the logic that processes data and responds to user interactions.\n\nShiny apps can include multiple views (tabs), export buttons, dynamic filtering, charts, and customized design themes.\n\n\n\n\nfluidPage(): Defines the page layout.\nsidebarLayout(), sidebarPanel(), mainPanel(): Organize inputs and outputs side-by-side.\ntabsetPanel(): Allows tab navigation for multi-page apps.\ntags$style(), shinythemes::shinytheme(): Add or apply custom styles/themes.\n\n\n\n\n\n\nreactive(): Creates reactive data or expressions.\nobserveEvent(): Executes code when a trigger changes.\nreq(): Validates necessary input before proceeding.\nOutput functions: renderPlotly(), renderDT(), renderText(), renderTable().\n\n\n\n\n\n\n\n\n\n\n\n\n\nType\nFunction\nPurpose\n\n\n\n\nInput\nsliderInput()\nSelect a numeric value or range\n\n\nInput\nselectInput()\nDropdown menu to choose a category\n\n\nInput\ncolourInput()\nSelect a color\n\n\nInput\nactionButton()\nTrigger processing on click\n\n\nInput\ndownloadButton()\nDownload output tables or data\n\n\nOutput\nplotlyOutput()\nRender interactive plots using Plotly\n\n\nOutput\nDTOutput(), datatable()\nRender interactive tables\n\n\nOutput\nformatStyle()\nApply styling (e.g., color, font) to tables\n\n\n\n\n\n\n\n\nAdd extensions = 'Buttons' to enable table exports.\nExport types: \"copy\", \"csv\", \"excel\", \"pdf\", \"print\".\n\n\n\n\n\n\nshinyApp(ui, server): Runs the Shiny app combining both UI and server logic.\nApps can be hosted on ShinyApps.io, internal servers, or embedded in R Markdown dashboards.\n\n\nThe Shiny app code below demonstrates how interactive visualizations can be built using R to present health data in an accessible and user-friendly format. Specifically, it explores breast cancer screening uptake across states, years, and age groups in Australia. The app enhances user engagement through customizable features and immediate feedback mechanisms.\nKey capabilities demonstrated include: - Dynamic UI generation using fluidPage(), sidebarLayout(), and interactive widgets - State selection using a dropdown (selectInput()), which scales better than radio buttons - Age group filtering with a multiple selection input - Quantile-based filtering with sliderInput() for rate grouping - Color customization of output using colourInput() for personalizing table aesthetics - A modal popup (modalDialog()) triggered by a help button to explain data sources - Export options via downloadButton() and DT export buttons for multiple file formats - Real-time data filtering using reactive() expressions to tailor output to user input - An interactive line plot rendered via plotly and ggplot2 for visualization - Fully styled, downloadable data table with DT::renderDT() and export capabilities\nSee the live app at the following platforms\n\nAnalyticsHub YouTube: https://studio.youtube.com/video/5V7SPBH-8BE/edit\nLive App: https://j9eu4e-habtamu-mellie0bizuayehu.shinyapps.io/Breast_Cancer_Screening_Shiny_App/\n\n\n# Install required packages if not already installed\nrequired_packages &lt;- c(\"shiny\", \"ggplot2\", \"plotly\", \"DT\", \"dplyr\", \"shinyjs\", \"shinyWidgets\", \"scales\", \"colourpicker\")\n\n# Install missing ones\nnew_packages &lt;- required_packages[!(required_packages %in% installed.packages()[,\"Package\"])]\nif(length(new_packages)) install.packages(new_packages)\n\n# Load packages\nlibrary(shiny)\nlibrary(ggplot2)\nlibrary(plotly)\nlibrary(DT)\nlibrary(dplyr)\nlibrary(shinyjs)\nlibrary(shinyWidgets)\nlibrary(scales)\nlibrary(colourpicker)\n\n\n# load the data\nload(\"C:/Users/User/Desktop/Materials_ Course and proposals/VIP collection for Syntax code or project titles/R codes/Shiny App BC Screening/Breast Cancer Screening.RData\")\n\n\n# -------------------Shiny Application for Breast Cancer Screening---------------------\n\n\n# ------------------- UI and Server Definition ---------------------\n\n# Define custom CSS for styling buttons and other UI elements\nui &lt;- fluidPage(\n  \n  # Application title displayed at the top of the app\n  h1(\"Breast Cancer Screening Uptake\"),\n\n  # Apply custom styling to the download button\n  tags$style(HTML(\"\n    #download_data {\n      background: orange;\n      font-size: 20px;\n    }\n  \")),  \n\n  # Layout structure: sidebar for inputs and main panel for outputs\n  sidebarLayout(\n    sidebarPanel(\n      \n      # Quantile-based slider to filter screening rate\n      sliderInput(\"rate_10_group\", \"Rate Group\", \n                  min = min(breast_cancer_long$rate_10_group, na.rm = TRUE), \n                  max = max(breast_cancer_long$rate_10_group, na.rm = TRUE), \n                  value = c(5, 7)),\n      \n      # Dropdown menu for state selection (simplifies and scales better than radio buttons)\n      selectInput(\"state\", \"Select State\",  \n                  choices = unique(breast_cancer_long$state), \n                  selected = \"WA\"),\n\n      # Multi-select dropdown for age groups (allows viewing multiple demographics)\n      selectInput(\"age_group\", \"Women's Age Group\", \n                  choices = unique(breast_cancer_long$age_group), \n                  multiple = TRUE,\n                  selected = unique(breast_cancer_long$age_group)[1]),\n\n      # Add colour input to allow users to control table font colour\n      colourInput(\"color\", \"Point color\", value = \"blue\"),\n\n      # Add a help button that triggers a modal popup for guidance\n      actionButton(\"show_help\", \"Help\"),\n\n      # Add a download button for exporting filtered dataset\n      downloadButton(\"download_data\", \"Download Data\")\n    ),\n\n    mainPanel(\n      # Render the interactive line chart\n      plotlyOutput(\"plot\"),\n\n      # Render the data table output\n      DTOutput(\"table\")\n    )\n  )\n)\n\n# Define server-side logic for rendering outputs and interactivity\nserver &lt;- function(input, output, session) {\n\n  # Show Help Modal: explains data source when help button is clicked\n  observeEvent(input$show_help, {\n    showModal(modalDialog(\n      title = \"Help\",\n      \"This data was compiled from the Australian Institute of Health and Welfare.\"\n    ))\n  })\n\n  # Reactive expression to filter and summarize the dataset based on inputs\n  filtered_data &lt;- reactive({\n    req(input$rate_10_group, input$state, input$age_group)  # Ensure all inputs are available\n\n    breast_cancer_long %&gt;%\n      filter(rate_10_group &gt;= input$rate_10_group[1] & \n               rate_10_group &lt;= input$rate_10_group[2],\n             state == input$state,\n             age_group %in% input$age_group) %&gt;%\n      group_by(year, state, age_group) %&gt;%\n      summarise(year = as.integer(year),  # Convert year to integer for plotting\n                rate = round(mean(rate, na.rm = TRUE), 1),  # Average screening rate\n                .groups = \"drop\") \n  })\n\n  # Render Table: displays filtered data in an interactive table with export options\n  output$table &lt;- renderDT({\n    datatable(filtered_data(), \n              options = list(\n                pageLength = 10,  # Show 10 rows per page\n                dom = 'Bfrtip',  # Include Buttons (copy, csv, pdf, etc.)\n                buttons = c('copy', 'csv', 'excel', 'pdf', 'print'),\n                class = \"display nowrap compact\"  # Responsive and compact table design\n              ),\n              extensions = 'Buttons',\n              style = \"bootstrap\", \n              class = \"table table-striped table-bordered\") %&gt;%\n      formatStyle(columns = names(filtered_data()), color = input$color)  # Use selected color\n  })\n\n  # Download Handler: enables users to download filtered data\n  output$download_data &lt;- downloadHandler(\n    filename = \"Breast_cancer_screening_data.csv\",\n    content = function(file) {\n      write.csv(filtered_data(), file, row.names = FALSE)\n    }\n  )\n\n  # Render Plot: displays line plot of screening rates over time by age group\n  output$plot &lt;- renderPlotly({\n    df &lt;- filtered_data()\n\n    p &lt;- ggplot(df, aes(x = year, y = rate, color = age_group, group = interaction(state, age_group))) +\n      geom_line(size = 1) +  # Draw lines to show trend\n      geom_point(size = 3) +  # Add points to emphasize data values\n      labs(title = \"Breast Cancer Screening Uptake\", \n           x = \"Year\", \n           y = \"Screening Rate\",\n           color = \"Age Group\") +\n      theme_minimal()\n\n    ggplotly(p)  # Convert ggplot to interactive plotly chart\n  })\n}\n\n# Launch the app\nshinyApp(ui, server)"
  },
  {
    "objectID": "Post_Blog/Data_Manipulation_and_Wrangling/index.html#part-i-foundations-and-introduction",
    "href": "Post_Blog/Data_Manipulation_and_Wrangling/index.html#part-i-foundations-and-introduction",
    "title": "Date Manipulation and Wrangling using R",
    "section": "",
    "text": "This section will cover the following contents\n- Installing R and RStudio\n- Setting working directories\n- Clearing environment and console\n- Installing and loading packages (eg tidyverse, janitor, etc.)\n\nInstalling R and RStudio\n\nWhen we begin working with R, the very first step we take is installing two important tools: R itself (the engine) and RStudio (the friendly interface we use every day). I recommend that we install R first and then RStudio immediately after.\nTo make this clear, I have prepared a complete video tutorial that you can watch step-by-step:\nWathc at AnalyticsHub YouTube\nThe video, shows:\n\nHow to Download R from the CRAN website.\nInstall RStudio, which gives us a powerful yet simple environment to work in.\nBriefly explore basic options like font size, theme (dark/light mode), and code editor settings to make RStudio comfortable for coding.\nSetting working directories\nWhen we work in R, it‚Äôs very important that we know where R is reading from and saving to.\nI often think of the working directory as the ‚Äúhome folder‚Äù where all my files live during an R session.\nWe can easily check our current working directory by typing:\n\ngetwd() \n\n[1] \"C:/Users/User/Desktop/Materials_ Course and proposals/VIP collection for Syntax code or project titles/R codes/Website profile Mod 2/Post_Blog/Data_Manipulation_and_Wrangling\"\n\n\n\nThis command tells us exactly where R is currently looking for files.\nIf we want to change the working directory to a folder we are working on (for example, a project folder or a course material folder), we can use:\n\nsetwd(\"C:/Users/User/Desktop/Materials_ Course and proposals/\")\n\nAlways make sure the folder path is in quotation marks and I use forward slashes / or double backslashes \\\\ when typing the path.\nüìå We can also set the working directory easily by clicking:\n\nSession ‚ûî Set Working Directory ‚ûî Choose Directory‚Ä¶\n\nüìö Note about API tokens and special folders:\nIf you are using R for connecting to APIs, cloud storage, or services like GitHub, Dropbox, or Google Drive,\nsometimes you will need to set a working directory where your API token file is stored (for authentication).\n\nsetwd(\"C:/Users/YourName/.credentials/\") \n\n‚ö†Ô∏è Important: Always make sure API tokens and confidential files are in a secure private directory.\n\nClearing environment and console\n\n# Clear environment and console\nrm(list = ls()) # To clear the environment (remove all objects in memory)\ncat(\"\\014\") # To clear the console (like wiping a whiteboard)\n\n\nBefore starting fresh in any R session, I like to clear out everything‚Äîall variables, data, and even the clutter in the console.\nInstalling and loading packages\nWe rely on a range of packages in R for data wrangling, visualization, dashboards, and reporting.\nI typically create a vector of required packages and write a small loop to install any missing ones.\n\n\n# ------------------ Set CRAN Repository ------------------\n\noptions(repos = c(CRAN = \"https://cran.rstudio.com\"))\n\n# ------------------ List of required packages for Data Wrangling and Analysis ------------------\npackages &lt;- c(\n  \"lubridate\", \"dplyr\", \"stringr\", \"zoo\", \"tsibble\", \"ggplot2\", \"plotly\", \n  \"readr\", \"readxl\", \"haven\", \"openxlsx\", \"labelled\", \"forecast\",\n  \"prettydoc\", \"janitor\", \"knitr\", \"rmarkdown\", \"yaml\", \n  \"flextable\", \"scales\", \"gt\", \"reactable\", \"DT\", \"gmodels\", \"Hmisc\",\n  \"tidyverse\", \"tidyr\", \"officer\",\n  \"shiny\", \"shinydashboard\", \"shinythemes\", \"mice\", \"shinyWidgets\", \"bslib\", \"quarto\"\n)\n\n# ------------------ Install and load packages ------------------\nfor (pkg in packages) {\n  if (!require(pkg, character.only = TRUE)) {\n    install.packages(pkg)\n  }\n}\n\n# ------------------ Load required libraries with descriptions ------------------\nlibrary(lubridate)     # Simplifies the manipulation of dates and times in R (e.g., formatting, extracting components)\nlibrary(dplyr)         # Data manipulation: filtering, summarizing, and transforming data\nlibrary(stringr)       # Simplifies string manipulation\nlibrary(tidyr)         # Data tidying: reshaping with pivot_longer, pivot_wider, etc.\nlibrary(purrr)         # Functional programming: map functions over lists/vectors\nlibrary(forcats)       # Categorical data: reordering and labeling factor levels\n\nlibrary(zoo)           # Infrastructure for time series objects\nlibrary(tsibble)       # Tidy temporal data frames and time series modeling\nlibrary(forecast)      # Forecasting functions for time series models\n\nlibrary(readr)         # Read rectangular data like CSVs\nlibrary(readxl)        # Read Excel files (.xls and .xlsx)\nlibrary(haven)         # Import data from SAS, SPSS, and Stata\nlibrary(openxlsx)      # Write to Excel with more control\nlibrary(labelled)      # Attach and work with variable labels\n\nlibrary(ggplot2)       # Create elegant data visualizations using the grammar of graphics\nlibrary(plotly)        # Interactive visualizations using ggplot2 or standalone plotly\nlibrary(scales)        # Provides scale functions for ggplot2 (e.g., log, percent)\n\nlibrary(janitor)       # Clean data: make column names nice, tabulate, etc.\nlibrary(gmodels)       # CrossTables and other classic stats tools\nlibrary(Hmisc)         # Summarization and advanced table/label handling\nlibrary(mice)           # missing data imputation\n\nlibrary(knitr)         # Dynamic report generation in R\nlibrary(rmarkdown)     # Convert R scripts to reports in various formats\nlibrary(prettydoc)     # Beautiful HTML document templates\nlibrary(yaml)          # Read and write YAML files (used in R Markdown, Quarto)\nlibrary(officer)       # Export tables and reports to Word/PowerPoint\n\nlibrary(flextable)     # Create nicely formatted tables\nlibrary(gt)            # Grammar of tables for HTML and PDF output\nlibrary(reactable)     # Interactive data tables\nlibrary(DT)            # Wrapper of JavaScript DataTables for R\n\nlibrary(shiny)         # Build interactive web applications directly from R\nlibrary(shinydashboard)# Create dashboard layouts for Shiny apps\nlibrary(shinythemes)   # Prebuilt UI themes for Shiny apps\nlibrary(shinyWidgets)  # Enhanced UI widgets for Shiny\nlibrary(bslib)         # Bootstrap themes for Shiny and rmarkdown\n\nlibrary(quarto)        # Rendering Quarto documents\n\n\n\n\n\nOperators: &lt;-, %&gt;%, ==, &, |, ~\nAdditional Operators: %in%, ::, %&lt;&gt;%, |&gt;\nSymbols: (), [], {}, \"\", #\nCommenting, structure, and help functions (?function, args())\nUsing R scripts vs.¬†R Markdown vs.¬†Quarto\n\nIn this section, we walk through the fundamental syntax building blocks of R.\nMastering these basics helps write cleaner, more efficient, and more readable code.\nüîπ Operators\nIn R, operators are used to perform operations on objects and values:\n\nAssignment operators (&lt;-, =) store values into objects.\nPipe operators (%&gt;%, %&lt;&gt;%, |&gt;) allow chaining multiple commands together.\nComparison operators (==, !=, &lt;, &gt;) compare values for equality or relational logic.\nLogical operators (&, |, !) build logical expressions (AND, OR, NOT).\nFormula operator (~) defines models and formulas, e.g., y ~ x1 + x2.\nMembership operator (%in%) checks whether an element belongs to a set.\nPackage access operator (::) calls a function from a package without loading the full package.\n\nüîπ Symbols\nSymbols are special characters used in structuring R code:\n\n() : Used for function calls and setting arguments.\n[] : Indexing vectors, matrices, or data frames.\n{} : Grouping multiple expressions into a code block.\n\"\" or '' : Define character strings.\n# : Create comments that are ignored during code execution.\n\nüîπ Help Functions\n\n?function_name : Access the help documentation for any function.\nargs(function_name) : Display the arguments a function accepts.\nüîπ Scripting in .R, .Rmd, .qmd\n\n\n\n\n\n\n\n\nFormat\nDescription\nBest Use Case\n\n\n\n\n.R\nBasic R script. Contains code only, no formatting or output.\nExploratory coding, testing snippets\n\n\n.Rmd\nR Markdown file. Supports code + text + output in one file.\nReproducible reports, presentations, notebooks\n\n\n.qmd\nQuarto document. Successor to R Markdown with more flexible publishing.\nPolished reports, web publishing, multi-language\n\n\n\n\nüìä R Syntax Essentials Summary\n\n\n\n\n\n\n\n\nElement\nSymbol / Syntax\nWhat It Does\n\n\n\n\nAssignment\n&lt;-, =\nAssign a value to a variable (e.g., x &lt;- 5)\n\n\nPipe\n%&gt;%, %&lt;&gt;%, |&gt;\nPass or transform results between functions\n\n\nComparison\n==, !=, &lt;, &gt;\nCompare values (equal, not equal, less than, etc.)\n\n\nLogical\n&, |, !\nLogical conditions: AND, OR, NOT\n\n\nFormula\n~\nDefine model formulas (e.g., y ~ x1 + x2)\n\n\nMembership Test\n%in%\nCheck if an element exists within a vector\n\n\nPackage Function Access\n::\nCall a function from a specific package without loading it\n\n\nFunction Call\n()\nCall a function with arguments (e.g., mean(x))\n\n\nIndexing\n[]\nAccess parts of data structures (e.g., x[1], df[2,3])\n\n\nCode Block\n{}\nGroup multiple lines (loops, conditionals)\n\n\nStrings\n\"text\", 'text'\nDefine character strings\n\n\nCommenting\n#\nInsert a comment ignored by R\n\n\nHelp Functions\n?function, args(function)\nAccess help or check function arguments\n\n\nOutput Format\n.R, .Rmd, .qmd\nFile formats for scripting or reporting\n\n\n\n?mean # Opens the help page for the ‚Äòmean‚Äô function\nargs(mean) # Lists input arguments for ‚Äòmean‚Äô\n\n\n\nIn this section, I highlight essential RStudio shortcut keys that improve coding efficiency and simplify the workflow for scripting and reporting.\n\n\n\nShortcut\nAction\n\n\n\n\nCtrl + Z\nUndo the last action\n\n\nCtrl + Shift + Z\nRedo the undone action\n\n\nCtrl + Enter\nExecute the current line or selected block\n\n\nAlt + -\nInsert assignment operator &lt;-\n\n\nCtrl + Shift + M\nInsert pipe operator %&gt;%\n\n\nCtrl + L\nClear the console output\n\n\nCtrl + Shift + C\nComment or uncomment selected lines\n\n\nCtrl + Shift + S\nSource and run the entire script\n\n\nCtrl + Alt + I\nInsert a new R Markdown or Quarto code chunk\n\n\n\n\n\n\n\nElement | Vector | Matrix | |Data Frame | Data Table | List | Factor | Variable | Object\nThis section provides a brief overview of foundational R data structures.\nFor more detailed explanations and demonstrations, refer to:\n\nYouTube: AnalyticsHub\nGitHub: HabtamuBizuayehu Repositories\n\nUnderstanding these fundamental terms is essential for working effectively with R data analysis and wrangling.\nüîπ Brief Narration of Key Terms\n\nElement: A single piece of data, such as a number or a character.\nVector: An ordered collection of elements of the same type (numeric, character, logical).\nMatrix: A two-dimensional collection of elements arranged by rows and columns, all of the same type.\nData Frame: A two-dimensional table where each column can contain different types of data (numeric, character, factor).\nData Table: A high-performance extension from the data.table package ‚Äî for very large datasets and faster manipulation.\nList: A flexible container that can hold elements of different types and structures (vectors, data frames, even other lists).\nFactor: A special type of vector used for categorical data, storing levels internally.\nVariable: A named object that holds data (vectors, lists, data frames, etc.).\nObject: A general term for any data structure stored in R.\n\n\nüîç Summary Table: R Objects\n\n\n\n\n\n\n\nTerm\nDefinition\n\n\n\n\nElement\nA single unit of data (e.g., 5, \"apple\")\n\n\nVector\nA sequence of elements of the same type\n\n\nMatrix\nA two-dimensional collection of homogeneous elements\n\n\nData Frame\nA two-dimensional table with heterogeneous column types\n\n\nData Table\nA fast and memory-efficient data frame extension (data.table package)\n\n\nList\nA flexible container for different types of elements\n\n\nFactor\nA categorical variable with predefined levels\n\n\nVariable\nA named object that stores data\n\n\nObject\nAny entity stored in R (data, functions, models, etc.)\n\n\n\n\n\n\nThis section summarizes key chunk options and syntax used in Quarto and R Markdown.\nThese settings allow flexible control over code execution, output display, figure formatting, and reporting behavior."
  },
  {
    "objectID": "Post_Blog/Data_Manipulation_and_Wrangling/index.html#summary-quarto-and-r-markdown-chunk-options",
    "href": "Post_Blog/Data_Manipulation_and_Wrangling/index.html#summary-quarto-and-r-markdown-chunk-options",
    "title": "Date Manipulation and Wrangling using R",
    "section": "",
    "text": "Feature\nQuarto Syntax\nDescription\n\n\n\n\nCode Chunks\n{r}\nUsed to write and execute R code. You can specify options like echo, results.\n\n\nEchoing Code\necho: true\nDisplays the code in the output (default is true). Set to false to hide the code.\n\n\nInclude Code\ninclude: false\nExecutes code but does not show the code in the final output.\n\n\nEvaluating Code\neval: false\nPrevents the code from running but still displays the code in the output.\n\n\nResults Control\nresults: 'markup' or results: 'asis'\nControls how output results are displayed (formatted or raw).\n\n\nMessage and Warnings\nmessage: false, warning: false\nControls whether messages and warnings appear in the output.\n\n\nOutput File Format\noutput: html\nSpecifies output format (html, pdf, word). Default is html.\n\n\nTable Output\nresults: 'asis' or results: 'markup'\nEnsures clean table rendering for formatted output.\n\n\nChunk Labeling\n# Label\nLabels help organize and reference code chunks easily.\n\n\nInline Code\nYour value is 2 times.\nEmbeds live code inside text for dynamic reporting.\n\n\nCaching Results\ncache: true\nSaves chunk results to avoid rerunning unchanged code. It stores the output (like objects, plots, and printed results) in a cache directory\n\n\nFigure Options\nfig.width: 7, fig.height: 5, fig.align: 'center'\nAdjusts figure size and alignment in output documents.\n\n\nOutput as LaTeX\nlatex: true\nAllows LaTeX formatting (mainly for PDFs and math expressions).\n\n\nCommenting Code\n# (within chunks)\nStandard way to comment within R code chunks.\n\n\n\n‚û°Ô∏è Mastering these options ensures smoother report generation, cleaner outputs, and faster rendering when building professional documents in Quarto or R Markdown."
  },
  {
    "objectID": "Post_Blog/Data_Manipulation_and_Wrangling/index.html#part-ii-data-loading-and-exploration",
    "href": "Post_Blog/Data_Manipulation_and_Wrangling/index.html#part-ii-data-loading-and-exploration",
    "title": "Date Manipulation and Wrangling using R",
    "section": "",
    "text": "File path setup and working with getwd(), paste()\nread_csv(), read_excel(), read.delim(), readRDS()\nReading .tsv, .dta, and .sav files (foreign and haven packages)\nReading from ZIP Files\n\nBefore we begin analyzing data in R, we need to bring it in from where it‚Äôs stored‚Äîyour computer, the cloud, or an online source.\nThere are many formats we commonly work with in public health and analytics: CSV, Excel, text files, RDS, SPSS, and others.\nBelow is a summary table of functions used to read each data type.\nüìä Reading Common Data Types in R\n\n\n\n\n\n\n\n\n\nData Type\nFunction\nPackage\nExample\n\n\n\n\nCSV\nread_csv(), read.csv()\nreadr / base\nread_csv(\"file.csv\")\n\n\nExcel (.xls/.xlsx)\nread_excel()\nreadxl\nread_excel(\"file.xlsx\")\n\n\nTab-separated (.tsv)\nread_tsv()\nreadr\nread_tsv(\"file.tsv\")\n\n\nText (.txt)\nread.delim()\nbase\nread.delim(\"file.txt\")\n\n\nStata (.dta)\nread_dta()\nhaven\nread_dta(\"file.dta\")\n\n\nSPSS (.sav)\nread_sav()\nhaven\nread_sav(\"file.sav\")\n\n\nRDS (R object)\nreadRDS()\nbase\nreadRDS(\"object.rds\")\n\n\nZIP archives\nunzip()\nutils (base)\nunzip(\"data.zip\", exdir = \"folder\")\n\n\nOnline Excel/CSV\ndownload.file() + reader\nbase + readxl\nDownload file, then read_excel(temp_file)\n\n\n\nBefore reading files, I usually set the working directory to the folder where my files are saved. This avoids typing full file paths every time.\nTo combine folder names and filenames dynamically: paste(getwd(), ‚Äúmy_data.csv‚Äù, sep = ‚Äú/‚Äù)\nReading Local Files\nOnce you‚Äôre in the right working directory, you can read in your files like below:\n\n# setwd(\"C:/Users/User/Desktop/Materials_ Course and proposals/Course Related/DataCamp/Data/Synthetic_data\")\n\npatients &lt;- read.csv(\"C:/Users/User/Desktop/Materials_ Course and proposals/Course Related/DataCamp/Data/Synthetic_data/patients.csv\")\nvaccination &lt;- read.csv(\"C:/Users/User/Desktop/Materials_ Course and proposals/Course Related/DataCamp/Data/Synthetic_data/immunizations.csv\")\n\n# medications &lt;- read.csv (paste(getwd(), \"medications.csv\", sep = \"/\"))\n\nmedications &lt;- read.csv(\"C:/Users/User/Desktop/Materials_ Course and proposals/Course Related/DataCamp/Data/Synthetic_data/medications.csv\")\n\nThese are standard CSVs and can be read using read.csv() from base R, or read_csv() from the readr package for cleaner output.\nReading from ZIP Files\nSometimes, especially when downloading from government databases or health systems, data is compressed into .zip files. In R, we can easily unzip these files and extract their contents.\nSet working directory to the folder where the zip file is located\n\n# --- Define base folder manually (safe way without setwd)\nbase_folder &lt;- \"C:/Users/User/Desktop/Materials_ Course and proposals/Course Related/DataCamp/Data/Synthetic_data\"\n\n# --- Extract ZIP file into 'procedures' folder inside base\nunzip(file.path(base_folder, \"procedures.zip\"), exdir = file.path(base_folder, \"procedures\"))\n\n# --- List extracted files\nlist.files(file.path(base_folder, \"procedures\"))\n\n[1] \"procedures\"     \"procedures.csv\"\n\n# --- Read extracted CSV\nprocedures &lt;- read.csv(file.path(base_folder, \"procedures\", \"procedures.csv\"))\n\nReading Online Files\nIf the file is online, we first download it, save it to a temporary file, and then read it:\nIt is useful when working with shared datasets, APIs, or GitHub repos.\n\n# Upload Online data\n\nurl &lt;- \"https://raw.githubusercontent.com/HabtamuBizuayehu/Data-sources/main/Breast_cancer_screening.xls\"\ntemp_file &lt;- tempfile(fileext = \".xls\")\ndownload.file(url, temp_file, mode = \"wb\")\n\nbreast_cancer_data &lt;- read_excel(temp_file)\n\n2.2 Exploring Data\n\nstr(), summary(), glimpse(), head(), tail(), count()\nViewing data: view(), nrow(), ncol()\nCleaning variable names: janitor::clean_names()\nCreating a data dictionary\nWorking with column names and types\n\nOnce we load data into R, it‚Äôs important to explore it properly before doing any analysis.\nThis step helps us understand:\n\nWhat variables we have\nHow the data is structured\nIf there are any issues (like missing values, wrong data types, weird names)\n\nIn this part, we‚Äôll look at some essential functions we often use at the very beginning of a project.\nüîç Key Tools for Exploring Data (with Important Details and Tips)\n1. str(), summary(), glimpse(), head(), tail(), count()\n\nstr(df) shows the structure of the entire dataset: number of observations (rows), number of variables (columns), and data types.\nstr(df$var) shows the structure of a specific variable (single column), useful to quickly check type and contents.\nsummary(df) gives basic descriptive statistics for all variables at once.\nsummary(df$var) gives a summary for one specific variable.\nglimpse(df) (from dplyr) provides a compact sideways overview showing each variable name, type, and preview of values.\nhead(df) shows the first 6 rows of the dataset by default.\nhead(df, n = 10) shows the first 10 rows (you can customize the number with n =).\ntail(df) shows the last 6 rows of the dataset.\ntail(df, n = 8) shows the last 8 rows.\ncount(df, var) (from dplyr) counts occurrences of each unique value in a variable.\n\n‚û°Ô∏è Using str(df$var) and summary(df$var) is a fast way to inspect just one column without needing the whole dataset.\n\n2. Viewing Data\n\nview(df) opens an Excel-like data viewer window inside RStudio for easy manual exploration.\nnrow(df) returns the number of rows.\nncol(df) returns the number of columns.\ndim(df) returns a two-number vector: (rows, columns).\n\n‚û°Ô∏è Use view(df) when you want to sort/filter manually without coding.\n\n3. Cleaning Variable Names\n\njanitor::clean_names(df) standardizes messy variable names:\n\nMakes all names lowercase\nReplaces spaces and special characters with underscores\nRemoves parentheses, punctuation, etc.\n\n\n‚û°Ô∏è Run clean_names() immediately after loading raw survey, registry, or administrative datasets.\nExample:\n\nnames(patients)\n\n [1] \"Id\"                  \"BIRTHDATE\"           \"DEATHDATE\"          \n [4] \"SSN\"                 \"DRIVERS\"             \"PASSPORT\"           \n [7] \"PREFIX\"              \"FIRST\"               \"MIDDLE\"             \n[10] \"LAST\"                \"SUFFIX\"              \"MAIDEN\"             \n[13] \"MARITAL\"             \"RACE\"                \"ETHNICITY\"          \n[16] \"GENDER\"              \"BIRTHPLACE\"          \"ADDRESS\"            \n[19] \"CITY\"                \"STATE\"               \"COUNTY\"             \n[22] \"FIPS\"                \"ZIP\"                 \"LAT\"                \n[25] \"LON\"                 \"HEALTHCARE_EXPENSES\" \"HEALTHCARE_COVERAGE\"\n[28] \"INCOME\"             \n\ntemp &lt;- janitor::clean_names(patients)\ncolnames(temp)\n\n [1] \"id\"                  \"birthdate\"           \"deathdate\"          \n [4] \"ssn\"                 \"drivers\"             \"passport\"           \n [7] \"prefix\"              \"first\"               \"middle\"             \n[10] \"last\"                \"suffix\"              \"maiden\"             \n[13] \"marital\"             \"race\"                \"ethnicity\"          \n[16] \"gender\"              \"birthplace\"          \"address\"            \n[19] \"city\"                \"state\"               \"county\"             \n[22] \"fips\"                \"zip\"                 \"lat\"                \n[25] \"lon\"                 \"healthcare_expenses\" \"healthcare_coverage\"\n[28] \"income\"             \n\nrm(temp)\n\nüîç Listing All Data Frames and Variables\nTo organize and review datasets loaded in the environment, the following workflow lists all data frames and their variables:\n\nrm (breast_cancer_data, patients)\n\n# 1. List all data frames in the environment\ndfs &lt;- ls(envir = .GlobalEnv)[sapply(ls(envir = .GlobalEnv), function(x) is.data.frame(get(x)))]\n\n# 2. For each data frame, list its variable (column) names\ndf_variables &lt;- lapply(dfs, function(df_name) {\n  vars &lt;- names(get(df_name))\n  data.frame(\n    DataFrame = df_name,\n    Variable = vars,\n    stringsAsFactors = FALSE\n  )\n})\n\n# 3. Combine into one clean table\ndf_variables_all &lt;- do.call(rbind, df_variables)\n\n# View the result\nprint(df_variables_all)\n\n     DataFrame          Variable\n1  medications             START\n2  medications              STOP\n3  medications           PATIENT\n4  medications             PAYER\n5  medications         ENCOUNTER\n6  medications              CODE\n7  medications       DESCRIPTION\n8  medications         BASE_COST\n9  medications    PAYER_COVERAGE\n10 medications         DISPENSES\n11 medications         TOTALCOST\n12 medications        REASONCODE\n13 medications REASONDESCRIPTION\n14  procedures             START\n15  procedures              STOP\n16  procedures           PATIENT\n17  procedures         ENCOUNTER\n18  procedures            SYSTEM\n19  procedures              CODE\n20  procedures       DESCRIPTION\n21  procedures         BASE_COST\n22  procedures        REASONCODE\n23  procedures REASONDESCRIPTION\n24 vaccination              DATE\n25 vaccination           PATIENT\n26 vaccination         ENCOUNTER\n27 vaccination              CODE\n28 vaccination       DESCRIPTION\n29 vaccination         BASE_COST\n\nrm (df_variables_all, df_variables) # clean working enviroment \n\n4. Creating a Data Dictionary\nA data dictionary is a simple but critical table that documents:\n\nVariable names (column names)\nDescriptions (what each variable represents)\nTypes (numeric, character, factor)\n\n‚û°Ô∏è We can automate building a basic data dictionary by combining names(), sapply(), and class() functions.\n\ndata_dictionary &lt;- data.frame(\n  Variable = names(patients),\n  Type = sapply(patients, class)\n)\n\nThe dictionary can be expanded by manually adding descriptions, coding instructions, or value mappings where necessary.\n5. Working with Column Names and Types\n\nnames(df) or colnames(df) retrieves a list of all column names.\nclass(df$var) reveals the data type of a specific variable.\nsapply(df, class) applies class() across all variables and summarizes their types.\nIf needed, variables can be recast to appropriate types.\n\nüìä Summary Table: Key Functions for Exploring Data\n\n\n\n\n\n\n\n\nTask\nFunction\nPurpose / What It Does\n\n\n\n\nView structure of dataset\nstr(df)\nShows structure: number of rows, columns, and variable types\n\n\nView structure of variable\nstr(df$var)\nShows structure/type of a specific variable\n\n\nSummarize statistics (dataset)\nsummary(df)\nProvides summary stats (min, max, mean, NA count) for all variables\n\n\nSummarize statistics (variable)\nsummary(df$var)\nSummary stats for a specific variable\n\n\nCompact structure overview\nglimpse(df)\nQuick, sideways compact view of dataset (from dplyr)\n\n\nPreview first rows\nhead(df), head(df, n = 10)\nDisplays first 6 or specified number of rows\n\n\nPreview last rows\ntail(df), tail(df, n = 8)\nDisplays last 6 or specified number of rows\n\n\nCount frequencies\ncount(df, var)\nCounts unique values and frequency of a specified variable\n\n\nOpen full viewer\nview(df)\nOpens Excel-style data viewer window (RStudio)\n\n\nCheck number of rows\nnrow(df)\nReturns number of rows (observations)\n\n\nCheck number of columns\nncol(df)\nReturns number of columns (variables)\n\n\nCheck both dimensions\ndim(df)\nReturns (rows, columns) as a two-number vector\n\n\nClean column names\njanitor::clean_names(df)\nConverts messy names into lowercase, underscore-separated names\n\n\nList variable names\nnames(df), colnames(df)\nLists all column names in a data frame\n\n\nCheck variable type\nclass(df$var)\nReturns data type of a specific variable\n\n\nCheck types for all variables\nsapply(df, class)\nReturns data types for every column in the dataset\n\n\nCreate basic data dictionary\ndata.frame(Variable = names(df), Type = sapply(df, class))\nTable summarizing variable names and types\n\n\nList all data frames in environment\ndfs &lt;- ls(...)[sapply(...)]\nIdentifies and lists all data frames currently loaded\n\n\nList all variables from all data frames\nlapply(dfs, function(x) names(get(x)))\nCreates table listing data frames and their variables\n\n\n\nNow I can apply some of the above to my datasets (df): such as breast_cancer_data, vaccination, patients\n\nbreast_cancer_data_demo &lt;- breast_cancer_data %&gt;%\n  select(sa3name, state, year, part50_74, rate50_74)\n\n# Structure of the demo dataset\nstr(breast_cancer_data_demo)\n\n'data.frame':   1364 obs. of  5 variables:\n $ sa3name  : chr  \"Queanbeyan\" \"Queanbeyan\" \"Queanbeyan\" \"Queanbeyan\" ...\n $ state    : chr  \"NSW\" \"NSW\" \"NSW\" \"NSW\" ...\n $ year     : int  201617 201718 201819 201920 201617 201718 201819 201920 201617 201718 ...\n $ part50_74: num  4875 5048 5276 5179 1850 ...\n $ rate50_74: num  60.5 60.8 61.4 58.2 59.7 ...\n\n# Summary statistics for rate50_74\nsummary(breast_cancer_data_demo$rate50_74)\n\n   Min. 1st Qu.  Median    Mean 3rd Qu.    Max.    NA's \n   5.40   50.07   54.50   53.63   57.88   80.20     135 \n\n# Display first 10 rows\nhead(breast_cancer_data_demo, 10)\n\n           sa3name state   year part50_74 rate50_74\n1       Queanbeyan   NSW 201617      4875  60.50000\n2       Queanbeyan   NSW 201718      5048  60.75961\n3       Queanbeyan   NSW 201819      5276  61.43839\n4       Queanbeyan   NSW 201920      5179  58.16834\n5  Snowy Mountains   NSW 201617      1850  59.70000\n6  Snowy Mountains   NSW 201718      1910  61.54862\n7  Snowy Mountains   NSW 201819      2039  65.12912\n8  Snowy Mountains   NSW 201920      1979  62.23419\n9      South Coast   NSW 201617      9469  62.80000\n10     South Coast   NSW 201718      9565  62.94230\n\n# Count number of records\ncount(breast_cancer_data_demo)\n\n     n\n1 1364\n\n# Show variable names\nnames(breast_cancer_data_demo)\n\n[1] \"sa3name\"   \"state\"     \"year\"      \"part50_74\" \"rate50_74\""
  },
  {
    "objectID": "Post_Blog/Data_Manipulation_and_Wrangling/index.html#part-iii-wrangling-with-dplyr",
    "href": "Post_Blog/Data_Manipulation_and_Wrangling/index.html#part-iii-wrangling-with-dplyr",
    "title": "Date Manipulation and Wrangling using R",
    "section": "",
    "text": "In this part, we focus on mastering core data wrangling skills using the dplyr package, one of the most powerful tools in R for data manipulation.\nWe will learn how to select, rename, create, modify, group, sort, slice, and reshape datasets.\nThese operations form the foundation for preparing clean, organized, and analysis-ready data.\nEach subsection introduces a set of essential verbs (select(), mutate(), group_by(), etc.) that allow for data transformation pipelines. Examples and practical applications will be provided throughout to demonstrate how to use dplyr.\n\n\n\n\nselect(), rename(), relocate()`\nColumn helpers: starts_with(), ends_with(), contains(), last_clos, matches\nAllow modifying entire groups of column names by adding prefixes or suffixes\nHandling null/missing column names\n\nSelecting, reordering, and renaming variables is often the first step when preparing a dataset for analysis.\nIn dplyr, we use functions such as select(), rename(), and relocate() to organize variables, clean up data, and prepare for transformations.\nDropping unnecessary columns or reordering variables can make the data cleaner, faster to work with, and easier to understand.\nAdditional tools allow modifying groups of column names by adding prefixes or suffixes, and safely handling missing columns during selection.\n\nüîπ Summary of Functions for Selecting, Reordering, Dropping, and Renaming\n\n\n\n\n\n\n\n\nTask\nFunction\nPurpose\n\n\n\n\nSelect specific columns\nselect()\nChoose a subset of columns based on name or condition\n\n\nRename columns\nrename()\nRename one or multiple columns\n\n\nRelocate columns\nrelocate()\nMove selected columns to a new position\n\n\nReorder manually\nselect(a, b, c, everything())\nExplicitly define column order\n\n\nFind columns by pattern\nstarts_with(), ends_with(), contains(), matches()\nSelect columns matching a pattern\n\n\nDrop single column\nselect(-col1)\nRemove one variable\n\n\nDrop multiple columns\nselect(-col1, -col2)\nRemove several variables\n\n\nDrop by pattern\nselect(-starts_with(\"temp\")), select(-contains(\"score\"))\nRemove variables based on naming patterns\n\n\nAdd prefix to column names\nrename_with(~ paste0(\"prefix_\", .x))\nAdd a prefix to selected columns\n\n\nAdd suffix to column names\nrename_with(~ paste0(.x, \"_suffix\"))\nAdd a suffix to selected columns\n\n\nHandle missing columns safely\nif(\"var\" %in% names(df)) {}\nAvoid errors when column does not exist\n\n\n\n\n‚û°Ô∏è These techniques allow quick restructuring of datasets, improving workflow efficiency and clarity.\n\nüîπ Examples Using the vaccination Dataset\n\n# Selecting specific columns manually\nbreast_selected &lt;- breast_cancer_data %&gt;%\n  select(sa3code, sa3name, year, part50_74, pop50_74)\n\nhead(breast_selected, n = 3)\n\n  sa3code    sa3name   year part50_74 pop50_74\n1   10102 Queanbeyan 201617      4875     8052\n2   10102 Queanbeyan 201718      5048     8309\n3   10102 Queanbeyan 201819      5276     8588\n\n# Reordering columns manually (bring year, sa3name, state first)\nbc_reorder_manual &lt;- breast_cancer_data %&gt;%\n  select(year, sa3name, state, everything())\n\nhead(bc_reorder_manual, n = 3)\n\n    year    sa3name state sa3code sa3coden part50_74 pop50_74 rate50_74\n1 201617 Queanbeyan   NSW   10102    10102      4875     8052  60.50000\n2 201718 Queanbeyan   NSW   10102    10102      5048     8309  60.75961\n3 201819 Queanbeyan   NSW   10102    10102      5276     8588  61.43839\n  agen50_74 expct50_74 part50_69 pop50_69 rate50_69 agen50_69 expct50_69\n1         3       4428      4309     7145  60.30000         2       3929\n2         3       4553      4448     7338  60.62238         2       4013\n3         3       4706      4629     7548  61.33203         2       4113\n  part50_54 pop50_54 rate50_54 agen50_54 expct50_54 part55_59 pop55_59\n1      1284     2251  57.00000         1       1118      1188     1970\n2      1285     2306  55.72035         1       1143      1260     2030\n3      1375     2342  58.70977         1       1166      1252     2093\n  rate55_59 agen55_59 expct55_59 part60_64 pop60_64 rate60_64 agen60_64\n1  60.30000         4       1046      1012     1625  62.30000         5\n2  62.09035         4       1069      1048     1646  63.69947         5\n3  59.81504         4       1098      1105     1689  65.43657         5\n  expct60_64 part65_69 pop65_69 rate65_69 agen65_69 expct65_69 part70_74\n1        950       826     1300  63.50000         6        781       566\n2        953       855     1357  63.02558         6        812       600\n3        967       898     1426  63.00429         6        849       647\n  pop70_74 rate70_74 agen70_74 expct70_74\n1      907  62.40000         7        498\n2      971  61.79725         7        541\n3     1040  62.21032         7        585\n\n# Relocating specific columns before another variable\nbc_relocate_before &lt;- breast_cancer_data %&gt;%\n  relocate(part50_74, pop50_74, .before = rate50_74)\n\nhead(bc_relocate_before, n = 3)\n\n  sa3code sa3coden    sa3name state   year part50_74 pop50_74 rate50_74\n1   10102    10102 Queanbeyan   NSW 201617      4875     8052  60.50000\n2   10102    10102 Queanbeyan   NSW 201718      5048     8309  60.75961\n3   10102    10102 Queanbeyan   NSW 201819      5276     8588  61.43839\n  agen50_74 expct50_74 part50_69 pop50_69 rate50_69 agen50_69 expct50_69\n1         3       4428      4309     7145  60.30000         2       3929\n2         3       4553      4448     7338  60.62238         2       4013\n3         3       4706      4629     7548  61.33203         2       4113\n  part50_54 pop50_54 rate50_54 agen50_54 expct50_54 part55_59 pop55_59\n1      1284     2251  57.00000         1       1118      1188     1970\n2      1285     2306  55.72035         1       1143      1260     2030\n3      1375     2342  58.70977         1       1166      1252     2093\n  rate55_59 agen55_59 expct55_59 part60_64 pop60_64 rate60_64 agen60_64\n1  60.30000         4       1046      1012     1625  62.30000         5\n2  62.09035         4       1069      1048     1646  63.69947         5\n3  59.81504         4       1098      1105     1689  65.43657         5\n  expct60_64 part65_69 pop65_69 rate65_69 agen65_69 expct65_69 part70_74\n1        950       826     1300  63.50000         6        781       566\n2        953       855     1357  63.02558         6        812       600\n3        967       898     1426  63.00429         6        849       647\n  pop70_74 rate70_74 agen70_74 expct70_74\n1      907  62.40000         7        498\n2      971  61.79725         7        541\n3     1040  62.21032         7        585\n\n# Relocating specific columns after another variable\nbc_relocate_after &lt;- breast_cancer_data %&gt;%\n  relocate(sa3name, state, .after = year)\n\nhead(bc_relocate_after, n = 3)\n\n  sa3code sa3coden   year    sa3name state part50_74 pop50_74 rate50_74\n1   10102    10102 201617 Queanbeyan   NSW      4875     8052  60.50000\n2   10102    10102 201718 Queanbeyan   NSW      5048     8309  60.75961\n3   10102    10102 201819 Queanbeyan   NSW      5276     8588  61.43839\n  agen50_74 expct50_74 part50_69 pop50_69 rate50_69 agen50_69 expct50_69\n1         3       4428      4309     7145  60.30000         2       3929\n2         3       4553      4448     7338  60.62238         2       4013\n3         3       4706      4629     7548  61.33203         2       4113\n  part50_54 pop50_54 rate50_54 agen50_54 expct50_54 part55_59 pop55_59\n1      1284     2251  57.00000         1       1118      1188     1970\n2      1285     2306  55.72035         1       1143      1260     2030\n3      1375     2342  58.70977         1       1166      1252     2093\n  rate55_59 agen55_59 expct55_59 part60_64 pop60_64 rate60_64 agen60_64\n1  60.30000         4       1046      1012     1625  62.30000         5\n2  62.09035         4       1069      1048     1646  63.69947         5\n3  59.81504         4       1098      1105     1689  65.43657         5\n  expct60_64 part65_69 pop65_69 rate65_69 agen65_69 expct65_69 part70_74\n1        950       826     1300  63.50000         6        781       566\n2        953       855     1357  63.02558         6        812       600\n3        967       898     1426  63.00429         6        849       647\n  pop70_74 rate70_74 agen70_74 expct70_74\n1      907  62.40000         7        498\n2      971  61.79725         7        541\n3     1040  62.21032         7        585\n\n# Dropping one variable\nbc_drop_one &lt;- breast_cancer_data %&gt;%\n  select(-expct50_74)\n\nhead(bc_drop_one, n = 3)\n\n  sa3code sa3coden    sa3name state   year part50_74 pop50_74 rate50_74\n1   10102    10102 Queanbeyan   NSW 201617      4875     8052  60.50000\n2   10102    10102 Queanbeyan   NSW 201718      5048     8309  60.75961\n3   10102    10102 Queanbeyan   NSW 201819      5276     8588  61.43839\n  agen50_74 part50_69 pop50_69 rate50_69 agen50_69 expct50_69 part50_54\n1         3      4309     7145  60.30000         2       3929      1284\n2         3      4448     7338  60.62238         2       4013      1285\n3         3      4629     7548  61.33203         2       4113      1375\n  pop50_54 rate50_54 agen50_54 expct50_54 part55_59 pop55_59 rate55_59\n1     2251  57.00000         1       1118      1188     1970  60.30000\n2     2306  55.72035         1       1143      1260     2030  62.09035\n3     2342  58.70977         1       1166      1252     2093  59.81504\n  agen55_59 expct55_59 part60_64 pop60_64 rate60_64 agen60_64 expct60_64\n1         4       1046      1012     1625  62.30000         5        950\n2         4       1069      1048     1646  63.69947         5        953\n3         4       1098      1105     1689  65.43657         5        967\n  part65_69 pop65_69 rate65_69 agen65_69 expct65_69 part70_74 pop70_74\n1       826     1300  63.50000         6        781       566      907\n2       855     1357  63.02558         6        812       600      971\n3       898     1426  63.00429         6        849       647     1040\n  rate70_74 agen70_74 expct70_74\n1  62.40000         7        498\n2  61.79725         7        541\n3  62.21032         7        585\n\n# Dropping multiple variables\nbc_drop_multiple &lt;- breast_cancer_data %&gt;%\n  select(-expct50_74, -expct50_69)\n\nhead(bc_drop_multiple, n = 3)\n\n  sa3code sa3coden    sa3name state   year part50_74 pop50_74 rate50_74\n1   10102    10102 Queanbeyan   NSW 201617      4875     8052  60.50000\n2   10102    10102 Queanbeyan   NSW 201718      5048     8309  60.75961\n3   10102    10102 Queanbeyan   NSW 201819      5276     8588  61.43839\n  agen50_74 part50_69 pop50_69 rate50_69 agen50_69 part50_54 pop50_54 rate50_54\n1         3      4309     7145  60.30000         2      1284     2251  57.00000\n2         3      4448     7338  60.62238         2      1285     2306  55.72035\n3         3      4629     7548  61.33203         2      1375     2342  58.70977\n  agen50_54 expct50_54 part55_59 pop55_59 rate55_59 agen55_59 expct55_59\n1         1       1118      1188     1970  60.30000         4       1046\n2         1       1143      1260     2030  62.09035         4       1069\n3         1       1166      1252     2093  59.81504         4       1098\n  part60_64 pop60_64 rate60_64 agen60_64 expct60_64 part65_69 pop65_69\n1      1012     1625  62.30000         5        950       826     1300\n2      1048     1646  63.69947         5        953       855     1357\n3      1105     1689  65.43657         5        967       898     1426\n  rate65_69 agen65_69 expct65_69 part70_74 pop70_74 rate70_74 agen70_74\n1  63.50000         6        781       566      907  62.40000         7\n2  63.02558         6        812       600      971  61.79725         7\n3  63.00429         6        849       647     1040  62.21032         7\n  expct70_74\n1        498\n2        541\n3        585\n\n# Dropping variables by pattern (e.g., columns ending with \"_69\")\nbc_drop_by_pattern &lt;- breast_cancer_data %&gt;%\n  select(-ends_with(\"_69\"))\n\nhead(bc_drop_by_pattern, n = 3)\n\n  sa3code sa3coden    sa3name state   year part50_74 pop50_74 rate50_74\n1   10102    10102 Queanbeyan   NSW 201617      4875     8052  60.50000\n2   10102    10102 Queanbeyan   NSW 201718      5048     8309  60.75961\n3   10102    10102 Queanbeyan   NSW 201819      5276     8588  61.43839\n  agen50_74 expct50_74 part50_54 pop50_54 rate50_54 agen50_54 expct50_54\n1         3       4428      1284     2251  57.00000         1       1118\n2         3       4553      1285     2306  55.72035         1       1143\n3         3       4706      1375     2342  58.70977         1       1166\n  part55_59 pop55_59 rate55_59 agen55_59 expct55_59 part60_64 pop60_64\n1      1188     1970  60.30000         4       1046      1012     1625\n2      1260     2030  62.09035         4       1069      1048     1646\n3      1252     2093  59.81504         4       1098      1105     1689\n  rate60_64 agen60_64 expct60_64 part70_74 pop70_74 rate70_74 agen70_74\n1  62.30000         5        950       566      907  62.40000         7\n2  63.69947         5        953       600      971  61.79725         7\n3  65.43657         5        967       647     1040  62.21032         7\n  expct70_74\n1        498\n2        541\n3        585\n\n# Renaming a column for clarity\nbreast_renamed &lt;- breast_selected %&gt;%\n  rename(SA3_Code = sa3code, SA3_Name = sa3name, Year = year)\n\nhead(breast_renamed, n = 3)\n\n  SA3_Code   SA3_Name   Year part50_74 pop50_74\n1    10102 Queanbeyan 201617      4875     8052\n2    10102 Queanbeyan 201718      5048     8309\n3    10102 Queanbeyan 201819      5276     8588\n\n# Adding a prefix to all column names\nbc_prefixed &lt;- breast_cancer_data %&gt;%\n  rename_with(~ paste0(\"bc_\", .x))\n\nhead(bc_prefixed, n = 3)\n\n  bc_sa3code bc_sa3coden bc_sa3name bc_state bc_year bc_part50_74 bc_pop50_74\n1      10102       10102 Queanbeyan      NSW  201617         4875        8052\n2      10102       10102 Queanbeyan      NSW  201718         5048        8309\n3      10102       10102 Queanbeyan      NSW  201819         5276        8588\n  bc_rate50_74 bc_agen50_74 bc_expct50_74 bc_part50_69 bc_pop50_69 bc_rate50_69\n1     60.50000            3          4428         4309        7145     60.30000\n2     60.75961            3          4553         4448        7338     60.62238\n3     61.43839            3          4706         4629        7548     61.33203\n  bc_agen50_69 bc_expct50_69 bc_part50_54 bc_pop50_54 bc_rate50_54 bc_agen50_54\n1            2          3929         1284        2251     57.00000            1\n2            2          4013         1285        2306     55.72035            1\n3            2          4113         1375        2342     58.70977            1\n  bc_expct50_54 bc_part55_59 bc_pop55_59 bc_rate55_59 bc_agen55_59\n1          1118         1188        1970     60.30000            4\n2          1143         1260        2030     62.09035            4\n3          1166         1252        2093     59.81504            4\n  bc_expct55_59 bc_part60_64 bc_pop60_64 bc_rate60_64 bc_agen60_64\n1          1046         1012        1625     62.30000            5\n2          1069         1048        1646     63.69947            5\n3          1098         1105        1689     65.43657            5\n  bc_expct60_64 bc_part65_69 bc_pop65_69 bc_rate65_69 bc_agen65_69\n1           950          826        1300     63.50000            6\n2           953          855        1357     63.02558            6\n3           967          898        1426     63.00429            6\n  bc_expct65_69 bc_part70_74 bc_pop70_74 bc_rate70_74 bc_agen70_74\n1           781          566         907     62.40000            7\n2           812          600         971     61.79725            7\n3           849          647        1040     62.21032            7\n  bc_expct70_74\n1           498\n2           541\n3           585\n\n# Adding a suffix to all column names\nbc_suffixed &lt;- breast_cancer_data %&gt;%\n  rename_with(~ paste0(.x, \"_info\"))\n\nhead(bc_suffixed, n = 3)\n\n  sa3code_info sa3coden_info sa3name_info state_info year_info part50_74_info\n1        10102         10102   Queanbeyan        NSW    201617           4875\n2        10102         10102   Queanbeyan        NSW    201718           5048\n3        10102         10102   Queanbeyan        NSW    201819           5276\n  pop50_74_info rate50_74_info agen50_74_info expct50_74_info part50_69_info\n1          8052       60.50000              3            4428           4309\n2          8309       60.75961              3            4553           4448\n3          8588       61.43839              3            4706           4629\n  pop50_69_info rate50_69_info agen50_69_info expct50_69_info part50_54_info\n1          7145       60.30000              2            3929           1284\n2          7338       60.62238              2            4013           1285\n3          7548       61.33203              2            4113           1375\n  pop50_54_info rate50_54_info agen50_54_info expct50_54_info part55_59_info\n1          2251       57.00000              1            1118           1188\n2          2306       55.72035              1            1143           1260\n3          2342       58.70977              1            1166           1252\n  pop55_59_info rate55_59_info agen55_59_info expct55_59_info part60_64_info\n1          1970       60.30000              4            1046           1012\n2          2030       62.09035              4            1069           1048\n3          2093       59.81504              4            1098           1105\n  pop60_64_info rate60_64_info agen60_64_info expct60_64_info part65_69_info\n1          1625       62.30000              5             950            826\n2          1646       63.69947              5             953            855\n3          1689       65.43657              5             967            898\n  pop65_69_info rate65_69_info agen65_69_info expct65_69_info part70_74_info\n1          1300       63.50000              6             781            566\n2          1357       63.02558              6             812            600\n3          1426       63.00429              6             849            647\n  pop70_74_info rate70_74_info agen70_74_info expct70_74_info\n1           907       62.40000              7             498\n2           971       61.79725              7             541\n3          1040       62.21032              7             585\n\n# Handling missing columns safely during selection\nif (\"non_existing_column\" %in% names(breast_cancer_data)) {\n  bc_safe_select &lt;- breast_cancer_data %&gt;%\n    select(non_existing_column)\n  head(bc_safe_select, n = 3)\n} else {\n  message(\"Column 'non_existing_column' not found in breast_cancer_data.\")\n}\n\nColumn 'non_existing_column' not found in breast_cancer_data.\n\n# ....................................................\n# Remove all temporary objects created in this chunk\n# ....................................................\nrm(breast_selected, breast_renamed, bc_drop_one, bc_drop_multiple, bc_drop_by_pattern,\n   bc_reorder_manual, bc_relocate_before, bc_relocate_after,\n   bc_prefixed, bc_suffixed)\n\n\n\n\n\nmutate(), transmute(), recoding, case_when(), if_else()\nstr_detect(), regex(), %in%\nCreating dummy/flag variables\nString manipulation: strsplit(), sub(), gsub(), tolower(), `janitor::clean_names()`\n\nCreating new variables or modifying existing ones is a key part of preparing data for analysis.\nIn dplyr, we use functions like mutate() and transmute() to add, transform, or recode variables.\nWe can also create conditional variables with case_when() or if_else(), and apply string operations such as splitting, replacing, or converting text.\nThese steps help structure the data more logically, highlight important features, or derive new indicators for analysis.\n\nüîπ Summary of Functions for Creating and Modifying Variables\n\n\n\n\n\n\n\n\nTask\nFunction\nPurpose\n\n\n\n\nCreate or modify variables\nmutate()\nAdd or transform variables, keeping all columns\n\n\nCreate new variables only\ntransmute()\nKeep only new variables created\n\n\nConditional variable creation\ncase_when()\nCreate new variables based on multiple conditions\n\n\nSimple conditional assignment\nif_else()\nAssign based on TRUE/FALSE logic\n\n\nSplit strings into parts\nstrsplit()\nSplit a string into components\n\n\nReplace text (first occurrence)\nsub()\nReplace first match of a pattern\n\n\nReplace text (all occurrences)\ngsub()\nReplace all matches of a pattern\n\n\nConvert text to lowercase\ntolower()\nStandardize text to lowercase\n\n\nDetect text patterns\nstr_detect()\nCheck if a pattern exists in text\n\n\nFlexible pattern matching\nregex()\nUse regular expressions for complex patterns\n\n\nMembership check\n%in%\nTest if a value is part of a group\n\n\n\n\n‚û°Ô∏è These functions allow transforming the dataset systematically to extract new features, categorize information, or clean fields.\n\n# Creating and Modifying Variables (patients dataset)\n\n# Creating a new age group variable\npatients_mutated &lt;- patients %&gt;%\n  mutate(age_group = if_else(BIRTHDATE &lt;= as.Date(\"1970-01-01\"), \"Below 70\", \"70+\")) %&gt;%\n  relocate(age_group, .after = BIRTHDATE) %&gt;%\n  select(-Id, -DEATHDATE, -SSN, -LAT, -LON, -SUFFIX, -ZIP)\n\nhead(patients_mutated, 10)\n\n    BIRTHDATE age_group   DRIVERS   PASSPORT PREFIX       FIRST       MIDDLE\n1  1994-02-06       70+ S99996852 X47758697X    Mr.   Joshua658      Alvin56\n2  1968-08-06  Below 70 S99993577 X28173268X    Mr.   Bennie663             \n3  2008-12-21       70+                               Hunter736  Mckinley734\n4  1994-01-27       70+ S99995100 X83694889X   Mrs.   Carlyn477 Florencia449\n5  2019-07-27       70+                                 Robin66    Jeramy610\n6  2019-04-18       70+                               Arthur650             \n7  2013-08-10       70+                                 Caryl47     Lelia627\n8  1968-08-06  Below 70 S99911538 X37637991X    Mr.  Willian804    Shelton25\n9  2006-07-02       70+ S99943171               Ms. Domenica436             \n10 1948-05-28  Below 70 S99941458 X59458953X    Mr.  Arnulfo253    Jordan900\n            LAST   MAIDEN MARITAL  RACE   ETHNICITY GENDER\n1       Kunde533                M white nonhispanic      M\n2       Ebert178                D white nonhispanic      M\n3     Gerlach374                  white nonhispanic      M\n4  Williamson769 Rogahn59       M asian nonhispanic      F\n5   Gleichner915                  white nonhispanic      M\n6     Roberts511                  white nonhispanic      M\n7    Kassulke119                  white nonhispanic      F\n8      Keeling57                M white nonhispanic      M\n9         Rau926                  white    hispanic      F\n10  Jaskolski867                D white nonhispanic      M\n                         BIRTHPLACE                     ADDRESS         CITY\n1         Boston  Massachusetts  US            811 Kihn Viaduct    Braintree\n2       Chicopee  Massachusetts  US 975 Pfannerstill Throughway    Braintree\n3        Spencer  Massachusetts  US             548 Heller Lane Mattapoisett\n4       Franklin  Massachusetts  US  160 Fadel Crossroad Apt 65      Wareham\n5       Brockton  Massachusetts  US      766 Grant Loaf Unit 15    Groveland\n6       Plymouth  Massachusetts  US            866 Kulas Harbor    Cambridge\n7  East Falmouth  Massachusetts  US            578 Dickens Camp    Arlington\n8        Methuen  Massachusetts  US      848 Ebert Knoll Unit 7    Braintree\n9        Maynard  Massachusetts  US             963 Senger Fort    Haverhill\n10        Boston  Massachusetts  US    757 Lockman Annex Apt 10   Georgetown\n           STATE           COUNTY  FIPS HEALTHCARE_EXPENSES HEALTHCARE_COVERAGE\n1  Massachusetts   Norfolk County 25021            56904.96            18019.99\n2  Massachusetts   Norfolk County 25021           124024.12             1075.06\n3  Massachusetts  Plymouth County    NA            45645.06             6154.94\n4  Massachusetts  Plymouth County    NA            12895.15           659951.61\n5  Massachusetts     Essex County    NA            18500.02             5493.57\n6  Massachusetts Middlesex County 25017            14478.23              693.39\n7  Massachusetts Middlesex County 25017             9821.14            27142.51\n8  Massachusetts   Norfolk County 25021           175817.63            55473.97\n9  Massachusetts     Essex County 25009            52933.16            11941.44\n10 Massachusetts     Essex County    NA           242013.44           322768.97\n   INCOME\n1  100511\n2   49737\n3  133816\n4   17382\n5   52159\n6   75767\n7   58294\n8   49737\n9   77756\n10  35255\n\n# extract month and year from date in form of date is YYYY-MM-DD HH:MM:SS\nstr (vaccination$DATE) # date is YYYY-MM-DD HH:MM:SS format.\n\n chr [1:1619] \"2016-04-10T09:04:48Z\" \"2016-04-10T09:04:48Z\" ...\n\nvaccination &lt;- vaccination %&gt;%\n  mutate(\n    vacc_date = as.Date(strptime(DATE, format = \"%Y-%m-%dT%H:%M:%SZ\")),  # First create vacc_date\n    year = format(vacc_date, \"%Y\"),         # Extract year\n    month = format(vacc_date, \"%B\")          # Extract full month name (January, February, etc.)\n  )\n\ncolnames(vaccination)\n\n[1] \"DATE\"        \"PATIENT\"     \"ENCOUNTER\"   \"CODE\"        \"DESCRIPTION\"\n[6] \"BASE_COST\"   \"vacc_date\"   \"year\"        \"month\"      \n\nhead(vaccination)\n\n                  DATE                              PATIENT\n1 2016-04-10T09:04:48Z 30a6452c-4297-a1ac-977a-6a23237c7b46\n2 2016-04-10T09:04:48Z 30a6452c-4297-a1ac-977a-6a23237c7b46\n3 2016-04-10T09:04:48Z 30a6452c-4297-a1ac-977a-6a23237c7b46\n4 2016-04-10T09:04:48Z 30a6452c-4297-a1ac-977a-6a23237c7b46\n5 2002-10-29T19:07:21Z 34a4dcc4-35fb-6ad5-ab98-be285c586a4f\n6 2005-11-01T19:07:21Z 34a4dcc4-35fb-6ad5-ab98-be285c586a4f\n                             ENCOUNTER CODE\n1 0b03e41b-06a6-66fa-b972-acc5a83b134a  140\n2 0b03e41b-06a6-66fa-b972-acc5a83b134a  113\n3 0b03e41b-06a6-66fa-b972-acc5a83b134a   43\n4 0b03e41b-06a6-66fa-b972-acc5a83b134a  114\n5 30ab48ec-35a7-7704-86e5-113ef6a90c03  140\n6 d00bda57-b134-0654-e152-831ef486da53  140\n                                                   DESCRIPTION BASE_COST\n1           Influenza  seasonal  injectable  preservative free       136\n2 Td (adult)  5 Lf tetanus toxoid  preservative free  adsorbed       136\n3                                                 Hep B  adult       136\n4                                          meningococcal MCV4P       136\n5           Influenza  seasonal  injectable  preservative free       136\n6           Influenza  seasonal  injectable  preservative free       136\n   vacc_date year    month\n1 2016-04-10 2016    April\n2 2016-04-10 2016    April\n3 2016-04-10 2016    April\n4 2016-04-10 2016    April\n5 2002-10-29 2002  October\n6 2005-11-01 2005 November\n\n# Creating a dataset keeping only new variables (transmute)\npatients_transmuted &lt;- patients %&gt;%\n  transmute(\n    full_name = paste(FIRST, LAST, sep = \" \"), \n    birth_year = format(as.Date(BIRTHDATE), \"%Y\")\n  )\n\nhead (patients_transmuted)\n\n                full_name birth_year\n1      Joshua658 Kunde533       1994\n2      Bennie663 Ebert178       1968\n3    Hunter736 Gerlach374       2008\n4 Carlyn477 Williamson769       1994\n5    Robin66 Gleichner915       2019\n6    Arthur650 Roberts511       2019\n\n# generate a birth_year_group variable based on birth_year values\n\npatients_transmuted &lt;- patients_transmuted %&gt;%\n  mutate(birth_year_group = case_when(\n    birth_year &lt; 1940 ~ \"Before 1940\",\n    birth_year &gt;= 1940 & birth_year &lt;= 1959 ~ \"1940‚Äì1959\",\n    birth_year &gt;= 1960 & birth_year &lt;= 1979 ~ \"1960‚Äì1979\",\n    birth_year &gt;= 1980 & birth_year &lt;= 1999 ~ \"1980‚Äì1999\",\n    birth_year &gt;= 2000 ~ \"2000 and later\",\n    TRUE ~ NA_character_\n  ))\n\nhead(patients_transmuted)\n\n                full_name birth_year birth_year_group\n1      Joshua658 Kunde533       1994        1980‚Äì1999\n2      Bennie663 Ebert178       1968        1960‚Äì1979\n3    Hunter736 Gerlach374       2008   2000 and later\n4 Carlyn477 Williamson769       1994        1980‚Äì1999\n5    Robin66 Gleichner915       2019   2000 and later\n6    Arthur650 Roberts511       2019   2000 and later\n\n# other option to achieve similar result for the above \n\npatients_transmuted &lt;- patients_transmuted %&gt;%\n  mutate(birth_year = as.numeric(birth_year),   # Convert to numeric\n         birth_year_group = cut(birth_year,     # Apply cut()\n                                breaks = c(0, 1939, 1959, 1979, 1999, Inf),\n                                labels = c(\"Before 1940\", \"1940‚Äì1959\", \"1960‚Äì1979\", \"1980‚Äì1999\", \"2000 and later\"),\n                                right = TRUE\n         ))\n\n\nhead(patients_transmuted)\n\n                full_name birth_year birth_year_group\n1      Joshua658 Kunde533       1994        1980‚Äì1999\n2      Bennie663 Ebert178       1968        1960‚Äì1979\n3    Hunter736 Gerlach374       2008   2000 and later\n4 Carlyn477 Williamson769       1994        1980‚Äì1999\n5    Robin66 Gleichner915       2019   2000 and later\n6    Arthur650 Roberts511       2019   2000 and later\n\n# Using case_when to assign marital status values\npatients_case_when &lt;- patients %&gt;%\n  mutate(marital_status_group = case_when(\n    MARITAL == \"M\" ~ \"Married\",\n    MARITAL == \"S\" ~ \"Single\",\n    MARITAL == \"D\" ~ \"Divorced\",\n    TRUE ~ \"Unknown\"\n  )) %&gt;% \n  select(MARITAL, marital_status_group, RACE)\n\nhead(patients_case_when, n = 10)\n\n   MARITAL marital_status_group  RACE\n1        M              Married white\n2        D             Divorced white\n3                       Unknown white\n4        M              Married asian\n5                       Unknown white\n6                       Unknown white\n7                       Unknown white\n8        M              Married white\n9                       Unknown white\n10       D             Divorced white\n\ntable(patients_case_when$marital_status, useNA = \"ifany\")  # Show missing values in the table\n\n\nDivorced  Married   Single  Unknown \n      15       33       12       46 \n\n# Recode marital status while leaving unknown values as missing\npatients_case_when &lt;- patients_case_when %&gt;%\n  mutate(marital_2group = case_when(\n    MARITAL == \"M\" ~ \"Partnered\",\n    MARITAL == \"D\" | MARITAL == \"S\" | MARITAL == \"W\" ~ \"Not partnered\",\n    TRUE ~ NA_character_  # Replaces unknown values with missing (NA)\n  )) \n\nhead(patients_case_when)\n\n  MARITAL marital_status_group  RACE marital_2group\n1       M              Married white      Partnered\n2       D             Divorced white  Not partnered\n3                      Unknown white           &lt;NA&gt;\n4       M              Married asian      Partnered\n5                      Unknown white           &lt;NA&gt;\n6                      Unknown white           &lt;NA&gt;\n\n# Recode race status while leaving unknown values as missing\npatients_case_when &lt;- patients_case_when %&gt;%\n  mutate(race_grouped = case_when(\n    RACE == 'white' ~ \"White\",\n    RACE == \"asian\" ~ \"Asian\",\n    RACE == \"native\" | RACE == \"other\" ~ \"Other\",\n    TRUE ~ NA_character_\n  )) %&gt;% \n  select(RACE, race_grouped)\n\nhead(patients_case_when, n=10)\n\n    RACE race_grouped\n1  white        White\n2  white        White\n3  white        White\n4  asian        Asian\n5  white        White\n6  white        White\n7  white        White\n8  white        White\n9  white        White\n10 white        White\n\n# Simple conditional assignment with if_else\npatients$PASSPORT[patients$PASSPORT == \"\"] &lt;- NA # formatting the variable to know missing values\nprint(sum(is.na(patients$PASSPORT))) #  31 missing value\n\n[1] 31\n\npatients_if_else &lt;- patients %&gt;%\n  mutate(has_passport = if_else(!is.na(PASSPORT), \"Yes\", \"No\")) %&gt;% \n  select(PASSPORT, has_passport)\n\nhead(patients_if_else, n = 10)\n\n     PASSPORT has_passport\n1  X47758697X          Yes\n2  X28173268X          Yes\n3        &lt;NA&gt;           No\n4  X83694889X          Yes\n5        &lt;NA&gt;           No\n6        &lt;NA&gt;           No\n7        &lt;NA&gt;           No\n8  X37637991X          Yes\n9        &lt;NA&gt;           No\n10 X59458953X          Yes\n\n# Replace the first occurrence (e.g., fix misspelled city name)\npatients_sub &lt;- patients %&gt;%\n  mutate(city_fixed = sub(\"Nwe York\", \"New York\", CITY)) %&gt;% \n  select(-Id, -DEATHDATE, -SSN, -LAT, -LON, -SUFFIX, -ZIP)\n\nhead(patients_sub, n = 3)\n\n   BIRTHDATE   DRIVERS   PASSPORT PREFIX     FIRST      MIDDLE       LAST\n1 1994-02-06 S99996852 X47758697X    Mr. Joshua658     Alvin56   Kunde533\n2 1968-08-06 S99993577 X28173268X    Mr. Bennie663               Ebert178\n3 2008-12-21                 &lt;NA&gt;        Hunter736 Mckinley734 Gerlach374\n  MAIDEN MARITAL  RACE   ETHNICITY GENDER                  BIRTHPLACE\n1              M white nonhispanic      M   Boston  Massachusetts  US\n2              D white nonhispanic      M Chicopee  Massachusetts  US\n3                white nonhispanic      M  Spencer  Massachusetts  US\n                      ADDRESS         CITY         STATE          COUNTY  FIPS\n1            811 Kihn Viaduct    Braintree Massachusetts  Norfolk County 25021\n2 975 Pfannerstill Throughway    Braintree Massachusetts  Norfolk County 25021\n3             548 Heller Lane Mattapoisett Massachusetts Plymouth County    NA\n  HEALTHCARE_EXPENSES HEALTHCARE_COVERAGE INCOME   city_fixed\n1            56904.96            18019.99 100511    Braintree\n2           124024.12             1075.06  49737    Braintree\n3            45645.06             6154.94 133816 Mattapoisett\n\n# Replace all occurrences (e.g., replace spaces with underscores)\npatients_gsub &lt;- patients %&gt;%\n  mutate(birthplace_clean = gsub(\" \", \"_\", BIRTHPLACE)) %&gt;% \n  select(BIRTHPLACE, birthplace_clean)\n\nhead(patients_gsub, n = 3)\n\n                   BIRTHPLACE            birthplace_clean\n1   Boston  Massachusetts  US   Boston__Massachusetts__US\n2 Chicopee  Massachusetts  US Chicopee__Massachusetts__US\n3  Spencer  Massachusetts  US  Spencer__Massachusetts__US\n\n# Convert last names to lowercase\ntemp &lt;- patients %&gt;% \n  select(-Id, -DEATHDATE, -SSN, -LAT, -LON, -SUFFIX, -ZIP)\n\npatients_tolower &lt;- temp \ncolnames(patients_tolower) &lt;- tolower(colnames(patients_tolower)) \n\nhead(patients_tolower, n = 3)\n\n   birthdate   drivers   passport prefix     first      middle       last\n1 1994-02-06 S99996852 X47758697X    Mr. Joshua658     Alvin56   Kunde533\n2 1968-08-06 S99993577 X28173268X    Mr. Bennie663               Ebert178\n3 2008-12-21                 &lt;NA&gt;        Hunter736 Mckinley734 Gerlach374\n  maiden marital  race   ethnicity gender                  birthplace\n1              M white nonhispanic      M   Boston  Massachusetts  US\n2              D white nonhispanic      M Chicopee  Massachusetts  US\n3                white nonhispanic      M  Spencer  Massachusetts  US\n                      address         city         state          county  fips\n1            811 Kihn Viaduct    Braintree Massachusetts  Norfolk County 25021\n2 975 Pfannerstill Throughway    Braintree Massachusetts  Norfolk County 25021\n3             548 Heller Lane Mattapoisett Massachusetts Plymouth County    NA\n  healthcare_expenses healthcare_coverage income\n1            56904.96            18019.99 100511\n2           124024.12             1075.06  49737\n3            45645.06             6154.94 133816\n\nrm(temp)\n\n#`janitor::clean_names(df)` standardizes variable names:\n\nnames(patients)\n\n [1] \"Id\"                  \"BIRTHDATE\"           \"DEATHDATE\"          \n [4] \"SSN\"                 \"DRIVERS\"             \"PASSPORT\"           \n [7] \"PREFIX\"              \"FIRST\"               \"MIDDLE\"             \n[10] \"LAST\"                \"SUFFIX\"              \"MAIDEN\"             \n[13] \"MARITAL\"             \"RACE\"                \"ETHNICITY\"          \n[16] \"GENDER\"              \"BIRTHPLACE\"          \"ADDRESS\"            \n[19] \"CITY\"                \"STATE\"               \"COUNTY\"             \n[22] \"FIPS\"                \"ZIP\"                 \"LAT\"                \n[25] \"LON\"                 \"HEALTHCARE_EXPENSES\" \"HEALTHCARE_COVERAGE\"\n[28] \"INCOME\"             \n\ntemp &lt;- janitor::clean_names(patients)\ncolnames(temp)\n\n [1] \"id\"                  \"birthdate\"           \"deathdate\"          \n [4] \"ssn\"                 \"drivers\"             \"passport\"           \n [7] \"prefix\"              \"first\"               \"middle\"             \n[10] \"last\"                \"suffix\"              \"maiden\"             \n[13] \"marital\"             \"race\"                \"ethnicity\"          \n[16] \"gender\"              \"birthplace\"          \"address\"            \n[19] \"city\"                \"state\"               \"county\"             \n[22] \"fips\"                \"zip\"                 \"lat\"                \n[25] \"lon\"                 \"healthcare_expenses\" \"healthcare_coverage\"\n[28] \"income\"             \n\n# Remove all temporary objects created in this chunk\nrm(patients_mutated, patients_transmuted, patients_case_when, patients_if_else,\n   patients_split, patients_sub, patients_gsub, patients_tolower, temp)\n\nWarning in rm(patients_mutated, patients_transmuted, patients_case_when, :\nobject 'patients_split' not found\n\n\n\n\nParsing Text Fields in R: Handling Multi-Word Names\nIn real-world datasets, it‚Äôs common to encounter text fields where multiple data elements‚Äîsuch as city, state, and country‚Äîare embedded within a single string. These entries often include inconsistent spacing, making them challenging to analyze directly.\nParsing refers to the process of systematically breaking down these complex text fields into structured, usable components.\nparsing involves\n\nDetecting patterns in spacing‚Äîfor instance, identifying how many spaces exist between different parts of a string.\nDeciding where to split the string. For example, a single space might separate words within a single name such as city name (e.g., \"East Falmouth\"), while two or more spaces might indicate the boundary between city, state, and country (e.g., \"East Falmouth  Massachusetts  US\").\nCreating new variables or columns such as city, state, and country for cleaner and more structured data representation.\n\nparsing is important\n\nMany administrative or imported datasets contain combined or messy fields that hinder direct analysis.\nProper parsing helps to standardize and clean these fields, which is a critical step for effective data management, visualization, and analysis.\nIt enables downstream tasks such as geographic grouping, mapping, and report generation.\n\nSummary Table\n\n\n\n\n\n\n\nStep\nPurpose\n\n\n\n\nstr_view()\nVisually inspect spacing patterns between components\n\n\nstr_extract_all(\" +\")\nExtract all space sequences\n\n\nmap_int(..., length)\nCount the number of space groups per entry\n\n\nstr_count(\"\\\\S+\")\nCount the number of words\n\n\nnchar() with map_chr()\nShow the length of each space between words\n\n\narrange(desc(word_count))\nIdentify rows with the most words (potential outliers)\n\n\n\nDetecting and Understanding Space Patterns\nTo begin, I used example data from the patients$BIRTHPLACE column to identify how different rows are structured and where inconsistencies might exist.\n1. Visual Inspection of Spacing We can use str_view() from the stringr package to highlight space sequences:\n\nstr_view(patients$BIRTHPLACE[1:15], pattern = \" +\", match = TRUE)\n\n [1] ‚îÇ Boston&lt;  &gt;Massachusetts&lt;  &gt;US\n [2] ‚îÇ Chicopee&lt;  &gt;Massachusetts&lt;  &gt;US\n [3] ‚îÇ Spencer&lt;  &gt;Massachusetts&lt;  &gt;US\n [4] ‚îÇ Franklin&lt;  &gt;Massachusetts&lt;  &gt;US\n [5] ‚îÇ Brockton&lt;  &gt;Massachusetts&lt;  &gt;US\n [6] ‚îÇ Plymouth&lt;  &gt;Massachusetts&lt;  &gt;US\n [7] ‚îÇ East&lt; &gt;Falmouth&lt;  &gt;Massachusetts&lt;  &gt;US\n [8] ‚îÇ Methuen&lt;  &gt;Massachusetts&lt;  &gt;US\n [9] ‚îÇ Maynard&lt;  &gt;Massachusetts&lt;  &gt;US\n[10] ‚îÇ Boston&lt;  &gt;Massachusetts&lt;  &gt;US\n[11] ‚îÇ Framingham&lt;  &gt;Massachusetts&lt;  &gt;US\n[12] ‚îÇ Wayland&lt;  &gt;Massachusetts&lt;  &gt;US\n[13] ‚îÇ Toulouse&lt;  &gt;Occitanie&lt;  &gt;FR\n[14] ‚îÇ Framingham&lt;  &gt;Massachusetts&lt;  &gt;US\n[15] ‚îÇ Lynn&lt;  &gt;Massachusetts&lt;  &gt;US\n\n\nThis shows, for example: East&lt; &gt;Falmouth&lt; &gt;Massachusetts&lt; &gt;US Where: - One space connects city words (‚ÄúEast Falmouth‚Äù) - Two spaces separate city, state, and country\n2. Extract and Inspect Space Sequences Each row shows the space segments between words. This helps us detect whether extra or inconsistent spacing is present.\n\npatients %&gt;%\n  mutate(space_groups = str_extract_all(BIRTHPLACE, \" +\")) %&gt;%\n  select(BIRTHPLACE, space_groups) %&gt;%\n  head()\n\n                   BIRTHPLACE space_groups\n1   Boston  Massachusetts  US         ,   \n2 Chicopee  Massachusetts  US         ,   \n3  Spencer  Massachusetts  US         ,   \n4 Franklin  Massachusetts  US         ,   \n5 Brockton  Massachusetts  US         ,   \n6 Plymouth  Massachusetts  US         ,   \n\n\n3. Count Number of Space Groups This gives a frequency table showing how many rows have 2, 3, 4, or more space groups. A row with more than 2 groups may have extra words or inconsistent formatting.\n\npatients %&gt;%\n  mutate(\n    space_groups = str_extract_all(BIRTHPLACE, \" +\"),\n    n_spaces = map_int(space_groups, length)\n  ) %&gt;%\n  count(n_spaces)\n\n  n_spaces  n\n1        2 84\n2        3 15\n3        4  4\n4        5  3\n\n\n4. Count the Number of Words This confirms how many ‚Äúword segments‚Äù are in each row and helps identify malformed entries.\n\npatients %&gt;%\n  mutate(space_count = str_count(BIRTHPLACE, \" +\")) %&gt;%\n  count(space_count)\n\n  space_count  n\n1           2 84\n2           3 15\n3           4  4\n4           5  3\n\n\n5. Combine Word Count and Space Width To fully understand the complexity of each row, I extracted the number of words and the exact space widths between them:\nThis helps in identifying patterns like:\n‚ÄúEast Falmouth Massachusetts US‚Äù ‚Üí 4 words, with spacing like 1 | 2 | 1\n‚ÄúBoston Massachusetts US‚Äù ‚Üí 3 words, spacing 2 | 2\n\npatients %&gt;%\n  mutate(\n    word_count = str_count(BIRTHPLACE, \"\\\\S+\"),  # count non-space words\n    space_groups = str_extract_all(BIRTHPLACE, \" +\"),\n    space_lengths = map_chr(space_groups, ~ paste(nchar(.x), collapse = \" | \"))  # lengths of spaces\n  ) %&gt;%\n  arrange(desc(word_count)) %&gt;%\n  select(BIRTHPLACE, word_count, space_lengths) %&gt;%\n  head(20)\n\n                                 BIRTHPLACE word_count     space_lengths\n1  Santiago de los Caballeros  Santiago  DO          6 1 | 1 | 1 | 2 | 2\n2  Santiago de los Caballeros  Santiago  DO          6 1 | 1 | 1 | 2 | 2\n3  Santiago de los Caballeros  Santiago  DO          6 1 | 1 | 1 | 2 | 2\n4             San Salvador  El Salvador  SV          5     1 | 2 | 1 | 2\n5      Santo Domingo  National District  DO          5     1 | 2 | 1 | 2\n6         Portsmouth  Saint John Parish  DM          5     2 | 1 | 1 | 2\n7           Wesley  Saint Andrew Parish  DM          5     2 | 1 | 1 | 2\n8          East Falmouth  Massachusetts  US          4         1 | 2 | 2\n9       West Springfield  Massachusetts  US          4         1 | 2 | 2\n10        North Pembroke  Massachusetts  US          4         1 | 2 | 2\n11    North Attleborough  Massachusetts  US          4         1 | 2 | 2\n12                   Ponce  Puerto Rico  PR          4         2 | 1 | 2\n13            Fall River  Massachusetts  US          4         1 | 2 | 2\n14       South Deerfield  Massachusetts  US          4         1 | 2 | 2\n15                 Bayamon  Puerto Rico  PR          4         2 | 1 | 2\n16            Oak Bluffs  Massachusetts  US          4         1 | 2 | 2\n17       North Lakeville  Massachusetts  US          4         1 | 2 | 2\n18            Guatemala City  Guatemala  GT          4         1 | 2 | 2\n19         North Andover  Massachusetts  US          4         1 | 2 | 2\n20         North Reading  Massachusetts  US          4         1 | 2 | 2\n\n\nFrom observations in the data, split BIRTHPLACE by 2+ spaces would be more appropriate. Those two words having one space are the names for a city, state or country\n\n# Clean and split birthplace into city, state/region, and country\npatients_clean &lt;- patients %&gt;%\n  mutate(\n    parts = str_split(BIRTHPLACE, \" {2,}\"),             # split BIRTHPLACE by 2+ spaces\n    # %||% is a shorthand from the rlang package (used implicitly here via purrr) that returns the left-hand side if it exists, otherwise returns the right-hand side.\n    # eg If .x[2] exists, use it; otherwise, use NA (missing character).\n    city = map_chr(parts, ~ .x[1] %||% NA_character_),  # city name (first part)\n    state = map_chr(parts, ~ .x[2] %||% NA_character_), # state or region (second part)\n    country = map_chr(parts, ~ .x[3] %||% NA_character_)# country code (third part)\n  ) %&gt;%\n  select(BIRTHPLACE, city, state, country)\nhead(patients_clean, 10)\n\n                         BIRTHPLACE          city         state country\n1         Boston  Massachusetts  US        Boston Massachusetts      US\n2       Chicopee  Massachusetts  US      Chicopee Massachusetts      US\n3        Spencer  Massachusetts  US       Spencer Massachusetts      US\n4       Franklin  Massachusetts  US      Franklin Massachusetts      US\n5       Brockton  Massachusetts  US      Brockton Massachusetts      US\n6       Plymouth  Massachusetts  US      Plymouth Massachusetts      US\n7  East Falmouth  Massachusetts  US East Falmouth Massachusetts      US\n8        Methuen  Massachusetts  US       Methuen Massachusetts      US\n9        Maynard  Massachusetts  US       Maynard Massachusetts      US\n10        Boston  Massachusetts  US        Boston Massachusetts      US\n\ntail(patients_clean, 10)\n\n                                  BIRTHPLACE                       city\n97                 Boston  Massachusetts  US                     Boston\n98     North Attleborough  Massachusetts  US         North Attleborough\n99                Taunton  Massachusetts  US                    Taunton\n100            Chelmsford  Massachusetts  US                 Chelmsford\n101                Boston  Massachusetts  US                     Boston\n102             Holliston  Massachusetts  US                  Holliston\n103 Santiago de los Caballeros  Santiago  DO Santiago de los Caballeros\n104           Springfield  Massachusetts  US                Springfield\n105             Fitchburg  Massachusetts  US                  Fitchburg\n106       Millis-Clicquot  Massachusetts  US            Millis-Clicquot\n            state country\n97  Massachusetts      US\n98  Massachusetts      US\n99  Massachusetts      US\n100 Massachusetts      US\n101 Massachusetts      US\n102 Massachusetts      US\n103      Santiago      DO\n104 Massachusetts      US\n105 Massachusetts      US\n106 Massachusetts      US\n\n\nConclusion From this exploration, we observe that:\n\nMost entries use single spaces within city names (e.g., ‚ÄúEast Falmouth‚Äù)\nTwo or more spaces are commonly used to separate city, state, and country names\nParsing using a split on ‚Äú{2,}‚Äù (two or more spaces) is a reliable strategy\n\n\n\n\nFree-text fields are common in public-health, administrative, and clinical datasets. While they are rich in information, the lack of structure and consistent vocabulary can limit their usefulness. In real-world datasets, especially in health, administration, and survey data, free-text fields often contain rich information hidden in inconsistent or varied language. A single concept (e.g., ‚ÄúCOVID-19 vaccine‚Äù) might appear in many forms such as ‚Äúcovid jab‚Äù, ‚Äúcovid-19 injection‚Äù, or ‚ÄúSARS-CoV-2 shot‚Äù. This presentation demonstrates how to transform unstructured text into structured, analyzable data using R. The workflow covers\n\ntokenization,\nword-frequency analysis,\nstop-word removal,\nTF‚ÄìIDF to highlight context-specific terms,\nword-cloud visualisation,\nbigram and trigram extraction, and\npattern detection with regular expressions to create categorical variables.\n\nBasic Tokenisation and Word-Frequency Table\nTokenisation splits long strings of text into individual words or terms (‚Äútokens‚Äù). This enables us to calculate how often each word appears, which is essential for understanding vocabulary patterns.\nWe begin by loading the necessary R packages. If a package is not already installed.\n\n# Install packages when they are not already available\nif (!require(\"tidytext\")) install.packages(\"tidytext\", dependencies = TRUE)\nif (!require(\"wordcloud\")) install.packages(\"wordcloud\", dependencies = TRUE)\nif (!require(\"tm\"))        install.packages(\"tm\",        dependencies = TRUE)\n\nlibrary(tidytext)   # text mining utilities\nlibrary(wordcloud)  # word-cloud plots\nlibrary(tm)         # text-mining helpers used by wordcloud\n\n\nword_freq &lt;- vaccination %&gt;%\n  unnest_tokens(word, DESCRIPTION) %&gt;%\n  count(word, sort = TRUE) %&gt;%\n  filter(!is.na(word) & word != \"\")\n\nhead(word_freq)\n\n          word   n\n1         free 929\n2 preservative 929\n3    influenza 859\n4   injectable 859\n5     seasonal 859\n6         dose 230\n\n\nRemove Stop Words\nStop words are common terms like ‚Äúand‚Äù, ‚Äúthe‚Äù, or ‚Äúin‚Äù that typically do not contribute meaningful information in analysis. Removing these helps us focus on content-rich terms.\n\ndata(\"stop_words\")          # built-in tidytext stop-word list\n\nword_freq_clean &lt;- vaccination %&gt;%\n  unnest_tokens(word, DESCRIPTION) %&gt;%\n  anti_join(stop_words, by = \"word\") %&gt;%\n  count(word, sort = TRUE)\n\nhead(word_freq_clean)\n\n          word   n\n1         free 929\n2 preservative 929\n3    influenza 859\n4   injectable 859\n5     seasonal 859\n6         dose 230\n\n\n\nVisualise Word Frequencies\nThis bar chart provides a visual overview of the most common meaningful words in the dataset after stop-word removal.\n\nword_freq_clean %&gt;%\n  filter(n &gt; 20) %&gt;%\n  ggplot(aes(x = reorder(word, n), y = n)) +\n  geom_col() +\n  coord_flip() +\n  labs(title = \"Most Frequent Words After Stop-Word Removal\",\n       x = \"Word\",\n       y = \"Count\")\n\n\n\n\n\n\n\n\n\nCreate a Word Cloud\nA word cloud presents word frequencies visually, with more frequent words appearing larger. It offers a quick snapshot of key terms in the dataset.\n\npar(mar = c(1, 1, 1, 1))  # reduce plot margins\nwordcloud(words = word_freq_clean$word,\n          freq = word_freq_clean$n,\n          min.freq = 1,\n          max.words = 100,\n          random.order = FALSE)\n\n\n\n\n\n\n\n\n\nTF‚ÄìIDF Analysis\nTF‚ÄìIDF (Term Frequency‚ÄìInverse Document Frequency) highlights words that are common within a group but rare across groups. This helps identify terms that are contextually important for specific subgroups.\n\n# Example assumes a column called 'source_id' identifies individual documents\n\ntfidf_result &lt;- vaccination %&gt;%\n  select(source_id, DESCRIPTION) %&gt;%\n  unnest_tokens(word, DESCRIPTION) %&gt;%\n  anti_join(stop_words, by = \"word\") %&gt;%\n  count(source_id, word, sort = TRUE) %&gt;%\n  bind_tf_idf(word, source_id, n) %&gt;%\n  arrange(desc(tf_idf))\n\nhead(tfidf_result)\n\n\nBigrams and Trigrams (n-grams)\nSometimes the context of words matters more than individual terms. N-grams (bigrams, trigrams, etc.) allow us to capture meaningful phrases instead of isolated words.\nBigrams ‚Äì two-word phrases\n\nbigrams &lt;- vaccination %&gt;%\n  unnest_tokens(bigram, DESCRIPTION, token = \"ngrams\", n = 2) %&gt;%\n  count(bigram, sort = TRUE)\n\nhead(bigrams)\n\n                   bigram   n\n1       preservative free 929\n2      influenza seasonal 859\n3 injectable preservative 859\n4     seasonal injectable 859\n5                    &lt;NA&gt; 185\n6                covid 19 144\n\n\nTrigrams ‚Äì three-word phrases\n\ntrigrams &lt;- vaccination %&gt;%\n  unnest_tokens(trigram, DESCRIPTION, token = \"ngrams\", n = 3) %&gt;%\n  count(trigram, sort = TRUE)\n\nhead(trigrams)\n\n                           trigram   n\n1    influenza seasonal injectable 859\n2     injectable preservative free 859\n3 seasonal injectable preservative 859\n4                             &lt;NA&gt; 319\n5                      19 mrna lnp 142\n6                    covid 19 mrna 142\n\n\n\nCreate Categorical Variables from free and unstructured Text\nWe use regular expressions to classify unstructured free-text values into consistent categories. This transformation is critical for summarising or modelling based on text. We can identify and map all words that contain a certain substring (like ‚Äúcovid‚Äù in ‚ÄúCOVID-19‚Äù, ‚Äúcovid_19‚Äù, or ‚Äúcovid‚Äù). You can use str_detect() with a case-insensitive regular expression to filter your word frequency table.\n\nvaccination &lt;- vaccination %&gt;%\n  mutate(vaccine_group = case_when(\n    str_detect(DESCRIPTION, regex(\"covid|sars-cov-2\", ignore_case = TRUE)) ~ \"COVID-19\",\n    str_detect(DESCRIPTION, regex(\"influenza\", ignore_case = TRUE)) ~ \"Influenza\",\n    str_detect(DESCRIPTION, regex(\"hepatitis|hep a|hep b\", ignore_case = TRUE)) ~ \"Hepatitis\",\n    str_detect(DESCRIPTION, regex(\"hpv\", ignore_case = TRUE)) ~ \"HPV\",\n    str_detect(DESCRIPTION, regex(\"mmr\", ignore_case = TRUE)) ~ \"MMR\",\n    str_detect(DESCRIPTION, regex(\"dtap|tdap|tetanus|td \\\\(?adult\\\\)?\", ignore_case = TRUE)) ~ \"DTP group\",\n    str_detect(DESCRIPTION, regex(\"ipv\", ignore_case = TRUE)) ~ \"IPV\",\n    str_detect(DESCRIPTION, regex(\"hib\", ignore_case = TRUE)) ~ \"Hib\",\n    str_detect(DESCRIPTION, regex(\"meningococcal|mcv4\", ignore_case = TRUE)) ~ \"Meningococcal\",\n    str_detect(DESCRIPTION, regex(\"pneumococcal.*13\", ignore_case = TRUE)) ~ \"Pneumococcal PCV13\",\n    str_detect(DESCRIPTION, regex(\"pneumococcal.*23\", ignore_case = TRUE)) ~ \"Pneumococcal PPV23\",\n    str_detect(DESCRIPTION, regex(\"rotavirus\", ignore_case = TRUE)) ~ \"Rotavirus\",\n    str_detect(DESCRIPTION, regex(\"varicella\", ignore_case = TRUE)) ~ \"Varicella\",\n    str_detect(DESCRIPTION, regex(\"zoster\", ignore_case = TRUE)) ~ \"Zoster\",\n    TRUE ~ \"Other\"\n  ))\n\n# Frequency check\n\ntable(vaccination$vaccine_group)\n\n\n          COVID-19          DTP group          Hepatitis                Hib \n               144                152                114                 32 \n               HPV          Influenza                IPV      Meningococcal \n                61                859                 51                 52 \n               MMR Pneumococcal PCV13 Pneumococcal PPV23          Rotavirus \n                26                 52                  8                 21 \n         Varicella             Zoster \n                26                 21 \n\n# Grouping Values Using %in% Inside case_when()\n\nvaccination &lt;- vaccination %&gt;%\n  mutate(vacc_group3 = case_when(\n    vaccine_group %in% c(\"COVID-19\", \"Influenza\") ~ \"Respiratory vaccines\",\n    vaccine_group %in% c(\"DTP group\", \"Hepatitis\", \"HPV\", \"Hib\", \"IPV\", \n                         \"Meningococcal\", \"MMR\") ~ \"Childhood vaccines\",\n    TRUE ~ \"Other\"\n  )) %&gt;% \n  select(-ENCOUNTER, -CODE)\n\nhead (vaccination)\n\n                  DATE                              PATIENT\n1 2016-04-10T09:04:48Z 30a6452c-4297-a1ac-977a-6a23237c7b46\n2 2016-04-10T09:04:48Z 30a6452c-4297-a1ac-977a-6a23237c7b46\n3 2016-04-10T09:04:48Z 30a6452c-4297-a1ac-977a-6a23237c7b46\n4 2016-04-10T09:04:48Z 30a6452c-4297-a1ac-977a-6a23237c7b46\n5 2002-10-29T19:07:21Z 34a4dcc4-35fb-6ad5-ab98-be285c586a4f\n6 2005-11-01T19:07:21Z 34a4dcc4-35fb-6ad5-ab98-be285c586a4f\n                                                   DESCRIPTION BASE_COST\n1           Influenza  seasonal  injectable  preservative free       136\n2 Td (adult)  5 Lf tetanus toxoid  preservative free  adsorbed       136\n3                                                 Hep B  adult       136\n4                                          meningococcal MCV4P       136\n5           Influenza  seasonal  injectable  preservative free       136\n6           Influenza  seasonal  injectable  preservative free       136\n   vacc_date year    month vaccine_group          vacc_group3\n1 2016-04-10 2016    April     Influenza Respiratory vaccines\n2 2016-04-10 2016    April     DTP group   Childhood vaccines\n3 2016-04-10 2016    April     Hepatitis   Childhood vaccines\n4 2016-04-10 2016    April Meningococcal   Childhood vaccines\n5 2002-10-29 2002  October     Influenza Respiratory vaccines\n6 2005-11-01 2005 November     Influenza Respiratory vaccines\n\n\nConclusion\nBy combining the tidytext, stringr, and dplyr packages we converted messy free-text into structured data ready for analysis. This approach supports reproducible work, clearer insights, and more robust statistical modelling.\n\n\n\n\n\nCreating factor levels and relabeling\n\nApplying labels with label() and val_labels()\n\nDescriptive summaries with describe()\n\nIn R, categorical variables can be represented as factors to support grouping, modeling, and formatting for reporting. Factor variables store both the value and its associated level label.\nThis section introduces key functions to:\n\nConvert variables into factors\n\nRename or reorder levels for clarity\n\nApply variable-level labels using label() or var_label()\n\nAssign value labels using val_labels() (e.g., 1 = Male)\n\nGenerate descriptive metadata summaries using Hmisc::describe()\n\nValue labels are especially useful when numeric codes represent categorical responses. These can be shown in summaries or retained for export and display.\nYou can choose to display or hide value labels:\noptions(labelled::val_labels_visible = TRUE) # Show values like ‚Äú1 = Male‚Äù options(labelled::val_labels_visible = FALSE) # Show only ‚ÄúMale‚Äù\nüîπ Summary of Functions for Working with Factors and Labels\n\n\n\n\n\n\n\n\nTask\nFunction\nDescription\n\n\n\n\nConvert to factor\nas.factor(x)\nConvert a character or numeric variable into a factor\n\n\nReorder levels\nfactor(x, levels = ...)\nDefine a specific order for levels\n\n\nRename factor levels\nlevels(x) &lt;- c(...)\nManually change the displayed names of factor levels\n\n\nRecode with forcats\nfct_recode(), fct_relevel()\nRelabel, reorder, or collapse factor levels using tidyverse tools\n\n\nApply variable label\nlabel(x) &lt;- \"...\" or var_label(x) &lt;- \"...\"\nAssign a description to a variable\n\n\nApply value labels\nval_labels(x) &lt;- c(\"Label\" = code)\nDefine how codes map to category names (e.g., 1 = Male)\n\n\nRetrieve labels\nlabel(x), val_labels(x)\nView current labels or mappings\n\n\nGenerate summary with labels\nHmisc::describe(df)\nReturn a summary including variable names, labels, types, and distributions\n\n\n\n\n# Select two categorical variables\nvacc_factor &lt;- vacc_pt_merged %&gt;%\n  select(gender, marital)\n\n# Convert character to factor\nvacc_factor &lt;- vacc_factor %&gt;%\n  mutate(\n    gender = factor(gender),\n    marital = factor(marital)\n  )\n\n# Relabel factor levels using fct_recode()\nvacc_factor &lt;- vacc_factor %&gt;%\n  mutate(\n    gender = fct_recode(gender, \"Male\" = \"M\", \"Female\" = \"F\"),\n    marital = fct_recode(marital,\n                         \"Married\" = \"M\",\n                         \"Divorced\" = \"D\",\n                         \"Single\" = \"S\",\n                         \"Widowed\" = \"W\")\n  )\n\ntail(vacc_factor)\n\n     gender marital\n1614 Female  Single\n1615 Female  Single\n1616 Female  Single\n1617 Female  Single\n1618 Female  Single\n1619 Female  Single\n\n# Assign variable labels\nvar_label(vacc_factor$gender) &lt;- \"Biological Sex\"\nvar_label(vacc_factor$marital) &lt;- \"Marital Status\"\n\n# Assign value labels\nvacc_factor$gender_chr &lt;- as.character(vacc_factor$gender) # Convert factor to character\nval_labels(vacc_factor$gender_chr) &lt;- c(\"1\" = \"Male\", \"2\" = \"Female\")\n\n\n# View internal structure and label info\nstr(vacc_factor)\n\n'data.frame':   1619 obs. of  3 variables:\n $ gender    : Factor w/ 2 levels \"Female\",\"Male\": 2 2 2 2 2 2 2 2 2 2 ...\n  ..- attr(*, \"label\")= chr \"Biological Sex\"\n $ marital   : Factor w/ 5 levels \"\",\"Divorced\",..: 3 3 3 3 3 3 2 2 2 2 ...\n  ..- attr(*, \"label\")= chr \"Marital Status\"\n $ gender_chr: chr+lbl [1:1619] Male  , Male  , Male  , Male  , Male  , Male  , Male ...\n   ..@ labels: Named chr  \"Male\" \"Female\"\n   .. ..- attr(*, \"names\")= chr [1:2] \"1\" \"2\"\n\n# Remove bad labels if needed:\nvar_label(vacc_factor$gender) &lt;- NULL\n\n# Remove temporary object\nrm(vacc_factor)\n\n\n\n\n\n# Select two categorical variables\nvacc_factor &lt;- vacc_pt_merged %&gt;%\n  select(gender, marital)\n\n# Convert character to factor\nvacc_factor &lt;- vacc_factor %&gt;%\n  mutate(\n    gender = factor(gender),\n    marital = factor(marital)\n  )\n\n# Relabel factor levels using fct_recode()\nvacc_factor &lt;- vacc_factor %&gt;%\n  mutate(\n    gender = fct_recode(gender, \"Male\" = \"M\", \"Female\" = \"F\"),\n    marital = fct_recode(marital,\n                         \"Married\" = \"M\",\n                         \"Divorced\" = \"D\",\n                         \"Single\" = \"S\",\n                         \"Widowed\" = \"W\")\n  )\n\ntail(vacc_factor)\n\n     gender marital\n1614 Female  Single\n1615 Female  Single\n1616 Female  Single\n1617 Female  Single\n1618 Female  Single\n1619 Female  Single\n\n# Assign variable labels\nvar_label(vacc_factor$gender) &lt;- \"Biological Sex\"\nvar_label(vacc_factor$marital) &lt;- \"Marital Status\"\n\n# Assign value labels\nvacc_factor$gender_chr &lt;- as.character(vacc_factor$gender) # Convert factor to character\nval_labels(vacc_factor$gender_chr) &lt;- c(\"1\" = \"Male\", \"2\" = \"Female\")\n\n\n# View internal structure and label info\nstr(vacc_factor)\n\n'data.frame':   1619 obs. of  3 variables:\n $ gender    : Factor w/ 2 levels \"Female\",\"Male\": 2 2 2 2 2 2 2 2 2 2 ...\n  ..- attr(*, \"label\")= chr \"Biological Sex\"\n $ marital   : Factor w/ 5 levels \"\",\"Divorced\",..: 3 3 3 3 3 3 2 2 2 2 ...\n  ..- attr(*, \"label\")= chr \"Marital Status\"\n $ gender_chr: chr+lbl [1:1619] Male  , Male  , Male  , Male  , Male  , Male  , Male ...\n   ..@ labels: Named chr  \"Male\" \"Female\"\n   .. ..- attr(*, \"names\")= chr [1:2] \"1\" \"2\"\n\n# Remove bad labels if needed:\nvar_label(vacc_factor$gender) &lt;- NULL\n\n# Remove temporary object\nrm(vacc_factor)\n\n\ngroup_by(), summarize(), ungroup()\nRow and column percentages: details presented in section 7.2 below\nWeighted summaries with wt =\n\nGrouping and summarizing data is fundamental for understanding patterns, distributions, and relationships within datasets.\nIn dplyr, the functions group_by() and summarize() are used together to calculate statistics across different groups.\nWe can also calculate proportions (row-wise or column-wise) and perform weighted summaries when necessary. The details regarding row and column percentages are presented in section 7.2 below.\nThese steps are critical for aggregating information into meaningful insights, especially when working with categorical, grouped, or longitudinal data.\n\nüîπ Summary of Functions for Grouping and Summarizing\n\n\n\n\n\n\n\n\nTask\nFunction\nPurpose\n\n\n\n\nGroup data by one or more variables\ngroup_by()\nDefine groups for aggregation\n\n\nSummarize grouped data\nsummarize()\nApply aggregation functions (e.g., mean, sum, count)\n\n\nRemove grouping structure\nungroup()\nReturn to ungrouped state after summary\n\n\nCalculate row-wise or column-wise proportions\nManual with mutate(), prop.table(), etc.\nUnderstand percentage distribution within/between groups\n\n\nWeighted summaries\nsummarize(wt = )\nCompute weighted means, sums, or percentages when different rows contribute differently\n\n\n\n\n‚û°Ô∏è Grouping and summarization allow efficient exploration of key relationships and preparation of clean summary tables.\n\n\n# ....................................................\n# Grouping and Summarizing Breast Cancer Data\n# ....................................................\n\n# Grouping by SA3 name, State, and Year, and summarizing participation\nbc_summary_year &lt;- breast_cancer_data %&gt;%\n  group_by(year) %&gt;%\n  summarise(\n    total_participants = sum(part50_74, na.rm = TRUE),\n    total_population = sum(pop50_74, na.rm = TRUE),\n    mean_screening_rate = mean(rate50_74, na.rm = TRUE),\n    .groups = \"drop\"\n  )\nhead(bc_summary_year, n = 3)\n\n# A tibble: 3 √ó 4\n    year total_participants total_population mean_screening_rate\n   &lt;int&gt;              &lt;dbl&gt;            &lt;dbl&gt;               &lt;dbl&gt;\n1 201617            1720463          3127749                54.9\n2 201718            1748606          3187574                54.7\n3 201819            1781484          3247470                54.6\n\n# --- Create Vaccination Pattern Dataset ---\ndf_vaccination_plot &lt;- vaccination %&gt;%\n  group_by(year, month, vaccine_group) %&gt;%\n  summarise(\n    count = n(),  # Number of records per year-month-vaccine_group combination\n    .groups = \"drop\"\n  ) %&gt;%\n  ungroup() %&gt;%\n  group_by(year, month) %&gt;%\n  mutate(\n    count_month = sum(count)  # Total vaccines in that year-month across all groups\n  ) %&gt;%\n  ungroup() %&gt;%\n  mutate(\n    proportion_month = round((count / count_month) * 100, 1)  # % per vaccine group within month\n  ) %&gt;%\n  group_by(year) %&gt;%\n  mutate(\n    total_year = sum(count)  # Total vaccines across the year\n  ) %&gt;%\n  mutate(\n    proportion_year = round((count / total_year) * 100, 1)  # % per vaccine group within year\n  ) %&gt;%\n  ungroup()\n\n# View first few rows\ntail(df_vaccination_plot)\n\n# A tibble: 6 √ó 8\n  year  month     vaccine_group count count_month proportion_month total_year\n  &lt;chr&gt; &lt;chr&gt;     &lt;chr&gt;         &lt;int&gt;       &lt;int&gt;            &lt;dbl&gt;      &lt;int&gt;\n1 2024  October   Zoster            1          15              6.7        122\n2 2024  September COVID-19          1          15              6.7        122\n3 2024  September DTP group         2          15             13.3        122\n4 2024  September HPV               2          15             13.3        122\n5 2024  September Influenza         9          15             60          122\n6 2024  September Meningococcal     1          15              6.7        122\n# ‚Ñπ 1 more variable: proportion_year &lt;dbl&gt;\n\n# Enhanced summary of breast cancer screening data with SA3, State, and National Year-level proportions\n# use na.rm = TRUE to remove (ignore) missing values (NA) when calculating\n\nbc_summary &lt;- breast_cancer_data %&gt;%\n  # Group by SA3 area, State, and Year\n  group_by(sa3name, state, year) %&gt;%\n  summarise(\n    total_participants = sum(part50_74, na.rm = TRUE),  # Sum of screened participants\n    total_population = sum(pop50_74, na.rm = TRUE),     # Sum of target population\n    .groups = \"drop\"\n  ) %&gt;%\n  # Calculate SA3-level screening rate and proportion\n  mutate(\n    screening_rate = round((total_participants / total_population) * 100, 1),  # % screened in that SA3\n    proportion_area = round((total_participants / sum(total_participants)) * 100, 1)  # % contribution to national participants\n  ) %&gt;%\n  # Add State-level aggregated summaries\n  group_by(state, year) %&gt;%\n  mutate(\n    state_sa3 = n(),  # Number of SA3 areas within each State-Year\n    state_total_participants = sum(total_participants, na.rm = TRUE),  # State-wide participants\n    state_total_population = sum(total_population, na.rm = TRUE),      # State-wide target population\n    state_screening_rate = round((state_total_participants / state_total_population) * 100, 1),  # % screened at State level\n    state_proportion = round((state_total_participants / sum(total_participants)) * 100, 1)  # State share of total participants\n  ) %&gt;%\n  ungroup() %&gt;%\n  # Add National Year-level aggregated summaries\n  group_by(year) %&gt;%\n  mutate(\n    year_sa3 = n(),  # Number of SA3 areas within each Year\n    year_total_participants = sum(total_participants, na.rm = TRUE),  # Australia-wide participants for that year\n    year_total_population = sum(total_population, na.rm = TRUE),      # Australia-wide target population for that year\n    year_screening_rate = round((year_total_participants / year_total_population) * 100, 1),  # National % screened\n    year_proportion = round((year_total_participants / sum(total_participants)) * 100, 1)  # National share\n  ) %&gt;%\n  ungroup() %&gt;%\n  arrange(year, state, sa3name)   # Final arrangement for neat viewing\n\n# View the last few rows\ntail(bc_summary)\n\n# A tibble: 6 √ó 17\n  sa3name        state   year total_participants total_population screening_rate\n  &lt;chr&gt;          &lt;chr&gt;  &lt;int&gt;              &lt;dbl&gt;            &lt;dbl&gt;          &lt;dbl&gt;\n1 Stirling       WA    201920              13878            27265           50.9\n2 Swan           WA    201920               8513            17274           49.3\n3 Wanneroo       WA    201920              12032            24345           49.4\n4 West Pilbara   WA    201920                828             2409           34.4\n5 Wheat Belt - ‚Ä¶ WA    201920               4947             9813           50.4\n6 Wheat Belt - ‚Ä¶ WA    201920               1446             3342           43.3\n# ‚Ñπ 11 more variables: proportion_area &lt;dbl&gt;, state_sa3 &lt;int&gt;,\n#   state_total_participants &lt;dbl&gt;, state_total_population &lt;dbl&gt;,\n#   state_screening_rate &lt;dbl&gt;, state_proportion &lt;dbl&gt;, year_sa3 &lt;int&gt;,\n#   year_total_participants &lt;dbl&gt;, year_total_population &lt;dbl&gt;,\n#   year_screening_rate &lt;dbl&gt;, year_proportion &lt;dbl&gt;\n\n# ....................................................\n# Calculating Proportions: details presented in section 7.2 below\n# ....................................................\n\n# Adding participation proportion within each SA3-year group\nbc_summary_with_prop &lt;- bc_summary %&gt;%\n  mutate(\n    participation_rate = (total_participants / total_population) * 100\n  ) %&gt;% \n  select(participation_rate)\n\nhead(bc_summary_with_prop)\n\n# A tibble: 6 √ó 1\n  participation_rate\n               &lt;dbl&gt;\n1               56.1\n2              NaN  \n3               53.8\n4              NaN  \n5               54.5\n6               55.1\n\n# ....................................................\n# Weighted Summarization (Weighted Average Screening Rate)\n# ....................................................\n\n# Calculate weighted mean screening rate by SA3\nbc_weighted_summary &lt;- breast_cancer_data %&gt;%\n  group_by(sa3name, state, year) %&gt;%\n  summarise(\n    total_participants = sum(part50_74, na.rm = TRUE),\n    total_population = sum(pop50_74, na.rm = TRUE),\n    weighted_screening_rate = round(sum(rate50_74 * pop50_74, na.rm = TRUE) / sum(pop50_74, na.rm = TRUE), 1),\n    .groups = \"drop\"\n  )\n\nhead(bc_weighted_summary)\n\n# A tibble: 6 √ó 6\n  sa3name        state   year total_participants total_population\n  &lt;chr&gt;          &lt;chr&gt;  &lt;int&gt;              &lt;dbl&gt;            &lt;dbl&gt;\n1 Adelaide City  SA    201617               1280             2537\n2 Adelaide City  SA    201718               1314             2608\n3 Adelaide City  SA    201819               1368             2642\n4 Adelaide City  SA    201920               1208             2707\n5 Adelaide Hills SA    201617               7010            11636\n6 Adelaide Hills SA    201718               7096            11876\n# ‚Ñπ 1 more variable: weighted_screening_rate &lt;dbl&gt;\n\n# ....................................................\n# Remove all temporary objects created in this chunk\n# ....................................................\nrm(bc_summary, bc_summary_with_prop, bc_weighted_summary)\n\n\n\n\n\narrange(), desc()\nslice_max(), slice_min(), top_n()\nRanking data and filtering top/bottom groups\n\nSorting and reordering data is important for finding trends, identifying extremes (top or bottom performers), and preparing tables for reporting or visualization.\nIn dplyr, the arrange() function sorts datasets by one or more variables, while desc() allows descending (reverse) order.\nFor selecting specific rows like top N or bottom N values, slice_max() and slice_min() are commonly used.\nThese techniques allow focusing on key records, comparing rankings across groups, and making datasets easier to review.\n\nüîπ Summary of Functions for Sorting and Reordering\n\n\n\n\n\n\n\n\nTask\nFunction\nPurpose\n\n\n\n\nSort ascending order\narrange()\nSort rows by one or more variables (lowest to highest)\n\n\nSort descending order\narrange(desc())\nSort rows highest to lowest\n\n\nSelect top N rows by a variable\nslice_max()\nKeep top N records based on a variable\n\n\nSelect bottom N rows by a variable\nslice_min()\nKeep bottom N records based on a variable\n\n\nSelect top N rows (old method)\ntop_n()\nDeprecated alternative to slice_max() (not recommended now)\n\n\nRank within groups\nmutate(rank = row_number())\nCreate custom ranking inside grouped data\n\n\n\n\n‚û°Ô∏è Sorting and slicing help prioritize key data points and create targeted outputs for decision-making or visualization.\n\n\n# ....................................................\n# Sorting, Reordering, Slicing, and Arranging (Breast Cancer Data)\n# ....................................................\n\n# Sorting by Screening Rate in Ascending Order\nbc_sorted_rate &lt;- breast_cancer_data %&gt;%\n  arrange(rate50_74) %&gt;%\n  select(sa3code, sa3coden, sa3name, state, year,\n         part50_74, pop50_74, rate50_74, agen50_74, expct50_74)\n\nhead(bc_sorted_rate)\n\n  sa3code sa3coden        sa3name state   year part50_74 pop50_74 rate50_74\n1   90104    90104 Norfolk Island Other 201920        24      441   5.40000\n2   90104    90104 Norfolk Island Other 201819        31      422   7.30000\n3   90104    90104 Norfolk Island Other 201718        39      401   9.70000\n4   70205    70205      Katherine    NT 201920       412     2011  20.51335\n5   51002    51002   East Pilbara    WA 201920       562     1987  28.26220\n6   51002    51002   East Pilbara    WA 201819       567     1918  29.55425\n  agen50_74 expct50_74\n1         3        220\n2         3        231\n3         3        219\n4         3       1003\n5         3        991\n6         3       1051\n\n# Sorting by Screening Rate in Descending Order\nbc_sorted_rate_desc &lt;- breast_cancer_data %&gt;%\n  arrange(desc(rate50_74)) %&gt;%\n  select(sa3code, sa3coden, sa3name, state, year,\n         part50_74, pop50_74, rate50_74, agen50_74, expct50_74)\n\nhead(bc_sorted_rate_desc)\n\n  sa3code sa3coden                        sa3name state   year part50_74\n1   90102    90102        Cocos (Keeling) Islands Other 201920        81\n2   31801    31801 Charters Towers - Ayr - Ingham   Qld 201617      4628\n3   60102    60102            Hobart - North East   Tas 201718      5856\n4   60104    60104        Hobart - South and West   Tas 201718      3643\n5   11004    11004            Tamworth - Gunnedah   NSW 201819      8426\n6   31801    31801 Charters Towers - Ayr - Ingham   Qld 201718      4612\n  pop50_74 rate50_74 agen50_74 expct50_74\n1      101  80.20000         3         50\n2     6713  68.90000         3       3692\n3     8566  68.36348         3       4694\n4     5331  68.34190         3       2921\n5    12333  68.32168         3       6758\n6     6759  68.23824         3       3703\n\n# Slicing Top 10 SA3s with Highest Screening Rates\nbc_top_screening &lt;- breast_cancer_data %&gt;%\n  slice_max(order_by = rate50_74, n = 10) %&gt;%\n  select(sa3code, sa3coden, sa3name, state, year,\n         part50_74, pop50_74, rate50_74, agen50_74, expct50_74)\n\nbc_top_screening\n\n   sa3code sa3coden                        sa3name state   year part50_74\n1    90102    90102        Cocos (Keeling) Islands Other 201920        81\n2    31801    31801 Charters Towers - Ayr - Ingham   Qld 201617      4628\n3    60102    60102            Hobart - North East   Tas 201718      5856\n4    60104    60104        Hobart - South and West   Tas 201718      3643\n5    11004    11004            Tamworth - Gunnedah   NSW 201819      8426\n6    31801    31801 Charters Towers - Ayr - Ingham   Qld 201718      4612\n7    11001    11001                       Armidale   NSW 201617      3810\n8    60102    60102            Hobart - North East   Tas 201819      5881\n9    31801    31801 Charters Towers - Ayr - Ingham   Qld 201819      4588\n10   31801    31801 Charters Towers - Ayr - Ingham   Qld 201920      4580\n   pop50_74 rate50_74 agen50_74 expct50_74\n1       101  80.20000         3         50\n2      6713  68.90000         3       3692\n3      8566  68.36348         3       4694\n4      5331  68.34190         3       2921\n5     12333  68.32168         3       6758\n6      6759  68.23824         3       3703\n7      5602  68.00000         3       3081\n8      8698  67.61016         3       4766\n9      6797  67.49974         3       3724\n10     6818  67.17431         3       3402\n\n# Slicing Bottom 5 SA3s with Lowest Screening Rates\nbc_bottom_screening &lt;- breast_cancer_data %&gt;%\n  slice_min(order_by = rate50_74, n = 5) %&gt;%\n  select(sa3code, sa3coden, sa3name, state, year,\n         part50_74, pop50_74, rate50_74, agen50_74, expct50_74)\n\nbc_bottom_screening\n\n  sa3code sa3coden        sa3name state   year part50_74 pop50_74 rate50_74\n1   90104    90104 Norfolk Island Other 201920        24      441   5.40000\n2   90104    90104 Norfolk Island Other 201819        31      422   7.30000\n3   90104    90104 Norfolk Island Other 201718        39      401   9.70000\n4   70205    70205      Katherine    NT 201920       412     2011  20.51335\n5   51002    51002   East Pilbara    WA 201920       562     1987  28.26220\n  agen50_74 expct50_74\n1         3        220\n2         3        231\n3         3        219\n4         3       1003\n5         3        991\n\n# Ranking Within Each State\nbc_ranked &lt;- breast_cancer_data %&gt;%\n  group_by(state) %&gt;%\n  arrange(desc(rate50_74), .by_group = TRUE) %&gt;%\n  mutate(screening_rank = row_number()) %&gt;%\n  select(screening_rank, rate50_74, state) %&gt;% \n  ungroup()\n\nhead(bc_ranked, n = 10)\n\n# A tibble: 10 √ó 3\n   screening_rank rate50_74 state\n            &lt;int&gt;     &lt;dbl&gt; &lt;chr&gt;\n 1              1      59.9 ACT  \n 2              2      58.8 ACT  \n 3              3      58.4 ACT  \n 4              4      58   ACT  \n 5              5      57.7 ACT  \n 6              6      57.4 ACT  \n 7              7      57.2 ACT  \n 8              8      57.1 ACT  \n 9              9      57.0 ACT  \n10             10      56.7 ACT  \n\n# ....................................................\n# Remove all temporary objects created in this chunk\n# ....................................................\nrm(bc_sorted_rate, bc_sorted_rate_desc, bc_top_screening, bc_bottom_screening, bc_ranked)\n\n\n\n\n\npivot_longer(), pivot_wider()\nWide-to-long and long-to-wide transformations\nSeparating and uniting columns with separate() and unite()\n\n\nIn data analysis, datasets often need to be reorganized ‚Äî from wide format to long format, or vice versa ‚Äî to suit different types of analysis or visualization.\nThe goal is to follow Tidy Data principles where: - Each variable forms a column - Each observation forms a row - Each type of observational unit forms a table\ndplyr and tidyr provide key functions for reshaping: - pivot_longer() turns many columns into two columns (variable name and value). - pivot_wider() spreads one column into multiple columns. - separate() splits one column into multiple columns based on a separator. - unite() combines multiple columns into one.\nThese tools help create clean, organized datasets ready for efficient analysis and plotting.\n\nüîπ Summary of Functions for Reshaping and Tidy Data\n\n\n\n\n\n\n\n\nTask\nFunction\nPurpose\n\n\n\n\nReshape wide to long\npivot_longer()\nCollapse multiple columns into key-value pairs\n\n\nReshape long to wide\npivot_wider()\nSpread key-value pairs across multiple columns\n\n\nSplit a column into multiple parts\nseparate()\nSeparate one column into several columns by a delimiter\n\n\nCombine multiple columns into one\nunite()\nMerge several columns into a single column\n\n\n\n\n‚û°Ô∏è These reshaping techniques make it easy to transform datasets into a tidy structure for summaries, modeling, or visualization.\n\n** üîé Regular Expression Tip for names_pattern**\n\n\nIn pivot_longer(), we use a regular expression to split the column names into two components: - part, pop, rate, or expct ‚Üí measure - 50_54, 55_59, etc. ‚Üí age group The pattern ([0-9]{2}_[0-9]{2}) works as follows:\n\n\n\n\n\nComponent\nMeaning\n\n\n\n\n[0-9]\nMatch any digit (0‚Äì9)\n\n\n{2}\nExactly two digits\n\n\n_\nAn underscore\n\n\n[0-9]{2}\nAnother two digits\n\n\n\n‚û°Ô∏è This captures typical age formats like 50_54, 60_64, etc.\n\nOriginal Column Name: rate50_54\nComponents: ‚îå‚îÄ‚îÄ‚îÄ‚îê ‚îå‚îÄ‚îÄ‚îÄ‚îê ‚Ä¶.&gt; ‚îÇrate ‚îÇ ‚îÇ50_54 ‚îÇ &gt; ‚îî‚îÄ‚îò ‚îî‚îÄ‚îÄ‚îò\n\n# ....................................................\n# Reshaping, Separate and Unite Columns: Breast Cancer Data\n# ....................................................\n\n# Pivot longer by extracting measure type and age group separately\nbreast_cancer_long &lt;- breast_cancer_data %&gt;%\n  pivot_longer(\n    cols = starts_with(\"part\") | starts_with(\"pop\") | starts_with(\"rate\") | starts_with(\"expct\"),\n    names_to = c(\"measure\", \"age_group\"),\n    names_pattern = \"(part|pop|rate|expct)([0-9]{2}_[0-9]{2})\",\n    values_to = \"value\"\n  ) %&gt;%\n  relocate(measure, age_group, .before = sa3code)\n\nhead(breast_cancer_long, n = 10)\n\n# A tibble: 10 √ó 15\n   measure age_group sa3code sa3coden sa3name   state   year agen50_74 agen50_69\n   &lt;chr&gt;   &lt;chr&gt;       &lt;int&gt;    &lt;int&gt; &lt;chr&gt;     &lt;chr&gt;  &lt;int&gt;     &lt;int&gt;     &lt;int&gt;\n 1 part    50_74       10102    10102 Queanbey‚Ä¶ NSW   201617         3         2\n 2 part    50_69       10102    10102 Queanbey‚Ä¶ NSW   201617         3         2\n 3 part    50_54       10102    10102 Queanbey‚Ä¶ NSW   201617         3         2\n 4 part    55_59       10102    10102 Queanbey‚Ä¶ NSW   201617         3         2\n 5 part    60_64       10102    10102 Queanbey‚Ä¶ NSW   201617         3         2\n 6 part    65_69       10102    10102 Queanbey‚Ä¶ NSW   201617         3         2\n 7 part    70_74       10102    10102 Queanbey‚Ä¶ NSW   201617         3         2\n 8 pop     50_74       10102    10102 Queanbey‚Ä¶ NSW   201617         3         2\n 9 pop     50_69       10102    10102 Queanbey‚Ä¶ NSW   201617         3         2\n10 pop     50_54       10102    10102 Queanbey‚Ä¶ NSW   201617         3         2\n# ‚Ñπ 6 more variables: agen50_54 &lt;int&gt;, agen55_59 &lt;int&gt;, agen60_64 &lt;int&gt;,\n#   agen65_69 &lt;int&gt;, agen70_74 &lt;int&gt;, value &lt;dbl&gt;\n\n# Pivot wider to spread measures into separate columns\nbreast_cancer_final &lt;- breast_cancer_long %&gt;%\n  pivot_wider(\n    names_from = measure,\n    values_from = value\n  ) %&gt;%\n  relocate(part, pop, rate, expct, .before = sa3code)\n\nhead(breast_cancer_final, n = 5)\n\n# A tibble: 5 √ó 17\n  age_group  part   pop  rate expct sa3code sa3coden sa3name    state   year\n  &lt;chr&gt;     &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;   &lt;int&gt;    &lt;int&gt; &lt;chr&gt;      &lt;chr&gt;  &lt;int&gt;\n1 50_74      4875  8052  60.5  4428   10102    10102 Queanbeyan NSW   201617\n2 50_69      4309  7145  60.3  3929   10102    10102 Queanbeyan NSW   201617\n3 50_54      1284  2251  57    1118   10102    10102 Queanbeyan NSW   201617\n4 55_59      1188  1970  60.3  1046   10102    10102 Queanbeyan NSW   201617\n5 60_64      1012  1625  62.3   950   10102    10102 Queanbeyan NSW   201617\n# ‚Ñπ 7 more variables: agen50_74 &lt;int&gt;, agen50_69 &lt;int&gt;, agen50_54 &lt;int&gt;,\n#   agen55_59 &lt;int&gt;, agen60_64 &lt;int&gt;, agen65_69 &lt;int&gt;, agen70_74 &lt;int&gt;\n\n# Separate 'age_group' into two new columns: start and end age\nbreast_cancer_separated &lt;- breast_cancer_long %&gt;%\n  separate(\n    col = age_group,\n    into = c(\"age_start\", \"age_end\"),\n    sep = \"_\",\n    convert = TRUE\n  ) %&gt;% \n  select(\"age_start\", \"age_end\", everything())\n\nhead(breast_cancer_separated, n = 3)\n\n# A tibble: 3 √ó 16\n  age_start age_end measure sa3code sa3coden sa3name    state   year agen50_74\n      &lt;int&gt;   &lt;int&gt; &lt;chr&gt;     &lt;int&gt;    &lt;int&gt; &lt;chr&gt;      &lt;chr&gt;  &lt;int&gt;     &lt;int&gt;\n1        50      74 part      10102    10102 Queanbeyan NSW   201617         3\n2        50      69 part      10102    10102 Queanbeyan NSW   201617         3\n3        50      54 part      10102    10102 Queanbeyan NSW   201617         3\n# ‚Ñπ 7 more variables: agen50_69 &lt;int&gt;, agen50_54 &lt;int&gt;, agen55_59 &lt;int&gt;,\n#   agen60_64 &lt;int&gt;, agen65_69 &lt;int&gt;, agen70_74 &lt;int&gt;, value &lt;dbl&gt;\n\n# Unite 'age_start' and 'age_end' into a single age group label\nbreast_cancer_united &lt;- breast_cancer_separated %&gt;%\n  unite(\n    col = age_group_combined,\n    age_start, age_end,\n    sep = \"-\",\n    remove = FALSE\n  )\n\nhead(breast_cancer_united, n = 3)\n\n# A tibble: 3 √ó 17\n  age_group_combined age_start age_end measure sa3code sa3coden sa3name    state\n  &lt;chr&gt;                  &lt;int&gt;   &lt;int&gt; &lt;chr&gt;     &lt;int&gt;    &lt;int&gt; &lt;chr&gt;      &lt;chr&gt;\n1 50-74                     50      74 part      10102    10102 Queanbeyan NSW  \n2 50-69                     50      69 part      10102    10102 Queanbeyan NSW  \n3 50-54                     50      54 part      10102    10102 Queanbeyan NSW  \n# ‚Ñπ 9 more variables: year &lt;int&gt;, agen50_74 &lt;int&gt;, agen50_69 &lt;int&gt;,\n#   agen50_54 &lt;int&gt;, agen55_59 &lt;int&gt;, agen60_64 &lt;int&gt;, agen65_69 &lt;int&gt;,\n#   agen70_74 &lt;int&gt;, value &lt;dbl&gt;\n\n# ....................................................\n# Remove temporary objects created in this chunk\n# ....................................................\nrm(breast_cancer_long, breast_cancer_separated, breast_cancer_united, breast_cancer_final)"
  },
  {
    "objectID": "Post_Blog/Data_Manipulation_and_Wrangling/index.html#part-iv-advanced-wrangling-and-integration",
    "href": "Post_Blog/Data_Manipulation_and_Wrangling/index.html#part-iv-advanced-wrangling-and-integration",
    "title": "Date Manipulation and Wrangling using R",
    "section": "",
    "text": "lubridate::ymd(), as_date(), format(), %p, weekdays()\nExtracting date components: year, month, quarter\n\nWorking with dates is essential in many datasets, particularly for time-based trends, age calculations, seasonal effects, and survival analysis.\nWe use the lubridate package to parse, extract, and manipulate dates efficiently. The details about time and date data has been presented separately.\n‚û°Ô∏è For full tutorials and videos: - YouTube (AnalyticsHub): Watch Full Video - GitHub: Access Here\nSummary of Functions for Date Handling\n\n\n\n\n\n\n\n\nTask\nFunction\nPurpose\n\n\n\n\nParse ISO dates\nas.Date(), strptime()\nRead and convert raw string timestamps\n\n\nFormat date output\nformat()\nCustomize how dates are displayed\n\n\nExtract components\nyear(), month(), day(), quarter(), week()\nPull year, month, day, quarter, week from dates\n\n\nWeekday labels\nwday(label = TRUE)\nGet day of week in text form\n\n\nDate arithmetic\ndifftime(), -\nCalculate differences between dates\n\n\nLogical operations\n&lt;, &gt;, between()\nFilter by date ranges\n\n\nFiscal/seasonal grouping\ncase_when()\nCategorize based on seasons or financial years\n\n\n\n\nDemonstration using Vaccination Dataset\n\n# Convert DATE into usable R date format\nvaccination &lt;- vaccination %&gt;%\n  mutate(\n    vacc_date = as.Date(strptime(date, format = \"%Y-%m-%dT%H:%M:%SZ\")),\n    vacc_year = year(vacc_date),\n    vacc_month = month(vacc_date, label = TRUE, abbr = FALSE)\n  ) %&gt;% \n  select(-description, base_cost)\n\nhead(vaccination)\n\n                  date                              patient base_cost\n1 2016-04-10T09:04:48Z 30a6452c-4297-a1ac-977a-6a23237c7b46       136\n2 2016-04-10T09:04:48Z 30a6452c-4297-a1ac-977a-6a23237c7b46       136\n3 2016-04-10T09:04:48Z 30a6452c-4297-a1ac-977a-6a23237c7b46       136\n4 2016-04-10T09:04:48Z 30a6452c-4297-a1ac-977a-6a23237c7b46       136\n5 2002-10-29T19:07:21Z 34a4dcc4-35fb-6ad5-ab98-be285c586a4f       136\n6 2005-11-01T19:07:21Z 34a4dcc4-35fb-6ad5-ab98-be285c586a4f       136\n   vacc_date year    month vaccine_group          vacc_group3 vacc_year\n1 2016-04-10 2016    April     Influenza Respiratory vaccines      2016\n2 2016-04-10 2016    April     DTP group   Childhood vaccines      2016\n3 2016-04-10 2016    April     Hepatitis   Childhood vaccines      2016\n4 2016-04-10 2016    April Meningococcal   Childhood vaccines      2016\n5 2002-10-29 2002  October     Influenza Respiratory vaccines      2002\n6 2005-11-01 2005 November     Influenza Respiratory vaccines      2005\n  vacc_month\n1      April\n2      April\n3      April\n4      April\n5    October\n6   November\n\n\nCalculating Time Differences\n\n# Calculating Time Differences\n\n# Convert column names to lowercase\ncolnames(patients) &lt;- tolower(colnames(patients))\ncolnames(vaccination) &lt;- tolower(colnames(vaccination))\n\n# vacc_pt_merged &lt;- left_join(patients, vaccination, by = \"id\" )\nvacc_pt_merged &lt;- left_join(patients, vaccination, by = c(\"id\" = \"patient\"))\n\nstr (vacc_pt_merged)\n\n'data.frame':   1619 obs. of  37 variables:\n $ id                 : chr  \"30a6452c-4297-a1ac-977a-6a23237c7b46\" \"30a6452c-4297-a1ac-977a-6a23237c7b46\" \"30a6452c-4297-a1ac-977a-6a23237c7b46\" \"30a6452c-4297-a1ac-977a-6a23237c7b46\" ...\n $ birthdate          : chr  \"1994-02-06\" \"1994-02-06\" \"1994-02-06\" \"1994-02-06\" ...\n $ deathdate          : chr  \"\" \"\" \"\" \"\" ...\n $ ssn                : chr  \"999-52-8591\" \"999-52-8591\" \"999-52-8591\" \"999-52-8591\" ...\n $ drivers            : chr  \"S99996852\" \"S99996852\" \"S99996852\" \"S99996852\" ...\n $ passport           : chr  \"X47758697X\" \"X47758697X\" \"X47758697X\" \"X47758697X\" ...\n $ prefix             : chr  \"Mr.\" \"Mr.\" \"Mr.\" \"Mr.\" ...\n $ first              : chr  \"Joshua658\" \"Joshua658\" \"Joshua658\" \"Joshua658\" ...\n $ middle             : chr  \"Alvin56\" \"Alvin56\" \"Alvin56\" \"Alvin56\" ...\n $ last               : chr  \"Kunde533\" \"Kunde533\" \"Kunde533\" \"Kunde533\" ...\n $ suffix             : logi  NA NA NA NA NA NA ...\n $ maiden             : chr  \"\" \"\" \"\" \"\" ...\n $ marital            : chr  \"M\" \"M\" \"M\" \"M\" ...\n $ race               : chr  \"white\" \"white\" \"white\" \"white\" ...\n $ ethnicity          : chr  \"nonhispanic\" \"nonhispanic\" \"nonhispanic\" \"nonhispanic\" ...\n $ gender             : chr  \"M\" \"M\" \"M\" \"M\" ...\n $ birthplace         : chr  \"Boston  Massachusetts  US\" \"Boston  Massachusetts  US\" \"Boston  Massachusetts  US\" \"Boston  Massachusetts  US\" ...\n $ address            : chr  \"811 Kihn Viaduct\" \"811 Kihn Viaduct\" \"811 Kihn Viaduct\" \"811 Kihn Viaduct\" ...\n $ city               : chr  \"Braintree\" \"Braintree\" \"Braintree\" \"Braintree\" ...\n $ state              : chr  \"Massachusetts\" \"Massachusetts\" \"Massachusetts\" \"Massachusetts\" ...\n $ county             : chr  \"Norfolk County\" \"Norfolk County\" \"Norfolk County\" \"Norfolk County\" ...\n $ fips               : int  25021 25021 25021 25021 25021 25021 25021 25021 25021 25021 ...\n $ zip                : int  2184 2184 2184 2184 2184 2184 2184 2184 2184 2184 ...\n $ lat                : num  42.2 42.2 42.2 42.2 42.2 ...\n $ lon                : num  -71 -71 -71 -71 -71 ...\n $ healthcare_expenses: num  56905 56905 56905 56905 56905 ...\n $ healthcare_coverage: num  18020 18020 18020 18020 18020 ...\n $ income             : int  100511 100511 100511 100511 100511 100511 49737 49737 49737 49737 ...\n $ date               : chr  \"2016-04-10T09:04:48Z\" \"2016-04-10T09:04:48Z\" \"2016-04-10T09:04:48Z\" \"2016-04-10T09:04:48Z\" ...\n $ base_cost          : num  136 136 136 136 136 136 136 136 136 136 ...\n $ vacc_date          : Date, format: \"2016-04-10\" \"2016-04-10\" ...\n $ year               : chr  \"2016\" \"2016\" \"2016\" \"2016\" ...\n $ month              : chr  \"April\" \"April\" \"April\" \"April\" ...\n $ vaccine_group      : chr  \"Influenza\" \"DTP group\" \"Hepatitis\" \"Meningococcal\" ...\n $ vacc_group3        : chr  \"Respiratory vaccines\" \"Childhood vaccines\" \"Childhood vaccines\" \"Childhood vaccines\" ...\n $ vacc_year          : num  2016 2016 2016 2016 2019 ...\n $ vacc_month         : Ord.factor w/ 12 levels \"January\"&lt;\"February\"&lt;..: 4 4 4 4 4 4 10 11 8 8 ...\n\nvacc_pt_merged %&gt;% \n  mutate(\n    vacc_date = as.Date(strptime(date, format = \"%Y-%m-%dT%H:%M:%SZ\")),\n    birthdate = as.Date(birthdate),\n    days_to_vax = as.numeric(difftime(vacc_date, birthdate, units = \"days\")),\n    weeks_to_vax = as.numeric(difftime(vacc_date, birthdate, units = \"weeks\")),\n    months_to_vax = as.numeric(difftime(vacc_date, birthdate, units = \"days\")) / 30.44,\n    years_to_vax = floor(as.numeric(difftime(vacc_date, birthdate, units = \"days\")) / 365.25)\n  ) -&gt; vacc_pt_merged\n\nsummary(vacc_pt_merged$days_to_vax)\n\n   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. \n      0    2548    7742   10375   18263   36813 \n\nsummary(vacc_pt_merged$years_to_vax)\n\n   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. \n   0.00    6.00   21.00   28.02   50.00  100.00 \n\n\nExtracting Date Components\n\nvacc_pt_merged &lt;- vacc_pt_merged %&gt;%\n  mutate(\n    vacc_day = day(vacc_date),\n    vacc_month_num = month(vacc_date),\n    vacc_month_name = month(vacc_date, label = TRUE, abbr = FALSE),\n    vacc_weekday = wday(vacc_date, label = TRUE, abbr = FALSE),\n    vacc_week = week(vacc_date),\n    vacc_quarter = quarter(vacc_date),\n    vacc_year = year(vacc_date),  # Define vacc_year first\n    vacc_fy = if_else(vacc_month_num &gt;= 7, vacc_year, vacc_year - 1),  # FY starts 1 July in Australia\n    vacc_season = case_when(\n      vacc_month_num %in% 12:2 ~ \"Summer\",\n      vacc_month_num %in% 3:5  ~ \"Autumn\",\n      vacc_month_num %in% 6:8  ~ \"Winter\",\n      vacc_month_num %in% 9:11 ~ \"Spring\"\n    ),\n    is_weekend = wday(vacc_date) %in% c(1, 7),\n    days_since_ref = floor(as.numeric(difftime(vacc_date, as.Date(\"2020-01-01\"), units = \"days\")))\n  )\n\ntemp &lt;- vacc_pt_merged %&gt;%\n  select(vacc_day, vacc_month_num, vacc_month_name, vacc_weekday, vacc_week,\n         vacc_quarter, vacc_year, vacc_fy, vacc_season, is_weekend, days_since_ref)\n\nhead(temp, n = 8)\n\n  vacc_day vacc_month_num vacc_month_name vacc_weekday vacc_week vacc_quarter\n1       10              4           April       Sunday        15            2\n2       10              4           April       Sunday        15            2\n3       10              4           April       Sunday        15            2\n4       10              4           April       Sunday        15            2\n5       14              4           April       Sunday        15            2\n6       17              4           April       Sunday        16            2\n7       29             10         October      Tuesday        44            4\n8        1             11        November      Tuesday        44            4\n  vacc_year vacc_fy vacc_season is_weekend days_since_ref\n1      2016    2015      Summer       TRUE          -1361\n2      2016    2015      Summer       TRUE          -1361\n3      2016    2015      Summer       TRUE          -1361\n4      2016    2015      Summer       TRUE          -1361\n5      2019    2018      Summer       TRUE           -262\n6      2022    2021      Summer       TRUE            837\n7      2002    2002      Summer      FALSE          -6273\n8      2005    2005      Summer      FALSE          -5174\n\nrm (temp)\n\nFiltering Between Date Ranges\n\n# Calculate Age as of 31 December 2024\n# str(vacc_pt_merged$birthdate) \n\nvacc_pt_merged &lt;- vacc_pt_merged %&gt;%\n  mutate(\n    age = floor(time_length(difftime(as.Date(\"2024-12-31\"), birthdate), unit = \"years\"))\n  )\n\ntable (vacc_pt_merged$age)\n\n\n  1   2   5   6   7  10  11  12  13  14  15  16  17  18  19  20  21  23  24  25 \n 46  24  64  66  34 102  38  59  21  21  34  83  18  36  18  34  48  13  12  47 \n 27  28  29  30  33  34  36  37  38  40  41  42  43  44  45  46  47  48  49  50 \n 17  30   9  38   4   7   6   8   6  20  37  16   9  17  15  13   9  21  30  15 \n 51  52  53  55  56  58  60  61  62  63  64  65  68  69  71  73  74  76  78  80 \n 13  30  16  30  30  14  12  27  49  13  26  14  14  57  15  27  15  14  12  13 \n 85  97 110 \n 12  20   1 \n\n# Categorize into Age Groups\nvacc_pt_merged &lt;- vacc_pt_merged %&gt;%\n  mutate(\n    age_group = cut(\n      age,\n      breaks = c(0, 9, 19, 29, 49, 100),\n      labels = c(\"0‚Äì9\", \"10‚Äì19\", \"20‚Äì29\", \"30‚Äì49\", \"50+\"),\n      right = TRUE\n    )\n  )\n\ntable (vacc_pt_merged$age_group)\n\n\n  0‚Äì9 10‚Äì19 20‚Äì29 30‚Äì49   50+ \n  234   430   210   256   488 \n\n# Vaccinations only in 2022\nvacc_2022 &lt;- vacc_pt_merged %&gt;%\n  filter(vacc_date &gt;= ymd(\"2022-01-01\") & vacc_date &lt;= ymd(\"2022-12-31\"))\n\n# Vaccinations between 2015 and 2024\nvacc_1524 &lt;- vacc_pt_merged %&gt;%\n  filter(vacc_year &gt;= 2015 & vacc_year &lt;= 2024)\n\ntable(vacc_1524$vacc_year)\n\n\n2015 2016 2017 2018 2019 2020 2021 2022 2023 2024 \n 153  139  137  151  161  137  263  120  170  122 \n\nrm(vacc_2022)\n\n\n\n\n\nID Creation (if missing): paste(), substr(), as.Date(), unite()\nDetecting Duplicates: duplicated(), distinct(), n_distinct(), row_number(), count(distinct(‚Ä¶))\nTagging Duplicates: row_number(), duplicated(), mutate(dup = row_number())\nValidating Duplicates: group_by() + filter(n() &gt; 1), arrange(), subset()\nRemoving Duplicates: filter(dup == 1), distinct(), summarise()\nOptional Filtering Rules: Keep first/last by date, non-missing only, domain-specific logic\n\nDuplicate records in health or survey data can compromise the integrity of analyses. A critical first step is ensuring each individual has a consistent and unique identifier (ID). When explicit IDs are missing or unreliable, they can be constructed using combinations of variables such as names, dates of birth, and location (e.g., using paste(), substr(), or unite()). Once IDs are established, duplicates can be detected, reviewed, and resolved systematically through tagging (row_number()), visual inspection, and appropriate retention or removal strategies.\n\nüîπ Key Aspects of Duplicate Management\n\n\n\n\n\n\n\n\nAspect\nWhat to Address\nWhy It Matters\n\n\n\n\nDetection Methods\nUse duplicated(), distinct(), n_distinct(), row_number() by ID or keys\nHelps quantify and locate potential duplicates\n\n\nValidation\nVisual/manual review using arrange(), group_by() + filter()\nPrevents removal of legitimate but similar entries\n\n\nTagging Duplicates\nLabel using row_number() or duplicated()\nAllows flexible filtering or analysis of repeats\n\n\nDeciding What to Keep\nKeep first, latest (by date), or non-missing based on rules\nAvoids loss of useful or most complete records\n\n\nRemoval or Aggregation\nDrop with filter(), or use summarise() to collapse duplicates\nDepends on context: reporting vs.¬†recordkeeping\n\n\nID Creation / Fixing\nUse mutate() to create or correct IDs\nEnables future joins and tracking\n\n\n\n\nThe following table shows the summary with some data manipulation options\n\n\n\n\n\n\n\n\nTask\nFunction / Code\nPurpose\n\n\n\n\nIdentify blank IDs or fields\nx[x == \"\"] &lt;- NA\nConvert empty strings to NA for proper detection\n\n\nCount missing values\nsum(is.na(x))\nCheck how many values are missing\n\n\nCount unique observations\ncount(distinct(df, id))\nDetermine the number of unique records\n\n\nGenerate row numbers per group\ngroup_by(id) %&gt;% mutate(dup = row_number())\nLabel duplicates within each ID\n\n\nCheck duplication status\ntable(df$dup) or sum(dup &gt;= 2)\nSummarise duplication pattern\n\n\nSubset for review\nsubset(df, dup == 2)\nView specific duplicates for manual inspection\n\n\nFilter duplicated individuals\nfilter(n() &gt; 1)\nExtract only duplicated IDs\n\n\nRemove duplicates\nfilter(!(dup &gt;= 2))\nKeep only the first instance per group (if needed)\n\n\nClean temporary object\nrm()\nRemove intermediate datasets from environment\n\n\n\nThis setup ensures duplicates are clearly identified, reviewed, and removed where appropriate.\n\npatients &lt;- patients %&gt;%\n  mutate(\n    birthdate = as.Date(birthdate),\n    id_text = paste0(substr(first, 1, 4), \"|\", substr(last, 1, 4), \"|\", birthdate)\n  )\n# Preview new ID\nhead(patients$id_text, n = 3)\n\n[1] \"Josh|Kund|1994-02-06\" \"Benn|Eber|1968-08-06\" \"Hunt|Gerl|2008-12-21\"\n\n# --- Step 2: Create random numeric ID per individual ---\nset.seed(1234)  # for reproducibility\npatients &lt;- patients %&gt;%\n  mutate(id_num = sample(100000:999999, n(), replace = FALSE))\n\n# Preview both ID columns\npatients %&gt;%\n  select(first, last, birthdate, id_text, id_num) %&gt;%\n  head(5)\n\n      first          last  birthdate              id_text id_num\n1 Joshua658      Kunde533 1994-02-06 Josh|Kund|1994-02-06 861679\n2 Bennie663      Ebert178 1968-08-06 Benn|Eber|1968-08-06 730677\n3 Hunter736    Gerlach374 2008-12-21 Hunt|Gerl|2008-12-21 404107\n4 Carlyn477 Williamson769 1994-01-27 Carl|Will|1994-01-27 395845\n5   Robin66  Gleichner915 2019-07-27 Robi|Glei|2019-07-27 226054\n\n# ....................................................\n# Clean-up if needed\n# ....................................................\n# rm(id_text, id_num) # optional if you store externally\n\ntable (patients$race)\n\n\n asian  black native  other  white \n     8      6      1      3     88 \n\notherrace &lt;- patients %&gt;%\n  filter(race != \"white\")\n\npatients &lt;- rbind(patients, otherrace)\n\n# Count total and unique records\nn_total &lt;- nrow(patients)\nn_unique &lt;- n_distinct(patients$id_text)\nmessage(glue::glue(\"Total records: {n_total}, Unique IDs: {n_unique}\"))\n\nTotal records: 124, Unique IDs: 106\n\n# Tag duplicates using row_number()\npatients &lt;- patients %&gt;%\n  arrange(id_text) %&gt;%\n  group_by(id_text) %&gt;%\n  mutate(dup = row_number()) %&gt;%\n  ungroup()\n# Count number of true duplicates\ntable(patients$dup)\n\n\n  1   2 \n106  18 \n\nprint(sum(patients$dup &gt;= 2))\n\n[1] 18\n\n# Keep only records from individuals who have duplicates\nduplicates &lt;- patients %&gt;%\n  group_by(id_text) %&gt;%\n  filter(n() &gt;= 2) %&gt;%\n  select(id_text, id_num, race, marital, gender, birthdate) %&gt;%\n  ungroup()\n\n# Preview records from duplicated individuals\nhead(duplicates)\n\n# A tibble: 6 √ó 6\n  id_text              id_num race  marital gender birthdate \n  &lt;chr&gt;                 &lt;int&gt; &lt;chr&gt; &lt;chr&gt;   &lt;chr&gt;  &lt;date&gt;    \n1 Alen|Gusi|1927-03-20 361202 other M       F      1927-03-20\n2 Alen|Gusi|1927-03-20 361202 other M       F      1927-03-20\n3 Bert|Alem|1983-05-07 513589 black M       F      1983-05-07\n4 Bert|Alem|1983-05-07 513589 black M       F      1983-05-07\n5 Blan|Rein|1951-11-22 465318 asian S       F      1951-11-22\n6 Blan|Rein|1951-11-22 465318 asian S       F      1951-11-22\n\nrm(duplicates, n_total, n_unique)\n\n\n\n\n\nleft_join(), right_join(), inner_join(), full_join()\nsemi_join() and anti_join()\nbind_rows(), rbind() , bind_cols() and cbind()\n\nWhen analyzing real-world datasets, it‚Äôs often necessary to merge or append multiple datasets.\nThis could involve matching rows based on common identifiers, appending additional cases, or combining variables side-by-side.\nWe can join, bind, or filter datasets efficiently using dplyr and base R techniques.\nBrief Descriptions\n\nleft_join(): Keep all records from the left (main) table; bring matching records from the right table.\nright_join(): Keep all records from the right table; bring matching records from the left.\ninner_join(): Keep only rows where keys match in both tables.\nfull_join(): Keep all records from both tables; missing matches filled with NA.\nsemi_join(): Keep rows from the left table where a match exists in the right.\nanti_join(): Keep only rows from the left table that don‚Äôt match the right.\n\n‚û°Ô∏è bind_rows() and rbind() are used for stacking datasets.\n‚û°Ô∏è bind_cols() and cbind() are used for attaching new columns horizontally.\nSummary Table: Key Functions for Joining and Appending\n\n\n\n\n\n\n\n\nTask\nFunction\nPurpose\n\n\n\n\nMerge by common key\nleft_join(), right_join(), inner_join(), full_join()\nMerge datasets using common variables\n\n\nFilter matching rows\nsemi_join()\nKeep rows from left table that have matches in right table\n\n\nFilter non-matching rows\nanti_join()\nKeep rows from left table with no match in right table\n\n\nRow-wise append\nbind_rows()\nStack two datasets vertically (must have same columns)\n\n\nColumn-wise append\nbind_cols()\nAdd columns side-by-side (matching by row position)\n\n\nBasic base R row bind\nrbind()\nAppend rows (base R equivalent to bind_rows)\n\n\nBasic base R column bind\ncbind()\nAppend columns (base R equivalent to bind_cols)\n\n\nJoin a table to itself\nSelf-join\nAnalyze relationships within a single dataset (e.g., hierarchy)\n\n\n\n\nImportant Reminders - Joins (left_join, etc.) match based on a key (column/s). - bind_rows() assumes same column names and types. - bind_cols() assumes same number of rows. - rbind() and cbind() are base R methods but dplyr::bind_*() are more flexible. ‚Äî\nDemonstrating Different Types of Joins with Brief Descriptions\nStandardizing variable Names\nBefore performing joins, it is essential to ensure column names match in both datasets.\nThis avoids errors caused by case differences or inconsistent naming.\n\n# ......................................\n# Full Join: Keep everything from both datasets\n# ......................................\nvacc_full_join &lt;- full_join(\n  patients,\n  vaccination,\n  by = c(\"id\" = \"patient\")\n)\n\nhead(vacc_full_join, n = 3)\n\n                                    id  birthdate deathdate         ssn\n1 30a6452c-4297-a1ac-977a-6a23237c7b46 1994-02-06           999-52-8591\n2 30a6452c-4297-a1ac-977a-6a23237c7b46 1994-02-06           999-52-8591\n3 30a6452c-4297-a1ac-977a-6a23237c7b46 1994-02-06           999-52-8591\n    drivers   passport prefix     first  middle     last suffix maiden marital\n1 S99996852 X47758697X    Mr. Joshua658 Alvin56 Kunde533     NA              M\n2 S99996852 X47758697X    Mr. Joshua658 Alvin56 Kunde533     NA              M\n3 S99996852 X47758697X    Mr. Joshua658 Alvin56 Kunde533     NA              M\n   race   ethnicity gender                birthplace          address      city\n1 white nonhispanic      M Boston  Massachusetts  US 811 Kihn Viaduct Braintree\n2 white nonhispanic      M Boston  Massachusetts  US 811 Kihn Viaduct Braintree\n3 white nonhispanic      M Boston  Massachusetts  US 811 Kihn Viaduct Braintree\n          state         county  fips  zip      lat      lon healthcare_expenses\n1 Massachusetts Norfolk County 25021 2184 42.21114 -71.0458            56904.96\n2 Massachusetts Norfolk County 25021 2184 42.21114 -71.0458            56904.96\n3 Massachusetts Norfolk County 25021 2184 42.21114 -71.0458            56904.96\n  healthcare_coverage income                 date\n1            18019.99 100511 2016-04-10T09:04:48Z\n2            18019.99 100511 2016-04-10T09:04:48Z\n3            18019.99 100511 2016-04-10T09:04:48Z\n                             encounter code\n1 0b03e41b-06a6-66fa-b972-acc5a83b134a  140\n2 0b03e41b-06a6-66fa-b972-acc5a83b134a  113\n3 0b03e41b-06a6-66fa-b972-acc5a83b134a   43\n                                                   description base_cost\n1           Influenza  seasonal  injectable  preservative free       136\n2 Td (adult)  5 Lf tetanus toxoid  preservative free  adsorbed       136\n3                                                 Hep B  adult       136\n\n# ......................................\n# Left Join: Keep all patients, add vaccination if available\n# ......................................\nvacc_left_join &lt;- left_join(\n  patients,\n  vaccination,\n  by = c(\"id\" = \"patient\")\n)\n\nhead(vacc_left_join, n = 3)\n\n                                    id  birthdate deathdate         ssn\n1 30a6452c-4297-a1ac-977a-6a23237c7b46 1994-02-06           999-52-8591\n2 30a6452c-4297-a1ac-977a-6a23237c7b46 1994-02-06           999-52-8591\n3 30a6452c-4297-a1ac-977a-6a23237c7b46 1994-02-06           999-52-8591\n    drivers   passport prefix     first  middle     last suffix maiden marital\n1 S99996852 X47758697X    Mr. Joshua658 Alvin56 Kunde533     NA              M\n2 S99996852 X47758697X    Mr. Joshua658 Alvin56 Kunde533     NA              M\n3 S99996852 X47758697X    Mr. Joshua658 Alvin56 Kunde533     NA              M\n   race   ethnicity gender                birthplace          address      city\n1 white nonhispanic      M Boston  Massachusetts  US 811 Kihn Viaduct Braintree\n2 white nonhispanic      M Boston  Massachusetts  US 811 Kihn Viaduct Braintree\n3 white nonhispanic      M Boston  Massachusetts  US 811 Kihn Viaduct Braintree\n          state         county  fips  zip      lat      lon healthcare_expenses\n1 Massachusetts Norfolk County 25021 2184 42.21114 -71.0458            56904.96\n2 Massachusetts Norfolk County 25021 2184 42.21114 -71.0458            56904.96\n3 Massachusetts Norfolk County 25021 2184 42.21114 -71.0458            56904.96\n  healthcare_coverage income                 date\n1            18019.99 100511 2016-04-10T09:04:48Z\n2            18019.99 100511 2016-04-10T09:04:48Z\n3            18019.99 100511 2016-04-10T09:04:48Z\n                             encounter code\n1 0b03e41b-06a6-66fa-b972-acc5a83b134a  140\n2 0b03e41b-06a6-66fa-b972-acc5a83b134a  113\n3 0b03e41b-06a6-66fa-b972-acc5a83b134a   43\n                                                   description base_cost\n1           Influenza  seasonal  injectable  preservative free       136\n2 Td (adult)  5 Lf tetanus toxoid  preservative free  adsorbed       136\n3                                                 Hep B  adult       136\n\n# ......................................\n# Right Join: Keep all vaccinations, add patients if available\n# ......................................\nvacc_right_join &lt;- right_join(\n  patients,\n  vaccination,\n  by = c(\"id\" = \"patient\")\n)\n\nhead(vacc_right_join, n = 3)\n\n                                    id  birthdate deathdate         ssn\n1 30a6452c-4297-a1ac-977a-6a23237c7b46 1994-02-06           999-52-8591\n2 30a6452c-4297-a1ac-977a-6a23237c7b46 1994-02-06           999-52-8591\n3 30a6452c-4297-a1ac-977a-6a23237c7b46 1994-02-06           999-52-8591\n    drivers   passport prefix     first  middle     last suffix maiden marital\n1 S99996852 X47758697X    Mr. Joshua658 Alvin56 Kunde533     NA              M\n2 S99996852 X47758697X    Mr. Joshua658 Alvin56 Kunde533     NA              M\n3 S99996852 X47758697X    Mr. Joshua658 Alvin56 Kunde533     NA              M\n   race   ethnicity gender                birthplace          address      city\n1 white nonhispanic      M Boston  Massachusetts  US 811 Kihn Viaduct Braintree\n2 white nonhispanic      M Boston  Massachusetts  US 811 Kihn Viaduct Braintree\n3 white nonhispanic      M Boston  Massachusetts  US 811 Kihn Viaduct Braintree\n          state         county  fips  zip      lat      lon healthcare_expenses\n1 Massachusetts Norfolk County 25021 2184 42.21114 -71.0458            56904.96\n2 Massachusetts Norfolk County 25021 2184 42.21114 -71.0458            56904.96\n3 Massachusetts Norfolk County 25021 2184 42.21114 -71.0458            56904.96\n  healthcare_coverage income                 date\n1            18019.99 100511 2016-04-10T09:04:48Z\n2            18019.99 100511 2016-04-10T09:04:48Z\n3            18019.99 100511 2016-04-10T09:04:48Z\n                             encounter code\n1 0b03e41b-06a6-66fa-b972-acc5a83b134a  140\n2 0b03e41b-06a6-66fa-b972-acc5a83b134a  113\n3 0b03e41b-06a6-66fa-b972-acc5a83b134a   43\n                                                   description base_cost\n1           Influenza  seasonal  injectable  preservative free       136\n2 Td (adult)  5 Lf tetanus toxoid  preservative free  adsorbed       136\n3                                                 Hep B  adult       136\n\n# ......................................\n# Inner Join: Keep only matched patients and vaccinations\n# ......................................\nvacc_inner_join &lt;- inner_join(\n  patients,\n  vaccination,\n  by = c(\"id\" = \"patient\"))\n\nhead(vacc_inner_join, n = 3)\n\n                                    id  birthdate deathdate         ssn\n1 30a6452c-4297-a1ac-977a-6a23237c7b46 1994-02-06           999-52-8591\n2 30a6452c-4297-a1ac-977a-6a23237c7b46 1994-02-06           999-52-8591\n3 30a6452c-4297-a1ac-977a-6a23237c7b46 1994-02-06           999-52-8591\n    drivers   passport prefix     first  middle     last suffix maiden marital\n1 S99996852 X47758697X    Mr. Joshua658 Alvin56 Kunde533     NA              M\n2 S99996852 X47758697X    Mr. Joshua658 Alvin56 Kunde533     NA              M\n3 S99996852 X47758697X    Mr. Joshua658 Alvin56 Kunde533     NA              M\n   race   ethnicity gender                birthplace          address      city\n1 white nonhispanic      M Boston  Massachusetts  US 811 Kihn Viaduct Braintree\n2 white nonhispanic      M Boston  Massachusetts  US 811 Kihn Viaduct Braintree\n3 white nonhispanic      M Boston  Massachusetts  US 811 Kihn Viaduct Braintree\n          state         county  fips  zip      lat      lon healthcare_expenses\n1 Massachusetts Norfolk County 25021 2184 42.21114 -71.0458            56904.96\n2 Massachusetts Norfolk County 25021 2184 42.21114 -71.0458            56904.96\n3 Massachusetts Norfolk County 25021 2184 42.21114 -71.0458            56904.96\n  healthcare_coverage income                 date\n1            18019.99 100511 2016-04-10T09:04:48Z\n2            18019.99 100511 2016-04-10T09:04:48Z\n3            18019.99 100511 2016-04-10T09:04:48Z\n                             encounter code\n1 0b03e41b-06a6-66fa-b972-acc5a83b134a  140\n2 0b03e41b-06a6-66fa-b972-acc5a83b134a  113\n3 0b03e41b-06a6-66fa-b972-acc5a83b134a   43\n                                                   description base_cost\n1           Influenza  seasonal  injectable  preservative free       136\n2 Td (adult)  5 Lf tetanus toxoid  preservative free  adsorbed       136\n3                                                 Hep B  adult       136\n\n# ......................................\n# Semi Join: Keep only patients that have a vaccination match\n# (Only patient columns are kept)\n# ......................................\n\nvacc_semi_join &lt;- semi_join(\n  patients,\n  vaccination,\n  by = c(\"id\" = \"patient\"))\n\nhead(vacc_semi_join, n = 3)\n\n                                    id  birthdate  deathdate         ssn\n1 30a6452c-4297-a1ac-977a-6a23237c7b46 1994-02-06            999-52-8591\n2 34a4dcc4-35fb-6ad5-ab98-be285c586a4f 1968-08-06 2009-12-11 999-75-3953\n3 7179458e-d6e3-c723-2530-d4acfe1c2668 2008-12-21            999-70-1925\n    drivers   passport prefix     first      middle       last suffix maiden\n1 S99996852 X47758697X    Mr. Joshua658     Alvin56   Kunde533     NA       \n2 S99993577 X28173268X    Mr. Bennie663               Ebert178     NA       \n3                             Hunter736 Mckinley734 Gerlach374     NA       \n  marital  race   ethnicity gender                  birthplace\n1       M white nonhispanic      M   Boston  Massachusetts  US\n2       D white nonhispanic      M Chicopee  Massachusetts  US\n3         white nonhispanic      M  Spencer  Massachusetts  US\n                      address         city         state          county  fips\n1            811 Kihn Viaduct    Braintree Massachusetts  Norfolk County 25021\n2 975 Pfannerstill Throughway    Braintree Massachusetts  Norfolk County 25021\n3             548 Heller Lane Mattapoisett Massachusetts Plymouth County    NA\n   zip      lat       lon healthcare_expenses healthcare_coverage income\n1 2184 42.21114 -71.04580            56904.96            18019.99 100511\n2 2184 42.25542 -70.97102           124024.12             1075.06  49737\n3    0 41.64829 -70.85062            45645.06             6154.94 133816\n\n# ......................................\n# Anti Join: Keep only patients that do not have a vaccination match\n# ......................................\nvacc_anti_join &lt;- anti_join(\n  patients,\n  vaccination,\n  by = c(\"id\" = \"patient\"))\n\nhead(vacc_anti_join, n = 3)\n\n [1] id                  birthdate           deathdate          \n [4] ssn                 drivers             passport           \n [7] prefix              first               middle             \n[10] last                suffix              maiden             \n[13] marital             race                ethnicity          \n[16] gender              birthplace          address            \n[19] city                state               county             \n[22] fips                zip                 lat                \n[25] lon                 healthcare_expenses healthcare_coverage\n[28] income             \n&lt;0 rows&gt; (or 0-length row.names)\n\n# ......................................\n# Remove temporary datasets\n# ......................................\nrm(vacc_left_join, vacc_right_join, vacc_inner_join, vacc_full_join, vacc_semi_join, vacc_anti_join)\n\nAppending (Binding) DataFrames: Rows and Columns\n\n# Binding Rows Together (bind_rows): Combine NSW, WA, and Others into one dataset\n\nbc_combined_rows &lt;- bind_rows(\n  breast_cancer_NSW,\n  breast_cancer_WA,\n  breast_cancer_others\n)\n\n# Check result\nhead(bc_combined_rows, n = 3)\n\n  sa3code sa3coden    sa3name state   year part50_74 pop50_74 rate50_74\n1   10102    10102 Queanbeyan   NSW 201617      4875     8052  60.50000\n2   10102    10102 Queanbeyan   NSW 201718      5048     8309  60.75961\n3   10102    10102 Queanbeyan   NSW 201819      5276     8588  61.43839\n  agen50_74 expct50_74 part50_69 pop50_69 rate50_69 agen50_69 expct50_69\n1         3       4428      4309     7145  60.30000         2       3929\n2         3       4553      4448     7338  60.62238         2       4013\n3         3       4706      4629     7548  61.33203         2       4113\n  part50_54 pop50_54 rate50_54 agen50_54 expct50_54 part55_59 pop55_59\n1      1284     2251  57.00000         1       1118      1188     1970\n2      1285     2306  55.72035         1       1143      1260     2030\n3      1375     2342  58.70977         1       1166      1252     2093\n  rate55_59 agen55_59 expct55_59 part60_64 pop60_64 rate60_64 agen60_64\n1  60.30000         4       1046      1012     1625  62.30000         5\n2  62.09035         4       1069      1048     1646  63.69947         5\n3  59.81504         4       1098      1105     1689  65.43657         5\n  expct60_64 part65_69 pop65_69 rate65_69 agen65_69 expct65_69 part70_74\n1        950       826     1300  63.50000         6        781       566\n2        953       855     1357  63.02558         6        812       600\n3        967       898     1426  63.00429         6        849       647\n  pop70_74 rate70_74 agen70_74 expct70_74\n1      907  62.40000         7        498\n2      971  61.79725         7        541\n3     1040  62.21032         7        585\n\n# Confirm number of rows\nnrow(bc_combined_rows)\n\n[1] 1364\n\n# Binding Columns Together (bind_cols): Combine Participation Data with SA3 metadata\n# (needs same number of rows)\n\nbc_combined_cols &lt;- bind_cols(\n  participation,\n  breast_cancer_SA3_info )\n# Check result\nhead(bc_combined_cols, n = 3)\n\n    year part50_74 pop50_74 rate50_74 agen50_74 expct50_74 part50_69 pop50_69\n1 201617      4875     8052  60.50000         3       4428      4309     7145\n2 201718      5048     8309  60.75961         3       4553      4448     7338\n3 201819      5276     8588  61.43839         3       4706      4629     7548\n  rate50_69 agen50_69 expct50_69 part50_54 pop50_54 rate50_54 agen50_54\n1  60.30000         2       3929      1284     2251  57.00000         1\n2  60.62238         2       4013      1285     2306  55.72035         1\n3  61.33203         2       4113      1375     2342  58.70977         1\n  expct50_54 part55_59 pop55_59 rate55_59 agen55_59 expct55_59 part60_64\n1       1118      1188     1970  60.30000         4       1046      1012\n2       1143      1260     2030  62.09035         4       1069      1048\n3       1166      1252     2093  59.81504         4       1098      1105\n  pop60_64 rate60_64 agen60_64 expct60_64 part65_69 pop65_69 rate65_69\n1     1625  62.30000         5        950       826     1300  63.50000\n2     1646  63.69947         5        953       855     1357  63.02558\n3     1689  65.43657         5        967       898     1426  63.00429\n  agen65_69 expct65_69 part70_74 pop70_74 rate70_74 agen70_74 expct70_74\n1         6        781       566      907  62.40000         7        498\n2         6        812       600      971  61.79725         7        541\n3         6        849       647     1040  62.21032         7        585\n  sa3code sa3coden    sa3name state\n1   10102    10102 Queanbeyan   NSW\n2   10102    10102 Queanbeyan   NSW\n3   10102    10102 Queanbeyan   NSW\n\n# Appending Rows Using Base R rbind()\n# (Equivalent to bind_rows but simpler cases, needs identical columns)\nbc_combined_rbind &lt;- rbind(\n  breast_cancer_NSW,\n  breast_cancer_WA\n)\n\n# Check result\nhead(bc_combined_rbind, n = 3)\n\n  sa3code sa3coden    sa3name state   year part50_74 pop50_74 rate50_74\n1   10102    10102 Queanbeyan   NSW 201617      4875     8052  60.50000\n2   10102    10102 Queanbeyan   NSW 201718      5048     8309  60.75961\n3   10102    10102 Queanbeyan   NSW 201819      5276     8588  61.43839\n  agen50_74 expct50_74 part50_69 pop50_69 rate50_69 agen50_69 expct50_69\n1         3       4428      4309     7145  60.30000         2       3929\n2         3       4553      4448     7338  60.62238         2       4013\n3         3       4706      4629     7548  61.33203         2       4113\n  part50_54 pop50_54 rate50_54 agen50_54 expct50_54 part55_59 pop55_59\n1      1284     2251  57.00000         1       1118      1188     1970\n2      1285     2306  55.72035         1       1143      1260     2030\n3      1375     2342  58.70977         1       1166      1252     2093\n  rate55_59 agen55_59 expct55_59 part60_64 pop60_64 rate60_64 agen60_64\n1  60.30000         4       1046      1012     1625  62.30000         5\n2  62.09035         4       1069      1048     1646  63.69947         5\n3  59.81504         4       1098      1105     1689  65.43657         5\n  expct60_64 part65_69 pop65_69 rate65_69 agen65_69 expct65_69 part70_74\n1        950       826     1300  63.50000         6        781       566\n2        953       855     1357  63.02558         6        812       600\n3        967       898     1426  63.00429         6        849       647\n  pop70_74 rate70_74 agen70_74 expct70_74\n1      907  62.40000         7        498\n2      971  61.79725         7        541\n3     1040  62.21032         7        585\n\n# Appending Columns Using Base R cbind()\n# (Simple column binding, assumes same number of rows)\n\nbc_combined_cbind &lt;- cbind(\n  participation,\n  breast_cancer_SA3_info)\n\n# Check result\nhead(bc_combined_cbind, n = 3)\n\n    year part50_74 pop50_74 rate50_74 agen50_74 expct50_74 part50_69 pop50_69\n1 201617      4875     8052  60.50000         3       4428      4309     7145\n2 201718      5048     8309  60.75961         3       4553      4448     7338\n3 201819      5276     8588  61.43839         3       4706      4629     7548\n  rate50_69 agen50_69 expct50_69 part50_54 pop50_54 rate50_54 agen50_54\n1  60.30000         2       3929      1284     2251  57.00000         1\n2  60.62238         2       4013      1285     2306  55.72035         1\n3  61.33203         2       4113      1375     2342  58.70977         1\n  expct50_54 part55_59 pop55_59 rate55_59 agen55_59 expct55_59 part60_64\n1       1118      1188     1970  60.30000         4       1046      1012\n2       1143      1260     2030  62.09035         4       1069      1048\n3       1166      1252     2093  59.81504         4       1098      1105\n  pop60_64 rate60_64 agen60_64 expct60_64 part65_69 pop65_69 rate65_69\n1     1625  62.30000         5        950       826     1300  63.50000\n2     1646  63.69947         5        953       855     1357  63.02558\n3     1689  65.43657         5        967       898     1426  63.00429\n  agen65_69 expct65_69 part70_74 pop70_74 rate70_74 agen70_74 expct70_74\n1         6        781       566      907  62.40000         7        498\n2         6        812       600      971  61.79725         7        541\n3         6        849       647     1040  62.21032         7        585\n  sa3code sa3coden    sa3name state\n1   10102    10102 Queanbeyan   NSW\n2   10102    10102 Queanbeyan   NSW\n3   10102    10102 Queanbeyan   NSW\n\n# Important Notes:\n# - bind_rows() can handle different column orders safely\n# - rbind() requires identical column names and order\n# - bind_cols() simply pastes side-by-side, no matching by keys\n# - cbind() assumes same number of rows\n\n# ....................................................\n# Remove all temporary objects created in this chunk\n# ....................................................\nrm(\n  breast_cancer_NSW, breast_cancer_WA, breast_cancer_others, participation, breast_cancer_SA3_info,\n  bc_combined_rows, bc_combined_cols, bc_combined_rbind, bc_combined_cbind\n)\n\n\n\n\nA. Identifying Missing Values\n\nis.na(), anyNA(), sum(is.na(x)), colSums() ‚Äì detect/count missing values\ncomplete.cases() ‚Äì filter complete rows\nConvert blanks to NA: x[x == ‚Äú‚Äú] &lt;- NA\n\nB. Handling Missing Values\n\nBasic Removal/Replacement: na.omit(), replace_na() (tidyr), ifelse()\nForward/Backward Fill: fill() (tidyr) with .direction = ‚Äúdown‚Äù / ‚Äúup‚Äù\nStatistical Imputation:\n\n-Simple: mean/median imputation\n-Multiple: mice::mice()()\n-Advanced: Hmisc::aregImpute, missForest, Amelia, zoo::na.fill\nMissing data is a common issue in real-world datasets. In R, handling missing values properly is essential to ensure the integrity of analyses and avoid misleading results.\nThis section covers how to identify, clean, and impute missing values using base R and tidyverse tools. Techniques range from basic filtering to advanced imputation models.\n‚û°Ô∏è Missing values are typically represented as NA in R. Empty strings (e.g., \"\") or special codes (e.g., -99, \"missing\") may also indicate missingness and need conversion before analysis.\nüîπ Summary of Functions for Handling Missing Values\n\n\n\n\n\n\n\n\nTask\nFunction / Code\nPurpose\n\n\n\n\nDetect missing values\nis.na(x), anyNA(x), sum(is.na(x))\nIdentify/count missing values\n\n\nMissing per column\ncolSums(is.na(df))\nCount NAs per column\n\n\nFilter complete rows\ncomplete.cases(df)\nKeep only rows without any missing values\n\n\nConvert blanks to NA\nx[x == \"\"] &lt;- NA\nConvert empty strings to missing values\n\n\nRemove missing rows\nna.omit(df)\nRemove rows with any missing value\n\n\nReplace missing values\nreplace_na(df, list(...)), ifelse(is.na(x), ...)\nImpute or replace NA with custom logic\n\n\nForward/backward fill\nfill(df, .direction = \"down\" / \"up\")\nFill NA using nearby values\n\n\nMean/median imputation\nx[is.na(x)] &lt;- mean(x, na.rm = TRUE)\nReplace NA with summary statistic\n\n\nMultiple imputation\nmice::mice(df)\nCreate multiple imputed datasets using chained equations\n\n\nAdvanced imputation\nHmisc::aregImpute, missForest, Amelia, zoo::na.fill()\nSpecialized techniques for complex imputations\n\n\n\nüìö Further Learning and Resources\nAdditional tutorials, demonstrations, and datasets are available on:\n\nYouTube Channel ‚Äì AnalyticsHub\nhttps://studio.youtube.com/channel/UCLVKP0g8GvHhOh0kn20T8eg/videos/upload?filter=%5B%5D&sort=%7B%22columnType%22%3A%22date%22%2C%22sortOrder%22%3A%22DESCENDING%22%7D\nGitHub Repository\nhttps://github.com/HabtamuBizuayehu?tab=repositories\n\n\n\n\n                                    id  birthdate deathdate         ssn\n1 898a6256-7ffb-dbe2-e24d-12fda2fedcfd 1966-06-23           999-98-5513\n2 5e0a6984-38d7-c604-f55f-f1de5e933768 1986-07-04           999-58-5560\n3 e335de09-0994-4111-3c15-6edcc17ae4bc 2005-04-25           999-48-3846\n4 45b89342-dc05-8e57-8eee-9ed68ec42378 1984-08-24           999-40-3433\n5 916b1ac8-56c8-ec1b-3b9a-721336a74912 1953-05-10           999-16-3735\n6 dc323bce-e583-d903-303e-9c865bc87e67 2012-09-02           999-90-3605\n    drivers   passport prefix     first     middle          last suffix\n1 S99971131 X62454905X   Mrs.  Maris768              Lindgren255     NA\n2 S99931679 X61479569X   Mrs. Hattie299  Reatha769      Nader710     NA\n3 S99958413               Ms.  Jimmie93 Towanda270      Doyle959     NA\n4 S99985178 X27670495X    Mr. Dwight645  Marlin805      Hilll811     NA\n5 S99968840 X83646024X    Ms.  Tambra47 Brittni468 Balistreri607     NA\n6                             Carson894 Raphael767     Littel644     NA\n     maiden marital  race   ethnicity gender                       birthplace\n1   Dach178       D white nonhispanic      F        Oxford  Massachusetts  US\n2 Harber290       M white nonhispanic      F North Reading  Massachusetts  US\n3                   white nonhispanic      F        Boston  Massachusetts  US\n4                 M white nonhispanic      M    Framingham  Massachusetts  US\n5                 S white nonhispanic      F     Lexington  Massachusetts  US\n6                   white nonhispanic      M      Plymouth  Massachusetts  US\n                        address        city         state           county\n1          962 Stiedemann Vista    Aquinnah Massachusetts     Dukes County\n2            720 O'Keefe Arcade      Newton Massachusetts Middlesex County\n3       493 Cruickshank Mission   Holliston Massachusetts Middlesex County\n4              810 Wolf Pathway      Malden Massachusetts Middlesex County\n5      146 Rowe Village Suite 3 New Bedford Massachusetts   Bristol County\n6 467 Collier Stravenue Unit 12   Attleboro Massachusetts   Bristol County\n   fips  zip      lat       lon healthcare_expenses healthcare_coverage income\n1    NA    0 41.29618 -70.77458           343608.18           884243.46 178323\n2 25017 2468 42.29180 -71.14930           169293.06           801407.90  86384\n3    NA    0 42.24196 -71.46440            64178.99             5906.14 198522\n4 25017 2148 42.43610 -71.14328            36010.63           472861.90  25909\n5 25005 2743 41.69576 -71.01391           281198.90           310261.21 140772\n6 44007 2861 41.94870 -71.30420            45972.75                0.00  71169\n  visit\n1     1\n2     1\n3     1\n4     1\n5     1\n6     1\n\n\n\n# Summarise missing values across all columns\nmissing_summary &lt;- colSums(is.na(visits_all))\nprint(missing_summary[missing_summary &gt; 0])\n\n          deathdate             drivers            passport              prefix \n                 40                   4                  12                   8 \n             middle              suffix              maiden             marital \n                  4                  40                  28                  16 \n               race                fips                 zip healthcare_coverage \n                 20                  12                  12                   4 \n             income \n                 20 \n\n# Total number of missing cells\ntotal_missing &lt;- sum(is.na(visits_all))\ncat(\"Total missing values in dataset:\", total_missing, \"\\n\")\n\nTotal missing values in dataset: 220 \n\n# Count of individuals with at least one missing value\nn_missing_individuals &lt;- sum(!complete.cases(visits_all))\ncat(\"Number of individuals with at least one missing value:\", n_missing_individuals, \"\\n\")\n\nNumber of individuals with at least one missing value: 40 \n\n# Sort records by patient ID and visit number\nvisits_all &lt;- visits_all %&gt;%\n  arrange(id_text, visit)\n\n# View rows with any missing values\nmissing_rows &lt;- visits_all %&gt;%\n  filter(!complete.cases(.))\nhead(missing_rows, n = 12) %&gt;% select(id_text, race, income, passport)\n\n                id_text  race income   passport\n1  Anit|S√°nc|1960-05-07 white  61016  X9157439X\n2  Anit|S√°nc|1960-05-07  &lt;NA&gt;     NA  X9157439X\n3  Anit|S√°nc|1960-05-07 white     NA  X9157439X\n4  Anit|S√°nc|1960-05-07  &lt;NA&gt;  60016  X9157439X\n5  Aure|Weis|2003-11-12 white   8752 X17586296X\n6  Aure|Weis|2003-11-12  &lt;NA&gt;     NA X17586296X\n7  Aure|Weis|2003-11-12 white     NA X17586296X\n8  Aure|Weis|2003-11-12  &lt;NA&gt;   7752 X17586296X\n9  Cars|Litt|2012-09-02 white  71169       &lt;NA&gt;\n10 Cars|Litt|2012-09-02  &lt;NA&gt;     NA       &lt;NA&gt;\n11 Cars|Litt|2012-09-02  &lt;NA&gt;  70169       &lt;NA&gt;\n12 Cars|Litt|2012-09-02 white     NA       &lt;NA&gt;\n\n# Impute passport with \"UNKNOWN\"\ndf_passport &lt;- visits_all %&gt;%\n  mutate(passport_imputed = replace_na(passport, \"UNKNOWN\")) %&gt;%\n  filter(is.na(passport)) %&gt;%\n  select(id, id_text, visit, passport, passport_imputed)\n\nhead(df_passport, n = 12)\n\n                                     id              id_text visit passport\n1  dc323bce-e583-d903-303e-9c865bc87e67 Cars|Litt|2012-09-02     1     &lt;NA&gt;\n2  dc323bce-e583-d903-303e-9c865bc87e67 Cars|Litt|2012-09-02     2     &lt;NA&gt;\n3  dc323bce-e583-d903-303e-9c865bc87e67 Cars|Litt|2012-09-02     3     &lt;NA&gt;\n4  dc323bce-e583-d903-303e-9c865bc87e67 Cars|Litt|2012-09-02     4     &lt;NA&gt;\n5  da7b1f55-c782-544f-ba8c-fe69d519dc85 Doll|Fran|2008-10-04     1     &lt;NA&gt;\n6  da7b1f55-c782-544f-ba8c-fe69d519dc85 Doll|Fran|2008-10-04     2     &lt;NA&gt;\n7  da7b1f55-c782-544f-ba8c-fe69d519dc85 Doll|Fran|2008-10-04     3     &lt;NA&gt;\n8  da7b1f55-c782-544f-ba8c-fe69d519dc85 Doll|Fran|2008-10-04     4     &lt;NA&gt;\n9  e335de09-0994-4111-3c15-6edcc17ae4bc Jimm|Doyl|2005-04-25     1     &lt;NA&gt;\n10 e335de09-0994-4111-3c15-6edcc17ae4bc Jimm|Doyl|2005-04-25     2     &lt;NA&gt;\n11 e335de09-0994-4111-3c15-6edcc17ae4bc Jimm|Doyl|2005-04-25     3     &lt;NA&gt;\n12 e335de09-0994-4111-3c15-6edcc17ae4bc Jimm|Doyl|2005-04-25     4     &lt;NA&gt;\n   passport_imputed\n1           UNKNOWN\n2           UNKNOWN\n3           UNKNOWN\n4           UNKNOWN\n5           UNKNOWN\n6           UNKNOWN\n7           UNKNOWN\n8           UNKNOWN\n9           UNKNOWN\n10          UNKNOWN\n11          UNKNOWN\n12          UNKNOWN\n\n# Sort records by patient ID and visit number (to prepare for forward/backward fill)\nvisits_all &lt;- visits_all %&gt;%\n  arrange(id_text, visit)\n\n# Preview sorted data (tail)\ntail(visits_all %&gt;% select(id_text, visit, race, income), n = 12)\n\n                id_text visit  race income\n29 Jimm|Doyl|2005-04-25     1 white 198522\n30 Jimm|Doyl|2005-04-25     2  &lt;NA&gt;     NA\n31 Jimm|Doyl|2005-04-25     3  &lt;NA&gt; 197522\n32 Jimm|Doyl|2005-04-25     4 white     NA\n33 Mari|Lind|1966-06-23     1 white 178323\n34 Mari|Lind|1966-06-23     2  &lt;NA&gt;     NA\n35 Mari|Lind|1966-06-23     3 white     NA\n36 Mari|Lind|1966-06-23     4  &lt;NA&gt; 177323\n37 Tamb|Bali|1953-05-10     1 white 140772\n38 Tamb|Bali|1953-05-10     2  &lt;NA&gt;     NA\n39 Tamb|Bali|1953-05-10     3 white     NA\n40 Tamb|Bali|1953-05-10     4  &lt;NA&gt; 139772\n\n# Forward fill missing race values within each patient (downward)\nvisits_all &lt;- visits_all %&gt;%\n  group_by(id_text) %&gt;%\n  mutate(race_forward = race) %&gt;%\n  fill(race_forward, .direction = \"down\") %&gt;%\n  ungroup()\n\n# Preview forward-filled race values (head)\nhead(visits_all %&gt;% select(id_text, visit, race, race_forward), n = 12)\n\n# A tibble: 12 √ó 4\n   id_text              visit race  race_forward\n   &lt;chr&gt;                &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt;       \n 1 Anit|S√°nc|1960-05-07     1 white white       \n 2 Anit|S√°nc|1960-05-07     2 &lt;NA&gt;  white       \n 3 Anit|S√°nc|1960-05-07     3 white white       \n 4 Anit|S√°nc|1960-05-07     4 &lt;NA&gt;  white       \n 5 Aure|Weis|2003-11-12     1 white white       \n 6 Aure|Weis|2003-11-12     2 &lt;NA&gt;  white       \n 7 Aure|Weis|2003-11-12     3 white white       \n 8 Aure|Weis|2003-11-12     4 &lt;NA&gt;  white       \n 9 Cars|Litt|2012-09-02     1 white white       \n10 Cars|Litt|2012-09-02     2 &lt;NA&gt;  white       \n11 Cars|Litt|2012-09-02     3 &lt;NA&gt;  white       \n12 Cars|Litt|2012-09-02     4 white white       \n\n# Backward fill missing race values within each patient (upward)\nvisits_all &lt;- visits_all %&gt;%\n  group_by(id_text) %&gt;%\n  mutate(race_backward = race) %&gt;%\n  fill(race_backward, .direction = \"up\") %&gt;%\n  ungroup()\n\n# Preview backward-filled race values (tail)\ntail(visits_all %&gt;% select(id_text, visit, race, race_backward), n = 12)\n\n# A tibble: 12 √ó 4\n   id_text              visit race  race_backward\n   &lt;chr&gt;                &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt;        \n 1 Jimm|Doyl|2005-04-25     1 white white        \n 2 Jimm|Doyl|2005-04-25     2 &lt;NA&gt;  white        \n 3 Jimm|Doyl|2005-04-25     3 &lt;NA&gt;  white        \n 4 Jimm|Doyl|2005-04-25     4 white white        \n 5 Mari|Lind|1966-06-23     1 white white        \n 6 Mari|Lind|1966-06-23     2 &lt;NA&gt;  white        \n 7 Mari|Lind|1966-06-23     3 white white        \n 8 Mari|Lind|1966-06-23     4 &lt;NA&gt;  &lt;NA&gt;         \n 9 Tamb|Bali|1953-05-10     1 white white        \n10 Tamb|Bali|1953-05-10     2 &lt;NA&gt;  white        \n11 Tamb|Bali|1953-05-10     3 white white        \n12 Tamb|Bali|1953-05-10     4 &lt;NA&gt;  &lt;NA&gt;         \n\n# Calculate the global (overall) mean income\nglobal_mean_income &lt;- mean(visits_all$income, na.rm = TRUE)\n\n# Use global mean to impute missing income values\nvisits_all &lt;- visits_all %&gt;%\n  mutate(income_global_mean = ifelse(is.na(income), global_mean_income, income))\n\n# Preview global mean-imputed income (head)\nhead(visits_all %&gt;% select(id_text, visit, income, income_global_mean), n = 12)\n\n# A tibble: 12 √ó 4\n   id_text              visit income income_global_mean\n   &lt;chr&gt;                &lt;dbl&gt;  &lt;dbl&gt;              &lt;dbl&gt;\n 1 Anit|S√°nc|1960-05-07     1  61016             61016 \n 2 Anit|S√°nc|1960-05-07     2     NA             96123.\n 3 Anit|S√°nc|1960-05-07     3     NA             96123.\n 4 Anit|S√°nc|1960-05-07     4  60016             60016 \n 5 Aure|Weis|2003-11-12     1   8752              8752 \n 6 Aure|Weis|2003-11-12     2     NA             96123.\n 7 Aure|Weis|2003-11-12     3     NA             96123.\n 8 Aure|Weis|2003-11-12     4   7752              7752 \n 9 Cars|Litt|2012-09-02     1  71169             71169 \n10 Cars|Litt|2012-09-02     2     NA             96123.\n11 Cars|Litt|2012-09-02     3  70169             70169 \n12 Cars|Litt|2012-09-02     4     NA             96123.\n\n# Calculate mean income per participant (id_text)\nparticipant_mean_income &lt;- visits_all %&gt;%\n  group_by(id_text) %&gt;%\n  summarise(mean_income_id = mean(income, na.rm = TRUE), .groups = \"drop\")\n\n# Use participant-level mean to impute missing income values\nvisits_all &lt;- visits_all %&gt;%\n  left_join(participant_mean_income, by = \"id_text\") %&gt;%\n  mutate(income_participant_mean = ifelse(is.na(income), mean_income_id, income))\n\n# Preview participant mean-imputed income (tail)\ntail(visits_all %&gt;% select(id_text, visit, income, income_participant_mean), n = 12)\n\n# A tibble: 12 √ó 4\n   id_text              visit income income_participant_mean\n   &lt;chr&gt;                &lt;dbl&gt;  &lt;dbl&gt;                   &lt;dbl&gt;\n 1 Jimm|Doyl|2005-04-25     1 198522                  198522\n 2 Jimm|Doyl|2005-04-25     2     NA                  198022\n 3 Jimm|Doyl|2005-04-25     3 197522                  197522\n 4 Jimm|Doyl|2005-04-25     4     NA                  198022\n 5 Mari|Lind|1966-06-23     1 178323                  178323\n 6 Mari|Lind|1966-06-23     2     NA                  177823\n 7 Mari|Lind|1966-06-23     3     NA                  177823\n 8 Mari|Lind|1966-06-23     4 177323                  177323\n 9 Tamb|Bali|1953-05-10     1 140772                  140772\n10 Tamb|Bali|1953-05-10     2     NA                  140272\n11 Tamb|Bali|1953-05-10     3     NA                  140272\n12 Tamb|Bali|1953-05-10     4 139772                  139772\n\n# Multiple imputation for fips, zip, healthcare_coverage, and income\npatients_mice &lt;- visits_all %&gt;%\n  select(id_text, fips, zip, healthcare_coverage, income)\n\n# Apply mice\nimputed &lt;- mice(patients_mice %&gt;% select(-id_text), method = \"pmm\", m = 1, printFlag = FALSE)\n\nWarning: Number of logged events: 1\n\n# Retrieve completed dataset\nmice_result &lt;- complete(imputed)\ncolnames(mice_result) &lt;- paste0(colnames(mice_result), \"_imputed\")\n\n# Join ID and filter rows with original missing values\ndf_mice &lt;- bind_cols(patients_mice, mice_result) %&gt;%\n  filter(is.na(fips) | is.na(zip) | is.na(healthcare_coverage) | is.na(income)) %&gt;%\n  select(id_text,\n         fips, fips_imputed,\n         zip, zip_imputed,\n         healthcare_coverage, healthcare_coverage_imputed,\n         income, income_imputed)\n\nhead(df_mice, n = 12)\n\n# A tibble: 12 √ó 9\n   id_text               fips fips_imputed   zip zip_imputed healthcare_coverage\n   &lt;chr&gt;                &lt;int&gt;        &lt;int&gt; &lt;int&gt;       &lt;int&gt;               &lt;dbl&gt;\n 1 Anit|S√°nc|1960-05-07 25009        25009  1915        1915            1280070.\n 2 Anit|S√°nc|1960-05-07 25009        25009  1915        1915            1280070.\n 3 Aure|Weis|2003-11-12 25027        25027  1606        1606             253645.\n 4 Aure|Weis|2003-11-12 25027        25027  1606        1606             253645.\n 5 Cars|Litt|2012-09-02 44007        44007  2861        2861                 NA \n 6 Cars|Litt|2012-09-02 44007        44007  2861        2861                 NA \n 7 Cars|Litt|2012-09-02 44007        44007  2861        2861                 NA \n 8 Cars|Litt|2012-09-02 44007        44007  2861        2861                 NA \n 9 Doll|Fran|2008-10-04    NA        25013    NA        2468             422516.\n10 Doll|Fran|2008-10-04    NA        25027    NA        1030             422516.\n11 Doll|Fran|2008-10-04    NA        25017    NA        2861             422516.\n12 Doll|Fran|2008-10-04    NA        25017    NA        1606             422516.\n# ‚Ñπ 3 more variables: healthcare_coverage_imputed &lt;dbl&gt;, income &lt;dbl&gt;,\n#   income_imputed &lt;dbl&gt;\n\n# Optional: Inspect logged events from mice\nimputed$loggedEvents\n\n  it im                 dep meth\n1  3  1 healthcare_coverage  pmm\n                                                                                                                                                                                                                                                       out\n1 mice detected that your data are (nearly) multi-collinear.\\nIt applied a ridge penalty to continue calculations, but the results can be unstable.\\nDoes your dataset contain duplicates, linear transformation, or factors with unique respondent names?\n\n# Final summary: compare original and imputed values for rows with missingness\n\nfinal_impute_check &lt;- visits_all %&gt;%\n  filter(is.na(race) | is.na(income)) %&gt;%\n  select(id_text, visit,\n         race, race_forward, race_backward,\n         income, income_global_mean, income_participant_mean)\n\n# Preview top 12\nhead(final_impute_check, n = 12)\n\n# A tibble: 12 √ó 8\n   id_text      visit race  race_forward race_backward income income_global_mean\n   &lt;chr&gt;        &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt;        &lt;chr&gt;          &lt;dbl&gt;              &lt;dbl&gt;\n 1 Anit|S√°nc|1‚Ä¶     2 &lt;NA&gt;  white        white             NA             96123.\n 2 Anit|S√°nc|1‚Ä¶     3 white white        white             NA             96123.\n 3 Anit|S√°nc|1‚Ä¶     4 &lt;NA&gt;  white        &lt;NA&gt;           60016             60016 \n 4 Aure|Weis|2‚Ä¶     2 &lt;NA&gt;  white        white             NA             96123.\n 5 Aure|Weis|2‚Ä¶     3 white white        white             NA             96123.\n 6 Aure|Weis|2‚Ä¶     4 &lt;NA&gt;  white        &lt;NA&gt;            7752              7752 \n 7 Cars|Litt|2‚Ä¶     2 &lt;NA&gt;  white        white             NA             96123.\n 8 Cars|Litt|2‚Ä¶     3 &lt;NA&gt;  white        white          70169             70169 \n 9 Cars|Litt|2‚Ä¶     4 white white        white             NA             96123.\n10 Doll|Fran|2‚Ä¶     2 &lt;NA&gt;  white        white             NA             96123.\n11 Doll|Fran|2‚Ä¶     3 &lt;NA&gt;  white        white         187023            187023 \n12 Doll|Fran|2‚Ä¶     4 white white        white             NA             96123.\n# ‚Ñπ 1 more variable: income_participant_mean &lt;dbl&gt;\n\n# Preview bottom 12\ntail(final_impute_check, n = 12)\n\n# A tibble: 12 √ó 8\n   id_text      visit race  race_forward race_backward income income_global_mean\n   &lt;chr&gt;        &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt;        &lt;chr&gt;          &lt;dbl&gt;              &lt;dbl&gt;\n 1 Home|Qui√±|1‚Ä¶     2 &lt;NA&gt;  white        white             NA             96123.\n 2 Home|Qui√±|1‚Ä¶     3 &lt;NA&gt;  white        white           6361              6361 \n 3 Home|Qui√±|1‚Ä¶     4 white white        white             NA             96123.\n 4 Jimm|Doyl|2‚Ä¶     2 &lt;NA&gt;  white        white             NA             96123.\n 5 Jimm|Doyl|2‚Ä¶     3 &lt;NA&gt;  white        white         197522            197522 \n 6 Jimm|Doyl|2‚Ä¶     4 white white        white             NA             96123.\n 7 Mari|Lind|1‚Ä¶     2 &lt;NA&gt;  white        white             NA             96123.\n 8 Mari|Lind|1‚Ä¶     3 white white        white             NA             96123.\n 9 Mari|Lind|1‚Ä¶     4 &lt;NA&gt;  white        &lt;NA&gt;          177323            177323 \n10 Tamb|Bali|1‚Ä¶     2 &lt;NA&gt;  white        white             NA             96123.\n11 Tamb|Bali|1‚Ä¶     3 white white        white             NA             96123.\n12 Tamb|Bali|1‚Ä¶     4 &lt;NA&gt;  white        &lt;NA&gt;          139772            139772 \n# ‚Ñπ 1 more variable: income_participant_mean &lt;dbl&gt;\n\n# Clean up temporary objects \nrm( participant_mean_income, final_impute_check, global_mean_income, df_passport, df_mice,\n    patients_mice, imputed, mice_result, missing_summary, total_missing, n_missing_individuals, missing_rows\n)"
  },
  {
    "objectID": "Post_Blog/Data_Manipulation_and_Wrangling/index.html#part-vi-descriptive-statistics-and-tabulation",
    "href": "Post_Blog/Data_Manipulation_and_Wrangling/index.html#part-vi-descriptive-statistics-and-tabulation",
    "title": "Date Manipulation and Wrangling using R",
    "section": "",
    "text": "In data analysis, summarising and tabulating variables is often the first step before conducting modelling or drawing conclusions. Descriptive statistics reveal the central tendency, variability, distribution shape, and frequency patterns in your dataset.\nThis section provides an overview of the most commonly used R functions for summarising both numeric and categorical variables. These tools help detect outliers, missing data, or skewed distributions and are essential for generating publication-ready summary tables.\nüìö Further are available via:\n\nYouTube: AnalyticsHub\n\nGithub: Summary Tools Repository\n\n\nSome of the contents essential for this section are presented below.\nBasic Summary Statistics\nsummary(), mean(), median(), min(), max(), sd(), var(), range(), quantile(), IQR()\nDistribution Shape / Skewness: skewness(), kurtosis() Extended Descriptive Summaries: describe() ,stat.desc(), skim() Tabulation (Frequencies and Proportions)\ntable(), prop.table(), addmargins(), xtabs()\nTidy Summary and Tabulations\ntabyl(), adorn_percentages(), adorn_totals() ‚Äì From janitor\ncount(), group_by() + summarise() ‚Äì From dplyr\npivot_wider(), pivot_longer() ‚Äì From tidyr\nCross Tabulations: CrossTable() ‚Äì From gmodels\n\n\nThese functions are useful for summarising continuous variables such as age, vaccine cost, or time intervals:\n\nsummary() ‚Äì 5-number summary + mean\n\nmean(), median() ‚Äì Measures of central tendency\n\nsd(), var() ‚Äì Measures of spread\n\nmin(), max() ‚Äì Extremes\n\nrange() ‚Äì Min and max in one\n\nquantile() ‚Äì Percentiles (e.g., 25th, 75th)\nIQR() ‚Äì Interquartile range\n\n\n\n\n  Childhood Respiratory       Other \n        472         955         126 \n\n\n\nFemale   Male \n   798    755 \n\n\n\n# ....................................................\n# Basic Summary Statistics Using Base R\n# ....................................................\n\n# Select key numeric variables\nsummary_vars &lt;- vacc_1524 %&gt;% \n  select(age, base_cost, healthcare_expenses)\n\n# View summary() for a quick five-number summary + mean\nsummary(summary_vars)\n\n      age          base_cost   healthcare_expenses\n Min.   : 1.00   Min.   :136   Min.   :    527.5  \n 1st Qu.:12.00   1st Qu.:136   1st Qu.:  14478.2  \n Median :25.00   Median :136   Median :  56729.2  \n Mean   :32.42   Mean   :136   Mean   : 156656.2  \n 3rd Qu.:52.00   3rd Qu.:136   3rd Qu.: 195830.8  \n Max.   :97.00   Max.   :136   Max.   :1157947.0  \n\n# Individual statistics for 'age'\nmean(vacc_1524$age, na.rm = TRUE)             # Mean age\n\n[1] 32.41661\n\nmedian(vacc_1524$age, na.rm = TRUE)           # Median age\n\n[1] 25\n\nmin(vacc_1524$age, na.rm = TRUE)              # Minimum age\n\n[1] 1\n\nmax(vacc_1524$age, na.rm = TRUE)              # Maximum age\n\n[1] 97\n\nsd(vacc_1524$age, na.rm = TRUE)               # Standard deviation of age\n\n[1] 23.76926\n\nvar(vacc_1524$age, na.rm = TRUE)              # Variance of age\n\n[1] 564.9777\n\nrange(vacc_1524$age, na.rm = TRUE)            # Range: min and max\n\n[1]  1 97\n\nquantile(vacc_1524$age, probs = c(0.25, 0.5, 0.75), na.rm = TRUE)  # Quartiles\n\n25% 50% 75% \n 12  25  52 \n\nIQR(vacc_1524$age, na.rm = TRUE)              # Interquartile range\n\n[1] 40\n\n# ....................................................\n# Clean up temporary object\n# ....................................................\nrm(summary_vars)\n\n\n\n\nThese indicators describe the shape of a numeric variable‚Äôs distribution. They help identify when a variable is:\n\nSkewed (not symmetric)\nHeavy-tailed (high kurtosis)\n\nDistribution Shape: Skewness and Kurtosis\n\n\n\n\n\n\n\n\nValue Range\nSkewness\nKurtosis (Excess)\n\n\n\n\n‚âà 0\nSymmetrical\nMesokurtic (normal-tailed)\n\n\n¬±0.5\nApproximately symmetrical\nSlight deviation\n\n\n¬±0.5 ‚Äì ¬±1\nModerate skew\nModerate peakedness or flatness\n\n\n&gt; ¬±1\nHigh skew (strong asymmetry)\nSubstantial deviation from normality\n\n\n&gt; 0 (kurtosis - 3 &gt; 0)\n‚Äì\nLeptokurtic (peaked, heavy tails)\n\n\n&lt; 0 (kurtosis - 3 &lt; 0)\n‚Äì\nPlatykurtic (flat, light tails)\n\n\n\n\n# Ensure the 'moments' package is installed\nif (!requireNamespace(\"moments\", quietly = TRUE)) {install.packages(\"moments\")}\nlibrary(moments)\n\n\n# Calculate distribution shape statistics\nskewness(vacc_1524$age, na.rm = TRUE)     # Skewness: +ve = right-skewed, -ve = left-skewed\n\n[1] 0.5301022\n\nkurtosis(vacc_1524$age, na.rm = TRUE)     # Kurtosis: &gt;3 = heavy tails, &lt;3 = flat distribution\n\n[1] 2.059686\n\nkurtosis(vacc_1524$age, na.rm = TRUE) - 3  # Excess kurtosis\n\n[1] -0.940314\n\n# ....................................................\n# Histogram to Visualize Distribution Shape\n# ....................................................\nhist(vacc_1524$age, \n     main = \"Histogram of Age\",\n     xlab = \"Age (Years)\", \n     col = \"#69b3a2\", \n     border = \"white\")\n\n\n\n\n\n\n\n\n\n\n\n\nTo produce a comprehensive summary of all variables (especially helpful in surveys or health system datasets), use:\n\ndescribe() ‚Äì From Hmisc: includes labels, missing %, and stats\n\nstat.desc() ‚Äì From pastecs: full statistical description with skew/kurtosis\n\nskim() ‚Äì From skimr: summary with inline histograms and types\n\n\n\n# Install required packages if missing\npackages &lt;- c(\"Hmisc\", \"pastecs\", \"skimr\")\nfor (p in packages) {if (!requireNamespace(p, quietly = TRUE)) install.packages(p)}\n\n# Explicitly load the packages\nlibrary(Hmisc)     # for describe()\nlibrary(pastecs)   # for stat.desc()\nlibrary(skimr)     # for skim()\n\nrm (packages)\n\n\n# ------------------------------\n# Extended Descriptive Summaries\n# ------------------------------\n\n# Hmisc::describe() ‚Äì Detailed variable summary\ndescribe(vacc_1524[, c(\"age\", \"gender\", \"race\")])\n\nvacc_1524[, c(\"age\", \"gender\", \"race\")] \n\n 3  Variables      1553  Observations\n--------------------------------------------------------------------------------\nage \n       n  missing distinct     Info     Mean  pMedian      Gmd      .05 \n    1553        0       62    0.999    32.42       32    26.76      5.0 \n     .10      .25      .50      .75      .90      .95 \n     6.0     12.0     25.0     52.0     68.8     73.0 \n\nlowest :  1  2  5  6  7, highest: 76 78 80 85 97\n--------------------------------------------------------------------------------\ngender \n       n  missing distinct \n    1553        0        2 \n                        \nValue      Female   Male\nFrequency     798    755\nProportion  0.514  0.486\n--------------------------------------------------------------------------------\nrace \n       n  missing distinct \n    1553        0        5 \n                                             \nValue       asian  black native  other  white\nFrequency     111     94     13     29   1306\nProportion  0.071  0.061  0.008  0.019  0.841\n--------------------------------------------------------------------------------\n\n# pastecs::stat.desc() ‚Äì Full statistics with skewness/kurtosis\nstat.desc(vacc_1524$age)\n\n     nbr.val     nbr.null       nbr.na          min          max        range \n1.553000e+03 0.000000e+00 0.000000e+00 1.000000e+00 9.700000e+01 9.600000e+01 \n         sum       median         mean      SE.mean CI.mean.0.95          var \n5.034300e+04 2.500000e+01 3.241661e+01 6.031564e-01 1.183087e+00 5.649777e+02 \n     std.dev     coef.var \n2.376926e+01 7.332432e-01 \n\n# skimr::skim() ‚Äì Tidy summary with histograms and data types\nskim(vacc_1524[, c(\"age\", \"gender\", \"income\")])\n\n\nData summary\n\n\nName\nvacc_1524[, c(‚Äúage‚Äù, ‚Äúgen‚Ä¶\n\n\nNumber of rows\n1553\n\n\nNumber of columns\n3\n\n\n_______________________\n\n\n\nColumn type frequency:\n\n\n\nfactor\n1\n\n\nnumeric\n2\n\n\n________________________\n\n\n\nGroup variables\nNone\n\n\n\nVariable type: factor\n\n\n\n\n\n\n\n\n\n\n\nskim_variable\nn_missing\ncomplete_rate\nordered\nn_unique\ntop_counts\n\n\n\n\ngender\n0\n1\nFALSE\n2\nFem: 798, Mal: 755\n\n\n\nVariable type: numeric\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nskim_variable\nn_missing\ncomplete_rate\nmean\nsd\np0\np25\np50\np75\np100\nhist\n\n\n\n\nage\n0\n1\n32.42\n23.77\n1\n12\n25\n52\n97\n‚ñá‚ñÉ‚ñÉ‚ñÉ‚ñÅ\n\n\nincome\n0\n1\n108887.58\n139702.07\n7361\n35860\n75767\n124775\n816851\n‚ñá‚ñÅ‚ñÅ‚ñÅ‚ñÅ\n\n\n\n\n\n\n\n\nUsed for categorical variables like gender, race, or vaccine group:\n\ntable() ‚Äì Basic frequency counts\n\nprop.table() ‚Äì Row/column proportions\n\naddmargins() ‚Äì Adds totals to tables\n\nxtabs() ‚Äì Cross-tabulation formula interface\n\n\n\n# --------------------------------------------\n# üîπ Categorical Variable Summary \n# --------------------------------------------\n\n# Basic frequency counts for individual vaccine types\ntable(vacc_1524$vaccine_group)\n\n\n          COVID-19          DTP group          Hepatitis                Hib \n               144                147                111                 32 \n               HPV          Influenza                IPV      Meningococcal \n                59                811                 47                 50 \n               MMR Pneumococcal PCV13 Pneumococcal PPV23          Rotavirus \n                26                 52                  8                 21 \n         Varicella             Zoster \n                26                 19 \n\n# Frequency counts for grouped vaccine categories\ntable(vacc_1524$vacc_group3)\n\n\n  Childhood Respiratory       Other \n        472         955         126 \n\n# Proportion of grouped vaccine categories\nprop.table(table(vacc_1524$vacc_group3))  # Overall proportions\n\n\n  Childhood Respiratory       Other \n 0.30392788  0.61493883  0.08113329 \n\n# Frequency table with row/column totals added\naddmargins(table(vacc_1524$vacc_group3))\n\n\n  Childhood Respiratory       Other         Sum \n        472         955         126        1553 \n\n# Cross-tabulation between vaccine group and gender\nxtabs(~ vacc_group3 + gender, data = vacc_1524)\n\n             gender\nvacc_group3   Female Male\n  Childhood      233  239\n  Respiratory    511  444\n  Other           54   72\n\n\n\n\n\nModern workflows prefer tidy-format summaries using:\n\ntabyl() ‚Äì From janitor: clean frequency tables\n\nadorn_totals(), adorn_percentages() ‚Äì Add percentages and totals\n\ncount() ‚Äì From dplyr: group-level counts\n\ngroup_by() + summarise() ‚Äì Group-wise summary\npivot_wider(), pivot_longer() ‚Äì Reshape tables\n\nThe section below demonstrates tabulations using janitor::tabyl() and tidyverse functions for grouped summaries and table reshaping.\n\n# --------------------------------------------\n# üîπ Tabulation and Table Reshaping \n# --------------------------------------------\n\n# 1. Basic clean frequency table with janitor::tabyl()\nvacc_1524 %&gt;%\n  tabyl(vacc_group3)\n\n vacc_group3   n    percent\n   Childhood 472 0.30392788\n Respiratory 955 0.61493883\n       Other 126 0.08113329\n\n# 2. Add column percentages and total row\nvacc_1524 %&gt;%\n  tabyl(vacc_group3, gender) %&gt;%\n  adorn_percentages(\"col\") %&gt;%\n  adorn_totals(\"row\") %&gt;%\n  adorn_title(\"combined\")  # Cleaner column names\n\n vacc_group3/gender     Female       Male\n          Childhood 0.29197995 0.31655629\n        Respiratory 0.64035088 0.58807947\n              Other 0.06766917 0.09536424\n              Total 1.00000000 1.00000000\n\n# 3. Group-level count using dplyr::count()\nvacc_1524 %&gt;%\n  count(vacc_group3, gender)\n\n  vacc_group3 gender   n\n1   Childhood Female 233\n2   Childhood   Male 239\n3 Respiratory Female 511\n4 Respiratory   Male 444\n5       Other Female  54\n6       Other   Male  72\n\n# 4. Group-wise summary using group_by + summarise\nvacc_1524 %&gt;%\n  group_by(vacc_group3) %&gt;%\n  summarise(n = n(), .groups = \"drop\") %&gt;%\n  mutate(prop = n / sum(n))\n\n# A tibble: 3 √ó 3\n  vacc_group3     n   prop\n  &lt;fct&gt;       &lt;int&gt;  &lt;dbl&gt;\n1 Childhood     472 0.304 \n2 Respiratory   955 0.615 \n3 Other         126 0.0811\n\n# 5. Pivot table to wide format (e.g., for display or reporting)\nvacc_1524 %&gt;%\n  count(vacc_group3, gender) %&gt;%\n  pivot_wider(names_from = gender, values_from = n, values_fill = 0)\n\n# A tibble: 3 √ó 3\n  vacc_group3 Female  Male\n  &lt;fct&gt;        &lt;int&gt; &lt;int&gt;\n1 Childhood      233   239\n2 Respiratory    511   444\n3 Other           54    72\n\n# 6. Optional: Pivot longer to return to tidy format\nvacc_1524 %&gt;%\n  count(vacc_group3, gender) %&gt;%\n  pivot_wider(names_from = gender, values_from = n, values_fill = 0) %&gt;%\n  pivot_longer(-vacc_group3, names_to = \"gender\", values_to = \"count\")\n\n# A tibble: 6 √ó 3\n  vacc_group3 gender count\n  &lt;fct&gt;       &lt;chr&gt;  &lt;int&gt;\n1 Childhood   Female   233\n2 Childhood   Male     239\n3 Respiratory Female   511\n4 Respiratory Male     444\n5 Other       Female    54\n6 Other       Male      72\n\n\n\n\n\nUsed to explore the relationship between two or more categorical variables.\n\nCrossTable() ‚Äì From gmodels: produces detailed cross-tabs with row %, column %, and counts\n\n\n# Install and load the gmodels package for cross-tabulation\nif (!requireNamespace(\"gmodels\", quietly = TRUE)) {\n  install.packages(\"gmodels\")\n}\nlibrary(gmodels)\n\n\n# ------------------------------\n# Cross Tabulation Example\n# ------------------------------\n\n# Generate a contingency table between gender and vaccine group\nCrossTable(vacc_1524$vacc_group3, vacc_1524$gender,\n           prop.r = FALSE,     # Row proportions\n           prop.c = TRUE,     # Column proportions\n           prop.t = FALSE,    # Overall proportion (optional)\n           chisq = TRUE)      # Include chi-square test for independence\n\n\n \n   Cell Contents\n|-------------------------|\n|                       N |\n| Chi-square contribution |\n|           N / Col Total |\n|-------------------------|\n\n \nTotal Observations in Table:  1553 \n\n \n                      | vacc_1524$gender \nvacc_1524$vacc_group3 |    Female |      Male | Row Total | \n----------------------|-----------|-----------|-----------|\n            Childhood |       233 |       239 |       472 | \n                      |     0.375 |     0.396 |           | \n                      |     0.292 |     0.317 |           | \n----------------------|-----------|-----------|-----------|\n          Respiratory |       511 |       444 |       955 | \n                      |     0.838 |     0.886 |           | \n                      |     0.640 |     0.588 |           | \n----------------------|-----------|-----------|-----------|\n                Other |        54 |        72 |       126 | \n                      |     1.783 |     1.885 |           | \n                      |     0.068 |     0.095 |           | \n----------------------|-----------|-----------|-----------|\n         Column Total |       798 |       755 |      1553 | \n                      |     0.514 |     0.486 |           | \n----------------------|-----------|-----------|-----------|\n\n \nStatistics for All Table Factors\n\n\nPearson's Chi-squared test \n------------------------------------------------------------\nChi^2 =  6.162349     d.f. =  2     p =  0.04590531 \n\n\n \n\n\n\nüîπ Summary Table: Descriptive Statistics and Tabulation Functions\n\n\n\n\n\n\n\n\nTask\nFunction\nPackage\n\n\n\n\nBasic numeric summaries\nsummary(), mean(), sd(), IQR()\nbase\n\n\nPercentiles and range\nquantile(), range()\nbase\n\n\nSkewness / Kurtosis\nskewness(), kurtosis()\ne1071, moments\n\n\nExtended profiling\ndescribe(), stat.desc(), skim()\nHmisc, pastecs, skimr\n\n\nFrequency tables\ntable(), xtabs(), prop.table()\nbase\n\n\nClean tables (tidy)\ntabyl(), adorn_*(), count()\njanitor, dplyr\n\n\nGroup summaries\ngroup_by() + summarise()\ndplyr\n\n\nReshape for tables\npivot_wider(), pivot_longer()\ntidyr\n\n\nRich cross-tabulation\nCrossTable()\ngmodels\n\n\n\n\n\n\n\n\nwrite.csv(), write_xlsx(), saveRDS(), write_tsv()\nExporting interactive tables with DT::datatable()\nSaving and loading the entire R workspace (save.image(), load())"
  },
  {
    "objectID": "Post_Blog/Data_Manipulation_and_Wrangling/index.html#part-vii-data-visualization-with-ggplot2",
    "href": "Post_Blog/Data_Manipulation_and_Wrangling/index.html#part-vii-data-visualization-with-ggplot2",
    "title": "Date Manipulation and Wrangling using R",
    "section": "",
    "text": "Visualization Contents and Types Overview\n\nLayers: Theme, Coordinates, Facets, Statistics, Geometries, Aesthetics, Data\nChart Types: line, histogram, boxplot, bar, area, density, violin, dotplot, ECDF, scatter, bubble, QQ plot\nComparative & Multivariate: faceted plot, pair plot, heatmap, treemap, radar chart, ridgeline plot, forest plot\nGeospatial Visualization: choropleth map, point map, heatmap overlay\nStatistical Overlays: error bars, confidence intervals, regression lines, smoothers\nInteractive Visualization: scatter/line/bar (Plotly), interactive tables (DT), interactive maps (Leaflet), dashboards (Shiny, flexdashboard)\n\nEffective visualizations help uncover patterns, trends, and insights in data. In R, we commonly use the ggplot2 package for static plots and tools like plotly, DT, and leaflet for interactive dashboards and graphics.\nThe sections below summarize different types of visualizations and how they fit into analysis workflows.\n\n\n\nEvery ggplot chart is built using multiple composable layers: - Data: The dataset to visualize. - Aesthetics (aes()): Mappings between variables and visual elements (e.g., x, y, color). - Geometries (geom_*): Plot types (e.g., geom_line(), geom_bar()). - Statistics (stat_*): Summaries or transformations (e.g., stat_smooth()). - Facets: Create multiple plots by group (facet_wrap(), facet_grid()). - Coordinates: Set axis and aspect ratio (coord_cartesian(), coord_flip()). - Themes: Control overall appearance (e.g., theme_minimal(), theme_bw()).\n\n\n\n\n\n\n\n\n\n\n\nChart Type\nFunction\nUsed For\n\n\n\n\nLine Chart\ngeom_line()\nTrends over time\n\n\nHistogram\ngeom_histogram()\nDistribution of continuous variables\n\n\nBoxplot\ngeom_boxplot()\nDistribution & outliers\n\n\nBar Plot\ngeom_bar()\nCounts or categorical comparison\n\n\nArea Plot\ngeom_area()\nCumulative trends\n\n\nDensity Plot\ngeom_density()\nSmoothed distribution\n\n\nViolin Plot\ngeom_violin()\nCombination of boxplot + density\n\n\nDot Plot\ngeom_dotplot()\nCount-based plots\n\n\nECDF Plot\nstat_ecdf()\nCumulative distribution\n\n\nScatter Plot\ngeom_point()\nBivariate relationships\n\n\nBubble Plot\ngeom_point(aes(size = ...))\n3-variable comparison using size\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nVisual Type\nPurpose\n\n\n\n\nFaceted Plot (facet_wrap)\nCompare subgroups in separate panels\n\n\nPair Plot (GGally::ggpairs)\nExplore all pairwise relationships\n\n\nHeatmap (geom_tile, heatmap())\nShow intensity using color\n\n\nTreemap (treemapify)\nHierarchical categories and values\n\n\nRadar Chart (fmsb)\nCompare multivariate profiles\n\n\nRidgeline Plot (ggridges)\nDistribution comparison across groups\n\n\nForest Plot (forestplot, ggforestplot)\nConfidence intervals and effect sizes\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nMap Type\nFunction/Use\n\n\n\n\nChoropleth Map\nShow values by region (e.g., geom_sf(), tmap)\n\n\nPoint Map\nLocations with coordinates (e.g., geom_point(), leaflet::addMarkers)\n\n\nHeatmap Overlay\nDensity of spatial events (e.g., leaflet::addHeatmap())\n\n\n\n\n\n\n\n\nError bars: geom_errorbar() for confidence or SD intervals\nRegression lines: geom_smooth(method = \"lm\")\nTrend smoothing: geom_smooth() with method = \"loess\"\nLabeling: geom_text(), geom_label() to annotate plots\n\n\nThis section demonstrates how to visualize breast cancer screening and vaccination data. We‚Äôll walk through common chart types such as line plots, bar charts, boxplots, and faceted views. Each example is designed with annotations and descriptions to aid understanding.\n\n\n\n\nEach chart demonstrates how different ggplot2 components come together using real health datasets.\n\n# Install if not already installed\nif (!requireNamespace(\"treemapify\", quietly = TRUE)) {install.packages(\"treemapify\")}\nif (!requireNamespace(\"ggridges\", quietly = TRUE)) {install.packages(\"ggridges\")}\nif (!requireNamespace(\"gganimate\", quietly = TRUE)) install.packages(\"gganimate\")\nif (!requireNamespace(\"gifski\", quietly = TRUE)) install.packages(\"gifski\")\n\nlibrary(gganimate)\nlibrary(gifski)\nlibrary(ggridges)\nlibrary(dplyr)\nlibrary(ggplot2)\nlibrary(plotly)\nlibrary(treemapify)\nlibrary(stringr)  # for str_to_title()\nlibrary(tidyr)\n\n\n\n Date[1:1553], format: \"1994-02-06\" \"1994-02-06\" \"1994-02-06\" \"1994-02-06\" \"1994-02-06\" ...\n\n\n\n  1   2   5   6   7  10  11  12  13  14  15  16  17  18  19  20  21  23  24  25 \n 46  24  64  66  34 100  38  59  21  21  34  81  18  36  18  34  40  13  12  47 \n 27  28  29  30  33  34  36  37  38  40  41  42  43  44  45  46  47  48  49  50 \n 17  30   9  35   4   7   6   8   6  20  37  16   9  17  15  13   9  21  30  15 \n 51  52  53  55  56  58  60  61  62  63  64  65  68  69  71  73  74  76  78  80 \n 13  30  16  30  26  14  12  24  36  13  25  14  14  47  14  19  15  14  12  13 \n 85  97 \n 12  10 \n\n\n\n  0‚Äì9 10‚Äì19 20‚Äì29 30‚Äì49   50+ \n  234   426   202   253   438 \n\n\n\n2016 2017 2018 2019 \n 341  341  341  341 \n\n\nLine Chart ‚Äì Breast Cancer Screening Trends by Region in Australia\nThe example below shows a line chart illustrating trends in breast cancer screening rates across Australian states from 2016 to 2019.\n\nBreast cancer screening rates across most Australian states appeared relatively consistent from 2016 to 2018, with minor year-to-year variations.\nA notable decline in screening rates is evident after 2018 and particularly in 2019, coinciding with the early stages of the COVID-19 pandemic\n\nState-specific Observations:\n\nTasmania (Tas) consistently had the highest screening rate, around 60%, but showed a clear decline post-2018.\nThe Northern Territory (NT) had the lowest rates, around 40%, also experiencing a slight decline during this period.\nOther states (ACT, NSW, Qld, SA, Vic, WA) maintained relatively stable rates (around 55%) until 2018, after which a distinct downturn is noticeable, particularly in Western Australia (WA) and Victoria (Vic).\n\nImpact of COVID-19:\n\nThe observed decline in breast cancer screening from 2019 onwards aligns with the emergence of the COVID-19 pandemic, which disrupted routine healthcare services globally.\n\nThis analysis underscores the importance of maintaining consistent access to healthcare services, particularly preventive screenings, even during periods of significant healthcare disruption.\n\n# Visualizing changes in screening rates (50‚Äì74 years) over time by state\n\nbreast_cancer_data %&gt;%\n  group_by(state, year_4digit) %&gt;%  # group by state and year\n  summarise(mean_rate = mean(rate50_74, na.rm = TRUE), .groups = \"drop\") %&gt;%\n  ggplot(aes(x = year_4digit, y = mean_rate, color = state)) +  # map axes and color\n  geom_line(size = 1.2) +  # trend lines\n  geom_point(size = 2) +   # points for each year\n  labs(\n    title = \"Breast Cancer Screening Rates (50‚Äì74 yrs)\",  \n    subtitle = \"Aggregated by State and Year\",           \n    x = \"Year\", y = \"Screening Rate (%)\",  # Axis labels\n    color = \"State\"   # Legend title\n  ) +\n  \n  theme_minimal()  \n\nWarning: Using `size` aesthetic for lines was deprecated in ggplot2 3.4.0.\n‚Ñπ Please use `linewidth` instead.\n\n\nWarning: Removed 4 rows containing missing values or values outside the scale range\n(`geom_line()`).\n\n\nWarning: Removed 4 rows containing missing values or values outside the scale range\n(`geom_point()`).\n\n\n\n\n\n\n\n\n\nHistogram ‚Äì Distribution of Age\nDisplays the frequency of vaccinated individuals by age, with a density line overlay to visualize the distribution shape.\nThe example below shows a histogram illustrating the age distribution within our studied population. The distribution highlights a clear bimodal pattern, indicating two main age groups. The largest group comprises younger adults, predominantly around 20‚Äì30 years old, suggesting a significant representation of young adults. A smaller secondary group emerges around 55‚Äì65 years old, reflecting a noticeable segment of older adults. This pattern may indicate specific target groups or demographic characteristics relevant to the population from which the data was collected. Understanding these age clusters can help tailor appropriate health strategies, services, or interventions accordingly.\n\nvacc_1524 %&gt;%\n  ggplot(aes(x = age)) +\n  geom_histogram(aes(y = ..density..), binwidth = 5, fill = \"darkblue\", color = \"white\", alpha = 0.7) +\n  geom_density(color = \"red\", size = 1.2) +\n  labs(title = \"Age Distribution with Density Curve\", x = \"Age\", y = \"Density\") +\n  theme_minimal()\n\nWarning: The dot-dot notation (`..density..`) was deprecated in ggplot2 3.4.0.\n‚Ñπ Please use `after_stat(density)` instead.\n\n\n\n\n\n\n\n\n\nPie Chart ‚Äì Proportion by Vaccine Group\nShows how vaccine groups are proportionally represented in the dataset. Useful for visualizing categorical outcomes.\nIn the example below, the pie chart represents the proportion of vaccinations grouped into three categories:\n\nRespiratory vaccines account for the largest proportion, comprising 61% of all vaccines administered.\nChildhood vaccines represent a significant portion as well, making up 30%.\nThe category labeled Other includes 8% of vaccines administered, indicating a smaller but notable group of vaccinations outside the respiratory and childhood classifications.\n\n\nvacc_1524 %&gt;%\n  count(vacc_group3) %&gt;%\n  mutate(perc = n / sum(n), label = scales::percent(perc)) %&gt;%\n  ggplot(aes(x = \"\", y = perc, fill = vacc_group3)) +\n  geom_col(width = 1) +\n  coord_polar(theta = \"y\") +\n  geom_text(aes(label = label), position = position_stack(vjust = 0.5)) +\n  labs(title = \"Vaccine Group Proportions\", fill = \"Vaccine Group\") +\n  theme_void()\n\n\n\n\n\n\n\n\nBar Plot ‚Äì Vaccination Count by Vaccine Group\nThis plot compares the absolute count of vaccinations across groups, with horizontal bars for better readability of long labels.\nThe example below shows a horizontal bar chart illustrating the total number of vaccinations administered, grouped into three distinct categories:\n\nRespiratory vaccines clearly represent the largest group, indicating that these vaccines were administered most frequently within the population.\nThe Other category accounts for the smallest number of vaccinations, suggesting a relatively minor proportion of miscellaneous or specialized vaccines.\n\n\nvacc_1524 %&gt;%\n  count(vacc_group3) %&gt;%\n  ggplot(aes(x = reorder(vacc_group3, n), y = n, fill = vacc_group3)) +\n  geom_bar(stat = \"identity\") +\n  coord_flip() +\n  labs(title = \"Vaccination Count by Group\", x = NULL, y = \"Count\") +\n  theme_minimal() +\n  theme(legend.position = \"none\")\n\n\n\n\n\n\n\n\nGrouped Bar Plot ‚Äì Vaccination by Race and Vaccine Group\nThe example below shows a stacked bar chart presenting the distribution of vaccinations by race and vaccine category.\n\nRespiratory vaccines (represented in blue) dominate across all racial groups, consistently making up the largest proportion of administered vaccines, especially noticeable among Black and White groups.\nChildhood vaccines (represented in red) form a significant proportion of vaccinations among the Asian and Native groups, highlighting targeted or population-specific vaccination programs for younger age groups within these communities.\nThe Other vaccines category (represented in green) comprises a relatively minor proportion and appears more prominent among the Asian and White populations.\n\n**Implications:**\n\nThese patterns may suggest varying public health strategies, demographic factors, or differing healthcare access across racial groups. Understanding these variations can guide targeted healthcare interventions and improve vaccine coverage equity.\n\n# Prepare data: count vaccinations by race and vaccine group\n\nvacc_1524$race &lt;- tools::toTitleCase(vacc_1524$race)\n\nvacc_summary &lt;- vacc_1524 %&gt;%\n  count(race, vacc_group3) %&gt;%\n  group_by(race) %&gt;%\n  mutate(prop = n / sum(n)) %&gt;%\n  ungroup()\n\nggplot(vacc_summary, aes(x = race, y = prop, fill = vacc_group3)) +\n  geom_col(position = \"dodge\") +\n  labs(\n    title = \"Vaccination Distribution by Race and Vaccine Group\",\n    x = \"Race\", y = \"Proportion\",\n    fill = \"Vaccine Group\"\n  ) +\n  scale_y_continuous(labels = scales::percent_format()) +\n  theme_minimal() +\n  theme(axis.text.x = element_text(angle = 45, hjust = 1))\n\n\n\n\n\n\n\nrm(vacc_summary)\n\nStacked Bar Chart ‚Äì Race by Vaccine Group\nThe example below shows a stacked bar chart illustrating the number of vaccinations administered, grouped by vaccine type and categorized by racial groups.\n\nThe White population received the highest number of vaccinations across all vaccine categories (Childhood, Other, and Respiratory vaccines).\nOther racial groups (Asian, Black, Native, and Other) also received vaccinations, though in smaller numbers across each vaccine type, indicating ongoing efforts to reach diverse communities.\nRespiratory vaccines had the highest total number of vaccinations administered, suggesting these vaccines were a primary focus within the vaccination program.\n\nThis data helps to illustrate which groups have higher vaccine coverage and highlights the importance of ensuring equitable access and distribution across all communities.\n\nvacc_1524 %&gt;%\n  mutate(race = stringr::str_to_title(race)) %&gt;%\n  count(vacc_group3, race) %&gt;%\n  ggplot(aes(x = vacc_group3, y = n, fill = race)) +\n  geom_bar(stat = \"identity\") +\n  labs(title = \"Stacked Bar Chart: Race by Vaccine Group\", x = \"Vaccine Group\", y = \"Count\") +\n  theme_minimal()\n\n\n\n\n\n\n\n\nBoxplot ‚Äì Age Distribution by Vaccine Group\nVisualizes how age varies across vaccine groups using standard boxplots.\nThe example below shows a box plot depicting age distribution for three vaccine categories (Childhood vaccines, Other vaccines, and Respiratory vaccines):\nKey Observations:\n\nChildhood vaccines primarily cover younger ages, with most recipients under 25 years old. Some individuals beyond this age range appear as outliers, suggesting occasional vaccinations in older groups.\nRespiratory vaccines generally target an older age group, with the median age around 50 years, and a broad range from younger adults to elderly populations.\nThe Other vaccines category has a wider age distribution overall, suggesting these vaccines serve diverse age groups, though with fewer individuals compared to the other two groups.\n\nImplications:\nThis visualization highlights clear age-based targeting for different vaccine categories. Childhood vaccines are expectedly administered primarily to younger populations, while respiratory vaccines predominantly reach older adults. Understanding these age patterns helps to plan targeted public health campaigns and resource allocation effectively.\n\nvacc_1524 %&gt;%\n  ggplot(aes(x = vacc_group3, y = age, fill = vacc_group3)) +\n  geom_boxplot() +\n  labs(title = \"Age Distribution by Vaccine Group\",\n       x = \"Vaccine Group\", y = \"Age (Years)\") +\n  theme_minimal() +\n  theme(legend.position = \"none\")\n\n\n\n\n\n\n\n\nBoxplot with Jittered (Individual Data) Points\nCombines summary and raw data by overlaying individual age points on the boxplot.\nThe example below shows a boxplot with individual data points (jittered), displaying the age distribution of individuals across three vaccine groups: Childhood vaccines, Other vaccines, and Respiratory vaccines.\n\nChildhood vaccines:\nMost individuals who received childhood vaccines are young, with a median age around 10 years.\nThe distribution is tightly concentrated, though some older individuals (outliers) also received these vaccines.\nThe data points clearly cluster in younger age ranges, which is expected for this vaccine group.\n\nRespiratory vaccines:\n\nThis group has the highest median age, around 40‚Äì50 years.\nThe data points are more evenly spread out across a wide age range, with many individuals above 60 years, indicating respiratory vaccines are frequently administered to older populations.\n\n\nOther vaccines:\n\nThis group shows a wide range of ages, from infants to older adults.\nWhile the median age is still relatively low, the spread is broader compared to childhood vaccines, suggesting this category includes various vaccines administered across different age groups.\n\nImplications:\nBy combining summary statistics (boxplot) with individual-level data (dots), this chart offers a clear view of both overall trends and variation in vaccination by age. It confirms that vaccine distribution aligns with age-specific health needs‚Äîyoung children for childhood vaccines, and older adults for respiratory vaccines‚Äîwhile also showing the diversity within each group.\n\n\nvacc_1524 %&gt;%\n  ggplot(aes(x = vacc_group3, y = age, fill = vacc_group3)) +\n  geom_boxplot(outlier.shape = NA, alpha = 0.6) +\n  geom_point(position = position_jitter(width = 0.2),\n             alpha = 0.3, color = \"black\", size = 1.2) +\n  labs(title = \"Boxplot with Individual Data Points\",\n       x = \"Vaccine Group\", y = \"Age\") +\n  theme_minimal() +\n  theme(legend.position = \"none\")\n\n\n\n\n\n\n\n\nBoxplot with Violin Overlay\nAdds a violin plot to visualize the full distribution of ages while preserving boxplot summary stats.\nThe plot below combines a boxplot and violin plot to display the age distribution across different vaccine groups: Childhood vaccines, Other vaccines, and Respiratory vaccines.\n\nChildhood vaccines:\nThe age distribution is heavily concentrated among younger individuals, with most recipients under 25 years. The violin shape is widest near the lower ages, tapering quickly, which indicates that childhood vaccines are rarely given to older individuals.\nRespiratory vaccines:\nThe distribution leans toward older age groups, with the median age higher than in other categories. The violin is widest in the 40‚Äì70 age range, suggesting respiratory vaccines are more commonly administered to older adults.\n\n\n\nOther vaccines:\nThis group shows a broader age range. The shape suggests two areas of concentration: one among younger children and another around age 60‚Äì70, indicating this group includes vaccine types used across diverse age groups.\nOverall, this combined plot provides both statistical summaries (via boxplot) and full distribution shapes (via violin plot), helping to clearly distinguish the age-related usage patterns across vaccine types.\n\n\nvacc_1524 %&gt;%\n  ggplot(aes(x = vacc_group3, y = age, fill = vacc_group3)) +\n  geom_violin(alpha = 0.4, color = NA) +\n  geom_boxplot(width = 0.2, outlier.shape = NA) +\n  labs(title = \"Boxplot with Violin Overlay\", x = NULL, y = \"Age\") +\n  theme_minimal() +\n  theme(legend.position = \"none\")\n\n\n\n\n\n\n\n\nNotched Boxplot ‚Äì Median Comparison\nNotches allow a rough comparison of medians across groups. Non-overlapping notches suggest a significant difference.\nThe plot below presents a notched boxplot showing the age distribution for each vaccine group‚ÄîChildhood vaccines, Other vaccines, and Respiratory vaccines.\n\nThe notches around the medians provide a visual guide for comparing the central values (medians) across groups. If the notches do not overlap, it suggests that the medians are likely different in a statistically meaningful way.\n\nKey insights:\n\nChildhood vaccines show a younger age distribution, with a median age around 10 years and a narrow spread. Outliers indicate a few older individuals also received these vaccines.\nRespiratory vaccines are mainly administered to older age groups, with the highest median age among the three categories.\nOther vaccines span a wider range of ages, but the median remains lower than that of respiratory vaccines.\n\nMedian Comparison:\n\nThe non-overlapping notches between childhood and respiratory vaccines suggest a clear difference in median ages.\nThe other vaccines group overlaps slightly with both, indicating a more mixed age distribution and less pronounced difference.\n\n\nvacc_1524 %&gt;%\n  ggplot(aes(x = vacc_group3, y = age, fill = vacc_group3)) +\n  geom_boxplot(notch = TRUE) +\n  labs(title = \"Notched Boxplot: Vaccine Group vs Age\", x = \"Group\", y = \"Age\") +\n  theme_minimal() +\n  theme(legend.position = \"none\")\n\nNotch went outside hinges\n‚Ñπ Do you want `notch = FALSE`?\n\n\n\n\n\n\n\n\n\nFaceted Boxplot by Gender\nBreaks down the age distribution by vaccine group and gender to compare across subgroups.\nThe plot below shows boxplots of age distribution by vaccine group (Childhood, Respiratory, and Other vaccines), separated into two panels by gender (Female and Male).\nKey Observations:\n\nChildhood vaccines:\n\n-    Age distributions are similar for both females and males, with most recipients being under 25 years.\n\n-    A few older outliers are present, especially among females, but the bulk of vaccine recipients are children and adolescents.\n\nRespiratory vaccines:\n\n-    This group shows a wide age range in both genders, with median ages around 40‚Äì45 years.\n\n-    The distribution is slightly more spread out among males, but the overall trend remains consistent across genders.\n\nOther vaccines:\n\n-    A notable gender difference is visible here:\n\n    -   Among **females**, recipients span a broad age range, including many older adults.\n\n    -    Among **males**, the age distribution is narrower and skewed toward younger adults.\nSummary:\nThis faceted view helps highlight how age patterns differ by both vaccine group and gender. While childhood and respiratory vaccine distributions are generally similar across genders, the ‚ÄúOther‚Äù vaccine group shows more variation, possibly reflecting differences in vaccine eligibility, access, or health needs.\n\nvacc_1524 %&gt;%\n  ggplot(aes(x = vacc_group3, y = age, fill = vacc_group3)) +\n  geom_boxplot() +\n  facet_wrap(~ gender) +\n  labs(title = \"Age by Vaccine Group, Faceted by Gender\", x = NULL, y = \"Age\") +\n  theme_minimal() +\n  theme(legend.position = \"none\")\n\n\n\n\n\n\n\n\nOrdered Boxplot ‚Äì by Median Age\nReorders vaccine groups by median age to emphasize differences in distribution centrality.\nThe plot below shows age distributions by vaccine group, with the groups reordered by median age to highlight differences in central tendency.\nKey Observations:\n\nChildhood vaccines have the lowest median age, with most recipients being under 20 years. A small number of older individuals appear as outliers.\nOther vaccines show a moderate median age, but with a wide spread across age groups‚Äîranging from infants to older adults. This suggests these vaccines are used in more varied contexts.\nRespiratory vaccines have the highest median age, with recipients typically ranging from their 30s to older adulthood, reflecting their common use among older populations.\n\nConclusion:\nBy ordering the boxplots by median age, this visual emphasizes the different age profiles targeted by each vaccine group. This approach helps communicate age-related trends in vaccine administration more clearly .\n\nvacc_1524 %&gt;%\n  mutate(vacc_group3 = fct_reorder(vacc_group3, age, median, na.rm = TRUE)) %&gt;%\n  ggplot(aes(x = vacc_group3, y = age, fill = vacc_group3)) +\n  geom_boxplot() +\n  labs(title = \"Boxplot Ordered by Median Age\", x = NULL, y = \"Age\") +\n  theme_minimal() +\n  theme(legend.position = \"none\")\n\n\n\n\n\n\n\n\nArea Plot ‚Äì Monthly Vaccination Trends Over Years\nUses an area chart to show monthly vaccination volumes over multiple years, stacked by year.\nThe area chart below displays monthly vaccination counts over multiple years (2015‚Äì2024), helping visualize seasonal and annual trends in vaccine uptake.\nKey Observations:\n\n2020 stands out with the highest overall vaccination counts, especially between April and June, likely reflecting a surge due to public health responses such as the COVID-19 pandemic.\nIn other years, vaccination numbers are more evenly distributed, with moderate peaks around March‚ÄìApril or August‚ÄìSeptember, possibly aligning with seasonal vaccination programs (e.g., flu campaigns).\n2023 and 2024 show a relatively steady pattern throughout the year, with less fluctuation month-to-month.\nEarlier years (2015‚Äì2017) have lower and more variable volumes compared to recent years.\n\nConclusion:\nThis chart highlights both seasonal vaccination patterns and the impact of specific public health events, such as the elevated activity in 2020. Monitoring these trends over time supports planning for future vaccination campaigns and resource allocation.\n\nvacc_1524 %&gt;%\n  count(vacc_year, vacc_month_name) %&gt;%\n  ggplot(aes(x = vacc_month_name, y = n, group = vacc_year, fill = factor(vacc_year))) +\n  geom_area(alpha = 0.7, position = \"identity\") +\n  labs(title = \"Monthly Vaccination Trends by Year\",\n       x = \"Month\", y = \"Number of Vaccinations\", fill = \"Year\") +\n  theme_minimal()\n\n\n\n\n\n\n\n\nFaceted Plot ‚Äì Proportional Vaccination Trends by Group and Race\nDisplays how the proportion of vaccinations among different races changed across years, separately for each vaccine group.\nThe faceted line plot below shows how the proportion of vaccinations among different racial groups has changed over time (2015‚Äì2024), presented separately for each vaccine group: Childhood, Respiratory, and Other.\nKey Observations:\n\nChildhood vaccines:\n\n-   Proportions vary notably year to year, especially for **Asian**, **Black**, and **Native** groups.\n\n-   The **\"Other\"** and **White** groups show a more consistent presence but with modest fluctuations.\n\n-    Some groups (e.g., Native) show a steady rise in recent years.\n\n**Respiratory vaccines**:\n\n-    Several racial groups (notably **Native**, **Black**, and **Other**) show periods of very high proportions, including years where proportions reached **100%**, likely due to small subgroup sample sizes or data dominance.\n\n-    The **White** and **Asian** groups tend to remain stable, though proportions fluctuate in certain years (e.g., 2020‚Äì2022).\n\nOther vaccines:\n\n-   Representation is generally lower and more variable across all racial groups.\n\n-    The **White** group maintains a small but steady share throughout most years.\n\n**Interpretation:**\nThis faceted view enables comparisons within and between vaccine types, highlighting potential shifts in vaccine access, uptake, or data coverage by racial group over time. It also suggests where disparities or changes in focus may have occurred, helping to inform more equitable vaccination strategies.\n\n# Prepare data: floor year, count by group, compute proportions within each group\n\n# Clean and count total per race/year (for denominator)\ntotal_by_race_year &lt;- vacc_1524 %&gt;%\n  mutate(\n    age = as.integer(round(age)),\n    vacc_year = as.integer(floor(vacc_year)),\n    race = str_to_title(as.character(race))\n  ) %&gt;%\n  count(vacc_year, race, name = \"total_race_year\")\n\n#  Count per vaccine group (for numerator), then join\nvacc_plot_data &lt;- vacc_1524 %&gt;%\n  mutate(\n    age = as.integer(round(age)),\n    vacc_year = as.integer(floor(vacc_year)),\n    race = str_to_title(as.character(race))\n  ) %&gt;%\n  count(vacc_year, race, vacc_group3, name = \"n\") %&gt;%\n  left_join(total_by_race_year, by = c(\"vacc_year\", \"race\")) %&gt;%\n  mutate(prop = n / total_race_year)\n\n# Plot proportion by race within group\nggplot(vacc_plot_data, aes(x = vacc_year, y = prop, color = race)) +\n  geom_line(size = 1) +\n  facet_wrap(~ vacc_group3) +\n  scale_y_continuous(labels = percent_format()) +\n  scale_x_continuous(breaks = pretty(unique(vacc_plot_data$vacc_year))) +\n  labs(\n    title = \"Proportion of Race Within Vaccine Groups by Year\",\n    x = \"Year\", y = \"Proportion\", color = \"Race\"\n  ) +\n  theme_minimal() +\n  theme(axis.text.x = element_text(angle = 45, hjust = 1))\n\n\n\n\n\n\n\nrm(vacc_plot_data, total_by_race_year)\n\nStatistical Overlay ‚Äì Regression Line on Vaccination Age\nAdds a linear regression to examine the relationship between income and age at vaccination.\nThe scatterplot below visualizes the relationship between income (horizontal axis) and age at vaccination (vertical axis), with a linear regression line and confidence band overlaid to summarize the trend.\nKey Observations:\n\nThe fitted regression line shows a slight negative slope, suggesting that as income increases, the age at which individuals receive vaccination tends to decrease modestly.\nThe confidence band (shaded region) around the line is relatively narrow, indicating a fair level of certainty in the trend across the central range of income.\nThe majority of data points are concentrated in the lower income ranges, while higher income values are more sparsely populated and show greater variability.\n\n**Interpretation:**\nThis trend suggests a possible inverse relationship between income and vaccination age‚Äîindividuals with higher income may be more likely to receive vaccines at younger ages. This could reflect differences in healthcare access, awareness, or proactive health behaviors associated with income level.\n\nvacc_1524 %&gt;%\n  ggplot(aes(x = income, y = age)) +\n  geom_point(alpha = 0.3, color = \"gray50\") +\n  geom_smooth(method = \"lm\", se = TRUE, color = \"blue\") +\n  labs(\n    title = \"Association Between Income and Age at Vaccination\",\n    x = \"Income\", y = \"Age\"\n  ) +\n  theme_minimal()\n\n`geom_smooth()` using formula = 'y ~ x'\n\n\n\n\n\n\n\n\n\nRegression Plot ‚Äì Age vs Income by Vaccine Group (Log Scale)\nAdds linear regression and facets by vaccine group. The x-axis is log-scaled to handle skewed income data.\nThe plot below shows scatterplots with linear regression lines, examining the relationship between income and age at vaccination. The plots are faceted by vaccine group: Childhood, Other, and Respiratory. The x-axis uses a logarithmic scale to better handle the skewed distribution of income.\nKey Observations:\n\nChildhood vaccines:\n\n-    A **slight negative trend** is observed, indicating that as income increases, age at vaccination tends to decrease slightly.\n\n-    This may reflect earlier or more timely vaccinations among higher-income individuals for childhood vaccines.\n\nOther vaccines:\n\n-   The regression line is nearly flat with a wide confidence interval, suggesting **no strong or consistent relationship** between income and age at vaccination in this group.\n\n-    This likely reflects diverse vaccine purposes and use across a broad age and income range.\n\nRespiratory vaccines:\n\n-   A **mild negative trend** is also seen here, where higher-income individuals may receive respiratory vaccines at slightly younger ages.\n\n-    However, the relationship is subtle and the confidence interval overlaps considerably with the regression line.\n\n**Interpretation:**\nWhile the strength of association varies across groups, both the childhood and respiratory vaccine panels suggest a small trend where higher income is associated with younger age at vaccination. This may be related to differences in access, preventive health behaviors, or healthcare utilization by income level.\n\nvacc_1524 %&gt;%\n  mutate(vacc_group3 = str_to_title(vacc_group3)) %&gt;%\n  ggplot(aes(x = income, y = age)) +\n  geom_point(alpha = 0.3, color = \"gray50\") +\n  geom_smooth(method = \"lm\", se = TRUE, color = \"blue\") +\n  scale_x_log10(labels = scales::comma_format()) +\n  facet_wrap(~ vacc_group3) +\n  labs(\n    title = \"Association Between Income and Age at Vaccination\",\n    x = \"Income (log scale)\", y = \"Age\"\n  ) +\n  theme_minimal()\n\n`geom_smooth()` using formula = 'y ~ x'\n\n\n\n\n\n\n\n\n\nECDF ‚Äì Age at Vaccination\nThe empirical cumulative distribution function (ECDF) shows the proportion of individuals vaccinated at or below each age. This helps visualize the age distribution in a cumulative way.\nThe plot below presents shows the cumulative proportion of individuals who received a vaccination at or below each age.\nKey Observations:\n\nThe curve rises steeply in the early age range, indicating that a large proportion of individuals were vaccinated at younger ages (e.g., before 30).\nBy around age 50, approximately 80% of individuals had been vaccinated.\nThe curve flattens out after age 75, suggesting fewer vaccinations occur at older ages.\n\nInterpretation:\nThe ECDF provides an intuitive way to understand the distribution of vaccination ages. It highlights that most vaccinations occur in childhood and early adulthood, with fewer individuals vaccinated later in life. This cumulative view complements histograms and boxplots by showing the proportion of individuals affected up to each age.\n\nvacc_1524 &lt;- vacc_1524 %&gt;% filter(income &gt; 0, !is.na(age))\n\nvacc_1524 %&gt;%\n  ggplot(aes(x = age)) +\n  stat_ecdf(geom = \"step\", color = \"steelblue\") +\n  labs(title = \"ECDF of Age at Vaccination\", x = \"Age\", y = \"Cumulative Proportion\") +\n  theme_minimal()\n\n\n\n\n\n\n\n\nTreemap ‚Äì Vaccination by Race and Vaccine Group\nThis treemap visualizes the distribution of vaccinations by race and vaccine group. Larger areas indicate more individuals within each combination.\nThe treemap below displays the distribution of vaccinations across racial groups, further categorized by vaccine group (Childhood, Respiratory, and Other). Each rectangle represents a combination of race and vaccine type, with area size corresponding to the number of individuals vaccinated.\nKey Observations:\n\nThe White population accounts for the largest share overall, with:\n\n-    **788 individuals (50.7%)** in the **Respiratory** vaccine group.\n\n-    **404 individuals (26.0%)** in the **Childhood** vaccine group.\n\n-    **114 individuals (7.3%)** in the **Other** vaccine group.\n\nOther racial groups have smaller shares:\n\n-    **Black** individuals make up a modest proportion across groups, particularly **4.5%** in the Respiratory group and **1.4%** in Childhood vaccines.\n\n-    **Asian** individuals represent **4.4%** of Respiratory vaccines and **2.1%** of Childhood vaccines.\n\n-    **Native** and **Other** groups have minimal representation overall.\n\n**Interpretation:**\nThis treemap visually emphasizes the dominant contribution of the White population across all vaccine types, especially for respiratory vaccines. It also illustrates disparities in representation among racial groups, which can be important for assessing equity in vaccine access, uptake, and program targeting.\n\n# Cross-platform ‚Äúnew device‚Äù:\ndev.new(width = 8, height = 6)  \n\np &lt;- vacc_1524 %&gt;%\n  count(race, vacc_group3) %&gt;%\n  mutate(race = str_to_title(race)) %&gt;%\n  ggplot(aes(area = n, fill = vacc_group3, label = race)) +\n  geom_treemap() +\n  geom_treemap_text(colour = \"white\", place = \"centre\", grow = TRUE) +\n  labs(\n    title = \"Treemap: Vaccination by Race and Vaccine Group\",\n    fill  = \"Vaccine Group\"\n  ) +\n  theme_minimal()\n\nprint(p)\n\nrm (p)\n\n\n#  Treemap - with Labels Showing Counts and Proportions by Race and vaccine Group\nvacc_1524 %&gt;%\n  count(race, vacc_group3) %&gt;%\n  mutate(\n    race = str_to_title(race),\n    total = sum(n),\n    proportion = n / total,\n    label_text = paste0(race, \"\\n\", n, \" (\", percent(proportion, accuracy = 0.1), \")\")\n  ) %&gt;%\n  ggplot(aes(area = n, fill = vacc_group3, label = label_text)) +\n  geom_treemap() +\n  geom_treemap_text(colour = \"white\", place = \"centre\", grow = TRUE, reflow = TRUE) +\n  labs(\n    title = \"Treemap: Vaccination by Race and Vaccine Group\",\n    fill = \"Vaccine Group\"\n  ) +\n  theme_minimal()\n\n\n\n\n\n\n\n\nCorrelation Heatmap ‚Äì Numeric Variables\nThis heatmap displays Pearson correlation coefficients between selected numeric variables. Strong positive or negative values help identify relationships worth further analysis.\nThe heatmap below displays Pearson correlation coefficients between selected numeric variables: age, income, healthcare expenses, and healthcare coverage. Correlation values range from -1 to 1, where values closer to ¬±1 indicate stronger relationships.\nKey Observations:\n\nAge and healthcare coverage show a strong positive correlation (0.65), suggesting that as individuals age, they are more likely to have greater healthcare coverage.\nAge and healthcare expenses are also positively correlated (0.66), indicating that older individuals tend to incur higher healthcare costs.\nHealthcare coverage and healthcare expenses show a moderate positive correlation (0.44), which may reflect that those with more coverage also utilize healthcare services more frequently or thoroughly.\nIncome is not strongly correlated with any other variable in this set, with the highest being a negligible 0.02 with healthcare coverage and a slightly negative value with age (-0.04) and expenses (-0.05).\n\n**Interpretation:**\nThis heatmap highlights potential relationships that may inform further analysis‚Äîespecially the connections between age, coverage, and expenses. In contrast, income appears relatively independent of the other variables in this dataset.\n\nnumeric_vars &lt;- vacc_1524 %&gt;%\n  select(age, income, healthcare_expenses, healthcare_coverage) %&gt;%\n  na.omit()\n\ncor_matrix &lt;- round(cor(numeric_vars), 2)\n\nas.data.frame(as.table(cor_matrix)) %&gt;%\n  rename(Var1 = Var1, Var2 = Var2, Correlation = Freq) %&gt;%\n  ggplot(aes(x = Var1, y = Var2, fill = Correlation)) +\n  geom_tile(color = \"white\") +\n  geom_text(aes(label = Correlation), color = \"black\") +\n  scale_fill_gradient2(low = \"red\", high = \"blue\", mid = \"white\", midpoint = 0) +\n  labs(title = \"Correlation Heatmap of Numeric Variables\", x = NULL, y = NULL) +\n  theme_minimal()\n\n\n\n\n\n\n\n\nRidgeline Plot ‚Äì Age by Vaccine Group\nThis ridgeline plot shows the age distribution for each vaccine group. It highlights where age densities differ across categories.\nThe ridgeline plot below shows age distributions for three vaccine groups: Childhood, Other, and Respiratory. Each layer represents the density of ages within a vaccine category, allowing for visual comparison of where individuals are most commonly vaccinated within each group.\nKey Observations:\n\nChildhood vaccines show a clear peak at very young ages, as expected. The density drops rapidly as age increases, with a small secondary bump around middle age, possibly reflecting catch-up vaccinations or data irregularities.\nOther vaccines have a bimodal distribution with one peak in younger adults and another in older adults (around 70+ years), suggesting they are used across multiple life stages.\nRespiratory vaccines have a broad distribution, with a peak density around 60‚Äì70 years, consistent with routine respiratory vaccinations for older adults (e.g., influenza or pneumococcal vaccines).\n\n**Interpretation:**\nThis visualization effectively highlights differences in age targeting across vaccine groups. It shows that:\n\nChildhood vaccines are concentrated in early life,\nOther vaccines are used more broadly across age ranges, and\nRespiratory vaccines are predominantly administered to older populations.\n\n\nvacc_1524 %&gt;%\n  mutate(vacc_group3 = stringr::str_to_title(vacc_group3)) %&gt;%\n  ggplot(aes(x = age, y = vacc_group3, fill = vacc_group3)) +\n  geom_density_ridges(scale = 1.5, alpha = 0.6, color = \"white\") +\n  labs(title = \"Ridgeline Plot: Age Distribution by Vaccine Group\", x = \"Age\", y = \"Vaccine Group\") +\n  theme_minimal() +\n  theme(legend.position = \"none\")\n\nPicking joint bandwidth of 5.93\n\n\n\n\n\n\n\n\n\nInteractive Plot ‚Äì Income vs Age by Race\nThis interactive scatter plot shows the relationship between income and age, colored by race. Hovering reveals more details including group and income.\n\np &lt;- vacc_1524 %&gt;%\n  mutate(race = stringr::str_to_title(race)) %&gt;%\n  ggplot(aes(x = income, y = age, color = race,\n             text = paste(\"Race:\", race,\n                          \"&lt;br&gt;Group:\", vacc_group3,\n                          \"&lt;br&gt;Income:\", income,\n                          \"&lt;br&gt;Age:\", age))) +\n  geom_point(alpha = 0.6) +\n  geom_smooth(method = \"loess\", se = FALSE, color = \"gray30\") +\n  labs(title = \"Interactive: Income vs Age by Race\",\n       x = \"Income\", y = \"Age\", color = \"Race\") +\n  theme_minimal() +\n  theme(legend.position = \"bottom\")\n\nggplotly(p, tooltip = \"text\")\n\n`geom_smooth()` using formula = 'y ~ x'\n\n\n\n\n\nrm(p)\n\nAnimation ‚Äì Vaccination Trends Over Years\nThis animation shows how vaccination counts across vaccine groups change over time. It helps spot temporal trends and emerging patterns.\n\nanim_plot &lt;- vacc_1524 %&gt;%\n  mutate(vacc_year = as.integer(floor(vacc_year))) %&gt;%\n  count(vacc_year, vacc_group3) %&gt;%\n  ggplot(aes(x = vacc_group3, y = n, fill = vacc_group3)) +\n  geom_col(show.legend = FALSE) +\n  labs(title = 'Year: {frame_time}', x = 'Vaccine Group', y = 'Count') +\n  theme_minimal() +\n  transition_time(vacc_year) +\n  ease_aes('linear')\n\nanim_file &lt;- tempfile(fileext = \".gif\")\nanim &lt;- animate(anim_plot, nframes = 100, fps = 10, renderer = gifski_renderer(anim_file))\nprint(anim)\n\nrm(anim_plot, anim_file, anim)\n\nAnimation ‚Äì Breast Cancer Screening Uptake by State\nThis animated bar chart shows breast cancer screening uptake over time for each Australian state. It uses faceting to compare regional trends.\n\nbreast_anim &lt;- breast_cancer_data %&gt;%\n  filter(!state %in% c(\"Other\", \"Unknown\")) %&gt;%\n  mutate(year_4digit = as.integer(year_4digit)) %&gt;%\n  group_by(state, year_4digit) %&gt;%\n  summarise(total_screened = sum(part50_74, na.rm = TRUE), .groups = \"drop\") %&gt;%\n  ggplot(aes(x = year_4digit, y = total_screened, fill = state)) +\n  geom_col(show.legend = FALSE) +\n  facet_wrap(~ state) +\n  labs(title = 'Year: {frame_time}', x = 'Year', y = 'Women Screened (50‚Äì74 yrs)') +\n  theme_minimal() +\n  transition_time(year_4digit) +\n  ease_aes('linear')\n\nscreening_gif &lt;- tempfile(fileext = \".gif\")\nanim_screen &lt;- animate(breast_anim, nframes = 100, fps = 10, renderer = gifski_renderer(screening_gif))\nprint(anim_screen)\n\nrm(breast_anim, screening_gif, anim_screen)\n\n\n\n\nHeatmap ‚Äì Number of Vaccinations by Month and Weekday Highlights vaccination activity patterns by day of week and month. Darker tiles represent higher counts.\nThe heatmap below demonstrates the number of vaccinations administered across each day of the week and each calendar month. Color intensity indicates the relative number of vaccinations, with darker red representing higher uptake and pale yellow representing lower activity.\nKey Observations:\n\nSaturday consistently shows high uptake, particularly in October, September, and July, suggesting that weekends may be more accessible or preferred for vaccination appointments.\nTuesday in May and Wednesday in August also show pronounced peaks, likely linked to specific campaign efforts or seasonal programs.\nThursday and Friday generally have moderate activity, while Sunday and Monday tend to have lower vaccination counts across most months.\nOverall, the summer and early fall months (July to October) show increased uptake across several weekdays, possibly aligning with back-to-school vaccination drives or respiratory vaccine rollouts.\n\n**Interpretation:**\nThe plot reveals both seasonal and weekly rhythms in vaccination behavior. Recognizing these patterns can guide better scheduling of clinics, resource planning, and public messaging to align with high-demand periods and improve overall vaccine accessibility.\n\n# ................Without  Adding the long Title ........................................................\n# ..............................................................................................\n\n# --- Order weekday and month factors for proper axis display ---\n# --- Convert original vaccination date to Eastern Time (Massachusetts local time) ---\n# Assumes vacc_date is POSIXct or character in UTC or local system time\nvacc_1524 &lt;- vacc_1524 %&gt;%\n  mutate(\n    vacc_datetime_et = with_tz(as.POSIXct(vacc_date, tz = \"UTC\"), tzone = \"America/New_York\"),  # Adjust timezone to Eastern Time\n    vacc_weekday = wday(vacc_datetime_et, label = TRUE, abbr = FALSE),                          # Extract weekday (e.g., Monday)\n    vacc_month_name = month(vacc_datetime_et, label = TRUE, abbr = FALSE)                       # Extract month (e.g., January)\n  )\n\n# --- Order weekday and month factors for proper axis display ---\nvacc_1524 &lt;- vacc_1524 %&gt;%\n  mutate(\n    vacc_month_name = factor(vacc_month_name, levels = month.name),  # Ensure months are in calendar order\n    vacc_weekday = factor(vacc_weekday, levels = c(\"Monday\", \"Tuesday\", \"Wednesday\", \"Thursday\", \"Friday\", \"Saturday\", \"Sunday\"))  # Ensure weekdays are in logical order\n  )\n\n# --- Create heatmap of vaccination counts by weekday and month ---\nvacc_1524 %&gt;%\n  count(vacc_weekday, vacc_month_name) %&gt;%  # Count number of vaccinations by weekday and month\n  ggplot(aes(x = vacc_weekday, y = vacc_month_name, fill = n)) +     # Map weekday to x-axis, month to y-axis, and fill by count\n  geom_tile(color = \"white\") +                                       # Draw heatmap tiles with white border for readability\n  scale_fill_gradientn(                                              # Use custom yellow-to-red color scale\n    colors = c(\"#ffffcc\", \"#ffeda0\", \"#feb24c\", \"#f03b20\", \"#bd0026\"),\n    breaks = scales::pretty_breaks(n = 5),                           # Auto-select 5 good breakpoints for legend\n    name = \"Vaccinated Number\"                                       # Legend title\n  ) +\n  labs(\n    title = \"Vaccination Uptake by Weekday and Month\",               # Plot title\n    subtitle = \"Timestamps interpreted as US Eastern Time (Massachusetts)\",  # Timezone context\n    x = \"Weekday\", y = \"Month\", fill = \"Vaccinated Number\",          # Axis and legend labels\n    caption = \"Note: Original timestamps converted from UTC to America/New_York\"\n  ) +\n  theme_minimal() +\n  theme(\n    text = element_text(family = \"Times New Roman\"),                 # Font style\n    legend.position = \"bottom\",                                      # Move legend below the plot\n    axis.text.x = element_text(angle = 45, hjust = 1, size = 10, face = \"bold\"),  # X-axis label formatting\n    axis.text.y = element_text(size = 10, face = \"bold\"),            # Y-axis label formatting\n    axis.title.x = element_text(face = \"bold\", size = 11),\n    axis.title.y = element_text(face = \"bold\", size = 11),\n    plot.title = element_text(size = 12, face = \"bold\"),\n    legend.title = element_text(size = 10),\n    legend.text = element_text(size = 8)\n  )\n\n\n\n\n\n\n\n# Use figure title below to render in Quarto or Rmarkdown \n#\"Figure XX: Vaccination uptake by weekday and month among individuals aged 15‚Äì24, 2016‚Äì2024.\"\n\n\n# ................Adding the long Title ........................................................\n# ..............................................................................................\n\n# --- Convert original vaccination date to Eastern Time (Massachusetts local time) ---\n# Assumes vacc_date is POSIXct or character in UTC or local system time\nvacc_1524 &lt;- vacc_1524 %&gt;%\n  mutate(\n    vacc_datetime_et = with_tz(as.POSIXct(vacc_date, tz = \"UTC\"), tzone = \"America/New_York\"),  # Adjust timezone to Eastern Time\n    vacc_weekday = wday(vacc_datetime_et, label = TRUE, abbr = FALSE),                          # Extract weekday (e.g., Monday)\n    vacc_month_name = month(vacc_datetime_et, label = TRUE, abbr = FALSE)                       # Extract month (e.g., January)\n  )\n\n# --- Order weekday and month factors for proper axis display ---\nvacc_1524 &lt;- vacc_1524 %&gt;%\n  mutate(\n    vacc_month_name = factor(vacc_month_name, levels = month.name),  # Ensure months are in calendar order\n    vacc_weekday = factor(vacc_weekday, levels = c(\"Monday\", \"Tuesday\", \"Wednesday\", \"Thursday\", \"Friday\", \"Saturday\", \"Sunday\"))  # Ensure weekdays are in logical order\n  )\n\n# --- Create heatmap of vaccination counts by weekday and month ---\np &lt;- vacc_1524 %&gt;%\n  count(vacc_weekday, vacc_month_name) %&gt;%  # Count number of vaccinations by weekday and month\n  ggplot(aes(x = vacc_weekday, y = vacc_month_name, fill = n)) +     # Map weekday to x-axis, month to y-axis, and fill by count\n  geom_tile(color = \"white\") +                                       # Draw heatmap tiles with white border for readability\n  scale_fill_gradientn(                                              # Use custom yellow-to-red color scale\n    colors = c(\"#ffffcc\", \"#ffeda0\", \"#feb24c\", \"#f03b20\", \"#bd0026\"),\n    breaks = scales::pretty_breaks(n = 5),                           # Auto-select 5 good breakpoints for legend\n    name = \"Vaccinated Number\"                                       # Legend title\n  ) +\n  labs(\n    title = \"Vaccination Uptake by Weekday and Month\",               # Plot title\n    x = \"Weekday\", y = \"Month\", fill = \"Vaccinated Number\"           # Axis and legend labels\n  ) +\n  theme_minimal() +\n  theme(\n    text = element_text(family = \"Times New Roman\"),                 # Font style\n    legend.position = \"bottom\",                                      # Move legend below the plot\n    axis.text.x = element_text(angle = 45, hjust = 1, size = 10, face = \"bold\"),  # X-axis label formatting\n    axis.text.y = element_text(size = 10, face = \"bold\"),            # Y-axis label formatting\n    axis.title.x = element_text(face = \"bold\", size = 11),\n    axis.title.y = element_text(face = \"bold\", size = 11),\n    plot.title = element_text(size = 12, face = \"bold\"),\n    legend.title = element_text(size = 10),\n    legend.text = element_text(size = 8)\n  )\n\n# --- Add descriptive figure caption using patchwork's plot_annotation() ---\nfinal_plot &lt;- p + plot_annotation(\n  caption = \"Figure XX: Vaccination uptake by weekday and month among individuals aged 15‚Äì24, 2016‚Äì2024.\",\n  theme = theme(\n    plot.caption = element_text(\n      size = 10, family = \"Times New Roman\", hjust = 0\n    )\n  )\n)\n\n# --- Display the final plot with caption ---\nfinal_plot\n\n\n\n\n\n\n\n# setwd (\"C:/Users/User/Desktop/Materials_ Course and proposals/VIP collection for Syntax code or project titles/R codes/Data Manipulation and Wrangling\")\n# \n# # Save plots\n# ggsave(\"Heatmap_vaccination_pattern by day and month.TIFF\", plot = last_plot(), device = \"tiff\", width = 10, height = 6, units = \"in\")\n# ggsave(\"Heatmap_vaccination_pattern by day and month.svg\", plot = last_plot(), device = \"svg\", width = 10, height = 6, units = \"in\")\n\nrm (p, final_plot)"
  },
  {
    "objectID": "Post_Blog/Data_Manipulation_and_Wrangling/index.html#part-viii-shiny-app-building-web-apps",
    "href": "Post_Blog/Data_Manipulation_and_Wrangling/index.html#part-viii-shiny-app-building-web-apps",
    "title": "Date Manipulation and Wrangling using R",
    "section": "",
    "text": "8.1 UI fluidPage(), sidebarLayout(), sidebarPanel(), mainPanel(), tabsetPanel(), tags$style()\n8.2 Server reactive(), observeEvent(), req(), renderPlotly(), renderDT(), modalDialog(), showModal()\n8.3 App Launch shinyApp(ui, server)\n8.4 Inputs sliderInput(), selectInput(), colourInput(), actionButton(), downloadButton()\n8.5 Outputs plotlyOutput(), DTOutput(), datatable(), formatStyle()\n8.6 DT Features extensions = 'Buttons', export options: copy, csv, excel, pdf, print\n8.7 Styling and Themes tags$style(), (shinythemes::shinytheme() ‚Äì loaded but not applied)\nShiny is a web application framework for R that allows analysts to build interactive dashboards and tools using familiar syntax. It provides a structured approach to turning R scripts into accessible apps for broader audiences.\nA typical Shiny app includes two core components:\n\nUI (User Interface): Defines layout, inputs, and outputs shown on the screen interface.\nServer: Contains the logic that processes data and responds to user interactions.\n\nShiny apps can include multiple views (tabs), export buttons, dynamic filtering, charts, and customized design themes.\n\n\n\n\nfluidPage(): Defines the page layout.\nsidebarLayout(), sidebarPanel(), mainPanel(): Organize inputs and outputs side-by-side.\ntabsetPanel(): Allows tab navigation for multi-page apps.\ntags$style(), shinythemes::shinytheme(): Add or apply custom styles/themes.\n\n\n\n\n\n\nreactive(): Creates reactive data or expressions.\nobserveEvent(): Executes code when a trigger changes.\nreq(): Validates necessary input before proceeding.\nOutput functions: renderPlotly(), renderDT(), renderText(), renderTable().\n\n\n\n\n\n\n\n\n\n\n\n\n\nType\nFunction\nPurpose\n\n\n\n\nInput\nsliderInput()\nSelect a numeric value or range\n\n\nInput\nselectInput()\nDropdown menu to choose a category\n\n\nInput\ncolourInput()\nSelect a color\n\n\nInput\nactionButton()\nTrigger processing on click\n\n\nInput\ndownloadButton()\nDownload output tables or data\n\n\nOutput\nplotlyOutput()\nRender interactive plots using Plotly\n\n\nOutput\nDTOutput(), datatable()\nRender interactive tables\n\n\nOutput\nformatStyle()\nApply styling (e.g., color, font) to tables\n\n\n\n\n\n\n\n\nAdd extensions = 'Buttons' to enable table exports.\nExport types: \"copy\", \"csv\", \"excel\", \"pdf\", \"print\".\n\n\n\n\n\n\nshinyApp(ui, server): Runs the Shiny app combining both UI and server logic.\nApps can be hosted on ShinyApps.io, internal servers, or embedded in R Markdown dashboards.\n\n\nThe Shiny app code below demonstrates how interactive visualizations can be built using R to present health data in an accessible and user-friendly format. Specifically, it explores breast cancer screening uptake across states, years, and age groups in Australia. The app enhances user engagement through customizable features and immediate feedback mechanisms.\nKey capabilities demonstrated include: - Dynamic UI generation using fluidPage(), sidebarLayout(), and interactive widgets - State selection using a dropdown (selectInput()), which scales better than radio buttons - Age group filtering with a multiple selection input - Quantile-based filtering with sliderInput() for rate grouping - Color customization of output using colourInput() for personalizing table aesthetics - A modal popup (modalDialog()) triggered by a help button to explain data sources - Export options via downloadButton() and DT export buttons for multiple file formats - Real-time data filtering using reactive() expressions to tailor output to user input - An interactive line plot rendered via plotly and ggplot2 for visualization - Fully styled, downloadable data table with DT::renderDT() and export capabilities\nSee the live app at the following platforms\n\nAnalyticsHub YouTube: https://studio.youtube.com/video/5V7SPBH-8BE/edit\nLive App: https://j9eu4e-habtamu-mellie0bizuayehu.shinyapps.io/Breast_Cancer_Screening_Shiny_App/\n\n\n# Install required packages if not already installed\nrequired_packages &lt;- c(\"shiny\", \"ggplot2\", \"plotly\", \"DT\", \"dplyr\", \"shinyjs\", \"shinyWidgets\", \"scales\", \"colourpicker\")\n\n# Install missing ones\nnew_packages &lt;- required_packages[!(required_packages %in% installed.packages()[,\"Package\"])]\nif(length(new_packages)) install.packages(new_packages)\n\n# Load packages\nlibrary(shiny)\nlibrary(ggplot2)\nlibrary(plotly)\nlibrary(DT)\nlibrary(dplyr)\nlibrary(shinyjs)\nlibrary(shinyWidgets)\nlibrary(scales)\nlibrary(colourpicker)\n\n\n# load the data\nload(\"C:/Users/User/Desktop/Materials_ Course and proposals/VIP collection for Syntax code or project titles/R codes/Shiny App BC Screening/Breast Cancer Screening.RData\")\n\n\n# -------------------Shiny Application for Breast Cancer Screening---------------------\n\n\n# ------------------- UI and Server Definition ---------------------\n\n# Define custom CSS for styling buttons and other UI elements\nui &lt;- fluidPage(\n  \n  # Application title displayed at the top of the app\n  h1(\"Breast Cancer Screening Uptake\"),\n\n  # Apply custom styling to the download button\n  tags$style(HTML(\"\n    #download_data {\n      background: orange;\n      font-size: 20px;\n    }\n  \")),  \n\n  # Layout structure: sidebar for inputs and main panel for outputs\n  sidebarLayout(\n    sidebarPanel(\n      \n      # Quantile-based slider to filter screening rate\n      sliderInput(\"rate_10_group\", \"Rate Group\", \n                  min = min(breast_cancer_long$rate_10_group, na.rm = TRUE), \n                  max = max(breast_cancer_long$rate_10_group, na.rm = TRUE), \n                  value = c(5, 7)),\n      \n      # Dropdown menu for state selection (simplifies and scales better than radio buttons)\n      selectInput(\"state\", \"Select State\",  \n                  choices = unique(breast_cancer_long$state), \n                  selected = \"WA\"),\n\n      # Multi-select dropdown for age groups (allows viewing multiple demographics)\n      selectInput(\"age_group\", \"Women's Age Group\", \n                  choices = unique(breast_cancer_long$age_group), \n                  multiple = TRUE,\n                  selected = unique(breast_cancer_long$age_group)[1]),\n\n      # Add colour input to allow users to control table font colour\n      colourInput(\"color\", \"Point color\", value = \"blue\"),\n\n      # Add a help button that triggers a modal popup for guidance\n      actionButton(\"show_help\", \"Help\"),\n\n      # Add a download button for exporting filtered dataset\n      downloadButton(\"download_data\", \"Download Data\")\n    ),\n\n    mainPanel(\n      # Render the interactive line chart\n      plotlyOutput(\"plot\"),\n\n      # Render the data table output\n      DTOutput(\"table\")\n    )\n  )\n)\n\n# Define server-side logic for rendering outputs and interactivity\nserver &lt;- function(input, output, session) {\n\n  # Show Help Modal: explains data source when help button is clicked\n  observeEvent(input$show_help, {\n    showModal(modalDialog(\n      title = \"Help\",\n      \"This data was compiled from the Australian Institute of Health and Welfare.\"\n    ))\n  })\n\n  # Reactive expression to filter and summarize the dataset based on inputs\n  filtered_data &lt;- reactive({\n    req(input$rate_10_group, input$state, input$age_group)  # Ensure all inputs are available\n\n    breast_cancer_long %&gt;%\n      filter(rate_10_group &gt;= input$rate_10_group[1] & \n               rate_10_group &lt;= input$rate_10_group[2],\n             state == input$state,\n             age_group %in% input$age_group) %&gt;%\n      group_by(year, state, age_group) %&gt;%\n      summarise(year = as.integer(year),  # Convert year to integer for plotting\n                rate = round(mean(rate, na.rm = TRUE), 1),  # Average screening rate\n                .groups = \"drop\") \n  })\n\n  # Render Table: displays filtered data in an interactive table with export options\n  output$table &lt;- renderDT({\n    datatable(filtered_data(), \n              options = list(\n                pageLength = 10,  # Show 10 rows per page\n                dom = 'Bfrtip',  # Include Buttons (copy, csv, pdf, etc.)\n                buttons = c('copy', 'csv', 'excel', 'pdf', 'print'),\n                class = \"display nowrap compact\"  # Responsive and compact table design\n              ),\n              extensions = 'Buttons',\n              style = \"bootstrap\", \n              class = \"table table-striped table-bordered\") %&gt;%\n      formatStyle(columns = names(filtered_data()), color = input$color)  # Use selected color\n  })\n\n  # Download Handler: enables users to download filtered data\n  output$download_data &lt;- downloadHandler(\n    filename = \"Breast_cancer_screening_data.csv\",\n    content = function(file) {\n      write.csv(filtered_data(), file, row.names = FALSE)\n    }\n  )\n\n  # Render Plot: displays line plot of screening rates over time by age group\n  output$plot &lt;- renderPlotly({\n    df &lt;- filtered_data()\n\n    p &lt;- ggplot(df, aes(x = year, y = rate, color = age_group, group = interaction(state, age_group))) +\n      geom_line(size = 1) +  # Draw lines to show trend\n      geom_point(size = 3) +  # Add points to emphasize data values\n      labs(title = \"Breast Cancer Screening Uptake\", \n           x = \"Year\", \n           y = \"Screening Rate\",\n           color = \"Age Group\") +\n      theme_minimal()\n\n    ggplotly(p)  # Convert ggplot to interactive plotly chart\n  })\n}\n\n# Launch the app\nshinyApp(ui, server)"
  },
  {
    "objectID": "Post_Blog/Date_and_Time_Data_analysis/index.html",
    "href": "Post_Blog/Date_and_Time_Data_analysis/index.html",
    "title": "Date-Time Data Analysis in R",
    "section": "",
    "text": "This presentation introduces essential techniques for analyzing date and time data in health research using R. Key topics include:\n\nImportance of date/time analysis\nCore R packages for handling dates (e.g., lubridate, tidyverse)\nDate conversion and formatting\nCalculating durations and age\nExtracting date components (e.g., month, weekday, season)\nSummary and Visualize time-based trends\n\n1. Importance of Date/Time Analysis in Health Data\nDate-time data is crucial in healthcare because it allows us to:\n\nCalculate accurate patient ages, service time\nMeasure time intervals between critical events (e.g., diagnosis to treatment, age vaccination)\nIdentify seasonal patterns in disease occurrence\nTrack vaccine effectiveness over time\nDetermine follow-up periods for clinical studies"
  },
  {
    "objectID": "Post_Blog/Date_and_Time_Data_analysis/index.html#weekday-heatmap",
    "href": "Post_Blog/Date_and_Time_Data_analysis/index.html#weekday-heatmap",
    "title": "Date-Time Data Analysis in R",
    "section": "9.1 Weekday Heatmap",
    "text": "9.1 Weekday Heatmap\nThe heatmap identifies temporal service patterns. Higher intensity on Wednesdays/Thursdays may reflect clinic scheduling norms, while weekend gaps could indicate access barriers.\n\nvacc_1524 %&gt;%\n  count(vacc_month_name, vacc_weekday) %&gt;%\n  ggplot(aes(x = vacc_weekday, y = vacc_month_name, fill = n)) +\n  geom_tile(color = \"white\") +\n  scale_fill_gradient(low = \"#f7fbff\", high = \"#08306b\") +\n  labs(title = \"Vaccination Intensity by Weekday and Month\",\n       x = \"Weekday\", y = \"Month\") +\n  theme_minimal() +\n  theme(legend.position = \"bottom\")"
  },
  {
    "objectID": "Post_Blog/Date_and_Time_Data_analysis/index.html#seasonal-vaccination-distribution",
    "href": "Post_Blog/Date_and_Time_Data_analysis/index.html#seasonal-vaccination-distribution",
    "title": "Date-Time Data Analysis in R",
    "section": "9.2 Seasonal Vaccination Distribution",
    "text": "9.2 Seasonal Vaccination Distribution\nExplore how vaccination services vary by season.\n\nvacc_1524 %&gt;%\n  mutate(month = as.numeric(format(vacc_date, \"%m\")),\n         season = case_when(\n           month %in% c(12, 1, 2) ~ \"Summer\",\n           month %in% c(3, 4, 5) ~ \"Autumn\",\n           month %in% c(6, 7, 8) ~ \"Winter\",\n           month %in% c(9, 10, 11) ~ \"Spring\"\n         )) %&gt;%\n  count(season) %&gt;%\n  ggplot(aes(x = season, y = n, fill = season)) +\n  geom_col() +\n  labs(\n    title = \"Seasonal Vaccination Distribution\",\n    x = \"Season\",\n    y = \"Vaccination Count\"\n  ) +\n  theme_minimal()"
  },
  {
    "objectID": "Post_Blog/Date_and_Time_Data_analysis/index.html#vaccination-proportion-by-year-and-race",
    "href": "Post_Blog/Date_and_Time_Data_analysis/index.html#vaccination-proportion-by-year-and-race",
    "title": "Date-Time Data Analysis in R",
    "section": "9.3 Vaccination proportion by year and race",
    "text": "9.3 Vaccination proportion by year and race\nIf we‚Äôd like a stacked bar plot of the proportions\n\n# Proportion by vacc_year and race with cleaned race labels\ndf_plot_race &lt;- vacc_1524 %&gt;%\n  mutate(\n    race = ifelse(race %in% c(\"native\", \"other\"), \"Other\", race),\n    race = str_to_title(race),\n    vacc_year = as.integer(floor(as.numeric(vacc_year)))  # Ensure whole number\n  ) %&gt;%\n  group_by(race, vacc_year) %&gt;%\n  summarise(count = n(), .groups = \"drop\") %&gt;%\n  group_by(race) %&gt;%\n  mutate(\n    total = sum(count),\n    proportion = (count / total) * 100\n  ) %&gt;%\n  ungroup()\n\n# Line plot\nggplot(df_plot_race, aes(x = vacc_year, y = proportion, color = race)) +\n  geom_line(linewidth = 1) +\n  geom_point(size = 2) +\n  scale_x_continuous(breaks = seq(min(df_plot_race$vacc_year), max(df_plot_race$vacc_year), by = 2)) +\n  labs(\n    title = \"Vaccination Proportion by Race and Year\",\n    x = \"Vaccination Year\",\n    y = \"Proportion (%)\",\n    color = \"Race\"\n  ) +\n  theme_minimal() +\n  theme(\n    legend.position = \"right\",\n    plot.title = element_text(hjust = 0.5)\n  )\n\n\n\n\n\n\n\n# Bar plot\nggplot(df_plot_race, aes(x = vacc_year, y = proportion, fill = race)) +\n  geom_bar(stat = \"identity\", position = \"stack\") +\n  scale_x_continuous(breaks = seq(min(df_plot_race$vacc_year), max(df_plot_race$vacc_year), by = 2)) +\n  labs(\n    title = \"Vaccination Proportion by Race and Year\",\n    x = \"Vaccination Year\",\n    y = \"Proportion (%)\",\n    fill = \"Race\"\n  ) +\n  theme_minimal()\n\n\n\n\n\n\n\n\n\n# Proportion by vacc_year and gender\nvacc_1524 %&gt;%\n  mutate(\n    gender = case_when(\n      gender == \"M\" ~ \"Male\",\n      gender == \"F\" ~ \"Female\",\n      TRUE ~ gender\n    ),\n    vacc_year = as.integer(vacc_year)  # Ensure year is whole number\n  ) %&gt;%\n  group_by(gender, vacc_year) %&gt;%\n  summarise(count = n(), .groups = \"drop\") %&gt;%\n  group_by(gender) %&gt;%\n  mutate(\n    total = sum(count),\n    proportion = (count / total) * 100\n  ) %&gt;%\n  ungroup() %&gt;% \n  \n  ggplot(aes(x = vacc_year, y = proportion, color = gender)) +\n  geom_line(linewidth = 1) +\n  geom_point(size = 2) +\n  scale_x_continuous(breaks = scales::pretty_breaks()) +  # Ensures whole number years\n  labs(\n    title = \"Vaccination Proportion by Gender and Year\",\n    x = \"Vaccination Year\",\n    y = \"Proportion (%)\",\n    color = \"Gender\"\n  ) +\n  scale_color_manual(values = c(\"Male\" = \"#1f77b4\", \"Female\" = \"#ff7f0e\")) +\n  theme_minimal() +\n  theme(\n    legend.position = \"right\",\n    plot.title = element_text(hjust = 0.5, size = 14, face = \"bold\"),\n    axis.title = element_text(size = 12),\n    legend.title = element_text(size = 12)\n  )"
  },
  {
    "objectID": "Post_Blog/Date_and_Time_Data_analysis/index.html#vaccination-proportion-by-month-and-year",
    "href": "Post_Blog/Date_and_Time_Data_analysis/index.html#vaccination-proportion-by-month-and-year",
    "title": "Date-Time Data Analysis in R",
    "section": "9.4 Vaccination proportion by month and year",
    "text": "9.4 Vaccination proportion by month and year"
  },
  {
    "objectID": "Post_Blog/Date_and_Time_Data_analysis/index.html#summary-and-key-takeaways",
    "href": "Post_Blog/Date_and_Time_Data_analysis/index.html#summary-and-key-takeaways",
    "title": "Date-Time Data Analysis in R",
    "section": "9.5 Summary and Key Takeaways",
    "text": "9.5 Summary and Key Takeaways\nKey techniques covered:\n\nProper date conversion from character strings\nAccurate age and time difference calculations\nSeasonal and temporal pattern analysis\nVisualization of date-based trends\nSurvival analysis for time-to-event data\n\nBest practices:\n\nAlways validate date conversions\nDocument time units clearly (days vs.¬†months vs.¬†years)\nHandle missing dates explicitly\nConsider time zones for multi-center studies\n\nReferences\n\nhttps://CRAN.R-project.org/package=dplyr\nhttps://www.jstatsoft.org/article/view/v103i01\nhttps://r4ds.hadley.nz/"
  },
  {
    "objectID": "Post_Blog/Table_automation_Ideas/index.html",
    "href": "Post_Blog/Table_automation_Ideas/index.html",
    "title": "Automating Publication-Ready Tables in R",
    "section": "",
    "text": "This section presents a walkthrough of generating a publication-ready table. The aim is to summarize and format data in a professional way. The key steps include:\n\nCleaning and preparing data for consistency.\nCreating summary tables for different variables.\nCombining and styling tables for clear visual presentation.\nAutomating the process using flextable.\n\nThe code below demonstrates how to achieve these steps. I will demonstrate how to generate a clean, publication-ready summary table using R. The approach combines data manipulation with dplyr, summary tabulation with janitor, and elegant styling via the flextable package.\nThis process is especially useful for public health datasets with categorical variables like age, gender, or service dates and includes options for handling missing data, calculating row percentages, column percentages and customizing formatting such as font type, table width, and color.\nBy automating these steps, we can save time, reduce manual formatting errors, and ensure consistency across tables.\nüîπ Step 1: Load Required Libraries\n\n# Clear environment and console\nrm(list = ls()) \ncat(\"\\014\")\n\n# Load required packages\n#gc() #garbage collector to clean up the workspace.\noptions(repos = c(CRAN = \"https://cran.rstudio.com\"))\n\n# List of required packages for Date and Time Data Analysis\npackages &lt;- c(\n  \"lubridate\", \"dplyr\", \"stringr\", \"zoo\", \"tsibble\", \"ggplot2\", \"plotly\", \n  \"readr\", \"forecast\", \"prettydoc\", \"janitor\", \"knitr\", \"rmarkdown\", \"yaml\", \n  \"flextable\", \"scales\", \"gt\", \"reactable\", \"tidyverse\", \"tidyr\", \"officer\"\n)\n\n# Install and load packages with descriptions\nfor (pkg in packages) {\n  if (!require(pkg, character.only = TRUE)) {\n    install.packages(pkg)\n  }\n}\n\n# Install quarto if not already installed\nif (!requireNamespace(\"quarto\", quietly = TRUE)) install.packages(\"quarto\")\n\n\n# **Load required libraries**\n\nlibrary(lubridate) # Simplifies the manipulation of dates and times in R (e.g., formatting, extracting components)\nlibrary(dplyr) # Provides tools for data manipulation, helpful for filtering and summarizing date-based data\nlibrary(stringr) # Simplifies string manipulation\nlibrary(tidyr)   # Reshaping and tidying data\n\nlibrary(zoo) # For working with time series data, including rolling calculations and handling missing data in time series\nlibrary(tsibble) # Provides tools for handling time series data, including date-time indexes and features for forecasting\n\nlibrary(readr) # For reading date-time data from CSV\nlibrary(haven) #  data from other statistical software formats (SPSS, SAS, Stata)\nlibrary(forecast) # Useful for time series forecasting, especially when working with seasonal or trend-based data\nlibrary(ggplot2) # For visualizing date-time trends in data (e.g., time series plots)\nlibrary(janitor) # Tabulation, cleaning column names, adding totals and proportions\nlibrary (plotly)     # Interactive visualizations\n\n# Documentation/reporting\nlibrary(prettydoc)  # Pretty document templates\nlibrary(flexdashboard)# Interactive dashboards\nlibrary(quarto)  # For rendering and publishing documents with the Quarto framework\nlibrary(yaml)       # YAML document processing\n\n# Tabulation\nlibrary(flextable)  # for creating styled, publication-ready tables\nlibrary(gt)         # Grammar of tables\nlibrary(reactable)  # Interactive tables\n\nlibrary(scales) # for number formatting (e.g., commas)\nlibrary(officer)  #  For exporting tables/reports to Word or PowerPoint\n\n\nsetwd(\"C:/Users/User/Desktop/Materials_ Course and proposals/Course Related/DataCamp/Data/\")\nload(\"Vaccination_uptake.RDATA\")\n\nüîπ Step 2: Convert Grouping Variables to Character\nBefore we tabulate values, we need to ensure all grouping variables have a consistent format. The table-generating function later in this workflow expects character values. If a mix of numeric and character types is used, the output may fail or be misaligned.\n\nvacc_1524 &lt;- vacc_1524 %&gt;%   mutate(across(c(age_group, gender, marital_status,                   vacc_service_year, vacc_quarter, vacc_weekday), as.character))\n\nüí° Why this matters: If one variable like gender is stored as a character and another like age_group is numeric, the table creation function won‚Äôt process them uniformly. This step ensures compatibility and consistency.\nüîπ Step 3: Define a Table Generation Function\nThis section defines a reusable function that creates a summary table for any categorical variable of interest.\n\ncreate_tab &lt;- function(data, var, label) {\n  # Step 1: Generate counts for non-missing values\n  tab_main &lt;- data %&gt;%\n    filter(!is.na({{ var }})) %&gt;%          # Exclude missing values\n    tabyl({{ var }}, vacc_group3) %&gt;%      # Cross-tabulate (var √ó vaccine groups)\n    mutate(Category = label, .before = 1) %&gt;%  # Add category label (e.g., \"Gender\")\n    rename(Label = {{ var }}) %&gt;%           # Rename variable column for consistency\n    mutate(Label = as.character(Label))     # Ensure labels are text\n\n  # Step 2: Check for and append missing values (if any)\n  na_count &lt;- sum(is.na(pull(data, {{ var }})))\n  if (na_count &gt; 0) {\n    missing_row &lt;- tibble(\n      Category = label,\n      Label = \"Missing\",\n      `Respiratory vaccines` = sum(data$vacc_group3 == \"Respiratory vaccines\" & is.na(pull(data, {{ var }})), na.rm = TRUE),\n      ...  # Similar for other vaccine groups\n    )\n    tab_final &lt;- bind_rows(tab_main, missing_row)  # Combine with main table\n  } else {\n    tab_final &lt;- tab_main\n  }\n  return(tab_final)\n}\n\nLet‚Äôs break it down:\n\ndata: The full dataset (vacc_1524) you are analyzing.\nvar: A single categorical variable (e.g., age_group) whose values will appear as rows.\nlabel: A string label that describes the variable for the final table (e.g., \"Age\").\n\nInside the function:\n\nWe filter out missing values temporarily to generate the main table using tabyl().\nWe count and append missing entries separately, if any.\nWe return a single tibble containing counts across vaccine groups by value of the selected variable.\n\nThis abstraction allows us to apply one function to multiple variables.\nüîπ Step 4: Generate Summary Tables for Each Variable\nThe code below creates summary tables for several key variables: age, gender, marital status, service year, quarter, and weekday.\n\ntab_age            &lt;- create_tab(vacc_1524, age_group, \"Age\")\ntab_sex            &lt;- create_tab(vacc_1524, gender, \"Gender\")\ntab_marital_status &lt;- create_tab(vacc_1524, marital_status, \"Marital status\")\ntab_year           &lt;- create_tab(vacc_1524, vacc_service_year, \"Year\")\ntab_quarter        &lt;- create_tab(vacc_1524, vacc_quarter, \"Quarter\")\ntab_weekday        &lt;- create_tab(vacc_1524, vacc_weekday, \"Weekday\")\n\nEach result is a well-structured table of vaccine uptake by subgroup.\nüîπ Step 5: Combine All Summary Tables\nHere, we merge the results into one combined table that can be styled and displayed together.\n\ntab_combined &lt;- bind_rows(tab_sex, tab_age, tab_marital_status, tab_year, tab_quarter, tab_weekday)\n\nWe are now working with one long-format table that contains all the variables of interest.\nüîπ Step 6: Calculate Row-Wise Percentages and Format Counts\nNext, I add percentages for each vaccine type within a row (e.g., among all women aged 20‚Äì29, what percent received respiratory vaccines?). I also format the counts with commas for easier reading.\n\ntab_combined &lt;- tab_combined %&gt;%\n  rowwise() %&gt;%\n  mutate(\n    Total = sum(`Respiratory vaccines`, `Childhood vaccines`, Other, na.rm = TRUE),\n    is_missing = trimws(tolower(Label)) == \"missing\",\n    \n    Respiratory = ifelse(is_missing,\n                         comma(`Respiratory vaccines`),\n                         paste0(comma(`Respiratory vaccines`), \" (\", round(100 * `Respiratory vaccines` / Total, 1), \")\")),\n    \n    Childhood = ifelse(is_missing,\n                       comma(`Childhood vaccines`),\n                       paste0(comma(`Childhood vaccines`), \" (\", round(100 * `Childhood vaccines` / Total, 1), \")\")),\n    \n    Other_grp = ifelse(is_missing,\n                       comma(Other),\n                       paste0(comma(Other), \" (\", round(100 * Other / Total, 1), \")\"))\n  ) %&gt;%\n  ungroup() %&gt;%\n  select(Category, Label, Respiratory, Childhood, Other_grp)\n\nüëâ Note: We skip calculating percentages for ‚ÄúMissing‚Äù rows to avoid misleading results.\nüîπ Step 7: Show Category Name Once per Block\nTo improve readability, I only show the category name (like ‚ÄúAge‚Äù or ‚ÄúGender‚Äù) once per group.\n\ntab_combined &lt;- tab_combined %&gt;%\n  group_by(Category) %&gt;%\n  mutate(Category = ifelse(row_number() == 1, Category, \"\")) %&gt;%\n  ungroup()\n\nüîπ Step 8: Count Total Vaccine Recipients (for Header Labels)\nWe calculate the total number of people who received each type of vaccine to include in the header row.\n\ntotals &lt;- vacc_1524 %&gt;%   count(vacc_group3) %&gt;%   deframe()\n\nüîπ Step 9: Style the Table Using {flextable}\nNow comes the fun part! We format and stylize the table with headers, font choices, alternating colors, and footnotes. This creates a visually appealing table suitable for publication.\n\n# ft_vacc_summary &lt;- tab_combined %&gt;%   flextable() %&gt;%   set_header_labels(...) %&gt;%   add_header_row(...) %&gt;%   add_header_row(...) %&gt;%   theme_box() %&gt;%   set_table_properties(layout = \"autofit\", width = 1) %&gt;%   width(...) %&gt;%   align(align = \"justify\", part = \"all\") %&gt;%   border_remove() %&gt;%   set_caption(...) %&gt;%   fontsize(...) %&gt;%   font(part = \"all\", fontname = \"Times New Roman\") %&gt;%   bg(part = \"header\", bg = \"lightblue\") %&gt;%   bg(j = 1:5, i = seq(1, nrow(tab_combined), 2), bg = \"lightgray\") %&gt;%   bg(j = 1:5, i = seq(2, nrow(tab_combined), 2), bg = \"red\") %&gt;%   footnote(...)\n\nKey Steps:\n\nSet Headers: Labels columns appropriately such as including multi-row headers that describe each vaccine group with sample size (N)\nAdd Header Rows: Includes multi-level headers for clarity.\nThemes and Layout: Applies a boxed theme, adjusts column widths, and aligns text.\nFont and Colors: Uses ‚ÄúTimes New Roman‚Äù and alternates row colors (e.g., gray and red) for better visuals.\nAdd Captions, Superscripts and Footnotes: Provides context to the table.\n\nüîπ Step 10: Display the Table\nüîπ Step 11: Clean Up Temporary Objects\nTo keep your R environment tidy, we remove the temporary tables and variables created along the way.\n\nrm(tab_age, tab_sex, tab_marital_status, tab_year, tab_quarter, tab_weekday,     tab_combined, ft_vacc_summary, totals, create_tab)\n\n\n\nThis section introduces a basic version of the automated table‚Äîminimal and clean without captions or footnotes.\n\nWhy it matters: A stripped-down table is great for quick previews or inline summaries.\nWhen to use: Internal drafts, early analysis stages, or dashboards.\nEnsure grouping variables are characters to avoid formatting issues.\nBuild one reusable function (create_tab) to apply across multiple variables.\nBind all summary tables into a combined format.\nAdd row-wise percentages directly to the table.\n\n\n# ------------1. Table without title and footer -------------------------------------------+\n#.......................Ensure grouping variables are characters............................\nvacc_1524 &lt;- vacc_1524 %&gt;%\n  mutate(across(c(vacc_service_year, vacc_quarter, vacc_weekday), as.character))\n\n# ---------------- Table generation function ....................\ncreate_tab &lt;- function(data, var, label) {\n  data %&gt;%\n    filter(!is.na({{ var }})) %&gt;%\n    tabyl({{ var }}, vacc_group3) %&gt;%\n    mutate(Category = label, .before = 1) %&gt;%\n    rename(Label = {{ var }}) %&gt;%\n    mutate(Label = as.character(Label))\n}\n\n# .................... Create summary tables ....................\ntab_age &lt;- create_tab(vacc_1524, age_group, \"Age\")\ntab_sex &lt;- create_tab(vacc_1524, gender, \"Gender\")\ntab_marital_status &lt;- create_tab(vacc_1524, marital_status, \"Marital status\")\ntab_year    &lt;- create_tab(vacc_1524, vacc_service_year, \"Year\")\ntab_quarter &lt;- create_tab(vacc_1524, vacc_quarter, \"Quarter\")\ntab_weekday &lt;- create_tab(vacc_1524, vacc_weekday, \"Weekday\")\n\n# ......................Combine all tabs ....................\ntab_combined &lt;- bind_rows(tab_sex, tab_age, tab_marital_status, tab_year, tab_quarter, tab_weekday)\n\n# ....................... Create row % and format as text ....................\ntab_combined &lt;- tab_combined %&gt;%\n  rowwise() %&gt;%\n  mutate(\n    Total = sum(`Respiratory vaccines`, `Childhood vaccines`, Other, na.rm = TRUE),\n    Respiratory = paste0(comma(`Respiratory vaccines`), \" (\", round(100 * `Respiratory vaccines` / Total, 1), \")\"),\n    Childhood   = paste0(comma(`Childhood vaccines`), \" (\", round(100 * `Childhood vaccines` / Total, 1), \")\"),\n    Other_grp   = paste0(comma(Other), \" (\", round(100 * Other / Total, 1), \")\")\n  ) %&gt;%\n  ungroup()\n\n# ............................. Remove repeated variable names ....................\ntab_combined &lt;- tab_combined %&gt;%\n  group_by(Category) %&gt;%\n  mutate(Category = ifelse(row_number() == 1, Category, \"\")) %&gt;%\n  ungroup()\n\n# ........................... Get total counts per vaccine group ....................\ntotals &lt;- vacc_1524 %&gt;%\n  count(vacc_group3) %&gt;%\n  deframe()\n\n# .................... Create flextable ....................\nft_vacc_summary &lt;- tab_combined %&gt;%\n  select(Category, Label, Respiratory, Childhood, Other_grp) %&gt;%\n  flextable() %&gt;%\n  set_header_labels(\n    Category = \"Variable type\",\n    Label = \"Values\",\n    Respiratory = \"Number (%)·µÉ\",\n    Childhood = \"Number (%)·µÉ\",\n    Other_grp = \"Number (%)·µÉ\"\n  ) %&gt;%\n  add_header_row( # Second row\n    values = c(\n      \"\", \"\",\n      paste0(\"Respiratory vaccines (N = \", format(totals[\"Respiratory vaccines\"], big.mark = \",\"), \")\"),\n      paste0(\"Childhood vaccines (N = \", format(totals[\"Childhood vaccines\"], big.mark = \",\"), \")\"),\n      paste0(\"Other (N = \", format(totals[\"Other\"], big.mark = \",\"), \")\")\n    )\n  ) %&gt;%\n  add_header_row( # First row (merged header)\n    values = c(\"Description\", \"Vaccination uptake\"),\n    colwidths = c(2, 3)\n  ) %&gt;%\n  theme_box() %&gt;%\n  set_table_properties(layout = \"autofit\", width = 1) %&gt;%\n  width(j = 1, width = 1.5) %&gt;%\n  width(j = 2, width = 2.5) %&gt;%\n  width(j = 3:4, width = 1.5) %&gt;%\n  align(align = \"justify\", part = \"all\") %&gt;%\n  border_remove() %&gt;%\n  border(part = \"header\", i = 1, border.top = fp_border(color = \"black\", width = 1)) %&gt;%\n  border(part = \"header\", i = 3, border.bottom = fp_border(color = \"black\", width = 1)) %&gt;%\n  border_inner_h(part = \"header\", border = fp_border(color = \"black\", width = 0.8)) %&gt;%\n  border_inner_h(part = \"body\", border = fp_border(color = \"black\", width = 0.8)) %&gt;%\n  border(part = \"body\", i = nrow(tab_combined), border.bottom = fp_border(color = \"black\", width = 1)) \n  \n# --- Display the table ---\nft_vacc_summary\n\nDescriptionVaccination uptakeRespiratory vaccines (N = 955)Childhood vaccines (N = 472)Other (N = 126)Variable typeValuesNumber (%)·µÉNumber (%)·µÉNumber (%)·µÉGenderFemale511 (64)233 (29.2)54 (6.8)Male444 (58.8)239 (31.7)72 (9.5)Age0-19250 (38.9)302 (47)90 (14)20-29150 (68.2)70 (31.8)0 (0)30-3947 (71.2)19 (28.8)0 (0)40-49142 (75.9)45 (24.1)0 (0)50-59112 (77.8)14 (9.7)18 (12.5)60-69149 (87.6)13 (7.6)8 (4.7)70+105 (84.7)9 (7.3)10 (8.1)Marital statusDivorced136 (83.4)15 (9.2)12 (7.4)Married289 (79)59 (16.1)18 (4.9)Single/widowed150 (79.4)33 (17.5)6 (3.2)Year201578 (51)56 (36.6)19 (12.4)201684 (60.4)47 (33.8)8 (5.8)201775 (54.7)52 (38)10 (7.3)201881 (53.6)52 (34.4)18 (11.9)201983 (51.6)60 (37.3)18 (11.2)202082 (59.9)44 (32.1)11 (8)2021223 (84.8)34 (12.9)6 (2.3)202288 (73.3)25 (20.8)7 (5.8)202387 (51.2)63 (37.1)20 (11.8)202474 (60.7)39 (32)9 (7.4)Quarter1253 (62.8)120 (29.8)30 (7.4)2220 (58.5)117 (31.1)39 (10.4)3295 (63.2)139 (29.8)33 (7.1)4187 (60.9)96 (31.3)24 (7.8)WeekdayFriday141 (78.3)31 (17.2)8 (4.4)Monday114 (64.4)49 (27.7)14 (7.9)Saturday160 (63.2)81 (32)12 (4.7)Sunday156 (56.3)100 (36.1)21 (7.6)Thursday167 (66)66 (26.1)20 (7.9)Tuesday108 (65.5)43 (26.1)14 (8.5)Wednesday109 (44)102 (41.1)37 (14.9)\n\n# --- Clean up environment ---\nrm(tab_year, tab_quarter, tab_weekday, tab_combined, totals, create_tab, ft_vacc_summary)\n\n\n\n\nThis extends the previous section by including a clear table caption and an explanatory footnote.\nüßæ Why this is important:\n\nCaptions add context‚Äîespecially in reports.\nFootnotes help clarify how metrics are calculated (e.g., row percentages).\n\nüìò Best used when: Preparing for publication, stakeholder presentations, or final reports.\n\n# ------------2. Table with Title and Footer -------------------------------------------\n\n#.......................Ensure grouping variables are characters............................\nvacc_1524 &lt;- vacc_1524 %&gt;%\n  mutate(across(c(vacc_service_year, vacc_quarter, vacc_weekday), as.character))\n\n# ---------------- Table generation function ....................\ncreate_tab &lt;- function(data, var, label) {\n  data %&gt;%\n    filter(!is.na({{ var }})) %&gt;%\n    tabyl({{ var }}, vacc_group3) %&gt;%\n    mutate(Category = label, .before = 1) %&gt;%\n    rename(Label = {{ var }}) %&gt;%\n    mutate(Label = as.character(Label))\n}\n\n# .................... Create summary tables ....................\ntab_age &lt;- create_tab(vacc_1524, age_group, \"Age\")\ntab_sex &lt;- create_tab(vacc_1524, gender, \"Gender\")\ntab_marital_status &lt;- create_tab(vacc_1524, marital_status, \"Marital status\")\ntab_year    &lt;- create_tab(vacc_1524, vacc_service_year, \"Year\")\ntab_quarter &lt;- create_tab(vacc_1524, vacc_quarter, \"Quarter\")\ntab_weekday &lt;- create_tab(vacc_1524, vacc_weekday, \"Weekday\")\n\n# ......................Combine all tabs ....................\ntab_combined &lt;- bind_rows(tab_sex, tab_age, tab_marital_status, tab_year, tab_quarter, tab_weekday)\n\n# ....................... Create row % and format as text ....................\ntab_combined &lt;- tab_combined %&gt;%\n  rowwise() %&gt;%\n  mutate(\n    Total = sum(`Respiratory vaccines`, `Childhood vaccines`, Other, na.rm = TRUE),\n    Respiratory = paste0(comma(`Respiratory vaccines`), \" (\", round(100 * `Respiratory vaccines` / Total, 1), \")\"),\n    Childhood   = paste0(comma(`Childhood vaccines`), \" (\", round(100 * `Childhood vaccines` / Total, 1), \")\"),\n    Other_grp   = paste0(comma(Other), \" (\", round(100 * Other / Total, 1), \")\")\n  ) %&gt;%\n  ungroup()\n\n# ............................. Remove repeated variable names ....................\ntab_combined &lt;- tab_combined %&gt;%\n  group_by(Category) %&gt;%\n  mutate(Category = ifelse(row_number() == 1, Category, \"\")) %&gt;%\n  ungroup()\n\n# ........................... Get total counts per vaccine group ....................\ntotals &lt;- vacc_1524 %&gt;%\n  count(vacc_group3) %&gt;%\n  deframe()\n\n# .................... Create flextable ....................\nft_vacc_summary &lt;- tab_combined %&gt;%\n  select(Category, Label, Respiratory, Childhood, Other_grp) %&gt;%\n  flextable() %&gt;%\n  set_header_labels(\n    Category = \"Variable type\",\n    Label = \"Values\",\n    Respiratory = \"Number (%)·µÉ\",\n    Childhood = \"Number (%)·µÉ\",\n    Other_grp = \"Number (%)·µÉ\"\n  ) %&gt;%\n  add_header_row( # Second row\n    values = c(\n      \"\", \"\",\n      paste0(\"Respiratory vaccines (N = \", format(totals[\"Respiratory vaccines\"], big.mark = \",\"), \")\"),\n      paste0(\"Childhood vaccines (N = \", format(totals[\"Childhood vaccines\"], big.mark = \",\"), \")\"),\n      paste0(\"Other (N = \", format(totals[\"Other\"], big.mark = \",\"), \")\")\n    )\n  ) %&gt;%\n  add_header_row( # First row (merged header)\n    values = c(\"Description\", \"Vaccination uptake\"),\n    colwidths = c(2, 3)\n  ) %&gt;%\n  theme_box() %&gt;%\n  set_table_properties(layout = \"autofit\", width = 1) %&gt;%\n  width(j = 1, width = 1.5) %&gt;%\n  width(j = 2, width = 2.5) %&gt;%\n  width(j = 3:4, width = 1.5) %&gt;%\n  align(align = \"justify\", part = \"all\") %&gt;%\n  \n  border_remove() %&gt;%\n  border(part = \"header\", i = 1, border.top = fp_border(color = \"black\", width = 1)) %&gt;%\n  border(part = \"header\", i = 3, border.bottom = fp_border(color = \"black\", width = 1)) %&gt;%\n  border_inner_h(part = \"header\", border = fp_border(color = \"black\", width = 0.8)) %&gt;%\n  border_inner_h(part = \"body\", border = fp_border(color = \"black\", width = 0.8)) %&gt;%\n  border(part = \"body\", i = nrow(tab_combined), border.bottom = fp_border(color = \"black\", width = 1)) %&gt;%\n  \n  set_caption(\"Table: Vaccination uptake across service year, quarter, and weekday\") %&gt;%\n  footnote(i = 1, \n           value = as_paragraph(\" Vaccination proportions were calculated row-wise (i.e., by row).\"),\n           ref_symbols = \"·µÉ\", part = \"header\") \n# %&gt;%\n#   border_inner_h(border = fp_border(color = \"black\", width = 1))  %&gt;%\n#   add_header_lines(values = \"Table xx: Vaccination uptake across service year, quarter, and weekday.\") %&gt;%\n#   add_footer_lines(values = c(\n#     \"·µÉ Vaccination proportions were calculated per row (row percentage).\",\n#     paste0(\"·µá The vaccine provider type did not include unvaccinated (N = \", format(no_total, big.mark = \",\"), \").\"),\n#     \"·∂ú Vaccination proportions were calculated row-wise (i.e., by row).\",\n#     \"GP = General practitioner, PHU = Public Health Unit\"\n#   ))\n\n# Display the table\nft_vacc_summary\n\nDescription·µÉVaccination uptake·µÉRespiratory vaccines (N = 955)Childhood vaccines (N = 472)Other (N = 126)Variable typeValuesNumber (%)·µÉNumber (%)·µÉNumber (%)·µÉGenderFemale511 (64)233 (29.2)54 (6.8)Male444 (58.8)239 (31.7)72 (9.5)Age0-19250 (38.9)302 (47)90 (14)20-29150 (68.2)70 (31.8)0 (0)30-3947 (71.2)19 (28.8)0 (0)40-49142 (75.9)45 (24.1)0 (0)50-59112 (77.8)14 (9.7)18 (12.5)60-69149 (87.6)13 (7.6)8 (4.7)70+105 (84.7)9 (7.3)10 (8.1)Marital statusDivorced136 (83.4)15 (9.2)12 (7.4)Married289 (79)59 (16.1)18 (4.9)Single/widowed150 (79.4)33 (17.5)6 (3.2)Year201578 (51)56 (36.6)19 (12.4)201684 (60.4)47 (33.8)8 (5.8)201775 (54.7)52 (38)10 (7.3)201881 (53.6)52 (34.4)18 (11.9)201983 (51.6)60 (37.3)18 (11.2)202082 (59.9)44 (32.1)11 (8)2021223 (84.8)34 (12.9)6 (2.3)202288 (73.3)25 (20.8)7 (5.8)202387 (51.2)63 (37.1)20 (11.8)202474 (60.7)39 (32)9 (7.4)Quarter1253 (62.8)120 (29.8)30 (7.4)2220 (58.5)117 (31.1)39 (10.4)3295 (63.2)139 (29.8)33 (7.1)4187 (60.9)96 (31.3)24 (7.8)WeekdayFriday141 (78.3)31 (17.2)8 (4.4)Monday114 (64.4)49 (27.7)14 (7.9)Saturday160 (63.2)81 (32)12 (4.7)Sunday156 (56.3)100 (36.1)21 (7.6)Thursday167 (66)66 (26.1)20 (7.9)Tuesday108 (65.5)43 (26.1)14 (8.5)Wednesday109 (44)102 (41.1)37 (14.9)·µÉ Vaccination proportions were calculated row-wise (i.e., by row).\n\n# .................... Clean up environment ....................\nrm(tab_year, tab_quarter, tab_weekday, tab_combined, ft_vacc_summary, totals, create_tab)\n\n\n\n\nIn this version, we include ‚ÄúMissing‚Äù as a separate category and provide both counts and percentages.\nüß† Why this matters: Ignoring missing values can skew analysis. This format transparently highlights data completeness.\nüëç Recommended for: Health datasets, surveys, or administrative data where data quality assessment is key.\n\n# ------------3. Missing values with n(%)-------------------------------------------\n\n\n# .................. Convert grouping vars to character ..................\nvacc_1524 &lt;- vacc_1524 %&gt;%\n  mutate(across(c(age_group, gender, marital_status,\n                  vacc_service_year, vacc_quarter, vacc_weekday), as.character))\n\n# .................. Table generation function with Missing ..................\ncreate_tab &lt;- function(data, var, label) {\n  tab_main &lt;- data %&gt;%\n    filter(!is.na({{ var }})) %&gt;%\n    tabyl({{ var }}, vacc_group3) %&gt;%\n    mutate(Category = label, .before = 1) %&gt;%\n    rename(Label = {{ var }}) %&gt;%\n    mutate(Label = as.character(Label))\n  \n  na_count &lt;- sum(is.na(pull(data, {{ var }})))\n  \n  if (na_count &gt; 0) {\n    missing_row &lt;- tibble(\n      Category = label,\n      Label = \"Missing\",\n      `Respiratory vaccines` = sum(data$vacc_group3 == \"Respiratory vaccines\" & is.na(pull(data, {{ var }})), na.rm = TRUE),\n      `Childhood vaccines` = sum(data$vacc_group3 == \"Childhood vaccines\" & is.na(pull(data, {{ var }})), na.rm = TRUE),\n      Other = sum(data$vacc_group3 == \"Other\" & is.na(pull(data, {{ var }})), na.rm = TRUE)\n    )\n    tab_final &lt;- bind_rows(tab_main, missing_row)\n  } else {\n    tab_final &lt;- tab_main\n  }\n  \n  return(tab_final)\n}\n\n# .................. Create summary tables ..................\ntab_age            &lt;- create_tab(vacc_1524, age_group, \"Age\")\ntab_sex            &lt;- create_tab(vacc_1524, gender, \"Gender\")\ntab_marital_status &lt;- create_tab(vacc_1524, marital_status, \"Marital status\")\ntab_year           &lt;- create_tab(vacc_1524, vacc_service_year, \"Year\")\ntab_quarter        &lt;- create_tab(vacc_1524, vacc_quarter, \"Quarter\")\ntab_weekday        &lt;- create_tab(vacc_1524, vacc_weekday, \"Weekday\")\n\n# .................. Combine all tables ..................\ntab_combined &lt;- bind_rows(tab_sex, tab_age, tab_marital_status, tab_year, tab_quarter, tab_weekday)\n\n# .................. Calculate row-wise percentages ..................\ntab_combined &lt;- tab_combined %&gt;%\n  rowwise() %&gt;%\n  mutate(\n    Total = sum(`Respiratory vaccines`, `Childhood vaccines`, Other, na.rm = TRUE),\n    Respiratory = paste0(comma(`Respiratory vaccines`), \" (\", round(100 * `Respiratory vaccines` / Total, 1), \")\"),\n    Childhood   = paste0(comma(`Childhood vaccines`), \" (\", round(100 * `Childhood vaccines` / Total, 1), \")\"),\n    Other_grp   = paste0(comma(Other), \" (\", round(100 * Other / Total, 1), \")\")\n  ) %&gt;%\n  ungroup()\n\n\n# .................. Show Category only once per group ..................\ntab_combined &lt;- tab_combined %&gt;%\n  group_by(Category) %&gt;%\n  mutate(Category = ifelse(row_number() == 1, Category, \"\")) %&gt;%\n  ungroup()\n\n# .................. Get total counts per vaccine group ..................\ntotals &lt;- vacc_1524 %&gt;%\n  count(vacc_group3) %&gt;%\n  deframe()\n\n# .................. Create flextable ..................\nft_vacc_summary &lt;- tab_combined %&gt;%\n  select(Category, Label, Respiratory, Childhood, Other_grp) %&gt;%\n  flextable() %&gt;%\n  set_header_labels(\n    Category = \"Variable type\",\n    Label = \"Values\",\n    Respiratory = \"Number (%)·µÉ\",\n    Childhood = \"Number (%)·µÉ\",\n    Other_grp = \"Number (%)·µÉ\"\n  ) %&gt;%\n  add_header_row(\n    values = c(\n      \"\", \"\",\n      paste0(\"Respiratory vaccines (N = \", format(totals[\"Respiratory vaccines\"], big.mark = \",\"), \")\"),\n      paste0(\"Childhood vaccines (N = \", format(totals[\"Childhood vaccines\"], big.mark = \",\"), \")\"),\n      paste0(\"Other (N = \", format(totals[\"Other\"], big.mark = \",\"), \")\")\n    )\n  ) %&gt;%\n  add_header_row(\n    values = c(\"Description\", \"Vaccination uptake\"),\n    colwidths = c(2, 3)\n  ) %&gt;%\n  theme_box() %&gt;%\n  set_table_properties(layout = \"autofit\", width = 1) %&gt;%\n  width(j = 1, width = 1.5) %&gt;%\n  width(j = 2, width = 2.5) %&gt;%\n  width(j = 3:5, width = 1.5) %&gt;%\n  align(align = \"justify\", part = \"all\") %&gt;%\n  border_remove() %&gt;%\n  border(part = \"header\", i = 1, border.top = fp_border(color = \"black\", width = 1)) %&gt;%\n  border(part = \"header\", i = 3, border.bottom = fp_border(color = \"black\", width = 1)) %&gt;%\n  border_inner_h(part = \"header\", border = fp_border(color = \"black\", width = 0.8)) %&gt;%\n  border_inner_h(part = \"body\", border = fp_border(color = \"black\", width = 0.8)) %&gt;%\n  border(part = \"body\", i = nrow(tab_combined), border.bottom = fp_border(color = \"black\", width = 1)) %&gt;%\n  \n  set_caption(\"Table: Vaccination uptake across service year, quarter, and weekday\") %&gt;%\n  footnote(i = 1, \n           value = as_paragraph(\"Vaccination proportions were calculated row-wise (i.e., by row).\"),\n           ref_symbols = \"·µÉ\", \n           part = \"header\")\n# .................. Show the table ..................\nft_vacc_summary\n\nDescription·µÉVaccination uptake·µÉRespiratory vaccines (N = 955)Childhood vaccines (N = 472)Other (N = 126)Variable typeValuesNumber (%)·µÉNumber (%)·µÉNumber (%)·µÉGenderFemale511 (64)233 (29.2)54 (6.8)Male444 (58.8)239 (31.7)72 (9.5)Age0-19250 (38.9)302 (47)90 (14)20-29150 (68.2)70 (31.8)0 (0)30-3947 (71.2)19 (28.8)0 (0)40-49142 (75.9)45 (24.1)0 (0)50-59112 (77.8)14 (9.7)18 (12.5)60-69149 (87.6)13 (7.6)8 (4.7)70+105 (84.7)9 (7.3)10 (8.1)Marital statusDivorced136 (83.4)15 (9.2)12 (7.4)Married289 (79)59 (16.1)18 (4.9)Single/widowed150 (79.4)33 (17.5)6 (3.2)Missing380 (45.5)365 (43.7)90 (10.8)Year201578 (51)56 (36.6)19 (12.4)201684 (60.4)47 (33.8)8 (5.8)201775 (54.7)52 (38)10 (7.3)201881 (53.6)52 (34.4)18 (11.9)201983 (51.6)60 (37.3)18 (11.2)202082 (59.9)44 (32.1)11 (8)2021223 (84.8)34 (12.9)6 (2.3)202288 (73.3)25 (20.8)7 (5.8)202387 (51.2)63 (37.1)20 (11.8)202474 (60.7)39 (32)9 (7.4)Quarter1253 (62.8)120 (29.8)30 (7.4)2220 (58.5)117 (31.1)39 (10.4)3295 (63.2)139 (29.8)33 (7.1)4187 (60.9)96 (31.3)24 (7.8)WeekdayFriday141 (78.3)31 (17.2)8 (4.4)Monday114 (64.4)49 (27.7)14 (7.9)Saturday160 (63.2)81 (32)12 (4.7)Sunday156 (56.3)100 (36.1)21 (7.6)Thursday167 (66)66 (26.1)20 (7.9)Tuesday108 (65.5)43 (26.1)14 (8.5)Wednesday109 (44)102 (41.1)37 (14.9)·µÉVaccination proportions were calculated row-wise (i.e., by row).\n\n# .................. Clean up ..................\nrm(tab_age, tab_sex, tab_marital_status, tab_year, tab_quarter, tab_weekday, \n   tab_combined, ft_vacc_summary, totals, create_tab)\n\n\n\n\nThis variation includes missing data rows but only shows raw counts, not percentages.\n\n‚öñÔ∏è Why use this: It prevents misleading interpretations‚Äîespecially when the denominator for percentage is unclear or inconsistent.\nUse this when you want to acknowledge missing data but avoid implying proportional meaning.\n\n\n# ------------4. Missing values with only counts-------------------------------------------\n\n# .................. Convert grouping vars to character ..................\nvacc_1524 &lt;- vacc_1524 %&gt;%\n  mutate(across(c(age_group, gender, marital_status,\n                  vacc_service_year, vacc_quarter, vacc_weekday), as.character))\n\n# .................. Table generation function with Missing ..................\ncreate_tab &lt;- function(data, var, label) {\n  tab_main &lt;- data %&gt;%\n    filter(!is.na({{ var }})) %&gt;%\n    tabyl({{ var }}, vacc_group3) %&gt;%\n    mutate(Category = label, .before = 1) %&gt;%\n    rename(Label = {{ var }}) %&gt;%\n    mutate(Label = as.character(Label))\n  \n  na_count &lt;- sum(is.na(pull(data, {{ var }})))\n  \n  if (na_count &gt; 0) {\n    missing_row &lt;- tibble(\n      Category = label,\n      Label = \"Missing\",\n      `Respiratory vaccines` = sum(data$vacc_group3 == \"Respiratory vaccines\" & is.na(pull(data, {{ var }})), na.rm = TRUE),\n      `Childhood vaccines` = sum(data$vacc_group3 == \"Childhood vaccines\" & is.na(pull(data, {{ var }})), na.rm = TRUE),\n      Other = sum(data$vacc_group3 == \"Other\" & is.na(pull(data, {{ var }})), na.rm = TRUE)\n    )\n    tab_final &lt;- bind_rows(tab_main, missing_row)\n  } else {\n    tab_final &lt;- tab_main\n  }\n  \n  return(tab_final)\n}\n\n# .................. Create summary tables ..................\ntab_age            &lt;- create_tab(vacc_1524, age_group, \"Age\")\ntab_sex            &lt;- create_tab(vacc_1524, gender, \"Gender\")\ntab_marital_status &lt;- create_tab(vacc_1524, marital_status, \"Marital status\")\ntab_year           &lt;- create_tab(vacc_1524, vacc_service_year, \"Year\")\ntab_quarter        &lt;- create_tab(vacc_1524, vacc_quarter, \"Quarter\")\ntab_weekday        &lt;- create_tab(vacc_1524, vacc_weekday, \"Weekday\")\n\n# .................. Combine all tables ..................\ntab_combined &lt;- bind_rows(tab_sex, tab_age, tab_marital_status, tab_year, tab_quarter, tab_weekday)\n\n# .................. Calculate row-wise percentages (skip for Missing) ..................\ntab_combined &lt;- tab_combined %&gt;%\n  rowwise() %&gt;%\n  mutate(\n    Total = sum(`Respiratory vaccines`, `Childhood vaccines`, Other, na.rm = TRUE),\n    is_missing = trimws(tolower(Label)) == \"missing\",\n    \n    Respiratory = ifelse(is_missing,\n                         comma(`Respiratory vaccines`),\n                         paste0(comma(`Respiratory vaccines`), \" (\", round(100 * `Respiratory vaccines` / Total, 1), \")\")),\n    \n    Childhood = ifelse(is_missing,\n                       comma(`Childhood vaccines`),\n                       paste0(comma(`Childhood vaccines`), \" (\", round(100 * `Childhood vaccines` / Total, 1), \")\")),\n    \n    Other_grp = ifelse(is_missing,\n                       comma(Other),\n                       paste0(comma(Other), \" (\", round(100 * Other / Total, 1), \")\"))\n  ) %&gt;%\n  ungroup() %&gt;%\n  select(Category, Label, Respiratory, Childhood, Other_grp)\n\n# .................. Show Category only once per group ..................\ntab_combined &lt;- tab_combined %&gt;%\n  group_by(Category) %&gt;%\n  mutate(Category = ifelse(row_number() == 1, Category, \"\")) %&gt;%\n  ungroup()\n\n# .................. Get total counts per vaccine group ..................\ntotals &lt;- vacc_1524 %&gt;%\n  count(vacc_group3) %&gt;%\n  deframe()\n\n# .................. Create flextable ..................\nft_vacc_summary &lt;- tab_combined %&gt;%\n  flextable() %&gt;%\n  set_header_labels(\n    Category = \"Variable type\",\n    Label = \"Values\",\n    Respiratory = \"Number (%)·µÉ\",\n    Childhood = \"Number (%)·µÉ\",\n    Other_grp = \"Number (%)·µÉ\"\n  ) %&gt;%\n  add_header_row(\n    values = c(\n      \"\", \"\",\n      paste0(\"Respiratory vaccines (N = \", format(totals[\"Respiratory vaccines\"], big.mark = \",\"), \")\"),\n      paste0(\"Childhood vaccines (N = \", format(totals[\"Childhood vaccines\"], big.mark = \",\"), \")\"),\n      paste0(\"Other (N = \", format(totals[\"Other\"], big.mark = \",\"), \")\")\n    )\n  ) %&gt;%\n  add_header_row(\n    values = c(\"Description\", \"Vaccination uptake\"),\n    colwidths = c(2, 3)\n  ) %&gt;%\n  theme_box() %&gt;%\n  set_table_properties(layout = \"autofit\", width = 1) %&gt;%\n  width(j = 1, width = 1.5) %&gt;%\n  width(j = 2, width = 2.5) %&gt;%\n  width(j = 3:5, width = 1.5) %&gt;%\n  align(align = \"justify\", part = \"all\") %&gt;%\n  border_remove() %&gt;%\n  border(part = \"header\", i = 1, border.top = fp_border(color = \"black\", width = 1)) %&gt;%\n  border(part = \"header\", i = 3, border.bottom = fp_border(color = \"black\", width = 1)) %&gt;%\n  border_inner_h(part = \"header\", border = fp_border(color = \"black\", width = 0.8)) %&gt;%\n  border_inner_h(part = \"body\", border = fp_border(color = \"black\", width = 0.8)) %&gt;%\n  border(part = \"body\", i = nrow(tab_combined), border.bottom = fp_border(color = \"black\", width = 1)) %&gt;%\n  \n  set_caption(\"Table: Vaccination uptake across service year, quarter, and weekday\") %&gt;%\n  footnote(i = 1, \n           value = as_paragraph(\"Vaccination proportions were calculated row-wise (i.e., by row).\"),\n           ref_symbols = \"·µÉ\", \n           part = \"header\")\n\n# .................. Show the table ..................\nft_vacc_summary\n\nDescription·µÉVaccination uptake·µÉRespiratory vaccines (N = 955)Childhood vaccines (N = 472)Other (N = 126)Variable typeValuesNumber (%)·µÉNumber (%)·µÉNumber (%)·µÉGenderFemale511 (64)233 (29.2)54 (6.8)Male444 (58.8)239 (31.7)72 (9.5)Age0-19250 (38.9)302 (47)90 (14)20-29150 (68.2)70 (31.8)0 (0)30-3947 (71.2)19 (28.8)0 (0)40-49142 (75.9)45 (24.1)0 (0)50-59112 (77.8)14 (9.7)18 (12.5)60-69149 (87.6)13 (7.6)8 (4.7)70+105 (84.7)9 (7.3)10 (8.1)Marital statusDivorced136 (83.4)15 (9.2)12 (7.4)Married289 (79)59 (16.1)18 (4.9)Single/widowed150 (79.4)33 (17.5)6 (3.2)Missing38036590Year201578 (51)56 (36.6)19 (12.4)201684 (60.4)47 (33.8)8 (5.8)201775 (54.7)52 (38)10 (7.3)201881 (53.6)52 (34.4)18 (11.9)201983 (51.6)60 (37.3)18 (11.2)202082 (59.9)44 (32.1)11 (8)2021223 (84.8)34 (12.9)6 (2.3)202288 (73.3)25 (20.8)7 (5.8)202387 (51.2)63 (37.1)20 (11.8)202474 (60.7)39 (32)9 (7.4)Quarter1253 (62.8)120 (29.8)30 (7.4)2220 (58.5)117 (31.1)39 (10.4)3295 (63.2)139 (29.8)33 (7.1)4187 (60.9)96 (31.3)24 (7.8)WeekdayFriday141 (78.3)31 (17.2)8 (4.4)Monday114 (64.4)49 (27.7)14 (7.9)Saturday160 (63.2)81 (32)12 (4.7)Sunday156 (56.3)100 (36.1)21 (7.6)Thursday167 (66)66 (26.1)20 (7.9)Tuesday108 (65.5)43 (26.1)14 (8.5)Wednesday109 (44)102 (41.1)37 (14.9)·µÉVaccination proportions were calculated row-wise (i.e., by row).\n\n# .................. Clean up ..................\nrm(tab_age, tab_sex, tab_marital_status, tab_year, tab_quarter, tab_weekday, \n   tab_combined, ft_vacc_summary, totals, create_tab)\n\n\n\n\nThis version removes all border lines for a minimalist, text-friendly table.\n‚ú® Why this helps: It improves visual integration in Word documents or printed reports where borders may clutter formatting.\nüîç Ideal for: Inline reporting, Word exports, or journal submissions requiring custom styling.\n\n# ------------5. Lines: remove all lines -------------------------------------------\n\n\n# .................. Convert grouping vars to character ..................\nvacc_1524 &lt;- vacc_1524 %&gt;%\n  mutate(across(c(age_group, gender, marital_status,\n                  vacc_service_year, vacc_quarter, vacc_weekday), as.character))\n\n# .................. Table generation function with Missing ..................\ncreate_tab &lt;- function(data, var, label) {\n  tab_main &lt;- data %&gt;%\n    filter(!is.na({{ var }})) %&gt;%\n    tabyl({{ var }}, vacc_group3) %&gt;%\n    mutate(Category = label, .before = 1) %&gt;%\n    rename(Label = {{ var }}) %&gt;%\n    mutate(Label = as.character(Label))\n  \n  na_count &lt;- sum(is.na(pull(data, {{ var }})))\n  \n  if (na_count &gt; 0) {\n    missing_row &lt;- tibble(\n      Category = label,\n      Label = \"Missing\",\n      `Respiratory vaccines` = sum(data$vacc_group3 == \"Respiratory vaccines\" & is.na(pull(data, {{ var }})), na.rm = TRUE),\n      `Childhood vaccines` = sum(data$vacc_group3 == \"Childhood vaccines\" & is.na(pull(data, {{ var }})), na.rm = TRUE),\n      Other = sum(data$vacc_group3 == \"Other\" & is.na(pull(data, {{ var }})), na.rm = TRUE)\n    )\n    tab_final &lt;- bind_rows(tab_main, missing_row)\n  } else {\n    tab_final &lt;- tab_main\n  }\n  \n  return(tab_final)\n}\n\n# .................. Create summary tables ..................\ntab_age            &lt;- create_tab(vacc_1524, age_group, \"Age\")\ntab_sex            &lt;- create_tab(vacc_1524, gender, \"Gender\")\ntab_marital_status &lt;- create_tab(vacc_1524, marital_status, \"Marital status\")\ntab_year           &lt;- create_tab(vacc_1524, vacc_service_year, \"Year\")\ntab_quarter        &lt;- create_tab(vacc_1524, vacc_quarter, \"Quarter\")\ntab_weekday        &lt;- create_tab(vacc_1524, vacc_weekday, \"Weekday\")\n\n# .................. Combine all tables ..................\ntab_combined &lt;- bind_rows(tab_sex, tab_age, tab_marital_status, tab_year, tab_quarter, tab_weekday)\n\n# .................. Calculate row-wise percentages (skip for Missing) ..................\ntab_combined &lt;- tab_combined %&gt;%\n  rowwise() %&gt;%\n  mutate(\n    Total = sum(`Respiratory vaccines`, `Childhood vaccines`, Other, na.rm = TRUE),\n    is_missing = trimws(tolower(Label)) == \"missing\",\n    \n    Respiratory = ifelse(is_missing,\n                         comma(`Respiratory vaccines`),\n                         paste0(comma(`Respiratory vaccines`), \" (\", round(100 * `Respiratory vaccines` / Total, 1), \")\")),\n    \n    Childhood = ifelse(is_missing,\n                       comma(`Childhood vaccines`),\n                       paste0(comma(`Childhood vaccines`), \" (\", round(100 * `Childhood vaccines` / Total, 1), \")\")),\n    \n    Other_grp = ifelse(is_missing,\n                       comma(Other),\n                       paste0(comma(Other), \" (\", round(100 * Other / Total, 1), \")\"))\n  ) %&gt;%\n  ungroup() %&gt;%\n  select(Category, Label, Respiratory, Childhood, Other_grp)\n\n# .................. Show Category only once per group ..................\ntab_combined &lt;- tab_combined %&gt;%\n  group_by(Category) %&gt;%\n  mutate(Category = ifelse(row_number() == 1, Category, \"\")) %&gt;%\n  ungroup()\n\n# .................. Get total counts per vaccine group ..................\ntotals &lt;- vacc_1524 %&gt;%\n  count(vacc_group3) %&gt;%\n  deframe()\n\n# .................. Create flextable ..................\nft_vacc_summary &lt;- tab_combined %&gt;%\n  flextable() %&gt;%\n  set_header_labels(\n    Category = \"Variable type\",\n    Label = \"Values\",\n    Respiratory = \"Number (%)·µÉ\",\n    Childhood = \"Number (%)·µÉ\",\n    Other_grp = \"Number (%)·µÉ\"\n  ) %&gt;%\n  add_header_row(\n    values = c(\n      \"\", \"\",\n      paste0(\"Respiratory vaccines (N = \", format(totals[\"Respiratory vaccines\"], big.mark = \",\"), \")\"),\n      paste0(\"Childhood vaccines (N = \", format(totals[\"Childhood vaccines\"], big.mark = \",\"), \")\"),\n      paste0(\"Other (N = \", format(totals[\"Other\"], big.mark = \",\"), \")\")\n    )\n  ) %&gt;%\n  add_header_row(\n    values = c(\"Description\", \"Vaccination uptake\"),\n    colwidths = c(2, 3)\n  ) %&gt;%\n  theme_box() %&gt;%\n  set_table_properties(layout = \"autofit\", width = 1) %&gt;%\n  width(j = 1, width = 1.5) %&gt;%\n  width(j = 2, width = 2.5) %&gt;%\n  width(j = 3:5, width = 1.5) %&gt;%\n  align(align = \"justify\", part = \"all\") %&gt;%\n  border_remove() %&gt;%\n  #  border_inner_h(border = fp_border(color = \"black\", width = 1)) %&gt;%\n  set_caption(\"Table: Vaccination uptake across service year, quarter, and weekday\") %&gt;%\n  footnote(i = 1, \n           value = as_paragraph(\"Vaccination proportions were calculated row-wise (i.e., by row).\"),\n           ref_symbols = \"·µÉ\", \n           part = \"header\")\n\n# .................. Show the table ..................\nft_vacc_summary\n\nDescription·µÉVaccination uptake·µÉRespiratory vaccines (N = 955)Childhood vaccines (N = 472)Other (N = 126)Variable typeValuesNumber (%)·µÉNumber (%)·µÉNumber (%)·µÉGenderFemale511 (64)233 (29.2)54 (6.8)Male444 (58.8)239 (31.7)72 (9.5)Age0-19250 (38.9)302 (47)90 (14)20-29150 (68.2)70 (31.8)0 (0)30-3947 (71.2)19 (28.8)0 (0)40-49142 (75.9)45 (24.1)0 (0)50-59112 (77.8)14 (9.7)18 (12.5)60-69149 (87.6)13 (7.6)8 (4.7)70+105 (84.7)9 (7.3)10 (8.1)Marital statusDivorced136 (83.4)15 (9.2)12 (7.4)Married289 (79)59 (16.1)18 (4.9)Single/widowed150 (79.4)33 (17.5)6 (3.2)Missing38036590Year201578 (51)56 (36.6)19 (12.4)201684 (60.4)47 (33.8)8 (5.8)201775 (54.7)52 (38)10 (7.3)201881 (53.6)52 (34.4)18 (11.9)201983 (51.6)60 (37.3)18 (11.2)202082 (59.9)44 (32.1)11 (8)2021223 (84.8)34 (12.9)6 (2.3)202288 (73.3)25 (20.8)7 (5.8)202387 (51.2)63 (37.1)20 (11.8)202474 (60.7)39 (32)9 (7.4)Quarter1253 (62.8)120 (29.8)30 (7.4)2220 (58.5)117 (31.1)39 (10.4)3295 (63.2)139 (29.8)33 (7.1)4187 (60.9)96 (31.3)24 (7.8)WeekdayFriday141 (78.3)31 (17.2)8 (4.4)Monday114 (64.4)49 (27.7)14 (7.9)Saturday160 (63.2)81 (32)12 (4.7)Sunday156 (56.3)100 (36.1)21 (7.6)Thursday167 (66)66 (26.1)20 (7.9)Tuesday108 (65.5)43 (26.1)14 (8.5)Wednesday109 (44)102 (41.1)37 (14.9)·µÉVaccination proportions were calculated row-wise (i.e., by row).\n\n# .................. Clean up ..................\nrm(tab_age, tab_sex, tab_marital_status, tab_year, tab_quarter, tab_weekday, \n   tab_combined, ft_vacc_summary, totals, create_tab)\n\n\n\n\nThis style keeps only horizontal dividers to improve readability without overwhelming the user.\nüìè Implication: Helps guide the eye across wide tables while maintaining a clean aesthetic.\n‚úÖ Great for: Formal documents and slide decks where visual clarity is important.\n\n# ------------6. Lines: Only Horizantal Lines -------------------------------------------\n\n# .................. Convert grouping vars to character ..................\nvacc_1524 &lt;- vacc_1524 %&gt;%\n  mutate(across(c(age_3group, gender, marital_status,\n                  vacc_service_year, vacc_quarter, vacc_weekday), as.character))\n\n# .................. Table generation function with Missing ..................\ncreate_tab &lt;- function(data, var, label) {\n  tab_main &lt;- data %&gt;%\n    filter(!is.na({{ var }})) %&gt;%\n    tabyl({{ var }}, vacc_group3) %&gt;%\n    mutate(Category = label, .before = 1) %&gt;%\n    rename(Label = {{ var }}) %&gt;%\n    mutate(Label = as.character(Label))\n  \n  na_count &lt;- sum(is.na(pull(data, {{ var }})))\n  \n  if (na_count &gt; 0) {\n    missing_row &lt;- tibble(\n      Category = label,\n      Label = \"Missing\",\n      `Respiratory vaccines` = sum(data$vacc_group3 == \"Respiratory vaccines\" & is.na(pull(data, {{ var }})), na.rm = TRUE),\n      `Childhood vaccines` = sum(data$vacc_group3 == \"Childhood vaccines\" & is.na(pull(data, {{ var }})), na.rm = TRUE),\n      Other = sum(data$vacc_group3 == \"Other\" & is.na(pull(data, {{ var }})), na.rm = TRUE)\n    )\n    tab_final &lt;- bind_rows(tab_main, missing_row)\n  } else {\n    tab_final &lt;- tab_main\n  }\n  \n  return(tab_final)\n}\n\n# .................. Create summary tables ..................\ntab_age            &lt;- create_tab(vacc_1524, age_group, \"Age\")\ntab_sex            &lt;- create_tab(vacc_1524, gender, \"Gender\")\ntab_marital_status &lt;- create_tab(vacc_1524, marital_status, \"Marital status\")\ntab_year           &lt;- create_tab(vacc_1524, vacc_service_year, \"Year\")\ntab_quarter        &lt;- create_tab(vacc_1524, vacc_quarter, \"Quarter\")\ntab_weekday        &lt;- create_tab(vacc_1524, vacc_weekday, \"Weekday\")\n\n# .................. Combine all tables ..................\ntab_combined &lt;- bind_rows(tab_sex, tab_age, tab_marital_status, tab_year, tab_quarter, tab_weekday)\n\n# .................. Calculate row-wise percentages (skip for Missing) ..................\ntab_combined &lt;- tab_combined %&gt;%\n  rowwise() %&gt;%\n  mutate(\n    Total = sum(`Respiratory vaccines`, `Childhood vaccines`, Other, na.rm = TRUE),\n    is_missing = trimws(tolower(Label)) == \"missing\",\n    \n    Respiratory = ifelse(is_missing,\n                         comma(`Respiratory vaccines`),\n                         paste0(comma(`Respiratory vaccines`), \" (\", round(100 * `Respiratory vaccines` / Total, 1), \")\")),\n    \n    Childhood = ifelse(is_missing,\n                       comma(`Childhood vaccines`),\n                       paste0(comma(`Childhood vaccines`), \" (\", round(100 * `Childhood vaccines` / Total, 1), \")\")),\n    \n    Other_grp = ifelse(is_missing,\n                       comma(Other),\n                       paste0(comma(Other), \" (\", round(100 * Other / Total, 1), \")\"))\n  ) %&gt;%\n  ungroup() %&gt;%\n  select(Category, Label, Respiratory, Childhood, Other_grp)\n\n# .................. Show Category only once per group ..................\ntab_combined &lt;- tab_combined %&gt;%\n  group_by(Category) %&gt;%\n  mutate(Category = ifelse(row_number() == 1, Category, \"\")) %&gt;%\n  ungroup()\n\n# .................. Get total counts per vaccine group ..................\ntotals &lt;- vacc_1524 %&gt;%\n  count(vacc_group3) %&gt;%\n  deframe()\n\n# .................. Create flextable ..................\nft_vacc_summary &lt;- tab_combined %&gt;%\n  flextable() %&gt;%\n  set_header_labels(\n    Category = \"Variable type\",\n    Label = \"Values\",\n    Respiratory = \"Number (%)·µÉ\",\n    Childhood = \"Number (%)·µÉ\",\n    Other_grp = \"Number (%)·µÉ\"\n  ) %&gt;%\n  add_header_row(\n    values = c(\n      \"\", \"\",\n      paste0(\"Respiratory vaccines (N = \", format(totals[\"Respiratory vaccines\"], big.mark = \",\"), \")\"),\n      paste0(\"Childhood vaccines (N = \", format(totals[\"Childhood vaccines\"], big.mark = \",\"), \")\"),\n      paste0(\"Other (N = \", format(totals[\"Other\"], big.mark = \",\"), \")\")\n    )\n  ) %&gt;%\n  add_header_row(\n    values = c(\"Description\", \"Vaccination uptake\"),\n    colwidths = c(2, 3)\n  ) %&gt;%\n  theme_box() %&gt;%\n  set_table_properties(layout = \"autofit\", width = 1) %&gt;%\n  width(j = 1, width = 1.5) %&gt;%\n  width(j = 2, width = 2.5) %&gt;%\n  width(j = 3:5, width = 1.5) %&gt;%\n  align(align = \"justify\", part = \"all\") %&gt;%\n  border_remove() %&gt;%\n  border(part = \"header\", i = 1, border.top = fp_border(color = \"black\", width = 1)) %&gt;%\n  border(part = \"header\", i = 3, border.bottom = fp_border(color = \"black\", width = 1)) %&gt;%\n  border_inner_h(part = \"header\", border = fp_border(color = \"black\", width = 0.8)) %&gt;%\n  border_inner_h(part = \"body\", border = fp_border(color = \"black\", width = 0.8)) %&gt;%\n  border(part = \"body\", i = nrow(tab_combined), border.bottom = fp_border(color = \"black\", width = 1)) %&gt;%\n  \n  set_caption(\"Table: Vaccination uptake across service year, quarter, and weekday\") %&gt;%\n  footnote(i = 1, \n           value = as_paragraph(\"Vaccination proportions were calculated row-wise (i.e., by row).\"),\n           ref_symbols = \"·µÉ\", \n           part = \"header\")\n\n# .................. Show the table ..................\nft_vacc_summary\n\nDescription·µÉVaccination uptake·µÉRespiratory vaccines (N = 955)Childhood vaccines (N = 472)Other (N = 126)Variable typeValuesNumber (%)·µÉNumber (%)·µÉNumber (%)·µÉGenderFemale511 (64)233 (29.2)54 (6.8)Male444 (58.8)239 (31.7)72 (9.5)Age0-19250 (38.9)302 (47)90 (14)20-29150 (68.2)70 (31.8)0 (0)30-3947 (71.2)19 (28.8)0 (0)40-49142 (75.9)45 (24.1)0 (0)50-59112 (77.8)14 (9.7)18 (12.5)60-69149 (87.6)13 (7.6)8 (4.7)70+105 (84.7)9 (7.3)10 (8.1)Marital statusDivorced136 (83.4)15 (9.2)12 (7.4)Married289 (79)59 (16.1)18 (4.9)Single/widowed150 (79.4)33 (17.5)6 (3.2)Missing38036590Year201578 (51)56 (36.6)19 (12.4)201684 (60.4)47 (33.8)8 (5.8)201775 (54.7)52 (38)10 (7.3)201881 (53.6)52 (34.4)18 (11.9)201983 (51.6)60 (37.3)18 (11.2)202082 (59.9)44 (32.1)11 (8)2021223 (84.8)34 (12.9)6 (2.3)202288 (73.3)25 (20.8)7 (5.8)202387 (51.2)63 (37.1)20 (11.8)202474 (60.7)39 (32)9 (7.4)Quarter1253 (62.8)120 (29.8)30 (7.4)2220 (58.5)117 (31.1)39 (10.4)3295 (63.2)139 (29.8)33 (7.1)4187 (60.9)96 (31.3)24 (7.8)WeekdayFriday141 (78.3)31 (17.2)8 (4.4)Monday114 (64.4)49 (27.7)14 (7.9)Saturday160 (63.2)81 (32)12 (4.7)Sunday156 (56.3)100 (36.1)21 (7.6)Thursday167 (66)66 (26.1)20 (7.9)Tuesday108 (65.5)43 (26.1)14 (8.5)Wednesday109 (44)102 (41.1)37 (14.9)·µÉVaccination proportions were calculated row-wise (i.e., by row).\n\n# .................. Clean up ..................\nrm(tab_age, tab_sex, tab_marital_status, tab_year, tab_quarter, tab_weekday, \n   tab_combined, ft_vacc_summary, totals, create_tab)\n\n\n\n\nThis version includes both horizontal and vertical grid lines, mimicking Excel-style tables.\nüìä When to use: When presenting detailed tables where structure must be visually enforced.\nüì¶ Applicability: Regulatory reports, appendices, or complex data breakdowns.\n\n# ------------6. Lines: All Lines Visible-------------------------------------------\n\n# .................. Convert grouping vars to character ..................\nvacc_1524 &lt;- vacc_1524 %&gt;%\n  mutate(across(c(age_group, gender, marital_status,\n                  vacc_service_year, vacc_quarter, vacc_weekday), as.character))\n\n# .................. Table generation function with Missing ..................\ncreate_tab &lt;- function(data, var, label) {\n  tab_main &lt;- data %&gt;%\n    filter(!is.na({{ var }})) %&gt;%\n    tabyl({{ var }}, vacc_group3) %&gt;%\n    mutate(Category = label, .before = 1) %&gt;%\n    rename(Label = {{ var }}) %&gt;%\n    mutate(Label = as.character(Label))\n  \n  na_count &lt;- sum(is.na(pull(data, {{ var }})))\n  \n  if (na_count &gt; 0) {\n    missing_row &lt;- tibble(\n      Category = label,\n      Label = \"Missing\",\n      `Respiratory vaccines` = sum(data$vacc_group3 == \"Respiratory vaccines\" & is.na(pull(data, {{ var }})), na.rm = TRUE),\n      `Childhood vaccines` = sum(data$vacc_group3 == \"Childhood vaccines\" & is.na(pull(data, {{ var }})), na.rm = TRUE),\n      Other = sum(data$vacc_group3 == \"Other\" & is.na(pull(data, {{ var }})), na.rm = TRUE)\n    )\n    tab_final &lt;- bind_rows(tab_main, missing_row)\n  } else {\n    tab_final &lt;- tab_main\n  }\n  \n  return(tab_final)\n}\n\n# .................. Create summary tables ..................\ntab_age            &lt;- create_tab(vacc_1524, age_group, \"Age\")\ntab_sex            &lt;- create_tab(vacc_1524, gender, \"Gender\")\ntab_marital_status &lt;- create_tab(vacc_1524, marital_status, \"Marital status\")\ntab_year           &lt;- create_tab(vacc_1524, vacc_service_year, \"Year\")\ntab_quarter        &lt;- create_tab(vacc_1524, vacc_quarter, \"Quarter\")\ntab_weekday        &lt;- create_tab(vacc_1524, vacc_weekday, \"Weekday\")\n\n# .................. Combine all tables ..................\ntab_combined &lt;- bind_rows(tab_sex, tab_age, tab_marital_status, tab_year, tab_quarter, tab_weekday)\n\n# .................. Calculate row-wise percentages (skip for Missing) ..................\ntab_combined &lt;- tab_combined %&gt;%\n  rowwise() %&gt;%\n  mutate(\n    Total = sum(`Respiratory vaccines`, `Childhood vaccines`, Other, na.rm = TRUE),\n    is_missing = trimws(tolower(Label)) == \"missing\",\n    \n    Respiratory = ifelse(is_missing,\n                         comma(`Respiratory vaccines`),\n                         paste0(comma(`Respiratory vaccines`), \" (\", round(100 * `Respiratory vaccines` / Total, 1), \")\")),\n    \n    Childhood = ifelse(is_missing,\n                       comma(`Childhood vaccines`),\n                       paste0(comma(`Childhood vaccines`), \" (\", round(100 * `Childhood vaccines` / Total, 1), \")\")),\n    \n    Other_grp = ifelse(is_missing,\n                       comma(Other),\n                       paste0(comma(Other), \" (\", round(100 * Other / Total, 1), \")\"))\n  ) %&gt;%\n  ungroup() %&gt;%\n  select(Category, Label, Respiratory, Childhood, Other_grp)\n\n# .................. Show Category only once per group ..................\ntab_combined &lt;- tab_combined %&gt;%\n  group_by(Category) %&gt;%\n  mutate(Category = ifelse(row_number() == 1, Category, \"\")) %&gt;%\n  ungroup()\n\n# .................. Get total counts per vaccine group ..................\ntotals &lt;- vacc_1524 %&gt;%\n  count(vacc_group3) %&gt;%\n  deframe()\n\n# .................. Create flextable ..................\nft_vacc_summary &lt;- tab_combined %&gt;%\n  flextable() %&gt;%\n  set_header_labels(\n    Category = \"Variable type\",\n    Label = \"Values\",\n    Respiratory = \"Number (%)·µÉ\",\n    Childhood = \"Number (%)·µÉ\",\n    Other_grp = \"Number (%)·µÉ\"\n  ) %&gt;%\n  add_header_row(\n    values = c(\n      \"\", \"\",\n      paste0(\"Respiratory vaccines (N = \", format(totals[\"Respiratory vaccines\"], big.mark = \",\"), \")\"),\n      paste0(\"Childhood vaccines (N = \", format(totals[\"Childhood vaccines\"], big.mark = \",\"), \")\"),\n      paste0(\"Other (N = \", format(totals[\"Other\"], big.mark = \",\"), \")\")\n    )\n  ) %&gt;%\n  add_header_row(\n    values = c(\"Description\", \"Vaccination uptake\"),\n    colwidths = c(2, 3)\n  ) %&gt;%\n  theme_box() %&gt;%\n  set_table_properties(layout = \"autofit\", width = 1) %&gt;%\n  width(j = 1, width = 1.5) %&gt;%\n  width(j = 2, width = 2.5) %&gt;%\n  width(j = 3:5, width = 1.5) %&gt;%\n  align(align = \"justify\", part = \"all\") %&gt;%\n  border_inner_h(border = fp_border(color = \"black\", width = 1)) %&gt;%\n  set_caption(\"Table: Vaccination uptake across service year, quarter, and weekday\") %&gt;%\n  footnote(i = 1, \n           value = as_paragraph(\"Vaccination proportions were calculated row-wise (i.e., by row).\"),\n           ref_symbols = \"·µÉ\", \n           part = \"header\")\n\n# .................. Show the table ..................\nft_vacc_summary\n\nDescription·µÉVaccination uptake·µÉRespiratory vaccines (N = 955)Childhood vaccines (N = 472)Other (N = 126)Variable typeValuesNumber (%)·µÉNumber (%)·µÉNumber (%)·µÉGenderFemale511 (64)233 (29.2)54 (6.8)Male444 (58.8)239 (31.7)72 (9.5)Age0-19250 (38.9)302 (47)90 (14)20-29150 (68.2)70 (31.8)0 (0)30-3947 (71.2)19 (28.8)0 (0)40-49142 (75.9)45 (24.1)0 (0)50-59112 (77.8)14 (9.7)18 (12.5)60-69149 (87.6)13 (7.6)8 (4.7)70+105 (84.7)9 (7.3)10 (8.1)Marital statusDivorced136 (83.4)15 (9.2)12 (7.4)Married289 (79)59 (16.1)18 (4.9)Single/widowed150 (79.4)33 (17.5)6 (3.2)Missing38036590Year201578 (51)56 (36.6)19 (12.4)201684 (60.4)47 (33.8)8 (5.8)201775 (54.7)52 (38)10 (7.3)201881 (53.6)52 (34.4)18 (11.9)201983 (51.6)60 (37.3)18 (11.2)202082 (59.9)44 (32.1)11 (8)2021223 (84.8)34 (12.9)6 (2.3)202288 (73.3)25 (20.8)7 (5.8)202387 (51.2)63 (37.1)20 (11.8)202474 (60.7)39 (32)9 (7.4)Quarter1253 (62.8)120 (29.8)30 (7.4)2220 (58.5)117 (31.1)39 (10.4)3295 (63.2)139 (29.8)33 (7.1)4187 (60.9)96 (31.3)24 (7.8)WeekdayFriday141 (78.3)31 (17.2)8 (4.4)Monday114 (64.4)49 (27.7)14 (7.9)Saturday160 (63.2)81 (32)12 (4.7)Sunday156 (56.3)100 (36.1)21 (7.6)Thursday167 (66)66 (26.1)20 (7.9)Tuesday108 (65.5)43 (26.1)14 (8.5)Wednesday109 (44)102 (41.1)37 (14.9)·µÉVaccination proportions were calculated row-wise (i.e., by row).\n\n# .................. Clean up ..................\nrm(tab_age, tab_sex, tab_marital_status, tab_year, tab_quarter, tab_weekday, \n   tab_combined, ft_vacc_summary, totals, create_tab)\n\n\n\n\nHere, I demonstrate how to:\n\nSet font types (e.g., Times New Roman)\nControl font size\nApply alternating row colors and header backgrounds\n\nüé® Why this is valuable:\n\nEnhances visual appeal and professionalism.\nAligns with publication or organizational branding requirements.\nBest for: Reports to stakeholders, executive summaries, or printed materials.\n\n\n# ------------ 7. Font Formating: Colour and Font type options adding in the Table -------------------------------------------\n\nlibrary(dplyr)\nlibrary(janitor)\nlibrary(tibble)\nlibrary(scales)\nlibrary(flextable)\n\n# .................. Convert grouping vars to character ..................\nvacc_1524 &lt;- vacc_1524 %&gt;%\n  mutate(across(c(age_group, gender, marital_status,\n                  vacc_service_year, vacc_quarter, vacc_weekday), as.character))\n\n# .................. Table generation function with Missing ..................\ncreate_tab &lt;- function(data, var, label) {\n  tab_main &lt;- data %&gt;%\n    filter(!is.na({{ var }})) %&gt;%\n    tabyl({{ var }}, vacc_group3) %&gt;%\n    mutate(Category = label, .before = 1) %&gt;%\n    rename(Label = {{ var }}) %&gt;%\n    mutate(Label = as.character(Label))\n  \n  na_count &lt;- sum(is.na(pull(data, {{ var }})))\n  \n  if (na_count &gt; 0) {\n    missing_row &lt;- tibble(\n      Category = label,\n      Label = \"Missing\",\n      `Respiratory vaccines` = sum(data$vacc_group3 == \"Respiratory vaccines\" & is.na(pull(data, {{ var }})), na.rm = TRUE),\n      `Childhood vaccines` = sum(data$vacc_group3 == \"Childhood vaccines\" & is.na(pull(data, {{ var }})), na.rm = TRUE),\n      Other = sum(data$vacc_group3 == \"Other\" & is.na(pull(data, {{ var }})), na.rm = TRUE)\n    )\n    tab_final &lt;- bind_rows(tab_main, missing_row)\n  } else {\n    tab_final &lt;- tab_main\n  }\n  \n  return(tab_final)\n}\n\n# .................. Create summary tables ..................\ntab_age            &lt;- create_tab(vacc_1524, age_group, \"Age\")\ntab_sex            &lt;- create_tab(vacc_1524, gender, \"Gender\")\ntab_marital_status &lt;- create_tab(vacc_1524, marital_status, \"Marital status\")\ntab_year           &lt;- create_tab(vacc_1524, vacc_service_year, \"Year\")\ntab_quarter        &lt;- create_tab(vacc_1524, vacc_quarter, \"Quarter\")\ntab_weekday        &lt;- create_tab(vacc_1524, vacc_weekday, \"Weekday\")\n\n# .................. Combine all tables ..................\ntab_combined &lt;- bind_rows(tab_sex, tab_age, tab_marital_status, tab_year, tab_quarter, tab_weekday)\n\n# .................. Calculate row-wise percentages (skip for Missing) ..................\ntab_combined &lt;- tab_combined %&gt;%\n  rowwise() %&gt;%\n  mutate(\n    Total = sum(`Respiratory vaccines`, `Childhood vaccines`, Other, na.rm = TRUE),\n    is_missing = trimws(tolower(Label)) == \"missing\",\n    \n    Respiratory = ifelse(is_missing,\n                         comma(`Respiratory vaccines`),\n                         paste0(comma(`Respiratory vaccines`), \" (\", round(100 * `Respiratory vaccines` / Total, 1), \")\")),\n    \n    Childhood = ifelse(is_missing,\n                       comma(`Childhood vaccines`),\n                       paste0(comma(`Childhood vaccines`), \" (\", round(100 * `Childhood vaccines` / Total, 1), \")\")),\n    \n    Other_grp = ifelse(is_missing,\n                       comma(Other),\n                       paste0(comma(Other), \" (\", round(100 * Other / Total, 1), \")\"))\n  ) %&gt;%\n  ungroup() %&gt;%\n  select(Category, Label, Respiratory, Childhood, Other_grp)\n\n# .................. Show Category only once per group ..................\ntab_combined &lt;- tab_combined %&gt;%\n  group_by(Category) %&gt;%\n  mutate(Category = ifelse(row_number() == 1, Category, \"\")) %&gt;%\n  ungroup()\n\n# .................. Get total counts per vaccine group ..................\ntotals &lt;- vacc_1524 %&gt;%\n  count(vacc_group3) %&gt;%\n  deframe()\n\n\nft_vacc_summary &lt;- tab_combined %&gt;%\n  flextable() %&gt;%\n  set_header_labels(\n    Category = \"Variable type\",\n    Label = \"Values\",\n    Respiratory = \"Number (%)·µÉ\",\n    Childhood = \"Number (%)·µÉ\",\n    Other_grp = \"Number (%)·µÉ\"\n  ) %&gt;%\n  add_header_row(\n    values = c(\n      \"\", \"\",\n      paste0(\"Respiratory vaccines (N = \", format(totals[\"Respiratory vaccines\"], big.mark = \",\"), \")\"),\n      paste0(\"Childhood vaccines (N = \", format(totals[\"Childhood vaccines\"], big.mark = \",\"), \")\"),\n      paste0(\"Other (N = \", format(totals[\"Other\"], big.mark = \",\"), \")\")\n    )\n  ) %&gt;%\n  add_header_row(\n    values = c(\"Description\", \"Vaccination uptake\"),\n    colwidths = c(2, 3)\n  ) %&gt;%\n  theme_box() %&gt;%\n  set_table_properties(layout = \"autofit\", width = 1) %&gt;%\n  width(j = 1, width = 1.5) %&gt;%\n  width(j = 2, width = 2.5) %&gt;%\n  width(j = 3:5, width = 1.5) %&gt;%\n  align(align = \"justify\", part = \"all\") %&gt;%\n  border_remove() %&gt;%\n  border(part = \"header\", i = 1, border.top = fp_border(color = \"black\", width = 1)) %&gt;%\n  border(part = \"header\", i = 3, border.bottom = fp_border(color = \"black\", width = 1)) %&gt;%\n  border_inner_h(part = \"header\", border = fp_border(color = \"black\", width = 0.8)) %&gt;%\n  border_inner_h(part = \"body\", border = fp_border(color = \"black\", width = 0.8)) %&gt;%\n  border(part = \"body\", i = nrow(tab_combined), border.bottom = fp_border(color = \"black\", width = 1)) %&gt;%\n  \n  set_caption(as_paragraph(as_chunk(\"Table: Vaccination uptake across service year, quarter, and weekday\",\n                                    props = fp_text(font.size = 14, font.family = \"Times New Roman\", bold = FALSE)))) %&gt;%\n  fontsize(part = \"header\", size = 12) %&gt;%\n  fontsize(part = \"body\", size = 11) %&gt;%\n  fontsize(part = \"footer\", size = 10) %&gt;%\n  font(part = \"all\", fontname = \"Times New Roman\") %&gt;%\n  bg(part = \"header\", bg = \"lightblue\") %&gt;%\n  bg(j = 1:5, i = seq(1, nrow(tab_combined), 2), bg = \"lightgray\") %&gt;%\n  bg(j = 1:5, i = seq(2, nrow(tab_combined), 2), bg = \"red\") %&gt;%\n  footnote(i = 1, \n           value = as_paragraph(\"Vaccination proportions were calculated row-wise (i.e., by row).\"),\n           ref_symbols = \"·µÉ\", \n           part = \"header\")\n\n\n# .................. Show the table ..................\nft_vacc_summary\n\nDescription·µÉVaccination uptake·µÉRespiratory vaccines (N = 955)Childhood vaccines (N = 472)Other (N = 126)Variable typeValuesNumber (%)·µÉNumber (%)·µÉNumber (%)·µÉGenderFemale511 (64)233 (29.2)54 (6.8)Male444 (58.8)239 (31.7)72 (9.5)Age0-19250 (38.9)302 (47)90 (14)20-29150 (68.2)70 (31.8)0 (0)30-3947 (71.2)19 (28.8)0 (0)40-49142 (75.9)45 (24.1)0 (0)50-59112 (77.8)14 (9.7)18 (12.5)60-69149 (87.6)13 (7.6)8 (4.7)70+105 (84.7)9 (7.3)10 (8.1)Marital statusDivorced136 (83.4)15 (9.2)12 (7.4)Married289 (79)59 (16.1)18 (4.9)Single/widowed150 (79.4)33 (17.5)6 (3.2)Missing38036590Year201578 (51)56 (36.6)19 (12.4)201684 (60.4)47 (33.8)8 (5.8)201775 (54.7)52 (38)10 (7.3)201881 (53.6)52 (34.4)18 (11.9)201983 (51.6)60 (37.3)18 (11.2)202082 (59.9)44 (32.1)11 (8)2021223 (84.8)34 (12.9)6 (2.3)202288 (73.3)25 (20.8)7 (5.8)202387 (51.2)63 (37.1)20 (11.8)202474 (60.7)39 (32)9 (7.4)Quarter1253 (62.8)120 (29.8)30 (7.4)2220 (58.5)117 (31.1)39 (10.4)3295 (63.2)139 (29.8)33 (7.1)4187 (60.9)96 (31.3)24 (7.8)WeekdayFriday141 (78.3)31 (17.2)8 (4.4)Monday114 (64.4)49 (27.7)14 (7.9)Saturday160 (63.2)81 (32)12 (4.7)Sunday156 (56.3)100 (36.1)21 (7.6)Thursday167 (66)66 (26.1)20 (7.9)Tuesday108 (65.5)43 (26.1)14 (8.5)Wednesday109 (44)102 (41.1)37 (14.9)·µÉVaccination proportions were calculated row-wise (i.e., by row).\n\n# .................. Clean up all new objects ..................\nrm(tab_age, tab_sex, tab_marital_status, tab_year, tab_quarter, tab_weekday, \n   tab_combined, ft_vacc_summary, totals, create_tab)\n\n\n\n\nThis is not a new table‚Äîrather, it‚Äôs a conceptual summary of the row-wise percentage approaches applied in earlier sections.\nImportance:\n\nPercentages sum to 100% per row, highlighting within-group distributions.\n\nImplications:\n\nAnswers: ‚ÄúWithin age group X, what % received each vaccine?‚Äù\n\n\n\n\nThis version calculates percentages down each vaccine group column, rather than across each row.\nImportance:\n\nPercentages sum to 100% per column, showing group contributions to totals.\n\nImplications:\n\nAnswers: ‚ÄúAmong Respiratory vaccines, what % are from age group X?‚Äù\nUse this when: You want to know, for example, what percentage of all Respiratory vaccine users were aged below 25 years.\n\n\n# ------------ 10. Columnwise Tables -------------------------------------------\n\n# Prepare Vaccination Uptake Table (All Variables Using Column Percentages)\n\n# --- Convert selected variables to character type for proper label handling ---\nvacc_1524 &lt;- vacc_1524 %&gt;%\n  mutate(across(c(gender, age_3group, marital_2group, year_3group, vacc_quarter, race_grouped), as.character))\n\n# --- Create general table-building function with optional column percentage flag ---\n# This function creates a summary count table of vaccination type by a categorical variable.\n# If use_col_percentage is TRUE, the summary will support column-based percentage formatting.\ncreate_tab &lt;- function(data, var, label, use_col_percentage = TRUE) {\n  tab_main &lt;- data %&gt;%\n    filter(!is.na({{ var }})) %&gt;%\n    tabyl({{ var }}, vacc_group3) %&gt;%\n    mutate(Category = label, .before = 1) %&gt;%\n    rename(Label = {{ var }}) %&gt;%\n    mutate(Label = as.character(Label))\n  \n  # Add a row for \"Unknown\" if missing values are found\n  na_count &lt;- sum(is.na(pull(data, {{ var }})))\n  if (na_count &gt; 0) {\n    na_row &lt;- tibble(\n      Category = label,\n      Label = \"Unknown\",\n      `Respiratory vaccines` = sum(data$vacc_group3 == \"Respiratory vaccines\" & is.na(pull(data, {{ var }})), na.rm = TRUE),\n      `Childhood vaccines` = sum(data$vacc_group3 == \"Childhood vaccines\" & is.na(pull(data, {{ var }})), na.rm = TRUE),\n      Other = sum(data$vacc_group3 == \"Other\" & is.na(pull(data, {{ var }})), na.rm = TRUE)\n    )\n    tab_combined &lt;- bind_rows(tab_main, na_row)\n  } else {\n    tab_combined &lt;- tab_main\n  }\n  \n  tab_combined %&gt;%\n    mutate(use_col_percentage = use_col_percentage)\n}\n\n# --- Generate summary tables for each variable using column percentages ---\ntab_gender    &lt;- create_tab(vacc_1524, gender, \"Gender\")\ntab_age       &lt;- create_tab(vacc_1524, age_3group, \"Age group\")\ntab_marital   &lt;- create_tab(vacc_1524, marital_2group, \"Marital status·µá\")\ntab_year      &lt;- create_tab(vacc_1524, year_3group, \"Year group\")\ntab_quarter   &lt;- create_tab(vacc_1524, vacc_quarter, \"Quarter\")\ntab_race      &lt;- create_tab(vacc_1524, race_grouped, \"Race group\")\n\n# --- Combine all variable-level tables into one ---\ntab_combined &lt;- bind_rows(\n  tab_gender, tab_age, tab_marital,\n  tab_year, tab_quarter, tab_race\n)\n\n# --- Calculate percentages and format values into strings with \"Number (%)\" ---\ntab_combined &lt;- tab_combined %&gt;%\n  group_by(Category) %&gt;%\n  mutate(\n    use_col = TRUE,  # column percentages applied uniformly\n    \n    # Calculate denominators excluding \"Unknown\"\n    Total_Resp = sum(`Respiratory vaccines`[Label != \"Unknown\"], na.rm = TRUE),\n    Total_Child = sum(`Childhood vaccines`[Label != \"Unknown\"], na.rm = TRUE),\n    Total_Other = sum(Other[Label != \"Unknown\"], na.rm = TRUE),\n    \n    # Calculate percentages\n    Resp_prop = ifelse(Label != \"Unknown\", round(100 * `Respiratory vaccines` / Total_Resp, 1), NA),\n    Child_prop = ifelse(Label != \"Unknown\", round(100 * `Childhood vaccines` / Total_Child, 1), NA),\n    Other_prop = ifelse(Label != \"Unknown\", round(100 * Other / Total_Other, 1), NA),\n    \n    # Format final output as \"number (percentage)\"\n    Respiratory = ifelse(is.na(Resp_prop),\n                         paste0(comma(`Respiratory vaccines`)),\n                         paste0(comma(`Respiratory vaccines`), \" (\", Resp_prop, \")\")),\n    Childhood = ifelse(is.na(Child_prop),\n                       paste0(comma(`Childhood vaccines`)),\n                       paste0(comma(`Childhood vaccines`), \" (\", Child_prop, \")\")),\n    Other_grp = ifelse(is.na(Other_prop),\n                       paste0(comma(Other)),\n                       paste0(comma(Other), \" (\", Other_prop, \")\"))\n  ) %&gt;%\n  ungroup()\n\n# --- Final clean-up: labels, superscripts, and hiding \"0 (0)\" from Unknown row ---\ntab_combined &lt;- tab_combined %&gt;%\n  mutate(\n    Label = ifelse(Label == \"Other\", \"Other·∂ú\", Label),\n    Respiratory = ifelse(Label == \"Unknown\" & `Respiratory vaccines` == 0, \"\", Respiratory),\n    Childhood   = ifelse(Label == \"Unknown\" & `Childhood vaccines` == 0, \"\", Childhood),\n    Other_grp   = ifelse(Label == \"Unknown\" & Other == 0, \"\", Other_grp)\n  ) %&gt;%\n  group_by(Category) %&gt;%\n  mutate(Category = ifelse(row_number() == 1, Category, \"\")) %&gt;%\n  ungroup() %&gt;%\n  select(Category, Label, Respiratory, Childhood, Other_grp)\n\n# --- Get total N for each vaccine group to display in header ---\ntotals &lt;- table(vacc_1524$vacc_group3)\ntotal_resp &lt;- totals[\"Respiratory vaccines\"]\ntotal_child &lt;- totals[\"Childhood vaccines\"]\ntotal_other &lt;- totals[\"Other\"]\n\n# --- Build flextable for formatted presentation ---\ntable_vacc_summary &lt;- flextable(tab_combined) %&gt;%\n  set_header_labels(\n    Category = \"Variable type\",\n    Label = \"Values\",\n    Respiratory = \"Number (%)·µÉ\",\n    Childhood = \"Number (%)·µÉ\",\n    Other_grp = \"Number (%)·µÉ\"\n  ) %&gt;%\n  add_header_row(\n    values = c(\"\", \"\",\n               paste0(\"Respiratory vaccines (N = \", format(total_resp, big.mark = \",\"), \")\"),\n               paste0(\"Childhood vaccines (N = \", format(total_child, big.mark = \",\"), \")\"),\n               paste0(\"Other (N = \", format(total_other, big.mark = \",\"), \")\")),\n    colwidths = c(1, 1, 1, 1, 1),\n    top = TRUE\n  ) %&gt;%\n  add_header_row(\n    values = c(\"Description\", \"Vaccination uptake\"),\n    colwidths = c(2, 3),\n    top = TRUE\n  ) %&gt;%\n  theme_box() %&gt;%\n  set_table_properties(layout = \"autofit\", width = 1) %&gt;%\n  width(j = 1, width = 1.5) %&gt;%\n  width(j = 2, width = 2.5) %&gt;%\n  width(j = 3:5, width = 1.5) %&gt;%\n  align(align = \"justify\", part = \"all\") %&gt;%\n  border_remove() %&gt;%\n  border(part = \"header\", i = 1, border.top = fp_border(color = \"black\", width = 1)) %&gt;%\n  border(part = \"header\", i = 3, border.bottom = fp_border(color = \"black\", width = 1)) %&gt;%\n  border_inner_h(part = \"header\", border = fp_border(color = \"black\", width = 0.8)) %&gt;%\n  border_inner_h(part = \"body\", border = fp_border(color = \"black\", width = 0.8)) %&gt;%\n  border(part = \"body\", i = nrow(tab_combined), border.bottom = fp_border(color = \"black\", width = 1)) %&gt;%\n  set_caption(as_paragraph(as_chunk(\n    \"Table xx: Column-percentage summary of vaccination uptake across all demographic variables, 2015‚Äì2024.\",\n    props = fp_text(font.size = 12, font.family = \"Times New Roman\", bold = FALSE)\n  ))) %&gt;%\n  add_footer_lines(values = c(\n    \"·µÉ Vaccination proportions were calculated using column percentages for all variables.\",\n    \"·µá Marital status was grouped into two: partnered (married) and not-partnered (divorced, widowed, single).\",\n    \"·∂ú Other race refers to those identifying as native or other racial groups.\"\n  )) %&gt;%\n  fontsize(part = \"header\", size = 12) %&gt;%\n  fontsize(part = \"body\", size = 11) %&gt;%\n  fontsize(part = \"footer\", size = 10) %&gt;%\n  font(part = \"all\", fontname = \"Times New Roman\") %&gt;%\n  color(part = \"header\", color = \"white\") %&gt;%\n  bg(part = \"header\", bg = \"black\") %&gt;%\n  bg(j = 1:5, i = seq(2, nrow(tab_combined), 2), bg = \"white\") %&gt;%\n  bold(j = 1, part = \"body\")\n\n# --- Display final table ---\ntable_vacc_summary\n\nDescriptionVaccination uptakeRespiratory vaccines (N = 955)Childhood vaccines (N = 472)Other (N = 126)Variable typeValuesNumber (%)·µÉNumber (%)·µÉNumber (%)·µÉGenderFemale511 (53.5)233 (49.4)54 (42.9)Male444 (46.5)239 (50.6)72 (57.1)Age group&lt;25332 (34.8)337 (71.4)90 (71.4)25-3498 (10.3)51 (10.8)0 (0)35+525 (55)84 (17.8)36 (28.6)Marital status·µáNot partnered286 (49.7)48 (44.9)18 (50)Partnered289 (50.3)59 (55.1)18 (50)Unknown38036590Year group‚â§2020483 (50.6)311 (65.9)84 (66.7)2021-2022311 (32.6)59 (12.5)13 (10.3)2023+161 (16.9)102 (21.6)29 (23)Quarter1253 (26.5)120 (25.4)30 (23.8)2220 (23)117 (24.8)39 (31)3295 (30.9)139 (29.4)33 (26.2)4187 (19.6)96 (20.3)24 (19)Race groupAsian69 (7.8)33 (7.3)9 (7.3)Other·∂ú28 (3.2)13 (2.9)1 (0.8)White788 (89)404 (89.8)114 (91.9)Unknown70222·µÉ Vaccination proportions were calculated using column percentages for all variables.·µá Marital status was grouped into two: partnered (married) and not-partnered (divorced, widowed, single).·∂ú Other race refers to those identifying as native or other racial groups.\n\n# --- Clean up temporary variables (optional good practice) ---\nrm(\n  tab_gender, tab_age, tab_marital, tab_year, tab_quarter, tab_race,\n  tab_combined, create_tab, totals, total_resp, total_child, total_other\n)\n\n\n\n\nColumnwise percentage table including NA where applicable - All variables use column percentages (i.e., % down each vaccine group column) - NA values are shown only where relevant (e.g., race group for Respiratory vaccines) - ‚ÄúUnknown‚Äù variable categories are excluded from percentage calculations to maintain ~100% totals per column - Useful for subgroup summaries where not all variables apply across all vaccine type\n\n# ------------ 11. Columnwise Tables with NA values-------------------------------------------\n\n# Prepare Vaccination Uptake Table (All Variables Using Column Percentages)\n# ....................................................................................................\n\n# --- Set working directory and load data (if needed) ---\n# setwd(\"C:/Users/User/Desktop/Materials_ Course and proposals/Course Related/DataCamp/Data/\")\n# load(\"Vaccination_uptake.RDATA\")\n\n# --- Clean and prepare datasets ---\nvacc_1524 &lt;- vacc_1524 %&gt;%\n  mutate(across(c(gender, age_3group, marital_2group, year_3group, vacc_quarter, race_grouped), as.character))\n\n# Subset data for Respiratory vaccines to calculate column-based percentages (used for race)\nrespiratory_vaccines &lt;- vacc_1524 %&gt;%\n  filter(vacc_group3 == \"Respiratory vaccines\") %&gt;%\n  mutate(across(race_grouped, as.character))\n\n# --- General table builder ---\ncreate_tab &lt;- function(data, var, label, use_col_percentage = TRUE) {\n  tab_main &lt;- data %&gt;%\n    filter(!is.na({{ var }})) %&gt;%\n    tabyl({{ var }}, vacc_group3) %&gt;%\n    mutate(Category = label, .before = 1) %&gt;%\n    rename(Label = {{ var }}) %&gt;%\n    mutate(Label = as.character(Label))\n  \n  na_count &lt;- sum(is.na(pull(data, {{ var }})))\n  if (na_count &gt; 0) {\n    na_row &lt;- tibble(\n      Category = label,\n      Label = \"Unknown\",\n      `Respiratory vaccines` = sum(data$vacc_group3 == \"Respiratory vaccines\" & is.na(pull(data, {{ var }})), na.rm = TRUE),\n      `Childhood vaccines` = sum(data$vacc_group3 == \"Childhood vaccines\" & is.na(pull(data, {{ var }})), na.rm = TRUE),\n      Other = sum(data$vacc_group3 == \"Other\" & is.na(pull(data, {{ var }})), na.rm = TRUE)\n    )\n    tab_combined &lt;- bind_rows(tab_main, na_row)\n  } else {\n    tab_combined &lt;- tab_main\n  }\n  \n  tab_combined %&gt;%\n    mutate(use_col_percentage = use_col_percentage)\n}\n\n# --- Create summary tables ---\ntab_gender    &lt;- create_tab(vacc_1524, gender, \"Gender\")\ntab_age       &lt;- create_tab(vacc_1524, age_3group, \"Age group\")\ntab_marital   &lt;- create_tab(vacc_1524, marital_2group, \"Marital status·µá\")\ntab_year      &lt;- create_tab(vacc_1524, year_3group, \"Year group\")\ntab_quarter   &lt;- create_tab(vacc_1524, vacc_quarter, \"Quarter\")\n\n# Race group from respiratory-only subset (denominator = respiratory group only)\ntab_race      &lt;- create_tab(respiratory_vaccines, race_grouped, \"Race group\")\n\n# --- Combine all tables ---\ntab_combined &lt;- bind_rows(\n  tab_gender, tab_age, tab_marital,\n  tab_year, tab_quarter, tab_race\n)\n\n# --- Calculate and format column percentages ---\ntab_combined &lt;- tab_combined %&gt;%\n  group_by(Category) %&gt;%\n  mutate(\n    use_col = TRUE,\n    Total_Resp = sum(`Respiratory vaccines`[Label != \"Unknown\"], na.rm = TRUE),\n    Total_Child = sum(`Childhood vaccines`[Label != \"Unknown\"], na.rm = TRUE),\n    Total_Other = sum(Other[Label != \"Unknown\"], na.rm = TRUE),\n    \n    Resp_prop = ifelse(Label != \"Unknown\", round(100 * `Respiratory vaccines` / Total_Resp, 1), NA),\n    Child_prop = ifelse(Label != \"Unknown\", round(100 * `Childhood vaccines` / Total_Child, 1), NA),\n    Other_prop = ifelse(Label != \"Unknown\", round(100 * Other / Total_Other, 1), NA),\n    \n    Respiratory = ifelse(is.na(Resp_prop),\n                         paste0(comma(`Respiratory vaccines`)),\n                         paste0(comma(`Respiratory vaccines`), \" (\", Resp_prop, \")\")),\n    Childhood = ifelse(is.na(Child_prop),\n                       paste0(comma(`Childhood vaccines`)),\n                       paste0(comma(`Childhood vaccines`), \" (\", Child_prop, \")\")),\n    Other_grp = ifelse(is.na(Other_prop),\n                       paste0(comma(Other)),\n                       paste0(comma(Other), \" (\", Other_prop, \")\"))\n  ) %&gt;%\n  ungroup()\n\n# --- Format labels and rows ---\ntab_combined &lt;- tab_combined %&gt;%\n  mutate(\n    Label = ifelse(Label == \"Other\", \"Other·∂ú\", Label),\n    Respiratory = ifelse(Label == \"Unknown\" & `Respiratory vaccines` == 0, \"\", Respiratory),\n    Childhood   = ifelse(Label == \"Unknown\" & `Childhood vaccines` == 0, \"\", Childhood),\n    Other_grp   = ifelse(Label == \"Unknown\" & Other == 0, \"\", Other_grp)\n  ) %&gt;%\n  group_by(Category) %&gt;%\n  mutate(Category = ifelse(row_number() == 1, Category, \"\")) %&gt;%\n  ungroup() %&gt;%\n  select(Category, Label, Respiratory, Childhood, Other_grp)\n\n# --- Prepare column Ns for header ---\ntotals &lt;- table(vacc_1524$vacc_group3)\ntotal_resp &lt;- totals[\"Respiratory vaccines\"]\ntotal_child &lt;- totals[\"Childhood vaccines\"]\ntotal_other &lt;- totals[\"Other\"]\n\n# --- Build Flextable ---\ntable_vacc_summary &lt;- flextable(tab_combined) %&gt;%\n  set_header_labels(\n    Category = \"Variable type\",\n    Label = \"Values\",\n    Respiratory = \"Number (%)·µÉ\",\n    Childhood = \"Number (%)·µÉ\",\n    Other_grp = \"Number (%)·µÉ\"\n  ) %&gt;%\n  add_header_row(\n    values = c(\"\", \"\",\n               paste0(\"Respiratory vaccines (N = \", format(total_resp, big.mark = \",\"), \")\"),\n               paste0(\"Childhood vaccines (N = \", format(total_child, big.mark = \",\"), \")\"),\n               paste0(\"Other (N = \", format(total_other, big.mark = \",\"), \")\")),\n    colwidths = c(1, 1, 1, 1, 1),\n    top = TRUE\n  ) %&gt;%\n  add_header_row(\n    values = c(\"Description\", \"Vaccination uptake\"),\n    colwidths = c(2, 3),\n    top = TRUE\n  ) %&gt;%\n  theme_box() %&gt;%\n  set_table_properties(layout = \"autofit\", width = 1) %&gt;%\n  width(j = 1, width = 1.5) %&gt;%\n  width(j = 2, width = 2.5) %&gt;%\n  width(j = 3:5, width = 1.5) %&gt;%\n  align(align = \"justify\", part = \"all\") %&gt;%\n  border_remove() %&gt;%\n  border(part = \"header\", i = 1, border.top = fp_border(color = \"black\", width = 1)) %&gt;%\n  border(part = \"header\", i = 3, border.bottom = fp_border(color = \"black\", width = 1)) %&gt;%\n  border_inner_h(part = \"header\", border = fp_border(color = \"black\", width = 0.8)) %&gt;%\n  border_inner_h(part = \"body\", border = fp_border(color = \"black\", width = 0.8)) %&gt;%\n  border(part = \"body\", i = nrow(tab_combined), border.bottom = fp_border(color = \"black\", width = 1)) %&gt;%\n  set_caption(as_paragraph(as_chunk(\n    \"Table xx: Column-percentage summary of vaccination uptake across all demographic variables, 2015‚Äì2024.\",\n    props = fp_text(font.size = 12, font.family = \"Times New Roman\", bold = FALSE)\n  ))) %&gt;%\n  add_footer_lines(values = c(\n    \"·µÉ Vaccination proportions were calculated using column percentages. Race group used respiratory vaccine subset only.\",\n    \"·µá Marital status was grouped into partnered (married) and non-partnered (single, divorced, widowed).\",\n    \"·∂ú 'Other' race includes native or other less represented racial identities.\"\n  )) %&gt;%\n  fontsize(part = \"header\", size = 12) %&gt;%\n  fontsize(part = \"body\", size = 11) %&gt;%\n  fontsize(part = \"footer\", size = 10) %&gt;%\n  font(part = \"all\", fontname = \"Times New Roman\") %&gt;%\n  color(part = \"header\", color = \"white\") %&gt;%\n  bg(part = \"header\", bg = \"#000000\") %&gt;%\n  bg(j = 1:5, i = seq(2, nrow(tab_combined), 2), bg = \"white\") %&gt;%\n  bold(j = 1, part = \"body\")\n\n# --- Display final table ---\ntable_vacc_summary\n\nDescriptionVaccination uptakeRespiratory vaccines (N = 955)Childhood vaccines (N = 472)Other (N = 126)Variable typeValuesNumber (%)·µÉNumber (%)·µÉNumber (%)·µÉGenderFemale511 (53.5)233 (49.4)54 (42.9)Male444 (46.5)239 (50.6)72 (57.1)Age group&lt;25332 (34.8)337 (71.4)90 (71.4)25-3498 (10.3)51 (10.8)0 (0)35+525 (55)84 (17.8)36 (28.6)Marital status·µáNot partnered286 (49.7)48 (44.9)18 (50)Partnered289 (50.3)59 (55.1)18 (50)Unknown38036590Year group‚â§2020483 (50.6)311 (65.9)84 (66.7)2021-2022311 (32.6)59 (12.5)13 (10.3)2023+161 (16.9)102 (21.6)29 (23)Quarter1253 (26.5)120 (25.4)30 (23.8)2220 (23)117 (24.8)39 (31)3295 (30.9)139 (29.4)33 (26.2)4187 (19.6)96 (20.3)24 (19)Race groupAsian69 (7.8)NANAOther·∂ú28 (3.2)NANAWhite788 (89)NANAUnknown70·µÉ Vaccination proportions were calculated using column percentages. Race group used respiratory vaccine subset only.·µá Marital status was grouped into partnered (married) and non-partnered (single, divorced, widowed).·∂ú 'Other' race includes native or other less represented racial identities.\n\n# --- Cleanup temporary objects ---\nrm(\n  tab_gender, tab_age, tab_marital, tab_year, tab_quarter, tab_race,\n  tab_combined, create_tab, totals, total_resp, total_child, total_other,\n  respiratory_vaccines\n)\n\n\n\n\nThis table presents both row and column percentages for vaccination uptake:\n\nRow percentages show how each category (e.g., age group, gender) distributes across vaccine types.\nColumn percentages are applied only to the race group, highlighting the demographic makeup within the respiratory vaccine recipients.\n\nThis format helps answer questions like: - ‚ÄúWhat proportion of women in each age group received respiratory vaccines?‚Äù (row %) - ‚ÄúWhat proportion of respiratory vaccine recipients were Aboriginal?‚Äù (column %)\nUnknown values are included but excluded from percentage calculations to avoid distorting group totals.\n\n# ------------12. Both Row wise and Column wise Tables -------------------------------------------\n\n# ....................................................................................................\n# Prepare Vaccination Uptake Table (Row and Column Percentages)\n# ....................................................................................................\n\n# --- Step 1: Prepare data for table formatting ---\n# Convert grouping variables to character for cleaner label handling\nvacc_1524 &lt;- vacc_1524 %&gt;%\n  mutate(across(c(gender, age_3group, marital_2group, year_3group, vacc_quarter, race_grouped), as.character))\n\n# Subset data for Respiratory vaccines to calculate column-based percentages (used for race)\nrespiratory_vaccines &lt;- vacc_1524 %&gt;%\n  filter(vacc_group3 == \"Respiratory vaccines\") %&gt;%\n  mutate(across(race_grouped, as.character))\n\n# --- Step 2: Create table-building function ---\n# This function tabulates counts by category and optionally adds missing (Unknown) values\ncreate_tab &lt;- function(data, var, label, use_col_percentage = FALSE) {\n  tab_main &lt;- data %&gt;%\n    filter(!is.na({{ var }})) %&gt;%\n    tabyl({{ var }}, vacc_group3) %&gt;%\n    mutate(Category = label, .before = 1) %&gt;%\n    rename(Label = {{ var }}) %&gt;%\n    mutate(Label = as.character(Label))\n  \n  # Add a row for missing/unknown if needed\n  na_count &lt;- sum(is.na(pull(data, {{ var }})))\n  if (na_count &gt; 0) {\n    na_row &lt;- tibble(\n      Category = label,\n      Label = \"Unknown\",\n      `Respiratory vaccines` = sum(data$vacc_group3 == \"Respiratory vaccines\" & is.na(pull(data, {{ var }})), na.rm = TRUE),\n      `Childhood vaccines` = sum(data$vacc_group3 == \"Childhood vaccines\" & is.na(pull(data, {{ var }})), na.rm = TRUE),\n      Other = sum(data$vacc_group3 == \"Other\" & is.na(pull(data, {{ var }})), na.rm = TRUE)\n    )\n    tab_combined &lt;- bind_rows(tab_main, na_row)\n  } else {\n    tab_combined &lt;- tab_main\n  }\n  \n  tab_combined %&gt;%\n    mutate(use_col_percentage = use_col_percentage)\n}\n\n# --- Step 3: Generate frequency tables for each variable ---\ntab_gender    &lt;- create_tab(vacc_1524, gender, \"Gender\")\ntab_age       &lt;- create_tab(vacc_1524, age_3group, \"Age group\")\ntab_marital   &lt;- create_tab(vacc_1524, marital_2group, \"Marital status·µá\")\ntab_year      &lt;- create_tab(vacc_1524, year_3group, \"Year group\")\ntab_quarter   &lt;- create_tab(vacc_1524, vacc_quarter, \"Quarter\")\ntab_race      &lt;- create_tab(respiratory_vaccines, race_grouped, \"Race group\", use_col_percentage = TRUE)\n\n# --- Step 4: Combine all tables ---\ntab_combined &lt;- bind_rows(\n  tab_gender, tab_age, tab_marital,\n  tab_year, tab_quarter, tab_race\n)\n\n# --- Step 5: Calculate percentages and formatted string outputs ---\ntab_combined &lt;- tab_combined %&gt;%\n  group_by(Category) %&gt;%\n  mutate(\n    use_col = first(use_col_percentage),\n    \n    # Exclude \"Unknown\" when calculating column totals to ensure proportions sum to 100\n    Total_Resp = ifelse(use_col, sum(`Respiratory vaccines`[Label != \"Unknown\"], na.rm = TRUE),\n                        `Respiratory vaccines` + `Childhood vaccines` + Other),\n    Total_Child = ifelse(use_col, sum(`Childhood vaccines`[Label != \"Unknown\"], na.rm = TRUE),\n                         `Respiratory vaccines` + `Childhood vaccines` + Other),\n    Total_Other = ifelse(use_col, sum(Other[Label != \"Unknown\"], na.rm = TRUE),\n                         `Respiratory vaccines` + `Childhood vaccines` + Other),\n    \n    # Calculate proportions\n    Resp_prop = ifelse(Label != \"Unknown\", round(100 * `Respiratory vaccines` / Total_Resp, 1), NA),\n    Child_prop = ifelse(Label != \"Unknown\", round(100 * `Childhood vaccines` / Total_Child, 1), NA),\n    Other_prop = ifelse(Label != \"Unknown\", round(100 * Other / Total_Other, 1), NA),\n    \n    # Format numbers and percentages\n    Respiratory = ifelse(is.na(Resp_prop),\n                         paste0(comma(`Respiratory vaccines`)),\n                         paste0(comma(`Respiratory vaccines`), \" (\", Resp_prop, \")\")),\n    Childhood = ifelse(is.na(Child_prop),\n                       paste0(comma(`Childhood vaccines`)),\n                       paste0(comma(`Childhood vaccines`), \" (\", Child_prop, \")\")),\n    Other_grp = ifelse(is.na(Other_prop),\n                       paste0(comma(Other)),\n                       paste0(comma(Other), \" (\", Other_prop, \")\"))\n  ) %&gt;%\n  ungroup()\n\n# --- Step 6: Clean labels and fix formatting for final table ---\ntab_combined &lt;- tab_combined %&gt;%\n  mutate(\n    Label = ifelse(Label == \"Other\", \"Other·∂ú\", Label),\n    Respiratory = ifelse(Label == \"Unknown\" & `Respiratory vaccines` == 0, \"\", Respiratory),\n    Childhood   = ifelse(Label == \"Unknown\" & `Childhood vaccines` == 0, \"\", Childhood),\n    Other_grp   = ifelse(Label == \"Unknown\" & Other == 0, \"\", Other_grp)\n  ) %&gt;%\n  group_by(Category) %&gt;%\n  mutate(Category = ifelse(row_number() == 1, Category, \"\")) %&gt;%\n  ungroup() %&gt;%\n  select(Category, Label, Respiratory, Childhood, Other_grp)\n\n# --- Step 7: Calculate group totals for header ---\ntotals &lt;- table(vacc_1524$vacc_group3)\ntotal_resp &lt;- totals[\"Respiratory vaccines\"]\ntotal_child &lt;- totals[\"Childhood vaccines\"]\ntotal_other &lt;- totals[\"Other\"]\n\n# --- Step 8: Create styled summary table using flextable ---\ntable_vacc_summary &lt;- flextable(tab_combined) %&gt;%\n  set_header_labels(\n    Category = \"Variable type\",\n    Label = \"Values\",\n    Respiratory = \"Number (%)·µÉ\",\n    Childhood = \"Number (%)·µÉ\",\n    Other_grp = \"Number (%)·µÉ\"\n  ) %&gt;%\n  add_header_row(\n    values = c(\"\", \"\",\n               paste0(\"Respiratory vaccines (N = \", format(total_resp, big.mark = \",\"), \")\"),\n               paste0(\"Childhood vaccines (N = \", format(total_child, big.mark = \",\"), \")\"),\n               paste0(\"Other (N = \", format(total_other, big.mark = \",\"), \")\")),\n    colwidths = c(1, 1, 1, 1, 1),\n    top = TRUE\n  ) %&gt;%\n  add_header_row(\n    values = c(\"Description\", \"Vaccination uptake\"),\n    colwidths = c(2, 3),\n    top = TRUE\n  ) %&gt;%\n  theme_box() %&gt;%\n  set_table_properties(layout = \"autofit\", width = 1) %&gt;%\n  width(j = 1, width = 1.5) %&gt;%\n  width(j = 2, width = 2.5) %&gt;%\n  width(j = 3:5, width = 1.5) %&gt;%\n  align(align = \"justify\", part = \"all\") %&gt;%\n  border_remove() %&gt;%\n  border(part = \"header\", i = 1, border.top = fp_border(color = \"black\", width = 1)) %&gt;%\n  border(part = \"header\", i = 3, border.bottom = fp_border(color = \"black\", width = 1)) %&gt;%\n  border_inner_h(part = \"header\", border = fp_border(color = \"black\", width = 0.8)) %&gt;%\n  border_inner_h(part = \"body\", border = fp_border(color = \"black\", width = 0.8)) %&gt;%\n  border(part = \"body\", i = nrow(tab_combined), border.bottom = fp_border(color = \"black\", width = 1)) %&gt;%\n  set_caption(as_paragraph(as_chunk(\n    \"Table xx: Vaccination uptake by demographic, temporal, and race variables, 2015‚Äì2024.\",\n    props = fp_text(font.size = 12, font.family = \"Times New Roman\", bold = FALSE)\n  ))) %&gt;%\n  add_footer_lines(values = c(\n    \"·µÉ Vaccination proportions were calculated per row (row percentage) except for race group which used column percentages.\",\n    \"·µá Marital status was grouped into two: partnered for those married and non-partnered for those divorced, widowed or single.\",\n    \"·∂ú Other race refers to those who identify as native or other racial groups.\"\n  )) %&gt;%\n  fontsize(part = \"header\", size = 12) %&gt;%\n  fontsize(part = \"body\", size = 11) %&gt;%\n  fontsize(part = \"footer\", size = 10) %&gt;%\n  font(part = \"all\", fontname = \"Times New Roman\") %&gt;%\n  color(part = \"header\", color = \"white\") %&gt;%\n  bg(part = \"header\", bg = \"black\") %&gt;%\n  bg(j = 1:5, i = seq(2, nrow(tab_combined), 2), bg = \"white\") %&gt;%\n  bold(j = 1, part = \"body\")\n\n# --- Step 9: Display table ---\ntable_vacc_summary\n\nDescriptionVaccination uptakeRespiratory vaccines (N = 955)Childhood vaccines (N = 472)Other (N = 126)Variable typeValuesNumber (%)·µÉNumber (%)·µÉNumber (%)·µÉGenderFemale511 (64)233 (29.2)54 (6.8)Male444 (58.8)239 (31.7)72 (9.5)Age group&lt;25332 (43.7)337 (44.4)90 (11.9)25-3498 (65.8)51 (34.2)0 (0)35+525 (81.4)84 (13)36 (5.6)Marital status·µáNot partnered286 (81.2)48 (13.6)18 (5.1)Partnered289 (79)59 (16.1)18 (4.9)Unknown38036590Year group‚â§2020483 (55)311 (35.4)84 (9.6)2021-2022311 (81.2)59 (15.4)13 (3.4)2023+161 (55.1)102 (34.9)29 (9.9)Quarter1253 (62.8)120 (29.8)30 (7.4)2220 (58.5)117 (31.1)39 (10.4)3295 (63.2)139 (29.8)33 (7.1)4187 (60.9)96 (31.3)24 (7.8)Race groupAsian69 (7.8)NANAOther·∂ú28 (3.2)NANAWhite788 (89)NANAUnknown70·µÉ Vaccination proportions were calculated per row (row percentage) except for race group which used column percentages.·µá Marital status was grouped into two: partnered for those married and non-partnered for those divorced, widowed or single.·∂ú Other race refers to those who identify as native or other racial groups.\n\n# --- Step 10: Clean up temporary objects (optional) ---\nrm(\n  tab_gender, tab_age, tab_marital, tab_year, tab_quarter, tab_race,\n  tab_combined, create_tab, respiratory_vaccines,\n  totals, total_resp, total_child, total_other\n)\n\n\n\n\nHere we simulate multiple-response tables by combining summary outputs from different variables side-by-side.\nüìö What‚Äôs useful here?\n\nShows how people responded with combinations of vaccine types (e.g., Both, Influenza, or None), where both here refers vaccination of influenza and other vaccine types.\nüôå Applies to: Any analysis involving response overlaps (e.g., co-morbidity, multiple treatments, combined exposures).\n\n\n# ------------ 10. Mutiple Response Tables: via appending: Rowwise -------------------------------------------\n\n# .................. Create flextable summary by variable ..................\nprocess_variable &lt;- function(data, group_var, group_label) {\n  \n  # Base pattern: Both and No\n  df_base &lt;- data %&gt;%\n    group_by(across(all_of(group_var)), vacc_pattern) %&gt;%\n    summarise(count = n(), .groups = \"drop\") %&gt;%\n    group_by(across(all_of(group_var))) %&gt;%\n    mutate(total = sum(count),\n           proportion = round((count / total) * 100, 1)) %&gt;%\n    ungroup() %&gt;%\n    filter(vacc_pattern %in% c(\"Both\", \"No\")) %&gt;%\n    rename(value = !!sym(group_var)) %&gt;%\n    mutate(value = as.character(value))\n  \n  # Influenza \n  df_flu &lt;- data %&gt;%\n    filter(!is.na(!!sym(group_var))) %&gt;%\n    mutate(flu_yes = recode(flu_yes, \"Yes\" = \"Influenza\")) %&gt;%\n    group_by(across(all_of(group_var)), flu_yes) %&gt;%\n    summarise(count = n(), .groups = \"drop\") %&gt;%\n    group_by(across(all_of(group_var))) %&gt;%\n    mutate(total = sum(count),\n           proportion = round((count / total) * 100, 1)) %&gt;%\n    ungroup() %&gt;%\n    filter(flu_yes == \"Influenza\") %&gt;%\n    rename(vacc_pattern = flu_yes, value = !!sym(group_var)) %&gt;%\n    mutate(value = as.character(value))\n  \n  df_combined &lt;- bind_rows(df_base, df_flu) %&gt;%\n    mutate(vacc_pattern = factor(vacc_pattern, levels = c(\"Both\", \"Influenza\", \"No\")))\n  \n  df_wide &lt;- df_combined %&gt;%\n    select(value, vacc_pattern, count, proportion) %&gt;%\n    pivot_wider(\n      names_from = vacc_pattern,\n      values_from = c(count, proportion),\n      values_fn = list(count = sum, proportion = sum),\n      values_fill = list(count = 0, proportion = 0)\n    ) %&gt;%\n    mutate(\n      Both = paste0(comma(`count_Both`), \" (\", `proportion_Both`, \")\"),\n      `Influenza only` = paste0(comma(`count_Influenza`), \" (\", `proportion_Influenza`, \")\"),\n      No = paste0(comma(`count_No`), \" (\", `proportion_No`, \")\"),\n      Variable = group_label\n    ) %&gt;%\n    select(value, Both, `Influenza only`, No, Variable)\n  \n  return(df_wide)\n}\n\n# Run for selected grouping variables\ndf_year &lt;- process_variable(vacc_1524, \"vacc_service_year\", \"Service year\")\ndf_age &lt;- process_variable(vacc_1524, \"age_group\", \"Age group\")\n\n# Combine and format for flextable\ndf_combined_long &lt;- bind_rows(df_year, df_age) %&gt;%\n  rename(Value = value) %&gt;%\n  select(Variable, Value, Both, `Influenza only`, No) %&gt;%\n  group_by(Variable) %&gt;%\n  mutate(Variable = ifelse(row_number() == 1, Variable, \"\")) %&gt;%\n  ungroup()\n\n# Create flextable\nfinal_table &lt;- flextable(df_combined_long) %&gt;%\n  set_header_labels(\n    Variable = \"Variable\",\n    Value = \"Value\",\n    Both = \"Both (%)\",\n    `Influenza only` = \"Influenza (%)\",\n    No = \"No (%)\"\n  ) %&gt;%\n  add_header_row(\n    values = c(\" \", \" \", \"Vaccination pattern·µÉ\"),\n    colwidths = c(1, 1, 3)\n  ) %&gt;%\n  align(align = \"justify\", part = \"all\") %&gt;%\n  bold(part = \"header\") %&gt;%\n  bold(i = 1, part = \"body\", j = \"Variable\") %&gt;%\n border_remove() %&gt;%\n  border_inner_h(border = fp_border(color = \"black\", width = 1)) %&gt;%\n  \n  add_header_lines(values = \"Table xx: Vaccination uptake pattern, 2015‚Äì2024.\") %&gt;%\n  add_footer_lines(values = c(\n    \"·µÉ The pattern reflects those with influenza vaccination history, influenza, or both.\"\n  ))\n\n# Display table\nfinal_table\n\nTable xx: Vaccination uptake pattern, 2015‚Äì2024.  Vaccination pattern·µÉVariableValueBoth (%)Influenza (%)No (%)Service year20158 (5.2)27 (17.6)110 (71.9)201652 (37.4)81 (58.3)36 (25.9)201741 (29.9)74 (54)34 (24.8)201850 (33.1)73 (48.3)47 (31.1)201953 (32.9)85 (52.8)46 (28.6)202053 (38.7)82 (59.9)26 (19)202127 (10.3)109 (41.4)96 (36.5)202239 (32.5)57 (47.5)16 (13.3)202357 (33.5)86 (50.6)56 (32.9)202446 (37.7)73 (59.8)23 (18.9)Age group0-1999 (15.4)214 (33.3)308 (48)20-2953 (24.1)110 (50)51 (23.2)30-3911 (16.7)28 (42.4)24 (36.4)40-4964 (34.2)108 (57.8)40 (21.4)50-5950 (34.7)85 (59)25 (17.4)60-6992 (54.1)120 (70.6)24 (14.1)70+57 (46)82 (66.1)18 (14.5)·µÉ The pattern reflects those with influenza vaccination history, influenza, or both.\n\n# .................. Clean up ..................\nrm(df_year, df_age, df_combined_long, process_variable, final_table)\n\n\n\n\nSimilar to the rowwise example, this version presents the column percentages of multiple responses.\nüßæ Key advantage: Allows side-by-side comparison of proportions within each vaccine group across multiple demographics.\nüíº Common in: Survey analysis, patient preference studies, behavioral research.\n\n# ------------ 11. Mutiple Response Tables: via appending: Columnwise -------------------------------------------\n\n# .................. Convert grouping vars to character ..................\nvacc_1524 &lt;- vacc_1524 %&gt;%\n  mutate(across(c(age_group, gender, marital_status,\n                  vacc_service_year, vacc_quarter, vacc_weekday), as.character))\n\n# .................. Table generation function (column-wise %) ..................\ncreate_tab &lt;- function(data, var, label) {\n  tab_main &lt;- data %&gt;%\n    filter(!is.na({{ var }})) %&gt;%\n    tabyl({{ var }}, vacc_group3) %&gt;%\n    mutate(Category = label, .before = 1) %&gt;%\n    rename(Label = {{ var }}) %&gt;%\n    mutate(Label = as.character(Label))\n  \n  na_count &lt;- sum(is.na(pull(data, {{ var }})))\n  \n  if (na_count &gt; 0) {\n    missing_row &lt;- tibble(\n      Category = label,\n      Label = \"Missing\",\n      `Respiratory vaccines` = sum(data$vacc_group3 == \"Respiratory vaccines\" & is.na(pull(data, {{ var }})), na.rm = TRUE),\n      `Childhood vaccines` = sum(data$vacc_group3 == \"Childhood vaccines\" & is.na(pull(data, {{ var }})), na.rm = TRUE),\n      Other = sum(data$vacc_group3 == \"Other\" & is.na(pull(data, {{ var }})), na.rm = TRUE)\n    )\n    tab_final &lt;- bind_rows(tab_main, missing_row)\n  } else {\n    tab_final &lt;- tab_main\n  }\n  \n  return(tab_final)\n}\n\n# .................. Create summary tables ..................\ntab_age            &lt;- create_tab(vacc_1524, age_group, \"Age\")\ntab_sex            &lt;- create_tab(vacc_1524, gender, \"Gender\")\ntab_marital_status &lt;- create_tab(vacc_1524, marital_status, \"Marital status\")\ntab_year           &lt;- create_tab(vacc_1524, vacc_service_year, \"Year\")\ntab_quarter        &lt;- create_tab(vacc_1524, vacc_quarter, \"Quarter\")\ntab_weekday        &lt;- create_tab(vacc_1524, vacc_weekday, \"Weekday\")\n\n# .................. Combine all tables ..................\ntab_combined &lt;- bind_rows(tab_sex, tab_age, tab_marital_status, tab_year, tab_quarter, tab_weekday)\n\n# .................. Calculate column-wise percentages within each Category group ..................\ntab_combined &lt;- tab_combined %&gt;%\n  group_by(Category) %&gt;%\n  mutate(\n    Total_Resp = sum(`Respiratory vaccines`[Label != \"Missing\"], na.rm = TRUE),\n    Total_Child = sum(`Childhood vaccines`[Label != \"Missing\"], na.rm = TRUE),\n    Total_Other = sum(Other[Label != \"Missing\"], na.rm = TRUE),\n    \n    is_missing = trimws(tolower(Label)) == \"missing\",\n    \n    Respiratory = ifelse(is_missing,\n                         comma(`Respiratory vaccines`),\n                         paste0(comma(`Respiratory vaccines`), \" (\", round(100 * `Respiratory vaccines` / Total_Resp, 1), \"%)\")),\n    \n    Childhood = ifelse(is_missing,\n                       comma(`Childhood vaccines`),\n                       paste0(comma(`Childhood vaccines`), \" (\", round(100 * `Childhood vaccines` / Total_Child, 1), \"%)\")),\n    \n    Other_grp = ifelse(is_missing,\n                       comma(Other),\n                       paste0(comma(Other), \" (\", round(100 * Other / Total_Other, 1), \"%)\"))\n  ) %&gt;%\n  ungroup() %&gt;%\n  select(Category, Label, Respiratory, Childhood, Other_grp)\n\n# .................. Show Category only once per group ..................\ntab_combined &lt;- tab_combined %&gt;%\n  group_by(Category) %&gt;%\n  mutate(Category = ifelse(row_number() == 1, Category, \"\")) %&gt;%\n  ungroup()\n\n# .................. Get total counts per vaccine group ..................\ntotals &lt;- vacc_1524 %&gt;%\n  count(vacc_group3) %&gt;%\n  deframe()\n\n# .................. Create flextable ..................\nft_vacc_summary &lt;- tab_combined %&gt;%\n  flextable() %&gt;%\n  set_header_labels(\n    Category = \"Variable type\",\n    Label = \"Values\",\n    Respiratory = \"Number (%)·µÉ\",\n    Childhood = \"Number (%)·µÉ\",\n    Other_grp = \"Number (%)·µÉ\"\n  ) %&gt;%\n  add_header_row(\n    values = c(\n      \"\", \"\",\n      paste0(\"Respiratory vaccines (N = \", format(totals[\"Respiratory vaccines\"], big.mark = \",\"), \")\"),\n      paste0(\"Childhood vaccines (N = \", format(totals[\"Childhood vaccines\"], big.mark = \",\"), \")\"),\n      paste0(\"Other (N = \", format(totals[\"Other\"], big.mark = \",\"), \")\")\n    )\n  ) %&gt;%\n  add_header_row(\n    values = c(\"Description\", \"Vaccination uptake\"),\n    colwidths = c(2, 3)\n  ) %&gt;%\n  theme_box() %&gt;%\n  set_table_properties(layout = \"autofit\", width = 1) %&gt;%\n  width(j = 1, width = 1.5) %&gt;%\n  width(j = 2, width = 2.5) %&gt;%\n  width(j = 3:5, width = 1.5) %&gt;%\n  align(align = \"justify\", part = \"all\") %&gt;%\n  border_remove() %&gt;%\n  border_inner_h(border = fp_border(color = \"black\", width = 1)) %&gt;%\n  \n  set_caption(\"Table: Vaccination uptake (column percentage) across service year, quarter, and weekday\") %&gt;%\n  footnote(i = 1, \n           value = as_paragraph(\"Vaccination proportions were calculated column-wise (i.e., within each vaccine group).\"),\n           ref_symbols = \"·µÉ\", \n           part = \"header\")\n\n# .................. Show the table ..................\nft_vacc_summary\n\nDescription·µÉVaccination uptake·µÉRespiratory vaccines (N = 955)Childhood vaccines (N = 472)Other (N = 126)Variable typeValuesNumber (%)·µÉNumber (%)·µÉNumber (%)·µÉGenderFemale511 (53.5%)233 (49.4%)54 (42.9%)Male444 (46.5%)239 (50.6%)72 (57.1%)Age0-19250 (26.2%)302 (64%)90 (71.4%)20-29150 (15.7%)70 (14.8%)0 (0%)30-3947 (4.9%)19 (4%)0 (0%)40-49142 (14.9%)45 (9.5%)0 (0%)50-59112 (11.7%)14 (3%)18 (14.3%)60-69149 (15.6%)13 (2.8%)8 (6.3%)70+105 (11%)9 (1.9%)10 (7.9%)Marital statusDivorced136 (23.7%)15 (14%)12 (33.3%)Married289 (50.3%)59 (55.1%)18 (50%)Single/widowed150 (26.1%)33 (30.8%)6 (16.7%)Missing38036590Year201578 (8.2%)56 (11.9%)19 (15.1%)201684 (8.8%)47 (10%)8 (6.3%)201775 (7.9%)52 (11%)10 (7.9%)201881 (8.5%)52 (11%)18 (14.3%)201983 (8.7%)60 (12.7%)18 (14.3%)202082 (8.6%)44 (9.3%)11 (8.7%)2021223 (23.4%)34 (7.2%)6 (4.8%)202288 (9.2%)25 (5.3%)7 (5.6%)202387 (9.1%)63 (13.3%)20 (15.9%)202474 (7.7%)39 (8.3%)9 (7.1%)Quarter1253 (26.5%)120 (25.4%)30 (23.8%)2220 (23%)117 (24.8%)39 (31%)3295 (30.9%)139 (29.4%)33 (26.2%)4187 (19.6%)96 (20.3%)24 (19%)WeekdayFriday141 (14.8%)31 (6.6%)8 (6.3%)Monday114 (11.9%)49 (10.4%)14 (11.1%)Saturday160 (16.8%)81 (17.2%)12 (9.5%)Sunday156 (16.3%)100 (21.2%)21 (16.7%)Thursday167 (17.5%)66 (14%)20 (15.9%)Tuesday108 (11.3%)43 (9.1%)14 (11.1%)Wednesday109 (11.4%)102 (21.6%)37 (29.4%)·µÉVaccination proportions were calculated column-wise (i.e., within each vaccine group).\n\n# .................. Clean up environment ..................\nrm(tab_age, tab_sex, tab_marital_status, tab_year, tab_quarter, tab_weekday,\n   tab_combined, ft_vacc_summary, totals, create_tab)\n\n\n\n\nFinally, we build an interactive table using the DT package with export options (CSV, Excel, Print).\nüñ±Ô∏è Why use this:\n\nOffers flexibility for exploratory review or end-user interaction.\nEnables printing or downloading filtered subsets.\n\nüåç Perfect for: Dashboards, websites, or when publishing to HTML via Quarto/GitHub.\n\n# ------------ 12. Interactive and Print ready: Table  -------------------------------------------\n\n\n# .................. Convert grouping vars to character ..................\nvacc_1524 &lt;- vacc_1524 %&gt;%\n  mutate(across(c(age_group, gender, marital_status,\n                  vacc_service_year, vacc_quarter, vacc_weekday), as.character))\n\n# .................. Table generation function with Missing ..................\ncreate_tab &lt;- function(data, var, label) {\n  tab_main &lt;- data %&gt;%\n    filter(!is.na({{ var }})) %&gt;%\n    tabyl({{ var }}, vacc_group3) %&gt;%\n    mutate(Category = label, .before = 1) %&gt;%\n    rename(Label = {{ var }}) %&gt;%\n    mutate(Label = as.character(Label))\n  \n  na_count &lt;- sum(is.na(pull(data, {{ var }})))\n  \n  if (na_count &gt; 0) {\n    missing_row &lt;- tibble(\n      Category = label,\n      Label = \"Missing\",\n      `Respiratory vaccines` = sum(data$vacc_group3 == \"Respiratory vaccines\" & is.na(pull(data, {{ var }})), na.rm = TRUE),\n      `Childhood vaccines` = sum(data$vacc_group3 == \"Childhood vaccines\" & is.na(pull(data, {{ var }})), na.rm = TRUE),\n      Other = sum(data$vacc_group3 == \"Other\" & is.na(pull(data, {{ var }})), na.rm = TRUE)\n    )\n    tab_final &lt;- bind_rows(tab_main, missing_row)\n  } else {\n    tab_final &lt;- tab_main\n  }\n  \n  return(tab_final)\n}\n\n# .................. Create summary tables ..................\ntab_age            &lt;- create_tab(vacc_1524, age_group, \"Age\")\ntab_sex            &lt;- create_tab(vacc_1524, gender, \"Gender\")\ntab_marital_status &lt;- create_tab(vacc_1524, marital_status, \"Marital status\")\ntab_year           &lt;- create_tab(vacc_1524, vacc_service_year, \"Year\")\ntab_quarter        &lt;- create_tab(vacc_1524, vacc_quarter, \"Quarter\")\ntab_weekday        &lt;- create_tab(vacc_1524, vacc_weekday, \"Weekday\")\n\n# .................. Combine all tables ..................\ntab_combined &lt;- bind_rows(tab_sex, tab_age, tab_marital_status, tab_year, tab_quarter, tab_weekday)\n\n# .................. Calculate row-wise percentages (skip for Missing) ..................\ntab_combined &lt;- tab_combined %&gt;%\n  rowwise() %&gt;%\n  mutate(\n    Total = sum(`Respiratory vaccines`, `Childhood vaccines`, Other, na.rm = TRUE),\n    is_missing = trimws(tolower(Label)) == \"missing\",\n    \n    Respiratory = ifelse(is_missing,\n                         comma(`Respiratory vaccines`),\n                         paste0(comma(`Respiratory vaccines`), \" (\", round(100 * `Respiratory vaccines` / Total, 1), \")\")),\n    \n    Childhood = ifelse(is_missing,\n                       comma(`Childhood vaccines`),\n                       paste0(comma(`Childhood vaccines`), \" (\", round(100 * `Childhood vaccines` / Total, 1), \")\")),\n    \n    Other_grp = ifelse(is_missing,\n                       comma(Other),\n                       paste0(comma(Other), \" (\", round(100 * Other / Total, 1), \")\"))\n  ) %&gt;%\n  ungroup() %&gt;%\n  select(Category, Label, Respiratory, Childhood, Other_grp)\n\n# .................. Show Category only once per group ..................\ntab_combined &lt;- tab_combined %&gt;%\n  group_by(Category) %&gt;%\n  mutate(Category = ifelse(row_number() == 1, Category, \"\")) %&gt;%\n  ungroup()\n\n# .................. Create interactive table with DT ..................\n\ndatatable(\n  tab_combined,\n  rownames = FALSE,\n  extensions = 'Buttons',\n  options = list(\n    dom = 'Bfrtip',\n    buttons = c('copy', 'csv', 'excel', 'pdf', 'print'),\n    pageLength = 25,\n    autoWidth = TRUE,\n    columnDefs = list(list(width = '200px', targets = c(0, 1)))\n  ),\n  caption = htmltools::tags$caption(\n    style = 'caption-side: top; font-size: 18px; font-family: \"Times New Roman\"; font-weight: bold;',\n    'Table: Vaccination uptake across service year, quarter, and weekday'\n  ),\n  class = 'stripe hover cell-border'\n)\n\n\n\n\n# .................. Clean up all new objects ..................\nrm(tab_age, tab_sex, tab_marital_status, tab_year, tab_quarter, tab_weekday,\n   tab_combined, create_tab)"
  },
  {
    "objectID": "Post_Blog/Table_automation_Ideas/index.html#table-without-title-and-footer",
    "href": "Post_Blog/Table_automation_Ideas/index.html#table-without-title-and-footer",
    "title": "Automating Publication-Ready Tables in R",
    "section": "",
    "text": "This section introduces a basic version of the automated table‚Äîminimal and clean without captions or footnotes.\n\nWhy it matters: A stripped-down table is great for quick previews or inline summaries.\nWhen to use: Internal drafts, early analysis stages, or dashboards.\nEnsure grouping variables are characters to avoid formatting issues.\nBuild one reusable function (create_tab) to apply across multiple variables.\nBind all summary tables into a combined format.\nAdd row-wise percentages directly to the table.\n\n\n# ------------1. Table without title and footer -------------------------------------------+\n#.......................Ensure grouping variables are characters............................\nvacc_1524 &lt;- vacc_1524 %&gt;%\n  mutate(across(c(vacc_service_year, vacc_quarter, vacc_weekday), as.character))\n\n# ---------------- Table generation function ....................\ncreate_tab &lt;- function(data, var, label) {\n  data %&gt;%\n    filter(!is.na({{ var }})) %&gt;%\n    tabyl({{ var }}, vacc_group3) %&gt;%\n    mutate(Category = label, .before = 1) %&gt;%\n    rename(Label = {{ var }}) %&gt;%\n    mutate(Label = as.character(Label))\n}\n\n# .................... Create summary tables ....................\ntab_age &lt;- create_tab(vacc_1524, age_group, \"Age\")\ntab_sex &lt;- create_tab(vacc_1524, gender, \"Gender\")\ntab_marital_status &lt;- create_tab(vacc_1524, marital_status, \"Marital status\")\ntab_year    &lt;- create_tab(vacc_1524, vacc_service_year, \"Year\")\ntab_quarter &lt;- create_tab(vacc_1524, vacc_quarter, \"Quarter\")\ntab_weekday &lt;- create_tab(vacc_1524, vacc_weekday, \"Weekday\")\n\n# ......................Combine all tabs ....................\ntab_combined &lt;- bind_rows(tab_sex, tab_age, tab_marital_status, tab_year, tab_quarter, tab_weekday)\n\n# ....................... Create row % and format as text ....................\ntab_combined &lt;- tab_combined %&gt;%\n  rowwise() %&gt;%\n  mutate(\n    Total = sum(`Respiratory vaccines`, `Childhood vaccines`, Other, na.rm = TRUE),\n    Respiratory = paste0(comma(`Respiratory vaccines`), \" (\", round(100 * `Respiratory vaccines` / Total, 1), \")\"),\n    Childhood   = paste0(comma(`Childhood vaccines`), \" (\", round(100 * `Childhood vaccines` / Total, 1), \")\"),\n    Other_grp   = paste0(comma(Other), \" (\", round(100 * Other / Total, 1), \")\")\n  ) %&gt;%\n  ungroup()\n\n# ............................. Remove repeated variable names ....................\ntab_combined &lt;- tab_combined %&gt;%\n  group_by(Category) %&gt;%\n  mutate(Category = ifelse(row_number() == 1, Category, \"\")) %&gt;%\n  ungroup()\n\n# ........................... Get total counts per vaccine group ....................\ntotals &lt;- vacc_1524 %&gt;%\n  count(vacc_group3) %&gt;%\n  deframe()\n\n# .................... Create flextable ....................\nft_vacc_summary &lt;- tab_combined %&gt;%\n  select(Category, Label, Respiratory, Childhood, Other_grp) %&gt;%\n  flextable() %&gt;%\n  set_header_labels(\n    Category = \"Variable type\",\n    Label = \"Values\",\n    Respiratory = \"Number (%)·µÉ\",\n    Childhood = \"Number (%)·µÉ\",\n    Other_grp = \"Number (%)·µÉ\"\n  ) %&gt;%\n  add_header_row( # Second row\n    values = c(\n      \"\", \"\",\n      paste0(\"Respiratory vaccines (N = \", format(totals[\"Respiratory vaccines\"], big.mark = \",\"), \")\"),\n      paste0(\"Childhood vaccines (N = \", format(totals[\"Childhood vaccines\"], big.mark = \",\"), \")\"),\n      paste0(\"Other (N = \", format(totals[\"Other\"], big.mark = \",\"), \")\")\n    )\n  ) %&gt;%\n  add_header_row( # First row (merged header)\n    values = c(\"Description\", \"Vaccination uptake\"),\n    colwidths = c(2, 3)\n  ) %&gt;%\n  theme_box() %&gt;%\n  set_table_properties(layout = \"autofit\", width = 1) %&gt;%\n  width(j = 1, width = 1.5) %&gt;%\n  width(j = 2, width = 2.5) %&gt;%\n  width(j = 3:4, width = 1.5) %&gt;%\n  align(align = \"justify\", part = \"all\") %&gt;%\n  border_remove() %&gt;%\n  border(part = \"header\", i = 1, border.top = fp_border(color = \"black\", width = 1)) %&gt;%\n  border(part = \"header\", i = 3, border.bottom = fp_border(color = \"black\", width = 1)) %&gt;%\n  border_inner_h(part = \"header\", border = fp_border(color = \"black\", width = 0.8)) %&gt;%\n  border_inner_h(part = \"body\", border = fp_border(color = \"black\", width = 0.8)) %&gt;%\n  border(part = \"body\", i = nrow(tab_combined), border.bottom = fp_border(color = \"black\", width = 1)) \n  \n# --- Display the table ---\nft_vacc_summary\n\nDescriptionVaccination uptakeRespiratory vaccines (N = 955)Childhood vaccines (N = 472)Other (N = 126)Variable typeValuesNumber (%)·µÉNumber (%)·µÉNumber (%)·µÉGenderFemale511 (64)233 (29.2)54 (6.8)Male444 (58.8)239 (31.7)72 (9.5)Age0-19250 (38.9)302 (47)90 (14)20-29150 (68.2)70 (31.8)0 (0)30-3947 (71.2)19 (28.8)0 (0)40-49142 (75.9)45 (24.1)0 (0)50-59112 (77.8)14 (9.7)18 (12.5)60-69149 (87.6)13 (7.6)8 (4.7)70+105 (84.7)9 (7.3)10 (8.1)Marital statusDivorced136 (83.4)15 (9.2)12 (7.4)Married289 (79)59 (16.1)18 (4.9)Single/widowed150 (79.4)33 (17.5)6 (3.2)Year201578 (51)56 (36.6)19 (12.4)201684 (60.4)47 (33.8)8 (5.8)201775 (54.7)52 (38)10 (7.3)201881 (53.6)52 (34.4)18 (11.9)201983 (51.6)60 (37.3)18 (11.2)202082 (59.9)44 (32.1)11 (8)2021223 (84.8)34 (12.9)6 (2.3)202288 (73.3)25 (20.8)7 (5.8)202387 (51.2)63 (37.1)20 (11.8)202474 (60.7)39 (32)9 (7.4)Quarter1253 (62.8)120 (29.8)30 (7.4)2220 (58.5)117 (31.1)39 (10.4)3295 (63.2)139 (29.8)33 (7.1)4187 (60.9)96 (31.3)24 (7.8)WeekdayFriday141 (78.3)31 (17.2)8 (4.4)Monday114 (64.4)49 (27.7)14 (7.9)Saturday160 (63.2)81 (32)12 (4.7)Sunday156 (56.3)100 (36.1)21 (7.6)Thursday167 (66)66 (26.1)20 (7.9)Tuesday108 (65.5)43 (26.1)14 (8.5)Wednesday109 (44)102 (41.1)37 (14.9)\n\n# --- Clean up environment ---\nrm(tab_year, tab_quarter, tab_weekday, tab_combined, totals, create_tab, ft_vacc_summary)"
  },
  {
    "objectID": "Post_Blog/Table_automation_Ideas/index.html#table-with-title-and-footer",
    "href": "Post_Blog/Table_automation_Ideas/index.html#table-with-title-and-footer",
    "title": "Automating Publication-Ready Tables in R",
    "section": "",
    "text": "This extends the previous section by including a clear table caption and an explanatory footnote.\nüßæ Why this is important:\n\nCaptions add context‚Äîespecially in reports.\nFootnotes help clarify how metrics are calculated (e.g., row percentages).\n\nüìò Best used when: Preparing for publication, stakeholder presentations, or final reports.\n\n# ------------2. Table with Title and Footer -------------------------------------------\n\n#.......................Ensure grouping variables are characters............................\nvacc_1524 &lt;- vacc_1524 %&gt;%\n  mutate(across(c(vacc_service_year, vacc_quarter, vacc_weekday), as.character))\n\n# ---------------- Table generation function ....................\ncreate_tab &lt;- function(data, var, label) {\n  data %&gt;%\n    filter(!is.na({{ var }})) %&gt;%\n    tabyl({{ var }}, vacc_group3) %&gt;%\n    mutate(Category = label, .before = 1) %&gt;%\n    rename(Label = {{ var }}) %&gt;%\n    mutate(Label = as.character(Label))\n}\n\n# .................... Create summary tables ....................\ntab_age &lt;- create_tab(vacc_1524, age_group, \"Age\")\ntab_sex &lt;- create_tab(vacc_1524, gender, \"Gender\")\ntab_marital_status &lt;- create_tab(vacc_1524, marital_status, \"Marital status\")\ntab_year    &lt;- create_tab(vacc_1524, vacc_service_year, \"Year\")\ntab_quarter &lt;- create_tab(vacc_1524, vacc_quarter, \"Quarter\")\ntab_weekday &lt;- create_tab(vacc_1524, vacc_weekday, \"Weekday\")\n\n# ......................Combine all tabs ....................\ntab_combined &lt;- bind_rows(tab_sex, tab_age, tab_marital_status, tab_year, tab_quarter, tab_weekday)\n\n# ....................... Create row % and format as text ....................\ntab_combined &lt;- tab_combined %&gt;%\n  rowwise() %&gt;%\n  mutate(\n    Total = sum(`Respiratory vaccines`, `Childhood vaccines`, Other, na.rm = TRUE),\n    Respiratory = paste0(comma(`Respiratory vaccines`), \" (\", round(100 * `Respiratory vaccines` / Total, 1), \")\"),\n    Childhood   = paste0(comma(`Childhood vaccines`), \" (\", round(100 * `Childhood vaccines` / Total, 1), \")\"),\n    Other_grp   = paste0(comma(Other), \" (\", round(100 * Other / Total, 1), \")\")\n  ) %&gt;%\n  ungroup()\n\n# ............................. Remove repeated variable names ....................\ntab_combined &lt;- tab_combined %&gt;%\n  group_by(Category) %&gt;%\n  mutate(Category = ifelse(row_number() == 1, Category, \"\")) %&gt;%\n  ungroup()\n\n# ........................... Get total counts per vaccine group ....................\ntotals &lt;- vacc_1524 %&gt;%\n  count(vacc_group3) %&gt;%\n  deframe()\n\n# .................... Create flextable ....................\nft_vacc_summary &lt;- tab_combined %&gt;%\n  select(Category, Label, Respiratory, Childhood, Other_grp) %&gt;%\n  flextable() %&gt;%\n  set_header_labels(\n    Category = \"Variable type\",\n    Label = \"Values\",\n    Respiratory = \"Number (%)·µÉ\",\n    Childhood = \"Number (%)·µÉ\",\n    Other_grp = \"Number (%)·µÉ\"\n  ) %&gt;%\n  add_header_row( # Second row\n    values = c(\n      \"\", \"\",\n      paste0(\"Respiratory vaccines (N = \", format(totals[\"Respiratory vaccines\"], big.mark = \",\"), \")\"),\n      paste0(\"Childhood vaccines (N = \", format(totals[\"Childhood vaccines\"], big.mark = \",\"), \")\"),\n      paste0(\"Other (N = \", format(totals[\"Other\"], big.mark = \",\"), \")\")\n    )\n  ) %&gt;%\n  add_header_row( # First row (merged header)\n    values = c(\"Description\", \"Vaccination uptake\"),\n    colwidths = c(2, 3)\n  ) %&gt;%\n  theme_box() %&gt;%\n  set_table_properties(layout = \"autofit\", width = 1) %&gt;%\n  width(j = 1, width = 1.5) %&gt;%\n  width(j = 2, width = 2.5) %&gt;%\n  width(j = 3:4, width = 1.5) %&gt;%\n  align(align = \"justify\", part = \"all\") %&gt;%\n  \n  border_remove() %&gt;%\n  border(part = \"header\", i = 1, border.top = fp_border(color = \"black\", width = 1)) %&gt;%\n  border(part = \"header\", i = 3, border.bottom = fp_border(color = \"black\", width = 1)) %&gt;%\n  border_inner_h(part = \"header\", border = fp_border(color = \"black\", width = 0.8)) %&gt;%\n  border_inner_h(part = \"body\", border = fp_border(color = \"black\", width = 0.8)) %&gt;%\n  border(part = \"body\", i = nrow(tab_combined), border.bottom = fp_border(color = \"black\", width = 1)) %&gt;%\n  \n  set_caption(\"Table: Vaccination uptake across service year, quarter, and weekday\") %&gt;%\n  footnote(i = 1, \n           value = as_paragraph(\" Vaccination proportions were calculated row-wise (i.e., by row).\"),\n           ref_symbols = \"·µÉ\", part = \"header\") \n# %&gt;%\n#   border_inner_h(border = fp_border(color = \"black\", width = 1))  %&gt;%\n#   add_header_lines(values = \"Table xx: Vaccination uptake across service year, quarter, and weekday.\") %&gt;%\n#   add_footer_lines(values = c(\n#     \"·µÉ Vaccination proportions were calculated per row (row percentage).\",\n#     paste0(\"·µá The vaccine provider type did not include unvaccinated (N = \", format(no_total, big.mark = \",\"), \").\"),\n#     \"·∂ú Vaccination proportions were calculated row-wise (i.e., by row).\",\n#     \"GP = General practitioner, PHU = Public Health Unit\"\n#   ))\n\n# Display the table\nft_vacc_summary\n\nDescription·µÉVaccination uptake·µÉRespiratory vaccines (N = 955)Childhood vaccines (N = 472)Other (N = 126)Variable typeValuesNumber (%)·µÉNumber (%)·µÉNumber (%)·µÉGenderFemale511 (64)233 (29.2)54 (6.8)Male444 (58.8)239 (31.7)72 (9.5)Age0-19250 (38.9)302 (47)90 (14)20-29150 (68.2)70 (31.8)0 (0)30-3947 (71.2)19 (28.8)0 (0)40-49142 (75.9)45 (24.1)0 (0)50-59112 (77.8)14 (9.7)18 (12.5)60-69149 (87.6)13 (7.6)8 (4.7)70+105 (84.7)9 (7.3)10 (8.1)Marital statusDivorced136 (83.4)15 (9.2)12 (7.4)Married289 (79)59 (16.1)18 (4.9)Single/widowed150 (79.4)33 (17.5)6 (3.2)Year201578 (51)56 (36.6)19 (12.4)201684 (60.4)47 (33.8)8 (5.8)201775 (54.7)52 (38)10 (7.3)201881 (53.6)52 (34.4)18 (11.9)201983 (51.6)60 (37.3)18 (11.2)202082 (59.9)44 (32.1)11 (8)2021223 (84.8)34 (12.9)6 (2.3)202288 (73.3)25 (20.8)7 (5.8)202387 (51.2)63 (37.1)20 (11.8)202474 (60.7)39 (32)9 (7.4)Quarter1253 (62.8)120 (29.8)30 (7.4)2220 (58.5)117 (31.1)39 (10.4)3295 (63.2)139 (29.8)33 (7.1)4187 (60.9)96 (31.3)24 (7.8)WeekdayFriday141 (78.3)31 (17.2)8 (4.4)Monday114 (64.4)49 (27.7)14 (7.9)Saturday160 (63.2)81 (32)12 (4.7)Sunday156 (56.3)100 (36.1)21 (7.6)Thursday167 (66)66 (26.1)20 (7.9)Tuesday108 (65.5)43 (26.1)14 (8.5)Wednesday109 (44)102 (41.1)37 (14.9)·µÉ Vaccination proportions were calculated row-wise (i.e., by row).\n\n# .................... Clean up environment ....................\nrm(tab_year, tab_quarter, tab_weekday, tab_combined, ft_vacc_summary, totals, create_tab)"
  },
  {
    "objectID": "Post_Blog/Table_automation_Ideas/index.html#missing-values-with-n",
    "href": "Post_Blog/Table_automation_Ideas/index.html#missing-values-with-n",
    "title": "Automating Publication-Ready Tables in R",
    "section": "",
    "text": "In this version, we include ‚ÄúMissing‚Äù as a separate category and provide both counts and percentages.\nüß† Why this matters: Ignoring missing values can skew analysis. This format transparently highlights data completeness.\nüëç Recommended for: Health datasets, surveys, or administrative data where data quality assessment is key.\n\n# ------------3. Missing values with n(%)-------------------------------------------\n\n\n# .................. Convert grouping vars to character ..................\nvacc_1524 &lt;- vacc_1524 %&gt;%\n  mutate(across(c(age_group, gender, marital_status,\n                  vacc_service_year, vacc_quarter, vacc_weekday), as.character))\n\n# .................. Table generation function with Missing ..................\ncreate_tab &lt;- function(data, var, label) {\n  tab_main &lt;- data %&gt;%\n    filter(!is.na({{ var }})) %&gt;%\n    tabyl({{ var }}, vacc_group3) %&gt;%\n    mutate(Category = label, .before = 1) %&gt;%\n    rename(Label = {{ var }}) %&gt;%\n    mutate(Label = as.character(Label))\n  \n  na_count &lt;- sum(is.na(pull(data, {{ var }})))\n  \n  if (na_count &gt; 0) {\n    missing_row &lt;- tibble(\n      Category = label,\n      Label = \"Missing\",\n      `Respiratory vaccines` = sum(data$vacc_group3 == \"Respiratory vaccines\" & is.na(pull(data, {{ var }})), na.rm = TRUE),\n      `Childhood vaccines` = sum(data$vacc_group3 == \"Childhood vaccines\" & is.na(pull(data, {{ var }})), na.rm = TRUE),\n      Other = sum(data$vacc_group3 == \"Other\" & is.na(pull(data, {{ var }})), na.rm = TRUE)\n    )\n    tab_final &lt;- bind_rows(tab_main, missing_row)\n  } else {\n    tab_final &lt;- tab_main\n  }\n  \n  return(tab_final)\n}\n\n# .................. Create summary tables ..................\ntab_age            &lt;- create_tab(vacc_1524, age_group, \"Age\")\ntab_sex            &lt;- create_tab(vacc_1524, gender, \"Gender\")\ntab_marital_status &lt;- create_tab(vacc_1524, marital_status, \"Marital status\")\ntab_year           &lt;- create_tab(vacc_1524, vacc_service_year, \"Year\")\ntab_quarter        &lt;- create_tab(vacc_1524, vacc_quarter, \"Quarter\")\ntab_weekday        &lt;- create_tab(vacc_1524, vacc_weekday, \"Weekday\")\n\n# .................. Combine all tables ..................\ntab_combined &lt;- bind_rows(tab_sex, tab_age, tab_marital_status, tab_year, tab_quarter, tab_weekday)\n\n# .................. Calculate row-wise percentages ..................\ntab_combined &lt;- tab_combined %&gt;%\n  rowwise() %&gt;%\n  mutate(\n    Total = sum(`Respiratory vaccines`, `Childhood vaccines`, Other, na.rm = TRUE),\n    Respiratory = paste0(comma(`Respiratory vaccines`), \" (\", round(100 * `Respiratory vaccines` / Total, 1), \")\"),\n    Childhood   = paste0(comma(`Childhood vaccines`), \" (\", round(100 * `Childhood vaccines` / Total, 1), \")\"),\n    Other_grp   = paste0(comma(Other), \" (\", round(100 * Other / Total, 1), \")\")\n  ) %&gt;%\n  ungroup()\n\n\n# .................. Show Category only once per group ..................\ntab_combined &lt;- tab_combined %&gt;%\n  group_by(Category) %&gt;%\n  mutate(Category = ifelse(row_number() == 1, Category, \"\")) %&gt;%\n  ungroup()\n\n# .................. Get total counts per vaccine group ..................\ntotals &lt;- vacc_1524 %&gt;%\n  count(vacc_group3) %&gt;%\n  deframe()\n\n# .................. Create flextable ..................\nft_vacc_summary &lt;- tab_combined %&gt;%\n  select(Category, Label, Respiratory, Childhood, Other_grp) %&gt;%\n  flextable() %&gt;%\n  set_header_labels(\n    Category = \"Variable type\",\n    Label = \"Values\",\n    Respiratory = \"Number (%)·µÉ\",\n    Childhood = \"Number (%)·µÉ\",\n    Other_grp = \"Number (%)·µÉ\"\n  ) %&gt;%\n  add_header_row(\n    values = c(\n      \"\", \"\",\n      paste0(\"Respiratory vaccines (N = \", format(totals[\"Respiratory vaccines\"], big.mark = \",\"), \")\"),\n      paste0(\"Childhood vaccines (N = \", format(totals[\"Childhood vaccines\"], big.mark = \",\"), \")\"),\n      paste0(\"Other (N = \", format(totals[\"Other\"], big.mark = \",\"), \")\")\n    )\n  ) %&gt;%\n  add_header_row(\n    values = c(\"Description\", \"Vaccination uptake\"),\n    colwidths = c(2, 3)\n  ) %&gt;%\n  theme_box() %&gt;%\n  set_table_properties(layout = \"autofit\", width = 1) %&gt;%\n  width(j = 1, width = 1.5) %&gt;%\n  width(j = 2, width = 2.5) %&gt;%\n  width(j = 3:5, width = 1.5) %&gt;%\n  align(align = \"justify\", part = \"all\") %&gt;%\n  border_remove() %&gt;%\n  border(part = \"header\", i = 1, border.top = fp_border(color = \"black\", width = 1)) %&gt;%\n  border(part = \"header\", i = 3, border.bottom = fp_border(color = \"black\", width = 1)) %&gt;%\n  border_inner_h(part = \"header\", border = fp_border(color = \"black\", width = 0.8)) %&gt;%\n  border_inner_h(part = \"body\", border = fp_border(color = \"black\", width = 0.8)) %&gt;%\n  border(part = \"body\", i = nrow(tab_combined), border.bottom = fp_border(color = \"black\", width = 1)) %&gt;%\n  \n  set_caption(\"Table: Vaccination uptake across service year, quarter, and weekday\") %&gt;%\n  footnote(i = 1, \n           value = as_paragraph(\"Vaccination proportions were calculated row-wise (i.e., by row).\"),\n           ref_symbols = \"·µÉ\", \n           part = \"header\")\n# .................. Show the table ..................\nft_vacc_summary\n\nDescription·µÉVaccination uptake·µÉRespiratory vaccines (N = 955)Childhood vaccines (N = 472)Other (N = 126)Variable typeValuesNumber (%)·µÉNumber (%)·µÉNumber (%)·µÉGenderFemale511 (64)233 (29.2)54 (6.8)Male444 (58.8)239 (31.7)72 (9.5)Age0-19250 (38.9)302 (47)90 (14)20-29150 (68.2)70 (31.8)0 (0)30-3947 (71.2)19 (28.8)0 (0)40-49142 (75.9)45 (24.1)0 (0)50-59112 (77.8)14 (9.7)18 (12.5)60-69149 (87.6)13 (7.6)8 (4.7)70+105 (84.7)9 (7.3)10 (8.1)Marital statusDivorced136 (83.4)15 (9.2)12 (7.4)Married289 (79)59 (16.1)18 (4.9)Single/widowed150 (79.4)33 (17.5)6 (3.2)Missing380 (45.5)365 (43.7)90 (10.8)Year201578 (51)56 (36.6)19 (12.4)201684 (60.4)47 (33.8)8 (5.8)201775 (54.7)52 (38)10 (7.3)201881 (53.6)52 (34.4)18 (11.9)201983 (51.6)60 (37.3)18 (11.2)202082 (59.9)44 (32.1)11 (8)2021223 (84.8)34 (12.9)6 (2.3)202288 (73.3)25 (20.8)7 (5.8)202387 (51.2)63 (37.1)20 (11.8)202474 (60.7)39 (32)9 (7.4)Quarter1253 (62.8)120 (29.8)30 (7.4)2220 (58.5)117 (31.1)39 (10.4)3295 (63.2)139 (29.8)33 (7.1)4187 (60.9)96 (31.3)24 (7.8)WeekdayFriday141 (78.3)31 (17.2)8 (4.4)Monday114 (64.4)49 (27.7)14 (7.9)Saturday160 (63.2)81 (32)12 (4.7)Sunday156 (56.3)100 (36.1)21 (7.6)Thursday167 (66)66 (26.1)20 (7.9)Tuesday108 (65.5)43 (26.1)14 (8.5)Wednesday109 (44)102 (41.1)37 (14.9)·µÉVaccination proportions were calculated row-wise (i.e., by row).\n\n# .................. Clean up ..................\nrm(tab_age, tab_sex, tab_marital_status, tab_year, tab_quarter, tab_weekday, \n   tab_combined, ft_vacc_summary, totals, create_tab)"
  },
  {
    "objectID": "Post_Blog/Table_automation_Ideas/index.html#missing-values-with-only-counts",
    "href": "Post_Blog/Table_automation_Ideas/index.html#missing-values-with-only-counts",
    "title": "Automating Publication-Ready Tables in R",
    "section": "",
    "text": "This variation includes missing data rows but only shows raw counts, not percentages.\n\n‚öñÔ∏è Why use this: It prevents misleading interpretations‚Äîespecially when the denominator for percentage is unclear or inconsistent.\nUse this when you want to acknowledge missing data but avoid implying proportional meaning.\n\n\n# ------------4. Missing values with only counts-------------------------------------------\n\n# .................. Convert grouping vars to character ..................\nvacc_1524 &lt;- vacc_1524 %&gt;%\n  mutate(across(c(age_group, gender, marital_status,\n                  vacc_service_year, vacc_quarter, vacc_weekday), as.character))\n\n# .................. Table generation function with Missing ..................\ncreate_tab &lt;- function(data, var, label) {\n  tab_main &lt;- data %&gt;%\n    filter(!is.na({{ var }})) %&gt;%\n    tabyl({{ var }}, vacc_group3) %&gt;%\n    mutate(Category = label, .before = 1) %&gt;%\n    rename(Label = {{ var }}) %&gt;%\n    mutate(Label = as.character(Label))\n  \n  na_count &lt;- sum(is.na(pull(data, {{ var }})))\n  \n  if (na_count &gt; 0) {\n    missing_row &lt;- tibble(\n      Category = label,\n      Label = \"Missing\",\n      `Respiratory vaccines` = sum(data$vacc_group3 == \"Respiratory vaccines\" & is.na(pull(data, {{ var }})), na.rm = TRUE),\n      `Childhood vaccines` = sum(data$vacc_group3 == \"Childhood vaccines\" & is.na(pull(data, {{ var }})), na.rm = TRUE),\n      Other = sum(data$vacc_group3 == \"Other\" & is.na(pull(data, {{ var }})), na.rm = TRUE)\n    )\n    tab_final &lt;- bind_rows(tab_main, missing_row)\n  } else {\n    tab_final &lt;- tab_main\n  }\n  \n  return(tab_final)\n}\n\n# .................. Create summary tables ..................\ntab_age            &lt;- create_tab(vacc_1524, age_group, \"Age\")\ntab_sex            &lt;- create_tab(vacc_1524, gender, \"Gender\")\ntab_marital_status &lt;- create_tab(vacc_1524, marital_status, \"Marital status\")\ntab_year           &lt;- create_tab(vacc_1524, vacc_service_year, \"Year\")\ntab_quarter        &lt;- create_tab(vacc_1524, vacc_quarter, \"Quarter\")\ntab_weekday        &lt;- create_tab(vacc_1524, vacc_weekday, \"Weekday\")\n\n# .................. Combine all tables ..................\ntab_combined &lt;- bind_rows(tab_sex, tab_age, tab_marital_status, tab_year, tab_quarter, tab_weekday)\n\n# .................. Calculate row-wise percentages (skip for Missing) ..................\ntab_combined &lt;- tab_combined %&gt;%\n  rowwise() %&gt;%\n  mutate(\n    Total = sum(`Respiratory vaccines`, `Childhood vaccines`, Other, na.rm = TRUE),\n    is_missing = trimws(tolower(Label)) == \"missing\",\n    \n    Respiratory = ifelse(is_missing,\n                         comma(`Respiratory vaccines`),\n                         paste0(comma(`Respiratory vaccines`), \" (\", round(100 * `Respiratory vaccines` / Total, 1), \")\")),\n    \n    Childhood = ifelse(is_missing,\n                       comma(`Childhood vaccines`),\n                       paste0(comma(`Childhood vaccines`), \" (\", round(100 * `Childhood vaccines` / Total, 1), \")\")),\n    \n    Other_grp = ifelse(is_missing,\n                       comma(Other),\n                       paste0(comma(Other), \" (\", round(100 * Other / Total, 1), \")\"))\n  ) %&gt;%\n  ungroup() %&gt;%\n  select(Category, Label, Respiratory, Childhood, Other_grp)\n\n# .................. Show Category only once per group ..................\ntab_combined &lt;- tab_combined %&gt;%\n  group_by(Category) %&gt;%\n  mutate(Category = ifelse(row_number() == 1, Category, \"\")) %&gt;%\n  ungroup()\n\n# .................. Get total counts per vaccine group ..................\ntotals &lt;- vacc_1524 %&gt;%\n  count(vacc_group3) %&gt;%\n  deframe()\n\n# .................. Create flextable ..................\nft_vacc_summary &lt;- tab_combined %&gt;%\n  flextable() %&gt;%\n  set_header_labels(\n    Category = \"Variable type\",\n    Label = \"Values\",\n    Respiratory = \"Number (%)·µÉ\",\n    Childhood = \"Number (%)·µÉ\",\n    Other_grp = \"Number (%)·µÉ\"\n  ) %&gt;%\n  add_header_row(\n    values = c(\n      \"\", \"\",\n      paste0(\"Respiratory vaccines (N = \", format(totals[\"Respiratory vaccines\"], big.mark = \",\"), \")\"),\n      paste0(\"Childhood vaccines (N = \", format(totals[\"Childhood vaccines\"], big.mark = \",\"), \")\"),\n      paste0(\"Other (N = \", format(totals[\"Other\"], big.mark = \",\"), \")\")\n    )\n  ) %&gt;%\n  add_header_row(\n    values = c(\"Description\", \"Vaccination uptake\"),\n    colwidths = c(2, 3)\n  ) %&gt;%\n  theme_box() %&gt;%\n  set_table_properties(layout = \"autofit\", width = 1) %&gt;%\n  width(j = 1, width = 1.5) %&gt;%\n  width(j = 2, width = 2.5) %&gt;%\n  width(j = 3:5, width = 1.5) %&gt;%\n  align(align = \"justify\", part = \"all\") %&gt;%\n  border_remove() %&gt;%\n  border(part = \"header\", i = 1, border.top = fp_border(color = \"black\", width = 1)) %&gt;%\n  border(part = \"header\", i = 3, border.bottom = fp_border(color = \"black\", width = 1)) %&gt;%\n  border_inner_h(part = \"header\", border = fp_border(color = \"black\", width = 0.8)) %&gt;%\n  border_inner_h(part = \"body\", border = fp_border(color = \"black\", width = 0.8)) %&gt;%\n  border(part = \"body\", i = nrow(tab_combined), border.bottom = fp_border(color = \"black\", width = 1)) %&gt;%\n  \n  set_caption(\"Table: Vaccination uptake across service year, quarter, and weekday\") %&gt;%\n  footnote(i = 1, \n           value = as_paragraph(\"Vaccination proportions were calculated row-wise (i.e., by row).\"),\n           ref_symbols = \"·µÉ\", \n           part = \"header\")\n\n# .................. Show the table ..................\nft_vacc_summary\n\nDescription·µÉVaccination uptake·µÉRespiratory vaccines (N = 955)Childhood vaccines (N = 472)Other (N = 126)Variable typeValuesNumber (%)·µÉNumber (%)·µÉNumber (%)·µÉGenderFemale511 (64)233 (29.2)54 (6.8)Male444 (58.8)239 (31.7)72 (9.5)Age0-19250 (38.9)302 (47)90 (14)20-29150 (68.2)70 (31.8)0 (0)30-3947 (71.2)19 (28.8)0 (0)40-49142 (75.9)45 (24.1)0 (0)50-59112 (77.8)14 (9.7)18 (12.5)60-69149 (87.6)13 (7.6)8 (4.7)70+105 (84.7)9 (7.3)10 (8.1)Marital statusDivorced136 (83.4)15 (9.2)12 (7.4)Married289 (79)59 (16.1)18 (4.9)Single/widowed150 (79.4)33 (17.5)6 (3.2)Missing38036590Year201578 (51)56 (36.6)19 (12.4)201684 (60.4)47 (33.8)8 (5.8)201775 (54.7)52 (38)10 (7.3)201881 (53.6)52 (34.4)18 (11.9)201983 (51.6)60 (37.3)18 (11.2)202082 (59.9)44 (32.1)11 (8)2021223 (84.8)34 (12.9)6 (2.3)202288 (73.3)25 (20.8)7 (5.8)202387 (51.2)63 (37.1)20 (11.8)202474 (60.7)39 (32)9 (7.4)Quarter1253 (62.8)120 (29.8)30 (7.4)2220 (58.5)117 (31.1)39 (10.4)3295 (63.2)139 (29.8)33 (7.1)4187 (60.9)96 (31.3)24 (7.8)WeekdayFriday141 (78.3)31 (17.2)8 (4.4)Monday114 (64.4)49 (27.7)14 (7.9)Saturday160 (63.2)81 (32)12 (4.7)Sunday156 (56.3)100 (36.1)21 (7.6)Thursday167 (66)66 (26.1)20 (7.9)Tuesday108 (65.5)43 (26.1)14 (8.5)Wednesday109 (44)102 (41.1)37 (14.9)·µÉVaccination proportions were calculated row-wise (i.e., by row).\n\n# .................. Clean up ..................\nrm(tab_age, tab_sex, tab_marital_status, tab_year, tab_quarter, tab_weekday, \n   tab_combined, ft_vacc_summary, totals, create_tab)"
  },
  {
    "objectID": "Post_Blog/Table_automation_Ideas/index.html#remove-all-lines",
    "href": "Post_Blog/Table_automation_Ideas/index.html#remove-all-lines",
    "title": "Automating Publication-Ready Tables in R",
    "section": "",
    "text": "This version removes all border lines for a minimalist, text-friendly table.\n‚ú® Why this helps: It improves visual integration in Word documents or printed reports where borders may clutter formatting.\nüîç Ideal for: Inline reporting, Word exports, or journal submissions requiring custom styling.\n\n# ------------5. Lines: remove all lines -------------------------------------------\n\n\n# .................. Convert grouping vars to character ..................\nvacc_1524 &lt;- vacc_1524 %&gt;%\n  mutate(across(c(age_group, gender, marital_status,\n                  vacc_service_year, vacc_quarter, vacc_weekday), as.character))\n\n# .................. Table generation function with Missing ..................\ncreate_tab &lt;- function(data, var, label) {\n  tab_main &lt;- data %&gt;%\n    filter(!is.na({{ var }})) %&gt;%\n    tabyl({{ var }}, vacc_group3) %&gt;%\n    mutate(Category = label, .before = 1) %&gt;%\n    rename(Label = {{ var }}) %&gt;%\n    mutate(Label = as.character(Label))\n  \n  na_count &lt;- sum(is.na(pull(data, {{ var }})))\n  \n  if (na_count &gt; 0) {\n    missing_row &lt;- tibble(\n      Category = label,\n      Label = \"Missing\",\n      `Respiratory vaccines` = sum(data$vacc_group3 == \"Respiratory vaccines\" & is.na(pull(data, {{ var }})), na.rm = TRUE),\n      `Childhood vaccines` = sum(data$vacc_group3 == \"Childhood vaccines\" & is.na(pull(data, {{ var }})), na.rm = TRUE),\n      Other = sum(data$vacc_group3 == \"Other\" & is.na(pull(data, {{ var }})), na.rm = TRUE)\n    )\n    tab_final &lt;- bind_rows(tab_main, missing_row)\n  } else {\n    tab_final &lt;- tab_main\n  }\n  \n  return(tab_final)\n}\n\n# .................. Create summary tables ..................\ntab_age            &lt;- create_tab(vacc_1524, age_group, \"Age\")\ntab_sex            &lt;- create_tab(vacc_1524, gender, \"Gender\")\ntab_marital_status &lt;- create_tab(vacc_1524, marital_status, \"Marital status\")\ntab_year           &lt;- create_tab(vacc_1524, vacc_service_year, \"Year\")\ntab_quarter        &lt;- create_tab(vacc_1524, vacc_quarter, \"Quarter\")\ntab_weekday        &lt;- create_tab(vacc_1524, vacc_weekday, \"Weekday\")\n\n# .................. Combine all tables ..................\ntab_combined &lt;- bind_rows(tab_sex, tab_age, tab_marital_status, tab_year, tab_quarter, tab_weekday)\n\n# .................. Calculate row-wise percentages (skip for Missing) ..................\ntab_combined &lt;- tab_combined %&gt;%\n  rowwise() %&gt;%\n  mutate(\n    Total = sum(`Respiratory vaccines`, `Childhood vaccines`, Other, na.rm = TRUE),\n    is_missing = trimws(tolower(Label)) == \"missing\",\n    \n    Respiratory = ifelse(is_missing,\n                         comma(`Respiratory vaccines`),\n                         paste0(comma(`Respiratory vaccines`), \" (\", round(100 * `Respiratory vaccines` / Total, 1), \")\")),\n    \n    Childhood = ifelse(is_missing,\n                       comma(`Childhood vaccines`),\n                       paste0(comma(`Childhood vaccines`), \" (\", round(100 * `Childhood vaccines` / Total, 1), \")\")),\n    \n    Other_grp = ifelse(is_missing,\n                       comma(Other),\n                       paste0(comma(Other), \" (\", round(100 * Other / Total, 1), \")\"))\n  ) %&gt;%\n  ungroup() %&gt;%\n  select(Category, Label, Respiratory, Childhood, Other_grp)\n\n# .................. Show Category only once per group ..................\ntab_combined &lt;- tab_combined %&gt;%\n  group_by(Category) %&gt;%\n  mutate(Category = ifelse(row_number() == 1, Category, \"\")) %&gt;%\n  ungroup()\n\n# .................. Get total counts per vaccine group ..................\ntotals &lt;- vacc_1524 %&gt;%\n  count(vacc_group3) %&gt;%\n  deframe()\n\n# .................. Create flextable ..................\nft_vacc_summary &lt;- tab_combined %&gt;%\n  flextable() %&gt;%\n  set_header_labels(\n    Category = \"Variable type\",\n    Label = \"Values\",\n    Respiratory = \"Number (%)·µÉ\",\n    Childhood = \"Number (%)·µÉ\",\n    Other_grp = \"Number (%)·µÉ\"\n  ) %&gt;%\n  add_header_row(\n    values = c(\n      \"\", \"\",\n      paste0(\"Respiratory vaccines (N = \", format(totals[\"Respiratory vaccines\"], big.mark = \",\"), \")\"),\n      paste0(\"Childhood vaccines (N = \", format(totals[\"Childhood vaccines\"], big.mark = \",\"), \")\"),\n      paste0(\"Other (N = \", format(totals[\"Other\"], big.mark = \",\"), \")\")\n    )\n  ) %&gt;%\n  add_header_row(\n    values = c(\"Description\", \"Vaccination uptake\"),\n    colwidths = c(2, 3)\n  ) %&gt;%\n  theme_box() %&gt;%\n  set_table_properties(layout = \"autofit\", width = 1) %&gt;%\n  width(j = 1, width = 1.5) %&gt;%\n  width(j = 2, width = 2.5) %&gt;%\n  width(j = 3:5, width = 1.5) %&gt;%\n  align(align = \"justify\", part = \"all\") %&gt;%\n  border_remove() %&gt;%\n  #  border_inner_h(border = fp_border(color = \"black\", width = 1)) %&gt;%\n  set_caption(\"Table: Vaccination uptake across service year, quarter, and weekday\") %&gt;%\n  footnote(i = 1, \n           value = as_paragraph(\"Vaccination proportions were calculated row-wise (i.e., by row).\"),\n           ref_symbols = \"·µÉ\", \n           part = \"header\")\n\n# .................. Show the table ..................\nft_vacc_summary\n\nDescription·µÉVaccination uptake·µÉRespiratory vaccines (N = 955)Childhood vaccines (N = 472)Other (N = 126)Variable typeValuesNumber (%)·µÉNumber (%)·µÉNumber (%)·µÉGenderFemale511 (64)233 (29.2)54 (6.8)Male444 (58.8)239 (31.7)72 (9.5)Age0-19250 (38.9)302 (47)90 (14)20-29150 (68.2)70 (31.8)0 (0)30-3947 (71.2)19 (28.8)0 (0)40-49142 (75.9)45 (24.1)0 (0)50-59112 (77.8)14 (9.7)18 (12.5)60-69149 (87.6)13 (7.6)8 (4.7)70+105 (84.7)9 (7.3)10 (8.1)Marital statusDivorced136 (83.4)15 (9.2)12 (7.4)Married289 (79)59 (16.1)18 (4.9)Single/widowed150 (79.4)33 (17.5)6 (3.2)Missing38036590Year201578 (51)56 (36.6)19 (12.4)201684 (60.4)47 (33.8)8 (5.8)201775 (54.7)52 (38)10 (7.3)201881 (53.6)52 (34.4)18 (11.9)201983 (51.6)60 (37.3)18 (11.2)202082 (59.9)44 (32.1)11 (8)2021223 (84.8)34 (12.9)6 (2.3)202288 (73.3)25 (20.8)7 (5.8)202387 (51.2)63 (37.1)20 (11.8)202474 (60.7)39 (32)9 (7.4)Quarter1253 (62.8)120 (29.8)30 (7.4)2220 (58.5)117 (31.1)39 (10.4)3295 (63.2)139 (29.8)33 (7.1)4187 (60.9)96 (31.3)24 (7.8)WeekdayFriday141 (78.3)31 (17.2)8 (4.4)Monday114 (64.4)49 (27.7)14 (7.9)Saturday160 (63.2)81 (32)12 (4.7)Sunday156 (56.3)100 (36.1)21 (7.6)Thursday167 (66)66 (26.1)20 (7.9)Tuesday108 (65.5)43 (26.1)14 (8.5)Wednesday109 (44)102 (41.1)37 (14.9)·µÉVaccination proportions were calculated row-wise (i.e., by row).\n\n# .................. Clean up ..................\nrm(tab_age, tab_sex, tab_marital_status, tab_year, tab_quarter, tab_weekday, \n   tab_combined, ft_vacc_summary, totals, create_tab)"
  },
  {
    "objectID": "Post_Blog/Table_automation_Ideas/index.html#only-horizontal-lines",
    "href": "Post_Blog/Table_automation_Ideas/index.html#only-horizontal-lines",
    "title": "Automating Publication-Ready Tables in R",
    "section": "",
    "text": "This style keeps only horizontal dividers to improve readability without overwhelming the user.\nüìè Implication: Helps guide the eye across wide tables while maintaining a clean aesthetic.\n‚úÖ Great for: Formal documents and slide decks where visual clarity is important.\n\n# ------------6. Lines: Only Horizantal Lines -------------------------------------------\n\n# .................. Convert grouping vars to character ..................\nvacc_1524 &lt;- vacc_1524 %&gt;%\n  mutate(across(c(age_3group, gender, marital_status,\n                  vacc_service_year, vacc_quarter, vacc_weekday), as.character))\n\n# .................. Table generation function with Missing ..................\ncreate_tab &lt;- function(data, var, label) {\n  tab_main &lt;- data %&gt;%\n    filter(!is.na({{ var }})) %&gt;%\n    tabyl({{ var }}, vacc_group3) %&gt;%\n    mutate(Category = label, .before = 1) %&gt;%\n    rename(Label = {{ var }}) %&gt;%\n    mutate(Label = as.character(Label))\n  \n  na_count &lt;- sum(is.na(pull(data, {{ var }})))\n  \n  if (na_count &gt; 0) {\n    missing_row &lt;- tibble(\n      Category = label,\n      Label = \"Missing\",\n      `Respiratory vaccines` = sum(data$vacc_group3 == \"Respiratory vaccines\" & is.na(pull(data, {{ var }})), na.rm = TRUE),\n      `Childhood vaccines` = sum(data$vacc_group3 == \"Childhood vaccines\" & is.na(pull(data, {{ var }})), na.rm = TRUE),\n      Other = sum(data$vacc_group3 == \"Other\" & is.na(pull(data, {{ var }})), na.rm = TRUE)\n    )\n    tab_final &lt;- bind_rows(tab_main, missing_row)\n  } else {\n    tab_final &lt;- tab_main\n  }\n  \n  return(tab_final)\n}\n\n# .................. Create summary tables ..................\ntab_age            &lt;- create_tab(vacc_1524, age_group, \"Age\")\ntab_sex            &lt;- create_tab(vacc_1524, gender, \"Gender\")\ntab_marital_status &lt;- create_tab(vacc_1524, marital_status, \"Marital status\")\ntab_year           &lt;- create_tab(vacc_1524, vacc_service_year, \"Year\")\ntab_quarter        &lt;- create_tab(vacc_1524, vacc_quarter, \"Quarter\")\ntab_weekday        &lt;- create_tab(vacc_1524, vacc_weekday, \"Weekday\")\n\n# .................. Combine all tables ..................\ntab_combined &lt;- bind_rows(tab_sex, tab_age, tab_marital_status, tab_year, tab_quarter, tab_weekday)\n\n# .................. Calculate row-wise percentages (skip for Missing) ..................\ntab_combined &lt;- tab_combined %&gt;%\n  rowwise() %&gt;%\n  mutate(\n    Total = sum(`Respiratory vaccines`, `Childhood vaccines`, Other, na.rm = TRUE),\n    is_missing = trimws(tolower(Label)) == \"missing\",\n    \n    Respiratory = ifelse(is_missing,\n                         comma(`Respiratory vaccines`),\n                         paste0(comma(`Respiratory vaccines`), \" (\", round(100 * `Respiratory vaccines` / Total, 1), \")\")),\n    \n    Childhood = ifelse(is_missing,\n                       comma(`Childhood vaccines`),\n                       paste0(comma(`Childhood vaccines`), \" (\", round(100 * `Childhood vaccines` / Total, 1), \")\")),\n    \n    Other_grp = ifelse(is_missing,\n                       comma(Other),\n                       paste0(comma(Other), \" (\", round(100 * Other / Total, 1), \")\"))\n  ) %&gt;%\n  ungroup() %&gt;%\n  select(Category, Label, Respiratory, Childhood, Other_grp)\n\n# .................. Show Category only once per group ..................\ntab_combined &lt;- tab_combined %&gt;%\n  group_by(Category) %&gt;%\n  mutate(Category = ifelse(row_number() == 1, Category, \"\")) %&gt;%\n  ungroup()\n\n# .................. Get total counts per vaccine group ..................\ntotals &lt;- vacc_1524 %&gt;%\n  count(vacc_group3) %&gt;%\n  deframe()\n\n# .................. Create flextable ..................\nft_vacc_summary &lt;- tab_combined %&gt;%\n  flextable() %&gt;%\n  set_header_labels(\n    Category = \"Variable type\",\n    Label = \"Values\",\n    Respiratory = \"Number (%)·µÉ\",\n    Childhood = \"Number (%)·µÉ\",\n    Other_grp = \"Number (%)·µÉ\"\n  ) %&gt;%\n  add_header_row(\n    values = c(\n      \"\", \"\",\n      paste0(\"Respiratory vaccines (N = \", format(totals[\"Respiratory vaccines\"], big.mark = \",\"), \")\"),\n      paste0(\"Childhood vaccines (N = \", format(totals[\"Childhood vaccines\"], big.mark = \",\"), \")\"),\n      paste0(\"Other (N = \", format(totals[\"Other\"], big.mark = \",\"), \")\")\n    )\n  ) %&gt;%\n  add_header_row(\n    values = c(\"Description\", \"Vaccination uptake\"),\n    colwidths = c(2, 3)\n  ) %&gt;%\n  theme_box() %&gt;%\n  set_table_properties(layout = \"autofit\", width = 1) %&gt;%\n  width(j = 1, width = 1.5) %&gt;%\n  width(j = 2, width = 2.5) %&gt;%\n  width(j = 3:5, width = 1.5) %&gt;%\n  align(align = \"justify\", part = \"all\") %&gt;%\n  border_remove() %&gt;%\n  border(part = \"header\", i = 1, border.top = fp_border(color = \"black\", width = 1)) %&gt;%\n  border(part = \"header\", i = 3, border.bottom = fp_border(color = \"black\", width = 1)) %&gt;%\n  border_inner_h(part = \"header\", border = fp_border(color = \"black\", width = 0.8)) %&gt;%\n  border_inner_h(part = \"body\", border = fp_border(color = \"black\", width = 0.8)) %&gt;%\n  border(part = \"body\", i = nrow(tab_combined), border.bottom = fp_border(color = \"black\", width = 1)) %&gt;%\n  \n  set_caption(\"Table: Vaccination uptake across service year, quarter, and weekday\") %&gt;%\n  footnote(i = 1, \n           value = as_paragraph(\"Vaccination proportions were calculated row-wise (i.e., by row).\"),\n           ref_symbols = \"·µÉ\", \n           part = \"header\")\n\n# .................. Show the table ..................\nft_vacc_summary\n\nDescription·µÉVaccination uptake·µÉRespiratory vaccines (N = 955)Childhood vaccines (N = 472)Other (N = 126)Variable typeValuesNumber (%)·µÉNumber (%)·µÉNumber (%)·µÉGenderFemale511 (64)233 (29.2)54 (6.8)Male444 (58.8)239 (31.7)72 (9.5)Age0-19250 (38.9)302 (47)90 (14)20-29150 (68.2)70 (31.8)0 (0)30-3947 (71.2)19 (28.8)0 (0)40-49142 (75.9)45 (24.1)0 (0)50-59112 (77.8)14 (9.7)18 (12.5)60-69149 (87.6)13 (7.6)8 (4.7)70+105 (84.7)9 (7.3)10 (8.1)Marital statusDivorced136 (83.4)15 (9.2)12 (7.4)Married289 (79)59 (16.1)18 (4.9)Single/widowed150 (79.4)33 (17.5)6 (3.2)Missing38036590Year201578 (51)56 (36.6)19 (12.4)201684 (60.4)47 (33.8)8 (5.8)201775 (54.7)52 (38)10 (7.3)201881 (53.6)52 (34.4)18 (11.9)201983 (51.6)60 (37.3)18 (11.2)202082 (59.9)44 (32.1)11 (8)2021223 (84.8)34 (12.9)6 (2.3)202288 (73.3)25 (20.8)7 (5.8)202387 (51.2)63 (37.1)20 (11.8)202474 (60.7)39 (32)9 (7.4)Quarter1253 (62.8)120 (29.8)30 (7.4)2220 (58.5)117 (31.1)39 (10.4)3295 (63.2)139 (29.8)33 (7.1)4187 (60.9)96 (31.3)24 (7.8)WeekdayFriday141 (78.3)31 (17.2)8 (4.4)Monday114 (64.4)49 (27.7)14 (7.9)Saturday160 (63.2)81 (32)12 (4.7)Sunday156 (56.3)100 (36.1)21 (7.6)Thursday167 (66)66 (26.1)20 (7.9)Tuesday108 (65.5)43 (26.1)14 (8.5)Wednesday109 (44)102 (41.1)37 (14.9)·µÉVaccination proportions were calculated row-wise (i.e., by row).\n\n# .................. Clean up ..................\nrm(tab_age, tab_sex, tab_marital_status, tab_year, tab_quarter, tab_weekday, \n   tab_combined, ft_vacc_summary, totals, create_tab)"
  },
  {
    "objectID": "Post_Blog/Table_automation_Ideas/index.html#all-lines-visible",
    "href": "Post_Blog/Table_automation_Ideas/index.html#all-lines-visible",
    "title": "Automating Publication-Ready Tables in R",
    "section": "",
    "text": "This version includes both horizontal and vertical grid lines, mimicking Excel-style tables.\nüìä When to use: When presenting detailed tables where structure must be visually enforced.\nüì¶ Applicability: Regulatory reports, appendices, or complex data breakdowns.\n\n# ------------6. Lines: All Lines Visible-------------------------------------------\n\n# .................. Convert grouping vars to character ..................\nvacc_1524 &lt;- vacc_1524 %&gt;%\n  mutate(across(c(age_group, gender, marital_status,\n                  vacc_service_year, vacc_quarter, vacc_weekday), as.character))\n\n# .................. Table generation function with Missing ..................\ncreate_tab &lt;- function(data, var, label) {\n  tab_main &lt;- data %&gt;%\n    filter(!is.na({{ var }})) %&gt;%\n    tabyl({{ var }}, vacc_group3) %&gt;%\n    mutate(Category = label, .before = 1) %&gt;%\n    rename(Label = {{ var }}) %&gt;%\n    mutate(Label = as.character(Label))\n  \n  na_count &lt;- sum(is.na(pull(data, {{ var }})))\n  \n  if (na_count &gt; 0) {\n    missing_row &lt;- tibble(\n      Category = label,\n      Label = \"Missing\",\n      `Respiratory vaccines` = sum(data$vacc_group3 == \"Respiratory vaccines\" & is.na(pull(data, {{ var }})), na.rm = TRUE),\n      `Childhood vaccines` = sum(data$vacc_group3 == \"Childhood vaccines\" & is.na(pull(data, {{ var }})), na.rm = TRUE),\n      Other = sum(data$vacc_group3 == \"Other\" & is.na(pull(data, {{ var }})), na.rm = TRUE)\n    )\n    tab_final &lt;- bind_rows(tab_main, missing_row)\n  } else {\n    tab_final &lt;- tab_main\n  }\n  \n  return(tab_final)\n}\n\n# .................. Create summary tables ..................\ntab_age            &lt;- create_tab(vacc_1524, age_group, \"Age\")\ntab_sex            &lt;- create_tab(vacc_1524, gender, \"Gender\")\ntab_marital_status &lt;- create_tab(vacc_1524, marital_status, \"Marital status\")\ntab_year           &lt;- create_tab(vacc_1524, vacc_service_year, \"Year\")\ntab_quarter        &lt;- create_tab(vacc_1524, vacc_quarter, \"Quarter\")\ntab_weekday        &lt;- create_tab(vacc_1524, vacc_weekday, \"Weekday\")\n\n# .................. Combine all tables ..................\ntab_combined &lt;- bind_rows(tab_sex, tab_age, tab_marital_status, tab_year, tab_quarter, tab_weekday)\n\n# .................. Calculate row-wise percentages (skip for Missing) ..................\ntab_combined &lt;- tab_combined %&gt;%\n  rowwise() %&gt;%\n  mutate(\n    Total = sum(`Respiratory vaccines`, `Childhood vaccines`, Other, na.rm = TRUE),\n    is_missing = trimws(tolower(Label)) == \"missing\",\n    \n    Respiratory = ifelse(is_missing,\n                         comma(`Respiratory vaccines`),\n                         paste0(comma(`Respiratory vaccines`), \" (\", round(100 * `Respiratory vaccines` / Total, 1), \")\")),\n    \n    Childhood = ifelse(is_missing,\n                       comma(`Childhood vaccines`),\n                       paste0(comma(`Childhood vaccines`), \" (\", round(100 * `Childhood vaccines` / Total, 1), \")\")),\n    \n    Other_grp = ifelse(is_missing,\n                       comma(Other),\n                       paste0(comma(Other), \" (\", round(100 * Other / Total, 1), \")\"))\n  ) %&gt;%\n  ungroup() %&gt;%\n  select(Category, Label, Respiratory, Childhood, Other_grp)\n\n# .................. Show Category only once per group ..................\ntab_combined &lt;- tab_combined %&gt;%\n  group_by(Category) %&gt;%\n  mutate(Category = ifelse(row_number() == 1, Category, \"\")) %&gt;%\n  ungroup()\n\n# .................. Get total counts per vaccine group ..................\ntotals &lt;- vacc_1524 %&gt;%\n  count(vacc_group3) %&gt;%\n  deframe()\n\n# .................. Create flextable ..................\nft_vacc_summary &lt;- tab_combined %&gt;%\n  flextable() %&gt;%\n  set_header_labels(\n    Category = \"Variable type\",\n    Label = \"Values\",\n    Respiratory = \"Number (%)·µÉ\",\n    Childhood = \"Number (%)·µÉ\",\n    Other_grp = \"Number (%)·µÉ\"\n  ) %&gt;%\n  add_header_row(\n    values = c(\n      \"\", \"\",\n      paste0(\"Respiratory vaccines (N = \", format(totals[\"Respiratory vaccines\"], big.mark = \",\"), \")\"),\n      paste0(\"Childhood vaccines (N = \", format(totals[\"Childhood vaccines\"], big.mark = \",\"), \")\"),\n      paste0(\"Other (N = \", format(totals[\"Other\"], big.mark = \",\"), \")\")\n    )\n  ) %&gt;%\n  add_header_row(\n    values = c(\"Description\", \"Vaccination uptake\"),\n    colwidths = c(2, 3)\n  ) %&gt;%\n  theme_box() %&gt;%\n  set_table_properties(layout = \"autofit\", width = 1) %&gt;%\n  width(j = 1, width = 1.5) %&gt;%\n  width(j = 2, width = 2.5) %&gt;%\n  width(j = 3:5, width = 1.5) %&gt;%\n  align(align = \"justify\", part = \"all\") %&gt;%\n  border_inner_h(border = fp_border(color = \"black\", width = 1)) %&gt;%\n  set_caption(\"Table: Vaccination uptake across service year, quarter, and weekday\") %&gt;%\n  footnote(i = 1, \n           value = as_paragraph(\"Vaccination proportions were calculated row-wise (i.e., by row).\"),\n           ref_symbols = \"·µÉ\", \n           part = \"header\")\n\n# .................. Show the table ..................\nft_vacc_summary\n\nDescription·µÉVaccination uptake·µÉRespiratory vaccines (N = 955)Childhood vaccines (N = 472)Other (N = 126)Variable typeValuesNumber (%)·µÉNumber (%)·µÉNumber (%)·µÉGenderFemale511 (64)233 (29.2)54 (6.8)Male444 (58.8)239 (31.7)72 (9.5)Age0-19250 (38.9)302 (47)90 (14)20-29150 (68.2)70 (31.8)0 (0)30-3947 (71.2)19 (28.8)0 (0)40-49142 (75.9)45 (24.1)0 (0)50-59112 (77.8)14 (9.7)18 (12.5)60-69149 (87.6)13 (7.6)8 (4.7)70+105 (84.7)9 (7.3)10 (8.1)Marital statusDivorced136 (83.4)15 (9.2)12 (7.4)Married289 (79)59 (16.1)18 (4.9)Single/widowed150 (79.4)33 (17.5)6 (3.2)Missing38036590Year201578 (51)56 (36.6)19 (12.4)201684 (60.4)47 (33.8)8 (5.8)201775 (54.7)52 (38)10 (7.3)201881 (53.6)52 (34.4)18 (11.9)201983 (51.6)60 (37.3)18 (11.2)202082 (59.9)44 (32.1)11 (8)2021223 (84.8)34 (12.9)6 (2.3)202288 (73.3)25 (20.8)7 (5.8)202387 (51.2)63 (37.1)20 (11.8)202474 (60.7)39 (32)9 (7.4)Quarter1253 (62.8)120 (29.8)30 (7.4)2220 (58.5)117 (31.1)39 (10.4)3295 (63.2)139 (29.8)33 (7.1)4187 (60.9)96 (31.3)24 (7.8)WeekdayFriday141 (78.3)31 (17.2)8 (4.4)Monday114 (64.4)49 (27.7)14 (7.9)Saturday160 (63.2)81 (32)12 (4.7)Sunday156 (56.3)100 (36.1)21 (7.6)Thursday167 (66)66 (26.1)20 (7.9)Tuesday108 (65.5)43 (26.1)14 (8.5)Wednesday109 (44)102 (41.1)37 (14.9)·µÉVaccination proportions were calculated row-wise (i.e., by row).\n\n# .................. Clean up ..................\nrm(tab_age, tab_sex, tab_marital_status, tab_year, tab_quarter, tab_weekday, \n   tab_combined, ft_vacc_summary, totals, create_tab)"
  },
  {
    "objectID": "Post_Blog/Table_automation_Ideas/index.html#font-formatting-colour-and-font-options",
    "href": "Post_Blog/Table_automation_Ideas/index.html#font-formatting-colour-and-font-options",
    "title": "Automating Publication-Ready Tables in R",
    "section": "",
    "text": "Here, I demonstrate how to:\n\nSet font types (e.g., Times New Roman)\nControl font size\nApply alternating row colors and header backgrounds\n\nüé® Why this is valuable:\n\nEnhances visual appeal and professionalism.\nAligns with publication or organizational branding requirements.\nBest for: Reports to stakeholders, executive summaries, or printed materials.\n\n\n# ------------ 7. Font Formating: Colour and Font type options adding in the Table -------------------------------------------\n\nlibrary(dplyr)\nlibrary(janitor)\nlibrary(tibble)\nlibrary(scales)\nlibrary(flextable)\n\n# .................. Convert grouping vars to character ..................\nvacc_1524 &lt;- vacc_1524 %&gt;%\n  mutate(across(c(age_group, gender, marital_status,\n                  vacc_service_year, vacc_quarter, vacc_weekday), as.character))\n\n# .................. Table generation function with Missing ..................\ncreate_tab &lt;- function(data, var, label) {\n  tab_main &lt;- data %&gt;%\n    filter(!is.na({{ var }})) %&gt;%\n    tabyl({{ var }}, vacc_group3) %&gt;%\n    mutate(Category = label, .before = 1) %&gt;%\n    rename(Label = {{ var }}) %&gt;%\n    mutate(Label = as.character(Label))\n  \n  na_count &lt;- sum(is.na(pull(data, {{ var }})))\n  \n  if (na_count &gt; 0) {\n    missing_row &lt;- tibble(\n      Category = label,\n      Label = \"Missing\",\n      `Respiratory vaccines` = sum(data$vacc_group3 == \"Respiratory vaccines\" & is.na(pull(data, {{ var }})), na.rm = TRUE),\n      `Childhood vaccines` = sum(data$vacc_group3 == \"Childhood vaccines\" & is.na(pull(data, {{ var }})), na.rm = TRUE),\n      Other = sum(data$vacc_group3 == \"Other\" & is.na(pull(data, {{ var }})), na.rm = TRUE)\n    )\n    tab_final &lt;- bind_rows(tab_main, missing_row)\n  } else {\n    tab_final &lt;- tab_main\n  }\n  \n  return(tab_final)\n}\n\n# .................. Create summary tables ..................\ntab_age            &lt;- create_tab(vacc_1524, age_group, \"Age\")\ntab_sex            &lt;- create_tab(vacc_1524, gender, \"Gender\")\ntab_marital_status &lt;- create_tab(vacc_1524, marital_status, \"Marital status\")\ntab_year           &lt;- create_tab(vacc_1524, vacc_service_year, \"Year\")\ntab_quarter        &lt;- create_tab(vacc_1524, vacc_quarter, \"Quarter\")\ntab_weekday        &lt;- create_tab(vacc_1524, vacc_weekday, \"Weekday\")\n\n# .................. Combine all tables ..................\ntab_combined &lt;- bind_rows(tab_sex, tab_age, tab_marital_status, tab_year, tab_quarter, tab_weekday)\n\n# .................. Calculate row-wise percentages (skip for Missing) ..................\ntab_combined &lt;- tab_combined %&gt;%\n  rowwise() %&gt;%\n  mutate(\n    Total = sum(`Respiratory vaccines`, `Childhood vaccines`, Other, na.rm = TRUE),\n    is_missing = trimws(tolower(Label)) == \"missing\",\n    \n    Respiratory = ifelse(is_missing,\n                         comma(`Respiratory vaccines`),\n                         paste0(comma(`Respiratory vaccines`), \" (\", round(100 * `Respiratory vaccines` / Total, 1), \")\")),\n    \n    Childhood = ifelse(is_missing,\n                       comma(`Childhood vaccines`),\n                       paste0(comma(`Childhood vaccines`), \" (\", round(100 * `Childhood vaccines` / Total, 1), \")\")),\n    \n    Other_grp = ifelse(is_missing,\n                       comma(Other),\n                       paste0(comma(Other), \" (\", round(100 * Other / Total, 1), \")\"))\n  ) %&gt;%\n  ungroup() %&gt;%\n  select(Category, Label, Respiratory, Childhood, Other_grp)\n\n# .................. Show Category only once per group ..................\ntab_combined &lt;- tab_combined %&gt;%\n  group_by(Category) %&gt;%\n  mutate(Category = ifelse(row_number() == 1, Category, \"\")) %&gt;%\n  ungroup()\n\n# .................. Get total counts per vaccine group ..................\ntotals &lt;- vacc_1524 %&gt;%\n  count(vacc_group3) %&gt;%\n  deframe()\n\n\nft_vacc_summary &lt;- tab_combined %&gt;%\n  flextable() %&gt;%\n  set_header_labels(\n    Category = \"Variable type\",\n    Label = \"Values\",\n    Respiratory = \"Number (%)·µÉ\",\n    Childhood = \"Number (%)·µÉ\",\n    Other_grp = \"Number (%)·µÉ\"\n  ) %&gt;%\n  add_header_row(\n    values = c(\n      \"\", \"\",\n      paste0(\"Respiratory vaccines (N = \", format(totals[\"Respiratory vaccines\"], big.mark = \",\"), \")\"),\n      paste0(\"Childhood vaccines (N = \", format(totals[\"Childhood vaccines\"], big.mark = \",\"), \")\"),\n      paste0(\"Other (N = \", format(totals[\"Other\"], big.mark = \",\"), \")\")\n    )\n  ) %&gt;%\n  add_header_row(\n    values = c(\"Description\", \"Vaccination uptake\"),\n    colwidths = c(2, 3)\n  ) %&gt;%\n  theme_box() %&gt;%\n  set_table_properties(layout = \"autofit\", width = 1) %&gt;%\n  width(j = 1, width = 1.5) %&gt;%\n  width(j = 2, width = 2.5) %&gt;%\n  width(j = 3:5, width = 1.5) %&gt;%\n  align(align = \"justify\", part = \"all\") %&gt;%\n  border_remove() %&gt;%\n  border(part = \"header\", i = 1, border.top = fp_border(color = \"black\", width = 1)) %&gt;%\n  border(part = \"header\", i = 3, border.bottom = fp_border(color = \"black\", width = 1)) %&gt;%\n  border_inner_h(part = \"header\", border = fp_border(color = \"black\", width = 0.8)) %&gt;%\n  border_inner_h(part = \"body\", border = fp_border(color = \"black\", width = 0.8)) %&gt;%\n  border(part = \"body\", i = nrow(tab_combined), border.bottom = fp_border(color = \"black\", width = 1)) %&gt;%\n  \n  set_caption(as_paragraph(as_chunk(\"Table: Vaccination uptake across service year, quarter, and weekday\",\n                                    props = fp_text(font.size = 14, font.family = \"Times New Roman\", bold = FALSE)))) %&gt;%\n  fontsize(part = \"header\", size = 12) %&gt;%\n  fontsize(part = \"body\", size = 11) %&gt;%\n  fontsize(part = \"footer\", size = 10) %&gt;%\n  font(part = \"all\", fontname = \"Times New Roman\") %&gt;%\n  bg(part = \"header\", bg = \"lightblue\") %&gt;%\n  bg(j = 1:5, i = seq(1, nrow(tab_combined), 2), bg = \"lightgray\") %&gt;%\n  bg(j = 1:5, i = seq(2, nrow(tab_combined), 2), bg = \"red\") %&gt;%\n  footnote(i = 1, \n           value = as_paragraph(\"Vaccination proportions were calculated row-wise (i.e., by row).\"),\n           ref_symbols = \"·µÉ\", \n           part = \"header\")\n\n\n# .................. Show the table ..................\nft_vacc_summary\n\nDescription·µÉVaccination uptake·µÉRespiratory vaccines (N = 955)Childhood vaccines (N = 472)Other (N = 126)Variable typeValuesNumber (%)·µÉNumber (%)·µÉNumber (%)·µÉGenderFemale511 (64)233 (29.2)54 (6.8)Male444 (58.8)239 (31.7)72 (9.5)Age0-19250 (38.9)302 (47)90 (14)20-29150 (68.2)70 (31.8)0 (0)30-3947 (71.2)19 (28.8)0 (0)40-49142 (75.9)45 (24.1)0 (0)50-59112 (77.8)14 (9.7)18 (12.5)60-69149 (87.6)13 (7.6)8 (4.7)70+105 (84.7)9 (7.3)10 (8.1)Marital statusDivorced136 (83.4)15 (9.2)12 (7.4)Married289 (79)59 (16.1)18 (4.9)Single/widowed150 (79.4)33 (17.5)6 (3.2)Missing38036590Year201578 (51)56 (36.6)19 (12.4)201684 (60.4)47 (33.8)8 (5.8)201775 (54.7)52 (38)10 (7.3)201881 (53.6)52 (34.4)18 (11.9)201983 (51.6)60 (37.3)18 (11.2)202082 (59.9)44 (32.1)11 (8)2021223 (84.8)34 (12.9)6 (2.3)202288 (73.3)25 (20.8)7 (5.8)202387 (51.2)63 (37.1)20 (11.8)202474 (60.7)39 (32)9 (7.4)Quarter1253 (62.8)120 (29.8)30 (7.4)2220 (58.5)117 (31.1)39 (10.4)3295 (63.2)139 (29.8)33 (7.1)4187 (60.9)96 (31.3)24 (7.8)WeekdayFriday141 (78.3)31 (17.2)8 (4.4)Monday114 (64.4)49 (27.7)14 (7.9)Saturday160 (63.2)81 (32)12 (4.7)Sunday156 (56.3)100 (36.1)21 (7.6)Thursday167 (66)66 (26.1)20 (7.9)Tuesday108 (65.5)43 (26.1)14 (8.5)Wednesday109 (44)102 (41.1)37 (14.9)·µÉVaccination proportions were calculated row-wise (i.e., by row).\n\n# .................. Clean up all new objects ..................\nrm(tab_age, tab_sex, tab_marital_status, tab_year, tab_quarter, tab_weekday, \n   tab_combined, ft_vacc_summary, totals, create_tab)"
  },
  {
    "objectID": "Post_Blog/Table_automation_Ideas/index.html#rowwise-tables-summary",
    "href": "Post_Blog/Table_automation_Ideas/index.html#rowwise-tables-summary",
    "title": "Automating Publication-Ready Tables in R",
    "section": "",
    "text": "This is not a new table‚Äîrather, it‚Äôs a conceptual summary of the row-wise percentage approaches applied in earlier sections.\nImportance:\n\nPercentages sum to 100% per row, highlighting within-group distributions.\n\nImplications:\n\nAnswers: ‚ÄúWithin age group X, what % received each vaccine?‚Äù"
  },
  {
    "objectID": "Post_Blog/Table_automation_Ideas/index.html#columnwise-tables",
    "href": "Post_Blog/Table_automation_Ideas/index.html#columnwise-tables",
    "title": "Automating Publication-Ready Tables in R",
    "section": "",
    "text": "This version calculates percentages down each vaccine group column, rather than across each row.\nImportance:\n\nPercentages sum to 100% per column, showing group contributions to totals.\n\nImplications:\n\nAnswers: ‚ÄúAmong Respiratory vaccines, what % are from age group X?‚Äù\nUse this when: You want to know, for example, what percentage of all Respiratory vaccine users were aged below 25 years.\n\n\n# ------------ 10. Columnwise Tables -------------------------------------------\n\n# Prepare Vaccination Uptake Table (All Variables Using Column Percentages)\n\n# --- Convert selected variables to character type for proper label handling ---\nvacc_1524 &lt;- vacc_1524 %&gt;%\n  mutate(across(c(gender, age_3group, marital_2group, year_3group, vacc_quarter, race_grouped), as.character))\n\n# --- Create general table-building function with optional column percentage flag ---\n# This function creates a summary count table of vaccination type by a categorical variable.\n# If use_col_percentage is TRUE, the summary will support column-based percentage formatting.\ncreate_tab &lt;- function(data, var, label, use_col_percentage = TRUE) {\n  tab_main &lt;- data %&gt;%\n    filter(!is.na({{ var }})) %&gt;%\n    tabyl({{ var }}, vacc_group3) %&gt;%\n    mutate(Category = label, .before = 1) %&gt;%\n    rename(Label = {{ var }}) %&gt;%\n    mutate(Label = as.character(Label))\n  \n  # Add a row for \"Unknown\" if missing values are found\n  na_count &lt;- sum(is.na(pull(data, {{ var }})))\n  if (na_count &gt; 0) {\n    na_row &lt;- tibble(\n      Category = label,\n      Label = \"Unknown\",\n      `Respiratory vaccines` = sum(data$vacc_group3 == \"Respiratory vaccines\" & is.na(pull(data, {{ var }})), na.rm = TRUE),\n      `Childhood vaccines` = sum(data$vacc_group3 == \"Childhood vaccines\" & is.na(pull(data, {{ var }})), na.rm = TRUE),\n      Other = sum(data$vacc_group3 == \"Other\" & is.na(pull(data, {{ var }})), na.rm = TRUE)\n    )\n    tab_combined &lt;- bind_rows(tab_main, na_row)\n  } else {\n    tab_combined &lt;- tab_main\n  }\n  \n  tab_combined %&gt;%\n    mutate(use_col_percentage = use_col_percentage)\n}\n\n# --- Generate summary tables for each variable using column percentages ---\ntab_gender    &lt;- create_tab(vacc_1524, gender, \"Gender\")\ntab_age       &lt;- create_tab(vacc_1524, age_3group, \"Age group\")\ntab_marital   &lt;- create_tab(vacc_1524, marital_2group, \"Marital status·µá\")\ntab_year      &lt;- create_tab(vacc_1524, year_3group, \"Year group\")\ntab_quarter   &lt;- create_tab(vacc_1524, vacc_quarter, \"Quarter\")\ntab_race      &lt;- create_tab(vacc_1524, race_grouped, \"Race group\")\n\n# --- Combine all variable-level tables into one ---\ntab_combined &lt;- bind_rows(\n  tab_gender, tab_age, tab_marital,\n  tab_year, tab_quarter, tab_race\n)\n\n# --- Calculate percentages and format values into strings with \"Number (%)\" ---\ntab_combined &lt;- tab_combined %&gt;%\n  group_by(Category) %&gt;%\n  mutate(\n    use_col = TRUE,  # column percentages applied uniformly\n    \n    # Calculate denominators excluding \"Unknown\"\n    Total_Resp = sum(`Respiratory vaccines`[Label != \"Unknown\"], na.rm = TRUE),\n    Total_Child = sum(`Childhood vaccines`[Label != \"Unknown\"], na.rm = TRUE),\n    Total_Other = sum(Other[Label != \"Unknown\"], na.rm = TRUE),\n    \n    # Calculate percentages\n    Resp_prop = ifelse(Label != \"Unknown\", round(100 * `Respiratory vaccines` / Total_Resp, 1), NA),\n    Child_prop = ifelse(Label != \"Unknown\", round(100 * `Childhood vaccines` / Total_Child, 1), NA),\n    Other_prop = ifelse(Label != \"Unknown\", round(100 * Other / Total_Other, 1), NA),\n    \n    # Format final output as \"number (percentage)\"\n    Respiratory = ifelse(is.na(Resp_prop),\n                         paste0(comma(`Respiratory vaccines`)),\n                         paste0(comma(`Respiratory vaccines`), \" (\", Resp_prop, \")\")),\n    Childhood = ifelse(is.na(Child_prop),\n                       paste0(comma(`Childhood vaccines`)),\n                       paste0(comma(`Childhood vaccines`), \" (\", Child_prop, \")\")),\n    Other_grp = ifelse(is.na(Other_prop),\n                       paste0(comma(Other)),\n                       paste0(comma(Other), \" (\", Other_prop, \")\"))\n  ) %&gt;%\n  ungroup()\n\n# --- Final clean-up: labels, superscripts, and hiding \"0 (0)\" from Unknown row ---\ntab_combined &lt;- tab_combined %&gt;%\n  mutate(\n    Label = ifelse(Label == \"Other\", \"Other·∂ú\", Label),\n    Respiratory = ifelse(Label == \"Unknown\" & `Respiratory vaccines` == 0, \"\", Respiratory),\n    Childhood   = ifelse(Label == \"Unknown\" & `Childhood vaccines` == 0, \"\", Childhood),\n    Other_grp   = ifelse(Label == \"Unknown\" & Other == 0, \"\", Other_grp)\n  ) %&gt;%\n  group_by(Category) %&gt;%\n  mutate(Category = ifelse(row_number() == 1, Category, \"\")) %&gt;%\n  ungroup() %&gt;%\n  select(Category, Label, Respiratory, Childhood, Other_grp)\n\n# --- Get total N for each vaccine group to display in header ---\ntotals &lt;- table(vacc_1524$vacc_group3)\ntotal_resp &lt;- totals[\"Respiratory vaccines\"]\ntotal_child &lt;- totals[\"Childhood vaccines\"]\ntotal_other &lt;- totals[\"Other\"]\n\n# --- Build flextable for formatted presentation ---\ntable_vacc_summary &lt;- flextable(tab_combined) %&gt;%\n  set_header_labels(\n    Category = \"Variable type\",\n    Label = \"Values\",\n    Respiratory = \"Number (%)·µÉ\",\n    Childhood = \"Number (%)·µÉ\",\n    Other_grp = \"Number (%)·µÉ\"\n  ) %&gt;%\n  add_header_row(\n    values = c(\"\", \"\",\n               paste0(\"Respiratory vaccines (N = \", format(total_resp, big.mark = \",\"), \")\"),\n               paste0(\"Childhood vaccines (N = \", format(total_child, big.mark = \",\"), \")\"),\n               paste0(\"Other (N = \", format(total_other, big.mark = \",\"), \")\")),\n    colwidths = c(1, 1, 1, 1, 1),\n    top = TRUE\n  ) %&gt;%\n  add_header_row(\n    values = c(\"Description\", \"Vaccination uptake\"),\n    colwidths = c(2, 3),\n    top = TRUE\n  ) %&gt;%\n  theme_box() %&gt;%\n  set_table_properties(layout = \"autofit\", width = 1) %&gt;%\n  width(j = 1, width = 1.5) %&gt;%\n  width(j = 2, width = 2.5) %&gt;%\n  width(j = 3:5, width = 1.5) %&gt;%\n  align(align = \"justify\", part = \"all\") %&gt;%\n  border_remove() %&gt;%\n  border(part = \"header\", i = 1, border.top = fp_border(color = \"black\", width = 1)) %&gt;%\n  border(part = \"header\", i = 3, border.bottom = fp_border(color = \"black\", width = 1)) %&gt;%\n  border_inner_h(part = \"header\", border = fp_border(color = \"black\", width = 0.8)) %&gt;%\n  border_inner_h(part = \"body\", border = fp_border(color = \"black\", width = 0.8)) %&gt;%\n  border(part = \"body\", i = nrow(tab_combined), border.bottom = fp_border(color = \"black\", width = 1)) %&gt;%\n  set_caption(as_paragraph(as_chunk(\n    \"Table xx: Column-percentage summary of vaccination uptake across all demographic variables, 2015‚Äì2024.\",\n    props = fp_text(font.size = 12, font.family = \"Times New Roman\", bold = FALSE)\n  ))) %&gt;%\n  add_footer_lines(values = c(\n    \"·µÉ Vaccination proportions were calculated using column percentages for all variables.\",\n    \"·µá Marital status was grouped into two: partnered (married) and not-partnered (divorced, widowed, single).\",\n    \"·∂ú Other race refers to those identifying as native or other racial groups.\"\n  )) %&gt;%\n  fontsize(part = \"header\", size = 12) %&gt;%\n  fontsize(part = \"body\", size = 11) %&gt;%\n  fontsize(part = \"footer\", size = 10) %&gt;%\n  font(part = \"all\", fontname = \"Times New Roman\") %&gt;%\n  color(part = \"header\", color = \"white\") %&gt;%\n  bg(part = \"header\", bg = \"black\") %&gt;%\n  bg(j = 1:5, i = seq(2, nrow(tab_combined), 2), bg = \"white\") %&gt;%\n  bold(j = 1, part = \"body\")\n\n# --- Display final table ---\ntable_vacc_summary\n\nDescriptionVaccination uptakeRespiratory vaccines (N = 955)Childhood vaccines (N = 472)Other (N = 126)Variable typeValuesNumber (%)·µÉNumber (%)·µÉNumber (%)·µÉGenderFemale511 (53.5)233 (49.4)54 (42.9)Male444 (46.5)239 (50.6)72 (57.1)Age group&lt;25332 (34.8)337 (71.4)90 (71.4)25-3498 (10.3)51 (10.8)0 (0)35+525 (55)84 (17.8)36 (28.6)Marital status·µáNot partnered286 (49.7)48 (44.9)18 (50)Partnered289 (50.3)59 (55.1)18 (50)Unknown38036590Year group‚â§2020483 (50.6)311 (65.9)84 (66.7)2021-2022311 (32.6)59 (12.5)13 (10.3)2023+161 (16.9)102 (21.6)29 (23)Quarter1253 (26.5)120 (25.4)30 (23.8)2220 (23)117 (24.8)39 (31)3295 (30.9)139 (29.4)33 (26.2)4187 (19.6)96 (20.3)24 (19)Race groupAsian69 (7.8)33 (7.3)9 (7.3)Other·∂ú28 (3.2)13 (2.9)1 (0.8)White788 (89)404 (89.8)114 (91.9)Unknown70222·µÉ Vaccination proportions were calculated using column percentages for all variables.·µá Marital status was grouped into two: partnered (married) and not-partnered (divorced, widowed, single).·∂ú Other race refers to those identifying as native or other racial groups.\n\n# --- Clean up temporary variables (optional good practice) ---\nrm(\n  tab_gender, tab_age, tab_marital, tab_year, tab_quarter, tab_race,\n  tab_combined, create_tab, totals, total_resp, total_child, total_other\n)"
  },
  {
    "objectID": "Post_Blog/Table_automation_Ideas/index.html#columnwise-tables-with-na-values",
    "href": "Post_Blog/Table_automation_Ideas/index.html#columnwise-tables-with-na-values",
    "title": "Automating Publication-Ready Tables in R",
    "section": "",
    "text": "Columnwise percentage table including NA where applicable - All variables use column percentages (i.e., % down each vaccine group column) - NA values are shown only where relevant (e.g., race group for Respiratory vaccines) - ‚ÄúUnknown‚Äù variable categories are excluded from percentage calculations to maintain ~100% totals per column - Useful for subgroup summaries where not all variables apply across all vaccine type\n\n# ------------ 11. Columnwise Tables with NA values-------------------------------------------\n\n# Prepare Vaccination Uptake Table (All Variables Using Column Percentages)\n# ....................................................................................................\n\n# --- Set working directory and load data (if needed) ---\n# setwd(\"C:/Users/User/Desktop/Materials_ Course and proposals/Course Related/DataCamp/Data/\")\n# load(\"Vaccination_uptake.RDATA\")\n\n# --- Clean and prepare datasets ---\nvacc_1524 &lt;- vacc_1524 %&gt;%\n  mutate(across(c(gender, age_3group, marital_2group, year_3group, vacc_quarter, race_grouped), as.character))\n\n# Subset data for Respiratory vaccines to calculate column-based percentages (used for race)\nrespiratory_vaccines &lt;- vacc_1524 %&gt;%\n  filter(vacc_group3 == \"Respiratory vaccines\") %&gt;%\n  mutate(across(race_grouped, as.character))\n\n# --- General table builder ---\ncreate_tab &lt;- function(data, var, label, use_col_percentage = TRUE) {\n  tab_main &lt;- data %&gt;%\n    filter(!is.na({{ var }})) %&gt;%\n    tabyl({{ var }}, vacc_group3) %&gt;%\n    mutate(Category = label, .before = 1) %&gt;%\n    rename(Label = {{ var }}) %&gt;%\n    mutate(Label = as.character(Label))\n  \n  na_count &lt;- sum(is.na(pull(data, {{ var }})))\n  if (na_count &gt; 0) {\n    na_row &lt;- tibble(\n      Category = label,\n      Label = \"Unknown\",\n      `Respiratory vaccines` = sum(data$vacc_group3 == \"Respiratory vaccines\" & is.na(pull(data, {{ var }})), na.rm = TRUE),\n      `Childhood vaccines` = sum(data$vacc_group3 == \"Childhood vaccines\" & is.na(pull(data, {{ var }})), na.rm = TRUE),\n      Other = sum(data$vacc_group3 == \"Other\" & is.na(pull(data, {{ var }})), na.rm = TRUE)\n    )\n    tab_combined &lt;- bind_rows(tab_main, na_row)\n  } else {\n    tab_combined &lt;- tab_main\n  }\n  \n  tab_combined %&gt;%\n    mutate(use_col_percentage = use_col_percentage)\n}\n\n# --- Create summary tables ---\ntab_gender    &lt;- create_tab(vacc_1524, gender, \"Gender\")\ntab_age       &lt;- create_tab(vacc_1524, age_3group, \"Age group\")\ntab_marital   &lt;- create_tab(vacc_1524, marital_2group, \"Marital status·µá\")\ntab_year      &lt;- create_tab(vacc_1524, year_3group, \"Year group\")\ntab_quarter   &lt;- create_tab(vacc_1524, vacc_quarter, \"Quarter\")\n\n# Race group from respiratory-only subset (denominator = respiratory group only)\ntab_race      &lt;- create_tab(respiratory_vaccines, race_grouped, \"Race group\")\n\n# --- Combine all tables ---\ntab_combined &lt;- bind_rows(\n  tab_gender, tab_age, tab_marital,\n  tab_year, tab_quarter, tab_race\n)\n\n# --- Calculate and format column percentages ---\ntab_combined &lt;- tab_combined %&gt;%\n  group_by(Category) %&gt;%\n  mutate(\n    use_col = TRUE,\n    Total_Resp = sum(`Respiratory vaccines`[Label != \"Unknown\"], na.rm = TRUE),\n    Total_Child = sum(`Childhood vaccines`[Label != \"Unknown\"], na.rm = TRUE),\n    Total_Other = sum(Other[Label != \"Unknown\"], na.rm = TRUE),\n    \n    Resp_prop = ifelse(Label != \"Unknown\", round(100 * `Respiratory vaccines` / Total_Resp, 1), NA),\n    Child_prop = ifelse(Label != \"Unknown\", round(100 * `Childhood vaccines` / Total_Child, 1), NA),\n    Other_prop = ifelse(Label != \"Unknown\", round(100 * Other / Total_Other, 1), NA),\n    \n    Respiratory = ifelse(is.na(Resp_prop),\n                         paste0(comma(`Respiratory vaccines`)),\n                         paste0(comma(`Respiratory vaccines`), \" (\", Resp_prop, \")\")),\n    Childhood = ifelse(is.na(Child_prop),\n                       paste0(comma(`Childhood vaccines`)),\n                       paste0(comma(`Childhood vaccines`), \" (\", Child_prop, \")\")),\n    Other_grp = ifelse(is.na(Other_prop),\n                       paste0(comma(Other)),\n                       paste0(comma(Other), \" (\", Other_prop, \")\"))\n  ) %&gt;%\n  ungroup()\n\n# --- Format labels and rows ---\ntab_combined &lt;- tab_combined %&gt;%\n  mutate(\n    Label = ifelse(Label == \"Other\", \"Other·∂ú\", Label),\n    Respiratory = ifelse(Label == \"Unknown\" & `Respiratory vaccines` == 0, \"\", Respiratory),\n    Childhood   = ifelse(Label == \"Unknown\" & `Childhood vaccines` == 0, \"\", Childhood),\n    Other_grp   = ifelse(Label == \"Unknown\" & Other == 0, \"\", Other_grp)\n  ) %&gt;%\n  group_by(Category) %&gt;%\n  mutate(Category = ifelse(row_number() == 1, Category, \"\")) %&gt;%\n  ungroup() %&gt;%\n  select(Category, Label, Respiratory, Childhood, Other_grp)\n\n# --- Prepare column Ns for header ---\ntotals &lt;- table(vacc_1524$vacc_group3)\ntotal_resp &lt;- totals[\"Respiratory vaccines\"]\ntotal_child &lt;- totals[\"Childhood vaccines\"]\ntotal_other &lt;- totals[\"Other\"]\n\n# --- Build Flextable ---\ntable_vacc_summary &lt;- flextable(tab_combined) %&gt;%\n  set_header_labels(\n    Category = \"Variable type\",\n    Label = \"Values\",\n    Respiratory = \"Number (%)·µÉ\",\n    Childhood = \"Number (%)·µÉ\",\n    Other_grp = \"Number (%)·µÉ\"\n  ) %&gt;%\n  add_header_row(\n    values = c(\"\", \"\",\n               paste0(\"Respiratory vaccines (N = \", format(total_resp, big.mark = \",\"), \")\"),\n               paste0(\"Childhood vaccines (N = \", format(total_child, big.mark = \",\"), \")\"),\n               paste0(\"Other (N = \", format(total_other, big.mark = \",\"), \")\")),\n    colwidths = c(1, 1, 1, 1, 1),\n    top = TRUE\n  ) %&gt;%\n  add_header_row(\n    values = c(\"Description\", \"Vaccination uptake\"),\n    colwidths = c(2, 3),\n    top = TRUE\n  ) %&gt;%\n  theme_box() %&gt;%\n  set_table_properties(layout = \"autofit\", width = 1) %&gt;%\n  width(j = 1, width = 1.5) %&gt;%\n  width(j = 2, width = 2.5) %&gt;%\n  width(j = 3:5, width = 1.5) %&gt;%\n  align(align = \"justify\", part = \"all\") %&gt;%\n  border_remove() %&gt;%\n  border(part = \"header\", i = 1, border.top = fp_border(color = \"black\", width = 1)) %&gt;%\n  border(part = \"header\", i = 3, border.bottom = fp_border(color = \"black\", width = 1)) %&gt;%\n  border_inner_h(part = \"header\", border = fp_border(color = \"black\", width = 0.8)) %&gt;%\n  border_inner_h(part = \"body\", border = fp_border(color = \"black\", width = 0.8)) %&gt;%\n  border(part = \"body\", i = nrow(tab_combined), border.bottom = fp_border(color = \"black\", width = 1)) %&gt;%\n  set_caption(as_paragraph(as_chunk(\n    \"Table xx: Column-percentage summary of vaccination uptake across all demographic variables, 2015‚Äì2024.\",\n    props = fp_text(font.size = 12, font.family = \"Times New Roman\", bold = FALSE)\n  ))) %&gt;%\n  add_footer_lines(values = c(\n    \"·µÉ Vaccination proportions were calculated using column percentages. Race group used respiratory vaccine subset only.\",\n    \"·µá Marital status was grouped into partnered (married) and non-partnered (single, divorced, widowed).\",\n    \"·∂ú 'Other' race includes native or other less represented racial identities.\"\n  )) %&gt;%\n  fontsize(part = \"header\", size = 12) %&gt;%\n  fontsize(part = \"body\", size = 11) %&gt;%\n  fontsize(part = \"footer\", size = 10) %&gt;%\n  font(part = \"all\", fontname = \"Times New Roman\") %&gt;%\n  color(part = \"header\", color = \"white\") %&gt;%\n  bg(part = \"header\", bg = \"#000000\") %&gt;%\n  bg(j = 1:5, i = seq(2, nrow(tab_combined), 2), bg = \"white\") %&gt;%\n  bold(j = 1, part = \"body\")\n\n# --- Display final table ---\ntable_vacc_summary\n\nDescriptionVaccination uptakeRespiratory vaccines (N = 955)Childhood vaccines (N = 472)Other (N = 126)Variable typeValuesNumber (%)·µÉNumber (%)·µÉNumber (%)·µÉGenderFemale511 (53.5)233 (49.4)54 (42.9)Male444 (46.5)239 (50.6)72 (57.1)Age group&lt;25332 (34.8)337 (71.4)90 (71.4)25-3498 (10.3)51 (10.8)0 (0)35+525 (55)84 (17.8)36 (28.6)Marital status·µáNot partnered286 (49.7)48 (44.9)18 (50)Partnered289 (50.3)59 (55.1)18 (50)Unknown38036590Year group‚â§2020483 (50.6)311 (65.9)84 (66.7)2021-2022311 (32.6)59 (12.5)13 (10.3)2023+161 (16.9)102 (21.6)29 (23)Quarter1253 (26.5)120 (25.4)30 (23.8)2220 (23)117 (24.8)39 (31)3295 (30.9)139 (29.4)33 (26.2)4187 (19.6)96 (20.3)24 (19)Race groupAsian69 (7.8)NANAOther·∂ú28 (3.2)NANAWhite788 (89)NANAUnknown70·µÉ Vaccination proportions were calculated using column percentages. Race group used respiratory vaccine subset only.·µá Marital status was grouped into partnered (married) and non-partnered (single, divorced, widowed).·∂ú 'Other' race includes native or other less represented racial identities.\n\n# --- Cleanup temporary objects ---\nrm(\n  tab_gender, tab_age, tab_marital, tab_year, tab_quarter, tab_race,\n  tab_combined, create_tab, totals, total_resp, total_child, total_other,\n  respiratory_vaccines\n)"
  },
  {
    "objectID": "Post_Blog/Table_automation_Ideas/index.html#both-row-wise-and-column-wise-tables",
    "href": "Post_Blog/Table_automation_Ideas/index.html#both-row-wise-and-column-wise-tables",
    "title": "Automating Publication-Ready Tables in R",
    "section": "",
    "text": "This table presents both row and column percentages for vaccination uptake:\n\nRow percentages show how each category (e.g., age group, gender) distributes across vaccine types.\nColumn percentages are applied only to the race group, highlighting the demographic makeup within the respiratory vaccine recipients.\n\nThis format helps answer questions like: - ‚ÄúWhat proportion of women in each age group received respiratory vaccines?‚Äù (row %) - ‚ÄúWhat proportion of respiratory vaccine recipients were Aboriginal?‚Äù (column %)\nUnknown values are included but excluded from percentage calculations to avoid distorting group totals.\n\n# ------------12. Both Row wise and Column wise Tables -------------------------------------------\n\n# ....................................................................................................\n# Prepare Vaccination Uptake Table (Row and Column Percentages)\n# ....................................................................................................\n\n# --- Step 1: Prepare data for table formatting ---\n# Convert grouping variables to character for cleaner label handling\nvacc_1524 &lt;- vacc_1524 %&gt;%\n  mutate(across(c(gender, age_3group, marital_2group, year_3group, vacc_quarter, race_grouped), as.character))\n\n# Subset data for Respiratory vaccines to calculate column-based percentages (used for race)\nrespiratory_vaccines &lt;- vacc_1524 %&gt;%\n  filter(vacc_group3 == \"Respiratory vaccines\") %&gt;%\n  mutate(across(race_grouped, as.character))\n\n# --- Step 2: Create table-building function ---\n# This function tabulates counts by category and optionally adds missing (Unknown) values\ncreate_tab &lt;- function(data, var, label, use_col_percentage = FALSE) {\n  tab_main &lt;- data %&gt;%\n    filter(!is.na({{ var }})) %&gt;%\n    tabyl({{ var }}, vacc_group3) %&gt;%\n    mutate(Category = label, .before = 1) %&gt;%\n    rename(Label = {{ var }}) %&gt;%\n    mutate(Label = as.character(Label))\n  \n  # Add a row for missing/unknown if needed\n  na_count &lt;- sum(is.na(pull(data, {{ var }})))\n  if (na_count &gt; 0) {\n    na_row &lt;- tibble(\n      Category = label,\n      Label = \"Unknown\",\n      `Respiratory vaccines` = sum(data$vacc_group3 == \"Respiratory vaccines\" & is.na(pull(data, {{ var }})), na.rm = TRUE),\n      `Childhood vaccines` = sum(data$vacc_group3 == \"Childhood vaccines\" & is.na(pull(data, {{ var }})), na.rm = TRUE),\n      Other = sum(data$vacc_group3 == \"Other\" & is.na(pull(data, {{ var }})), na.rm = TRUE)\n    )\n    tab_combined &lt;- bind_rows(tab_main, na_row)\n  } else {\n    tab_combined &lt;- tab_main\n  }\n  \n  tab_combined %&gt;%\n    mutate(use_col_percentage = use_col_percentage)\n}\n\n# --- Step 3: Generate frequency tables for each variable ---\ntab_gender    &lt;- create_tab(vacc_1524, gender, \"Gender\")\ntab_age       &lt;- create_tab(vacc_1524, age_3group, \"Age group\")\ntab_marital   &lt;- create_tab(vacc_1524, marital_2group, \"Marital status·µá\")\ntab_year      &lt;- create_tab(vacc_1524, year_3group, \"Year group\")\ntab_quarter   &lt;- create_tab(vacc_1524, vacc_quarter, \"Quarter\")\ntab_race      &lt;- create_tab(respiratory_vaccines, race_grouped, \"Race group\", use_col_percentage = TRUE)\n\n# --- Step 4: Combine all tables ---\ntab_combined &lt;- bind_rows(\n  tab_gender, tab_age, tab_marital,\n  tab_year, tab_quarter, tab_race\n)\n\n# --- Step 5: Calculate percentages and formatted string outputs ---\ntab_combined &lt;- tab_combined %&gt;%\n  group_by(Category) %&gt;%\n  mutate(\n    use_col = first(use_col_percentage),\n    \n    # Exclude \"Unknown\" when calculating column totals to ensure proportions sum to 100\n    Total_Resp = ifelse(use_col, sum(`Respiratory vaccines`[Label != \"Unknown\"], na.rm = TRUE),\n                        `Respiratory vaccines` + `Childhood vaccines` + Other),\n    Total_Child = ifelse(use_col, sum(`Childhood vaccines`[Label != \"Unknown\"], na.rm = TRUE),\n                         `Respiratory vaccines` + `Childhood vaccines` + Other),\n    Total_Other = ifelse(use_col, sum(Other[Label != \"Unknown\"], na.rm = TRUE),\n                         `Respiratory vaccines` + `Childhood vaccines` + Other),\n    \n    # Calculate proportions\n    Resp_prop = ifelse(Label != \"Unknown\", round(100 * `Respiratory vaccines` / Total_Resp, 1), NA),\n    Child_prop = ifelse(Label != \"Unknown\", round(100 * `Childhood vaccines` / Total_Child, 1), NA),\n    Other_prop = ifelse(Label != \"Unknown\", round(100 * Other / Total_Other, 1), NA),\n    \n    # Format numbers and percentages\n    Respiratory = ifelse(is.na(Resp_prop),\n                         paste0(comma(`Respiratory vaccines`)),\n                         paste0(comma(`Respiratory vaccines`), \" (\", Resp_prop, \")\")),\n    Childhood = ifelse(is.na(Child_prop),\n                       paste0(comma(`Childhood vaccines`)),\n                       paste0(comma(`Childhood vaccines`), \" (\", Child_prop, \")\")),\n    Other_grp = ifelse(is.na(Other_prop),\n                       paste0(comma(Other)),\n                       paste0(comma(Other), \" (\", Other_prop, \")\"))\n  ) %&gt;%\n  ungroup()\n\n# --- Step 6: Clean labels and fix formatting for final table ---\ntab_combined &lt;- tab_combined %&gt;%\n  mutate(\n    Label = ifelse(Label == \"Other\", \"Other·∂ú\", Label),\n    Respiratory = ifelse(Label == \"Unknown\" & `Respiratory vaccines` == 0, \"\", Respiratory),\n    Childhood   = ifelse(Label == \"Unknown\" & `Childhood vaccines` == 0, \"\", Childhood),\n    Other_grp   = ifelse(Label == \"Unknown\" & Other == 0, \"\", Other_grp)\n  ) %&gt;%\n  group_by(Category) %&gt;%\n  mutate(Category = ifelse(row_number() == 1, Category, \"\")) %&gt;%\n  ungroup() %&gt;%\n  select(Category, Label, Respiratory, Childhood, Other_grp)\n\n# --- Step 7: Calculate group totals for header ---\ntotals &lt;- table(vacc_1524$vacc_group3)\ntotal_resp &lt;- totals[\"Respiratory vaccines\"]\ntotal_child &lt;- totals[\"Childhood vaccines\"]\ntotal_other &lt;- totals[\"Other\"]\n\n# --- Step 8: Create styled summary table using flextable ---\ntable_vacc_summary &lt;- flextable(tab_combined) %&gt;%\n  set_header_labels(\n    Category = \"Variable type\",\n    Label = \"Values\",\n    Respiratory = \"Number (%)·µÉ\",\n    Childhood = \"Number (%)·µÉ\",\n    Other_grp = \"Number (%)·µÉ\"\n  ) %&gt;%\n  add_header_row(\n    values = c(\"\", \"\",\n               paste0(\"Respiratory vaccines (N = \", format(total_resp, big.mark = \",\"), \")\"),\n               paste0(\"Childhood vaccines (N = \", format(total_child, big.mark = \",\"), \")\"),\n               paste0(\"Other (N = \", format(total_other, big.mark = \",\"), \")\")),\n    colwidths = c(1, 1, 1, 1, 1),\n    top = TRUE\n  ) %&gt;%\n  add_header_row(\n    values = c(\"Description\", \"Vaccination uptake\"),\n    colwidths = c(2, 3),\n    top = TRUE\n  ) %&gt;%\n  theme_box() %&gt;%\n  set_table_properties(layout = \"autofit\", width = 1) %&gt;%\n  width(j = 1, width = 1.5) %&gt;%\n  width(j = 2, width = 2.5) %&gt;%\n  width(j = 3:5, width = 1.5) %&gt;%\n  align(align = \"justify\", part = \"all\") %&gt;%\n  border_remove() %&gt;%\n  border(part = \"header\", i = 1, border.top = fp_border(color = \"black\", width = 1)) %&gt;%\n  border(part = \"header\", i = 3, border.bottom = fp_border(color = \"black\", width = 1)) %&gt;%\n  border_inner_h(part = \"header\", border = fp_border(color = \"black\", width = 0.8)) %&gt;%\n  border_inner_h(part = \"body\", border = fp_border(color = \"black\", width = 0.8)) %&gt;%\n  border(part = \"body\", i = nrow(tab_combined), border.bottom = fp_border(color = \"black\", width = 1)) %&gt;%\n  set_caption(as_paragraph(as_chunk(\n    \"Table xx: Vaccination uptake by demographic, temporal, and race variables, 2015‚Äì2024.\",\n    props = fp_text(font.size = 12, font.family = \"Times New Roman\", bold = FALSE)\n  ))) %&gt;%\n  add_footer_lines(values = c(\n    \"·µÉ Vaccination proportions were calculated per row (row percentage) except for race group which used column percentages.\",\n    \"·µá Marital status was grouped into two: partnered for those married and non-partnered for those divorced, widowed or single.\",\n    \"·∂ú Other race refers to those who identify as native or other racial groups.\"\n  )) %&gt;%\n  fontsize(part = \"header\", size = 12) %&gt;%\n  fontsize(part = \"body\", size = 11) %&gt;%\n  fontsize(part = \"footer\", size = 10) %&gt;%\n  font(part = \"all\", fontname = \"Times New Roman\") %&gt;%\n  color(part = \"header\", color = \"white\") %&gt;%\n  bg(part = \"header\", bg = \"black\") %&gt;%\n  bg(j = 1:5, i = seq(2, nrow(tab_combined), 2), bg = \"white\") %&gt;%\n  bold(j = 1, part = \"body\")\n\n# --- Step 9: Display table ---\ntable_vacc_summary\n\nDescriptionVaccination uptakeRespiratory vaccines (N = 955)Childhood vaccines (N = 472)Other (N = 126)Variable typeValuesNumber (%)·µÉNumber (%)·µÉNumber (%)·µÉGenderFemale511 (64)233 (29.2)54 (6.8)Male444 (58.8)239 (31.7)72 (9.5)Age group&lt;25332 (43.7)337 (44.4)90 (11.9)25-3498 (65.8)51 (34.2)0 (0)35+525 (81.4)84 (13)36 (5.6)Marital status·µáNot partnered286 (81.2)48 (13.6)18 (5.1)Partnered289 (79)59 (16.1)18 (4.9)Unknown38036590Year group‚â§2020483 (55)311 (35.4)84 (9.6)2021-2022311 (81.2)59 (15.4)13 (3.4)2023+161 (55.1)102 (34.9)29 (9.9)Quarter1253 (62.8)120 (29.8)30 (7.4)2220 (58.5)117 (31.1)39 (10.4)3295 (63.2)139 (29.8)33 (7.1)4187 (60.9)96 (31.3)24 (7.8)Race groupAsian69 (7.8)NANAOther·∂ú28 (3.2)NANAWhite788 (89)NANAUnknown70·µÉ Vaccination proportions were calculated per row (row percentage) except for race group which used column percentages.·µá Marital status was grouped into two: partnered for those married and non-partnered for those divorced, widowed or single.·∂ú Other race refers to those who identify as native or other racial groups.\n\n# --- Step 10: Clean up temporary objects (optional) ---\nrm(\n  tab_gender, tab_age, tab_marital, tab_year, tab_quarter, tab_race,\n  tab_combined, create_tab, respiratory_vaccines,\n  totals, total_resp, total_child, total_other\n)"
  },
  {
    "objectID": "Post_Blog/Table_automation_Ideas/index.html#multiple-response-tables-rowwise-percentage",
    "href": "Post_Blog/Table_automation_Ideas/index.html#multiple-response-tables-rowwise-percentage",
    "title": "Automating Publication-Ready Tables in R",
    "section": "",
    "text": "Here we simulate multiple-response tables by combining summary outputs from different variables side-by-side.\nüìö What‚Äôs useful here?\n\nShows how people responded with combinations of vaccine types (e.g., Both, Influenza, or None), where both here refers vaccination of influenza and other vaccine types.\nüôå Applies to: Any analysis involving response overlaps (e.g., co-morbidity, multiple treatments, combined exposures).\n\n\n# ------------ 10. Mutiple Response Tables: via appending: Rowwise -------------------------------------------\n\n# .................. Create flextable summary by variable ..................\nprocess_variable &lt;- function(data, group_var, group_label) {\n  \n  # Base pattern: Both and No\n  df_base &lt;- data %&gt;%\n    group_by(across(all_of(group_var)), vacc_pattern) %&gt;%\n    summarise(count = n(), .groups = \"drop\") %&gt;%\n    group_by(across(all_of(group_var))) %&gt;%\n    mutate(total = sum(count),\n           proportion = round((count / total) * 100, 1)) %&gt;%\n    ungroup() %&gt;%\n    filter(vacc_pattern %in% c(\"Both\", \"No\")) %&gt;%\n    rename(value = !!sym(group_var)) %&gt;%\n    mutate(value = as.character(value))\n  \n  # Influenza \n  df_flu &lt;- data %&gt;%\n    filter(!is.na(!!sym(group_var))) %&gt;%\n    mutate(flu_yes = recode(flu_yes, \"Yes\" = \"Influenza\")) %&gt;%\n    group_by(across(all_of(group_var)), flu_yes) %&gt;%\n    summarise(count = n(), .groups = \"drop\") %&gt;%\n    group_by(across(all_of(group_var))) %&gt;%\n    mutate(total = sum(count),\n           proportion = round((count / total) * 100, 1)) %&gt;%\n    ungroup() %&gt;%\n    filter(flu_yes == \"Influenza\") %&gt;%\n    rename(vacc_pattern = flu_yes, value = !!sym(group_var)) %&gt;%\n    mutate(value = as.character(value))\n  \n  df_combined &lt;- bind_rows(df_base, df_flu) %&gt;%\n    mutate(vacc_pattern = factor(vacc_pattern, levels = c(\"Both\", \"Influenza\", \"No\")))\n  \n  df_wide &lt;- df_combined %&gt;%\n    select(value, vacc_pattern, count, proportion) %&gt;%\n    pivot_wider(\n      names_from = vacc_pattern,\n      values_from = c(count, proportion),\n      values_fn = list(count = sum, proportion = sum),\n      values_fill = list(count = 0, proportion = 0)\n    ) %&gt;%\n    mutate(\n      Both = paste0(comma(`count_Both`), \" (\", `proportion_Both`, \")\"),\n      `Influenza only` = paste0(comma(`count_Influenza`), \" (\", `proportion_Influenza`, \")\"),\n      No = paste0(comma(`count_No`), \" (\", `proportion_No`, \")\"),\n      Variable = group_label\n    ) %&gt;%\n    select(value, Both, `Influenza only`, No, Variable)\n  \n  return(df_wide)\n}\n\n# Run for selected grouping variables\ndf_year &lt;- process_variable(vacc_1524, \"vacc_service_year\", \"Service year\")\ndf_age &lt;- process_variable(vacc_1524, \"age_group\", \"Age group\")\n\n# Combine and format for flextable\ndf_combined_long &lt;- bind_rows(df_year, df_age) %&gt;%\n  rename(Value = value) %&gt;%\n  select(Variable, Value, Both, `Influenza only`, No) %&gt;%\n  group_by(Variable) %&gt;%\n  mutate(Variable = ifelse(row_number() == 1, Variable, \"\")) %&gt;%\n  ungroup()\n\n# Create flextable\nfinal_table &lt;- flextable(df_combined_long) %&gt;%\n  set_header_labels(\n    Variable = \"Variable\",\n    Value = \"Value\",\n    Both = \"Both (%)\",\n    `Influenza only` = \"Influenza (%)\",\n    No = \"No (%)\"\n  ) %&gt;%\n  add_header_row(\n    values = c(\" \", \" \", \"Vaccination pattern·µÉ\"),\n    colwidths = c(1, 1, 3)\n  ) %&gt;%\n  align(align = \"justify\", part = \"all\") %&gt;%\n  bold(part = \"header\") %&gt;%\n  bold(i = 1, part = \"body\", j = \"Variable\") %&gt;%\n border_remove() %&gt;%\n  border_inner_h(border = fp_border(color = \"black\", width = 1)) %&gt;%\n  \n  add_header_lines(values = \"Table xx: Vaccination uptake pattern, 2015‚Äì2024.\") %&gt;%\n  add_footer_lines(values = c(\n    \"·µÉ The pattern reflects those with influenza vaccination history, influenza, or both.\"\n  ))\n\n# Display table\nfinal_table\n\nTable xx: Vaccination uptake pattern, 2015‚Äì2024.  Vaccination pattern·µÉVariableValueBoth (%)Influenza (%)No (%)Service year20158 (5.2)27 (17.6)110 (71.9)201652 (37.4)81 (58.3)36 (25.9)201741 (29.9)74 (54)34 (24.8)201850 (33.1)73 (48.3)47 (31.1)201953 (32.9)85 (52.8)46 (28.6)202053 (38.7)82 (59.9)26 (19)202127 (10.3)109 (41.4)96 (36.5)202239 (32.5)57 (47.5)16 (13.3)202357 (33.5)86 (50.6)56 (32.9)202446 (37.7)73 (59.8)23 (18.9)Age group0-1999 (15.4)214 (33.3)308 (48)20-2953 (24.1)110 (50)51 (23.2)30-3911 (16.7)28 (42.4)24 (36.4)40-4964 (34.2)108 (57.8)40 (21.4)50-5950 (34.7)85 (59)25 (17.4)60-6992 (54.1)120 (70.6)24 (14.1)70+57 (46)82 (66.1)18 (14.5)·µÉ The pattern reflects those with influenza vaccination history, influenza, or both.\n\n# .................. Clean up ..................\nrm(df_year, df_age, df_combined_long, process_variable, final_table)"
  },
  {
    "objectID": "Post_Blog/Table_automation_Ideas/index.html#multiple-response-tables-columnwise-percentages",
    "href": "Post_Blog/Table_automation_Ideas/index.html#multiple-response-tables-columnwise-percentages",
    "title": "Automating Publication-Ready Tables in R",
    "section": "",
    "text": "Similar to the rowwise example, this version presents the column percentages of multiple responses.\nüßæ Key advantage: Allows side-by-side comparison of proportions within each vaccine group across multiple demographics.\nüíº Common in: Survey analysis, patient preference studies, behavioral research.\n\n# ------------ 11. Mutiple Response Tables: via appending: Columnwise -------------------------------------------\n\n# .................. Convert grouping vars to character ..................\nvacc_1524 &lt;- vacc_1524 %&gt;%\n  mutate(across(c(age_group, gender, marital_status,\n                  vacc_service_year, vacc_quarter, vacc_weekday), as.character))\n\n# .................. Table generation function (column-wise %) ..................\ncreate_tab &lt;- function(data, var, label) {\n  tab_main &lt;- data %&gt;%\n    filter(!is.na({{ var }})) %&gt;%\n    tabyl({{ var }}, vacc_group3) %&gt;%\n    mutate(Category = label, .before = 1) %&gt;%\n    rename(Label = {{ var }}) %&gt;%\n    mutate(Label = as.character(Label))\n  \n  na_count &lt;- sum(is.na(pull(data, {{ var }})))\n  \n  if (na_count &gt; 0) {\n    missing_row &lt;- tibble(\n      Category = label,\n      Label = \"Missing\",\n      `Respiratory vaccines` = sum(data$vacc_group3 == \"Respiratory vaccines\" & is.na(pull(data, {{ var }})), na.rm = TRUE),\n      `Childhood vaccines` = sum(data$vacc_group3 == \"Childhood vaccines\" & is.na(pull(data, {{ var }})), na.rm = TRUE),\n      Other = sum(data$vacc_group3 == \"Other\" & is.na(pull(data, {{ var }})), na.rm = TRUE)\n    )\n    tab_final &lt;- bind_rows(tab_main, missing_row)\n  } else {\n    tab_final &lt;- tab_main\n  }\n  \n  return(tab_final)\n}\n\n# .................. Create summary tables ..................\ntab_age            &lt;- create_tab(vacc_1524, age_group, \"Age\")\ntab_sex            &lt;- create_tab(vacc_1524, gender, \"Gender\")\ntab_marital_status &lt;- create_tab(vacc_1524, marital_status, \"Marital status\")\ntab_year           &lt;- create_tab(vacc_1524, vacc_service_year, \"Year\")\ntab_quarter        &lt;- create_tab(vacc_1524, vacc_quarter, \"Quarter\")\ntab_weekday        &lt;- create_tab(vacc_1524, vacc_weekday, \"Weekday\")\n\n# .................. Combine all tables ..................\ntab_combined &lt;- bind_rows(tab_sex, tab_age, tab_marital_status, tab_year, tab_quarter, tab_weekday)\n\n# .................. Calculate column-wise percentages within each Category group ..................\ntab_combined &lt;- tab_combined %&gt;%\n  group_by(Category) %&gt;%\n  mutate(\n    Total_Resp = sum(`Respiratory vaccines`[Label != \"Missing\"], na.rm = TRUE),\n    Total_Child = sum(`Childhood vaccines`[Label != \"Missing\"], na.rm = TRUE),\n    Total_Other = sum(Other[Label != \"Missing\"], na.rm = TRUE),\n    \n    is_missing = trimws(tolower(Label)) == \"missing\",\n    \n    Respiratory = ifelse(is_missing,\n                         comma(`Respiratory vaccines`),\n                         paste0(comma(`Respiratory vaccines`), \" (\", round(100 * `Respiratory vaccines` / Total_Resp, 1), \"%)\")),\n    \n    Childhood = ifelse(is_missing,\n                       comma(`Childhood vaccines`),\n                       paste0(comma(`Childhood vaccines`), \" (\", round(100 * `Childhood vaccines` / Total_Child, 1), \"%)\")),\n    \n    Other_grp = ifelse(is_missing,\n                       comma(Other),\n                       paste0(comma(Other), \" (\", round(100 * Other / Total_Other, 1), \"%)\"))\n  ) %&gt;%\n  ungroup() %&gt;%\n  select(Category, Label, Respiratory, Childhood, Other_grp)\n\n# .................. Show Category only once per group ..................\ntab_combined &lt;- tab_combined %&gt;%\n  group_by(Category) %&gt;%\n  mutate(Category = ifelse(row_number() == 1, Category, \"\")) %&gt;%\n  ungroup()\n\n# .................. Get total counts per vaccine group ..................\ntotals &lt;- vacc_1524 %&gt;%\n  count(vacc_group3) %&gt;%\n  deframe()\n\n# .................. Create flextable ..................\nft_vacc_summary &lt;- tab_combined %&gt;%\n  flextable() %&gt;%\n  set_header_labels(\n    Category = \"Variable type\",\n    Label = \"Values\",\n    Respiratory = \"Number (%)·µÉ\",\n    Childhood = \"Number (%)·µÉ\",\n    Other_grp = \"Number (%)·µÉ\"\n  ) %&gt;%\n  add_header_row(\n    values = c(\n      \"\", \"\",\n      paste0(\"Respiratory vaccines (N = \", format(totals[\"Respiratory vaccines\"], big.mark = \",\"), \")\"),\n      paste0(\"Childhood vaccines (N = \", format(totals[\"Childhood vaccines\"], big.mark = \",\"), \")\"),\n      paste0(\"Other (N = \", format(totals[\"Other\"], big.mark = \",\"), \")\")\n    )\n  ) %&gt;%\n  add_header_row(\n    values = c(\"Description\", \"Vaccination uptake\"),\n    colwidths = c(2, 3)\n  ) %&gt;%\n  theme_box() %&gt;%\n  set_table_properties(layout = \"autofit\", width = 1) %&gt;%\n  width(j = 1, width = 1.5) %&gt;%\n  width(j = 2, width = 2.5) %&gt;%\n  width(j = 3:5, width = 1.5) %&gt;%\n  align(align = \"justify\", part = \"all\") %&gt;%\n  border_remove() %&gt;%\n  border_inner_h(border = fp_border(color = \"black\", width = 1)) %&gt;%\n  \n  set_caption(\"Table: Vaccination uptake (column percentage) across service year, quarter, and weekday\") %&gt;%\n  footnote(i = 1, \n           value = as_paragraph(\"Vaccination proportions were calculated column-wise (i.e., within each vaccine group).\"),\n           ref_symbols = \"·µÉ\", \n           part = \"header\")\n\n# .................. Show the table ..................\nft_vacc_summary\n\nDescription·µÉVaccination uptake·µÉRespiratory vaccines (N = 955)Childhood vaccines (N = 472)Other (N = 126)Variable typeValuesNumber (%)·µÉNumber (%)·µÉNumber (%)·µÉGenderFemale511 (53.5%)233 (49.4%)54 (42.9%)Male444 (46.5%)239 (50.6%)72 (57.1%)Age0-19250 (26.2%)302 (64%)90 (71.4%)20-29150 (15.7%)70 (14.8%)0 (0%)30-3947 (4.9%)19 (4%)0 (0%)40-49142 (14.9%)45 (9.5%)0 (0%)50-59112 (11.7%)14 (3%)18 (14.3%)60-69149 (15.6%)13 (2.8%)8 (6.3%)70+105 (11%)9 (1.9%)10 (7.9%)Marital statusDivorced136 (23.7%)15 (14%)12 (33.3%)Married289 (50.3%)59 (55.1%)18 (50%)Single/widowed150 (26.1%)33 (30.8%)6 (16.7%)Missing38036590Year201578 (8.2%)56 (11.9%)19 (15.1%)201684 (8.8%)47 (10%)8 (6.3%)201775 (7.9%)52 (11%)10 (7.9%)201881 (8.5%)52 (11%)18 (14.3%)201983 (8.7%)60 (12.7%)18 (14.3%)202082 (8.6%)44 (9.3%)11 (8.7%)2021223 (23.4%)34 (7.2%)6 (4.8%)202288 (9.2%)25 (5.3%)7 (5.6%)202387 (9.1%)63 (13.3%)20 (15.9%)202474 (7.7%)39 (8.3%)9 (7.1%)Quarter1253 (26.5%)120 (25.4%)30 (23.8%)2220 (23%)117 (24.8%)39 (31%)3295 (30.9%)139 (29.4%)33 (26.2%)4187 (19.6%)96 (20.3%)24 (19%)WeekdayFriday141 (14.8%)31 (6.6%)8 (6.3%)Monday114 (11.9%)49 (10.4%)14 (11.1%)Saturday160 (16.8%)81 (17.2%)12 (9.5%)Sunday156 (16.3%)100 (21.2%)21 (16.7%)Thursday167 (17.5%)66 (14%)20 (15.9%)Tuesday108 (11.3%)43 (9.1%)14 (11.1%)Wednesday109 (11.4%)102 (21.6%)37 (29.4%)·µÉVaccination proportions were calculated column-wise (i.e., within each vaccine group).\n\n# .................. Clean up environment ..................\nrm(tab_age, tab_sex, tab_marital_status, tab_year, tab_quarter, tab_weekday,\n   tab_combined, ft_vacc_summary, totals, create_tab)"
  },
  {
    "objectID": "Post_Blog/Table_automation_Ideas/index.html#interactive-and-print-ready-table",
    "href": "Post_Blog/Table_automation_Ideas/index.html#interactive-and-print-ready-table",
    "title": "Automating Publication-Ready Tables in R",
    "section": "",
    "text": "Finally, we build an interactive table using the DT package with export options (CSV, Excel, Print).\nüñ±Ô∏è Why use this:\n\nOffers flexibility for exploratory review or end-user interaction.\nEnables printing or downloading filtered subsets.\n\nüåç Perfect for: Dashboards, websites, or when publishing to HTML via Quarto/GitHub.\n\n# ------------ 12. Interactive and Print ready: Table  -------------------------------------------\n\n\n# .................. Convert grouping vars to character ..................\nvacc_1524 &lt;- vacc_1524 %&gt;%\n  mutate(across(c(age_group, gender, marital_status,\n                  vacc_service_year, vacc_quarter, vacc_weekday), as.character))\n\n# .................. Table generation function with Missing ..................\ncreate_tab &lt;- function(data, var, label) {\n  tab_main &lt;- data %&gt;%\n    filter(!is.na({{ var }})) %&gt;%\n    tabyl({{ var }}, vacc_group3) %&gt;%\n    mutate(Category = label, .before = 1) %&gt;%\n    rename(Label = {{ var }}) %&gt;%\n    mutate(Label = as.character(Label))\n  \n  na_count &lt;- sum(is.na(pull(data, {{ var }})))\n  \n  if (na_count &gt; 0) {\n    missing_row &lt;- tibble(\n      Category = label,\n      Label = \"Missing\",\n      `Respiratory vaccines` = sum(data$vacc_group3 == \"Respiratory vaccines\" & is.na(pull(data, {{ var }})), na.rm = TRUE),\n      `Childhood vaccines` = sum(data$vacc_group3 == \"Childhood vaccines\" & is.na(pull(data, {{ var }})), na.rm = TRUE),\n      Other = sum(data$vacc_group3 == \"Other\" & is.na(pull(data, {{ var }})), na.rm = TRUE)\n    )\n    tab_final &lt;- bind_rows(tab_main, missing_row)\n  } else {\n    tab_final &lt;- tab_main\n  }\n  \n  return(tab_final)\n}\n\n# .................. Create summary tables ..................\ntab_age            &lt;- create_tab(vacc_1524, age_group, \"Age\")\ntab_sex            &lt;- create_tab(vacc_1524, gender, \"Gender\")\ntab_marital_status &lt;- create_tab(vacc_1524, marital_status, \"Marital status\")\ntab_year           &lt;- create_tab(vacc_1524, vacc_service_year, \"Year\")\ntab_quarter        &lt;- create_tab(vacc_1524, vacc_quarter, \"Quarter\")\ntab_weekday        &lt;- create_tab(vacc_1524, vacc_weekday, \"Weekday\")\n\n# .................. Combine all tables ..................\ntab_combined &lt;- bind_rows(tab_sex, tab_age, tab_marital_status, tab_year, tab_quarter, tab_weekday)\n\n# .................. Calculate row-wise percentages (skip for Missing) ..................\ntab_combined &lt;- tab_combined %&gt;%\n  rowwise() %&gt;%\n  mutate(\n    Total = sum(`Respiratory vaccines`, `Childhood vaccines`, Other, na.rm = TRUE),\n    is_missing = trimws(tolower(Label)) == \"missing\",\n    \n    Respiratory = ifelse(is_missing,\n                         comma(`Respiratory vaccines`),\n                         paste0(comma(`Respiratory vaccines`), \" (\", round(100 * `Respiratory vaccines` / Total, 1), \")\")),\n    \n    Childhood = ifelse(is_missing,\n                       comma(`Childhood vaccines`),\n                       paste0(comma(`Childhood vaccines`), \" (\", round(100 * `Childhood vaccines` / Total, 1), \")\")),\n    \n    Other_grp = ifelse(is_missing,\n                       comma(Other),\n                       paste0(comma(Other), \" (\", round(100 * Other / Total, 1), \")\"))\n  ) %&gt;%\n  ungroup() %&gt;%\n  select(Category, Label, Respiratory, Childhood, Other_grp)\n\n# .................. Show Category only once per group ..................\ntab_combined &lt;- tab_combined %&gt;%\n  group_by(Category) %&gt;%\n  mutate(Category = ifelse(row_number() == 1, Category, \"\")) %&gt;%\n  ungroup()\n\n# .................. Create interactive table with DT ..................\n\ndatatable(\n  tab_combined,\n  rownames = FALSE,\n  extensions = 'Buttons',\n  options = list(\n    dom = 'Bfrtip',\n    buttons = c('copy', 'csv', 'excel', 'pdf', 'print'),\n    pageLength = 25,\n    autoWidth = TRUE,\n    columnDefs = list(list(width = '200px', targets = c(0, 1)))\n  ),\n  caption = htmltools::tags$caption(\n    style = 'caption-side: top; font-size: 18px; font-family: \"Times New Roman\"; font-weight: bold;',\n    'Table: Vaccination uptake across service year, quarter, and weekday'\n  ),\n  class = 'stripe hover cell-border'\n)\n\n\n\n\n# .................. Clean up all new objects ..................\nrm(tab_age, tab_sex, tab_marital_status, tab_year, tab_quarter, tab_weekday,\n   tab_combined, create_tab)"
  },
  {
    "objectID": "Post_Blog/Data_Manipulation_and_Wrangling/index.html#part-v-descriptive-statistics-and-tabulation",
    "href": "Post_Blog/Data_Manipulation_and_Wrangling/index.html#part-v-descriptive-statistics-and-tabulation",
    "title": "Date Manipulation and Wrangling using R",
    "section": "",
    "text": "In data analysis, summarising and tabulating variables is often the first step before conducting modelling or drawing conclusions. Descriptive statistics reveal the central tendency, variability, distribution shape, and frequency patterns in your dataset.\nThis section provides an overview of the most commonly used R functions for summarising both numeric and categorical variables. These tools help detect outliers, missing data, or skewed distributions and are essential for generating publication-ready summary tables.\nüìö Further are available via:\n\nYouTube: AnalyticsHub\n\nGithub: Summary Tools Repository\n\n\nSome of the contents essential for this section are presented below.\nBasic Summary Statistics\nsummary(), mean(), median(), min(), max(), sd(), var(), range(), quantile(), IQR()\nDistribution Shape / Skewness: skewness(), kurtosis() Extended Descriptive Summaries: describe() ,stat.desc(), skim() Tabulation (Frequencies and Proportions)\ntable(), prop.table(), addmargins(), xtabs()\nTidy Summary and Tabulations\ntabyl(), adorn_percentages(), adorn_totals() ‚Äì From janitor\ncount(), group_by() + summarise() ‚Äì From dplyr\npivot_wider(), pivot_longer() ‚Äì From tidyr\nCross Tabulations: CrossTable() ‚Äì From gmodels\n\n\nThese functions are useful for summarising continuous variables such as age, vaccine cost, or time intervals:\n\nsummary() ‚Äì 5-number summary + mean\n\nmean(), median() ‚Äì Measures of central tendency\n\nsd(), var() ‚Äì Measures of spread\n\nmin(), max() ‚Äì Extremes\n\nrange() ‚Äì Min and max in one\n\nquantile() ‚Äì Percentiles (e.g., 25th, 75th)\nIQR() ‚Äì Interquartile range\n\n\n\n\n  Childhood Respiratory       Other \n        472         955         126 \n\n\n\nFemale   Male \n   798    755 \n\n\n\n# ....................................................\n# Basic Summary Statistics Using Base R\n# ....................................................\n\n# Select key numeric variables\nsummary_vars &lt;- vacc_1524 %&gt;% \n  select(age, base_cost, healthcare_expenses)\n\n# View summary() for a quick five-number summary + mean\nsummary(summary_vars)\n\n      age          base_cost   healthcare_expenses\n Min.   : 1.00   Min.   :136   Min.   :    527.5  \n 1st Qu.:12.00   1st Qu.:136   1st Qu.:  14478.2  \n Median :25.00   Median :136   Median :  56729.2  \n Mean   :32.42   Mean   :136   Mean   : 156656.2  \n 3rd Qu.:52.00   3rd Qu.:136   3rd Qu.: 195830.8  \n Max.   :97.00   Max.   :136   Max.   :1157946.9  \n\n# Individual statistics for 'age'\nmean(vacc_1524$age, na.rm = TRUE)             # Mean age\n\n[1] 32.41661\n\nmedian(vacc_1524$age, na.rm = TRUE)           # Median age\n\n[1] 25\n\nmin(vacc_1524$age, na.rm = TRUE)              # Minimum age\n\n[1] 1\n\nmax(vacc_1524$age, na.rm = TRUE)              # Maximum age\n\n[1] 97\n\nsd(vacc_1524$age, na.rm = TRUE)               # Standard deviation of age\n\n[1] 23.76926\n\nvar(vacc_1524$age, na.rm = TRUE)              # Variance of age\n\n[1] 564.9777\n\nrange(vacc_1524$age, na.rm = TRUE)            # Range: min and max\n\n[1]  1 97\n\nquantile(vacc_1524$age, probs = c(0.25, 0.5, 0.75), na.rm = TRUE)  # Quartiles\n\n25% 50% 75% \n 12  25  52 \n\nIQR(vacc_1524$age, na.rm = TRUE)              # Interquartile range\n\n[1] 40\n\n# ....................................................\n# Clean up temporary object\n# ....................................................\nrm(summary_vars)\n\n\n\n\nThese indicators describe the shape of a numeric variable‚Äôs distribution. They help identify when a variable is:\n\nSkewed (not symmetric)\nHeavy-tailed (high kurtosis)\n\nDistribution Shape: Skewness and Kurtosis\n\n\n\n\n\n\n\n\nValue Range\nSkewness\nKurtosis (Excess)\n\n\n\n\n‚âà 0\nSymmetrical\nMesokurtic (normal-tailed)\n\n\n¬±0.5\nApproximately symmetrical\nSlight deviation\n\n\n¬±0.5 ‚Äì ¬±1\nModerate skew\nModerate peakedness or flatness\n\n\n&gt; ¬±1\nHigh skew (strong asymmetry)\nSubstantial deviation from normality\n\n\n&gt; 0 (kurtosis - 3 &gt; 0)\n‚Äì\nLeptokurtic (peaked, heavy tails)\n\n\n&lt; 0 (kurtosis - 3 &lt; 0)\n‚Äì\nPlatykurtic (flat, light tails)\n\n\n\n\n# Ensure the 'moments' package is installed\nif (!requireNamespace(\"moments\", quietly = TRUE)) {install.packages(\"moments\")}\nlibrary(moments)\n\n\n# Calculate distribution shape statistics\nskewness(vacc_1524$age, na.rm = TRUE)     # Skewness: +ve = right-skewed, -ve = left-skewed\n\n[1] 0.5301022\n\nkurtosis(vacc_1524$age, na.rm = TRUE)     # Kurtosis: &gt;3 = heavy tails, &lt;3 = flat distribution\n\n[1] 2.059686\n\nkurtosis(vacc_1524$age, na.rm = TRUE) - 3  # Excess kurtosis\n\n[1] -0.940314\n\n# ....................................................\n# Histogram to Visualize Distribution Shape\n# ....................................................\nhist(vacc_1524$age, \n     main = \"Histogram of Age\",\n     xlab = \"Age (Years)\", \n     col = \"#69b3a2\", \n     border = \"white\")\n\n\n\n\n\n\n\n\n\n\n\n\nTo produce a comprehensive summary of all variables (especially helpful in surveys or health system datasets), use:\n\ndescribe() ‚Äì From Hmisc: includes labels, missing %, and stats\n\nstat.desc() ‚Äì From pastecs: full statistical description with skew/kurtosis\n\nskim() ‚Äì From skimr: summary with inline histograms and types\n\n\n\n# Install required packages if missing\npackages &lt;- c(\"Hmisc\", \"pastecs\", \"skimr\")\nfor (p in packages) {if (!requireNamespace(p, quietly = TRUE)) install.packages(p)}\n\n# Explicitly load the packages\nlibrary(Hmisc)     # for describe()\nlibrary(pastecs)   # for stat.desc()\nlibrary(skimr)     # for skim()\n\nrm (packages)\n\n\n# ------------------------------\n# Extended Descriptive Summaries\n# ------------------------------\n\n# Hmisc::describe() ‚Äì Detailed variable summary\ndescribe(vacc_1524[, c(\"age\", \"gender\", \"race\")])\n\nvacc_1524[, c(\"age\", \"gender\", \"race\")] \n\n 3  Variables      1553  Observations\n--------------------------------------------------------------------------------\nage \n       n  missing distinct     Info     Mean  pMedian      Gmd      .05 \n    1553        0       62    0.999    32.42       32    26.76      5.0 \n     .10      .25      .50      .75      .90      .95 \n     6.0     12.0     25.0     52.0     68.8     73.0 \n\nlowest :  1  2  5  6  7, highest: 76 78 80 85 97\n--------------------------------------------------------------------------------\ngender \n       n  missing distinct \n    1553        0        2 \n                        \nValue      Female   Male\nFrequency     798    755\nProportion  0.514  0.486\n--------------------------------------------------------------------------------\nrace \n       n  missing distinct \n    1553        0        5 \n                                             \nValue       asian  black native  other  white\nFrequency     111     94     13     29   1306\nProportion  0.071  0.061  0.008  0.019  0.841\n--------------------------------------------------------------------------------\n\n# pastecs::stat.desc() ‚Äì Full statistics with skewness/kurtosis\nstat.desc(vacc_1524$age)\n\n     nbr.val     nbr.null       nbr.na          min          max        range \n1.553000e+03 0.000000e+00 0.000000e+00 1.000000e+00 9.700000e+01 9.600000e+01 \n         sum       median         mean      SE.mean CI.mean.0.95          var \n5.034300e+04 2.500000e+01 3.241661e+01 6.031564e-01 1.183087e+00 5.649777e+02 \n     std.dev     coef.var \n2.376926e+01 7.332432e-01 \n\n# skimr::skim() ‚Äì Tidy summary with histograms and data types\nskim(vacc_1524[, c(\"age\", \"gender\", \"income\")])\n\n\nData summary\n\n\nName\nvacc_1524[, c(‚Äúage‚Äù, ‚Äúgen‚Ä¶\n\n\nNumber of rows\n1553\n\n\nNumber of columns\n3\n\n\n_______________________\n\n\n\nColumn type frequency:\n\n\n\nfactor\n1\n\n\nnumeric\n2\n\n\n________________________\n\n\n\nGroup variables\nNone\n\n\n\nVariable type: factor\n\n\n\n\n\n\n\n\n\n\n\nskim_variable\nn_missing\ncomplete_rate\nordered\nn_unique\ntop_counts\n\n\n\n\ngender\n0\n1\nFALSE\n2\nFem: 798, Mal: 755\n\n\n\nVariable type: numeric\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nskim_variable\nn_missing\ncomplete_rate\nmean\nsd\np0\np25\np50\np75\np100\nhist\n\n\n\n\nage\n0\n1\n32.42\n23.77\n1\n12\n25\n52\n97\n‚ñá‚ñÉ‚ñÉ‚ñÉ‚ñÅ\n\n\nincome\n0\n1\n108887.58\n139702.07\n7361\n35860\n75767\n124775\n816851\n‚ñá‚ñÅ‚ñÅ‚ñÅ‚ñÅ\n\n\n\n\n\n\n\n\nUsed for categorical variables like gender, race, or vaccine group:\n\ntable() ‚Äì Basic frequency counts\n\nprop.table() ‚Äì Row/column proportions\n\naddmargins() ‚Äì Adds totals to tables\n\nxtabs() ‚Äì Cross-tabulation formula interface\n\n\n\n# --------------------------------------------\n# üîπ Categorical Variable Summary \n# --------------------------------------------\n\n# Basic frequency counts for individual vaccine types\ntable(vacc_1524$vaccine_group)\n\n\n          COVID-19          DTP group          Hepatitis                Hib \n               144                147                111                 32 \n               HPV          Influenza                IPV      Meningococcal \n                59                811                 47                 50 \n               MMR Pneumococcal PCV13 Pneumococcal PPV23          Rotavirus \n                26                 52                  8                 21 \n         Varicella             Zoster \n                26                 19 \n\n# Frequency counts for grouped vaccine categories\ntable(vacc_1524$vacc_group3)\n\n\n  Childhood Respiratory       Other \n        472         955         126 \n\n# Proportion of grouped vaccine categories\nprop.table(table(vacc_1524$vacc_group3))  # Overall proportions\n\n\n  Childhood Respiratory       Other \n 0.30392788  0.61493883  0.08113329 \n\n# Frequency table with row/column totals added\naddmargins(table(vacc_1524$vacc_group3))\n\n\n  Childhood Respiratory       Other         Sum \n        472         955         126        1553 \n\n# Cross-tabulation between vaccine group and gender\nxtabs(~ vacc_group3 + gender, data = vacc_1524)\n\n             gender\nvacc_group3   Female Male\n  Childhood      233  239\n  Respiratory    511  444\n  Other           54   72\n\n\n\n\n\nModern workflows prefer tidy-format summaries using:\n\ntabyl() ‚Äì From janitor: clean frequency tables\n\nadorn_totals(), adorn_percentages() ‚Äì Add percentages and totals\n\ncount() ‚Äì From dplyr: group-level counts\n\ngroup_by() + summarise() ‚Äì Group-wise summary\npivot_wider(), pivot_longer() ‚Äì Reshape tables\n\nThe section below demonstrates tabulations using janitor::tabyl() and tidyverse functions for grouped summaries and table reshaping.\n\n# --------------------------------------------\n# üîπ Tabulation and Table Reshaping \n# --------------------------------------------\n\n# 1. Basic clean frequency table with janitor::tabyl()\nvacc_1524 %&gt;%\n  tabyl(vacc_group3)\n\n vacc_group3   n    percent\n   Childhood 472 0.30392788\n Respiratory 955 0.61493883\n       Other 126 0.08113329\n\n# 2. Add column percentages and total row\nvacc_1524 %&gt;%\n  tabyl(vacc_group3, gender) %&gt;%\n  adorn_percentages(\"col\") %&gt;%\n  adorn_totals(\"row\") %&gt;%\n  adorn_title(\"combined\")  # Cleaner column names\n\n vacc_group3/gender     Female       Male\n          Childhood 0.29197995 0.31655629\n        Respiratory 0.64035088 0.58807947\n              Other 0.06766917 0.09536424\n              Total 1.00000000 1.00000000\n\n# 3. Group-level count using dplyr::count()\nvacc_1524 %&gt;%\n  count(vacc_group3, gender)\n\n  vacc_group3 gender   n\n1   Childhood Female 233\n2   Childhood   Male 239\n3 Respiratory Female 511\n4 Respiratory   Male 444\n5       Other Female  54\n6       Other   Male  72\n\n# 4. Group-wise summary using group_by + summarise\nvacc_1524 %&gt;%\n  group_by(vacc_group3) %&gt;%\n  summarise(n = n(), .groups = \"drop\") %&gt;%\n  mutate(prop = n / sum(n))\n\n# A tibble: 3 √ó 3\n  vacc_group3     n   prop\n  &lt;fct&gt;       &lt;int&gt;  &lt;dbl&gt;\n1 Childhood     472 0.304 \n2 Respiratory   955 0.615 \n3 Other         126 0.0811\n\n# 5. Pivot table to wide format (e.g., for display or reporting)\nvacc_1524 %&gt;%\n  count(vacc_group3, gender) %&gt;%\n  pivot_wider(names_from = gender, values_from = n, values_fill = 0)\n\n# A tibble: 3 √ó 3\n  vacc_group3 Female  Male\n  &lt;fct&gt;        &lt;int&gt; &lt;int&gt;\n1 Childhood      233   239\n2 Respiratory    511   444\n3 Other           54    72\n\n# 6. Optional: Pivot longer to return to tidy format\nvacc_1524 %&gt;%\n  count(vacc_group3, gender) %&gt;%\n  pivot_wider(names_from = gender, values_from = n, values_fill = 0) %&gt;%\n  pivot_longer(-vacc_group3, names_to = \"gender\", values_to = \"count\")\n\n# A tibble: 6 √ó 3\n  vacc_group3 gender count\n  &lt;fct&gt;       &lt;chr&gt;  &lt;int&gt;\n1 Childhood   Female   233\n2 Childhood   Male     239\n3 Respiratory Female   511\n4 Respiratory Male     444\n5 Other       Female    54\n6 Other       Male      72\n\n\n\n\n\nUsed to explore the relationship between two or more categorical variables.\n\nCrossTable() ‚Äì From gmodels: produces detailed cross-tabs with row %, column %, and counts\n\n\n# Install and load the gmodels package for cross-tabulation\nif (!requireNamespace(\"gmodels\", quietly = TRUE)) {\n  install.packages(\"gmodels\")\n}\nlibrary(gmodels)\n\n\n# ------------------------------\n# Cross Tabulation Example\n# ------------------------------\n\n# Generate a contingency table between gender and vaccine group\nCrossTable(vacc_1524$vacc_group3, vacc_1524$gender,\n           prop.r = FALSE,     # Row proportions\n           prop.c = TRUE,     # Column proportions\n           prop.t = FALSE,    # Overall proportion (optional)\n           chisq = TRUE)      # Include chi-square test for independence\n\n\n \n   Cell Contents\n|-------------------------|\n|                       N |\n| Chi-square contribution |\n|           N / Col Total |\n|-------------------------|\n\n \nTotal Observations in Table:  1553 \n\n \n                      | vacc_1524$gender \nvacc_1524$vacc_group3 |    Female |      Male | Row Total | \n----------------------|-----------|-----------|-----------|\n            Childhood |       233 |       239 |       472 | \n                      |     0.375 |     0.396 |           | \n                      |     0.292 |     0.317 |           | \n----------------------|-----------|-----------|-----------|\n          Respiratory |       511 |       444 |       955 | \n                      |     0.838 |     0.886 |           | \n                      |     0.640 |     0.588 |           | \n----------------------|-----------|-----------|-----------|\n                Other |        54 |        72 |       126 | \n                      |     1.783 |     1.885 |           | \n                      |     0.068 |     0.095 |           | \n----------------------|-----------|-----------|-----------|\n         Column Total |       798 |       755 |      1553 | \n                      |     0.514 |     0.486 |           | \n----------------------|-----------|-----------|-----------|\n\n \nStatistics for All Table Factors\n\n\nPearson's Chi-squared test \n------------------------------------------------------------\nChi^2 =  6.162349     d.f. =  2     p =  0.04590531 \n\n\n \n\n\n\nüîπ Summary Table: Descriptive Statistics and Tabulation Functions\n\n\n\n\n\n\n\n\nTask\nFunction\nPackage\n\n\n\n\nBasic numeric summaries\nsummary(), mean(), sd(), IQR()\nbase\n\n\nPercentiles and range\nquantile(), range()\nbase\n\n\nSkewness / Kurtosis\nskewness(), kurtosis()\ne1071, moments\n\n\nExtended profiling\ndescribe(), stat.desc(), skim()\nHmisc, pastecs, skimr\n\n\nFrequency tables\ntable(), xtabs(), prop.table()\nbase\n\n\nClean tables (tidy)\ntabyl(), adorn_*(), count()\njanitor, dplyr\n\n\nGroup summaries\ngroup_by() + summarise()\ndplyr\n\n\nReshape for tables\npivot_wider(), pivot_longer()\ntidyr\n\n\nRich cross-tabulation\nCrossTable()\ngmodels\n\n\n\n\n\n\n\n\nwrite.csv(), write_xlsx(), saveRDS(), write_tsv()\nExporting interactive tables with DT::datatable()\nSaving and loading the entire R workspace (save.image(), load())"
  },
  {
    "objectID": "Post_Blog/Data_Manipulation_and_Wrangling/index.html#part-vi-data-visualization-with-ggplot2",
    "href": "Post_Blog/Data_Manipulation_and_Wrangling/index.html#part-vi-data-visualization-with-ggplot2",
    "title": "Date Manipulation and Wrangling using R",
    "section": "",
    "text": "Visualization Contents and Types Overview\n\nLayers: Theme, Coordinates, Facets, Statistics, Geometries, Aesthetics, Data\nChart Types: line, histogram, boxplot, bar, area, density, violin, dotplot, ECDF, scatter, bubble, QQ plot\nComparative & Multivariate: faceted plot, pair plot, heatmap, treemap, radar chart, ridgeline plot, forest plot\nGeospatial Visualization: choropleth map, point map, heatmap overlay\nStatistical Overlays: error bars, confidence intervals, regression lines, smoothers\nInteractive Visualization: scatter/line/bar (Plotly), interactive tables (DT), interactive maps (Leaflet), dashboards (Shiny, flexdashboard)\n\nEffective visualizations help uncover patterns, trends, and insights in data. In R, we commonly use the ggplot2 package for static plots and tools like plotly, DT, and leaflet for interactive dashboards and graphics.\nThe sections below summarize different types of visualizations and how they fit into analysis workflows.\n\n\n\nEvery ggplot chart is built using multiple composable layers: - Data: The dataset to visualize. - Aesthetics (aes()): Mappings between variables and visual elements (e.g., x, y, color). - Geometries (geom_*): Plot types (e.g., geom_line(), geom_bar()). - Statistics (stat_*): Summaries or transformations (e.g., stat_smooth()). - Facets: Create multiple plots by group (facet_wrap(), facet_grid()). - Coordinates: Set axis and aspect ratio (coord_cartesian(), coord_flip()). - Themes: Control overall appearance (e.g., theme_minimal(), theme_bw()).\n\n\n\n\n\n\n\n\n\n\n\nChart Type\nFunction\nUsed For\n\n\n\n\nLine Chart\ngeom_line()\nTrends over time\n\n\nHistogram\ngeom_histogram()\nDistribution of continuous variables\n\n\nBoxplot\ngeom_boxplot()\nDistribution & outliers\n\n\nBar Plot\ngeom_bar()\nCounts or categorical comparison\n\n\nArea Plot\ngeom_area()\nCumulative trends\n\n\nDensity Plot\ngeom_density()\nSmoothed distribution\n\n\nViolin Plot\ngeom_violin()\nCombination of boxplot + density\n\n\nDot Plot\ngeom_dotplot()\nCount-based plots\n\n\nECDF Plot\nstat_ecdf()\nCumulative distribution\n\n\nScatter Plot\ngeom_point()\nBivariate relationships\n\n\nBubble Plot\ngeom_point(aes(size = ...))\n3-variable comparison using size\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nVisual Type\nPurpose\n\n\n\n\nFaceted Plot (facet_wrap)\nCompare subgroups in separate panels\n\n\nPair Plot (GGally::ggpairs)\nExplore all pairwise relationships\n\n\nHeatmap (geom_tile, heatmap())\nShow intensity using color\n\n\nTreemap (treemapify)\nHierarchical categories and values\n\n\nRadar Chart (fmsb)\nCompare multivariate profiles\n\n\nRidgeline Plot (ggridges)\nDistribution comparison across groups\n\n\nForest Plot (forestplot, ggforestplot)\nConfidence intervals and effect sizes\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nMap Type\nFunction/Use\n\n\n\n\nChoropleth Map\nShow values by region (e.g., geom_sf(), tmap)\n\n\nPoint Map\nLocations with coordinates (e.g., geom_point(), leaflet::addMarkers)\n\n\nHeatmap Overlay\nDensity of spatial events (e.g., leaflet::addHeatmap())\n\n\n\n\n\n\n\n\nError bars: geom_errorbar() for confidence or SD intervals\nRegression lines: geom_smooth(method = \"lm\")\nTrend smoothing: geom_smooth() with method = \"loess\"\nLabeling: geom_text(), geom_label() to annotate plots\n\n\nThis section demonstrates how to visualize breast cancer screening and vaccination data. We‚Äôll walk through common chart types such as line plots, bar charts, boxplots, and faceted views. Each example is designed with annotations and descriptions to aid understanding.\n\n\n\n\nEach chart demonstrates how different ggplot2 components come together using real health datasets.\n\n# Install if not already installed\nif (!requireNamespace(\"treemapify\", quietly = TRUE)) {install.packages(\"treemapify\")}\nif (!requireNamespace(\"ggridges\", quietly = TRUE)) {install.packages(\"ggridges\")}\nif (!requireNamespace(\"gganimate\", quietly = TRUE)) install.packages(\"gganimate\")\nif (!requireNamespace(\"gifski\", quietly = TRUE)) install.packages(\"gifski\")\n\nlibrary(gganimate)\nlibrary(gifski)\nlibrary(ggridges)\nlibrary(dplyr)\nlibrary(ggplot2)\nlibrary(plotly)\nlibrary(treemapify)\nlibrary(stringr)  # for str_to_title()\nlibrary(tidyr)\n\n\n\n Date[1:1553], format: \"1994-02-06\" \"1994-02-06\" \"1994-02-06\" \"1994-02-06\" \"1994-02-06\" ...\n\n\n\n  1   2   5   6   7  10  11  12  13  14  15  16  17  18  19  20  21  23  24  25 \n 46  24  64  66  34 100  38  59  21  21  34  81  18  36  18  34  40  13  12  47 \n 27  28  29  30  33  34  36  37  38  40  41  42  43  44  45  46  47  48  49  50 \n 17  30   9  35   4   7   6   8   6  20  37  16   9  17  15  13   9  21  30  15 \n 51  52  53  55  56  58  60  61  62  63  64  65  68  69  71  73  74  76  78  80 \n 13  30  16  30  26  14  12  24  36  13  25  14  14  47  14  19  15  14  12  13 \n 85  97 \n 12  10 \n\n\n\n  0‚Äì9 10‚Äì19 20‚Äì29 30‚Äì49   50+ \n  234   426   202   253   438 \n\n\n\n2016 2017 2018 2019 \n 341  341  341  341 \n\n\nLine Chart ‚Äì Breast Cancer Screening Trends by Region in Australia\nThe example below shows a line chart illustrating trends in breast cancer screening rates across Australian states from 2016 to 2019.\n\nBreast cancer screening rates across most Australian states appeared relatively consistent from 2016 to 2018, with minor year-to-year variations.\nA notable decline in screening rates is evident after 2018 and particularly in 2019, coinciding with the early stages of the COVID-19 pandemic\n\nState-specific Observations:\n\nTasmania (Tas) consistently had the highest screening rate, around 60%, but showed a clear decline post-2018.\nThe Northern Territory (NT) had the lowest rates, around 40%, also experiencing a slight decline during this period.\nOther states (ACT, NSW, Qld, SA, Vic, WA) maintained relatively stable rates (around 55%) until 2018, after which a distinct downturn is noticeable, particularly in Western Australia (WA) and Victoria (Vic).\n\nImpact of COVID-19:\n\nThe observed decline in breast cancer screening from 2019 onwards aligns with the emergence of the COVID-19 pandemic, which disrupted routine healthcare services globally.\n\nThis analysis underscores the importance of maintaining consistent access to healthcare services, particularly preventive screenings, even during periods of significant healthcare disruption.\n\n# Visualizing changes in screening rates (50‚Äì74 years) over time by state\n\nbreast_cancer_data %&gt;%\n  group_by(state, year_4digit) %&gt;%  # group by state and year\n  summarise(mean_rate = mean(rate50_74, na.rm = TRUE), .groups = \"drop\") %&gt;%\n  ggplot(aes(x = year_4digit, y = mean_rate, color = state)) +  # map axes and color\n  geom_line(size = 1.2) +  # trend lines\n  geom_point(size = 2) +   # points for each year\n  labs(\n    title = \"Breast Cancer Screening Rates (50‚Äì74 yrs)\",  \n    subtitle = \"Aggregated by State and Year\",           \n    x = \"Year\", y = \"Screening Rate (%)\",  # Axis labels\n    color = \"State\"   # Legend title\n  ) +\n  \n  theme_minimal()  \n\nWarning: Using `size` aesthetic for lines was deprecated in ggplot2 3.4.0.\n‚Ñπ Please use `linewidth` instead.\n\n\nWarning: Removed 4 rows containing missing values or values outside the scale range\n(`geom_line()`).\n\n\nWarning: Removed 4 rows containing missing values or values outside the scale range\n(`geom_point()`).\n\n\n\n\n\n\n\n\n\nHistogram ‚Äì Distribution of Age\nDisplays the frequency of vaccinated individuals by age, with a density line overlay to visualize the distribution shape.\nThe example below shows a histogram illustrating the age distribution within our studied population. The distribution highlights a clear bimodal pattern, indicating two main age groups. The largest group comprises younger adults, predominantly around 20‚Äì30 years old, suggesting a significant representation of young adults. A smaller secondary group emerges around 55‚Äì65 years old, reflecting a noticeable segment of older adults. This pattern may indicate specific target groups or demographic characteristics relevant to the population from which the data was collected. Understanding these age clusters can help tailor appropriate health strategies, services, or interventions accordingly.\n\nvacc_1524 %&gt;%\n  ggplot(aes(x = age)) +\n  geom_histogram(aes(y = ..density..), binwidth = 5, fill = \"darkblue\", color = \"white\", alpha = 0.7) +\n  geom_density(color = \"red\", size = 1.2) +\n  labs(title = \"Age Distribution with Density Curve\", x = \"Age\", y = \"Density\") +\n  theme_minimal()\n\nWarning: The dot-dot notation (`..density..`) was deprecated in ggplot2 3.4.0.\n‚Ñπ Please use `after_stat(density)` instead.\n\n\n\n\n\n\n\n\n\nPie Chart ‚Äì Proportion by Vaccine Group\nShows how vaccine groups are proportionally represented in the dataset. Useful for visualizing categorical outcomes.\nIn the example below, the pie chart represents the proportion of vaccinations grouped into three categories:\n\nRespiratory vaccines account for the largest proportion, comprising 61% of all vaccines administered.\nChildhood vaccines represent a significant portion as well, making up 30%.\nThe category labeled Other includes 8% of vaccines administered, indicating a smaller but notable group of vaccinations outside the respiratory and childhood classifications.\n\n\nvacc_1524 %&gt;%\n  count(vacc_group3) %&gt;%\n  mutate(perc = n / sum(n), label = scales::percent(perc)) %&gt;%\n  ggplot(aes(x = \"\", y = perc, fill = vacc_group3)) +\n  geom_col(width = 1) +\n  coord_polar(theta = \"y\") +\n  geom_text(aes(label = label), position = position_stack(vjust = 0.5)) +\n  labs(title = \"Vaccine Group Proportions\", fill = \"Vaccine Group\") +\n  theme_void()\n\n\n\n\n\n\n\n\nBar Plot ‚Äì Vaccination Count by Vaccine Group\nThis plot compares the absolute count of vaccinations across groups, with horizontal bars for better readability of long labels.\nThe example below shows a horizontal bar chart illustrating the total number of vaccinations administered, grouped into three distinct categories:\n\nRespiratory vaccines clearly represent the largest group, indicating that these vaccines were administered most frequently within the population.\nThe Other category accounts for the smallest number of vaccinations, suggesting a relatively minor proportion of miscellaneous or specialized vaccines.\n\n\nvacc_1524 %&gt;%\n  count(vacc_group3) %&gt;%\n  ggplot(aes(x = reorder(vacc_group3, n), y = n, fill = vacc_group3)) +\n  geom_bar(stat = \"identity\") +\n  coord_flip() +\n  labs(title = \"Vaccination Count by Group\", x = NULL, y = \"Count\") +\n  theme_minimal() +\n  theme(legend.position = \"none\")\n\n\n\n\n\n\n\n\nGrouped Bar Plot ‚Äì Vaccination by Race and Vaccine Group\nThe example below shows a stacked bar chart presenting the distribution of vaccinations by race and vaccine category.\n\nRespiratory vaccines (represented in blue) dominate across all racial groups, consistently making up the largest proportion of administered vaccines, especially noticeable among Black and White groups.\nChildhood vaccines (represented in red) form a significant proportion of vaccinations among the Asian and Native groups, highlighting targeted or population-specific vaccination programs for younger age groups within these communities.\nThe Other vaccines category (represented in green) comprises a relatively minor proportion and appears more prominent among the Asian and White populations.\n\n**Implications:**\n\nThese patterns may suggest varying public health strategies, demographic factors, or differing healthcare access across racial groups. Understanding these variations can guide targeted healthcare interventions and improve vaccine coverage equity.\n\n# Prepare data: count vaccinations by race and vaccine group\n\nvacc_1524$race &lt;- tools::toTitleCase(vacc_1524$race)\n\nvacc_summary &lt;- vacc_1524 %&gt;%\n  count(race, vacc_group3) %&gt;%\n  group_by(race) %&gt;%\n  mutate(prop = n / sum(n)) %&gt;%\n  ungroup()\n\nggplot(vacc_summary, aes(x = race, y = prop, fill = vacc_group3)) +\n  geom_col(position = \"dodge\") +\n  labs(\n    title = \"Vaccination Distribution by Race and Vaccine Group\",\n    x = \"Race\", y = \"Proportion\",\n    fill = \"Vaccine Group\"\n  ) +\n  scale_y_continuous(labels = scales::percent_format()) +\n  theme_minimal() +\n  theme(axis.text.x = element_text(angle = 45, hjust = 1))\n\n\n\n\n\n\n\nrm(vacc_summary)\n\nStacked Bar Chart ‚Äì Race by Vaccine Group\nThe example below shows a stacked bar chart illustrating the number of vaccinations administered, grouped by vaccine type and categorized by racial groups.\n\nThe White population received the highest number of vaccinations across all vaccine categories (Childhood, Other, and Respiratory vaccines).\nOther racial groups (Asian, Black, Native, and Other) also received vaccinations, though in smaller numbers across each vaccine type, indicating ongoing efforts to reach diverse communities.\nRespiratory vaccines had the highest total number of vaccinations administered, suggesting these vaccines were a primary focus within the vaccination program.\n\nThis data helps to illustrate which groups have higher vaccine coverage and highlights the importance of ensuring equitable access and distribution across all communities.\n\nvacc_1524 %&gt;%\n  mutate(race = stringr::str_to_title(race)) %&gt;%\n  count(vacc_group3, race) %&gt;%\n  ggplot(aes(x = vacc_group3, y = n, fill = race)) +\n  geom_bar(stat = \"identity\") +\n  labs(title = \"Stacked Bar Chart: Race by Vaccine Group\", x = \"Vaccine Group\", y = \"Count\") +\n  theme_minimal()\n\n\n\n\n\n\n\n\nBoxplot ‚Äì Age Distribution by Vaccine Group\nVisualizes how age varies across vaccine groups using standard boxplots.\nThe example below shows a box plot depicting age distribution for three vaccine categories (Childhood vaccines, Other vaccines, and Respiratory vaccines):\nKey Observations:\n\nChildhood vaccines primarily cover younger ages, with most recipients under 25 years old. Some individuals beyond this age range appear as outliers, suggesting occasional vaccinations in older groups.\nRespiratory vaccines generally target an older age group, with the median age around 50 years, and a broad range from younger adults to elderly populations.\nThe Other vaccines category has a wider age distribution overall, suggesting these vaccines serve diverse age groups, though with fewer individuals compared to the other two groups.\n\nImplications:\nThis visualization highlights clear age-based targeting for different vaccine categories. Childhood vaccines are expectedly administered primarily to younger populations, while respiratory vaccines predominantly reach older adults. Understanding these age patterns helps to plan targeted public health campaigns and resource allocation effectively.\n\nvacc_1524 %&gt;%\n  ggplot(aes(x = vacc_group3, y = age, fill = vacc_group3)) +\n  geom_boxplot() +\n  labs(title = \"Age Distribution by Vaccine Group\",\n       x = \"Vaccine Group\", y = \"Age (Years)\") +\n  theme_minimal() +\n  theme(legend.position = \"none\")\n\n\n\n\n\n\n\n\nBoxplot with Jittered (Individual Data) Points\nCombines summary and raw data by overlaying individual age points on the boxplot.\nThe example below shows a boxplot with individual data points (jittered), displaying the age distribution of individuals across three vaccine groups: Childhood vaccines, Other vaccines, and Respiratory vaccines.\n\nChildhood vaccines:\nMost individuals who received childhood vaccines are young, with a median age around 10 years.\nThe distribution is tightly concentrated, though some older individuals (outliers) also received these vaccines.\nThe data points clearly cluster in younger age ranges, which is expected for this vaccine group.\n\nRespiratory vaccines:\n\nThis group has the highest median age, around 40‚Äì50 years.\nThe data points are more evenly spread out across a wide age range, with many individuals above 60 years, indicating respiratory vaccines are frequently administered to older populations.\n\n\nOther vaccines:\n\nThis group shows a wide range of ages, from infants to older adults.\nWhile the median age is still relatively low, the spread is broader compared to childhood vaccines, suggesting this category includes various vaccines administered across different age groups.\n\nImplications:\nBy combining summary statistics (boxplot) with individual-level data (dots), this chart offers a clear view of both overall trends and variation in vaccination by age. It confirms that vaccine distribution aligns with age-specific health needs‚Äîyoung children for childhood vaccines, and older adults for respiratory vaccines‚Äîwhile also showing the diversity within each group.\n\n\nvacc_1524 %&gt;%\n  ggplot(aes(x = vacc_group3, y = age, fill = vacc_group3)) +\n  geom_boxplot(outlier.shape = NA, alpha = 0.6) +\n  geom_point(position = position_jitter(width = 0.2),\n             alpha = 0.3, color = \"black\", size = 1.2) +\n  labs(title = \"Boxplot with Individual Data Points\",\n       x = \"Vaccine Group\", y = \"Age\") +\n  theme_minimal() +\n  theme(legend.position = \"none\")\n\n\n\n\n\n\n\n\nBoxplot with Violin Overlay\nAdds a violin plot to visualize the full distribution of ages while preserving boxplot summary stats.\nThe plot below combines a boxplot and violin plot to display the age distribution across different vaccine groups: Childhood vaccines, Other vaccines, and Respiratory vaccines.\n\nChildhood vaccines:\nThe age distribution is heavily concentrated among younger individuals, with most recipients under 25 years. The violin shape is widest near the lower ages, tapering quickly, which indicates that childhood vaccines are rarely given to older individuals.\nRespiratory vaccines:\nThe distribution leans toward older age groups, with the median age higher than in other categories. The violin is widest in the 40‚Äì70 age range, suggesting respiratory vaccines are more commonly administered to older adults.\n\n\n\nOther vaccines:\nThis group shows a broader age range. The shape suggests two areas of concentration: one among younger children and another around age 60‚Äì70, indicating this group includes vaccine types used across diverse age groups.\nOverall, this combined plot provides both statistical summaries (via boxplot) and full distribution shapes (via violin plot), helping to clearly distinguish the age-related usage patterns across vaccine types.\n\n\nvacc_1524 %&gt;%\n  ggplot(aes(x = vacc_group3, y = age, fill = vacc_group3)) +\n  geom_violin(alpha = 0.4, color = NA) +\n  geom_boxplot(width = 0.2, outlier.shape = NA) +\n  labs(title = \"Boxplot with Violin Overlay\", x = NULL, y = \"Age\") +\n  theme_minimal() +\n  theme(legend.position = \"none\")\n\n\n\n\n\n\n\n\nNotched Boxplot ‚Äì Median Comparison\nNotches allow a rough comparison of medians across groups. Non-overlapping notches suggest a significant difference.\nThe plot below presents a notched boxplot showing the age distribution for each vaccine group‚ÄîChildhood vaccines, Other vaccines, and Respiratory vaccines.\n\nThe notches around the medians provide a visual guide for comparing the central values (medians) across groups. If the notches do not overlap, it suggests that the medians are likely different in a statistically meaningful way.\n\nKey insights:\n\nChildhood vaccines show a younger age distribution, with a median age around 10 years and a narrow spread. Outliers indicate a few older individuals also received these vaccines.\nRespiratory vaccines are mainly administered to older age groups, with the highest median age among the three categories.\nOther vaccines span a wider range of ages, but the median remains lower than that of respiratory vaccines.\n\nMedian Comparison:\n\nThe non-overlapping notches between childhood and respiratory vaccines suggest a clear difference in median ages.\nThe other vaccines group overlaps slightly with both, indicating a more mixed age distribution and less pronounced difference.\n\n\nvacc_1524 %&gt;%\n  ggplot(aes(x = vacc_group3, y = age, fill = vacc_group3)) +\n  geom_boxplot(notch = TRUE) +\n  labs(title = \"Notched Boxplot: Vaccine Group vs Age\", x = \"Group\", y = \"Age\") +\n  theme_minimal() +\n  theme(legend.position = \"none\")\n\nNotch went outside hinges\n‚Ñπ Do you want `notch = FALSE`?\n\n\n\n\n\n\n\n\n\nFaceted Boxplot by Gender\nBreaks down the age distribution by vaccine group and gender to compare across subgroups.\nThe plot below shows boxplots of age distribution by vaccine group (Childhood, Respiratory, and Other vaccines), separated into two panels by gender (Female and Male).\nKey Observations:\n\nChildhood vaccines:\n\n-    Age distributions are similar for both females and males, with most recipients being under 25 years.\n\n-    A few older outliers are present, especially among females, but the bulk of vaccine recipients are children and adolescents.\n\nRespiratory vaccines:\n\n-    This group shows a wide age range in both genders, with median ages around 40‚Äì45 years.\n\n-    The distribution is slightly more spread out among males, but the overall trend remains consistent across genders.\n\nOther vaccines:\n\n-    A notable gender difference is visible here:\n\n    -   Among **females**, recipients span a broad age range, including many older adults.\n\n    -    Among **males**, the age distribution is narrower and skewed toward younger adults.\nSummary:\nThis faceted view helps highlight how age patterns differ by both vaccine group and gender. While childhood and respiratory vaccine distributions are generally similar across genders, the ‚ÄúOther‚Äù vaccine group shows more variation, possibly reflecting differences in vaccine eligibility, access, or health needs.\n\nvacc_1524 %&gt;%\n  ggplot(aes(x = vacc_group3, y = age, fill = vacc_group3)) +\n  geom_boxplot() +\n  facet_wrap(~ gender) +\n  labs(title = \"Age by Vaccine Group, Faceted by Gender\", x = NULL, y = \"Age\") +\n  theme_minimal() +\n  theme(legend.position = \"none\")\n\n\n\n\n\n\n\n\nOrdered Boxplot ‚Äì by Median Age\nReorders vaccine groups by median age to emphasize differences in distribution centrality.\nThe plot below shows age distributions by vaccine group, with the groups reordered by median age to highlight differences in central tendency.\nKey Observations:\n\nChildhood vaccines have the lowest median age, with most recipients being under 20 years. A small number of older individuals appear as outliers.\nOther vaccines show a moderate median age, but with a wide spread across age groups‚Äîranging from infants to older adults. This suggests these vaccines are used in more varied contexts.\nRespiratory vaccines have the highest median age, with recipients typically ranging from their 30s to older adulthood, reflecting their common use among older populations.\n\nConclusion:\nBy ordering the boxplots by median age, this visual emphasizes the different age profiles targeted by each vaccine group. This approach helps communicate age-related trends in vaccine administration more clearly .\n\nvacc_1524 %&gt;%\n  mutate(vacc_group3 = fct_reorder(vacc_group3, age, median, na.rm = TRUE)) %&gt;%\n  ggplot(aes(x = vacc_group3, y = age, fill = vacc_group3)) +\n  geom_boxplot() +\n  labs(title = \"Boxplot Ordered by Median Age\", x = NULL, y = \"Age\") +\n  theme_minimal() +\n  theme(legend.position = \"none\")\n\n\n\n\n\n\n\n\nArea Plot ‚Äì Monthly Vaccination Trends Over Years\nUses an area chart to show monthly vaccination volumes over multiple years, stacked by year.\nThe area chart below displays monthly vaccination counts over multiple years (2015‚Äì2024), helping visualize seasonal and annual trends in vaccine uptake.\nKey Observations:\n\n2020 stands out with the highest overall vaccination counts, especially between April and June, likely reflecting a surge due to public health responses such as the COVID-19 pandemic.\nIn other years, vaccination numbers are more evenly distributed, with moderate peaks around March‚ÄìApril or August‚ÄìSeptember, possibly aligning with seasonal vaccination programs (e.g., flu campaigns).\n2023 and 2024 show a relatively steady pattern throughout the year, with less fluctuation month-to-month.\nEarlier years (2015‚Äì2017) have lower and more variable volumes compared to recent years.\n\nConclusion:\nThis chart highlights both seasonal vaccination patterns and the impact of specific public health events, such as the elevated activity in 2020. Monitoring these trends over time supports planning for future vaccination campaigns and resource allocation.\n\nvacc_1524 %&gt;%\n  count(vacc_year, vacc_month_name) %&gt;%\n  ggplot(aes(x = vacc_month_name, y = n, group = vacc_year, fill = factor(vacc_year))) +\n  geom_area(alpha = 0.7, position = \"identity\") +\n  labs(title = \"Monthly Vaccination Trends by Year\",\n       x = \"Month\", y = \"Number of Vaccinations\", fill = \"Year\") +\n  theme_minimal()\n\n\n\n\n\n\n\n\nFaceted Plot ‚Äì Proportional Vaccination Trends by Group and Race\nDisplays how the proportion of vaccinations among different races changed across years, separately for each vaccine group.\nThe faceted line plot below shows how the proportion of vaccinations among different racial groups has changed over time (2015‚Äì2024), presented separately for each vaccine group: Childhood, Respiratory, and Other.\nKey Observations:\n\nChildhood vaccines:\n\n-   Proportions vary notably year to year, especially for **Asian**, **Black**, and **Native** groups.\n\n-   The **\"Other\"** and **White** groups show a more consistent presence but with modest fluctuations.\n\n-    Some groups (e.g., Native) show a steady rise in recent years.\n\n**Respiratory vaccines**:\n\n-    Several racial groups (notably **Native**, **Black**, and **Other**) show periods of very high proportions, including years where proportions reached **100%**, likely due to small subgroup sample sizes or data dominance.\n\n-    The **White** and **Asian** groups tend to remain stable, though proportions fluctuate in certain years (e.g., 2020‚Äì2022).\n\nOther vaccines:\n\n-   Representation is generally lower and more variable across all racial groups.\n\n-    The **White** group maintains a small but steady share throughout most years.\n\n**Interpretation:**\nThis faceted view enables comparisons within and between vaccine types, highlighting potential shifts in vaccine access, uptake, or data coverage by racial group over time. It also suggests where disparities or changes in focus may have occurred, helping to inform more equitable vaccination strategies.\n\n# Prepare data: floor year, count by group, compute proportions within each group\n\n# Clean and count total per race/year (for denominator)\ntotal_by_race_year &lt;- vacc_1524 %&gt;%\n  mutate(\n    age = as.integer(round(age)),\n    vacc_year = as.integer(floor(vacc_year)),\n    race = str_to_title(as.character(race))\n  ) %&gt;%\n  count(vacc_year, race, name = \"total_race_year\")\n\n#  Count per vaccine group (for numerator), then join\nvacc_plot_data &lt;- vacc_1524 %&gt;%\n  mutate(\n    age = as.integer(round(age)),\n    vacc_year = as.integer(floor(vacc_year)),\n    race = str_to_title(as.character(race))\n  ) %&gt;%\n  count(vacc_year, race, vacc_group3, name = \"n\") %&gt;%\n  left_join(total_by_race_year, by = c(\"vacc_year\", \"race\")) %&gt;%\n  mutate(prop = n / total_race_year)\n\n# Plot proportion by race within group\nggplot(vacc_plot_data, aes(x = vacc_year, y = prop, color = race)) +\n  geom_line(size = 1) +\n  facet_wrap(~ vacc_group3) +\n  scale_y_continuous(labels = percent_format()) +\n  scale_x_continuous(breaks = pretty(unique(vacc_plot_data$vacc_year))) +\n  labs(\n    title = \"Proportion of Race Within Vaccine Groups by Year\",\n    x = \"Year\", y = \"Proportion\", color = \"Race\"\n  ) +\n  theme_minimal() +\n  theme(axis.text.x = element_text(angle = 45, hjust = 1))\n\n\n\n\n\n\n\nrm(vacc_plot_data, total_by_race_year)\n\nStatistical Overlay ‚Äì Regression Line on Vaccination Age\nAdds a linear regression to examine the relationship between income and age at vaccination.\nThe scatterplot below visualizes the relationship between income (horizontal axis) and age at vaccination (vertical axis), with a linear regression line and confidence band overlaid to summarize the trend.\nKey Observations:\n\nThe fitted regression line shows a slight negative slope, suggesting that as income increases, the age at which individuals receive vaccination tends to decrease modestly.\nThe confidence band (shaded region) around the line is relatively narrow, indicating a fair level of certainty in the trend across the central range of income.\nThe majority of data points are concentrated in the lower income ranges, while higher income values are more sparsely populated and show greater variability.\n\n**Interpretation:**\nThis trend suggests a possible inverse relationship between income and vaccination age‚Äîindividuals with higher income may be more likely to receive vaccines at younger ages. This could reflect differences in healthcare access, awareness, or proactive health behaviors associated with income level.\n\nvacc_1524 %&gt;%\n  ggplot(aes(x = income, y = age)) +\n  geom_point(alpha = 0.3, color = \"gray50\") +\n  geom_smooth(method = \"lm\", se = TRUE, color = \"blue\") +\n  labs(\n    title = \"Association Between Income and Age at Vaccination\",\n    x = \"Income\", y = \"Age\"\n  ) +\n  theme_minimal()\n\n`geom_smooth()` using formula = 'y ~ x'\n\n\n\n\n\n\n\n\n\nRegression Plot ‚Äì Age vs Income by Vaccine Group (Log Scale)\nAdds linear regression and facets by vaccine group. The x-axis is log-scaled to handle skewed income data.\nThe plot below shows scatterplots with linear regression lines, examining the relationship between income and age at vaccination. The plots are faceted by vaccine group: Childhood, Other, and Respiratory. The x-axis uses a logarithmic scale to better handle the skewed distribution of income.\nKey Observations:\n\nChildhood vaccines:\n\n-    A **slight negative trend** is observed, indicating that as income increases, age at vaccination tends to decrease slightly.\n\n-    This may reflect earlier or more timely vaccinations among higher-income individuals for childhood vaccines.\n\nOther vaccines:\n\n-   The regression line is nearly flat with a wide confidence interval, suggesting **no strong or consistent relationship** between income and age at vaccination in this group.\n\n-    This likely reflects diverse vaccine purposes and use across a broad age and income range.\n\nRespiratory vaccines:\n\n-   A **mild negative trend** is also seen here, where higher-income individuals may receive respiratory vaccines at slightly younger ages.\n\n-    However, the relationship is subtle and the confidence interval overlaps considerably with the regression line.\n\n**Interpretation:**\nWhile the strength of association varies across groups, both the childhood and respiratory vaccine panels suggest a small trend where higher income is associated with younger age at vaccination. This may be related to differences in access, preventive health behaviors, or healthcare utilization by income level.\n\nvacc_1524 %&gt;%\n  mutate(vacc_group3 = str_to_title(vacc_group3)) %&gt;%\n  ggplot(aes(x = income, y = age)) +\n  geom_point(alpha = 0.3, color = \"gray50\") +\n  geom_smooth(method = \"lm\", se = TRUE, color = \"blue\") +\n  scale_x_log10(labels = scales::comma_format()) +\n  facet_wrap(~ vacc_group3) +\n  labs(\n    title = \"Association Between Income and Age at Vaccination\",\n    x = \"Income (log scale)\", y = \"Age\"\n  ) +\n  theme_minimal()\n\n`geom_smooth()` using formula = 'y ~ x'\n\n\n\n\n\n\n\n\n\nECDF ‚Äì Age at Vaccination\nThe empirical cumulative distribution function (ECDF) shows the proportion of individuals vaccinated at or below each age. This helps visualize the age distribution in a cumulative way.\nThe plot below presents shows the cumulative proportion of individuals who received a vaccination at or below each age.\nKey Observations:\n\nThe curve rises steeply in the early age range, indicating that a large proportion of individuals were vaccinated at younger ages (e.g., before 30).\nBy around age 50, approximately 80% of individuals had been vaccinated.\nThe curve flattens out after age 75, suggesting fewer vaccinations occur at older ages.\n\nInterpretation:\nThe ECDF provides an intuitive way to understand the distribution of vaccination ages. It highlights that most vaccinations occur in childhood and early adulthood, with fewer individuals vaccinated later in life. This cumulative view complements histograms and boxplots by showing the proportion of individuals affected up to each age.\n\nvacc_1524 &lt;- vacc_1524 %&gt;% filter(income &gt; 0, !is.na(age))\n\nvacc_1524 %&gt;%\n  ggplot(aes(x = age)) +\n  stat_ecdf(geom = \"step\", color = \"steelblue\") +\n  labs(title = \"ECDF of Age at Vaccination\", x = \"Age\", y = \"Cumulative Proportion\") +\n  theme_minimal()\n\n\n\n\n\n\n\n\nTreemap ‚Äì Vaccination by Race and Vaccine Group\nThis treemap visualizes the distribution of vaccinations by race and vaccine group. Larger areas indicate more individuals within each combination.\nThe treemap below displays the distribution of vaccinations across racial groups, further categorized by vaccine group (Childhood, Respiratory, and Other). Each rectangle represents a combination of race and vaccine type, with area size corresponding to the number of individuals vaccinated.\nKey Observations:\n\nThe White population accounts for the largest share overall, with:\n\n-    **788 individuals (50.7%)** in the **Respiratory** vaccine group.\n\n-    **404 individuals (26.0%)** in the **Childhood** vaccine group.\n\n-    **114 individuals (7.3%)** in the **Other** vaccine group.\n\nOther racial groups have smaller shares:\n\n-    **Black** individuals make up a modest proportion across groups, particularly **4.5%** in the Respiratory group and **1.4%** in Childhood vaccines.\n\n-    **Asian** individuals represent **4.4%** of Respiratory vaccines and **2.1%** of Childhood vaccines.\n\n-    **Native** and **Other** groups have minimal representation overall.\n\n**Interpretation:**\nThis treemap visually emphasizes the dominant contribution of the White population across all vaccine types, especially for respiratory vaccines. It also illustrates disparities in representation among racial groups, which can be important for assessing equity in vaccine access, uptake, and program targeting.\n\n# Cross-platform ‚Äúnew device‚Äù:\ndev.new(width = 8, height = 6)  \n\np &lt;- vacc_1524 %&gt;%\n  count(race, vacc_group3) %&gt;%\n  mutate(race = str_to_title(race)) %&gt;%\n  ggplot(aes(area = n, fill = vacc_group3, label = race)) +\n  geom_treemap() +\n  geom_treemap_text(colour = \"white\", place = \"centre\", grow = TRUE) +\n  labs(\n    title = \"Treemap: Vaccination by Race and Vaccine Group\",\n    fill  = \"Vaccine Group\"\n  ) +\n  theme_minimal()\n\nprint(p)\n\nrm (p)\n\n\n#  Treemap - with Labels Showing Counts and Proportions by Race and vaccine Group\nvacc_1524 %&gt;%\n  count(race, vacc_group3) %&gt;%\n  mutate(\n    race = str_to_title(race),\n    total = sum(n),\n    proportion = n / total,\n    label_text = paste0(race, \"\\n\", n, \" (\", percent(proportion, accuracy = 0.1), \")\")\n  ) %&gt;%\n  ggplot(aes(area = n, fill = vacc_group3, label = label_text)) +\n  geom_treemap() +\n  geom_treemap_text(colour = \"white\", place = \"centre\", grow = TRUE, reflow = TRUE) +\n  labs(\n    title = \"Treemap: Vaccination by Race and Vaccine Group\",\n    fill = \"Vaccine Group\"\n  ) +\n  theme_minimal()\n\n\n\n\n\n\n\n\nCorrelation Heatmap ‚Äì Numeric Variables\nThis heatmap displays Pearson correlation coefficients between selected numeric variables. Strong positive or negative values help identify relationships worth further analysis.\nThe heatmap below displays Pearson correlation coefficients between selected numeric variables: age, income, healthcare expenses, and healthcare coverage. Correlation values range from -1 to 1, where values closer to ¬±1 indicate stronger relationships.\nKey Observations:\n\nAge and healthcare coverage show a strong positive correlation (0.65), suggesting that as individuals age, they are more likely to have greater healthcare coverage.\nAge and healthcare expenses are also positively correlated (0.66), indicating that older individuals tend to incur higher healthcare costs.\nHealthcare coverage and healthcare expenses show a moderate positive correlation (0.44), which may reflect that those with more coverage also utilize healthcare services more frequently or thoroughly.\nIncome is not strongly correlated with any other variable in this set, with the highest being a negligible 0.02 with healthcare coverage and a slightly negative value with age (-0.04) and expenses (-0.05).\n\n**Interpretation:**\nThis heatmap highlights potential relationships that may inform further analysis‚Äîespecially the connections between age, coverage, and expenses. In contrast, income appears relatively independent of the other variables in this dataset.\n\nnumeric_vars &lt;- vacc_1524 %&gt;%\n  select(age, income, healthcare_expenses, healthcare_coverage) %&gt;%\n  na.omit()\n\ncor_matrix &lt;- round(cor(numeric_vars), 2)\n\nas.data.frame(as.table(cor_matrix)) %&gt;%\n  rename(Var1 = Var1, Var2 = Var2, Correlation = Freq) %&gt;%\n  ggplot(aes(x = Var1, y = Var2, fill = Correlation)) +\n  geom_tile(color = \"white\") +\n  geom_text(aes(label = Correlation), color = \"black\") +\n  scale_fill_gradient2(low = \"red\", high = \"blue\", mid = \"white\", midpoint = 0) +\n  labs(title = \"Correlation Heatmap of Numeric Variables\", x = NULL, y = NULL) +\n  theme_minimal()\n\n\n\n\n\n\n\n\nRidgeline Plot ‚Äì Age by Vaccine Group\nThis ridgeline plot shows the age distribution for each vaccine group. It highlights where age densities differ across categories.\nThe ridgeline plot below shows age distributions for three vaccine groups: Childhood, Other, and Respiratory. Each layer represents the density of ages within a vaccine category, allowing for visual comparison of where individuals are most commonly vaccinated within each group.\nKey Observations:\n\nChildhood vaccines show a clear peak at very young ages, as expected. The density drops rapidly as age increases, with a small secondary bump around middle age, possibly reflecting catch-up vaccinations or data irregularities.\nOther vaccines have a bimodal distribution with one peak in younger adults and another in older adults (around 70+ years), suggesting they are used across multiple life stages.\nRespiratory vaccines have a broad distribution, with a peak density around 60‚Äì70 years, consistent with routine respiratory vaccinations for older adults (e.g., influenza or pneumococcal vaccines).\n\n**Interpretation:**\nThis visualization effectively highlights differences in age targeting across vaccine groups. It shows that:\n\nChildhood vaccines are concentrated in early life,\nOther vaccines are used more broadly across age ranges, and\nRespiratory vaccines are predominantly administered to older populations.\n\n\nvacc_1524 %&gt;%\n  mutate(vacc_group3 = stringr::str_to_title(vacc_group3)) %&gt;%\n  ggplot(aes(x = age, y = vacc_group3, fill = vacc_group3)) +\n  geom_density_ridges(scale = 1.5, alpha = 0.6, color = \"white\") +\n  labs(title = \"Ridgeline Plot: Age Distribution by Vaccine Group\", x = \"Age\", y = \"Vaccine Group\") +\n  theme_minimal() +\n  theme(legend.position = \"none\")\n\nPicking joint bandwidth of 5.93\n\n\n\n\n\n\n\n\n\nInteractive Plot ‚Äì Income vs Age by Race\nThis interactive scatter plot shows the relationship between income and age, colored by race. Hovering reveals more details including group and income.\n\np &lt;- vacc_1524 %&gt;%\n  mutate(race = stringr::str_to_title(race)) %&gt;%\n  ggplot(aes(x = income, y = age, color = race,\n             text = paste(\"Race:\", race,\n                          \"&lt;br&gt;Group:\", vacc_group3,\n                          \"&lt;br&gt;Income:\", income,\n                          \"&lt;br&gt;Age:\", age))) +\n  geom_point(alpha = 0.6) +\n  geom_smooth(method = \"loess\", se = FALSE, color = \"gray30\") +\n  labs(title = \"Interactive: Income vs Age by Race\",\n       x = \"Income\", y = \"Age\", color = \"Race\") +\n  theme_minimal() +\n  theme(legend.position = \"bottom\")\n\nggplotly(p, tooltip = \"text\")\n\n`geom_smooth()` using formula = 'y ~ x'\n\n\n\n\n\nrm(p)\n\nAnimation ‚Äì Vaccination Trends Over Years\nThis animation shows how vaccination counts across vaccine groups change over time. It helps spot temporal trends and emerging patterns.\n\nanim_plot &lt;- vacc_1524 %&gt;%\n  mutate(vacc_year = as.integer(floor(vacc_year))) %&gt;%\n  count(vacc_year, vacc_group3) %&gt;%\n  ggplot(aes(x = vacc_group3, y = n, fill = vacc_group3)) +\n  geom_col(show.legend = FALSE) +\n  labs(title = 'Year: {frame_time}', x = 'Vaccine Group', y = 'Count') +\n  theme_minimal() +\n  transition_time(vacc_year) +\n  ease_aes('linear')\n\nanim_file &lt;- tempfile(fileext = \".gif\")\nanim &lt;- animate(anim_plot, nframes = 100, fps = 10, renderer = gifski_renderer(anim_file))\n# print(anim)\n\nrm(anim_plot, anim_file, anim)\n\nAnimation ‚Äì Breast Cancer Screening Uptake by State\nThis animated bar chart shows breast cancer screening uptake over time for each Australian state. It uses faceting to compare regional trends.\n\nbreast_anim &lt;- breast_cancer_data %&gt;%\n  filter(!state %in% c(\"Other\", \"Unknown\")) %&gt;%\n  mutate(year_4digit = as.integer(year_4digit)) %&gt;%\n  group_by(state, year_4digit) %&gt;%\n  summarise(total_screened = sum(part50_74, na.rm = TRUE), .groups = \"drop\") %&gt;%\n  ggplot(aes(x = year_4digit, y = total_screened, fill = state)) +\n  geom_col(show.legend = FALSE) +\n  facet_wrap(~ state) +\n  labs(title = 'Year: {frame_time}', x = 'Year', y = 'Women Screened (50‚Äì74 yrs)') +\n  theme_minimal() +\n  transition_time(year_4digit) +\n  ease_aes('linear')\n\nscreening_gif &lt;- tempfile(fileext = \".gif\")\nanim_screen &lt;- animate(breast_anim, nframes = 100, fps = 10, renderer = gifski_renderer(screening_gif))\n# print(anim_screen)\n\nrm(breast_anim, screening_gif, anim_screen)\n\n\n\n\nHeatmap ‚Äì Number of Vaccinations by Month and Weekday Highlights vaccination activity patterns by day of week and month. Darker tiles represent higher counts.\nThe heatmap below demonstrates the number of vaccinations administered across each day of the week and each calendar month. Color intensity indicates the relative number of vaccinations, with darker red representing higher uptake and pale yellow representing lower activity.\nKey Observations:\n\nSaturday consistently shows high uptake, particularly in October, September, and July, suggesting that weekends may be more accessible or preferred for vaccination appointments.\nTuesday in May and Wednesday in August also show pronounced peaks, likely linked to specific campaign efforts or seasonal programs.\nThursday and Friday generally have moderate activity, while Sunday and Monday tend to have lower vaccination counts across most months.\nOverall, the summer and early fall months (July to October) show increased uptake across several weekdays, possibly aligning with back-to-school vaccination drives or respiratory vaccine rollouts.\n\n**Interpretation:**\nThe plot reveals both seasonal and weekly rhythms in vaccination behavior. Recognizing these patterns can guide better scheduling of clinics, resource planning, and public messaging to align with high-demand periods and improve overall vaccine accessibility.\n\n# ................Without  Adding the long Title ........................................................\n# ..............................................................................................\n\n# --- Order weekday and month factors for proper axis display ---\n# --- Convert original vaccination date to Eastern Time (Massachusetts local time) ---\n# Assumes vacc_date is POSIXct or character in UTC or local system time\nvacc_1524 &lt;- vacc_1524 %&gt;%\n  mutate(\n    vacc_datetime_et = with_tz(as.POSIXct(vacc_date, tz = \"UTC\"), tzone = \"America/New_York\"),  # Adjust timezone to Eastern Time\n    vacc_weekday = wday(vacc_datetime_et, label = TRUE, abbr = FALSE),                          # Extract weekday (e.g., Monday)\n    vacc_month_name = month(vacc_datetime_et, label = TRUE, abbr = FALSE)                       # Extract month (e.g., January)\n  )\n\n# --- Order weekday and month factors for proper axis display ---\nvacc_1524 &lt;- vacc_1524 %&gt;%\n  mutate(\n    vacc_month_name = factor(vacc_month_name, levels = month.name),  # Ensure months are in calendar order\n    vacc_weekday = factor(vacc_weekday, levels = c(\"Monday\", \"Tuesday\", \"Wednesday\", \"Thursday\", \"Friday\", \"Saturday\", \"Sunday\"))  # Ensure weekdays are in logical order\n  )\n\n# --- Create heatmap of vaccination counts by weekday and month ---\nvacc_1524 %&gt;%\n  count(vacc_weekday, vacc_month_name) %&gt;%  # Count number of vaccinations by weekday and month\n  ggplot(aes(x = vacc_weekday, y = vacc_month_name, fill = n)) +     # Map weekday to x-axis, month to y-axis, and fill by count\n  geom_tile(color = \"white\") +                                       # Draw heatmap tiles with white border for readability\n  scale_fill_gradientn(                                              # Use custom yellow-to-red color scale\n    colors = c(\"#ffffcc\", \"#ffeda0\", \"#feb24c\", \"#f03b20\", \"#bd0026\"),\n    breaks = scales::pretty_breaks(n = 5),                           # Auto-select 5 good breakpoints for legend\n    name = \"Vaccinated Number\"                                       # Legend title\n  ) +\n  labs(\n    title = \"Vaccination Uptake by Weekday and Month\",               # Plot title\n    subtitle = \"Timestamps interpreted as US Eastern Time (Massachusetts)\",  # Timezone context\n    x = \"Weekday\", y = \"Month\", fill = \"Vaccinated Number\",          # Axis and legend labels\n    caption = \"Note: Original timestamps converted from UTC to America/New_York\"\n  ) +\n  theme_minimal() +\n  theme(\n    text = element_text(family = \"Times New Roman\"),                 # Font style\n    legend.position = \"bottom\",                                      # Move legend below the plot\n    axis.text.x = element_text(angle = 45, hjust = 1, size = 10, face = \"bold\"),  # X-axis label formatting\n    axis.text.y = element_text(size = 10, face = \"bold\"),            # Y-axis label formatting\n    axis.title.x = element_text(face = \"bold\", size = 11),\n    axis.title.y = element_text(face = \"bold\", size = 11),\n    plot.title = element_text(size = 12, face = \"bold\"),\n    legend.title = element_text(size = 10),\n    legend.text = element_text(size = 8)\n  )\n\n\n\n\n\n\n\n# Use figure title below to render in Quarto or Rmarkdown \n#\"Figure XX: Vaccination uptake by weekday and month among individuals aged 15‚Äì24, 2016‚Äì2024.\"\n\n\n# ................Adding the long Title ........................................................\n# ..............................................................................................\n\n# --- Convert original vaccination date to Eastern Time (Massachusetts local time) ---\n# Assumes vacc_date is POSIXct or character in UTC or local system time\nvacc_1524 &lt;- vacc_1524 %&gt;%\n  mutate(\n    vacc_datetime_et = with_tz(as.POSIXct(vacc_date, tz = \"UTC\"), tzone = \"America/New_York\"),  # Adjust timezone to Eastern Time\n    vacc_weekday = wday(vacc_datetime_et, label = TRUE, abbr = FALSE),                          # Extract weekday (e.g., Monday)\n    vacc_month_name = month(vacc_datetime_et, label = TRUE, abbr = FALSE)                       # Extract month (e.g., January)\n  )\n\n# --- Order weekday and month factors for proper axis display ---\nvacc_1524 &lt;- vacc_1524 %&gt;%\n  mutate(\n    vacc_month_name = factor(vacc_month_name, levels = month.name),  # Ensure months are in calendar order\n    vacc_weekday = factor(vacc_weekday, levels = c(\"Monday\", \"Tuesday\", \"Wednesday\", \"Thursday\", \"Friday\", \"Saturday\", \"Sunday\"))  # Ensure weekdays are in logical order\n  )\n\n# --- Create heatmap of vaccination counts by weekday and month ---\np &lt;- vacc_1524 %&gt;%\n  count(vacc_weekday, vacc_month_name) %&gt;%  # Count number of vaccinations by weekday and month\n  ggplot(aes(x = vacc_weekday, y = vacc_month_name, fill = n)) +     # Map weekday to x-axis, month to y-axis, and fill by count\n  geom_tile(color = \"white\") +                                       # Draw heatmap tiles with white border for readability\n  scale_fill_gradientn(                                              # Use custom yellow-to-red color scale\n    colors = c(\"#ffffcc\", \"#ffeda0\", \"#feb24c\", \"#f03b20\", \"#bd0026\"),\n    breaks = scales::pretty_breaks(n = 5),                           # Auto-select 5 good breakpoints for legend\n    name = \"Vaccinated Number\"                                       # Legend title\n  ) +\n  labs(\n    title = \"Vaccination Uptake by Weekday and Month\",               # Plot title\n    x = \"Weekday\", y = \"Month\", fill = \"Vaccinated Number\"           # Axis and legend labels\n  ) +\n  theme_minimal() +\n  theme(\n    text = element_text(family = \"Times New Roman\"),                 # Font style\n    legend.position = \"bottom\",                                      # Move legend below the plot\n    axis.text.x = element_text(angle = 45, hjust = 1, size = 10, face = \"bold\"),  # X-axis label formatting\n    axis.text.y = element_text(size = 10, face = \"bold\"),            # Y-axis label formatting\n    axis.title.x = element_text(face = \"bold\", size = 11),\n    axis.title.y = element_text(face = \"bold\", size = 11),\n    plot.title = element_text(size = 12, face = \"bold\"),\n    legend.title = element_text(size = 10),\n    legend.text = element_text(size = 8)\n  )\n\n# --- Add descriptive figure caption using patchwork's plot_annotation() ---\nfinal_plot &lt;- p + plot_annotation(\n  caption = \"Figure XX: Vaccination uptake by weekday and month among individuals aged 15‚Äì24, 2016‚Äì2024.\",\n  theme = theme(\n    plot.caption = element_text(\n      size = 10, family = \"Times New Roman\", hjust = 0\n    )\n  )\n)\n\n# --- Display the final plot with caption ---\nfinal_plot\n\n\n\n\n\n\n\n# setwd (\"C:/Users/User/Desktop/Materials_ Course and proposals/VIP collection for Syntax code or project titles/R codes/Data Manipulation and Wrangling\")\n# \n# # Save plots\n# ggsave(\"Heatmap_vaccination_pattern by day and month.TIFF\", plot = last_plot(), device = \"tiff\", width = 10, height = 6, units = \"in\")\n# ggsave(\"Heatmap_vaccination_pattern by day and month.svg\", plot = last_plot(), device = \"svg\", width = 10, height = 6, units = \"in\")\n\nrm (p, final_plot)"
  },
  {
    "objectID": "Post_Blog/Data_Manipulation_and_Wrangling/index.html#part-vii-shiny-app-building-web-apps",
    "href": "Post_Blog/Data_Manipulation_and_Wrangling/index.html#part-vii-shiny-app-building-web-apps",
    "title": "Date Manipulation and Wrangling using R",
    "section": "",
    "text": "8.1 UI fluidPage(), sidebarLayout(), sidebarPanel(), mainPanel(), tabsetPanel(), tags$style()\n8.2 Server reactive(), observeEvent(), req(), renderPlotly(), renderDT(), modalDialog(), showModal()\n8.3 App Launch shinyApp(ui, server)\n8.4 Inputs sliderInput(), selectInput(), colourInput(), actionButton(), downloadButton()\n8.5 Outputs plotlyOutput(), DTOutput(), datatable(), formatStyle()\n8.6 DT Features extensions = 'Buttons', export options: copy, csv, excel, pdf, print\n8.7 Styling and Themes tags$style(), (shinythemes::shinytheme() ‚Äì loaded but not applied)\nShiny is a web application framework for R that allows analysts to build interactive dashboards and tools using familiar syntax. It provides a structured approach to turning R scripts into accessible apps for broader audiences.\nA typical Shiny app includes two core components:\n\nUI (User Interface): Defines layout, inputs, and outputs shown on the screen interface.\nServer: Contains the logic that processes data and responds to user interactions.\n\nShiny apps can include multiple views (tabs), export buttons, dynamic filtering, charts, and customized design themes.\n\n\n\n\nfluidPage(): Defines the page layout.\nsidebarLayout(), sidebarPanel(), mainPanel(): Organize inputs and outputs side-by-side.\ntabsetPanel(): Allows tab navigation for multi-page apps.\ntags$style(), shinythemes::shinytheme(): Add or apply custom styles/themes.\n\n\n\n\n\n\nreactive(): Creates reactive data or expressions.\nobserveEvent(): Executes code when a trigger changes.\nreq(): Validates necessary input before proceeding.\nOutput functions: renderPlotly(), renderDT(), renderText(), renderTable().\n\n\n\n\n\n\n\n\n\n\n\n\n\nType\nFunction\nPurpose\n\n\n\n\nInput\nsliderInput()\nSelect a numeric value or range\n\n\nInput\nselectInput()\nDropdown menu to choose a category\n\n\nInput\ncolourInput()\nSelect a color\n\n\nInput\nactionButton()\nTrigger processing on click\n\n\nInput\ndownloadButton()\nDownload output tables or data\n\n\nOutput\nplotlyOutput()\nRender interactive plots using Plotly\n\n\nOutput\nDTOutput(), datatable()\nRender interactive tables\n\n\nOutput\nformatStyle()\nApply styling (e.g., color, font) to tables\n\n\n\n\n\n\n\n\nAdd extensions = 'Buttons' to enable table exports.\nExport types: \"copy\", \"csv\", \"excel\", \"pdf\", \"print\".\n\n\n\n\n\n\nshinyApp(ui, server): Runs the Shiny app combining both UI and server logic.\nApps can be hosted on ShinyApps.io, internal servers, or embedded in R Markdown dashboards.\n\n\nThe Shiny app code below demonstrates how interactive visualizations can be built using R to present health data in an accessible and user-friendly format. Specifically, it explores breast cancer screening uptake across states, years, and age groups in Australia. The app enhances user engagement through customizable features and immediate feedback mechanisms.\nKey capabilities demonstrated include: - Dynamic UI generation using fluidPage(), sidebarLayout(), and interactive widgets - State selection using a dropdown (selectInput()), which scales better than radio buttons - Age group filtering with a multiple selection input - Quantile-based filtering with sliderInput() for rate grouping - Color customization of output using colourInput() for personalizing table aesthetics - A modal popup (modalDialog()) triggered by a help button to explain data sources - Export options via downloadButton() and DT export buttons for multiple file formats - Real-time data filtering using reactive() expressions to tailor output to user input - An interactive line plot rendered via plotly and ggplot2 for visualization - Fully styled, downloadable data table with DT::renderDT() and export capabilities\nSee the live app at the following platforms\n\nAnalyticsHub YouTube: https://studio.youtube.com/video/5V7SPBH-8BE/edit\nLive App: https://j9eu4e-habtamu-mellie0bizuayehu.shinyapps.io/Breast_Cancer_Screening_Shiny_App/\n\n\n# Install required packages if not already installed\nrequired_packages &lt;- c(\"shiny\", \"ggplot2\", \"plotly\", \"DT\", \"dplyr\", \"shinyjs\", \"shinyWidgets\", \"scales\", \"colourpicker\")\n\n# Install missing ones\nnew_packages &lt;- required_packages[!(required_packages %in% installed.packages()[,\"Package\"])]\nif(length(new_packages)) install.packages(new_packages)\n\n# Load packages\nlibrary(shiny)\nlibrary(ggplot2)\nlibrary(plotly)\nlibrary(DT)\nlibrary(dplyr)\nlibrary(shinyjs)\nlibrary(shinyWidgets)\nlibrary(scales)\nlibrary(colourpicker)\n\n\n# load the data\nload(\"C:/Users/User/Desktop/Materials_ Course and proposals/VIP collection for Syntax code or project titles/R codes/Shiny App BC Screening/Breast Cancer Screening.RData\")\n\n\n# -------------------Shiny Application for Breast Cancer Screening---------------------\n\n\n# ------------------- UI and Server Definition ---------------------\n\n# Define custom CSS for styling buttons and other UI elements\nui &lt;- fluidPage(\n  \n  # Application title displayed at the top of the app\n  h1(\"Breast Cancer Screening Uptake\"),\n\n  # Apply custom styling to the download button\n  tags$style(HTML(\"\n    #download_data {\n      background: orange;\n      font-size: 20px;\n    }\n  \")),  \n\n  # Layout structure: sidebar for inputs and main panel for outputs\n  sidebarLayout(\n    sidebarPanel(\n      \n      # Quantile-based slider to filter screening rate\n      sliderInput(\"rate_10_group\", \"Rate Group\", \n                  min = min(breast_cancer_long$rate_10_group, na.rm = TRUE), \n                  max = max(breast_cancer_long$rate_10_group, na.rm = TRUE), \n                  value = c(5, 7)),\n      \n      # Dropdown menu for state selection (simplifies and scales better than radio buttons)\n      selectInput(\"state\", \"Select State\",  \n                  choices = unique(breast_cancer_long$state), \n                  selected = \"WA\"),\n\n      # Multi-select dropdown for age groups (allows viewing multiple demographics)\n      selectInput(\"age_group\", \"Women's Age Group\", \n                  choices = unique(breast_cancer_long$age_group), \n                  multiple = TRUE,\n                  selected = unique(breast_cancer_long$age_group)[1]),\n\n      # Add colour input to allow users to control table font colour\n      colourInput(\"color\", \"Point color\", value = \"blue\"),\n\n      # Add a help button that triggers a modal popup for guidance\n      actionButton(\"show_help\", \"Help\"),\n\n      # Add a download button for exporting filtered dataset\n      downloadButton(\"download_data\", \"Download Data\")\n    ),\n\n    mainPanel(\n      # Render the interactive line chart\n      plotlyOutput(\"plot\"),\n\n      # Render the data table output\n      DTOutput(\"table\")\n    )\n  )\n)\n\n# Define server-side logic for rendering outputs and interactivity\nserver &lt;- function(input, output, session) {\n\n  # Show Help Modal: explains data source when help button is clicked\n  observeEvent(input$show_help, {\n    showModal(modalDialog(\n      title = \"Help\",\n      \"This data was compiled from the Australian Institute of Health and Welfare.\"\n    ))\n  })\n\n  # Reactive expression to filter and summarize the dataset based on inputs\n  filtered_data &lt;- reactive({\n    req(input$rate_10_group, input$state, input$age_group)  # Ensure all inputs are available\n\n    breast_cancer_long %&gt;%\n      filter(rate_10_group &gt;= input$rate_10_group[1] & \n               rate_10_group &lt;= input$rate_10_group[2],\n             state == input$state,\n             age_group %in% input$age_group) %&gt;%\n      group_by(year, state, age_group) %&gt;%\n      summarise(year = as.integer(year),  # Convert year to integer for plotting\n                rate = round(mean(rate, na.rm = TRUE), 1),  # Average screening rate\n                .groups = \"drop\") \n  })\n\n  # Render Table: displays filtered data in an interactive table with export options\n  output$table &lt;- renderDT({\n    datatable(filtered_data(), \n              options = list(\n                pageLength = 10,  # Show 10 rows per page\n                dom = 'Bfrtip',  # Include Buttons (copy, csv, pdf, etc.)\n                buttons = c('copy', 'csv', 'excel', 'pdf', 'print'),\n                class = \"display nowrap compact\"  # Responsive and compact table design\n              ),\n              extensions = 'Buttons',\n              style = \"bootstrap\", \n              class = \"table table-striped table-bordered\") %&gt;%\n      formatStyle(columns = names(filtered_data()), color = input$color)  # Use selected color\n  })\n\n  # Download Handler: enables users to download filtered data\n  output$download_data &lt;- downloadHandler(\n    filename = \"Breast_cancer_screening_data.csv\",\n    content = function(file) {\n      write.csv(filtered_data(), file, row.names = FALSE)\n    }\n  )\n\n  # Render Plot: displays line plot of screening rates over time by age group\n  output$plot &lt;- renderPlotly({\n    df &lt;- filtered_data()\n\n    p &lt;- ggplot(df, aes(x = year, y = rate, color = age_group, group = interaction(state, age_group))) +\n      geom_line(size = 1) +  # Draw lines to show trend\n      geom_point(size = 3) +  # Add points to emphasize data values\n      labs(title = \"Breast Cancer Screening Uptake\", \n           x = \"Year\", \n           y = \"Screening Rate\",\n           color = \"Age Group\") +\n      theme_minimal()\n\n    ggplotly(p)  # Convert ggplot to interactive plotly chart\n  })\n}\n\n# Launch the app\nshinyApp(ui, server)"
  },
  {
    "objectID": "Post_Blog/Shiny_app_User_controlled/index.html#dashboard-for-breast-cancer-screening-in-australia-reactive-on-demand",
    "href": "Post_Blog/Shiny_app_User_controlled/index.html#dashboard-for-breast-cancer-screening-in-australia-reactive-on-demand",
    "title": "Dashboard: User-Controlled Shiny App",
    "section": "1 ü©∫ Dashboard for Breast Cancer Screening in Australia (Reactive on Demand)",
    "text": "1 ü©∫ Dashboard for Breast Cancer Screening in Australia (Reactive on Demand)\nThis Shiny web application allows users to explore breast cancer screening data for Australian women. It uses observer-based logic, meaning updates occur only after users trigger an action, such as clicking a button.\nThis project is part of a broader effort to translate public health screening data into actionable insights. It demonstrates best practices in using R Shiny for health surveillance, offering visual tools to support policy development and outreach strategies.\n\n\n1.1 üìò App Behavior & Architecture\nThis app uses observeEvent() to control reactivity. Changes to filters (e.g.¬†age group or state) do not instantly update the outputs. Instead, results appear after the user explicitly clicks a ‚ÄúShow Results‚Äù or similar button.\n\n\n\n\n\n\n\nShiny Feature\nRole\n\n\n\n\nobserveEvent()\nTriggers server actions on button click\n\n\neventReactive()\nReactive expressions tied to events\n\n\nactionButton()\nManual trigger for output updates\n\n\nrenderPlotly() / renderDT()\nControlled output rendering\n\n\n\n\n\n\n1.2 ‚úÖ Advantages\n\nReduces unnecessary computation\n\nAllows the user to finalize multiple input choices before updating\n\nPreferred for slower connections or complex datasets\n\n\n\n1.3 ‚ö†Ô∏è Disadvantages\n\nLess fluid interaction for exploratory tasks\n\nRequires an extra click for every update\n\n\n\n\n1.4 üîó Try the App\n‚ñ∂Ô∏è Live App (Manual Updates)"
  },
  {
    "objectID": "Post_Blog/Shiny_app_interactive/index.html#dashborad-for-breast-cancer-screening-explorer",
    "href": "Post_Blog/Shiny_app_interactive/index.html#dashborad-for-breast-cancer-screening-explorer",
    "title": "Interactive Dashboard: Shiny App",
    "section": "",
    "text": "‚ñ∂Ô∏è Click here for Live App\nThis version of the app responds instantly to any change in user input. Filtering options like state, age group, or rate thresholds immediately update the charts and tables ‚Äî no action button required.\nThis project is part of a broader effort to translate public health screening data into actionable insights. It demonstrates best practices in using R Shiny for health surveillance, offering visual tools to support policy development and outreach strategies.\n\n\n\nThis app is built using reactive() expressions that automatically track inputs and re-render outputs. It provides a seamless user experience designed for exploration and fast iteration.\n\n\n\nShiny Feature\nRole\n\n\n\n\nreactive()\nUpdates outputs automatically\n\n\nrenderPlotly()\nDisplays interactive plots\n\n\nrenderDT()\nFilters and formats tables\n\n\nsliderInput(), selectInput()\nCollect user filters\n\n\n\n\n\n\n\n\nInstant feedback with every change\n\nEncourages user exploration\n\nIdeal for training, teaching, and discovery\n\n\n\n\n\nPotentially heavier computation\n\nLess control over refresh timing\n\n\n\n\n\n‚ñ∂Ô∏è Live App (Fully Interactive)"
  },
  {
    "objectID": "Post_Blog/Longitudinal_Data_Analysis/index.html",
    "href": "Post_Blog/Longitudinal_Data_Analysis/index.html",
    "title": "Longitudinal Analysis Using 20 Years of Australian Prospective Cohort Data",
    "section": "",
    "text": "I have had the privilege of working on the Australian Longitudinal Study on Women‚Äôs Health (ALSWH) for more than four years, focusing on maternal and child health outcomes using one of Australia‚Äôs large and bid prospective longitudinal national datasets. I led the end-to-end process ‚Äî from data cleaning and preparation to advanced statistical modelling and dissemination of results ‚Äî both in high-impact journals and at conferences.\nMy work has resulted in three peer-reviewed Q1 publications:\n- Preterm Birth\n- Low Birthweight\n- Caesarean Section and Labour Intervention\nI have also presented these findings at:\n- Public Health Association of Australia Conference - ABReN (Australian Based Ethiopian Researchers Network) ‚Äì 4th Annual Conference\n- Health in Preconception, Pregnancy and Postpartum (HiPPP) EMR-C, Australia\nThrough this work, I have strengthened my expertise in managing large-scale, multi-wave datasets, applying advanced longitudinal modelling techniques, and translating complex findings into actionable insights for both academic and policy audiences.\n\nContents Addressed in this Presentation\n\nBrief Overview and Research Objectives ‚Äì Context, scope, and significance of the project.\nData Sources ‚Äì Description of primary and linked datasets.\nData Preparation & Management Workflow ‚Äì End-to-end process, from wave-level cleaning to final panel dataset.\nMissing Data management and analysis ‚Äì Diagnostic approaches, imputation methods, and sensitivity checks.\nStatistical Modelling & Analysis ‚Äì Model selection, longitudinal methods, and causal modelling approaches.\nData Governance & Ethics ‚Äì Ethical approvals, privacy, and confidentiality measures.\nResearch Outputs & Dissemination ‚Äì Publications, conference presentations, and stakeholder engagement.\nLessons Learned & Reflections ‚Äì Challenges faced and strategies used to manage a large multi-decade dataset.\nConclusion ‚Äì Summary of contributions, skills, and future applications."
  },
  {
    "objectID": "Post_Blog/Longitudinal_Data_Analysis/index.html#brief-overview",
    "href": "Post_Blog/Longitudinal_Data_Analysis/index.html#brief-overview",
    "title": "Longitudinal Analysis Using 20 Years of Australian Prospective Cohort Data",
    "section": "",
    "text": "I have had the privilege of working on the Australian Longitudinal Study on Women‚Äôs Health (ALSWH) for more than four years, focusing on maternal and child health outcomes using one of Australia‚Äôs large and bid prospective longitudinal national datasets. I led the end-to-end process ‚Äî from data cleaning and preparation to advanced statistical modelling and dissemination of results ‚Äî both in high-impact journals and at conferences.\nMy work has resulted in three peer-reviewed Q1 publications:\n- Preterm Birth\n- Low Birthweight\n- Caesarean Section and Labour Intervention\nI have also presented these findings at:\n- Public Health Association of Australia Conference - ABReN (Australian Based Ethiopian Researchers Network) ‚Äì 4th Annual Conference\n- Health in Preconception, Pregnancy and Postpartum (HiPPP) EMR-C, Australia\nThrough this work, I have strengthened my expertise in managing large-scale, multi-wave datasets, applying advanced longitudinal modelling techniques, and translating complex findings into actionable insights for both academic and policy audiences.\n\nContents Addressed in this Presentation\n\nBrief Overview and Research Objectives ‚Äì Context, scope, and significance of the project.\nData Sources ‚Äì Description of primary and linked datasets.\nData Preparation & Management Workflow ‚Äì End-to-end process, from wave-level cleaning to final panel dataset.\nMissing Data management and analysis ‚Äì Diagnostic approaches, imputation methods, and sensitivity checks.\nStatistical Modelling & Analysis ‚Äì Model selection, longitudinal methods, and causal modelling approaches.\nData Governance & Ethics ‚Äì Ethical approvals, privacy, and confidentiality measures.\nResearch Outputs & Dissemination ‚Äì Publications, conference presentations, and stakeholder engagement.\nLessons Learned & Reflections ‚Äì Challenges faced and strategies used to manage a large multi-decade dataset.\nConclusion ‚Äì Summary of contributions, skills, and future applications."
  },
  {
    "objectID": "Post_Blog/Longitudinal_Data_Analysis/index.html#contents-addressed-in-this-presentation",
    "href": "Post_Blog/Longitudinal_Data_Analysis/index.html#contents-addressed-in-this-presentation",
    "title": "Longitudinal Analysis Using 20 Years of Australian Prospective Cohort Data",
    "section": "2 Contents Addressed in this Presentation",
    "text": "2 Contents Addressed in this Presentation\n\nBrief Overview and Research Objectives ‚Äì Context, scope, and significance of the project.\nData Sources ‚Äì Description of primary and linked datasets.\nData Preparation & Management Workflow ‚Äì End-to-end process, from wave-level cleaning to final panel dataset.\nMissing Data management and analysis ‚Äì Diagnostic approaches, imputation methods, and sensitivity checks.\nStatistical Modelling & Analysis ‚Äì Model selection, longitudinal methods, and causal modelling approaches.\nData Governance & Ethics ‚Äì Ethical approvals, privacy, and confidentiality measures.\nResearch Outputs & Dissemination ‚Äì Publications, conference presentations, and stakeholder engagement.\nLessons Learned & Reflections ‚Äì Challenges faced and strategies used to manage a large multi-decade dataset.\nConclusion ‚Äì Summary of contributions, skills, and future applications."
  },
  {
    "objectID": "Post_Blog/Longitudinal_Data_Analysis/index.html#brief-overview-and-research-objectives",
    "href": "Post_Blog/Longitudinal_Data_Analysis/index.html#brief-overview-and-research-objectives",
    "title": "Longitudinal Analysis Using 20 Years of Australian Prospective Cohort Data",
    "section": "1. Brief Overview and Research Objectives",
    "text": "1. Brief Overview and Research Objectives\nThe main goal of my research was to investigate biopsychosocial risk factors for key maternal and child health outcomes over a 20-year period, while also developing reproducible workflows for large-scale longitudinal data analysis.\nSpecific objectives: Scientific Contribution\n- To identify and quantify the biopsychosocial determinants of preterm birth, low birth weight, and labour interventions over the life course.\n- To assess recurrence risks for adverse birth outcomes in subsequent pregnancies.\n- To explore causal pathways using longitudinal modelling approaches."
  },
  {
    "objectID": "Post_Blog/Longitudinal_Data_Analysis/index.html#data-sources",
    "href": "Post_Blog/Longitudinal_Data_Analysis/index.html#data-sources",
    "title": "Longitudinal Analysis Using 20 Years of Australian Prospective Cohort Data",
    "section": "2. Data Sources",
    "text": "2. Data Sources\nFor this research, I used data from the 1973‚Äì78 cohort of the Australian Longitudinal Study on Women‚Äôs Health (ALSWH), an ongoing, population-based prospective cohort study funded by the Australian Government Department of Health. ALSWH was designed to investigate the health and wellbeing of Australian women over time, with repeated follow-up surveys collecting comprehensive health, lifestyle, and sociodemographic information.\nThe baseline survey was conducted in 1996, when women from three birth cohorts (1973‚Äì78, 1946‚Äì51, and 1921‚Äì26) were recruited. Participants were randomly selected from Australia‚Äôs national medical insurance database (Medicare), which provides near-complete coverage of the population. To ensure sufficient representation of women living outside major cities, those in rural and remote areas were sampled at twice the rate of women in urban areas.\nFor my research, I focused on the 1973‚Äì78 cohort, who were aged 18‚Äì23 years at baseline. Data from this cohort span more than 20 years of follow-up, with surveys conducted approximately every three years. This cohort is particularly valuable for studying reproductive and maternal health because it captures women‚Äôs health experiences from early adulthood through to their 40s.\nThis analysis focused exclusively on the 1973‚Äì78 cohort, with data spanning over seven survey waves (20 years). The dataset contained: - Detailed reproductive histories including all pregnancies and their outcomes. - Maternal health information, including chronic and acute conditions. - Lifestyle and behavioural factors, such as smoking, alcohol consumption, physical activity, and dietary patterns. - Psychosocial indicators such as perceived stress, social support, and experiences of violence. - Socioeconomic indicators, including education, employment, and income."
  },
  {
    "objectID": "Post_Blog/Longitudinal_Data_Analysis/index.html#data-preparation-management-workflow",
    "href": "Post_Blog/Longitudinal_Data_Analysis/index.html#data-preparation-management-workflow",
    "title": "Longitudinal Analysis Using 20 Years of Australian Prospective Cohort Data",
    "section": "3. Data Preparation & Management Workflow",
    "text": "3. Data Preparation & Management Workflow\nWorking with a multi-decade, multi-wave longitudinal dataset required a structured and reproducible data management approach. My workflow was designed to ensure accuracy, transparency, and efficiency, from the wave-level cleaning stage to the creation of the final panel dataset ready for analysis.\n\n\n3.1 Wave-by-Wave Preparation\nImported raw datasets and conducted initial checks for duplicates, variable types, logical inconsistencies and missingness. Each survey wave (baseline and follow-ups) was cleaned individually before merging: - Variable naming was standardised across waves to ensure consistency. - Value categories were aligned where coding changed between waves. - Data type corrections were applied (e.g., converting string variables to numeric or date formats where needed). - Derived variables (e.g., birth order, maternal age at delivery) were calculated for each wave. - Resolved structural inconsistencies: Structural inconsistencies occur when the way a variable is defined, coded, or collected changes between survey waves, creating incompatibility for pooled or longitudinal analysis.\n- For Example: The definition and categories for marital status changed over time ‚Äî in earlier surveys, ‚Äúlegal marriage‚Äù was included as a distinct category, but this was omitted after Survey 4. Such changes can introduce misclassification if unaddressed. To resolve this, I created a unified classification scheme for marital status that allowed consistent comparison across all waves. - Documentation was updated after each cleaning step to support reproducibility.\n\n\n\n3.2 Appending and Merging\n\nAppending survey waves ‚Äì Cleaned wave files were appended into a master longitudinal dataset, ensuring a single record per woman per survey wave.\nMerging linked datasets ‚Äì Administrative datasets (Perinatal Data Collections) were merged using unique participant IDs and event dates and survey waves.\nData integrity checks ‚Äì After merging, I ran systematic cross-checks to ensure:\n\nNo duplicate IDs or wave combinations.\nCorrect alignment of event timing across sources.\nLogical consistency between self-reported and administrative data.\n\n\n\n\n\n3.3 Reshaping Data and Declaring the Panel Structure\nTo conduct time-varying and repeated-measures analyses: - I reshaped the data from wide to long format using reshape long, which is essential for longitudinal modelling. - I created lag and lead variables to capture sequential relationships (e.g., prior birth outcomes, health history). - I declared the dataset as panel data using: ‚Äúxtset idalias child_order‚Äù"
  },
  {
    "objectID": "Post_Blog/Longitudinal_Data_Analysis/index.html#data-preparation-management-workflow-1",
    "href": "Post_Blog/Longitudinal_Data_Analysis/index.html#data-preparation-management-workflow-1",
    "title": "Longitudinal Analysis Using 20 Years of Australian Prospective Cohort Data",
    "section": "3. Data Preparation & Management Workflow",
    "text": "3. Data Preparation & Management Workflow\nWave-by-Wave Preparation Each survey wave (baseline and follow-ups) was cleaned individually before merging: - Variable naming was standardised** across waves to ensure consistency (e.g., harmonising ‚Äúcsec‚Äù and ‚Äúcs_b‚Äù into ‚Äúcaesarean‚Äù). - Value categories were aligned where coding changed between waves. - Data type corrections were applied (e.g., converting string variables to numeric or date formats where needed). - Derived new variables: I generated derived variables for analysis. Derived variables are new variables created from one or more existing variables, often by transformation, combination, or aggregation.\n- Examples from this project:\n- Birth order indicator derived from multiple child-specific variables across waves.\n- History of preterm birth calculated using prior pregnancy records and gestational age variables.\n- Lifetime exposure to partner violence generated by combining reports from multiple survey waves. All derived variables were labelled clearly, with detailed documentation on the source variables, transformation logic, and rationale for their creation. - Resolved structural inconsistencies: ‚Äì Instances where the definition, wording, or response options for a variable changed between survey waves, creating incompatibility for pooled or longitudinal analysis.\n- For Example: In ALSWH, the definition and categories for marital status changed over time ‚Äî in earlier surveys, ‚Äúlegal marriage‚Äù was included as a distinct category, but this was omitted after Survey 4. Such changes can introduce misclassification if unaddressed. To resolve this, I created a unified classification scheme for marital status that allowed consistent comparison across all waves. - Documented variables added, removed, or restructured by ALSWH over time."
  },
  {
    "objectID": "Post_Blog/Longitudinal_Data_Analysis/index.html#data-governance-ethics",
    "href": "Post_Blog/Longitudinal_Data_Analysis/index.html#data-governance-ethics",
    "title": "Longitudinal Analysis Using 20 Years of Australian Prospective Cohort Data",
    "section": "6. Data Governance & Ethics",
    "text": "6. Data Governance & Ethics\nWorking with the ALSWH data and linked administrative datasets required strict adherence to ethical standards and data governance protocols.\n\nI prepared and submitted human research ethics applications specifically for linked and longitudinal data projects, receiving approval.\nFor this project, I ensured compliance with the NHMRC National Statement on Ethical Conduct in Human Research, the Privacy Act 1988, and relevant state-based health privacy legislation.\nData was stored securely and analysed only in approved environments, with access restricted to authorised personnel.\nI executed rigorous data accuracy and sample integrity checks, identifying and correcting:\n\nDuplicate observations\nOutliers and structural errors\nIncorrect data entries\nMissing values using suitable methods\n\n\nBy combining methodological rigour with strict privacy and confidentiality safeguards, I ensured that the analysis met both scientific and ethical requirements while protecting participant trust.\n\nResearch Outputs & Dissemination ‚Äì Publications, conference presentations, and stakeholder engagement."
  },
  {
    "objectID": "Post_Blog/Longitudinal_Data_Analysis/index.html#research-outputs-dissemination",
    "href": "Post_Blog/Longitudinal_Data_Analysis/index.html#research-outputs-dissemination",
    "title": "Longitudinal Analysis Using 20 Years of Australian Prospective Cohort Data",
    "section": "7. Research Outputs & Dissemination",
    "text": "7. Research Outputs & Dissemination\nThe findings from my longitudinal analyses using the Australian Longitudinal Study on Women‚Äôs Health (1973‚Äì78 cohort) were disseminated through high-impact peer-reviewed publications, multiple conferences, and direct stakeholder engagement to inform policy and practice.\n\n\n7.1 Peer-Reviewed Publications\n\nBizuayehu HM, Harris ML, Chojenta C, Forder PM, Loxton D.\nBiopsychosocial factors influencing the occurrence and recurrence of preterm singleton births among Australian women: A prospective cohort study. Midwifery, 2022; 110:103334.\nhttps://doi.org/10.1016/j.midw.2021.103334\nBizuayehu HM, Harris ML, Chojenta C, Forder PM, Loxton D.\nLow birth weight and its associated biopsychosocial factors over a 19-year period: findings from a national cohort study. European Journal of Public Health, 2021.\nhttps://doi.org/10.1093/eurpub/ckab181.477\nBizuayehu HM, Harris ML, Chojenta C, et al.\nPatterns of Labour Interventions and Associated Maternal Biopsychosocial Factors in Australia: a Path Analysis. Reproductive Sciences, 2023; 30: 2767‚Äì2779.\nhttps://doi.org/10.1007/s43032-023-01219-7\n\n\n\n\n7.2 Conference Presentations\n\nPreterm birth and its biopsychosocial predictors: a national prospective cohort study in Australia\nAustralian Public Health Conference (PHAA), October 19‚Äì30, 2020.\nConference Program & Abstract\nLow birth weight rate and predictors: a prospective study using the Australian Longitudinal Study on Women‚Äôs Health\nStrategic Centre for African Research, Engagement and Partnerships (CARE-P) & Africa Postgraduate Students Association (APSA) Conference, October 16, 2020.\nFocused on maternal and child health research and longitudinal method application between Australia and Ethiopia.\nPatterns of labour interventions and associated biopsychosocial factors: path analysis of a prospective cohort study (1996‚Äì2015)\nInaugural Conference of the Health in Preconception Pregnancy and Postpartum (HiPPP) & Early and Mid-career Researcher Collective (EMR-C), December 3, 2020.\n\n\n\n\n7.3 Knowledge Translation and Impact\n\nPublished in open-access journals to ensure broad accessibility.\n\nContributed to ALSWH methodological resources, enhancing institutional data management practices.\n\nThis work strengthened the national evidence base on the life-course determinants of adverse birth outcomes, translating complex longitudinal findings into actionable insights for both public health policy and clinical practice."
  },
  {
    "objectID": "Post_Blog/Longitudinal_Data_Analysis/index.html#missing-data-management-and-analysis",
    "href": "Post_Blog/Longitudinal_Data_Analysis/index.html#missing-data-management-and-analysis",
    "title": "Longitudinal Analysis Using 20 Years of Australian Prospective Cohort Data",
    "section": "4. Missing Data management and analysis",
    "text": "4. Missing Data management and analysis\nIn longitudinal studies, missing data is almost inevitable due to participant attrition, skipped questions, evolving survey designs, and structural inconsistencies. If not addressed appropriately, missingness can reduce statistical power, bias estimates, and compromise the validity of conclusions.\nIn this project, I developed and implemented a multi-stage missing data management plan for the ALSWH 1973‚Äì78 cohort that combined diagnostic assessment, mechanism classification, appropriate imputation, and sensitivity checks. This approach ensured that findings were robust and reproducible. If missing data is not handled appropriately, can introduce bias, reduce statistical power, and compromise validity of the findings.\n\n\n4.1 Scientific Context\nLongitudinal studies, such as ALSWH, collect data from the same participants repeatedly over long periods. While this design allows for rich analysis of change over time, it is also prone to loss to follow-up and intermittent missingness.\nInternational best practice suggests that when missingness exceeds 5‚Äì10% for a variable, imputation should be considered to improve precision and reduce bias (Rubin, 1987; Sterne et al., 2009). In this project: - Maternal pre-pregnancy BMI and age at menarche had missingness above 10%. - Missingness was often non-monotone, requiring tailored imputation strategies for different variable types.\n\n\n\n4.2 Diagnostic Approaches\nI began by systematically assessing the extent and structure of missingness:\n\nUsed STATA packages misschk, mdesc, and xtpatternvar to quantify missing values per variable and identify patterns.\nClassified patterns into monotone (e.g., dropout) and intermittent (e.g., missed responses but later re-entry).\nInspected missingness by birth order and survey wave to account for pregnancy-specific variables.\nFlagged variables with &gt;5% missingness for potential imputation.\n\n\n\n\n4.3 Missing Data Mechanisms\nBefore selecting imputation methods, I classified variables according to the statistical mechanism of missingness:\n\nMCAR ‚Äì Missing Completely at Random: The probability of a value being missing is unrelated to either the observed or unobserved data.\n\nMAR ‚Äì Missing at Random: The probability of missingness depends only on observed data, not the missing values themselves.\n\nMNAR ‚Äì Missing Not at Random: The probability of missingness depends on the unobserved data itself.\n\n\n\n\n4.4 Criteria for Imputation\nA rule of thumb from the literature recommends initiating imputation when the missing proportion exceeds 5‚Äì10% of the variable‚Äôs observations. In this study: - Maternal BMI and age at menarche exceeded 10% missingness. - Time-varying health conditions (e.g., hypertension) had intermittent missingness between waves.\n\n\n4.5 Imputation Methods Applied in This Project\na) Mean Imputation (Row Mean)\n- Applied to pre-pregnancy BMI (&lt;15% missingness).\n- Used the participant‚Äôs own available BMI values from other waves to calculate a personalised row mean.\n- Observed mean: 24.46 kg/m¬≤; Imputed mean: 24.63 kg/m¬≤ ‚Äî indicating close alignment.\nb) Multiple Imputation (MI)\n- Applied to age at menarche (&gt;10% missingness), a static variable recorded only once (Survey 2).\n- Used Multivariate Imputation by Chained Equations (MICE) with 20 imputations, following guidelines to reduce sampling error.\n- Incorporated auxiliary variables predictive of missingness.\n- Conducted diagnostics: density plots, distribution overlays, and observed vs.¬†imputed comparison.\nc) Last Observation Carried Forward (LOCF)\n- Used for chronic conditions (e.g., hypertension, diabetes) that persist after diagnosis.\n- Ensured stability in prevalence estimates over time.\nd) Next Observation Carried Backward (NOCB)\n- Applied to lifetime exposure variables (e.g., partner violence). If reported in later waves, status was carried backward.\ne) Combined LOCF + NOCB\n- Applied to variables requiring lifetime ascertainment, maximising completeness in both time directions; for example, country of birth.\n\n\n\n4.6 Sensitivity Analyses\nTo ensure the robustness of results: - Conducted complete-case analysis alongside imputed datasets. - Compared distributions of observed vs.¬†imputed data to detect anomalies. - Re-estimated models with alternative imputation strategies to check stability of effect estimates.\n\nTable: Summary of Missing Data Handling Techniques\n\n\n\n\n\n\n\n\n\nVariable Type\nExample Variable\nMethod Applied\nRationale\n\n\n\n\nStatic, continuous\nAge at menarche\nMultiple Imputation (20 datasets, chained equations)\nSingle-time measurement; high missingness; categorical imputation adjusted for predictors\n\n\nTime-varying, continuous\nBMI prior to birth\nRow mean imputation using available values from same participant\nPreserves within-person trajectory; missing at intermittent waves\n\n\nChronic binary condition\nHypertension, diabetes\nLast Observation Carried Forward (LOCF)\nLifetime conditions assumed persistent once reported\n\n\nLifetime event binary\nEver violated by partner\nLOCF + Next Observation Carried Backward (NOCB)\nEnsures capture of lifetime exposure regardless of reporting wave\n\n\n\n\nIn summary, the combination of diagnostic mapping, mechanism classification, tailored imputation, and sensitivity analyses allowed me to address missingness in a scientifically sound manner, maximising the analytic value of this 20-year longitudinal dataset.\n##5. Statistical Modelling & Analysis ‚Äì Model selection, longitudinal methods, and modelling approaches.\nIn this study, statistical modelling was guided by the biopsychosocial model, which provided a structured framework for identifying and categorising potential risk factors. This approach ensured that biological, psychological, and social determinants were considered holistically when examining adverse pregnancy outcomes.\nThe statistical strategy was designed to: - Correctly model repeated measures for women having &gt;= births during the study period. - Adjust for both time-varying and time-invariant covariates. - Select parsimonious yet clinically meaningful models. - Address missingness using variable-specific imputation strategies.\n\n\n\n5.1 Model Selection Strategy\nModel selection followed a multi-stage, evidence-based process:\n\nLiterature Review\nExisting literature on prematurity and related birth outcomes was reviewed to identify relevant variables available in the ALSWH dataset. Factors were categorised according to the biopsychosocial framework.\nUnivariate Screening\n\nEach potential predictor was tested individually against the outcome of interest.\n\nCovariates with unadjusted associations at p &lt; 0.25 were selected for consideration in the multivariable model.\n\nThis inclusive threshold ensured potentially important predictors were not excluded prematurely.\n\nMultivariable Model Building\n\nCandidate variables were refined using:\n\nBayesian Information Criterion (BIC) ‚Äì prioritising model parsimony while balancing goodness-of-fit.\nChange-in-Estimate Criterion ‚Äì retaining variables that materially influenced effect sizes or confidence intervals.\n\nOnly variables with biological and conceptual relevance and statistical contribution were retained in the final models.\n\n\n\n\n\n5.2 Handling of Missing Data in Models\nsome predictors had notable missingness: - BMI ‚Äì Imputed using each participant‚Äôs row mean across available survey waves preceding the birth. - Age at Menarche ‚Äì Imputed using Multiple Imputation by Chained Equations (MICE) with 20 imputations, incorporating auxiliary variables predictive of missingness.\nThe imputed values were included in all relevant analyses.\n\n\n\n5.3 Descriptive and Outcome Measures\nBefore modelling, descriptive statistics summarised participant characteristics: - Categorical variables ‚Äì Frequency and proportion. - Continuous variables ‚Äì Mean and standard deviation.\nOutcome calculations: - Overall Preterm Birth Rate ‚Äì Total number of preterm births divided by total number of births. - Recurrence Rate ‚Äì Number of repeat preterm births divided by total births occurring after a prior preterm birth (i.e., ‚â• second-order births to women with preterm history).\n\n\n\n5.4 Longitudinal Methods\nGiven the panel structure of the ALSWH data, many women contributed multiple birth records, resulting in within-person correlation.\nTo account for this: - First births only ‚Äì Binomial logistic regression was used. - All births ‚Äì Generalised Linear Mixed Model (GLMM) with a random intercept for participant ID was applied, adjusting for clustering of births within the same woman.\nThis mixed-effects framework: - Controlled for unmeasured time-invariant characteristics of individuals. - Improved efficiency and reduced bias in estimates.\n\n\n\n5.5 Modelling Steps\n\nData Preparation\n\nDeclared longitudinal structure using xtset idalias child_order in Stata.\n\nReshaped to long format for repeated measures modelling.\n\nUnivariate Analysis\n\nEach predictor assessed; p &lt; 0.25 threshold for progression.\n\nMultivariate Modelling\n\nUsed xtmelogit (GLMM) for all-births models.\n\nApplied BIC and effect-size change criteria.\n\nDiagnostics & Fit\n\nChecked intra-class correlation (ICC), ROC curves, and residual plots.\n\nSensitivity Analyses\n\nCompared complete-case vs.¬†imputed results.\n\nTested alternative correlation structures.\n\n\n\n\n\n5.6 Example Syntax ‚Äì GLMM in Stata\n\nDeclare panel structure xtset idalias child_order\nFit GLMM with multiple imputation mi estimate: xtmelogit preterm_birth /// i.age_group c.bmi i.smoking_status i.education_level || idalias:, covariance(independent) or\n\nSummary:\nThe modelling approach combined rigorous univariate screening, theory-driven multivariable selection, and advanced longitudinal and causal methods. This ensured that the identified predictors of preterm birth and labour interventions were robust, interpretable, and grounded in the biopsychosocial framework."
  },
  {
    "objectID": "Post_Blog/Longitudinal_Data_Analysis/index.html#lessons-learned-reflections-strategies-used-to-manage-a-large-multi-decade-dataset.",
    "href": "Post_Blog/Longitudinal_Data_Analysis/index.html#lessons-learned-reflections-strategies-used-to-manage-a-large-multi-decade-dataset.",
    "title": "Longitudinal Analysis Using 20 Years of Australian Prospective Cohort Data",
    "section": "8. Lessons Learned & Reflections ‚Äì Strategies used to manage a large multi-decade dataset.",
    "text": "8. Lessons Learned & Reflections ‚Äì Strategies used to manage a large multi-decade dataset.\nWorking with a large, multi-decade dataset like the Australian Longitudinal Study on Women‚Äôs Health (ALSWH) was both a privilege and a challenge.\nWhen I began this work, I had just arrived from Ethiopia, stepping into a research environment where I had not handled longitudinal data of this scale.\nThis meant I needed to quickly adapt ‚Äî not only to the analytical complexities of repeated-measures data, but also to understanding the broader Australian health system context to interpret findings correctly and meaningfully.\n\n\n8.1 The Nature of the Longitudinal Data\nLongitudinal datasets are living entities ‚Äî they grow, change, and adapt over time.\nIn ALSWH: - Some variables collected in early surveys were removed in later waves. - New variables were added to reflect emerging health priorities. - Even definitions and response categories shifted ‚Äî for example, the way marital status was recorded changed after Survey 4, omitting ‚Äúlegal marriage‚Äù as a category.\nThese changes occurred for reasons such as: - Participant feedback on sensitivity of questions. - Shifting policy priorities in public health. - Advances in health knowledge and improved survey design.\nOn top of this: - It requires harmonising variable formats for longitudinal analysis. - The complexity of linking multiple datasets and preserving participant-level consistency over two decades.\n\n\n\n8.2 Strategies for Managing a Large Longitudinal Dataset\nTo address these challenges, I developed a structured workflow:\n\nDeep Understanding of the Data Source\n\nRead technical reports for each wave to grasp methodology and variable context.\n\nReviewed data dictionaries in detail, mapping variable name changes and coding schemes.\n\nAnalysed previous publications using ALSWH data to understand standard practices.\n\nIdentifying Research Gaps\n\nCross-referenced my research interests with existing literature to ensure novelty.\n\nAligned project concepts with the biopsychosocial framework to cover biological, psychological, and social domains.\n\nContinuous Skills Development\n\nAttended the ALSWH Data Workshop for direct training from custodians and research team.\n\nCompleted advanced statistical courses:\n\nApplied Longitudinal Analysis (BIOS6990)\n\nGeneralised Linear Models (BIOS6940)\n\n\nEngaged in discussions with supervisors, senior mentors, and the research team.\n\nPursued targeted training in causal modelling and missing data strategies.\n\nData Management\n\nCleaned each wave individually before merging.\n\nApplied consistent naming conventions and maintained a central codebook.\n\nDocumented every data transformation step to ensure reproducibility and transparency.\n\n\n\n\n\n8.3 Reflections on the Journey\nThis work taught me that longitudinal research is as much about patience, persistence, and strategic thinking as it is about statistical modelling.\nI learned: - Data storytelling ‚Äì turning complex multi-decade trends into clear, actionable public health insights. - Adaptability ‚Äì navigating changing variable definitions, evolving health policies, and shifting analytical needs. - Collaboration ‚Äì leveraging expertise from statisticians, domain experts, and data custodians.\n\nLarge longitudinal datasets are like living organisms ‚Äî to work with them successfully, you must grow, change, and adapt alongside them."
  },
  {
    "objectID": "Post_Blog/Longitudinal_Data_Analysis/index.html#conclusion-contributions-skills-and-future-applications.",
    "href": "Post_Blog/Longitudinal_Data_Analysis/index.html#conclusion-contributions-skills-and-future-applications.",
    "title": "Longitudinal Analysis Using 20 Years of Australian Prospective Cohort Data",
    "section": "9. Conclusion ‚Äì Contributions, skills, and future applications.",
    "text": "9. Conclusion ‚Äì Contributions, skills, and future applications.\nThis project has been an important and rewarding stage in my large and complex project management and research career ‚Äî applying advanced longitudinal data analysis to more than 20 years of prospective cohort data from the Australian Longitudinal Study on Women‚Äôs Health (ALSWH, 1973‚Äì78 cohort). This project has provided valuable opportunities to build skills, contribute new evidence, and engage with diverse research and policy audiences.\n\n\n9.1 Contributions\nThrough this work, I have:\n\nApplied rigorous statistical methods ‚Äî from univariate screening to multivariable modelling ‚Äî using Bayesian Information Criterion (BIC) and Generalised Linear Mixed Models (GLMMs) to handle repeated measures and complex correlation structures.\n\nImplemented advanced missing data strategies, including mean imputation, Last Observation Carried Forward (LOCF), Next Observation Carried Backward (NOCB), and multiple imputation with chained equations, paired with diagnostic plots and sensitivity checks.\n\nManaged complex, evolving datasets across seven survey waves, addressing structural inconsistencies, changes in derived variables, and harmonisation of variable definitions over time.\n\nAdhered to high ethical and governance standards, securing human research ethics approvals, navigating privacy legislation, and ensuring secure data storage and handling.\n\nGenerated new evidence on maternal and child health outcomes ‚Äî including preterm birth, low birth weight, and patterns of labour interventions ‚Äî framed within the biopsychosocial model to capture the complexity of social, behavioural, and biological influences.\nDisseminated findings widely through high-impact journal articles, conference presentations, and professional networks.\n\n\n\n\n9.2 Skills Strengthened\nThrough this project, I strengthened my:\n\nTechnical expertise in longitudinal modelling, causal pathways, and missing data handling.\n\nData governance skills, including ethics applications, data linkage protocols, and privacy compliance.\n\nProject management abilities, overseeing multi-wave data preparation, documentation, and reproducibility planning.\n\nScience communication, translating complex results for diverse audiences ‚Äî from policymakers to academic peers.\n\n\n\n\n9.3 Publications\nMy work has resulted in three peer-reviewed publications, and you may refer to each paper for detailed methods and findings. Portions of the code used to generate these results are also available and can be adapted for similar projects.\n\nPreterm Birth ‚Äì Biopsychosocial factors influencing the occurrence and recurrence of preterm birth over two decades.\n\nLow Birthweight ‚Äì Longitudinal patterns and predictors over a 19-year follow-up.\n\nCaesarean Section and Labour Intervention ‚Äì Path analysis of maternal biopsychosocial factors influencing labour interventions.\n\nThese papers provide full methodological details, statistical approaches, and the public health implications of my findings.\n\n\nFinal Reflection:\nI have had the privilege of contributing to one of Australia‚Äôs most significant longitudinal studies, producing results that are both methodologically robust and policy-relevant.\nThe lessons I have learned ‚Äî about rigour, adaptability, and the power of data to inform change ‚Äî will continue to shape my work. I am committed to applying these skills to future research that bridges advanced analytics with real-world health outcomes, both in Australia and globally.\n\nIf you are interested in exploring each paper in greater depth, including the methods applied, please follow the links below. I hope you find them insightful.\n\nPreterm Birth\n\nLow Birthweight\n\nCaesarean Section and Labour Intervention"
  },
  {
    "objectID": "Post_Blog/Longitudinal_Data_Analysis/index.html#statistical-modelling-analysis",
    "href": "Post_Blog/Longitudinal_Data_Analysis/index.html#statistical-modelling-analysis",
    "title": "Longitudinal Analysis Using 20 Years of Australian Prospective Cohort Data",
    "section": "5. Statistical Modelling & Analysis",
    "text": "5. Statistical Modelling & Analysis\nGuided by the biopsychosocial model, considering biological, psychological, and social determinants.\nModel Strategy: - Modelled repeated measures (‚â•1 birth)\n- Adjusted for time-varying and time-invariant covariates\n- Parsimonious, clinically meaningful models\n- Missing data handled with variable-specific imputation\n\n\n5.1 Model Selection\n\nLiterature review to identify variables\n\nUnivariate screening (p &lt; 0.25 threshold)\n\nMultivariable refinement (BIC, change-in-estimate, clinical relevance)\n\n\n\n\n5.2 Missing Data in Models\n\nBMI ‚Üí Row mean imputation\n\nAge at menarche ‚Üí MICE (20 imputations)\n\n\n\n\n5.3 Descriptive & Outcome Measures\n\nCategorical: frequency, proportion\n\nContinuous: mean, SD\n\nPreterm birth rate = total preterm births / total births\n\nRecurrence = repeat preterm births / subsequent births after prior preterm birth\n\n\n\n\n5.4 Longitudinal Methods\n\nFirst births ‚Üí Binomial logistic regression\n\nAll births ‚Üí GLMM with random intercept for participant ID\n\n\n\n\n5.5 Modelling Steps\n\nDeclare panel structure in Stata (xtset idalias child_order)\n\nReshape to long format\n\nUnivariate analysis (p&lt;0.25 threshold)\n\nGLMM model fitting (xtmelogit)\n\nDiagnostics: ICC, ROC, residuals\n\nSensitivity analyses\n\n\n\n\n5.6 Example Syntax ‚Äì GLMM in Stata\nxtset idalias child_order mi estimate: xtmelogit preterm_birth i.age_group c.bmi i.smoking_status i.education_level || idalias:, covariance(independent) or\n\nSummary:\nThe modelling approach combined rigorous univariate screening, theory-driven multivariable selection, and advanced longitudinal and causal methods. This ensured that the identified predictors of preterm birth and labour interventions were robust, interpretable, and grounded in the biopsychosocial framework."
  },
  {
    "objectID": "Post_Blog/Longitudinal_Data_Analysis/index.html#lessons-learned-reflections",
    "href": "Post_Blog/Longitudinal_Data_Analysis/index.html#lessons-learned-reflections",
    "title": "Longitudinal Analysis Using 20 Years of Australian Prospective Cohort Data",
    "section": "8. Lessons Learned & Reflections",
    "text": "8. Lessons Learned & Reflections\nWorking with a large, multi-decade dataset like the Australian Longitudinal Study on Women‚Äôs Health (ALSWH) was both a privilege and a challenge.\nWhen I began this work, I had just arrived from Ethiopia, stepping into a research environment where I had not handled longitudinal data of this scale.\nThis meant I needed to quickly adapt ‚Äî not only to the analytical complexities of repeated-measures data, but also to understanding the broader Australian health system context to interpret findings correctly and meaningfully.\n\n8.1 The Nature of the Longitudinal Data\nLongitudinal datasets are living entities ‚Äî they grow, change, and adapt over time.\nIn ALSWH: - Some variables collected in early surveys were removed in later waves. - New variables were added to reflect emerging health priorities. - Even definitions and response categories shifted ‚Äî for example, the way marital status was recorded changed after Survey 4, omitting ‚Äúlegal marriage‚Äù as a category.\nThese changes occurred for reasons such as: - Participant feedback on sensitivity of questions. - Shifting policy priorities in public health. - Advances in health knowledge and improved survey design.\nOn top of this: - It requires harmonising variable formats for longitudinal analysis. - The complexity of linking multiple datasets and preserving participant-level consistency over two decades.\n\n\n8.2 Strategies for Managing a Large Longitudinal Dataset\nTo address these challenges, I developed a structured workflow:\n\nDeep Understanding of the Data Source\n\nRead technical reports for each wave to grasp methodology and variable context.\n\nReviewed data dictionaries in detail, mapping variable name changes and coding schemes.\n\nAnalysed previous publications using ALSWH data to understand standard practices.\n\nIdentifying Research Gaps\n\nCross-referenced my research interests with existing literature to ensure novelty.\n\nAligned project concepts with the biopsychosocial framework to cover biological, psychological, and social domains.\n\nContinuous Skills Development\n\nAttended the ALSWH Data Workshop for direct training from custodians and research team.\n\nCompleted advanced statistical courses:\n\nApplied Longitudinal Analysis (BIOS6990)\n\nGeneralised Linear Models (BIOS6940)\n\n\nEngaged in discussions with supervisors, senior mentors, and the research team.\n\nPursued targeted training in causal modelling and missing data strategies.\n\nData Management\n\nCleaned each wave individually before merging.\n\nApplied consistent naming conventions and maintained a central codebook.\n\nDocumented every data transformation step to ensure reproducibility and transparency.\n\n\n\n\n8.3 Reflections on the Journey\nThis work taught me that longitudinal research is as much about patience, persistence, and strategic thinking as it is about statistical modelling.\nI learned: - Data storytelling ‚Äì turning complex multi-decade trends into clear, actionable public health insights. - Adaptability ‚Äì navigating changing variable definitions, evolving health policies, and shifting analytical needs. - Collaboration ‚Äì leveraging expertise from statisticians, domain experts, and data custodians.\n\nLarge longitudinal datasets are like living organisms ‚Äî to work with them successfully, you must grow, change, and adapt alongside them."
  },
  {
    "objectID": "Post_Blog/Longitudinal_Data_Analysis/index.html#conclusion",
    "href": "Post_Blog/Longitudinal_Data_Analysis/index.html#conclusion",
    "title": "Longitudinal Analysis Using 20 Years of Australian Prospective Cohort Data",
    "section": "9. Conclusion",
    "text": "9. Conclusion\nThis project has been an important and rewarding stage in my large and complex project management and research career ‚Äî applying advanced longitudinal data analysis to more than 20 years of prospective cohort data from the Australian Longitudinal Study on Women‚Äôs Health (ALSWH, 1973‚Äì78 cohort). This project has provided valuable opportunities to build skills, contribute new evidence, and engage with diverse research and policy audiences.\n\n9.1 Contributions\nThrough this work, I have: - Applied rigorous statistical methods ‚Äî from univariate screening to multivariable modelling ‚Äî using Bayesian Information Criterion (BIC) and Generalised Linear Mixed Models (GLMMs) to handle repeated measures and complex correlation structures. - Implemented advanced missing data strategies, including mean imputation, Last Observation Carried Forward (LOCF), Next Observation Carried Backward (NOCB), and multiple imputation with chained equations, paired with diagnostic plots and sensitivity checks. - Managed complex, evolving datasets across seven survey waves, addressing structural inconsistencies, changes in derived variables, and harmonisation of variable definitions over time. - Adhered to high ethical and governance standards, securing human research ethics approvals, navigating privacy legislation, and ensuring secure data storage and handling. - Generated new evidence on maternal and child health outcomes ‚Äî including preterm birth, low birth weight, and patterns of labour interventions ‚Äî framed within the biopsychosocial model to capture the complexity of social, behavioural, and biological influences. - Disseminated findings widely through high-impact journal articles, conference presentations, and professional networks.\n\n\n9.2 Skills Strengthened\nThrough this project, I strengthened my: - Technical expertise in longitudinal modelling, causal pathways, and missing data handling. - Data governance skills, including ethics applications, data linkage protocols, and privacy compliance. - Project management abilities, overseeing multi-wave data preparation, documentation, and reproducibility planning. - Science communication, translating complex results for diverse audiences ‚Äî from policymakers to academic peers.\n\n\n9.3 Publications\nMy work has resulted in three peer-reviewed publications, and you may refer to each paper for detailed methods and findings. Portions of the code used to generate these results are also available and can be adapted for similar projects.\n\nPreterm Birth ‚Äì Biopsychosocial factors influencing the occurrence and recurrence of preterm birth over two decades.\nLow Birthweight ‚Äì Longitudinal patterns and predictors over a 19-year follow-up.\nCaesarean Section and Labour Intervention ‚Äì Path analysis of maternal biopsychosocial factors influencing labour interventions.\n\n\nFinal Reflection:\nI have had the privilege of contributing to one of Australia‚Äôs most significant longitudinal studies, producing results that are both methodologically robust and policy-relevant.\nThe lessons I have learned ‚Äî about rigour, adaptability, and the power of data to inform change ‚Äî will continue to shape my work. I am committed to applying these skills to future research that bridges advanced analytics with real-world health outcomes, both in Australia and globally.\n\nIf you are interested in exploring each paper in greater depth, including the methods applied, please follow the links below. I hope you find them insightful.\n\nPreterm Birth\n\nLow Birthweight\n\nCaesarean Section and Labour Intervention"
  },
  {
    "objectID": "Post_Blog/Missing_Data_Analysis/index.html#introduction-1",
    "href": "Post_Blog/Missing_Data_Analysis/index.html#introduction-1",
    "title": "Missing Data Management and Analysis",
    "section": "Introduction",
    "text": "Introduction\nMissing data is a common challenge in survey, clinical, and population-based datasets.\nIt can arise from participant dropout, skipped responses, changes in study design, or inconsistencies in data collection.\nIf not addressed appropriately, missingness can introduce bias, reduce statistical power, and undermine the reliability of results.\nThis work showcases two complementary missing data management projects, developed across different datasets and research contexts:\n\nStata-based missing data diagnostics and imputation\n\nUsed structured diagnostic tools to quantify and visualise missingness, and identify patterns.\n\nApplied targeted imputation methods, including Multiple Imputation (MI), Last Observation Carried Forward (LOCF), Next Observation Carried Backward (NOCB), and hybrid approaches depending on variable type and study design.\n\nR-based reproducible workflows for missing data\n\nDesigned flexible pipelines for detecting, cleaning, and imputing missing values.¬†\nDemonstrated simple (mean/median) and advanced methods (MICE, model-based imputation), as well as forward/backward filling and participant-level imputation.\n\n\nBy combining statistical rigour, methodological adaptability, and transparent documentation, these approaches ensure that findings remain robust, reproducible, and comparable across studies, regardless of the data source."
  },
  {
    "objectID": "Post_Blog/Missing_Data_Analysis/index.html#stata-based-missing-data-management-and-analysis-project",
    "href": "Post_Blog/Missing_Data_Analysis/index.html#stata-based-missing-data-management-and-analysis-project",
    "title": "Missing Data Management and Analysis",
    "section": "STATA-Based Missing Data management and Analysis Project",
    "text": "STATA-Based Missing Data management and Analysis Project\nSome outputs are not presented here, as certain variables had small cell counts that could potentially compromise participant confidentiality.\nWhere the number of observations fell below accepted thresholds, they were withheld to remain in line with the minimum data reporting standards for sensitive datasets.\nThe overall and aggregated results, however, have been published and are available in the following peer-reviewed journal articles:\nMy work has resulted in three peer-reviewed Q1 publications:\n- Preterm Birth: https://doi.org/10.1016/j.midw.2022.103334\n- Low Birthweight: https://doi.org/10.1093/eurpub/ckab033\n- Caesarean Section and Labour Intervention: https://doi.org/10.1007/s43032-023-01219-7\n\nIn large-scale and longitudinal data, missing data is almost inevitable. It can arise from participant attrition, skipped responses, evolving survey designs, or inconsistencies in measurement over time.\nIf not addressed appropriately, missingness can reduce statistical power, bias estimates, and compromise the validity of conclusions.\nThis Stata-based project was designed to:\n- Diagnose the extent and patterns of missingness using structured commands (misschk, mdesc, xtpatternvar).¬† - Classify the underlying missing data mechanisms (MCAR, MAR, MNAR) to guide appropriate handling strategies.¬† - Apply targeted imputation methods, including Multiple Imputation (MI), Last Observation Carried Forward (LOCF), Next Observation Carried Backward (NOCB), and combined approaches.¬†\nBy applying this systematic workflow, I ensured that the final analyses were methodologically robust, ethically compliant, and suitable for informing high-impact research on maternal and child health.\n\n1.1 Scientific Context\nLongitudinal studies, such as ALSWH, collect data from the same participants repeatedly over long periods. While this design allows for rich analysis of change over time, it is also prone to loss to follow-up and intermittent missingness.\nInternational best practice suggests that when missingness exceeds 5‚Äì10% for a variable, imputation should be considered to improve precision and reduce bias (Rubin, 1987; Sterne et al., 2009). In this project:\n- Maternal pre-pregnancy BMI and age at menarche had missingness above 10%.\n- Missingness was often non-monotone, requiring tailored imputation strategies for different variable types.\n\n\n\n1.2 Diagnostic Approaches\nI began by systematically assessing the extent and structure of missingness:\n\nUsed STATA packages misschk, mdesc, and xtpatternvar to quantify missing values per variable and identify patterns.\nClassified patterns into monotone (e.g., dropout) and intermittent (e.g., missed responses but later re-entry).\nInspected missingness by birth order and survey wave to account for pregnancy-specific variables.\nFlagged variables with &gt;5% missingness for potential imputation.\n\n\n\n\n1.3 Missing Data Mechanisms\nBefore selecting imputation methods, I classified variables according to the statistical mechanism of missingness:\n\nMCAR ‚Äì Missing Completely at Random: The probability of a value being missing is unrelated to either the observed or unobserved data.\nMAR ‚Äì Missing at Random: The probability of missingness depends only on observed data, not the missing values themselves.\nMNAR ‚Äì Missing Not at Random: The probability of missingness depends on the unobserved data itself.\n\n\n\n\n1.4 Criteria for Imputation\nA rule of thumb from the literature recommends initiating imputation when the missing proportion exceeds 5‚Äì10% of the variable‚Äôs observations. In this study:\n- Maternal BMI and age at menarche exceeded 10% missingness.\n- Time-varying health conditions (e.g., hypertension) had intermittent missingness between waves.\n\n\n1.5 Imputation Methods Applied Using STATA\nThis Project has been completed using ALSWH data source\na) Mean Imputation (Row Mean)\n- Applied to pre-pregnancy BMI (&lt;15% missingness).\n- Used the participant‚Äôs own available BMI values from other waves to calculate a personalised row mean.\n- Observed mean: 24.46 kg/m¬≤; Imputed mean: 24.63 kg/m¬≤ ‚Äî indicating close alignment.\nb) Multiple Imputation (MI)\n- Applied to age at menarche (&gt;10% missingness), a static variable recorded only once (Survey 2).\n- Used Multivariate Imputation by Chained Equations (MICE) with 20 imputations, following guidelines to reduce sampling error.\n- Incorporated auxiliary variables predictive of missingness.\n- Conducted diagnostics: density plots, distribution overlays, and observed vs.¬†imputed comparison.\nc) Last Observation Carried Forward (LOCF)\n- Used for chronic conditions (e.g., hypertension, diabetes) that persist after diagnosis.\n- Ensured stability in prevalence estimates over time.\nd) Next Observation Carried Backward (NOCB)\n- Applied to lifetime exposure variables (e.g., partner violence). If reported in later waves, status was carried backward.\ne) Combined LOCF + NOCB\n- Applied to variables requiring lifetime ascertainment, maximising completeness in both time directions; for example, country of birth.\n\n\n\n1.6 Sensitivity Analyses\nTo ensure the robustness of results: - Conducted complete-case analysis alongside imputed datasets. - Compared distributions of observed vs.¬†imputed data to detect anomalies. - Re-estimated models with alternative imputation strategies to check stability of effect estimates.\n\nTable: Summary of Missing Data Handling Techniques\n\n\n\n\n\n\n\n\n\nVariable Type\nExample Variable\nMethod Applied\nRationale\n\n\n\n\nStatic, continuous\nAge at menarche\nMultiple Imputation (20 datasets, chained equations)\nSingle-time measurement; high missingness; categorical imputation adjusted for predictors\n\n\nTime-varying, continuous\nBMI prior to birth\nRow mean imputation using available values from same participant\nPreserves within-person trajectory; missing at intermittent waves\n\n\nChronic binary condition\nHypertension, diabetes\nLast Observation Carried Forward (LOCF)\nLifetime conditions assumed persistent once reported\n\n\nLifetime event binary\nEver violated by partner\nLOCF + Next Observation Carried Backward (NOCB)\nEnsures capture of lifetime exposure regardless of reporting wave\n\n\n\n\nIn summary, the combination of diagnostic mapping, mechanism classification, tailored imputation, and sensitivity analyses allowed me to address missingness in a scientifically sound manner, maximising the analytic value of this 20-year longitudinal dataset.\n\n\nFinal Reflection:\nI have had the privilege of contributing to one of Australia‚Äôs most significant longitudinal studies, producing results that are both methodologically robust and policy-relevant.\nThe lessons I have gained ‚Äî about rigour, adaptability, and the potential of data to drive meaningful change ‚Äî will remain central to my work and collaborations. I will apply these skills in future projects that connects advanced analytics with real-world health outcomes, both in Australia and internationally.\n\nIf you are interested in exploring each paper in greater depth, including the methods applied, please read the links below. I hope you find them insightful.\n\nPreterm Birth: https://doi.org/10.1016/j.midw.2022.103334\n\nLow Birthweight: https://doi.org/10.1093/eurpub/ckab033\n\nCaesarean Section and Labour Intervention: https://doi.org/10.1007/s43032-023-01219-7"
  },
  {
    "objectID": "Post_Blog/Missing_Data_Analysis/index.html#r-based-missing-data-management-and-analysis-project",
    "href": "Post_Blog/Missing_Data_Analysis/index.html#r-based-missing-data-management-and-analysis-project",
    "title": "Missing Data Management and Analysis",
    "section": "R-Based Missing Data management and Analysis Project",
    "text": "R-Based Missing Data management and Analysis Project\n\nMissing Value Identification and Imputations\nA. Identifying Missing Values\n\nis.na(), anyNA(), sum(is.na(x)), colSums() ‚Äì detect/count missing values\ncomplete.cases() ‚Äì filter complete rows\nConvert blanks to NA: x[x == ‚Äú‚Äú] &lt;- NA\n\nB. Handling Missing Values\n\nBasic Removal/Replacement: na.omit(), replace_na() (tidyr), ifelse()\nForward/Backward Fill: fill() (tidyr) with .direction = ‚Äúdown‚Äù / ‚Äúup‚Äù\nStatistical Imputation:\n\n-Simple: mean/median imputation\n-Multiple: mice::mice()()\n-Advanced: Hmisc::aregImpute, missForest, Amelia, zoo::na.fill\nMissing data is a common issue in real-world datasets. In R, handling missing values properly is essential to ensure the integrity of analyses and avoid misleading results.\nThis section covers how to identify, clean, and impute missing values using base R and tidyverse tools. Techniques range from basic filtering to advanced imputation models.\n‚û°Ô∏è Missing values are typically represented as NA in R. Empty strings (e.g., \"\") or special codes (e.g., -99, \"missing\") may also indicate missingness and need conversion before analysis.\nüîπ Summary of Functions for Handling Missing Values\n\n\n\n\n\n\n\n\nTask\nFunction / Code\nPurpose\n\n\n\n\nDetect missing values\nis.na(x), anyNA(x), sum(is.na(x))\nIdentify/count missing values\n\n\nMissing per column\ncolSums(is.na(df))\nCount NAs per column\n\n\nFilter complete rows\ncomplete.cases(df)\nKeep only rows without any missing values\n\n\nConvert blanks to NA\nx[x == \"\"] &lt;- NA\nConvert empty strings to missing values\n\n\nRemove missing rows\nna.omit(df)\nRemove rows with any missing value\n\n\nReplace missing values\nreplace_na(df, list(...)), ifelse(is.na(x), ...)\nImpute or replace NA with custom logic\n\n\nForward/backward fill\nfill(df, .direction = \"down\" / \"up\")\nFill NA using nearby values\n\n\nMean/median imputation\nx[is.na(x)] &lt;- mean(x, na.rm = TRUE)\nReplace NA with summary statistic\n\n\nMultiple imputation\nmice::mice(df)\nCreate multiple imputed datasets using chained equations\n\n\nAdvanced imputation\nHmisc::aregImpute, missForest, Amelia, zoo::na.fill()\nSpecialized techniques for complex imputations\n\n\n\nüìö Further Learning and Resources\nAdditional tutorials, demonstrations, and datasets are available on:\n\nYouTube Channel ‚Äì AnalyticsHub\nhttps://studio.youtube.com/channel/UCLVKP0g8GvHhOh0kn20T8eg/videos/upload?filter=%5B%5D&sort=%7B%22columnType%22%3A%22date%22%2C%22sortOrder%22%3A%22DESCENDING%22%7D\nGitHub Repository\nhttps://github.com/HabtamuBizuayehu?tab=repositories\n\n\n\n\n                                    id  birthdate deathdate         ssn\n1 898a6256-7ffb-dbe2-e24d-12fda2fedcfd 1966-06-23           999-98-5513\n2 5e0a6984-38d7-c604-f55f-f1de5e933768 1986-07-04           999-58-5560\n3 e335de09-0994-4111-3c15-6edcc17ae4bc 2005-04-25           999-48-3846\n4 45b89342-dc05-8e57-8eee-9ed68ec42378 1984-08-24           999-40-3433\n5 916b1ac8-56c8-ec1b-3b9a-721336a74912 1953-05-10           999-16-3735\n6 dc323bce-e583-d903-303e-9c865bc87e67 2012-09-02           999-90-3605\n    drivers   passport prefix     first     middle          last suffix\n1 S99971131 X62454905X   Mrs.  Maris768              Lindgren255     NA\n2 S99931679 X61479569X   Mrs. Hattie299  Reatha769      Nader710     NA\n3 S99958413               Ms.  Jimmie93 Towanda270      Doyle959     NA\n4 S99985178 X27670495X    Mr. Dwight645  Marlin805      Hilll811     NA\n5 S99968840 X83646024X    Ms.  Tambra47 Brittni468 Balistreri607     NA\n6                             Carson894 Raphael767     Littel644     NA\n     maiden marital  race   ethnicity gender                       birthplace\n1   Dach178       D white nonhispanic      F        Oxford  Massachusetts  US\n2 Harber290       M white nonhispanic      F North Reading  Massachusetts  US\n3                   white nonhispanic      F        Boston  Massachusetts  US\n4                 M white nonhispanic      M    Framingham  Massachusetts  US\n5                 S white nonhispanic      F     Lexington  Massachusetts  US\n6                   white nonhispanic      M      Plymouth  Massachusetts  US\n                        address        city         state           county\n1          962 Stiedemann Vista    Aquinnah Massachusetts     Dukes County\n2            720 O'Keefe Arcade      Newton Massachusetts Middlesex County\n3       493 Cruickshank Mission   Holliston Massachusetts Middlesex County\n4              810 Wolf Pathway      Malden Massachusetts Middlesex County\n5      146 Rowe Village Suite 3 New Bedford Massachusetts   Bristol County\n6 467 Collier Stravenue Unit 12   Attleboro Massachusetts   Bristol County\n   fips  zip      lat       lon healthcare_expenses healthcare_coverage income\n1    NA    0 41.29618 -70.77458           343608.18           884243.46 178323\n2 25017 2468 42.29180 -71.14930           169293.06           801407.90  86384\n3    NA    0 42.24196 -71.46440            64178.99             5906.14 198522\n4 25017 2148 42.43610 -71.14328            36010.63           472861.90  25909\n5 25005 2743 41.69576 -71.01391           281198.90           310261.21 140772\n6 44007 2861 41.94870 -71.30420            45972.75                0.00  71169\n  visit\n1     1\n2     1\n3     1\n4     1\n5     1\n6     1\n\n\n\n# Summarise missing values across all columns\nmissing_summary &lt;- colSums(is.na(visits_all))\nprint(missing_summary[missing_summary &gt; 0])\n\n          deathdate             drivers            passport              prefix \n                 40                   4                  12                   8 \n             middle              suffix              maiden             marital \n                  4                  40                  28                  16 \n               race                fips                 zip healthcare_coverage \n                 20                  12                  12                   4 \n             income \n                 20 \n\n# Total number of missing cells\ntotal_missing &lt;- sum(is.na(visits_all))\ncat(\"Total missing values in dataset:\", total_missing, \"\\n\")\n\nTotal missing values in dataset: 220 \n\n# Count of individuals with at least one missing value\nn_missing_individuals &lt;- sum(!complete.cases(visits_all))\ncat(\"Number of individuals with at least one missing value:\", n_missing_individuals, \"\\n\")\n\nNumber of individuals with at least one missing value: 40 \n\n# Sort records by patient ID and visit number\nvisits_all &lt;- visits_all %&gt;%\n  arrange(id_text, visit)\n\n# View rows with any missing values\nmissing_rows &lt;- visits_all %&gt;%\n  filter(!complete.cases(.))\nhead(missing_rows, n = 12) %&gt;% select(id_text, race, income, passport)\n\n                id_text  race income   passport\n1  Anit|S√°nc|1960-05-07 white  61016  X9157439X\n2  Anit|S√°nc|1960-05-07  &lt;NA&gt;     NA  X9157439X\n3  Anit|S√°nc|1960-05-07 white     NA  X9157439X\n4  Anit|S√°nc|1960-05-07  &lt;NA&gt;  60016  X9157439X\n5  Aure|Weis|2003-11-12 white   8752 X17586296X\n6  Aure|Weis|2003-11-12  &lt;NA&gt;     NA X17586296X\n7  Aure|Weis|2003-11-12 white     NA X17586296X\n8  Aure|Weis|2003-11-12  &lt;NA&gt;   7752 X17586296X\n9  Cars|Litt|2012-09-02 white  71169       &lt;NA&gt;\n10 Cars|Litt|2012-09-02  &lt;NA&gt;     NA       &lt;NA&gt;\n11 Cars|Litt|2012-09-02  &lt;NA&gt;  70169       &lt;NA&gt;\n12 Cars|Litt|2012-09-02 white     NA       &lt;NA&gt;\n\n# Impute passport with \"UNKNOWN\"\ndf_passport &lt;- visits_all %&gt;%\n  mutate(passport_imputed = replace_na(passport, \"UNKNOWN\")) %&gt;%\n  filter(is.na(passport)) %&gt;%\n  select(id, id_text, visit, passport, passport_imputed)\n\nhead(df_passport, n = 12)\n\n                                     id              id_text visit passport\n1  dc323bce-e583-d903-303e-9c865bc87e67 Cars|Litt|2012-09-02     1     &lt;NA&gt;\n2  dc323bce-e583-d903-303e-9c865bc87e67 Cars|Litt|2012-09-02     2     &lt;NA&gt;\n3  dc323bce-e583-d903-303e-9c865bc87e67 Cars|Litt|2012-09-02     3     &lt;NA&gt;\n4  dc323bce-e583-d903-303e-9c865bc87e67 Cars|Litt|2012-09-02     4     &lt;NA&gt;\n5  da7b1f55-c782-544f-ba8c-fe69d519dc85 Doll|Fran|2008-10-04     1     &lt;NA&gt;\n6  da7b1f55-c782-544f-ba8c-fe69d519dc85 Doll|Fran|2008-10-04     2     &lt;NA&gt;\n7  da7b1f55-c782-544f-ba8c-fe69d519dc85 Doll|Fran|2008-10-04     3     &lt;NA&gt;\n8  da7b1f55-c782-544f-ba8c-fe69d519dc85 Doll|Fran|2008-10-04     4     &lt;NA&gt;\n9  e335de09-0994-4111-3c15-6edcc17ae4bc Jimm|Doyl|2005-04-25     1     &lt;NA&gt;\n10 e335de09-0994-4111-3c15-6edcc17ae4bc Jimm|Doyl|2005-04-25     2     &lt;NA&gt;\n11 e335de09-0994-4111-3c15-6edcc17ae4bc Jimm|Doyl|2005-04-25     3     &lt;NA&gt;\n12 e335de09-0994-4111-3c15-6edcc17ae4bc Jimm|Doyl|2005-04-25     4     &lt;NA&gt;\n   passport_imputed\n1           UNKNOWN\n2           UNKNOWN\n3           UNKNOWN\n4           UNKNOWN\n5           UNKNOWN\n6           UNKNOWN\n7           UNKNOWN\n8           UNKNOWN\n9           UNKNOWN\n10          UNKNOWN\n11          UNKNOWN\n12          UNKNOWN\n\n# Sort records by patient ID and visit number (to prepare for forward/backward fill)\nvisits_all &lt;- visits_all %&gt;%\n  arrange(id_text, visit)\n\n# Preview sorted data (tail)\ntail(visits_all %&gt;% select(id_text, visit, race, income), n = 12)\n\n                id_text visit  race income\n29 Jimm|Doyl|2005-04-25     1 white 198522\n30 Jimm|Doyl|2005-04-25     2  &lt;NA&gt;     NA\n31 Jimm|Doyl|2005-04-25     3  &lt;NA&gt; 197522\n32 Jimm|Doyl|2005-04-25     4 white     NA\n33 Mari|Lind|1966-06-23     1 white 178323\n34 Mari|Lind|1966-06-23     2  &lt;NA&gt;     NA\n35 Mari|Lind|1966-06-23     3 white     NA\n36 Mari|Lind|1966-06-23     4  &lt;NA&gt; 177323\n37 Tamb|Bali|1953-05-10     1 white 140772\n38 Tamb|Bali|1953-05-10     2  &lt;NA&gt;     NA\n39 Tamb|Bali|1953-05-10     3 white     NA\n40 Tamb|Bali|1953-05-10     4  &lt;NA&gt; 139772\n\n# Forward fill missing race values within each patient (downward)\nvisits_all &lt;- visits_all %&gt;%\n  group_by(id_text) %&gt;%\n  mutate(race_forward = race) %&gt;%\n  fill(race_forward, .direction = \"down\") %&gt;%\n  ungroup()\n\n# Preview forward-filled race values (head)\nhead(visits_all %&gt;% select(id_text, visit, race, race_forward), n = 12)\n\n# A tibble: 12 √ó 4\n   id_text              visit race  race_forward\n   &lt;chr&gt;                &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt;       \n 1 Anit|S√°nc|1960-05-07     1 white white       \n 2 Anit|S√°nc|1960-05-07     2 &lt;NA&gt;  white       \n 3 Anit|S√°nc|1960-05-07     3 white white       \n 4 Anit|S√°nc|1960-05-07     4 &lt;NA&gt;  white       \n 5 Aure|Weis|2003-11-12     1 white white       \n 6 Aure|Weis|2003-11-12     2 &lt;NA&gt;  white       \n 7 Aure|Weis|2003-11-12     3 white white       \n 8 Aure|Weis|2003-11-12     4 &lt;NA&gt;  white       \n 9 Cars|Litt|2012-09-02     1 white white       \n10 Cars|Litt|2012-09-02     2 &lt;NA&gt;  white       \n11 Cars|Litt|2012-09-02     3 &lt;NA&gt;  white       \n12 Cars|Litt|2012-09-02     4 white white       \n\n# Backward fill missing race values within each patient (upward)\nvisits_all &lt;- visits_all %&gt;%\n  group_by(id_text) %&gt;%\n  mutate(race_backward = race) %&gt;%\n  fill(race_backward, .direction = \"up\") %&gt;%\n  ungroup()\n\n# Preview backward-filled race values (tail)\ntail(visits_all %&gt;% select(id_text, visit, race, race_backward), n = 12)\n\n# A tibble: 12 √ó 4\n   id_text              visit race  race_backward\n   &lt;chr&gt;                &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt;        \n 1 Jimm|Doyl|2005-04-25     1 white white        \n 2 Jimm|Doyl|2005-04-25     2 &lt;NA&gt;  white        \n 3 Jimm|Doyl|2005-04-25     3 &lt;NA&gt;  white        \n 4 Jimm|Doyl|2005-04-25     4 white white        \n 5 Mari|Lind|1966-06-23     1 white white        \n 6 Mari|Lind|1966-06-23     2 &lt;NA&gt;  white        \n 7 Mari|Lind|1966-06-23     3 white white        \n 8 Mari|Lind|1966-06-23     4 &lt;NA&gt;  &lt;NA&gt;         \n 9 Tamb|Bali|1953-05-10     1 white white        \n10 Tamb|Bali|1953-05-10     2 &lt;NA&gt;  white        \n11 Tamb|Bali|1953-05-10     3 white white        \n12 Tamb|Bali|1953-05-10     4 &lt;NA&gt;  &lt;NA&gt;         \n\n# Calculate the global (overall) mean income\nglobal_mean_income &lt;- mean(visits_all$income, na.rm = TRUE)\n\n# Use global mean to impute missing income values\nvisits_all &lt;- visits_all %&gt;%\n  mutate(income_global_mean = ifelse(is.na(income), global_mean_income, income))\n\n# Preview global mean-imputed income (head)\nhead(visits_all %&gt;% select(id_text, visit, income, income_global_mean), n = 12)\n\n# A tibble: 12 √ó 4\n   id_text              visit income income_global_mean\n   &lt;chr&gt;                &lt;dbl&gt;  &lt;dbl&gt;              &lt;dbl&gt;\n 1 Anit|S√°nc|1960-05-07     1  61016             61016 \n 2 Anit|S√°nc|1960-05-07     2     NA             96123.\n 3 Anit|S√°nc|1960-05-07     3     NA             96123.\n 4 Anit|S√°nc|1960-05-07     4  60016             60016 \n 5 Aure|Weis|2003-11-12     1   8752              8752 \n 6 Aure|Weis|2003-11-12     2     NA             96123.\n 7 Aure|Weis|2003-11-12     3     NA             96123.\n 8 Aure|Weis|2003-11-12     4   7752              7752 \n 9 Cars|Litt|2012-09-02     1  71169             71169 \n10 Cars|Litt|2012-09-02     2     NA             96123.\n11 Cars|Litt|2012-09-02     3  70169             70169 \n12 Cars|Litt|2012-09-02     4     NA             96123.\n\n# Calculate mean income per participant (id_text)\nparticipant_mean_income &lt;- visits_all %&gt;%\n  group_by(id_text) %&gt;%\n  summarise(mean_income_id = mean(income, na.rm = TRUE), .groups = \"drop\")\n\n# Use participant-level mean to impute missing income values\nvisits_all &lt;- visits_all %&gt;%\n  left_join(participant_mean_income, by = \"id_text\") %&gt;%\n  mutate(income_participant_mean = ifelse(is.na(income), mean_income_id, income))\n\n# Preview participant mean-imputed income (tail)\ntail(visits_all %&gt;% select(id_text, visit, income, income_participant_mean), n = 12)\n\n# A tibble: 12 √ó 4\n   id_text              visit income income_participant_mean\n   &lt;chr&gt;                &lt;dbl&gt;  &lt;dbl&gt;                   &lt;dbl&gt;\n 1 Jimm|Doyl|2005-04-25     1 198522                  198522\n 2 Jimm|Doyl|2005-04-25     2     NA                  198022\n 3 Jimm|Doyl|2005-04-25     3 197522                  197522\n 4 Jimm|Doyl|2005-04-25     4     NA                  198022\n 5 Mari|Lind|1966-06-23     1 178323                  178323\n 6 Mari|Lind|1966-06-23     2     NA                  177823\n 7 Mari|Lind|1966-06-23     3     NA                  177823\n 8 Mari|Lind|1966-06-23     4 177323                  177323\n 9 Tamb|Bali|1953-05-10     1 140772                  140772\n10 Tamb|Bali|1953-05-10     2     NA                  140272\n11 Tamb|Bali|1953-05-10     3     NA                  140272\n12 Tamb|Bali|1953-05-10     4 139772                  139772\n\n# Multiple imputation for fips, zip, healthcare_coverage, and income\npatients_mice &lt;- visits_all %&gt;%\n  select(id_text, fips, zip, healthcare_coverage, income)\n\n# Apply mice\nimputed &lt;- mice(patients_mice %&gt;% select(-id_text), method = \"pmm\", m = 1, printFlag = FALSE)\n\n# Retrieve completed dataset\nmice_result &lt;- complete(imputed)\ncolnames(mice_result) &lt;- paste0(colnames(mice_result), \"_imputed\")\n\n# Join ID and filter rows with original missing values\ndf_mice &lt;- bind_cols(patients_mice, mice_result) %&gt;%\n  filter(is.na(fips) | is.na(zip) | is.na(healthcare_coverage) | is.na(income)) %&gt;%\n  select(id_text,\n         fips, fips_imputed,\n         zip, zip_imputed,\n         healthcare_coverage, healthcare_coverage_imputed,\n         income, income_imputed)\n\nhead(df_mice, n = 12)\n\n# A tibble: 12 √ó 9\n   id_text               fips fips_imputed   zip zip_imputed healthcare_coverage\n   &lt;chr&gt;                &lt;int&gt;        &lt;int&gt; &lt;int&gt;       &lt;int&gt;               &lt;dbl&gt;\n 1 Anit|S√°nc|1960-05-07 25009        25009  1915        1915            1280070.\n 2 Anit|S√°nc|1960-05-07 25009        25009  1915        1915            1280070.\n 3 Aure|Weis|2003-11-12 25027        25027  1606        1606             253645.\n 4 Aure|Weis|2003-11-12 25027        25027  1606        1606             253645.\n 5 Cars|Litt|2012-09-02 44007        44007  2861        2861                 NA \n 6 Cars|Litt|2012-09-02 44007        44007  2861        2861                 NA \n 7 Cars|Litt|2012-09-02 44007        44007  2861        2861                 NA \n 8 Cars|Litt|2012-09-02 44007        44007  2861        2861                 NA \n 9 Doll|Fran|2008-10-04    NA        25013    NA        2468             422516.\n10 Doll|Fran|2008-10-04    NA        25027    NA        1030             422516.\n11 Doll|Fran|2008-10-04    NA        25017    NA        2861             422516.\n12 Doll|Fran|2008-10-04    NA        25017    NA        1606             422516.\n# ‚Ñπ 3 more variables: healthcare_coverage_imputed &lt;dbl&gt;, income &lt;dbl&gt;,\n#   income_imputed &lt;dbl&gt;\n\n# Optional: Inspect logged events from mice\nimputed$loggedEvents\n\n  it im                 dep meth\n1  3  1 healthcare_coverage  pmm\n                                                                                                                                                                                                                                                       out\n1 mice detected that your data are (nearly) multi-collinear.\\nIt applied a ridge penalty to continue calculations, but the results can be unstable.\\nDoes your dataset contain duplicates, linear transformation, or factors with unique respondent names?\n\n# Final summary: compare original and imputed values for rows with missingness\n\nfinal_impute_check &lt;- visits_all %&gt;%\n  filter(is.na(race) | is.na(income)) %&gt;%\n  select(id_text, visit,\n         race, race_forward, race_backward,\n         income, income_global_mean, income_participant_mean)\n\n# Preview top 12\nhead(final_impute_check, n = 12)\n\n# A tibble: 12 √ó 8\n   id_text      visit race  race_forward race_backward income income_global_mean\n   &lt;chr&gt;        &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt;        &lt;chr&gt;          &lt;dbl&gt;              &lt;dbl&gt;\n 1 Anit|S√°nc|1‚Ä¶     2 &lt;NA&gt;  white        white             NA             96123.\n 2 Anit|S√°nc|1‚Ä¶     3 white white        white             NA             96123.\n 3 Anit|S√°nc|1‚Ä¶     4 &lt;NA&gt;  white        &lt;NA&gt;           60016             60016 \n 4 Aure|Weis|2‚Ä¶     2 &lt;NA&gt;  white        white             NA             96123.\n 5 Aure|Weis|2‚Ä¶     3 white white        white             NA             96123.\n 6 Aure|Weis|2‚Ä¶     4 &lt;NA&gt;  white        &lt;NA&gt;            7752              7752 \n 7 Cars|Litt|2‚Ä¶     2 &lt;NA&gt;  white        white             NA             96123.\n 8 Cars|Litt|2‚Ä¶     3 &lt;NA&gt;  white        white          70169             70169 \n 9 Cars|Litt|2‚Ä¶     4 white white        white             NA             96123.\n10 Doll|Fran|2‚Ä¶     2 &lt;NA&gt;  white        white             NA             96123.\n11 Doll|Fran|2‚Ä¶     3 &lt;NA&gt;  white        white         187023            187023 \n12 Doll|Fran|2‚Ä¶     4 white white        white             NA             96123.\n# ‚Ñπ 1 more variable: income_participant_mean &lt;dbl&gt;\n\n# Preview bottom 12\ntail(final_impute_check, n = 12)\n\n# A tibble: 12 √ó 8\n   id_text      visit race  race_forward race_backward income income_global_mean\n   &lt;chr&gt;        &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt;        &lt;chr&gt;          &lt;dbl&gt;              &lt;dbl&gt;\n 1 Home|Qui√±|1‚Ä¶     2 &lt;NA&gt;  white        white             NA             96123.\n 2 Home|Qui√±|1‚Ä¶     3 &lt;NA&gt;  white        white           6361              6361 \n 3 Home|Qui√±|1‚Ä¶     4 white white        white             NA             96123.\n 4 Jimm|Doyl|2‚Ä¶     2 &lt;NA&gt;  white        white             NA             96123.\n 5 Jimm|Doyl|2‚Ä¶     3 &lt;NA&gt;  white        white         197522            197522 \n 6 Jimm|Doyl|2‚Ä¶     4 white white        white             NA             96123.\n 7 Mari|Lind|1‚Ä¶     2 &lt;NA&gt;  white        white             NA             96123.\n 8 Mari|Lind|1‚Ä¶     3 white white        white             NA             96123.\n 9 Mari|Lind|1‚Ä¶     4 &lt;NA&gt;  white        &lt;NA&gt;          177323            177323 \n10 Tamb|Bali|1‚Ä¶     2 &lt;NA&gt;  white        white             NA             96123.\n11 Tamb|Bali|1‚Ä¶     3 white white        white             NA             96123.\n12 Tamb|Bali|1‚Ä¶     4 &lt;NA&gt;  white        &lt;NA&gt;          139772            139772 \n# ‚Ñπ 1 more variable: income_participant_mean &lt;dbl&gt;\n\n# Clean up temporary objects \nrm( participant_mean_income, final_impute_check, global_mean_income, df_passport, df_mice,\n    patients_mice, imputed, mice_result, missing_summary, total_missing, n_missing_individuals, missing_rows\n)"
  },
  {
    "objectID": "Post_Blog/Visualisations/index_original.html",
    "href": "Post_Blog/Visualisations/index_original.html",
    "title": "Date Manipulation and Wrangling using R",
    "section": "",
    "text": "This presentation provides a comprehensive walkthrough of data manipulation and wrangling in R, covering foundational setup, core syntax, data importing, exploration, and transformation techniques. It systematically introduces essential R packages and functions for cleaning, summarizing, and visualizing data, followed by advanced topics such as working with dates and handling missing values. Practical sections on looping, writing functions, and building interactive Shiny applications are also included to enhance automation and interactivity. The presentation concludes with real-world case studies, demonstrating how to apply these techniques to healthcare and public health datasets. This guide is designed to build technical proficiency and practical confidence for effective data analysis using R.\nThis Presentation/Project Covers\n- Part I: FOUNDATIONS AND INTRODUCTION\nInstalling R and RStudio, setting working directories, clearing console, loading packages, R syntax and shortcuts, R object types, Quarto and R Markdown overview.\n- Part II: DATA LOADING AND EXPLORATION\nImporting CSV/Excel data, reading datasets into R.\n- Part III: WRANGLING WITH dplyr\nSelecting and renaming columns, creating variables, splitting text, extracting patterns, working with factors, grouping, sorting, reshaping data.\n- Part IV: ADVANCED WRANGLING AND INTEGRATION\nHandling dates, deduplication, merging datasets, identifying and imputing missing values.\n- Part V: DESCRIPTIVE STATISTICS AND TABULATION\nSummary stats, skewness/kurtosis, frequencies, cross tabulations, exporting summaries.\n- Part VI: DATA VISUALIZATION WITH ggplot2\nChart components, common plots, multivariate visuals, geospatial maps, overlays, themes and labels.\n- Part VII: SHINY APP ‚Äì BUILDING WEB APPS\nUI and server structure, reactive inputs/outputs, DT tables, app deployment.\n\n\n\n\n\nThis section will cover the following contents\n- Installing R and RStudio\n- Setting working directories\n- Clearing environment and console\n- Installing and loading packages (eg tidyverse, janitor, etc.)\n\nInstalling R and RStudio\n\nWhen we begin working with R, the very first step we take is installing two important tools: R itself (the engine) and RStudio (the friendly interface we use every day). I recommend that we install R first and then RStudio immediately after.\nTo make this clear, I have prepared a complete video tutorial that you can watch step-by-step:\nWathc at AnalyticsHub YouTube\nThe video, shows:\n\nHow to Download R from the CRAN website.\nInstall RStudio, which gives us a powerful yet simple environment to work in.\nBriefly explore basic options like font size, theme (dark/light mode), and code editor settings to make RStudio comfortable for coding.\nSetting working directories\nWhen we work in R, it‚Äôs very important that we know where R is reading from and saving to.\nI often think of the working directory as the ‚Äúhome folder‚Äù where all my files live during an R session.\nWe can easily check our current working directory by typing:\n\ngetwd() \n\n[1] \"C:/Users/User/Desktop/Materials_ Course and proposals/VIP collection for Syntax code or project titles/R codes/Website profile Mod 2/Post_Blog/Visualisations\"\n\n\n\nThis command tells us exactly where R is currently looking for files.\nIf we want to change the working directory to a folder we are working on (for example, a project folder or a course material folder), we can use:\n\nsetwd(\"C:/Users/User/Desktop/Materials_ Course and proposals/\")\n\nAlways make sure the folder path is in quotation marks and I use forward slashes / or double backslashes \\\\ when typing the path.\nüìå We can also set the working directory easily by clicking:\n\nSession ‚ûî Set Working Directory ‚ûî Choose Directory‚Ä¶\n\nüìö Note about API tokens and special folders:\nIf you are using R for connecting to APIs, cloud storage, or services like GitHub, Dropbox, or Google Drive,\nsometimes you will need to set a working directory where your API token file is stored (for authentication).\n\nsetwd(\"C:/Users/YourName/.credentials/\") \n\n‚ö†Ô∏è Important: Always make sure API tokens and confidential files are in a secure private directory.\n\nClearing environment and console\n\n# Clear environment and console\nrm(list = ls()) # To clear the environment (remove all objects in memory)\ncat(\"\\014\") # To clear the console (like wiping a whiteboard)\n\n\nBefore starting fresh in any R session, I like to clear out everything‚Äîall variables, data, and even the clutter in the console.\nInstalling and loading packages\nWe rely on a range of packages in R for data wrangling, visualization, dashboards, and reporting.\nI typically create a vector of required packages and write a small loop to install any missing ones.\n\n\n# ------------------ Set CRAN Repository ------------------\n\noptions(repos = c(CRAN = \"https://cran.rstudio.com\"))\n\n# ------------------ List of required packages for Data Wrangling and Analysis ------------------\npackages &lt;- c(\n  \"lubridate\", \"dplyr\", \"stringr\", \"zoo\", \"tsibble\", \"ggplot2\", \"plotly\", \n  \"readr\", \"readxl\", \"haven\", \"openxlsx\", \"labelled\", \"forecast\",\n  \"prettydoc\", \"janitor\", \"knitr\", \"rmarkdown\", \"yaml\", \n  \"flextable\", \"scales\", \"gt\", \"reactable\", \"DT\", \"gmodels\", \"Hmisc\",\n  \"tidyverse\", \"tidyr\", \"officer\",\n  \"shiny\", \"shinydashboard\", \"shinythemes\", \"mice\", \"shinyWidgets\", \"bslib\", \"quarto\"\n)\n\n# ------------------ Install and load packages ------------------\nfor (pkg in packages) {\n  if (!require(pkg, character.only = TRUE)) {\n    install.packages(pkg)\n  }\n}\n\n# ------------------ Load required libraries with descriptions ------------------\nlibrary(lubridate)     # Simplifies the manipulation of dates and times in R (e.g., formatting, extracting components)\nlibrary(dplyr)         # Data manipulation: filtering, summarizing, and transforming data\nlibrary(stringr)       # Simplifies string manipulation\nlibrary(tidyr)         # Data tidying: reshaping with pivot_longer, pivot_wider, etc.\nlibrary(purrr)         # Functional programming: map functions over lists/vectors\nlibrary(forcats)       # Categorical data: reordering and labeling factor levels\n\nlibrary(zoo)           # Infrastructure for time series objects\nlibrary(tsibble)       # Tidy temporal data frames and time series modeling\nlibrary(forecast)      # Forecasting functions for time series models\n\nlibrary(readr)         # Read rectangular data like CSVs\nlibrary(readxl)        # Read Excel files (.xls and .xlsx)\nlibrary(haven)         # Import data from SAS, SPSS, and Stata\nlibrary(openxlsx)      # Write to Excel with more control\nlibrary(labelled)      # Attach and work with variable labels\n\nlibrary(ggplot2)       # Create elegant data visualizations using the grammar of graphics\nlibrary(plotly)        # Interactive visualizations using ggplot2 or standalone plotly\nlibrary(scales)        # Provides scale functions for ggplot2 (e.g., log, percent)\n\nlibrary(janitor)       # Clean data: make column names nice, tabulate, etc.\nlibrary(gmodels)       # CrossTables and other classic stats tools\nlibrary(Hmisc)         # Summarization and advanced table/label handling\nlibrary(mice)           # missing data imputation\n\nlibrary(knitr)         # Dynamic report generation in R\nlibrary(rmarkdown)     # Convert R scripts to reports in various formats\nlibrary(prettydoc)     # Beautiful HTML document templates\nlibrary(yaml)          # Read and write YAML files (used in R Markdown, Quarto)\nlibrary(officer)       # Export tables and reports to Word/PowerPoint\n\nlibrary(flextable)     # Create nicely formatted tables\nlibrary(gt)            # Grammar of tables for HTML and PDF output\nlibrary(reactable)     # Interactive data tables\nlibrary(DT)            # Wrapper of JavaScript DataTables for R\n\nlibrary(shiny)         # Build interactive web applications directly from R\nlibrary(shinydashboard)# Create dashboard layouts for Shiny apps\nlibrary(shinythemes)   # Prebuilt UI themes for Shiny apps\nlibrary(shinyWidgets)  # Enhanced UI widgets for Shiny\nlibrary(bslib)         # Bootstrap themes for Shiny and rmarkdown\n\nlibrary(quarto)        # Rendering Quarto documents\n\n\n\n\n\nOperators: &lt;-, %&gt;%, ==, &, |, ~\nAdditional Operators: %in%, ::, %&lt;&gt;%, |&gt;\nSymbols: (), [], {}, \"\", #\nCommenting, structure, and help functions (?function, args())\nUsing R scripts vs.¬†R Markdown vs.¬†Quarto\n\nIn this section, we walk through the fundamental syntax building blocks of R.\nMastering these basics helps write cleaner, more efficient, and more readable code.\nüîπ Operators\nIn R, operators are used to perform operations on objects and values:\n\nAssignment operators (&lt;-, =) store values into objects.\nPipe operators (%&gt;%, %&lt;&gt;%, |&gt;) allow chaining multiple commands together.\nComparison operators (==, !=, &lt;, &gt;) compare values for equality or relational logic.\nLogical operators (&, |, !) build logical expressions (AND, OR, NOT).\nFormula operator (~) defines models and formulas, e.g., y ~ x1 + x2.\nMembership operator (%in%) checks whether an element belongs to a set.\nPackage access operator (::) calls a function from a package without loading the full package.\n\nüîπ Symbols\nSymbols are special characters used in structuring R code:\n\n() : Used for function calls and setting arguments.\n[] : Indexing vectors, matrices, or data frames.\n{} : Grouping multiple expressions into a code block.\n\"\" or '' : Define character strings.\n# : Create comments that are ignored during code execution.\n\nüîπ Help Functions\n\n?function_name : Access the help documentation for any function.\nargs(function_name) : Display the arguments a function accepts.\nüîπ Scripting in .R, .Rmd, .qmd\n\n\n\n\n\n\n\n\nFormat\nDescription\nBest Use Case\n\n\n\n\n.R\nBasic R script. Contains code only, no formatting or output.\nExploratory coding, testing snippets\n\n\n.Rmd\nR Markdown file. Supports code + text + output in one file.\nReproducible reports, presentations, notebooks\n\n\n.qmd\nQuarto document. Successor to R Markdown with more flexible publishing.\nPolished reports, web publishing, multi-language\n\n\n\n\nüìä R Syntax Essentials Summary\n\n\n\n\n\n\n\n\nElement\nSymbol / Syntax\nWhat It Does\n\n\n\n\nAssignment\n&lt;-, =\nAssign a value to a variable (e.g., x &lt;- 5)\n\n\nPipe\n%&gt;%, %&lt;&gt;%, |&gt;\nPass or transform results between functions\n\n\nComparison\n==, !=, &lt;, &gt;\nCompare values (equal, not equal, less than, etc.)\n\n\nLogical\n&, |, !\nLogical conditions: AND, OR, NOT\n\n\nFormula\n~\nDefine model formulas (e.g., y ~ x1 + x2)\n\n\nMembership Test\n%in%\nCheck if an element exists within a vector\n\n\nPackage Function Access\n::\nCall a function from a specific package without loading it\n\n\nFunction Call\n()\nCall a function with arguments (e.g., mean(x))\n\n\nIndexing\n[]\nAccess parts of data structures (e.g., x[1], df[2,3])\n\n\nCode Block\n{}\nGroup multiple lines (loops, conditionals)\n\n\nStrings\n\"text\", 'text'\nDefine character strings\n\n\nCommenting\n#\nInsert a comment ignored by R\n\n\nHelp Functions\n?function, args(function)\nAccess help or check function arguments\n\n\nOutput Format\n.R, .Rmd, .qmd\nFile formats for scripting or reporting\n\n\n\n?mean # Opens the help page for the ‚Äòmean‚Äô function\nargs(mean) # Lists input arguments for ‚Äòmean‚Äô\n\n\n\nIn this section, I highlight essential RStudio shortcut keys that improve coding efficiency and simplify the workflow for scripting and reporting.\n\n\n\nShortcut\nAction\n\n\n\n\nCtrl + Z\nUndo the last action\n\n\nCtrl + Shift + Z\nRedo the undone action\n\n\nCtrl + Enter\nExecute the current line or selected block\n\n\nAlt + -\nInsert assignment operator &lt;-\n\n\nCtrl + Shift + M\nInsert pipe operator %&gt;%\n\n\nCtrl + L\nClear the console output\n\n\nCtrl + Shift + C\nComment or uncomment selected lines\n\n\nCtrl + Shift + S\nSource and run the entire script\n\n\nCtrl + Alt + I\nInsert a new R Markdown or Quarto code chunk\n\n\n\n\n\n\n\nElement | Vector | Matrix | |Data Frame | Data Table | List | Factor | Variable | Object\nThis section provides a brief overview of foundational R data structures.\nFor more detailed explanations and demonstrations, refer to:\n\nYouTube: AnalyticsHub\nGitHub: HabtamuBizuayehu Repositories\n\nUnderstanding these fundamental terms is essential for working effectively with R data analysis and wrangling.\nüîπ Brief Narration of Key Terms\n\nElement: A single piece of data, such as a number or a character.\nVector: An ordered collection of elements of the same type (numeric, character, logical).\nMatrix: A two-dimensional collection of elements arranged by rows and columns, all of the same type.\nData Frame: A two-dimensional table where each column can contain different types of data (numeric, character, factor).\nData Table: A high-performance extension from the data.table package ‚Äî for very large datasets and faster manipulation.\nList: A flexible container that can hold elements of different types and structures (vectors, data frames, even other lists).\nFactor: A special type of vector used for categorical data, storing levels internally.\nVariable: A named object that holds data (vectors, lists, data frames, etc.).\nObject: A general term for any data structure stored in R.\n\n\nüîç Summary Table: R Objects\n\n\n\n\n\n\n\nTerm\nDefinition\n\n\n\n\nElement\nA single unit of data (e.g., 5, \"apple\")\n\n\nVector\nA sequence of elements of the same type\n\n\nMatrix\nA two-dimensional collection of homogeneous elements\n\n\nData Frame\nA two-dimensional table with heterogeneous column types\n\n\nData Table\nA fast and memory-efficient data frame extension (data.table package)\n\n\nList\nA flexible container for different types of elements\n\n\nFactor\nA categorical variable with predefined levels\n\n\nVariable\nA named object that stores data\n\n\nObject\nAny entity stored in R (data, functions, models, etc.)\n\n\n\n\n\n\nThis section summarizes key chunk options and syntax used in Quarto and R Markdown.\nThese settings allow flexible control over code execution, output display, figure formatting, and reporting behavior.\n\n\n\n\n\n\n\n\n\n\n\n\nFeature\nQuarto Syntax\nDescription\n\n\n\n\nCode Chunks\n{r}\nUsed to write and execute R code. You can specify options like echo, results.\n\n\nEchoing Code\necho: true\nDisplays the code in the output (default is true). Set to false to hide the code.\n\n\nInclude Code\ninclude: false\nExecutes code but does not show the code in the final output.\n\n\nEvaluating Code\neval: false\nPrevents the code from running but still displays the code in the output.\n\n\nResults Control\nresults: 'markup' or results: 'asis'\nControls how output results are displayed (formatted or raw).\n\n\nMessage and Warnings\nmessage: false, warning: false\nControls whether messages and warnings appear in the output.\n\n\nOutput File Format\noutput: html\nSpecifies output format (html, pdf, word). Default is html.\n\n\nTable Output\nresults: 'asis' or results: 'markup'\nEnsures clean table rendering for formatted output.\n\n\nChunk Labeling\n# Label\nLabels help organize and reference code chunks easily.\n\n\nInline Code\nYour value is 2 times.\nEmbeds live code inside text for dynamic reporting.\n\n\nCaching Results\ncache: true\nSaves chunk results to avoid rerunning unchanged code. It stores the output (like objects, plots, and printed results) in a cache directory\n\n\nFigure Options\nfig.width: 7, fig.height: 5, fig.align: 'center'\nAdjusts figure size and alignment in output documents.\n\n\nOutput as LaTeX\nlatex: true\nAllows LaTeX formatting (mainly for PDFs and math expressions).\n\n\nCommenting Code\n# (within chunks)\nStandard way to comment within R code chunks.\n\n\n\n‚û°Ô∏è Mastering these options ensures smoother report generation, cleaner outputs, and faster rendering when building professional documents in Quarto or R Markdown.\n\n\n\n\n\n\nFile path setup and working with getwd(), paste()\nread_csv(), read_excel(), read.delim(), readRDS()\nReading .tsv, .dta, and .sav files (foreign and haven packages)\nReading from ZIP Files\n\nBefore we begin analyzing data in R, we need to bring it in from where it‚Äôs stored‚Äîyour computer, the cloud, or an online source.\nThere are many formats we commonly work with in public health and analytics: CSV, Excel, text files, RDS, SPSS, and others.\nBelow is a summary table of functions used to read each data type.\nüìä Reading Common Data Types in R\n\n\n\n\n\n\n\n\n\nData Type\nFunction\nPackage\nExample\n\n\n\n\nCSV\nread_csv(), read.csv()\nreadr / base\nread_csv(\"file.csv\")\n\n\nExcel (.xls/.xlsx)\nread_excel()\nreadxl\nread_excel(\"file.xlsx\")\n\n\nTab-separated (.tsv)\nread_tsv()\nreadr\nread_tsv(\"file.tsv\")\n\n\nText (.txt)\nread.delim()\nbase\nread.delim(\"file.txt\")\n\n\nStata (.dta)\nread_dta()\nhaven\nread_dta(\"file.dta\")\n\n\nSPSS (.sav)\nread_sav()\nhaven\nread_sav(\"file.sav\")\n\n\nRDS (R object)\nreadRDS()\nbase\nreadRDS(\"object.rds\")\n\n\nZIP archives\nunzip()\nutils (base)\nunzip(\"data.zip\", exdir = \"folder\")\n\n\nOnline Excel/CSV\ndownload.file() + reader\nbase + readxl\nDownload file, then read_excel(temp_file)\n\n\n\nBefore reading files, I usually set the working directory to the folder where my files are saved. This avoids typing full file paths every time.\nTo combine folder names and filenames dynamically: paste(getwd(), ‚Äúmy_data.csv‚Äù, sep = ‚Äú/‚Äù)\nReading Local Files\nOnce you‚Äôre in the right working directory, you can read in your files like below:\n\nsetwd(\"C:/Users/User/Desktop/Materials_ Course and proposals/Course Related/DataCamp/Data/Synthetic_data\")\n\npatients &lt;- read.csv(\"patients.csv\")\nvaccination &lt;- read.csv(\"immunizations.csv\")\n\nmedications &lt;- read.csv (paste(getwd(), \"medications.csv\", sep = \"/\"))\n\nThese are standard CSVs and can be read using read.csv() from base R, or read_csv() from the readr package for cleaner output.\nReading from ZIP Files\nSometimes, especially when downloading from government databases or health systems, data is compressed into .zip files. In R, we can easily unzip these files and extract their contents.\nSet working directory to the folder where the zip file is located\n\n# --- Define base folder manually (safe way without setwd)\nbase_folder &lt;- \"C:/Users/User/Desktop/Materials_ Course and proposals/Course Related/DataCamp/Data/Synthetic_data\"\n\n# --- Extract ZIP file into 'procedures' folder inside base\nunzip(file.path(base_folder, \"procedures.zip\"), exdir = file.path(base_folder, \"procedures\"))\n\n# --- List extracted files\nlist.files(file.path(base_folder, \"procedures\"))\n\n[1] \"procedures\"     \"procedures.csv\"\n\n# --- Read extracted CSV\nprocedures &lt;- read.csv(file.path(base_folder, \"procedures\", \"procedures.csv\"))\n\nReading Online Files\nIf the file is online, we first download it, save it to a temporary file, and then read it:\nIt is useful when working with shared datasets, APIs, or GitHub repos.\n\n# Upload Online data\n\nurl &lt;- \"https://raw.githubusercontent.com/HabtamuBizuayehu/Data-sources/main/Breast_cancer_screening.xls\"\ntemp_file &lt;- tempfile(fileext = \".xls\")\ndownload.file(url, temp_file, mode = \"wb\")\n\nbreast_cancer_data &lt;- read_excel(temp_file)\n\n2.2 Exploring Data\n\nstr(), summary(), glimpse(), head(), tail(), count()\nViewing data: view(), nrow(), ncol()\nCleaning variable names: janitor::clean_names()\nCreating a data dictionary\nWorking with column names and types\n\nOnce we load data into R, it‚Äôs important to explore it properly before doing any analysis.\nThis step helps us understand:\n\nWhat variables we have\nHow the data is structured\nIf there are any issues (like missing values, wrong data types, weird names)\n\nIn this part, we‚Äôll look at some essential functions we often use at the very beginning of a project.\nüîç Key Tools for Exploring Data (with Important Details and Tips)\n1. str(), summary(), glimpse(), head(), tail(), count()\n\nstr(df) shows the structure of the entire dataset: number of observations (rows), number of variables (columns), and data types.\nstr(df$var) shows the structure of a specific variable (single column), useful to quickly check type and contents.\nsummary(df) gives basic descriptive statistics for all variables at once.\nsummary(df$var) gives a summary for one specific variable.\nglimpse(df) (from dplyr) provides a compact sideways overview showing each variable name, type, and preview of values.\nhead(df) shows the first 6 rows of the dataset by default.\nhead(df, n = 10) shows the first 10 rows (you can customize the number with n =).\ntail(df) shows the last 6 rows of the dataset.\ntail(df, n = 8) shows the last 8 rows.\ncount(df, var) (from dplyr) counts occurrences of each unique value in a variable.\n\n‚û°Ô∏è Using str(df$var) and summary(df$var) is a fast way to inspect just one column without needing the whole dataset.\n\n2. Viewing Data\n\nview(df) opens an Excel-like data viewer window inside RStudio for easy manual exploration.\nnrow(df) returns the number of rows.\nncol(df) returns the number of columns.\ndim(df) returns a two-number vector: (rows, columns).\n\n‚û°Ô∏è Use view(df) when you want to sort/filter manually without coding.\n\n3. Cleaning Variable Names\n\njanitor::clean_names(df) standardizes messy variable names:\n\nMakes all names lowercase\nReplaces spaces and special characters with underscores\nRemoves parentheses, punctuation, etc.\n\n\n‚û°Ô∏è Run clean_names() immediately after loading raw survey, registry, or administrative datasets.\nExample:\n\nnames(patients)\n\n [1] \"Id\"                  \"BIRTHDATE\"           \"DEATHDATE\"          \n [4] \"SSN\"                 \"DRIVERS\"             \"PASSPORT\"           \n [7] \"PREFIX\"              \"FIRST\"               \"MIDDLE\"             \n[10] \"LAST\"                \"SUFFIX\"              \"MAIDEN\"             \n[13] \"MARITAL\"             \"RACE\"                \"ETHNICITY\"          \n[16] \"GENDER\"              \"BIRTHPLACE\"          \"ADDRESS\"            \n[19] \"CITY\"                \"STATE\"               \"COUNTY\"             \n[22] \"FIPS\"                \"ZIP\"                 \"LAT\"                \n[25] \"LON\"                 \"HEALTHCARE_EXPENSES\" \"HEALTHCARE_COVERAGE\"\n[28] \"INCOME\"             \n\ntemp &lt;- janitor::clean_names(patients)\ncolnames(temp)\n\n [1] \"id\"                  \"birthdate\"           \"deathdate\"          \n [4] \"ssn\"                 \"drivers\"             \"passport\"           \n [7] \"prefix\"              \"first\"               \"middle\"             \n[10] \"last\"                \"suffix\"              \"maiden\"             \n[13] \"marital\"             \"race\"                \"ethnicity\"          \n[16] \"gender\"              \"birthplace\"          \"address\"            \n[19] \"city\"                \"state\"               \"county\"             \n[22] \"fips\"                \"zip\"                 \"lat\"                \n[25] \"lon\"                 \"healthcare_expenses\" \"healthcare_coverage\"\n[28] \"income\"             \n\nrm(temp)\n\nüîç Listing All Data Frames and Variables\nTo organize and review datasets loaded in the environment, the following workflow lists all data frames and their variables:\n\nrm (breast_cancer_data, patients)\n\n# 1. List all data frames in the environment\ndfs &lt;- ls(envir = .GlobalEnv)[sapply(ls(envir = .GlobalEnv), function(x) is.data.frame(get(x)))]\n\n# 2. For each data frame, list its variable (column) names\ndf_variables &lt;- lapply(dfs, function(df_name) {\n  vars &lt;- names(get(df_name))\n  data.frame(\n    DataFrame = df_name,\n    Variable = vars,\n    stringsAsFactors = FALSE\n  )\n})\n\n# 3. Combine into one clean table\ndf_variables_all &lt;- do.call(rbind, df_variables)\n\n# View the result\nprint(df_variables_all)\n\n     DataFrame          Variable\n1  medications             START\n2  medications              STOP\n3  medications           PATIENT\n4  medications             PAYER\n5  medications         ENCOUNTER\n6  medications              CODE\n7  medications       DESCRIPTION\n8  medications         BASE_COST\n9  medications    PAYER_COVERAGE\n10 medications         DISPENSES\n11 medications         TOTALCOST\n12 medications        REASONCODE\n13 medications REASONDESCRIPTION\n14  procedures             START\n15  procedures              STOP\n16  procedures           PATIENT\n17  procedures         ENCOUNTER\n18  procedures            SYSTEM\n19  procedures              CODE\n20  procedures       DESCRIPTION\n21  procedures         BASE_COST\n22  procedures        REASONCODE\n23  procedures REASONDESCRIPTION\n24 vaccination              DATE\n25 vaccination           PATIENT\n26 vaccination         ENCOUNTER\n27 vaccination              CODE\n28 vaccination       DESCRIPTION\n29 vaccination         BASE_COST\n\nrm (df_variables_all, df_variables) # clean working enviroment \n\n4. Creating a Data Dictionary\nA data dictionary is a simple but critical table that documents:\n\nVariable names (column names)\nDescriptions (what each variable represents)\nTypes (numeric, character, factor)\n\n‚û°Ô∏è We can automate building a basic data dictionary by combining names(), sapply(), and class() functions.\n\ndata_dictionary &lt;- data.frame(\n  Variable = names(patients),\n  Type = sapply(patients, class)\n)\n\nThe dictionary can be expanded by manually adding descriptions, coding instructions, or value mappings where necessary.\n5. Working with Column Names and Types\n\nnames(df) or colnames(df) retrieves a list of all column names.\nclass(df$var) reveals the data type of a specific variable.\nsapply(df, class) applies class() across all variables and summarizes their types.\nIf needed, variables can be recast to appropriate types.\n\nüìä Summary Table: Key Functions for Exploring Data\n\n\n\n\n\n\n\n\nTask\nFunction\nPurpose / What It Does\n\n\n\n\nView structure of dataset\nstr(df)\nShows structure: number of rows, columns, and variable types\n\n\nView structure of variable\nstr(df$var)\nShows structure/type of a specific variable\n\n\nSummarize statistics (dataset)\nsummary(df)\nProvides summary stats (min, max, mean, NA count) for all variables\n\n\nSummarize statistics (variable)\nsummary(df$var)\nSummary stats for a specific variable\n\n\nCompact structure overview\nglimpse(df)\nQuick, sideways compact view of dataset (from dplyr)\n\n\nPreview first rows\nhead(df), head(df, n = 10)\nDisplays first 6 or specified number of rows\n\n\nPreview last rows\ntail(df), tail(df, n = 8)\nDisplays last 6 or specified number of rows\n\n\nCount frequencies\ncount(df, var)\nCounts unique values and frequency of a specified variable\n\n\nOpen full viewer\nview(df)\nOpens Excel-style data viewer window (RStudio)\n\n\nCheck number of rows\nnrow(df)\nReturns number of rows (observations)\n\n\nCheck number of columns\nncol(df)\nReturns number of columns (variables)\n\n\nCheck both dimensions\ndim(df)\nReturns (rows, columns) as a two-number vector\n\n\nClean column names\njanitor::clean_names(df)\nConverts messy names into lowercase, underscore-separated names\n\n\nList variable names\nnames(df), colnames(df)\nLists all column names in a data frame\n\n\nCheck variable type\nclass(df$var)\nReturns data type of a specific variable\n\n\nCheck types for all variables\nsapply(df, class)\nReturns data types for every column in the dataset\n\n\nCreate basic data dictionary\ndata.frame(Variable = names(df), Type = sapply(df, class))\nTable summarizing variable names and types\n\n\nList all data frames in environment\ndfs &lt;- ls(...)[sapply(...)]\nIdentifies and lists all data frames currently loaded\n\n\nList all variables from all data frames\nlapply(dfs, function(x) names(get(x)))\nCreates table listing data frames and their variables\n\n\n\nNow I can apply some of the above to my datasets (df): such as breast_cancer_data, vaccination, patients\n\nbreast_cancer_data_demo &lt;- breast_cancer_data %&gt;%\n  select(sa3name, state, year, part50_74, rate50_74)\n\n# Structure of the demo dataset\nstr(breast_cancer_data_demo)\n\n'data.frame':   1364 obs. of  5 variables:\n $ sa3name  : chr  \"Queanbeyan\" \"Queanbeyan\" \"Queanbeyan\" \"Queanbeyan\" ...\n $ state    : chr  \"NSW\" \"NSW\" \"NSW\" \"NSW\" ...\n $ year     : int  201617 201718 201819 201920 201617 201718 201819 201920 201617 201718 ...\n $ part50_74: num  4875 5048 5276 5179 1850 ...\n $ rate50_74: num  60.5 60.8 61.4 58.2 59.7 ...\n\n# Summary statistics for rate50_74\nsummary(breast_cancer_data_demo$rate50_74)\n\n   Min. 1st Qu.  Median    Mean 3rd Qu.    Max.    NA's \n   5.40   50.07   54.50   53.63   57.88   80.20     135 \n\n# Display first 10 rows\nhead(breast_cancer_data_demo, 10)\n\n           sa3name state   year part50_74 rate50_74\n1       Queanbeyan   NSW 201617      4875  60.50000\n2       Queanbeyan   NSW 201718      5048  60.75961\n3       Queanbeyan   NSW 201819      5276  61.43839\n4       Queanbeyan   NSW 201920      5179  58.16834\n5  Snowy Mountains   NSW 201617      1850  59.70000\n6  Snowy Mountains   NSW 201718      1910  61.54862\n7  Snowy Mountains   NSW 201819      2039  65.12912\n8  Snowy Mountains   NSW 201920      1979  62.23419\n9      South Coast   NSW 201617      9469  62.80000\n10     South Coast   NSW 201718      9565  62.94230\n\n# Count number of records\ncount(breast_cancer_data_demo)\n\n     n\n1 1364\n\n# Show variable names\nnames(breast_cancer_data_demo)\n\n[1] \"sa3name\"   \"state\"     \"year\"      \"part50_74\" \"rate50_74\"\n\n\n\n\n\n\nIn this part, we focus on mastering core data wrangling skills using the dplyr package, one of the most powerful tools in R for data manipulation.\nWe will learn how to select, rename, create, modify, group, sort, slice, and reshape datasets.\nThese operations form the foundation for preparing clean, organized, and analysis-ready data.\nEach subsection introduces a set of essential verbs (select(), mutate(), group_by(), etc.) that allow for data transformation pipelines. Examples and practical applications will be provided throughout to demonstrate how to use dplyr.\n\n\n\n\nselect(), rename(), relocate()`\nColumn helpers: starts_with(), ends_with(), contains(), last_clos, matches\nAllow modifying entire groups of column names by adding prefixes or suffixes\nHandling null/missing column names\n\nSelecting, reordering, and renaming variables is often the first step when preparing a dataset for analysis.\nIn dplyr, we use functions such as select(), rename(), and relocate() to organize variables, clean up data, and prepare for transformations.\nDropping unnecessary columns or reordering variables can make the data cleaner, faster to work with, and easier to understand.\nAdditional tools allow modifying groups of column names by adding prefixes or suffixes, and safely handling missing columns during selection.\n\nüîπ Summary of Functions for Selecting, Reordering, Dropping, and Renaming\n\n\n\n\n\n\n\n\nTask\nFunction\nPurpose\n\n\n\n\nSelect specific columns\nselect()\nChoose a subset of columns based on name or condition\n\n\nRename columns\nrename()\nRename one or multiple columns\n\n\nRelocate columns\nrelocate()\nMove selected columns to a new position\n\n\nReorder manually\nselect(a, b, c, everything())\nExplicitly define column order\n\n\nFind columns by pattern\nstarts_with(), ends_with(), contains(), matches()\nSelect columns matching a pattern\n\n\nDrop single column\nselect(-col1)\nRemove one variable\n\n\nDrop multiple columns\nselect(-col1, -col2)\nRemove several variables\n\n\nDrop by pattern\nselect(-starts_with(\"temp\")), select(-contains(\"score\"))\nRemove variables based on naming patterns\n\n\nAdd prefix to column names\nrename_with(~ paste0(\"prefix_\", .x))\nAdd a prefix to selected columns\n\n\nAdd suffix to column names\nrename_with(~ paste0(.x, \"_suffix\"))\nAdd a suffix to selected columns\n\n\nHandle missing columns safely\nif(\"var\" %in% names(df)) {}\nAvoid errors when column does not exist\n\n\n\n\n‚û°Ô∏è These techniques allow quick restructuring of datasets, improving workflow efficiency and clarity.\n\nüîπ Examples Using the vaccination Dataset\n\n# Selecting specific columns manually\nbreast_selected &lt;- breast_cancer_data %&gt;%\n  select(sa3code, sa3name, year, part50_74, pop50_74)\n\nhead(breast_selected, n = 3)\n\n  sa3code    sa3name   year part50_74 pop50_74\n1   10102 Queanbeyan 201617      4875     8052\n2   10102 Queanbeyan 201718      5048     8309\n3   10102 Queanbeyan 201819      5276     8588\n\n# Reordering columns manually (bring year, sa3name, state first)\nbc_reorder_manual &lt;- breast_cancer_data %&gt;%\n  select(year, sa3name, state, everything())\n\nhead(bc_reorder_manual, n = 3)\n\n    year    sa3name state sa3code sa3coden part50_74 pop50_74 rate50_74\n1 201617 Queanbeyan   NSW   10102    10102      4875     8052  60.50000\n2 201718 Queanbeyan   NSW   10102    10102      5048     8309  60.75961\n3 201819 Queanbeyan   NSW   10102    10102      5276     8588  61.43839\n  agen50_74 expct50_74 part50_69 pop50_69 rate50_69 agen50_69 expct50_69\n1         3       4428      4309     7145  60.30000         2       3929\n2         3       4553      4448     7338  60.62238         2       4013\n3         3       4706      4629     7548  61.33203         2       4113\n  part50_54 pop50_54 rate50_54 agen50_54 expct50_54 part55_59 pop55_59\n1      1284     2251  57.00000         1       1118      1188     1970\n2      1285     2306  55.72035         1       1143      1260     2030\n3      1375     2342  58.70977         1       1166      1252     2093\n  rate55_59 agen55_59 expct55_59 part60_64 pop60_64 rate60_64 agen60_64\n1  60.30000         4       1046      1012     1625  62.30000         5\n2  62.09035         4       1069      1048     1646  63.69947         5\n3  59.81504         4       1098      1105     1689  65.43657         5\n  expct60_64 part65_69 pop65_69 rate65_69 agen65_69 expct65_69 part70_74\n1        950       826     1300  63.50000         6        781       566\n2        953       855     1357  63.02558         6        812       600\n3        967       898     1426  63.00429         6        849       647\n  pop70_74 rate70_74 agen70_74 expct70_74\n1      907  62.40000         7        498\n2      971  61.79725         7        541\n3     1040  62.21032         7        585\n\n# Relocating specific columns before another variable\nbc_relocate_before &lt;- breast_cancer_data %&gt;%\n  relocate(part50_74, pop50_74, .before = rate50_74)\n\nhead(bc_relocate_before, n = 3)\n\n  sa3code sa3coden    sa3name state   year part50_74 pop50_74 rate50_74\n1   10102    10102 Queanbeyan   NSW 201617      4875     8052  60.50000\n2   10102    10102 Queanbeyan   NSW 201718      5048     8309  60.75961\n3   10102    10102 Queanbeyan   NSW 201819      5276     8588  61.43839\n  agen50_74 expct50_74 part50_69 pop50_69 rate50_69 agen50_69 expct50_69\n1         3       4428      4309     7145  60.30000         2       3929\n2         3       4553      4448     7338  60.62238         2       4013\n3         3       4706      4629     7548  61.33203         2       4113\n  part50_54 pop50_54 rate50_54 agen50_54 expct50_54 part55_59 pop55_59\n1      1284     2251  57.00000         1       1118      1188     1970\n2      1285     2306  55.72035         1       1143      1260     2030\n3      1375     2342  58.70977         1       1166      1252     2093\n  rate55_59 agen55_59 expct55_59 part60_64 pop60_64 rate60_64 agen60_64\n1  60.30000         4       1046      1012     1625  62.30000         5\n2  62.09035         4       1069      1048     1646  63.69947         5\n3  59.81504         4       1098      1105     1689  65.43657         5\n  expct60_64 part65_69 pop65_69 rate65_69 agen65_69 expct65_69 part70_74\n1        950       826     1300  63.50000         6        781       566\n2        953       855     1357  63.02558         6        812       600\n3        967       898     1426  63.00429         6        849       647\n  pop70_74 rate70_74 agen70_74 expct70_74\n1      907  62.40000         7        498\n2      971  61.79725         7        541\n3     1040  62.21032         7        585\n\n# Relocating specific columns after another variable\nbc_relocate_after &lt;- breast_cancer_data %&gt;%\n  relocate(sa3name, state, .after = year)\n\nhead(bc_relocate_after, n = 3)\n\n  sa3code sa3coden   year    sa3name state part50_74 pop50_74 rate50_74\n1   10102    10102 201617 Queanbeyan   NSW      4875     8052  60.50000\n2   10102    10102 201718 Queanbeyan   NSW      5048     8309  60.75961\n3   10102    10102 201819 Queanbeyan   NSW      5276     8588  61.43839\n  agen50_74 expct50_74 part50_69 pop50_69 rate50_69 agen50_69 expct50_69\n1         3       4428      4309     7145  60.30000         2       3929\n2         3       4553      4448     7338  60.62238         2       4013\n3         3       4706      4629     7548  61.33203         2       4113\n  part50_54 pop50_54 rate50_54 agen50_54 expct50_54 part55_59 pop55_59\n1      1284     2251  57.00000         1       1118      1188     1970\n2      1285     2306  55.72035         1       1143      1260     2030\n3      1375     2342  58.70977         1       1166      1252     2093\n  rate55_59 agen55_59 expct55_59 part60_64 pop60_64 rate60_64 agen60_64\n1  60.30000         4       1046      1012     1625  62.30000         5\n2  62.09035         4       1069      1048     1646  63.69947         5\n3  59.81504         4       1098      1105     1689  65.43657         5\n  expct60_64 part65_69 pop65_69 rate65_69 agen65_69 expct65_69 part70_74\n1        950       826     1300  63.50000         6        781       566\n2        953       855     1357  63.02558         6        812       600\n3        967       898     1426  63.00429         6        849       647\n  pop70_74 rate70_74 agen70_74 expct70_74\n1      907  62.40000         7        498\n2      971  61.79725         7        541\n3     1040  62.21032         7        585\n\n# Dropping one variable\nbc_drop_one &lt;- breast_cancer_data %&gt;%\n  select(-expct50_74)\n\nhead(bc_drop_one, n = 3)\n\n  sa3code sa3coden    sa3name state   year part50_74 pop50_74 rate50_74\n1   10102    10102 Queanbeyan   NSW 201617      4875     8052  60.50000\n2   10102    10102 Queanbeyan   NSW 201718      5048     8309  60.75961\n3   10102    10102 Queanbeyan   NSW 201819      5276     8588  61.43839\n  agen50_74 part50_69 pop50_69 rate50_69 agen50_69 expct50_69 part50_54\n1         3      4309     7145  60.30000         2       3929      1284\n2         3      4448     7338  60.62238         2       4013      1285\n3         3      4629     7548  61.33203         2       4113      1375\n  pop50_54 rate50_54 agen50_54 expct50_54 part55_59 pop55_59 rate55_59\n1     2251  57.00000         1       1118      1188     1970  60.30000\n2     2306  55.72035         1       1143      1260     2030  62.09035\n3     2342  58.70977         1       1166      1252     2093  59.81504\n  agen55_59 expct55_59 part60_64 pop60_64 rate60_64 agen60_64 expct60_64\n1         4       1046      1012     1625  62.30000         5        950\n2         4       1069      1048     1646  63.69947         5        953\n3         4       1098      1105     1689  65.43657         5        967\n  part65_69 pop65_69 rate65_69 agen65_69 expct65_69 part70_74 pop70_74\n1       826     1300  63.50000         6        781       566      907\n2       855     1357  63.02558         6        812       600      971\n3       898     1426  63.00429         6        849       647     1040\n  rate70_74 agen70_74 expct70_74\n1  62.40000         7        498\n2  61.79725         7        541\n3  62.21032         7        585\n\n# Dropping multiple variables\nbc_drop_multiple &lt;- breast_cancer_data %&gt;%\n  select(-expct50_74, -expct50_69)\n\nhead(bc_drop_multiple, n = 3)\n\n  sa3code sa3coden    sa3name state   year part50_74 pop50_74 rate50_74\n1   10102    10102 Queanbeyan   NSW 201617      4875     8052  60.50000\n2   10102    10102 Queanbeyan   NSW 201718      5048     8309  60.75961\n3   10102    10102 Queanbeyan   NSW 201819      5276     8588  61.43839\n  agen50_74 part50_69 pop50_69 rate50_69 agen50_69 part50_54 pop50_54 rate50_54\n1         3      4309     7145  60.30000         2      1284     2251  57.00000\n2         3      4448     7338  60.62238         2      1285     2306  55.72035\n3         3      4629     7548  61.33203         2      1375     2342  58.70977\n  agen50_54 expct50_54 part55_59 pop55_59 rate55_59 agen55_59 expct55_59\n1         1       1118      1188     1970  60.30000         4       1046\n2         1       1143      1260     2030  62.09035         4       1069\n3         1       1166      1252     2093  59.81504         4       1098\n  part60_64 pop60_64 rate60_64 agen60_64 expct60_64 part65_69 pop65_69\n1      1012     1625  62.30000         5        950       826     1300\n2      1048     1646  63.69947         5        953       855     1357\n3      1105     1689  65.43657         5        967       898     1426\n  rate65_69 agen65_69 expct65_69 part70_74 pop70_74 rate70_74 agen70_74\n1  63.50000         6        781       566      907  62.40000         7\n2  63.02558         6        812       600      971  61.79725         7\n3  63.00429         6        849       647     1040  62.21032         7\n  expct70_74\n1        498\n2        541\n3        585\n\n# Dropping variables by pattern (e.g., columns ending with \"_69\")\nbc_drop_by_pattern &lt;- breast_cancer_data %&gt;%\n  select(-ends_with(\"_69\"))\n\nhead(bc_drop_by_pattern, n = 3)\n\n  sa3code sa3coden    sa3name state   year part50_74 pop50_74 rate50_74\n1   10102    10102 Queanbeyan   NSW 201617      4875     8052  60.50000\n2   10102    10102 Queanbeyan   NSW 201718      5048     8309  60.75961\n3   10102    10102 Queanbeyan   NSW 201819      5276     8588  61.43839\n  agen50_74 expct50_74 part50_54 pop50_54 rate50_54 agen50_54 expct50_54\n1         3       4428      1284     2251  57.00000         1       1118\n2         3       4553      1285     2306  55.72035         1       1143\n3         3       4706      1375     2342  58.70977         1       1166\n  part55_59 pop55_59 rate55_59 agen55_59 expct55_59 part60_64 pop60_64\n1      1188     1970  60.30000         4       1046      1012     1625\n2      1260     2030  62.09035         4       1069      1048     1646\n3      1252     2093  59.81504         4       1098      1105     1689\n  rate60_64 agen60_64 expct60_64 part70_74 pop70_74 rate70_74 agen70_74\n1  62.30000         5        950       566      907  62.40000         7\n2  63.69947         5        953       600      971  61.79725         7\n3  65.43657         5        967       647     1040  62.21032         7\n  expct70_74\n1        498\n2        541\n3        585\n\n# Renaming a column for clarity\nbreast_renamed &lt;- breast_selected %&gt;%\n  rename(SA3_Code = sa3code, SA3_Name = sa3name, Year = year)\n\nhead(breast_renamed, n = 3)\n\n  SA3_Code   SA3_Name   Year part50_74 pop50_74\n1    10102 Queanbeyan 201617      4875     8052\n2    10102 Queanbeyan 201718      5048     8309\n3    10102 Queanbeyan 201819      5276     8588\n\n# Adding a prefix to all column names\nbc_prefixed &lt;- breast_cancer_data %&gt;%\n  rename_with(~ paste0(\"bc_\", .x))\n\nhead(bc_prefixed, n = 3)\n\n  bc_sa3code bc_sa3coden bc_sa3name bc_state bc_year bc_part50_74 bc_pop50_74\n1      10102       10102 Queanbeyan      NSW  201617         4875        8052\n2      10102       10102 Queanbeyan      NSW  201718         5048        8309\n3      10102       10102 Queanbeyan      NSW  201819         5276        8588\n  bc_rate50_74 bc_agen50_74 bc_expct50_74 bc_part50_69 bc_pop50_69 bc_rate50_69\n1     60.50000            3          4428         4309        7145     60.30000\n2     60.75961            3          4553         4448        7338     60.62238\n3     61.43839            3          4706         4629        7548     61.33203\n  bc_agen50_69 bc_expct50_69 bc_part50_54 bc_pop50_54 bc_rate50_54 bc_agen50_54\n1            2          3929         1284        2251     57.00000            1\n2            2          4013         1285        2306     55.72035            1\n3            2          4113         1375        2342     58.70977            1\n  bc_expct50_54 bc_part55_59 bc_pop55_59 bc_rate55_59 bc_agen55_59\n1          1118         1188        1970     60.30000            4\n2          1143         1260        2030     62.09035            4\n3          1166         1252        2093     59.81504            4\n  bc_expct55_59 bc_part60_64 bc_pop60_64 bc_rate60_64 bc_agen60_64\n1          1046         1012        1625     62.30000            5\n2          1069         1048        1646     63.69947            5\n3          1098         1105        1689     65.43657            5\n  bc_expct60_64 bc_part65_69 bc_pop65_69 bc_rate65_69 bc_agen65_69\n1           950          826        1300     63.50000            6\n2           953          855        1357     63.02558            6\n3           967          898        1426     63.00429            6\n  bc_expct65_69 bc_part70_74 bc_pop70_74 bc_rate70_74 bc_agen70_74\n1           781          566         907     62.40000            7\n2           812          600         971     61.79725            7\n3           849          647        1040     62.21032            7\n  bc_expct70_74\n1           498\n2           541\n3           585\n\n# Adding a suffix to all column names\nbc_suffixed &lt;- breast_cancer_data %&gt;%\n  rename_with(~ paste0(.x, \"_info\"))\n\nhead(bc_suffixed, n = 3)\n\n  sa3code_info sa3coden_info sa3name_info state_info year_info part50_74_info\n1        10102         10102   Queanbeyan        NSW    201617           4875\n2        10102         10102   Queanbeyan        NSW    201718           5048\n3        10102         10102   Queanbeyan        NSW    201819           5276\n  pop50_74_info rate50_74_info agen50_74_info expct50_74_info part50_69_info\n1          8052       60.50000              3            4428           4309\n2          8309       60.75961              3            4553           4448\n3          8588       61.43839              3            4706           4629\n  pop50_69_info rate50_69_info agen50_69_info expct50_69_info part50_54_info\n1          7145       60.30000              2            3929           1284\n2          7338       60.62238              2            4013           1285\n3          7548       61.33203              2            4113           1375\n  pop50_54_info rate50_54_info agen50_54_info expct50_54_info part55_59_info\n1          2251       57.00000              1            1118           1188\n2          2306       55.72035              1            1143           1260\n3          2342       58.70977              1            1166           1252\n  pop55_59_info rate55_59_info agen55_59_info expct55_59_info part60_64_info\n1          1970       60.30000              4            1046           1012\n2          2030       62.09035              4            1069           1048\n3          2093       59.81504              4            1098           1105\n  pop60_64_info rate60_64_info agen60_64_info expct60_64_info part65_69_info\n1          1625       62.30000              5             950            826\n2          1646       63.69947              5             953            855\n3          1689       65.43657              5             967            898\n  pop65_69_info rate65_69_info agen65_69_info expct65_69_info part70_74_info\n1          1300       63.50000              6             781            566\n2          1357       63.02558              6             812            600\n3          1426       63.00429              6             849            647\n  pop70_74_info rate70_74_info agen70_74_info expct70_74_info\n1           907       62.40000              7             498\n2           971       61.79725              7             541\n3          1040       62.21032              7             585\n\n# Handling missing columns safely during selection\nif (\"non_existing_column\" %in% names(breast_cancer_data)) {\n  bc_safe_select &lt;- breast_cancer_data %&gt;%\n    select(non_existing_column)\n  head(bc_safe_select, n = 3)\n} else {\n  message(\"Column 'non_existing_column' not found in breast_cancer_data.\")\n}\n\nColumn 'non_existing_column' not found in breast_cancer_data.\n\n# ....................................................\n# Remove all temporary objects created in this chunk\n# ....................................................\nrm(breast_selected, breast_renamed, bc_drop_one, bc_drop_multiple, bc_drop_by_pattern,\n   bc_reorder_manual, bc_relocate_before, bc_relocate_after,\n   bc_prefixed, bc_suffixed)\n\n\n\n\n\nmutate(), transmute(), recoding, case_when(), if_else()\nstr_detect(), regex(), %in%\nCreating dummy/flag variables\nString manipulation: strsplit(), sub(), gsub(), tolower(), `janitor::clean_names()`\n\nCreating new variables or modifying existing ones is a key part of preparing data for analysis.\nIn dplyr, we use functions like mutate() and transmute() to add, transform, or recode variables.\nWe can also create conditional variables with case_when() or if_else(), and apply string operations such as splitting, replacing, or converting text.\nThese steps help structure the data more logically, highlight important features, or derive new indicators for analysis.\n\nüîπ Summary of Functions for Creating and Modifying Variables\n\n\n\n\n\n\n\n\nTask\nFunction\nPurpose\n\n\n\n\nCreate or modify variables\nmutate()\nAdd or transform variables, keeping all columns\n\n\nCreate new variables only\ntransmute()\nKeep only new variables created\n\n\nConditional variable creation\ncase_when()\nCreate new variables based on multiple conditions\n\n\nSimple conditional assignment\nif_else()\nAssign based on TRUE/FALSE logic\n\n\nSplit strings into parts\nstrsplit()\nSplit a string into components\n\n\nReplace text (first occurrence)\nsub()\nReplace first match of a pattern\n\n\nReplace text (all occurrences)\ngsub()\nReplace all matches of a pattern\n\n\nConvert text to lowercase\ntolower()\nStandardize text to lowercase\n\n\nDetect text patterns\nstr_detect()\nCheck if a pattern exists in text\n\n\nFlexible pattern matching\nregex()\nUse regular expressions for complex patterns\n\n\nMembership check\n%in%\nTest if a value is part of a group\n\n\n\n\n‚û°Ô∏è These functions allow transforming the dataset systematically to extract new features, categorize information, or clean fields.\n\n# Creating and Modifying Variables (patients dataset)\n\n# Creating a new age group variable\npatients_mutated &lt;- patients %&gt;%\n  mutate(age_group = if_else(BIRTHDATE &lt;= as.Date(\"1970-01-01\"), \"Below 70\", \"70+\")) %&gt;%\n  relocate(age_group, .after = BIRTHDATE) %&gt;%\n  select(-Id, -DEATHDATE, -SSN, -LAT, -LON, -SUFFIX, -ZIP)\n\nhead(patients_mutated, 10)\n\n    BIRTHDATE age_group   DRIVERS   PASSPORT PREFIX       FIRST       MIDDLE\n1  1994-02-06       70+ S99996852 X47758697X    Mr.   Joshua658      Alvin56\n2  1968-08-06  Below 70 S99993577 X28173268X    Mr.   Bennie663             \n3  2008-12-21       70+                               Hunter736  Mckinley734\n4  1994-01-27       70+ S99995100 X83694889X   Mrs.   Carlyn477 Florencia449\n5  2019-07-27       70+                                 Robin66    Jeramy610\n6  2019-04-18       70+                               Arthur650             \n7  2013-08-10       70+                                 Caryl47     Lelia627\n8  1968-08-06  Below 70 S99911538 X37637991X    Mr.  Willian804    Shelton25\n9  2006-07-02       70+ S99943171               Ms. Domenica436             \n10 1948-05-28  Below 70 S99941458 X59458953X    Mr.  Arnulfo253    Jordan900\n            LAST   MAIDEN MARITAL  RACE   ETHNICITY GENDER\n1       Kunde533                M white nonhispanic      M\n2       Ebert178                D white nonhispanic      M\n3     Gerlach374                  white nonhispanic      M\n4  Williamson769 Rogahn59       M asian nonhispanic      F\n5   Gleichner915                  white nonhispanic      M\n6     Roberts511                  white nonhispanic      M\n7    Kassulke119                  white nonhispanic      F\n8      Keeling57                M white nonhispanic      M\n9         Rau926                  white    hispanic      F\n10  Jaskolski867                D white nonhispanic      M\n                         BIRTHPLACE                     ADDRESS         CITY\n1         Boston  Massachusetts  US            811 Kihn Viaduct    Braintree\n2       Chicopee  Massachusetts  US 975 Pfannerstill Throughway    Braintree\n3        Spencer  Massachusetts  US             548 Heller Lane Mattapoisett\n4       Franklin  Massachusetts  US  160 Fadel Crossroad Apt 65      Wareham\n5       Brockton  Massachusetts  US      766 Grant Loaf Unit 15    Groveland\n6       Plymouth  Massachusetts  US            866 Kulas Harbor    Cambridge\n7  East Falmouth  Massachusetts  US            578 Dickens Camp    Arlington\n8        Methuen  Massachusetts  US      848 Ebert Knoll Unit 7    Braintree\n9        Maynard  Massachusetts  US             963 Senger Fort    Haverhill\n10        Boston  Massachusetts  US    757 Lockman Annex Apt 10   Georgetown\n           STATE           COUNTY  FIPS HEALTHCARE_EXPENSES HEALTHCARE_COVERAGE\n1  Massachusetts   Norfolk County 25021            56904.96            18019.99\n2  Massachusetts   Norfolk County 25021           124024.12             1075.06\n3  Massachusetts  Plymouth County    NA            45645.06             6154.94\n4  Massachusetts  Plymouth County    NA            12895.15           659951.61\n5  Massachusetts     Essex County    NA            18500.02             5493.57\n6  Massachusetts Middlesex County 25017            14478.23              693.39\n7  Massachusetts Middlesex County 25017             9821.14            27142.51\n8  Massachusetts   Norfolk County 25021           175817.63            55473.97\n9  Massachusetts     Essex County 25009            52933.16            11941.44\n10 Massachusetts     Essex County    NA           242013.44           322768.97\n   INCOME\n1  100511\n2   49737\n3  133816\n4   17382\n5   52159\n6   75767\n7   58294\n8   49737\n9   77756\n10  35255\n\n# extract month and year from date in form of date is YYYY-MM-DD HH:MM:SS\nstr (vaccination$DATE) # date is YYYY-MM-DD HH:MM:SS format.\n\n chr [1:1619] \"2016-04-10T09:04:48Z\" \"2016-04-10T09:04:48Z\" ...\n\nvaccination &lt;- vaccination %&gt;%\n  mutate(\n    vacc_date = as.Date(strptime(DATE, format = \"%Y-%m-%dT%H:%M:%SZ\")),  # First create vacc_date\n    year = format(vacc_date, \"%Y\"),         # Extract year\n    month = format(vacc_date, \"%B\")          # Extract full month name (January, February, etc.)\n  )\n\ncolnames(vaccination)\n\n[1] \"DATE\"        \"PATIENT\"     \"ENCOUNTER\"   \"CODE\"        \"DESCRIPTION\"\n[6] \"BASE_COST\"   \"vacc_date\"   \"year\"        \"month\"      \n\nhead(vaccination)\n\n                  DATE                              PATIENT\n1 2016-04-10T09:04:48Z 30a6452c-4297-a1ac-977a-6a23237c7b46\n2 2016-04-10T09:04:48Z 30a6452c-4297-a1ac-977a-6a23237c7b46\n3 2016-04-10T09:04:48Z 30a6452c-4297-a1ac-977a-6a23237c7b46\n4 2016-04-10T09:04:48Z 30a6452c-4297-a1ac-977a-6a23237c7b46\n5 2002-10-29T19:07:21Z 34a4dcc4-35fb-6ad5-ab98-be285c586a4f\n6 2005-11-01T19:07:21Z 34a4dcc4-35fb-6ad5-ab98-be285c586a4f\n                             ENCOUNTER CODE\n1 0b03e41b-06a6-66fa-b972-acc5a83b134a  140\n2 0b03e41b-06a6-66fa-b972-acc5a83b134a  113\n3 0b03e41b-06a6-66fa-b972-acc5a83b134a   43\n4 0b03e41b-06a6-66fa-b972-acc5a83b134a  114\n5 30ab48ec-35a7-7704-86e5-113ef6a90c03  140\n6 d00bda57-b134-0654-e152-831ef486da53  140\n                                                   DESCRIPTION BASE_COST\n1           Influenza  seasonal  injectable  preservative free       136\n2 Td (adult)  5 Lf tetanus toxoid  preservative free  adsorbed       136\n3                                                 Hep B  adult       136\n4                                          meningococcal MCV4P       136\n5           Influenza  seasonal  injectable  preservative free       136\n6           Influenza  seasonal  injectable  preservative free       136\n   vacc_date year    month\n1 2016-04-10 2016    April\n2 2016-04-10 2016    April\n3 2016-04-10 2016    April\n4 2016-04-10 2016    April\n5 2002-10-29 2002  October\n6 2005-11-01 2005 November\n\n# Creating a dataset keeping only new variables (transmute)\npatients_transmuted &lt;- patients %&gt;%\n  transmute(\n    full_name = paste(FIRST, LAST, sep = \" \"), \n    birth_year = format(as.Date(BIRTHDATE), \"%Y\")\n  )\n\nhead (patients_transmuted)\n\n                full_name birth_year\n1      Joshua658 Kunde533       1994\n2      Bennie663 Ebert178       1968\n3    Hunter736 Gerlach374       2008\n4 Carlyn477 Williamson769       1994\n5    Robin66 Gleichner915       2019\n6    Arthur650 Roberts511       2019\n\n# generate a birth_year_group variable based on birth_year values\n\npatients_transmuted &lt;- patients_transmuted %&gt;%\n  mutate(birth_year_group = case_when(\n    birth_year &lt; 1940 ~ \"Before 1940\",\n    birth_year &gt;= 1940 & birth_year &lt;= 1959 ~ \"1940‚Äì1959\",\n    birth_year &gt;= 1960 & birth_year &lt;= 1979 ~ \"1960‚Äì1979\",\n    birth_year &gt;= 1980 & birth_year &lt;= 1999 ~ \"1980‚Äì1999\",\n    birth_year &gt;= 2000 ~ \"2000 and later\",\n    TRUE ~ NA_character_\n  ))\n\nhead(patients_transmuted)\n\n                full_name birth_year birth_year_group\n1      Joshua658 Kunde533       1994        1980‚Äì1999\n2      Bennie663 Ebert178       1968        1960‚Äì1979\n3    Hunter736 Gerlach374       2008   2000 and later\n4 Carlyn477 Williamson769       1994        1980‚Äì1999\n5    Robin66 Gleichner915       2019   2000 and later\n6    Arthur650 Roberts511       2019   2000 and later\n\n# other option to achieve similar result for the above \n\npatients_transmuted &lt;- patients_transmuted %&gt;%\n  mutate(birth_year = as.numeric(birth_year),   # Convert to numeric\n         birth_year_group = cut(birth_year,     # Apply cut()\n                                breaks = c(0, 1939, 1959, 1979, 1999, Inf),\n                                labels = c(\"Before 1940\", \"1940‚Äì1959\", \"1960‚Äì1979\", \"1980‚Äì1999\", \"2000 and later\"),\n                                right = TRUE\n         ))\n\n\nhead(patients_transmuted)\n\n                full_name birth_year birth_year_group\n1      Joshua658 Kunde533       1994        1980‚Äì1999\n2      Bennie663 Ebert178       1968        1960‚Äì1979\n3    Hunter736 Gerlach374       2008   2000 and later\n4 Carlyn477 Williamson769       1994        1980‚Äì1999\n5    Robin66 Gleichner915       2019   2000 and later\n6    Arthur650 Roberts511       2019   2000 and later\n\n# Using case_when to assign marital status values\npatients_case_when &lt;- patients %&gt;%\n  mutate(marital_status_group = case_when(\n    MARITAL == \"M\" ~ \"Married\",\n    MARITAL == \"S\" ~ \"Single\",\n    MARITAL == \"D\" ~ \"Divorced\",\n    TRUE ~ \"Unknown\"\n  )) %&gt;% \n  select(MARITAL, marital_status_group, RACE)\n\nhead(patients_case_when, n = 10)\n\n   MARITAL marital_status_group  RACE\n1        M              Married white\n2        D             Divorced white\n3                       Unknown white\n4        M              Married asian\n5                       Unknown white\n6                       Unknown white\n7                       Unknown white\n8        M              Married white\n9                       Unknown white\n10       D             Divorced white\n\ntable(patients_case_when$marital_status, useNA = \"ifany\")  # Show missing values in the table\n\n\nDivorced  Married   Single  Unknown \n      15       33       12       46 \n\n# Recode marital status while leaving unknown values as missing\npatients_case_when &lt;- patients_case_when %&gt;%\n  mutate(marital_2group = case_when(\n    MARITAL == \"M\" ~ \"Partnered\",\n    MARITAL == \"D\" | MARITAL == \"S\" | MARITAL == \"W\" ~ \"Not partnered\",\n    TRUE ~ NA_character_  # Replaces unknown values with missing (NA)\n  )) \n\nhead(patients_case_when)\n\n  MARITAL marital_status_group  RACE marital_2group\n1       M              Married white      Partnered\n2       D             Divorced white  Not partnered\n3                      Unknown white           &lt;NA&gt;\n4       M              Married asian      Partnered\n5                      Unknown white           &lt;NA&gt;\n6                      Unknown white           &lt;NA&gt;\n\n# Recode race status while leaving unknown values as missing\npatients_case_when &lt;- patients_case_when %&gt;%\n  mutate(race_grouped = case_when(\n    RACE == 'white' ~ \"White\",\n    RACE == \"asian\" ~ \"Asian\",\n    RACE == \"native\" | RACE == \"other\" ~ \"Other\",\n    TRUE ~ NA_character_\n  )) %&gt;% \n  select(RACE, race_grouped)\n\nhead(patients_case_when, n=10)\n\n    RACE race_grouped\n1  white        White\n2  white        White\n3  white        White\n4  asian        Asian\n5  white        White\n6  white        White\n7  white        White\n8  white        White\n9  white        White\n10 white        White\n\n# Simple conditional assignment with if_else\npatients$PASSPORT[patients$PASSPORT == \"\"] &lt;- NA # formatting the variable to know missing values\nprint(sum(is.na(patients$PASSPORT))) #  31 missing value\n\n[1] 31\n\npatients_if_else &lt;- patients %&gt;%\n  mutate(has_passport = if_else(!is.na(PASSPORT), \"Yes\", \"No\")) %&gt;% \n  select(PASSPORT, has_passport)\n\nhead(patients_if_else, n = 10)\n\n     PASSPORT has_passport\n1  X47758697X          Yes\n2  X28173268X          Yes\n3        &lt;NA&gt;           No\n4  X83694889X          Yes\n5        &lt;NA&gt;           No\n6        &lt;NA&gt;           No\n7        &lt;NA&gt;           No\n8  X37637991X          Yes\n9        &lt;NA&gt;           No\n10 X59458953X          Yes\n\n# Replace the first occurrence (e.g., fix misspelled city name)\npatients_sub &lt;- patients %&gt;%\n  mutate(city_fixed = sub(\"Nwe York\", \"New York\", CITY)) %&gt;% \n  select(-Id, -DEATHDATE, -SSN, -LAT, -LON, -SUFFIX, -ZIP)\n\nhead(patients_sub, n = 3)\n\n   BIRTHDATE   DRIVERS   PASSPORT PREFIX     FIRST      MIDDLE       LAST\n1 1994-02-06 S99996852 X47758697X    Mr. Joshua658     Alvin56   Kunde533\n2 1968-08-06 S99993577 X28173268X    Mr. Bennie663               Ebert178\n3 2008-12-21                 &lt;NA&gt;        Hunter736 Mckinley734 Gerlach374\n  MAIDEN MARITAL  RACE   ETHNICITY GENDER                  BIRTHPLACE\n1              M white nonhispanic      M   Boston  Massachusetts  US\n2              D white nonhispanic      M Chicopee  Massachusetts  US\n3                white nonhispanic      M  Spencer  Massachusetts  US\n                      ADDRESS         CITY         STATE          COUNTY  FIPS\n1            811 Kihn Viaduct    Braintree Massachusetts  Norfolk County 25021\n2 975 Pfannerstill Throughway    Braintree Massachusetts  Norfolk County 25021\n3             548 Heller Lane Mattapoisett Massachusetts Plymouth County    NA\n  HEALTHCARE_EXPENSES HEALTHCARE_COVERAGE INCOME   city_fixed\n1            56904.96            18019.99 100511    Braintree\n2           124024.12             1075.06  49737    Braintree\n3            45645.06             6154.94 133816 Mattapoisett\n\n# Replace all occurrences (e.g., replace spaces with underscores)\npatients_gsub &lt;- patients %&gt;%\n  mutate(birthplace_clean = gsub(\" \", \"_\", BIRTHPLACE)) %&gt;% \n  select(BIRTHPLACE, birthplace_clean)\n\nhead(patients_gsub, n = 3)\n\n                   BIRTHPLACE            birthplace_clean\n1   Boston  Massachusetts  US   Boston__Massachusetts__US\n2 Chicopee  Massachusetts  US Chicopee__Massachusetts__US\n3  Spencer  Massachusetts  US  Spencer__Massachusetts__US\n\n# Convert last names to lowercase\ntemp &lt;- patients %&gt;% \n  select(-Id, -DEATHDATE, -SSN, -LAT, -LON, -SUFFIX, -ZIP)\n\npatients_tolower &lt;- temp \ncolnames(patients_tolower) &lt;- tolower(colnames(patients_tolower)) \n\nhead(patients_tolower, n = 3)\n\n   birthdate   drivers   passport prefix     first      middle       last\n1 1994-02-06 S99996852 X47758697X    Mr. Joshua658     Alvin56   Kunde533\n2 1968-08-06 S99993577 X28173268X    Mr. Bennie663               Ebert178\n3 2008-12-21                 &lt;NA&gt;        Hunter736 Mckinley734 Gerlach374\n  maiden marital  race   ethnicity gender                  birthplace\n1              M white nonhispanic      M   Boston  Massachusetts  US\n2              D white nonhispanic      M Chicopee  Massachusetts  US\n3                white nonhispanic      M  Spencer  Massachusetts  US\n                      address         city         state          county  fips\n1            811 Kihn Viaduct    Braintree Massachusetts  Norfolk County 25021\n2 975 Pfannerstill Throughway    Braintree Massachusetts  Norfolk County 25021\n3             548 Heller Lane Mattapoisett Massachusetts Plymouth County    NA\n  healthcare_expenses healthcare_coverage income\n1            56904.96            18019.99 100511\n2           124024.12             1075.06  49737\n3            45645.06             6154.94 133816\n\nrm(temp)\n\n#`janitor::clean_names(df)` standardizes variable names:\n\nnames(patients)\n\n [1] \"Id\"                  \"BIRTHDATE\"           \"DEATHDATE\"          \n [4] \"SSN\"                 \"DRIVERS\"             \"PASSPORT\"           \n [7] \"PREFIX\"              \"FIRST\"               \"MIDDLE\"             \n[10] \"LAST\"                \"SUFFIX\"              \"MAIDEN\"             \n[13] \"MARITAL\"             \"RACE\"                \"ETHNICITY\"          \n[16] \"GENDER\"              \"BIRTHPLACE\"          \"ADDRESS\"            \n[19] \"CITY\"                \"STATE\"               \"COUNTY\"             \n[22] \"FIPS\"                \"ZIP\"                 \"LAT\"                \n[25] \"LON\"                 \"HEALTHCARE_EXPENSES\" \"HEALTHCARE_COVERAGE\"\n[28] \"INCOME\"             \n\ntemp &lt;- janitor::clean_names(patients)\ncolnames(temp)\n\n [1] \"id\"                  \"birthdate\"           \"deathdate\"          \n [4] \"ssn\"                 \"drivers\"             \"passport\"           \n [7] \"prefix\"              \"first\"               \"middle\"             \n[10] \"last\"                \"suffix\"              \"maiden\"             \n[13] \"marital\"             \"race\"                \"ethnicity\"          \n[16] \"gender\"              \"birthplace\"          \"address\"            \n[19] \"city\"                \"state\"               \"county\"             \n[22] \"fips\"                \"zip\"                 \"lat\"                \n[25] \"lon\"                 \"healthcare_expenses\" \"healthcare_coverage\"\n[28] \"income\"             \n\n# Remove all temporary objects created in this chunk\nrm(patients_mutated, patients_transmuted, patients_case_when, patients_if_else,\n   patients_split, patients_sub, patients_gsub, patients_tolower, temp)\n\nWarning in rm(patients_mutated, patients_transmuted, patients_case_when, :\nobject 'patients_split' not found\n\n\n\n\nParsing Text Fields in R: Handling Multi-Word Names\nIn real-world datasets, it‚Äôs common to encounter text fields where multiple data elements‚Äîsuch as city, state, and country‚Äîare embedded within a single string. These entries often include inconsistent spacing, making them challenging to analyze directly.\nParsing refers to the process of systematically breaking down these complex text fields into structured, usable components.\nparsing involves\n\nDetecting patterns in spacing‚Äîfor instance, identifying how many spaces exist between different parts of a string.\nDeciding where to split the string. For example, a single space might separate words within a single name such as city name (e.g., \"East Falmouth\"), while two or more spaces might indicate the boundary between city, state, and country (e.g., \"East Falmouth  Massachusetts  US\").\nCreating new variables or columns such as city, state, and country for cleaner and more structured data representation.\n\nparsing is important\n\nMany administrative or imported datasets contain combined or messy fields that hinder direct analysis.\nProper parsing helps to standardize and clean these fields, which is a critical step for effective data management, visualization, and analysis.\nIt enables downstream tasks such as geographic grouping, mapping, and report generation.\n\nSummary Table\n\n\n\n\n\n\n\nStep\nPurpose\n\n\n\n\nstr_view()\nVisually inspect spacing patterns between components\n\n\nstr_extract_all(\" +\")\nExtract all space sequences\n\n\nmap_int(..., length)\nCount the number of space groups per entry\n\n\nstr_count(\"\\\\S+\")\nCount the number of words\n\n\nnchar() with map_chr()\nShow the length of each space between words\n\n\narrange(desc(word_count))\nIdentify rows with the most words (potential outliers)\n\n\n\nDetecting and Understanding Space Patterns\nTo begin, I used example data from the patients$BIRTHPLACE column to identify how different rows are structured and where inconsistencies might exist.\n1. Visual Inspection of Spacing We can use str_view() from the stringr package to highlight space sequences:\n\nstr_view(patients$BIRTHPLACE[1:15], pattern = \" +\", match = TRUE)\n\n [1] ‚îÇ Boston&lt;  &gt;Massachusetts&lt;  &gt;US\n [2] ‚îÇ Chicopee&lt;  &gt;Massachusetts&lt;  &gt;US\n [3] ‚îÇ Spencer&lt;  &gt;Massachusetts&lt;  &gt;US\n [4] ‚îÇ Franklin&lt;  &gt;Massachusetts&lt;  &gt;US\n [5] ‚îÇ Brockton&lt;  &gt;Massachusetts&lt;  &gt;US\n [6] ‚îÇ Plymouth&lt;  &gt;Massachusetts&lt;  &gt;US\n [7] ‚îÇ East&lt; &gt;Falmouth&lt;  &gt;Massachusetts&lt;  &gt;US\n [8] ‚îÇ Methuen&lt;  &gt;Massachusetts&lt;  &gt;US\n [9] ‚îÇ Maynard&lt;  &gt;Massachusetts&lt;  &gt;US\n[10] ‚îÇ Boston&lt;  &gt;Massachusetts&lt;  &gt;US\n[11] ‚îÇ Framingham&lt;  &gt;Massachusetts&lt;  &gt;US\n[12] ‚îÇ Wayland&lt;  &gt;Massachusetts&lt;  &gt;US\n[13] ‚îÇ Toulouse&lt;  &gt;Occitanie&lt;  &gt;FR\n[14] ‚îÇ Framingham&lt;  &gt;Massachusetts&lt;  &gt;US\n[15] ‚îÇ Lynn&lt;  &gt;Massachusetts&lt;  &gt;US\n\n\nThis shows, for example: East&lt; &gt;Falmouth&lt; &gt;Massachusetts&lt; &gt;US Where: - One space connects city words (‚ÄúEast Falmouth‚Äù) - Two spaces separate city, state, and country\n2. Extract and Inspect Space Sequences Each row shows the space segments between words. This helps us detect whether extra or inconsistent spacing is present.\n\npatients %&gt;%\n  mutate(space_groups = str_extract_all(BIRTHPLACE, \" +\")) %&gt;%\n  select(BIRTHPLACE, space_groups) %&gt;%\n  head()\n\n                   BIRTHPLACE space_groups\n1   Boston  Massachusetts  US         ,   \n2 Chicopee  Massachusetts  US         ,   \n3  Spencer  Massachusetts  US         ,   \n4 Franklin  Massachusetts  US         ,   \n5 Brockton  Massachusetts  US         ,   \n6 Plymouth  Massachusetts  US         ,   \n\n\n3. Count Number of Space Groups This gives a frequency table showing how many rows have 2, 3, 4, or more space groups. A row with more than 2 groups may have extra words or inconsistent formatting.\n\npatients %&gt;%\n  mutate(\n    space_groups = str_extract_all(BIRTHPLACE, \" +\"),\n    n_spaces = map_int(space_groups, length)\n  ) %&gt;%\n  count(n_spaces)\n\n  n_spaces  n\n1        2 84\n2        3 15\n3        4  4\n4        5  3\n\n\n4. Count the Number of Words This confirms how many ‚Äúword segments‚Äù are in each row and helps identify malformed entries.\n\npatients %&gt;%\n  mutate(space_count = str_count(BIRTHPLACE, \" +\")) %&gt;%\n  count(space_count)\n\n  space_count  n\n1           2 84\n2           3 15\n3           4  4\n4           5  3\n\n\n5. Combine Word Count and Space Width To fully understand the complexity of each row, I extracted the number of words and the exact space widths between them:\nThis helps in identifying patterns like:\n‚ÄúEast Falmouth Massachusetts US‚Äù ‚Üí 4 words, with spacing like 1 | 2 | 1\n‚ÄúBoston Massachusetts US‚Äù ‚Üí 3 words, spacing 2 | 2\n\npatients %&gt;%\n  mutate(\n    word_count = str_count(BIRTHPLACE, \"\\\\S+\"),  # count non-space words\n    space_groups = str_extract_all(BIRTHPLACE, \" +\"),\n    space_lengths = map_chr(space_groups, ~ paste(nchar(.x), collapse = \" | \"))  # lengths of spaces\n  ) %&gt;%\n  arrange(desc(word_count)) %&gt;%\n  select(BIRTHPLACE, word_count, space_lengths) %&gt;%\n  head(20)\n\n                                 BIRTHPLACE word_count     space_lengths\n1  Santiago de los Caballeros  Santiago  DO          6 1 | 1 | 1 | 2 | 2\n2  Santiago de los Caballeros  Santiago  DO          6 1 | 1 | 1 | 2 | 2\n3  Santiago de los Caballeros  Santiago  DO          6 1 | 1 | 1 | 2 | 2\n4             San Salvador  El Salvador  SV          5     1 | 2 | 1 | 2\n5      Santo Domingo  National District  DO          5     1 | 2 | 1 | 2\n6         Portsmouth  Saint John Parish  DM          5     2 | 1 | 1 | 2\n7           Wesley  Saint Andrew Parish  DM          5     2 | 1 | 1 | 2\n8          East Falmouth  Massachusetts  US          4         1 | 2 | 2\n9       West Springfield  Massachusetts  US          4         1 | 2 | 2\n10        North Pembroke  Massachusetts  US          4         1 | 2 | 2\n11    North Attleborough  Massachusetts  US          4         1 | 2 | 2\n12                   Ponce  Puerto Rico  PR          4         2 | 1 | 2\n13            Fall River  Massachusetts  US          4         1 | 2 | 2\n14       South Deerfield  Massachusetts  US          4         1 | 2 | 2\n15                 Bayamon  Puerto Rico  PR          4         2 | 1 | 2\n16            Oak Bluffs  Massachusetts  US          4         1 | 2 | 2\n17       North Lakeville  Massachusetts  US          4         1 | 2 | 2\n18            Guatemala City  Guatemala  GT          4         1 | 2 | 2\n19         North Andover  Massachusetts  US          4         1 | 2 | 2\n20         North Reading  Massachusetts  US          4         1 | 2 | 2\n\n\nFrom observations in the data, split BIRTHPLACE by 2+ spaces would be more appropriate. Those two words having one space are the names for a city, state or country\n\n# Clean and split birthplace into city, state/region, and country\npatients_clean &lt;- patients %&gt;%\n  mutate(\n    parts = str_split(BIRTHPLACE, \" {2,}\"),             # split BIRTHPLACE by 2+ spaces\n    # %||% is a shorthand from the rlang package (used implicitly here via purrr) that returns the left-hand side if it exists, otherwise returns the right-hand side.\n    # eg If .x[2] exists, use it; otherwise, use NA (missing character).\n    city = map_chr(parts, ~ .x[1] %||% NA_character_),  # city name (first part)\n    state = map_chr(parts, ~ .x[2] %||% NA_character_), # state or region (second part)\n    country = map_chr(parts, ~ .x[3] %||% NA_character_)# country code (third part)\n  ) %&gt;%\n  select(BIRTHPLACE, city, state, country)\nhead(patients_clean, 10)\n\n                         BIRTHPLACE          city         state country\n1         Boston  Massachusetts  US        Boston Massachusetts      US\n2       Chicopee  Massachusetts  US      Chicopee Massachusetts      US\n3        Spencer  Massachusetts  US       Spencer Massachusetts      US\n4       Franklin  Massachusetts  US      Franklin Massachusetts      US\n5       Brockton  Massachusetts  US      Brockton Massachusetts      US\n6       Plymouth  Massachusetts  US      Plymouth Massachusetts      US\n7  East Falmouth  Massachusetts  US East Falmouth Massachusetts      US\n8        Methuen  Massachusetts  US       Methuen Massachusetts      US\n9        Maynard  Massachusetts  US       Maynard Massachusetts      US\n10        Boston  Massachusetts  US        Boston Massachusetts      US\n\ntail(patients_clean, 10)\n\n                                  BIRTHPLACE                       city\n97                 Boston  Massachusetts  US                     Boston\n98     North Attleborough  Massachusetts  US         North Attleborough\n99                Taunton  Massachusetts  US                    Taunton\n100            Chelmsford  Massachusetts  US                 Chelmsford\n101                Boston  Massachusetts  US                     Boston\n102             Holliston  Massachusetts  US                  Holliston\n103 Santiago de los Caballeros  Santiago  DO Santiago de los Caballeros\n104           Springfield  Massachusetts  US                Springfield\n105             Fitchburg  Massachusetts  US                  Fitchburg\n106       Millis-Clicquot  Massachusetts  US            Millis-Clicquot\n            state country\n97  Massachusetts      US\n98  Massachusetts      US\n99  Massachusetts      US\n100 Massachusetts      US\n101 Massachusetts      US\n102 Massachusetts      US\n103      Santiago      DO\n104 Massachusetts      US\n105 Massachusetts      US\n106 Massachusetts      US\n\n\nConclusion From this exploration, we observe that:\n\nMost entries use single spaces within city names (e.g., ‚ÄúEast Falmouth‚Äù)\nTwo or more spaces are commonly used to separate city, state, and country names\nParsing using a split on ‚Äú{2,}‚Äù (two or more spaces) is a reliable strategy\n\n\n\n\nFree-text fields are common in public-health, administrative, and clinical datasets. While they are rich in information, the lack of structure and consistent vocabulary can limit their usefulness. In real-world datasets, especially in health, administration, and survey data, free-text fields often contain rich information hidden in inconsistent or varied language. A single concept (e.g., ‚ÄúCOVID-19 vaccine‚Äù) might appear in many forms such as ‚Äúcovid jab‚Äù, ‚Äúcovid-19 injection‚Äù, or ‚ÄúSARS-CoV-2 shot‚Äù. This presentation demonstrates how to transform unstructured text into structured, analyzable data using R. The workflow covers\n\ntokenization,\nword-frequency analysis,\nstop-word removal,\nTF‚ÄìIDF to highlight context-specific terms,\nword-cloud visualisation,\nbigram and trigram extraction, and\npattern detection with regular expressions to create categorical variables.\n\nBasic Tokenisation and Word-Frequency Table\nTokenisation splits long strings of text into individual words or terms (‚Äútokens‚Äù). This enables us to calculate how often each word appears, which is essential for understanding vocabulary patterns.\nWe begin by loading the necessary R packages. If a package is not already installed.\n\n# Install packages when they are not already available\nif (!require(\"tidytext\")) install.packages(\"tidytext\", dependencies = TRUE)\nif (!require(\"wordcloud\")) install.packages(\"wordcloud\", dependencies = TRUE)\nif (!require(\"tm\"))        install.packages(\"tm\",        dependencies = TRUE)\n\nlibrary(tidytext)   # text mining utilities\nlibrary(wordcloud)  # word-cloud plots\nlibrary(tm)         # text-mining helpers used by wordcloud\n\n\nword_freq &lt;- vaccination %&gt;%\n  unnest_tokens(word, DESCRIPTION) %&gt;%\n  count(word, sort = TRUE) %&gt;%\n  filter(!is.na(word) & word != \"\")\n\nhead(word_freq)\n\n          word   n\n1         free 929\n2 preservative 929\n3    influenza 859\n4   injectable 859\n5     seasonal 859\n6         dose 230\n\n\nRemove Stop Words\nStop words are common terms like ‚Äúand‚Äù, ‚Äúthe‚Äù, or ‚Äúin‚Äù that typically do not contribute meaningful information in analysis. Removing these helps us focus on content-rich terms.\n\ndata(\"stop_words\")          # built-in tidytext stop-word list\n\nword_freq_clean &lt;- vaccination %&gt;%\n  unnest_tokens(word, DESCRIPTION) %&gt;%\n  anti_join(stop_words, by = \"word\") %&gt;%\n  count(word, sort = TRUE)\n\nhead(word_freq_clean)\n\n          word   n\n1         free 929\n2 preservative 929\n3    influenza 859\n4   injectable 859\n5     seasonal 859\n6         dose 230\n\n\n\nVisualise Word Frequencies\nThis bar chart provides a visual overview of the most common meaningful words in the dataset after stop-word removal.\n\nword_freq_clean %&gt;%\n  filter(n &gt; 20) %&gt;%\n  ggplot(aes(x = reorder(word, n), y = n)) +\n  geom_col() +\n  coord_flip() +\n  labs(title = \"Most Frequent Words After Stop-Word Removal\",\n       x = \"Word\",\n       y = \"Count\")\n\n\n\n\n\n\n\n\n\nCreate a Word Cloud\nA word cloud presents word frequencies visually, with more frequent words appearing larger. It offers a quick snapshot of key terms in the dataset.\n\npar(mar = c(1, 1, 1, 1))  # reduce plot margins\nwordcloud(words = word_freq_clean$word,\n          freq = word_freq_clean$n,\n          min.freq = 1,\n          max.words = 100,\n          random.order = FALSE)\n\n\n\n\n\n\n\n\n\nTF‚ÄìIDF Analysis\nTF‚ÄìIDF (Term Frequency‚ÄìInverse Document Frequency) highlights words that are common within a group but rare across groups. This helps identify terms that are contextually important for specific subgroups.\n\n# Example assumes a column called 'source_id' identifies individual documents\n\ntfidf_result &lt;- vaccination %&gt;%\n  select(source_id, DESCRIPTION) %&gt;%\n  unnest_tokens(word, DESCRIPTION) %&gt;%\n  anti_join(stop_words, by = \"word\") %&gt;%\n  count(source_id, word, sort = TRUE) %&gt;%\n  bind_tf_idf(word, source_id, n) %&gt;%\n  arrange(desc(tf_idf))\n\nhead(tfidf_result)\n\n\nBigrams and Trigrams (n-grams)\nSometimes the context of words matters more than individual terms. N-grams (bigrams, trigrams, etc.) allow us to capture meaningful phrases instead of isolated words.\nBigrams ‚Äì two-word phrases\n\nbigrams &lt;- vaccination %&gt;%\n  unnest_tokens(bigram, DESCRIPTION, token = \"ngrams\", n = 2) %&gt;%\n  count(bigram, sort = TRUE)\n\nhead(bigrams)\n\n                   bigram   n\n1       preservative free 929\n2      influenza seasonal 859\n3 injectable preservative 859\n4     seasonal injectable 859\n5                    &lt;NA&gt; 185\n6                covid 19 144\n\n\nTrigrams ‚Äì three-word phrases\n\ntrigrams &lt;- vaccination %&gt;%\n  unnest_tokens(trigram, DESCRIPTION, token = \"ngrams\", n = 3) %&gt;%\n  count(trigram, sort = TRUE)\n\nhead(trigrams)\n\n                           trigram   n\n1    influenza seasonal injectable 859\n2     injectable preservative free 859\n3 seasonal injectable preservative 859\n4                             &lt;NA&gt; 319\n5                      19 mrna lnp 142\n6                    covid 19 mrna 142\n\n\n\nCreate Categorical Variables from free and unstructured Text\nWe use regular expressions to classify unstructured free-text values into consistent categories. This transformation is critical for summarising or modelling based on text. We can identify and map all words that contain a certain substring (like ‚Äúcovid‚Äù in ‚ÄúCOVID-19‚Äù, ‚Äúcovid_19‚Äù, or ‚Äúcovid‚Äù). You can use str_detect() with a case-insensitive regular expression to filter your word frequency table.\n\nvaccination &lt;- vaccination %&gt;%\n  mutate(vaccine_group = case_when(\n    str_detect(DESCRIPTION, regex(\"covid|sars-cov-2\", ignore_case = TRUE)) ~ \"COVID-19\",\n    str_detect(DESCRIPTION, regex(\"influenza\", ignore_case = TRUE)) ~ \"Influenza\",\n    str_detect(DESCRIPTION, regex(\"hepatitis|hep a|hep b\", ignore_case = TRUE)) ~ \"Hepatitis\",\n    str_detect(DESCRIPTION, regex(\"hpv\", ignore_case = TRUE)) ~ \"HPV\",\n    str_detect(DESCRIPTION, regex(\"mmr\", ignore_case = TRUE)) ~ \"MMR\",\n    str_detect(DESCRIPTION, regex(\"dtap|tdap|tetanus|td \\\\(?adult\\\\)?\", ignore_case = TRUE)) ~ \"DTP group\",\n    str_detect(DESCRIPTION, regex(\"ipv\", ignore_case = TRUE)) ~ \"IPV\",\n    str_detect(DESCRIPTION, regex(\"hib\", ignore_case = TRUE)) ~ \"Hib\",\n    str_detect(DESCRIPTION, regex(\"meningococcal|mcv4\", ignore_case = TRUE)) ~ \"Meningococcal\",\n    str_detect(DESCRIPTION, regex(\"pneumococcal.*13\", ignore_case = TRUE)) ~ \"Pneumococcal PCV13\",\n    str_detect(DESCRIPTION, regex(\"pneumococcal.*23\", ignore_case = TRUE)) ~ \"Pneumococcal PPV23\",\n    str_detect(DESCRIPTION, regex(\"rotavirus\", ignore_case = TRUE)) ~ \"Rotavirus\",\n    str_detect(DESCRIPTION, regex(\"varicella\", ignore_case = TRUE)) ~ \"Varicella\",\n    str_detect(DESCRIPTION, regex(\"zoster\", ignore_case = TRUE)) ~ \"Zoster\",\n    TRUE ~ \"Other\"\n  ))\n\n# Frequency check\n\ntable(vaccination$vaccine_group)\n\n\n          COVID-19          DTP group          Hepatitis                Hib \n               144                152                114                 32 \n               HPV          Influenza                IPV      Meningococcal \n                61                859                 51                 52 \n               MMR Pneumococcal PCV13 Pneumococcal PPV23          Rotavirus \n                26                 52                  8                 21 \n         Varicella             Zoster \n                26                 21 \n\n# Grouping Values Using %in% Inside case_when()\n\nvaccination &lt;- vaccination %&gt;%\n  mutate(vacc_group3 = case_when(\n    vaccine_group %in% c(\"COVID-19\", \"Influenza\") ~ \"Respiratory vaccines\",\n    vaccine_group %in% c(\"DTP group\", \"Hepatitis\", \"HPV\", \"Hib\", \"IPV\", \n                         \"Meningococcal\", \"MMR\") ~ \"Childhood vaccines\",\n    TRUE ~ \"Other\"\n  )) %&gt;% \n  select(-ENCOUNTER, -CODE)\n\nhead (vaccination)\n\n                  DATE                              PATIENT\n1 2016-04-10T09:04:48Z 30a6452c-4297-a1ac-977a-6a23237c7b46\n2 2016-04-10T09:04:48Z 30a6452c-4297-a1ac-977a-6a23237c7b46\n3 2016-04-10T09:04:48Z 30a6452c-4297-a1ac-977a-6a23237c7b46\n4 2016-04-10T09:04:48Z 30a6452c-4297-a1ac-977a-6a23237c7b46\n5 2002-10-29T19:07:21Z 34a4dcc4-35fb-6ad5-ab98-be285c586a4f\n6 2005-11-01T19:07:21Z 34a4dcc4-35fb-6ad5-ab98-be285c586a4f\n                                                   DESCRIPTION BASE_COST\n1           Influenza  seasonal  injectable  preservative free       136\n2 Td (adult)  5 Lf tetanus toxoid  preservative free  adsorbed       136\n3                                                 Hep B  adult       136\n4                                          meningococcal MCV4P       136\n5           Influenza  seasonal  injectable  preservative free       136\n6           Influenza  seasonal  injectable  preservative free       136\n   vacc_date year    month vaccine_group          vacc_group3\n1 2016-04-10 2016    April     Influenza Respiratory vaccines\n2 2016-04-10 2016    April     DTP group   Childhood vaccines\n3 2016-04-10 2016    April     Hepatitis   Childhood vaccines\n4 2016-04-10 2016    April Meningococcal   Childhood vaccines\n5 2002-10-29 2002  October     Influenza Respiratory vaccines\n6 2005-11-01 2005 November     Influenza Respiratory vaccines\n\n\nConclusion\nBy combining the tidytext, stringr, and dplyr packages we converted messy free-text into structured data ready for analysis. This approach supports reproducible work, clearer insights, and more robust statistical modelling.\n\n\n\n\n\nCreating factor levels and relabeling\n\nApplying labels with label() and val_labels()\n\nDescriptive summaries with describe()\n\nIn R, categorical variables can be represented as factors to support grouping, modeling, and formatting for reporting. Factor variables store both the value and its associated level label.\nThis section introduces key functions to:\n\nConvert variables into factors\n\nRename or reorder levels for clarity\n\nApply variable-level labels using label() or var_label()\n\nAssign value labels using val_labels() (e.g., 1 = Male)\n\nGenerate descriptive metadata summaries using Hmisc::describe()\n\nValue labels are especially useful when numeric codes represent categorical responses. These can be shown in summaries or retained for export and display.\nYou can choose to display or hide value labels:\noptions(labelled::val_labels_visible = TRUE) # Show values like ‚Äú1 = Male‚Äù options(labelled::val_labels_visible = FALSE) # Show only ‚ÄúMale‚Äù\nüîπ Summary of Functions for Working with Factors and Labels\n\n\n\n\n\n\n\n\nTask\nFunction\nDescription\n\n\n\n\nConvert to factor\nas.factor(x)\nConvert a character or numeric variable into a factor\n\n\nReorder levels\nfactor(x, levels = ...)\nDefine a specific order for levels\n\n\nRename factor levels\nlevels(x) &lt;- c(...)\nManually change the displayed names of factor levels\n\n\nRecode with forcats\nfct_recode(), fct_relevel()\nRelabel, reorder, or collapse factor levels using tidyverse tools\n\n\nApply variable label\nlabel(x) &lt;- \"...\" or var_label(x) &lt;- \"...\"\nAssign a description to a variable\n\n\nApply value labels\nval_labels(x) &lt;- c(\"Label\" = code)\nDefine how codes map to category names (e.g., 1 = Male)\n\n\nRetrieve labels\nlabel(x), val_labels(x)\nView current labels or mappings\n\n\nGenerate summary with labels\nHmisc::describe(df)\nReturn a summary including variable names, labels, types, and distributions\n\n\n\n\n# Select two categorical variables\nvacc_factor &lt;- vacc_pt_merged %&gt;%\n  select(gender, marital)\n\n# Convert character to factor\nvacc_factor &lt;- vacc_factor %&gt;%\n  mutate(\n    gender = factor(gender),\n    marital = factor(marital)\n  )\n\n# Relabel factor levels using fct_recode()\nvacc_factor &lt;- vacc_factor %&gt;%\n  mutate(\n    gender = fct_recode(gender, \"Male\" = \"M\", \"Female\" = \"F\"),\n    marital = fct_recode(marital,\n                         \"Married\" = \"M\",\n                         \"Divorced\" = \"D\",\n                         \"Single\" = \"S\",\n                         \"Widowed\" = \"W\")\n  )\n\ntail(vacc_factor)\n\n     gender marital\n1614 Female  Single\n1615 Female  Single\n1616 Female  Single\n1617 Female  Single\n1618 Female  Single\n1619 Female  Single\n\n# Assign variable labels\nvar_label(vacc_factor$gender) &lt;- \"Biological Sex\"\nvar_label(vacc_factor$marital) &lt;- \"Marital Status\"\n\n# Assign value labels\nvacc_factor$gender_chr &lt;- as.character(vacc_factor$gender) # Convert factor to character\nval_labels(vacc_factor$gender_chr) &lt;- c(\"1\" = \"Male\", \"2\" = \"Female\")\n\n\n# View internal structure and label info\nstr(vacc_factor)\n\n'data.frame':   1619 obs. of  3 variables:\n $ gender    : Factor w/ 2 levels \"Female\",\"Male\": 2 2 2 2 2 2 2 2 2 2 ...\n  ..- attr(*, \"label\")= chr \"Biological Sex\"\n $ marital   : Factor w/ 5 levels \"\",\"Divorced\",..: 3 3 3 3 3 3 2 2 2 2 ...\n  ..- attr(*, \"label\")= chr \"Marital Status\"\n $ gender_chr: chr+lbl [1:1619] Male  , Male  , Male  , Male  , Male  , Male  , Male ...\n   ..@ labels: Named chr  \"Male\" \"Female\"\n   .. ..- attr(*, \"names\")= chr [1:2] \"1\" \"2\"\n\n# Remove bad labels if needed:\nvar_label(vacc_factor$gender) &lt;- NULL\n\n# Remove temporary object\nrm(vacc_factor)\n\n\n\n\n\n# Select two categorical variables\nvacc_factor &lt;- vacc_pt_merged %&gt;%\n  select(gender, marital)\n\n# Convert character to factor\nvacc_factor &lt;- vacc_factor %&gt;%\n  mutate(\n    gender = factor(gender),\n    marital = factor(marital)\n  )\n\n# Relabel factor levels using fct_recode()\nvacc_factor &lt;- vacc_factor %&gt;%\n  mutate(\n    gender = fct_recode(gender, \"Male\" = \"M\", \"Female\" = \"F\"),\n    marital = fct_recode(marital,\n                         \"Married\" = \"M\",\n                         \"Divorced\" = \"D\",\n                         \"Single\" = \"S\",\n                         \"Widowed\" = \"W\")\n  )\n\ntail(vacc_factor)\n\n     gender marital\n1614 Female  Single\n1615 Female  Single\n1616 Female  Single\n1617 Female  Single\n1618 Female  Single\n1619 Female  Single\n\n# Assign variable labels\nvar_label(vacc_factor$gender) &lt;- \"Biological Sex\"\nvar_label(vacc_factor$marital) &lt;- \"Marital Status\"\n\n# Assign value labels\nvacc_factor$gender_chr &lt;- as.character(vacc_factor$gender) # Convert factor to character\nval_labels(vacc_factor$gender_chr) &lt;- c(\"1\" = \"Male\", \"2\" = \"Female\")\n\n\n# View internal structure and label info\nstr(vacc_factor)\n\n'data.frame':   1619 obs. of  3 variables:\n $ gender    : Factor w/ 2 levels \"Female\",\"Male\": 2 2 2 2 2 2 2 2 2 2 ...\n  ..- attr(*, \"label\")= chr \"Biological Sex\"\n $ marital   : Factor w/ 5 levels \"\",\"Divorced\",..: 3 3 3 3 3 3 2 2 2 2 ...\n  ..- attr(*, \"label\")= chr \"Marital Status\"\n $ gender_chr: chr+lbl [1:1619] Male  , Male  , Male  , Male  , Male  , Male  , Male ...\n   ..@ labels: Named chr  \"Male\" \"Female\"\n   .. ..- attr(*, \"names\")= chr [1:2] \"1\" \"2\"\n\n# Remove bad labels if needed:\nvar_label(vacc_factor$gender) &lt;- NULL\n\n# Remove temporary object\nrm(vacc_factor)\n\n\ngroup_by(), summarize(), ungroup()\nRow and column percentages: details presented in section 7.2 below\nWeighted summaries with wt =\n\nGrouping and summarizing data is fundamental for understanding patterns, distributions, and relationships within datasets.\nIn dplyr, the functions group_by() and summarize() are used together to calculate statistics across different groups.\nWe can also calculate proportions (row-wise or column-wise) and perform weighted summaries when necessary. The details regarding row and column percentages are presented in section 7.2 below.\nThese steps are critical for aggregating information into meaningful insights, especially when working with categorical, grouped, or longitudinal data.\n\nüîπ Summary of Functions for Grouping and Summarizing\n\n\n\n\n\n\n\n\nTask\nFunction\nPurpose\n\n\n\n\nGroup data by one or more variables\ngroup_by()\nDefine groups for aggregation\n\n\nSummarize grouped data\nsummarize()\nApply aggregation functions (e.g., mean, sum, count)\n\n\nRemove grouping structure\nungroup()\nReturn to ungrouped state after summary\n\n\nCalculate row-wise or column-wise proportions\nManual with mutate(), prop.table(), etc.\nUnderstand percentage distribution within/between groups\n\n\nWeighted summaries\nsummarize(wt = )\nCompute weighted means, sums, or percentages when different rows contribute differently\n\n\n\n\n‚û°Ô∏è Grouping and summarization allow efficient exploration of key relationships and preparation of clean summary tables.\n\n\n# ....................................................\n# Grouping and Summarizing Breast Cancer Data\n# ....................................................\n\n# Grouping by SA3 name, State, and Year, and summarizing participation\nbc_summary_year &lt;- breast_cancer_data %&gt;%\n  group_by(year) %&gt;%\n  summarise(\n    total_participants = sum(part50_74, na.rm = TRUE),\n    total_population = sum(pop50_74, na.rm = TRUE),\n    mean_screening_rate = mean(rate50_74, na.rm = TRUE),\n    .groups = \"drop\"\n  )\nhead(bc_summary_year, n = 3)\n\n# A tibble: 3 √ó 4\n    year total_participants total_population mean_screening_rate\n   &lt;int&gt;              &lt;dbl&gt;            &lt;dbl&gt;               &lt;dbl&gt;\n1 201617            1720463          3127749                54.9\n2 201718            1748606          3187574                54.7\n3 201819            1781484          3247470                54.6\n\n# --- Create Vaccination Pattern Dataset ---\ndf_vaccination_plot &lt;- vaccination %&gt;%\n  group_by(year, month, vaccine_group) %&gt;%\n  summarise(\n    count = n(),  # Number of records per year-month-vaccine_group combination\n    .groups = \"drop\"\n  ) %&gt;%\n  ungroup() %&gt;%\n  group_by(year, month) %&gt;%\n  mutate(\n    count_month = sum(count)  # Total vaccines in that year-month across all groups\n  ) %&gt;%\n  ungroup() %&gt;%\n  mutate(\n    proportion_month = round((count / count_month) * 100, 1)  # % per vaccine group within month\n  ) %&gt;%\n  group_by(year) %&gt;%\n  mutate(\n    total_year = sum(count)  # Total vaccines across the year\n  ) %&gt;%\n  mutate(\n    proportion_year = round((count / total_year) * 100, 1)  # % per vaccine group within year\n  ) %&gt;%\n  ungroup()\n\n# View first few rows\ntail(df_vaccination_plot)\n\n# A tibble: 6 √ó 8\n  year  month     vaccine_group count count_month proportion_month total_year\n  &lt;chr&gt; &lt;chr&gt;     &lt;chr&gt;         &lt;int&gt;       &lt;int&gt;            &lt;dbl&gt;      &lt;int&gt;\n1 2024  October   Zoster            1          15              6.7        122\n2 2024  September COVID-19          1          15              6.7        122\n3 2024  September DTP group         2          15             13.3        122\n4 2024  September HPV               2          15             13.3        122\n5 2024  September Influenza         9          15             60          122\n6 2024  September Meningococcal     1          15              6.7        122\n# ‚Ñπ 1 more variable: proportion_year &lt;dbl&gt;\n\n# Enhanced summary of breast cancer screening data with SA3, State, and National Year-level proportions\n# use na.rm = TRUE to remove (ignore) missing values (NA) when calculating\n\nbc_summary &lt;- breast_cancer_data %&gt;%\n  # Group by SA3 area, State, and Year\n  group_by(sa3name, state, year) %&gt;%\n  summarise(\n    total_participants = sum(part50_74, na.rm = TRUE),  # Sum of screened participants\n    total_population = sum(pop50_74, na.rm = TRUE),     # Sum of target population\n    .groups = \"drop\"\n  ) %&gt;%\n  # Calculate SA3-level screening rate and proportion\n  mutate(\n    screening_rate = round((total_participants / total_population) * 100, 1),  # % screened in that SA3\n    proportion_area = round((total_participants / sum(total_participants)) * 100, 1)  # % contribution to national participants\n  ) %&gt;%\n  # Add State-level aggregated summaries\n  group_by(state, year) %&gt;%\n  mutate(\n    state_sa3 = n(),  # Number of SA3 areas within each State-Year\n    state_total_participants = sum(total_participants, na.rm = TRUE),  # State-wide participants\n    state_total_population = sum(total_population, na.rm = TRUE),      # State-wide target population\n    state_screening_rate = round((state_total_participants / state_total_population) * 100, 1),  # % screened at State level\n    state_proportion = round((state_total_participants / sum(total_participants)) * 100, 1)  # State share of total participants\n  ) %&gt;%\n  ungroup() %&gt;%\n  # Add National Year-level aggregated summaries\n  group_by(year) %&gt;%\n  mutate(\n    year_sa3 = n(),  # Number of SA3 areas within each Year\n    year_total_participants = sum(total_participants, na.rm = TRUE),  # Australia-wide participants for that year\n    year_total_population = sum(total_population, na.rm = TRUE),      # Australia-wide target population for that year\n    year_screening_rate = round((year_total_participants / year_total_population) * 100, 1),  # National % screened\n    year_proportion = round((year_total_participants / sum(total_participants)) * 100, 1)  # National share\n  ) %&gt;%\n  ungroup() %&gt;%\n  arrange(year, state, sa3name)   # Final arrangement for neat viewing\n\n# View the last few rows\ntail(bc_summary)\n\n# A tibble: 6 √ó 17\n  sa3name        state   year total_participants total_population screening_rate\n  &lt;chr&gt;          &lt;chr&gt;  &lt;int&gt;              &lt;dbl&gt;            &lt;dbl&gt;          &lt;dbl&gt;\n1 Stirling       WA    201920              13878            27265           50.9\n2 Swan           WA    201920               8513            17274           49.3\n3 Wanneroo       WA    201920              12032            24345           49.4\n4 West Pilbara   WA    201920                828             2409           34.4\n5 Wheat Belt - ‚Ä¶ WA    201920               4947             9813           50.4\n6 Wheat Belt - ‚Ä¶ WA    201920               1446             3342           43.3\n# ‚Ñπ 11 more variables: proportion_area &lt;dbl&gt;, state_sa3 &lt;int&gt;,\n#   state_total_participants &lt;dbl&gt;, state_total_population &lt;dbl&gt;,\n#   state_screening_rate &lt;dbl&gt;, state_proportion &lt;dbl&gt;, year_sa3 &lt;int&gt;,\n#   year_total_participants &lt;dbl&gt;, year_total_population &lt;dbl&gt;,\n#   year_screening_rate &lt;dbl&gt;, year_proportion &lt;dbl&gt;\n\n# ....................................................\n# Calculating Proportions: details presented in section 7.2 below\n# ....................................................\n\n# Adding participation proportion within each SA3-year group\nbc_summary_with_prop &lt;- bc_summary %&gt;%\n  mutate(\n    participation_rate = (total_participants / total_population) * 100\n  ) %&gt;% \n  select(participation_rate)\n\nhead(bc_summary_with_prop)\n\n# A tibble: 6 √ó 1\n  participation_rate\n               &lt;dbl&gt;\n1               56.1\n2              NaN  \n3               53.8\n4              NaN  \n5               54.5\n6               55.1\n\n# ....................................................\n# Weighted Summarization (Weighted Average Screening Rate)\n# ....................................................\n\n# Calculate weighted mean screening rate by SA3\nbc_weighted_summary &lt;- breast_cancer_data %&gt;%\n  group_by(sa3name, state, year) %&gt;%\n  summarise(\n    total_participants = sum(part50_74, na.rm = TRUE),\n    total_population = sum(pop50_74, na.rm = TRUE),\n    weighted_screening_rate = round(sum(rate50_74 * pop50_74, na.rm = TRUE) / sum(pop50_74, na.rm = TRUE), 1),\n    .groups = \"drop\"\n  )\n\nhead(bc_weighted_summary)\n\n# A tibble: 6 √ó 6\n  sa3name        state   year total_participants total_population\n  &lt;chr&gt;          &lt;chr&gt;  &lt;int&gt;              &lt;dbl&gt;            &lt;dbl&gt;\n1 Adelaide City  SA    201617               1280             2537\n2 Adelaide City  SA    201718               1314             2608\n3 Adelaide City  SA    201819               1368             2642\n4 Adelaide City  SA    201920               1208             2707\n5 Adelaide Hills SA    201617               7010            11636\n6 Adelaide Hills SA    201718               7096            11876\n# ‚Ñπ 1 more variable: weighted_screening_rate &lt;dbl&gt;\n\n# ....................................................\n# Remove all temporary objects created in this chunk\n# ....................................................\nrm(bc_summary, bc_summary_with_prop, bc_weighted_summary)\n\n\n\n\n\narrange(), desc()\nslice_max(), slice_min(), top_n()\nRanking data and filtering top/bottom groups\n\nSorting and reordering data is important for finding trends, identifying extremes (top or bottom performers), and preparing tables for reporting or visualization.\nIn dplyr, the arrange() function sorts datasets by one or more variables, while desc() allows descending (reverse) order.\nFor selecting specific rows like top N or bottom N values, slice_max() and slice_min() are commonly used.\nThese techniques allow focusing on key records, comparing rankings across groups, and making datasets easier to review.\n\nüîπ Summary of Functions for Sorting and Reordering\n\n\n\n\n\n\n\n\nTask\nFunction\nPurpose\n\n\n\n\nSort ascending order\narrange()\nSort rows by one or more variables (lowest to highest)\n\n\nSort descending order\narrange(desc())\nSort rows highest to lowest\n\n\nSelect top N rows by a variable\nslice_max()\nKeep top N records based on a variable\n\n\nSelect bottom N rows by a variable\nslice_min()\nKeep bottom N records based on a variable\n\n\nSelect top N rows (old method)\ntop_n()\nDeprecated alternative to slice_max() (not recommended now)\n\n\nRank within groups\nmutate(rank = row_number())\nCreate custom ranking inside grouped data\n\n\n\n\n‚û°Ô∏è Sorting and slicing help prioritize key data points and create targeted outputs for decision-making or visualization.\n\n\n# ....................................................\n# Sorting, Reordering, Slicing, and Arranging (Breast Cancer Data)\n# ....................................................\n\n# Sorting by Screening Rate in Ascending Order\nbc_sorted_rate &lt;- breast_cancer_data %&gt;%\n  arrange(rate50_74) %&gt;%\n  select(sa3code, sa3coden, sa3name, state, year,\n         part50_74, pop50_74, rate50_74, agen50_74, expct50_74)\n\nhead(bc_sorted_rate)\n\n  sa3code sa3coden        sa3name state   year part50_74 pop50_74 rate50_74\n1   90104    90104 Norfolk Island Other 201920        24      441   5.40000\n2   90104    90104 Norfolk Island Other 201819        31      422   7.30000\n3   90104    90104 Norfolk Island Other 201718        39      401   9.70000\n4   70205    70205      Katherine    NT 201920       412     2011  20.51335\n5   51002    51002   East Pilbara    WA 201920       562     1987  28.26220\n6   51002    51002   East Pilbara    WA 201819       567     1918  29.55425\n  agen50_74 expct50_74\n1         3        220\n2         3        231\n3         3        219\n4         3       1003\n5         3        991\n6         3       1051\n\n# Sorting by Screening Rate in Descending Order\nbc_sorted_rate_desc &lt;- breast_cancer_data %&gt;%\n  arrange(desc(rate50_74)) %&gt;%\n  select(sa3code, sa3coden, sa3name, state, year,\n         part50_74, pop50_74, rate50_74, agen50_74, expct50_74)\n\nhead(bc_sorted_rate_desc)\n\n  sa3code sa3coden                        sa3name state   year part50_74\n1   90102    90102        Cocos (Keeling) Islands Other 201920        81\n2   31801    31801 Charters Towers - Ayr - Ingham   Qld 201617      4628\n3   60102    60102            Hobart - North East   Tas 201718      5856\n4   60104    60104        Hobart - South and West   Tas 201718      3643\n5   11004    11004            Tamworth - Gunnedah   NSW 201819      8426\n6   31801    31801 Charters Towers - Ayr - Ingham   Qld 201718      4612\n  pop50_74 rate50_74 agen50_74 expct50_74\n1      101  80.20000         3         50\n2     6713  68.90000         3       3692\n3     8566  68.36348         3       4694\n4     5331  68.34190         3       2921\n5    12333  68.32168         3       6758\n6     6759  68.23824         3       3703\n\n# Slicing Top 10 SA3s with Highest Screening Rates\nbc_top_screening &lt;- breast_cancer_data %&gt;%\n  slice_max(order_by = rate50_74, n = 10) %&gt;%\n  select(sa3code, sa3coden, sa3name, state, year,\n         part50_74, pop50_74, rate50_74, agen50_74, expct50_74)\n\nbc_top_screening\n\n   sa3code sa3coden                        sa3name state   year part50_74\n1    90102    90102        Cocos (Keeling) Islands Other 201920        81\n2    31801    31801 Charters Towers - Ayr - Ingham   Qld 201617      4628\n3    60102    60102            Hobart - North East   Tas 201718      5856\n4    60104    60104        Hobart - South and West   Tas 201718      3643\n5    11004    11004            Tamworth - Gunnedah   NSW 201819      8426\n6    31801    31801 Charters Towers - Ayr - Ingham   Qld 201718      4612\n7    11001    11001                       Armidale   NSW 201617      3810\n8    60102    60102            Hobart - North East   Tas 201819      5881\n9    31801    31801 Charters Towers - Ayr - Ingham   Qld 201819      4588\n10   31801    31801 Charters Towers - Ayr - Ingham   Qld 201920      4580\n   pop50_74 rate50_74 agen50_74 expct50_74\n1       101  80.20000         3         50\n2      6713  68.90000         3       3692\n3      8566  68.36348         3       4694\n4      5331  68.34190         3       2921\n5     12333  68.32168         3       6758\n6      6759  68.23824         3       3703\n7      5602  68.00000         3       3081\n8      8698  67.61016         3       4766\n9      6797  67.49974         3       3724\n10     6818  67.17431         3       3402\n\n# Slicing Bottom 5 SA3s with Lowest Screening Rates\nbc_bottom_screening &lt;- breast_cancer_data %&gt;%\n  slice_min(order_by = rate50_74, n = 5) %&gt;%\n  select(sa3code, sa3coden, sa3name, state, year,\n         part50_74, pop50_74, rate50_74, agen50_74, expct50_74)\n\nbc_bottom_screening\n\n  sa3code sa3coden        sa3name state   year part50_74 pop50_74 rate50_74\n1   90104    90104 Norfolk Island Other 201920        24      441   5.40000\n2   90104    90104 Norfolk Island Other 201819        31      422   7.30000\n3   90104    90104 Norfolk Island Other 201718        39      401   9.70000\n4   70205    70205      Katherine    NT 201920       412     2011  20.51335\n5   51002    51002   East Pilbara    WA 201920       562     1987  28.26220\n  agen50_74 expct50_74\n1         3        220\n2         3        231\n3         3        219\n4         3       1003\n5         3        991\n\n# Ranking Within Each State\nbc_ranked &lt;- breast_cancer_data %&gt;%\n  group_by(state) %&gt;%\n  arrange(desc(rate50_74), .by_group = TRUE) %&gt;%\n  mutate(screening_rank = row_number()) %&gt;%\n  select(screening_rank, rate50_74, state) %&gt;% \n  ungroup()\n\nhead(bc_ranked, n = 10)\n\n# A tibble: 10 √ó 3\n   screening_rank rate50_74 state\n            &lt;int&gt;     &lt;dbl&gt; &lt;chr&gt;\n 1              1      59.9 ACT  \n 2              2      58.8 ACT  \n 3              3      58.4 ACT  \n 4              4      58   ACT  \n 5              5      57.7 ACT  \n 6              6      57.4 ACT  \n 7              7      57.2 ACT  \n 8              8      57.1 ACT  \n 9              9      57.0 ACT  \n10             10      56.7 ACT  \n\n# ....................................................\n# Remove all temporary objects created in this chunk\n# ....................................................\nrm(bc_sorted_rate, bc_sorted_rate_desc, bc_top_screening, bc_bottom_screening, bc_ranked)\n\n\n\n\n\npivot_longer(), pivot_wider()\nWide-to-long and long-to-wide transformations\nSeparating and uniting columns with separate() and unite()\n\n\nIn data analysis, datasets often need to be reorganized ‚Äî from wide format to long format, or vice versa ‚Äî to suit different types of analysis or visualization.\nThe goal is to follow Tidy Data principles where: - Each variable forms a column - Each observation forms a row - Each type of observational unit forms a table\ndplyr and tidyr provide key functions for reshaping: - pivot_longer() turns many columns into two columns (variable name and value). - pivot_wider() spreads one column into multiple columns. - separate() splits one column into multiple columns based on a separator. - unite() combines multiple columns into one.\nThese tools help create clean, organized datasets ready for efficient analysis and plotting.\n\nüîπ Summary of Functions for Reshaping and Tidy Data\n\n\n\n\n\n\n\n\nTask\nFunction\nPurpose\n\n\n\n\nReshape wide to long\npivot_longer()\nCollapse multiple columns into key-value pairs\n\n\nReshape long to wide\npivot_wider()\nSpread key-value pairs across multiple columns\n\n\nSplit a column into multiple parts\nseparate()\nSeparate one column into several columns by a delimiter\n\n\nCombine multiple columns into one\nunite()\nMerge several columns into a single column\n\n\n\n\n‚û°Ô∏è These reshaping techniques make it easy to transform datasets into a tidy structure for summaries, modeling, or visualization.\n\n** üîé Regular Expression Tip for names_pattern**\n\n\nIn pivot_longer(), we use a regular expression to split the column names into two components: - part, pop, rate, or expct ‚Üí measure - 50_54, 55_59, etc. ‚Üí age group The pattern ([0-9]{2}_[0-9]{2}) works as follows:\n\n\n\n\n\nComponent\nMeaning\n\n\n\n\n[0-9]\nMatch any digit (0‚Äì9)\n\n\n{2}\nExactly two digits\n\n\n_\nAn underscore\n\n\n[0-9]{2}\nAnother two digits\n\n\n\n‚û°Ô∏è This captures typical age formats like 50_54, 60_64, etc.\n\nOriginal Column Name: rate50_54\nComponents: ‚îå‚îÄ‚îÄ‚îÄ‚îê ‚îå‚îÄ‚îÄ‚îÄ‚îê ‚Ä¶.&gt; ‚îÇrate ‚îÇ ‚îÇ50_54 ‚îÇ &gt; ‚îî‚îÄ‚îò ‚îî‚îÄ‚îÄ‚îò\n\n# ....................................................\n# Reshaping, Separate and Unite Columns: Breast Cancer Data\n# ....................................................\n\n# Pivot longer by extracting measure type and age group separately\nbreast_cancer_long &lt;- breast_cancer_data %&gt;%\n  pivot_longer(\n    cols = starts_with(\"part\") | starts_with(\"pop\") | starts_with(\"rate\") | starts_with(\"expct\"),\n    names_to = c(\"measure\", \"age_group\"),\n    names_pattern = \"(part|pop|rate|expct)([0-9]{2}_[0-9]{2})\",\n    values_to = \"value\"\n  ) %&gt;%\n  relocate(measure, age_group, .before = sa3code)\n\nhead(breast_cancer_long, n = 10)\n\n# A tibble: 10 √ó 15\n   measure age_group sa3code sa3coden sa3name   state   year agen50_74 agen50_69\n   &lt;chr&gt;   &lt;chr&gt;       &lt;int&gt;    &lt;int&gt; &lt;chr&gt;     &lt;chr&gt;  &lt;int&gt;     &lt;int&gt;     &lt;int&gt;\n 1 part    50_74       10102    10102 Queanbey‚Ä¶ NSW   201617         3         2\n 2 part    50_69       10102    10102 Queanbey‚Ä¶ NSW   201617         3         2\n 3 part    50_54       10102    10102 Queanbey‚Ä¶ NSW   201617         3         2\n 4 part    55_59       10102    10102 Queanbey‚Ä¶ NSW   201617         3         2\n 5 part    60_64       10102    10102 Queanbey‚Ä¶ NSW   201617         3         2\n 6 part    65_69       10102    10102 Queanbey‚Ä¶ NSW   201617         3         2\n 7 part    70_74       10102    10102 Queanbey‚Ä¶ NSW   201617         3         2\n 8 pop     50_74       10102    10102 Queanbey‚Ä¶ NSW   201617         3         2\n 9 pop     50_69       10102    10102 Queanbey‚Ä¶ NSW   201617         3         2\n10 pop     50_54       10102    10102 Queanbey‚Ä¶ NSW   201617         3         2\n# ‚Ñπ 6 more variables: agen50_54 &lt;int&gt;, agen55_59 &lt;int&gt;, agen60_64 &lt;int&gt;,\n#   agen65_69 &lt;int&gt;, agen70_74 &lt;int&gt;, value &lt;dbl&gt;\n\n# Pivot wider to spread measures into separate columns\nbreast_cancer_final &lt;- breast_cancer_long %&gt;%\n  pivot_wider(\n    names_from = measure,\n    values_from = value\n  ) %&gt;%\n  relocate(part, pop, rate, expct, .before = sa3code)\n\nhead(breast_cancer_final, n = 5)\n\n# A tibble: 5 √ó 17\n  age_group  part   pop  rate expct sa3code sa3coden sa3name    state   year\n  &lt;chr&gt;     &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;   &lt;int&gt;    &lt;int&gt; &lt;chr&gt;      &lt;chr&gt;  &lt;int&gt;\n1 50_74      4875  8052  60.5  4428   10102    10102 Queanbeyan NSW   201617\n2 50_69      4309  7145  60.3  3929   10102    10102 Queanbeyan NSW   201617\n3 50_54      1284  2251  57    1118   10102    10102 Queanbeyan NSW   201617\n4 55_59      1188  1970  60.3  1046   10102    10102 Queanbeyan NSW   201617\n5 60_64      1012  1625  62.3   950   10102    10102 Queanbeyan NSW   201617\n# ‚Ñπ 7 more variables: agen50_74 &lt;int&gt;, agen50_69 &lt;int&gt;, agen50_54 &lt;int&gt;,\n#   agen55_59 &lt;int&gt;, agen60_64 &lt;int&gt;, agen65_69 &lt;int&gt;, agen70_74 &lt;int&gt;\n\n# Separate 'age_group' into two new columns: start and end age\nbreast_cancer_separated &lt;- breast_cancer_long %&gt;%\n  separate(\n    col = age_group,\n    into = c(\"age_start\", \"age_end\"),\n    sep = \"_\",\n    convert = TRUE\n  ) %&gt;% \n  select(\"age_start\", \"age_end\", everything())\n\nhead(breast_cancer_separated, n = 3)\n\n# A tibble: 3 √ó 16\n  age_start age_end measure sa3code sa3coden sa3name    state   year agen50_74\n      &lt;int&gt;   &lt;int&gt; &lt;chr&gt;     &lt;int&gt;    &lt;int&gt; &lt;chr&gt;      &lt;chr&gt;  &lt;int&gt;     &lt;int&gt;\n1        50      74 part      10102    10102 Queanbeyan NSW   201617         3\n2        50      69 part      10102    10102 Queanbeyan NSW   201617         3\n3        50      54 part      10102    10102 Queanbeyan NSW   201617         3\n# ‚Ñπ 7 more variables: agen50_69 &lt;int&gt;, agen50_54 &lt;int&gt;, agen55_59 &lt;int&gt;,\n#   agen60_64 &lt;int&gt;, agen65_69 &lt;int&gt;, agen70_74 &lt;int&gt;, value &lt;dbl&gt;\n\n# Unite 'age_start' and 'age_end' into a single age group label\nbreast_cancer_united &lt;- breast_cancer_separated %&gt;%\n  unite(\n    col = age_group_combined,\n    age_start, age_end,\n    sep = \"-\",\n    remove = FALSE\n  )\n\nhead(breast_cancer_united, n = 3)\n\n# A tibble: 3 √ó 17\n  age_group_combined age_start age_end measure sa3code sa3coden sa3name    state\n  &lt;chr&gt;                  &lt;int&gt;   &lt;int&gt; &lt;chr&gt;     &lt;int&gt;    &lt;int&gt; &lt;chr&gt;      &lt;chr&gt;\n1 50-74                     50      74 part      10102    10102 Queanbeyan NSW  \n2 50-69                     50      69 part      10102    10102 Queanbeyan NSW  \n3 50-54                     50      54 part      10102    10102 Queanbeyan NSW  \n# ‚Ñπ 9 more variables: year &lt;int&gt;, agen50_74 &lt;int&gt;, agen50_69 &lt;int&gt;,\n#   agen50_54 &lt;int&gt;, agen55_59 &lt;int&gt;, agen60_64 &lt;int&gt;, agen65_69 &lt;int&gt;,\n#   agen70_74 &lt;int&gt;, value &lt;dbl&gt;\n\n# ....................................................\n# Remove temporary objects created in this chunk\n# ....................................................\nrm(breast_cancer_long, breast_cancer_separated, breast_cancer_united, breast_cancer_final)\n\n\n\n\n\n\n\n\n\nlubridate::ymd(), as_date(), format(), %p, weekdays()\nExtracting date components: year, month, quarter\n\nWorking with dates is essential in many datasets, particularly for time-based trends, age calculations, seasonal effects, and survival analysis.\nWe use the lubridate package to parse, extract, and manipulate dates efficiently. The details about time and date data has been presented separately.\n‚û°Ô∏è For full tutorials and videos: - YouTube (AnalyticsHub): Watch Full Video - GitHub: Access Here\nSummary of Functions for Date Handling\n\n\n\n\n\n\n\n\nTask\nFunction\nPurpose\n\n\n\n\nParse ISO dates\nas.Date(), strptime()\nRead and convert raw string timestamps\n\n\nFormat date output\nformat()\nCustomize how dates are displayed\n\n\nExtract components\nyear(), month(), day(), quarter(), week()\nPull year, month, day, quarter, week from dates\n\n\nWeekday labels\nwday(label = TRUE)\nGet day of week in text form\n\n\nDate arithmetic\ndifftime(), -\nCalculate differences between dates\n\n\nLogical operations\n&lt;, &gt;, between()\nFilter by date ranges\n\n\nFiscal/seasonal grouping\ncase_when()\nCategorize based on seasons or financial years\n\n\n\n\nDemonstration using Vaccination Dataset\n\n# Convert DATE into usable R date format\nvaccination &lt;- vaccination %&gt;%\n  mutate(\n    vacc_date = as.Date(strptime(date, format = \"%Y-%m-%dT%H:%M:%SZ\")),\n    vacc_year = year(vacc_date),\n    vacc_month = month(vacc_date, label = TRUE, abbr = FALSE)\n  ) %&gt;% \n  select(-description, base_cost)\n\nhead(vaccination)\n\n                  date                              patient base_cost\n1 2016-04-10T09:04:48Z 30a6452c-4297-a1ac-977a-6a23237c7b46       136\n2 2016-04-10T09:04:48Z 30a6452c-4297-a1ac-977a-6a23237c7b46       136\n3 2016-04-10T09:04:48Z 30a6452c-4297-a1ac-977a-6a23237c7b46       136\n4 2016-04-10T09:04:48Z 30a6452c-4297-a1ac-977a-6a23237c7b46       136\n5 2002-10-29T19:07:21Z 34a4dcc4-35fb-6ad5-ab98-be285c586a4f       136\n6 2005-11-01T19:07:21Z 34a4dcc4-35fb-6ad5-ab98-be285c586a4f       136\n   vacc_date year    month vaccine_group          vacc_group3 vacc_year\n1 2016-04-10 2016    April     Influenza Respiratory vaccines      2016\n2 2016-04-10 2016    April     DTP group   Childhood vaccines      2016\n3 2016-04-10 2016    April     Hepatitis   Childhood vaccines      2016\n4 2016-04-10 2016    April Meningococcal   Childhood vaccines      2016\n5 2002-10-29 2002  October     Influenza Respiratory vaccines      2002\n6 2005-11-01 2005 November     Influenza Respiratory vaccines      2005\n  vacc_month\n1      April\n2      April\n3      April\n4      April\n5    October\n6   November\n\n\nCalculating Time Differences\n\n# Calculating Time Differences\n\n# Convert column names to lowercase\ncolnames(patients) &lt;- tolower(colnames(patients))\ncolnames(vaccination) &lt;- tolower(colnames(vaccination))\n\n# vacc_pt_merged &lt;- left_join(patients, vaccination, by = \"id\" )\nvacc_pt_merged &lt;- left_join(patients, vaccination, by = c(\"id\" = \"patient\"))\n\nstr (vacc_pt_merged)\n\n'data.frame':   1619 obs. of  37 variables:\n $ id                 : chr  \"30a6452c-4297-a1ac-977a-6a23237c7b46\" \"30a6452c-4297-a1ac-977a-6a23237c7b46\" \"30a6452c-4297-a1ac-977a-6a23237c7b46\" \"30a6452c-4297-a1ac-977a-6a23237c7b46\" ...\n $ birthdate          : chr  \"1994-02-06\" \"1994-02-06\" \"1994-02-06\" \"1994-02-06\" ...\n $ deathdate          : chr  \"\" \"\" \"\" \"\" ...\n $ ssn                : chr  \"999-52-8591\" \"999-52-8591\" \"999-52-8591\" \"999-52-8591\" ...\n $ drivers            : chr  \"S99996852\" \"S99996852\" \"S99996852\" \"S99996852\" ...\n $ passport           : chr  \"X47758697X\" \"X47758697X\" \"X47758697X\" \"X47758697X\" ...\n $ prefix             : chr  \"Mr.\" \"Mr.\" \"Mr.\" \"Mr.\" ...\n $ first              : chr  \"Joshua658\" \"Joshua658\" \"Joshua658\" \"Joshua658\" ...\n $ middle             : chr  \"Alvin56\" \"Alvin56\" \"Alvin56\" \"Alvin56\" ...\n $ last               : chr  \"Kunde533\" \"Kunde533\" \"Kunde533\" \"Kunde533\" ...\n $ suffix             : logi  NA NA NA NA NA NA ...\n $ maiden             : chr  \"\" \"\" \"\" \"\" ...\n $ marital            : chr  \"M\" \"M\" \"M\" \"M\" ...\n $ race               : chr  \"white\" \"white\" \"white\" \"white\" ...\n $ ethnicity          : chr  \"nonhispanic\" \"nonhispanic\" \"nonhispanic\" \"nonhispanic\" ...\n $ gender             : chr  \"M\" \"M\" \"M\" \"M\" ...\n $ birthplace         : chr  \"Boston  Massachusetts  US\" \"Boston  Massachusetts  US\" \"Boston  Massachusetts  US\" \"Boston  Massachusetts  US\" ...\n $ address            : chr  \"811 Kihn Viaduct\" \"811 Kihn Viaduct\" \"811 Kihn Viaduct\" \"811 Kihn Viaduct\" ...\n $ city               : chr  \"Braintree\" \"Braintree\" \"Braintree\" \"Braintree\" ...\n $ state              : chr  \"Massachusetts\" \"Massachusetts\" \"Massachusetts\" \"Massachusetts\" ...\n $ county             : chr  \"Norfolk County\" \"Norfolk County\" \"Norfolk County\" \"Norfolk County\" ...\n $ fips               : int  25021 25021 25021 25021 25021 25021 25021 25021 25021 25021 ...\n $ zip                : int  2184 2184 2184 2184 2184 2184 2184 2184 2184 2184 ...\n $ lat                : num  42.2 42.2 42.2 42.2 42.2 ...\n $ lon                : num  -71 -71 -71 -71 -71 ...\n $ healthcare_expenses: num  56905 56905 56905 56905 56905 ...\n $ healthcare_coverage: num  18020 18020 18020 18020 18020 ...\n $ income             : int  100511 100511 100511 100511 100511 100511 49737 49737 49737 49737 ...\n $ date               : chr  \"2016-04-10T09:04:48Z\" \"2016-04-10T09:04:48Z\" \"2016-04-10T09:04:48Z\" \"2016-04-10T09:04:48Z\" ...\n $ base_cost          : num  136 136 136 136 136 136 136 136 136 136 ...\n $ vacc_date          : Date, format: \"2016-04-10\" \"2016-04-10\" ...\n $ year               : chr  \"2016\" \"2016\" \"2016\" \"2016\" ...\n $ month              : chr  \"April\" \"April\" \"April\" \"April\" ...\n $ vaccine_group      : chr  \"Influenza\" \"DTP group\" \"Hepatitis\" \"Meningococcal\" ...\n $ vacc_group3        : chr  \"Respiratory vaccines\" \"Childhood vaccines\" \"Childhood vaccines\" \"Childhood vaccines\" ...\n $ vacc_year          : num  2016 2016 2016 2016 2019 ...\n $ vacc_month         : Ord.factor w/ 12 levels \"January\"&lt;\"February\"&lt;..: 4 4 4 4 4 4 10 11 8 8 ...\n\nvacc_pt_merged %&gt;% \n  mutate(\n    vacc_date = as.Date(strptime(date, format = \"%Y-%m-%dT%H:%M:%SZ\")),\n    birthdate = as.Date(birthdate),\n    days_to_vax = as.numeric(difftime(vacc_date, birthdate, units = \"days\")),\n    weeks_to_vax = as.numeric(difftime(vacc_date, birthdate, units = \"weeks\")),\n    months_to_vax = as.numeric(difftime(vacc_date, birthdate, units = \"days\")) / 30.44,\n    years_to_vax = floor(as.numeric(difftime(vacc_date, birthdate, units = \"days\")) / 365.25)\n  ) -&gt; vacc_pt_merged\n\nsummary(vacc_pt_merged$days_to_vax)\n\n   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. \n      0    2548    7742   10375   18263   36813 \n\nsummary(vacc_pt_merged$years_to_vax)\n\n   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. \n   0.00    6.00   21.00   28.02   50.00  100.00 \n\n\nExtracting Date Components\n\nvacc_pt_merged &lt;- vacc_pt_merged %&gt;%\n  mutate(\n    vacc_day = day(vacc_date),\n    vacc_month_num = month(vacc_date),\n    vacc_month_name = month(vacc_date, label = TRUE, abbr = FALSE),\n    vacc_weekday = wday(vacc_date, label = TRUE, abbr = FALSE),\n    vacc_week = week(vacc_date),\n    vacc_quarter = quarter(vacc_date),\n    vacc_year = year(vacc_date),  # Define vacc_year first\n    vacc_fy = if_else(vacc_month_num &gt;= 7, vacc_year, vacc_year - 1),  # FY starts 1 July in Australia\n    vacc_season = case_when(\n      vacc_month_num %in% 12:2 ~ \"Summer\",\n      vacc_month_num %in% 3:5  ~ \"Autumn\",\n      vacc_month_num %in% 6:8  ~ \"Winter\",\n      vacc_month_num %in% 9:11 ~ \"Spring\"\n    ),\n    is_weekend = wday(vacc_date) %in% c(1, 7),\n    days_since_ref = floor(as.numeric(difftime(vacc_date, as.Date(\"2020-01-01\"), units = \"days\")))\n  )\n\ntemp &lt;- vacc_pt_merged %&gt;%\n  select(vacc_day, vacc_month_num, vacc_month_name, vacc_weekday, vacc_week,\n         vacc_quarter, vacc_year, vacc_fy, vacc_season, is_weekend, days_since_ref)\n\nhead(temp, n = 8)\n\n  vacc_day vacc_month_num vacc_month_name vacc_weekday vacc_week vacc_quarter\n1       10              4           April       Sunday        15            2\n2       10              4           April       Sunday        15            2\n3       10              4           April       Sunday        15            2\n4       10              4           April       Sunday        15            2\n5       14              4           April       Sunday        15            2\n6       17              4           April       Sunday        16            2\n7       29             10         October      Tuesday        44            4\n8        1             11        November      Tuesday        44            4\n  vacc_year vacc_fy vacc_season is_weekend days_since_ref\n1      2016    2015      Summer       TRUE          -1361\n2      2016    2015      Summer       TRUE          -1361\n3      2016    2015      Summer       TRUE          -1361\n4      2016    2015      Summer       TRUE          -1361\n5      2019    2018      Summer       TRUE           -262\n6      2022    2021      Summer       TRUE            837\n7      2002    2002      Summer      FALSE          -6273\n8      2005    2005      Summer      FALSE          -5174\n\nrm (temp)\n\nFiltering Between Date Ranges\n\n# Calculate Age as of 31 December 2024\n# str(vacc_pt_merged$birthdate) \n\nvacc_pt_merged &lt;- vacc_pt_merged %&gt;%\n  mutate(\n    age = floor(time_length(difftime(as.Date(\"2024-12-31\"), birthdate), unit = \"years\"))\n  )\n\ntable (vacc_pt_merged$age)\n\n\n  1   2   5   6   7  10  11  12  13  14  15  16  17  18  19  20  21  23  24  25 \n 46  24  64  66  34 102  38  59  21  21  34  83  18  36  18  34  48  13  12  47 \n 27  28  29  30  33  34  36  37  38  40  41  42  43  44  45  46  47  48  49  50 \n 17  30   9  38   4   7   6   8   6  20  37  16   9  17  15  13   9  21  30  15 \n 51  52  53  55  56  58  60  61  62  63  64  65  68  69  71  73  74  76  78  80 \n 13  30  16  30  30  14  12  27  49  13  26  14  14  57  15  27  15  14  12  13 \n 85  97 110 \n 12  20   1 \n\n# Categorize into Age Groups\nvacc_pt_merged &lt;- vacc_pt_merged %&gt;%\n  mutate(\n    age_group = cut(\n      age,\n      breaks = c(0, 9, 19, 29, 49, 100),\n      labels = c(\"0‚Äì9\", \"10‚Äì19\", \"20‚Äì29\", \"30‚Äì49\", \"50+\"),\n      right = TRUE\n    )\n  )\n\ntable (vacc_pt_merged$age_group)\n\n\n  0‚Äì9 10‚Äì19 20‚Äì29 30‚Äì49   50+ \n  234   430   210   256   488 \n\n# Vaccinations only in 2022\nvacc_2022 &lt;- vacc_pt_merged %&gt;%\n  filter(vacc_date &gt;= ymd(\"2022-01-01\") & vacc_date &lt;= ymd(\"2022-12-31\"))\n\n# Vaccinations between 2015 and 2024\nvacc_1524 &lt;- vacc_pt_merged %&gt;%\n  filter(vacc_year &gt;= 2015 & vacc_year &lt;= 2024)\n\ntable(vacc_1524$vacc_year)\n\n\n2015 2016 2017 2018 2019 2020 2021 2022 2023 2024 \n 153  139  137  151  161  137  263  120  170  122 \n\nrm(vacc_2022)\n\n\n\n\n\nID Creation (if missing): paste(), substr(), as.Date(), unite()\nDetecting Duplicates: duplicated(), distinct(), n_distinct(), row_number(), count(distinct(‚Ä¶))\nTagging Duplicates: row_number(), duplicated(), mutate(dup = row_number())\nValidating Duplicates: group_by() + filter(n() &gt; 1), arrange(), subset()\nRemoving Duplicates: filter(dup == 1), distinct(), summarise()\nOptional Filtering Rules: Keep first/last by date, non-missing only, domain-specific logic\n\nDuplicate records in health or survey data can compromise the integrity of analyses. A critical first step is ensuring each individual has a consistent and unique identifier (ID). When explicit IDs are missing or unreliable, they can be constructed using combinations of variables such as names, dates of birth, and location (e.g., using paste(), substr(), or unite()). Once IDs are established, duplicates can be detected, reviewed, and resolved systematically through tagging (row_number()), visual inspection, and appropriate retention or removal strategies.\n\nüîπ Key Aspects of Duplicate Management\n\n\n\n\n\n\n\n\nAspect\nWhat to Address\nWhy It Matters\n\n\n\n\nDetection Methods\nUse duplicated(), distinct(), n_distinct(), row_number() by ID or keys\nHelps quantify and locate potential duplicates\n\n\nValidation\nVisual/manual review using arrange(), group_by() + filter()\nPrevents removal of legitimate but similar entries\n\n\nTagging Duplicates\nLabel using row_number() or duplicated()\nAllows flexible filtering or analysis of repeats\n\n\nDeciding What to Keep\nKeep first, latest (by date), or non-missing based on rules\nAvoids loss of useful or most complete records\n\n\nRemoval or Aggregation\nDrop with filter(), or use summarise() to collapse duplicates\nDepends on context: reporting vs.¬†recordkeeping\n\n\nID Creation / Fixing\nUse mutate() to create or correct IDs\nEnables future joins and tracking\n\n\n\n\nThe following table shows the summary with some data manipulation options\n\n\n\n\n\n\n\n\nTask\nFunction / Code\nPurpose\n\n\n\n\nIdentify blank IDs or fields\nx[x == \"\"] &lt;- NA\nConvert empty strings to NA for proper detection\n\n\nCount missing values\nsum(is.na(x))\nCheck how many values are missing\n\n\nCount unique observations\ncount(distinct(df, id))\nDetermine the number of unique records\n\n\nGenerate row numbers per group\ngroup_by(id) %&gt;% mutate(dup = row_number())\nLabel duplicates within each ID\n\n\nCheck duplication status\ntable(df$dup) or sum(dup &gt;= 2)\nSummarise duplication pattern\n\n\nSubset for review\nsubset(df, dup == 2)\nView specific duplicates for manual inspection\n\n\nFilter duplicated individuals\nfilter(n() &gt; 1)\nExtract only duplicated IDs\n\n\nRemove duplicates\nfilter(!(dup &gt;= 2))\nKeep only the first instance per group (if needed)\n\n\nClean temporary object\nrm()\nRemove intermediate datasets from environment\n\n\n\nThis setup ensures duplicates are clearly identified, reviewed, and removed where appropriate.\n\npatients &lt;- patients %&gt;%\n  mutate(\n    birthdate = as.Date(birthdate),\n    id_text = paste0(substr(first, 1, 4), \"|\", substr(last, 1, 4), \"|\", birthdate)\n  )\n# Preview new ID\nhead(patients$id_text, n = 3)\n\n[1] \"Josh|Kund|1994-02-06\" \"Benn|Eber|1968-08-06\" \"Hunt|Gerl|2008-12-21\"\n\n# --- Step 2: Create random numeric ID per individual ---\nset.seed(1234)  # for reproducibility\npatients &lt;- patients %&gt;%\n  mutate(id_num = sample(100000:999999, n(), replace = FALSE))\n\n# Preview both ID columns\npatients %&gt;%\n  select(first, last, birthdate, id_text, id_num) %&gt;%\n  head(5)\n\n      first          last  birthdate              id_text id_num\n1 Joshua658      Kunde533 1994-02-06 Josh|Kund|1994-02-06 861679\n2 Bennie663      Ebert178 1968-08-06 Benn|Eber|1968-08-06 730677\n3 Hunter736    Gerlach374 2008-12-21 Hunt|Gerl|2008-12-21 404107\n4 Carlyn477 Williamson769 1994-01-27 Carl|Will|1994-01-27 395845\n5   Robin66  Gleichner915 2019-07-27 Robi|Glei|2019-07-27 226054\n\n# ....................................................\n# Clean-up if needed\n# ....................................................\n# rm(id_text, id_num) # optional if you store externally\n\ntable (patients$race)\n\n\n asian  black native  other  white \n     8      6      1      3     88 \n\notherrace &lt;- patients %&gt;%\n  filter(race != \"white\")\n\npatients &lt;- rbind(patients, otherrace)\n\n# Count total and unique records\nn_total &lt;- nrow(patients)\nn_unique &lt;- n_distinct(patients$id_text)\nmessage(glue::glue(\"Total records: {n_total}, Unique IDs: {n_unique}\"))\n\nTotal records: 124, Unique IDs: 106\n\n# Tag duplicates using row_number()\npatients &lt;- patients %&gt;%\n  arrange(id_text) %&gt;%\n  group_by(id_text) %&gt;%\n  mutate(dup = row_number()) %&gt;%\n  ungroup()\n# Count number of true duplicates\ntable(patients$dup)\n\n\n  1   2 \n106  18 \n\nprint(sum(patients$dup &gt;= 2))\n\n[1] 18\n\n# Keep only records from individuals who have duplicates\nduplicates &lt;- patients %&gt;%\n  group_by(id_text) %&gt;%\n  filter(n() &gt;= 2) %&gt;%\n  select(id_text, id_num, race, marital, gender, birthdate) %&gt;%\n  ungroup()\n\n# Preview records from duplicated individuals\nhead(duplicates)\n\n# A tibble: 6 √ó 6\n  id_text              id_num race  marital gender birthdate \n  &lt;chr&gt;                 &lt;int&gt; &lt;chr&gt; &lt;chr&gt;   &lt;chr&gt;  &lt;date&gt;    \n1 Alen|Gusi|1927-03-20 361202 other M       F      1927-03-20\n2 Alen|Gusi|1927-03-20 361202 other M       F      1927-03-20\n3 Bert|Alem|1983-05-07 513589 black M       F      1983-05-07\n4 Bert|Alem|1983-05-07 513589 black M       F      1983-05-07\n5 Blan|Rein|1951-11-22 465318 asian S       F      1951-11-22\n6 Blan|Rein|1951-11-22 465318 asian S       F      1951-11-22\n\nrm(duplicates, n_total, n_unique)\n\n\n\n\n\nleft_join(), right_join(), inner_join(), full_join()\nsemi_join() and anti_join()\nbind_rows(), rbind() , bind_cols() and cbind()\n\nWhen analyzing real-world datasets, it‚Äôs often necessary to merge or append multiple datasets.\nThis could involve matching rows based on common identifiers, appending additional cases, or combining variables side-by-side.\nWe can join, bind, or filter datasets efficiently using dplyr and base R techniques.\nBrief Descriptions\n\nleft_join(): Keep all records from the left (main) table; bring matching records from the right table.\nright_join(): Keep all records from the right table; bring matching records from the left.\ninner_join(): Keep only rows where keys match in both tables.\nfull_join(): Keep all records from both tables; missing matches filled with NA.\nsemi_join(): Keep rows from the left table where a match exists in the right.\nanti_join(): Keep only rows from the left table that don‚Äôt match the right.\n\n‚û°Ô∏è bind_rows() and rbind() are used for stacking datasets.\n‚û°Ô∏è bind_cols() and cbind() are used for attaching new columns horizontally.\nSummary Table: Key Functions for Joining and Appending\n\n\n\n\n\n\n\n\nTask\nFunction\nPurpose\n\n\n\n\nMerge by common key\nleft_join(), right_join(), inner_join(), full_join()\nMerge datasets using common variables\n\n\nFilter matching rows\nsemi_join()\nKeep rows from left table that have matches in right table\n\n\nFilter non-matching rows\nanti_join()\nKeep rows from left table with no match in right table\n\n\nRow-wise append\nbind_rows()\nStack two datasets vertically (must have same columns)\n\n\nColumn-wise append\nbind_cols()\nAdd columns side-by-side (matching by row position)\n\n\nBasic base R row bind\nrbind()\nAppend rows (base R equivalent to bind_rows)\n\n\nBasic base R column bind\ncbind()\nAppend columns (base R equivalent to bind_cols)\n\n\nJoin a table to itself\nSelf-join\nAnalyze relationships within a single dataset (e.g., hierarchy)\n\n\n\n\nImportant Reminders - Joins (left_join, etc.) match based on a key (column/s). - bind_rows() assumes same column names and types. - bind_cols() assumes same number of rows. - rbind() and cbind() are base R methods but dplyr::bind_*() are more flexible. ‚Äî\nDemonstrating Different Types of Joins with Brief Descriptions\nStandardizing variable Names\nBefore performing joins, it is essential to ensure column names match in both datasets.\nThis avoids errors caused by case differences or inconsistent naming.\n\n# ......................................\n# Full Join: Keep everything from both datasets\n# ......................................\nvacc_full_join &lt;- full_join(\n  patients,\n  vaccination,\n  by = c(\"id\" = \"patient\")\n)\n\nhead(vacc_full_join, n = 3)\n\n                                    id  birthdate deathdate         ssn\n1 30a6452c-4297-a1ac-977a-6a23237c7b46 1994-02-06           999-52-8591\n2 30a6452c-4297-a1ac-977a-6a23237c7b46 1994-02-06           999-52-8591\n3 30a6452c-4297-a1ac-977a-6a23237c7b46 1994-02-06           999-52-8591\n    drivers   passport prefix     first  middle     last suffix maiden marital\n1 S99996852 X47758697X    Mr. Joshua658 Alvin56 Kunde533     NA              M\n2 S99996852 X47758697X    Mr. Joshua658 Alvin56 Kunde533     NA              M\n3 S99996852 X47758697X    Mr. Joshua658 Alvin56 Kunde533     NA              M\n   race   ethnicity gender                birthplace          address      city\n1 white nonhispanic      M Boston  Massachusetts  US 811 Kihn Viaduct Braintree\n2 white nonhispanic      M Boston  Massachusetts  US 811 Kihn Viaduct Braintree\n3 white nonhispanic      M Boston  Massachusetts  US 811 Kihn Viaduct Braintree\n          state         county  fips  zip      lat      lon healthcare_expenses\n1 Massachusetts Norfolk County 25021 2184 42.21114 -71.0458            56904.96\n2 Massachusetts Norfolk County 25021 2184 42.21114 -71.0458            56904.96\n3 Massachusetts Norfolk County 25021 2184 42.21114 -71.0458            56904.96\n  healthcare_coverage income                 date\n1            18019.99 100511 2016-04-10T09:04:48Z\n2            18019.99 100511 2016-04-10T09:04:48Z\n3            18019.99 100511 2016-04-10T09:04:48Z\n                             encounter code\n1 0b03e41b-06a6-66fa-b972-acc5a83b134a  140\n2 0b03e41b-06a6-66fa-b972-acc5a83b134a  113\n3 0b03e41b-06a6-66fa-b972-acc5a83b134a   43\n                                                   description base_cost\n1           Influenza  seasonal  injectable  preservative free       136\n2 Td (adult)  5 Lf tetanus toxoid  preservative free  adsorbed       136\n3                                                 Hep B  adult       136\n\n# ......................................\n# Left Join: Keep all patients, add vaccination if available\n# ......................................\nvacc_left_join &lt;- left_join(\n  patients,\n  vaccination,\n  by = c(\"id\" = \"patient\")\n)\n\nhead(vacc_left_join, n = 3)\n\n                                    id  birthdate deathdate         ssn\n1 30a6452c-4297-a1ac-977a-6a23237c7b46 1994-02-06           999-52-8591\n2 30a6452c-4297-a1ac-977a-6a23237c7b46 1994-02-06           999-52-8591\n3 30a6452c-4297-a1ac-977a-6a23237c7b46 1994-02-06           999-52-8591\n    drivers   passport prefix     first  middle     last suffix maiden marital\n1 S99996852 X47758697X    Mr. Joshua658 Alvin56 Kunde533     NA              M\n2 S99996852 X47758697X    Mr. Joshua658 Alvin56 Kunde533     NA              M\n3 S99996852 X47758697X    Mr. Joshua658 Alvin56 Kunde533     NA              M\n   race   ethnicity gender                birthplace          address      city\n1 white nonhispanic      M Boston  Massachusetts  US 811 Kihn Viaduct Braintree\n2 white nonhispanic      M Boston  Massachusetts  US 811 Kihn Viaduct Braintree\n3 white nonhispanic      M Boston  Massachusetts  US 811 Kihn Viaduct Braintree\n          state         county  fips  zip      lat      lon healthcare_expenses\n1 Massachusetts Norfolk County 25021 2184 42.21114 -71.0458            56904.96\n2 Massachusetts Norfolk County 25021 2184 42.21114 -71.0458            56904.96\n3 Massachusetts Norfolk County 25021 2184 42.21114 -71.0458            56904.96\n  healthcare_coverage income                 date\n1            18019.99 100511 2016-04-10T09:04:48Z\n2            18019.99 100511 2016-04-10T09:04:48Z\n3            18019.99 100511 2016-04-10T09:04:48Z\n                             encounter code\n1 0b03e41b-06a6-66fa-b972-acc5a83b134a  140\n2 0b03e41b-06a6-66fa-b972-acc5a83b134a  113\n3 0b03e41b-06a6-66fa-b972-acc5a83b134a   43\n                                                   description base_cost\n1           Influenza  seasonal  injectable  preservative free       136\n2 Td (adult)  5 Lf tetanus toxoid  preservative free  adsorbed       136\n3                                                 Hep B  adult       136\n\n# ......................................\n# Right Join: Keep all vaccinations, add patients if available\n# ......................................\nvacc_right_join &lt;- right_join(\n  patients,\n  vaccination,\n  by = c(\"id\" = \"patient\")\n)\n\nhead(vacc_right_join, n = 3)\n\n                                    id  birthdate deathdate         ssn\n1 30a6452c-4297-a1ac-977a-6a23237c7b46 1994-02-06           999-52-8591\n2 30a6452c-4297-a1ac-977a-6a23237c7b46 1994-02-06           999-52-8591\n3 30a6452c-4297-a1ac-977a-6a23237c7b46 1994-02-06           999-52-8591\n    drivers   passport prefix     first  middle     last suffix maiden marital\n1 S99996852 X47758697X    Mr. Joshua658 Alvin56 Kunde533     NA              M\n2 S99996852 X47758697X    Mr. Joshua658 Alvin56 Kunde533     NA              M\n3 S99996852 X47758697X    Mr. Joshua658 Alvin56 Kunde533     NA              M\n   race   ethnicity gender                birthplace          address      city\n1 white nonhispanic      M Boston  Massachusetts  US 811 Kihn Viaduct Braintree\n2 white nonhispanic      M Boston  Massachusetts  US 811 Kihn Viaduct Braintree\n3 white nonhispanic      M Boston  Massachusetts  US 811 Kihn Viaduct Braintree\n          state         county  fips  zip      lat      lon healthcare_expenses\n1 Massachusetts Norfolk County 25021 2184 42.21114 -71.0458            56904.96\n2 Massachusetts Norfolk County 25021 2184 42.21114 -71.0458            56904.96\n3 Massachusetts Norfolk County 25021 2184 42.21114 -71.0458            56904.96\n  healthcare_coverage income                 date\n1            18019.99 100511 2016-04-10T09:04:48Z\n2            18019.99 100511 2016-04-10T09:04:48Z\n3            18019.99 100511 2016-04-10T09:04:48Z\n                             encounter code\n1 0b03e41b-06a6-66fa-b972-acc5a83b134a  140\n2 0b03e41b-06a6-66fa-b972-acc5a83b134a  113\n3 0b03e41b-06a6-66fa-b972-acc5a83b134a   43\n                                                   description base_cost\n1           Influenza  seasonal  injectable  preservative free       136\n2 Td (adult)  5 Lf tetanus toxoid  preservative free  adsorbed       136\n3                                                 Hep B  adult       136\n\n# ......................................\n# Inner Join: Keep only matched patients and vaccinations\n# ......................................\nvacc_inner_join &lt;- inner_join(\n  patients,\n  vaccination,\n  by = c(\"id\" = \"patient\"))\n\nhead(vacc_inner_join, n = 3)\n\n                                    id  birthdate deathdate         ssn\n1 30a6452c-4297-a1ac-977a-6a23237c7b46 1994-02-06           999-52-8591\n2 30a6452c-4297-a1ac-977a-6a23237c7b46 1994-02-06           999-52-8591\n3 30a6452c-4297-a1ac-977a-6a23237c7b46 1994-02-06           999-52-8591\n    drivers   passport prefix     first  middle     last suffix maiden marital\n1 S99996852 X47758697X    Mr. Joshua658 Alvin56 Kunde533     NA              M\n2 S99996852 X47758697X    Mr. Joshua658 Alvin56 Kunde533     NA              M\n3 S99996852 X47758697X    Mr. Joshua658 Alvin56 Kunde533     NA              M\n   race   ethnicity gender                birthplace          address      city\n1 white nonhispanic      M Boston  Massachusetts  US 811 Kihn Viaduct Braintree\n2 white nonhispanic      M Boston  Massachusetts  US 811 Kihn Viaduct Braintree\n3 white nonhispanic      M Boston  Massachusetts  US 811 Kihn Viaduct Braintree\n          state         county  fips  zip      lat      lon healthcare_expenses\n1 Massachusetts Norfolk County 25021 2184 42.21114 -71.0458            56904.96\n2 Massachusetts Norfolk County 25021 2184 42.21114 -71.0458            56904.96\n3 Massachusetts Norfolk County 25021 2184 42.21114 -71.0458            56904.96\n  healthcare_coverage income                 date\n1            18019.99 100511 2016-04-10T09:04:48Z\n2            18019.99 100511 2016-04-10T09:04:48Z\n3            18019.99 100511 2016-04-10T09:04:48Z\n                             encounter code\n1 0b03e41b-06a6-66fa-b972-acc5a83b134a  140\n2 0b03e41b-06a6-66fa-b972-acc5a83b134a  113\n3 0b03e41b-06a6-66fa-b972-acc5a83b134a   43\n                                                   description base_cost\n1           Influenza  seasonal  injectable  preservative free       136\n2 Td (adult)  5 Lf tetanus toxoid  preservative free  adsorbed       136\n3                                                 Hep B  adult       136\n\n# ......................................\n# Semi Join: Keep only patients that have a vaccination match\n# (Only patient columns are kept)\n# ......................................\n\nvacc_semi_join &lt;- semi_join(\n  patients,\n  vaccination,\n  by = c(\"id\" = \"patient\"))\n\nhead(vacc_semi_join, n = 3)\n\n                                    id  birthdate  deathdate         ssn\n1 30a6452c-4297-a1ac-977a-6a23237c7b46 1994-02-06            999-52-8591\n2 34a4dcc4-35fb-6ad5-ab98-be285c586a4f 1968-08-06 2009-12-11 999-75-3953\n3 7179458e-d6e3-c723-2530-d4acfe1c2668 2008-12-21            999-70-1925\n    drivers   passport prefix     first      middle       last suffix maiden\n1 S99996852 X47758697X    Mr. Joshua658     Alvin56   Kunde533     NA       \n2 S99993577 X28173268X    Mr. Bennie663               Ebert178     NA       \n3                             Hunter736 Mckinley734 Gerlach374     NA       \n  marital  race   ethnicity gender                  birthplace\n1       M white nonhispanic      M   Boston  Massachusetts  US\n2       D white nonhispanic      M Chicopee  Massachusetts  US\n3         white nonhispanic      M  Spencer  Massachusetts  US\n                      address         city         state          county  fips\n1            811 Kihn Viaduct    Braintree Massachusetts  Norfolk County 25021\n2 975 Pfannerstill Throughway    Braintree Massachusetts  Norfolk County 25021\n3             548 Heller Lane Mattapoisett Massachusetts Plymouth County    NA\n   zip      lat       lon healthcare_expenses healthcare_coverage income\n1 2184 42.21114 -71.04580            56904.96            18019.99 100511\n2 2184 42.25542 -70.97102           124024.12             1075.06  49737\n3    0 41.64829 -70.85062            45645.06             6154.94 133816\n\n# ......................................\n# Anti Join: Keep only patients that do not have a vaccination match\n# ......................................\nvacc_anti_join &lt;- anti_join(\n  patients,\n  vaccination,\n  by = c(\"id\" = \"patient\"))\n\nhead(vacc_anti_join, n = 3)\n\n [1] id                  birthdate           deathdate          \n [4] ssn                 drivers             passport           \n [7] prefix              first               middle             \n[10] last                suffix              maiden             \n[13] marital             race                ethnicity          \n[16] gender              birthplace          address            \n[19] city                state               county             \n[22] fips                zip                 lat                \n[25] lon                 healthcare_expenses healthcare_coverage\n[28] income             \n&lt;0 rows&gt; (or 0-length row.names)\n\n# ......................................\n# Remove temporary datasets\n# ......................................\nrm(vacc_left_join, vacc_right_join, vacc_inner_join, vacc_full_join, vacc_semi_join, vacc_anti_join)\n\nAppending (Binding) DataFrames: Rows and Columns\n\n# Binding Rows Together (bind_rows): Combine NSW, WA, and Others into one dataset\n\nbc_combined_rows &lt;- bind_rows(\n  breast_cancer_NSW,\n  breast_cancer_WA,\n  breast_cancer_others\n)\n\n# Check result\nhead(bc_combined_rows, n = 3)\n\n  sa3code sa3coden    sa3name state   year part50_74 pop50_74 rate50_74\n1   10102    10102 Queanbeyan   NSW 201617      4875     8052  60.50000\n2   10102    10102 Queanbeyan   NSW 201718      5048     8309  60.75961\n3   10102    10102 Queanbeyan   NSW 201819      5276     8588  61.43839\n  agen50_74 expct50_74 part50_69 pop50_69 rate50_69 agen50_69 expct50_69\n1         3       4428      4309     7145  60.30000         2       3929\n2         3       4553      4448     7338  60.62238         2       4013\n3         3       4706      4629     7548  61.33203         2       4113\n  part50_54 pop50_54 rate50_54 agen50_54 expct50_54 part55_59 pop55_59\n1      1284     2251  57.00000         1       1118      1188     1970\n2      1285     2306  55.72035         1       1143      1260     2030\n3      1375     2342  58.70977         1       1166      1252     2093\n  rate55_59 agen55_59 expct55_59 part60_64 pop60_64 rate60_64 agen60_64\n1  60.30000         4       1046      1012     1625  62.30000         5\n2  62.09035         4       1069      1048     1646  63.69947         5\n3  59.81504         4       1098      1105     1689  65.43657         5\n  expct60_64 part65_69 pop65_69 rate65_69 agen65_69 expct65_69 part70_74\n1        950       826     1300  63.50000         6        781       566\n2        953       855     1357  63.02558         6        812       600\n3        967       898     1426  63.00429         6        849       647\n  pop70_74 rate70_74 agen70_74 expct70_74\n1      907  62.40000         7        498\n2      971  61.79725         7        541\n3     1040  62.21032         7        585\n\n# Confirm number of rows\nnrow(bc_combined_rows)\n\n[1] 1364\n\n# Binding Columns Together (bind_cols): Combine Participation Data with SA3 metadata\n# (needs same number of rows)\n\nbc_combined_cols &lt;- bind_cols(\n  participation,\n  breast_cancer_SA3_info )\n# Check result\nhead(bc_combined_cols, n = 3)\n\n    year part50_74 pop50_74 rate50_74 agen50_74 expct50_74 part50_69 pop50_69\n1 201617      4875     8052  60.50000         3       4428      4309     7145\n2 201718      5048     8309  60.75961         3       4553      4448     7338\n3 201819      5276     8588  61.43839         3       4706      4629     7548\n  rate50_69 agen50_69 expct50_69 part50_54 pop50_54 rate50_54 agen50_54\n1  60.30000         2       3929      1284     2251  57.00000         1\n2  60.62238         2       4013      1285     2306  55.72035         1\n3  61.33203         2       4113      1375     2342  58.70977         1\n  expct50_54 part55_59 pop55_59 rate55_59 agen55_59 expct55_59 part60_64\n1       1118      1188     1970  60.30000         4       1046      1012\n2       1143      1260     2030  62.09035         4       1069      1048\n3       1166      1252     2093  59.81504         4       1098      1105\n  pop60_64 rate60_64 agen60_64 expct60_64 part65_69 pop65_69 rate65_69\n1     1625  62.30000         5        950       826     1300  63.50000\n2     1646  63.69947         5        953       855     1357  63.02558\n3     1689  65.43657         5        967       898     1426  63.00429\n  agen65_69 expct65_69 part70_74 pop70_74 rate70_74 agen70_74 expct70_74\n1         6        781       566      907  62.40000         7        498\n2         6        812       600      971  61.79725         7        541\n3         6        849       647     1040  62.21032         7        585\n  sa3code sa3coden    sa3name state\n1   10102    10102 Queanbeyan   NSW\n2   10102    10102 Queanbeyan   NSW\n3   10102    10102 Queanbeyan   NSW\n\n# Appending Rows Using Base R rbind()\n# (Equivalent to bind_rows but simpler cases, needs identical columns)\nbc_combined_rbind &lt;- rbind(\n  breast_cancer_NSW,\n  breast_cancer_WA\n)\n\n# Check result\nhead(bc_combined_rbind, n = 3)\n\n  sa3code sa3coden    sa3name state   year part50_74 pop50_74 rate50_74\n1   10102    10102 Queanbeyan   NSW 201617      4875     8052  60.50000\n2   10102    10102 Queanbeyan   NSW 201718      5048     8309  60.75961\n3   10102    10102 Queanbeyan   NSW 201819      5276     8588  61.43839\n  agen50_74 expct50_74 part50_69 pop50_69 rate50_69 agen50_69 expct50_69\n1         3       4428      4309     7145  60.30000         2       3929\n2         3       4553      4448     7338  60.62238         2       4013\n3         3       4706      4629     7548  61.33203         2       4113\n  part50_54 pop50_54 rate50_54 agen50_54 expct50_54 part55_59 pop55_59\n1      1284     2251  57.00000         1       1118      1188     1970\n2      1285     2306  55.72035         1       1143      1260     2030\n3      1375     2342  58.70977         1       1166      1252     2093\n  rate55_59 agen55_59 expct55_59 part60_64 pop60_64 rate60_64 agen60_64\n1  60.30000         4       1046      1012     1625  62.30000         5\n2  62.09035         4       1069      1048     1646  63.69947         5\n3  59.81504         4       1098      1105     1689  65.43657         5\n  expct60_64 part65_69 pop65_69 rate65_69 agen65_69 expct65_69 part70_74\n1        950       826     1300  63.50000         6        781       566\n2        953       855     1357  63.02558         6        812       600\n3        967       898     1426  63.00429         6        849       647\n  pop70_74 rate70_74 agen70_74 expct70_74\n1      907  62.40000         7        498\n2      971  61.79725         7        541\n3     1040  62.21032         7        585\n\n# Appending Columns Using Base R cbind()\n# (Simple column binding, assumes same number of rows)\n\nbc_combined_cbind &lt;- cbind(\n  participation,\n  breast_cancer_SA3_info)\n\n# Check result\nhead(bc_combined_cbind, n = 3)\n\n    year part50_74 pop50_74 rate50_74 agen50_74 expct50_74 part50_69 pop50_69\n1 201617      4875     8052  60.50000         3       4428      4309     7145\n2 201718      5048     8309  60.75961         3       4553      4448     7338\n3 201819      5276     8588  61.43839         3       4706      4629     7548\n  rate50_69 agen50_69 expct50_69 part50_54 pop50_54 rate50_54 agen50_54\n1  60.30000         2       3929      1284     2251  57.00000         1\n2  60.62238         2       4013      1285     2306  55.72035         1\n3  61.33203         2       4113      1375     2342  58.70977         1\n  expct50_54 part55_59 pop55_59 rate55_59 agen55_59 expct55_59 part60_64\n1       1118      1188     1970  60.30000         4       1046      1012\n2       1143      1260     2030  62.09035         4       1069      1048\n3       1166      1252     2093  59.81504         4       1098      1105\n  pop60_64 rate60_64 agen60_64 expct60_64 part65_69 pop65_69 rate65_69\n1     1625  62.30000         5        950       826     1300  63.50000\n2     1646  63.69947         5        953       855     1357  63.02558\n3     1689  65.43657         5        967       898     1426  63.00429\n  agen65_69 expct65_69 part70_74 pop70_74 rate70_74 agen70_74 expct70_74\n1         6        781       566      907  62.40000         7        498\n2         6        812       600      971  61.79725         7        541\n3         6        849       647     1040  62.21032         7        585\n  sa3code sa3coden    sa3name state\n1   10102    10102 Queanbeyan   NSW\n2   10102    10102 Queanbeyan   NSW\n3   10102    10102 Queanbeyan   NSW\n\n# Important Notes:\n# - bind_rows() can handle different column orders safely\n# - rbind() requires identical column names and order\n# - bind_cols() simply pastes side-by-side, no matching by keys\n# - cbind() assumes same number of rows\n\n# ....................................................\n# Remove all temporary objects created in this chunk\n# ....................................................\nrm(\n  breast_cancer_NSW, breast_cancer_WA, breast_cancer_others, participation, breast_cancer_SA3_info,\n  bc_combined_rows, bc_combined_cols, bc_combined_rbind, bc_combined_cbind\n)\n\n\n\n\nA. Identifying Missing Values\n\nis.na(), anyNA(), sum(is.na(x)), colSums() ‚Äì detect/count missing values\ncomplete.cases() ‚Äì filter complete rows\nConvert blanks to NA: x[x == ‚Äú‚Äú] &lt;- NA\n\nB. Handling Missing Values\n\nBasic Removal/Replacement: na.omit(), replace_na() (tidyr), ifelse()\nForward/Backward Fill: fill() (tidyr) with .direction = ‚Äúdown‚Äù / ‚Äúup‚Äù\nStatistical Imputation:\n\n-Simple: mean/median imputation\n-Multiple: mice::mice()()\n-Advanced: Hmisc::aregImpute, missForest, Amelia, zoo::na.fill\nMissing data is a common issue in real-world datasets. In R, handling missing values properly is essential to ensure the integrity of analyses and avoid misleading results.\nThis section covers how to identify, clean, and impute missing values using base R and tidyverse tools. Techniques range from basic filtering to advanced imputation models.\n‚û°Ô∏è Missing values are typically represented as NA in R. Empty strings (e.g., \"\") or special codes (e.g., -99, \"missing\") may also indicate missingness and need conversion before analysis.\nüîπ Summary of Functions for Handling Missing Values\n\n\n\n\n\n\n\n\nTask\nFunction / Code\nPurpose\n\n\n\n\nDetect missing values\nis.na(x), anyNA(x), sum(is.na(x))\nIdentify/count missing values\n\n\nMissing per column\ncolSums(is.na(df))\nCount NAs per column\n\n\nFilter complete rows\ncomplete.cases(df)\nKeep only rows without any missing values\n\n\nConvert blanks to NA\nx[x == \"\"] &lt;- NA\nConvert empty strings to missing values\n\n\nRemove missing rows\nna.omit(df)\nRemove rows with any missing value\n\n\nReplace missing values\nreplace_na(df, list(...)), ifelse(is.na(x), ...)\nImpute or replace NA with custom logic\n\n\nForward/backward fill\nfill(df, .direction = \"down\" / \"up\")\nFill NA using nearby values\n\n\nMean/median imputation\nx[is.na(x)] &lt;- mean(x, na.rm = TRUE)\nReplace NA with summary statistic\n\n\nMultiple imputation\nmice::mice(df)\nCreate multiple imputed datasets using chained equations\n\n\nAdvanced imputation\nHmisc::aregImpute, missForest, Amelia, zoo::na.fill()\nSpecialized techniques for complex imputations\n\n\n\nüìö Further Learning and Resources\nAdditional tutorials, demonstrations, and datasets are available on:\n\nYouTube Channel ‚Äì AnalyticsHub\nhttps://studio.youtube.com/channel/UCLVKP0g8GvHhOh0kn20T8eg/videos/upload?filter=%5B%5D&sort=%7B%22columnType%22%3A%22date%22%2C%22sortOrder%22%3A%22DESCENDING%22%7D\nGitHub Repository\nhttps://github.com/HabtamuBizuayehu?tab=repositories\n\n\n\n\n                                    id  birthdate deathdate         ssn\n1 898a6256-7ffb-dbe2-e24d-12fda2fedcfd 1966-06-23           999-98-5513\n2 5e0a6984-38d7-c604-f55f-f1de5e933768 1986-07-04           999-58-5560\n3 e335de09-0994-4111-3c15-6edcc17ae4bc 2005-04-25           999-48-3846\n4 45b89342-dc05-8e57-8eee-9ed68ec42378 1984-08-24           999-40-3433\n5 916b1ac8-56c8-ec1b-3b9a-721336a74912 1953-05-10           999-16-3735\n6 dc323bce-e583-d903-303e-9c865bc87e67 2012-09-02           999-90-3605\n    drivers   passport prefix     first     middle          last suffix\n1 S99971131 X62454905X   Mrs.  Maris768              Lindgren255     NA\n2 S99931679 X61479569X   Mrs. Hattie299  Reatha769      Nader710     NA\n3 S99958413               Ms.  Jimmie93 Towanda270      Doyle959     NA\n4 S99985178 X27670495X    Mr. Dwight645  Marlin805      Hilll811     NA\n5 S99968840 X83646024X    Ms.  Tambra47 Brittni468 Balistreri607     NA\n6                             Carson894 Raphael767     Littel644     NA\n     maiden marital  race   ethnicity gender                       birthplace\n1   Dach178       D white nonhispanic      F        Oxford  Massachusetts  US\n2 Harber290       M white nonhispanic      F North Reading  Massachusetts  US\n3                   white nonhispanic      F        Boston  Massachusetts  US\n4                 M white nonhispanic      M    Framingham  Massachusetts  US\n5                 S white nonhispanic      F     Lexington  Massachusetts  US\n6                   white nonhispanic      M      Plymouth  Massachusetts  US\n                        address        city         state           county\n1          962 Stiedemann Vista    Aquinnah Massachusetts     Dukes County\n2            720 O'Keefe Arcade      Newton Massachusetts Middlesex County\n3       493 Cruickshank Mission   Holliston Massachusetts Middlesex County\n4              810 Wolf Pathway      Malden Massachusetts Middlesex County\n5      146 Rowe Village Suite 3 New Bedford Massachusetts   Bristol County\n6 467 Collier Stravenue Unit 12   Attleboro Massachusetts   Bristol County\n   fips  zip      lat       lon healthcare_expenses healthcare_coverage income\n1    NA    0 41.29618 -70.77458           343608.18           884243.46 178323\n2 25017 2468 42.29180 -71.14930           169293.06           801407.90  86384\n3    NA    0 42.24196 -71.46440            64178.99             5906.14 198522\n4 25017 2148 42.43610 -71.14328            36010.63           472861.90  25909\n5 25005 2743 41.69576 -71.01391           281198.90           310261.21 140772\n6 44007 2861 41.94870 -71.30420            45972.75                0.00  71169\n  visit\n1     1\n2     1\n3     1\n4     1\n5     1\n6     1\n\n\n\n# Summarise missing values across all columns\nmissing_summary &lt;- colSums(is.na(visits_all))\nprint(missing_summary[missing_summary &gt; 0])\n\n          deathdate             drivers            passport              prefix \n                 40                   4                  12                   8 \n             middle              suffix              maiden             marital \n                  4                  40                  28                  16 \n               race                fips                 zip healthcare_coverage \n                 20                  12                  12                   4 \n             income \n                 20 \n\n# Total number of missing cells\ntotal_missing &lt;- sum(is.na(visits_all))\ncat(\"Total missing values in dataset:\", total_missing, \"\\n\")\n\nTotal missing values in dataset: 220 \n\n# Count of individuals with at least one missing value\nn_missing_individuals &lt;- sum(!complete.cases(visits_all))\ncat(\"Number of individuals with at least one missing value:\", n_missing_individuals, \"\\n\")\n\nNumber of individuals with at least one missing value: 40 \n\n# Sort records by patient ID and visit number\nvisits_all &lt;- visits_all %&gt;%\n  arrange(id_text, visit)\n\n# View rows with any missing values\nmissing_rows &lt;- visits_all %&gt;%\n  filter(!complete.cases(.))\nhead(missing_rows, n = 12) %&gt;% select(id_text, race, income, passport)\n\n                id_text  race income   passport\n1  Anit|S√°nc|1960-05-07 white  61016  X9157439X\n2  Anit|S√°nc|1960-05-07  &lt;NA&gt;     NA  X9157439X\n3  Anit|S√°nc|1960-05-07 white     NA  X9157439X\n4  Anit|S√°nc|1960-05-07  &lt;NA&gt;  60016  X9157439X\n5  Aure|Weis|2003-11-12 white   8752 X17586296X\n6  Aure|Weis|2003-11-12  &lt;NA&gt;     NA X17586296X\n7  Aure|Weis|2003-11-12 white     NA X17586296X\n8  Aure|Weis|2003-11-12  &lt;NA&gt;   7752 X17586296X\n9  Cars|Litt|2012-09-02 white  71169       &lt;NA&gt;\n10 Cars|Litt|2012-09-02  &lt;NA&gt;     NA       &lt;NA&gt;\n11 Cars|Litt|2012-09-02  &lt;NA&gt;  70169       &lt;NA&gt;\n12 Cars|Litt|2012-09-02 white     NA       &lt;NA&gt;\n\n# Impute passport with \"UNKNOWN\"\ndf_passport &lt;- visits_all %&gt;%\n  mutate(passport_imputed = replace_na(passport, \"UNKNOWN\")) %&gt;%\n  filter(is.na(passport)) %&gt;%\n  select(id, id_text, visit, passport, passport_imputed)\n\nhead(df_passport, n = 12)\n\n                                     id              id_text visit passport\n1  dc323bce-e583-d903-303e-9c865bc87e67 Cars|Litt|2012-09-02     1     &lt;NA&gt;\n2  dc323bce-e583-d903-303e-9c865bc87e67 Cars|Litt|2012-09-02     2     &lt;NA&gt;\n3  dc323bce-e583-d903-303e-9c865bc87e67 Cars|Litt|2012-09-02     3     &lt;NA&gt;\n4  dc323bce-e583-d903-303e-9c865bc87e67 Cars|Litt|2012-09-02     4     &lt;NA&gt;\n5  da7b1f55-c782-544f-ba8c-fe69d519dc85 Doll|Fran|2008-10-04     1     &lt;NA&gt;\n6  da7b1f55-c782-544f-ba8c-fe69d519dc85 Doll|Fran|2008-10-04     2     &lt;NA&gt;\n7  da7b1f55-c782-544f-ba8c-fe69d519dc85 Doll|Fran|2008-10-04     3     &lt;NA&gt;\n8  da7b1f55-c782-544f-ba8c-fe69d519dc85 Doll|Fran|2008-10-04     4     &lt;NA&gt;\n9  e335de09-0994-4111-3c15-6edcc17ae4bc Jimm|Doyl|2005-04-25     1     &lt;NA&gt;\n10 e335de09-0994-4111-3c15-6edcc17ae4bc Jimm|Doyl|2005-04-25     2     &lt;NA&gt;\n11 e335de09-0994-4111-3c15-6edcc17ae4bc Jimm|Doyl|2005-04-25     3     &lt;NA&gt;\n12 e335de09-0994-4111-3c15-6edcc17ae4bc Jimm|Doyl|2005-04-25     4     &lt;NA&gt;\n   passport_imputed\n1           UNKNOWN\n2           UNKNOWN\n3           UNKNOWN\n4           UNKNOWN\n5           UNKNOWN\n6           UNKNOWN\n7           UNKNOWN\n8           UNKNOWN\n9           UNKNOWN\n10          UNKNOWN\n11          UNKNOWN\n12          UNKNOWN\n\n# Sort records by patient ID and visit number (to prepare for forward/backward fill)\nvisits_all &lt;- visits_all %&gt;%\n  arrange(id_text, visit)\n\n# Preview sorted data (tail)\ntail(visits_all %&gt;% select(id_text, visit, race, income), n = 12)\n\n                id_text visit  race income\n29 Jimm|Doyl|2005-04-25     1 white 198522\n30 Jimm|Doyl|2005-04-25     2  &lt;NA&gt;     NA\n31 Jimm|Doyl|2005-04-25     3  &lt;NA&gt; 197522\n32 Jimm|Doyl|2005-04-25     4 white     NA\n33 Mari|Lind|1966-06-23     1 white 178323\n34 Mari|Lind|1966-06-23     2  &lt;NA&gt;     NA\n35 Mari|Lind|1966-06-23     3 white     NA\n36 Mari|Lind|1966-06-23     4  &lt;NA&gt; 177323\n37 Tamb|Bali|1953-05-10     1 white 140772\n38 Tamb|Bali|1953-05-10     2  &lt;NA&gt;     NA\n39 Tamb|Bali|1953-05-10     3 white     NA\n40 Tamb|Bali|1953-05-10     4  &lt;NA&gt; 139772\n\n# Forward fill missing race values within each patient (downward)\nvisits_all &lt;- visits_all %&gt;%\n  group_by(id_text) %&gt;%\n  mutate(race_forward = race) %&gt;%\n  fill(race_forward, .direction = \"down\") %&gt;%\n  ungroup()\n\n# Preview forward-filled race values (head)\nhead(visits_all %&gt;% select(id_text, visit, race, race_forward), n = 12)\n\n# A tibble: 12 √ó 4\n   id_text              visit race  race_forward\n   &lt;chr&gt;                &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt;       \n 1 Anit|S√°nc|1960-05-07     1 white white       \n 2 Anit|S√°nc|1960-05-07     2 &lt;NA&gt;  white       \n 3 Anit|S√°nc|1960-05-07     3 white white       \n 4 Anit|S√°nc|1960-05-07     4 &lt;NA&gt;  white       \n 5 Aure|Weis|2003-11-12     1 white white       \n 6 Aure|Weis|2003-11-12     2 &lt;NA&gt;  white       \n 7 Aure|Weis|2003-11-12     3 white white       \n 8 Aure|Weis|2003-11-12     4 &lt;NA&gt;  white       \n 9 Cars|Litt|2012-09-02     1 white white       \n10 Cars|Litt|2012-09-02     2 &lt;NA&gt;  white       \n11 Cars|Litt|2012-09-02     3 &lt;NA&gt;  white       \n12 Cars|Litt|2012-09-02     4 white white       \n\n# Backward fill missing race values within each patient (upward)\nvisits_all &lt;- visits_all %&gt;%\n  group_by(id_text) %&gt;%\n  mutate(race_backward = race) %&gt;%\n  fill(race_backward, .direction = \"up\") %&gt;%\n  ungroup()\n\n# Preview backward-filled race values (tail)\ntail(visits_all %&gt;% select(id_text, visit, race, race_backward), n = 12)\n\n# A tibble: 12 √ó 4\n   id_text              visit race  race_backward\n   &lt;chr&gt;                &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt;        \n 1 Jimm|Doyl|2005-04-25     1 white white        \n 2 Jimm|Doyl|2005-04-25     2 &lt;NA&gt;  white        \n 3 Jimm|Doyl|2005-04-25     3 &lt;NA&gt;  white        \n 4 Jimm|Doyl|2005-04-25     4 white white        \n 5 Mari|Lind|1966-06-23     1 white white        \n 6 Mari|Lind|1966-06-23     2 &lt;NA&gt;  white        \n 7 Mari|Lind|1966-06-23     3 white white        \n 8 Mari|Lind|1966-06-23     4 &lt;NA&gt;  &lt;NA&gt;         \n 9 Tamb|Bali|1953-05-10     1 white white        \n10 Tamb|Bali|1953-05-10     2 &lt;NA&gt;  white        \n11 Tamb|Bali|1953-05-10     3 white white        \n12 Tamb|Bali|1953-05-10     4 &lt;NA&gt;  &lt;NA&gt;         \n\n# Calculate the global (overall) mean income\nglobal_mean_income &lt;- mean(visits_all$income, na.rm = TRUE)\n\n# Use global mean to impute missing income values\nvisits_all &lt;- visits_all %&gt;%\n  mutate(income_global_mean = ifelse(is.na(income), global_mean_income, income))\n\n# Preview global mean-imputed income (head)\nhead(visits_all %&gt;% select(id_text, visit, income, income_global_mean), n = 12)\n\n# A tibble: 12 √ó 4\n   id_text              visit income income_global_mean\n   &lt;chr&gt;                &lt;dbl&gt;  &lt;dbl&gt;              &lt;dbl&gt;\n 1 Anit|S√°nc|1960-05-07     1  61016             61016 \n 2 Anit|S√°nc|1960-05-07     2     NA             96123.\n 3 Anit|S√°nc|1960-05-07     3     NA             96123.\n 4 Anit|S√°nc|1960-05-07     4  60016             60016 \n 5 Aure|Weis|2003-11-12     1   8752              8752 \n 6 Aure|Weis|2003-11-12     2     NA             96123.\n 7 Aure|Weis|2003-11-12     3     NA             96123.\n 8 Aure|Weis|2003-11-12     4   7752              7752 \n 9 Cars|Litt|2012-09-02     1  71169             71169 \n10 Cars|Litt|2012-09-02     2     NA             96123.\n11 Cars|Litt|2012-09-02     3  70169             70169 \n12 Cars|Litt|2012-09-02     4     NA             96123.\n\n# Calculate mean income per participant (id_text)\nparticipant_mean_income &lt;- visits_all %&gt;%\n  group_by(id_text) %&gt;%\n  summarise(mean_income_id = mean(income, na.rm = TRUE), .groups = \"drop\")\n\n# Use participant-level mean to impute missing income values\nvisits_all &lt;- visits_all %&gt;%\n  left_join(participant_mean_income, by = \"id_text\") %&gt;%\n  mutate(income_participant_mean = ifelse(is.na(income), mean_income_id, income))\n\n# Preview participant mean-imputed income (tail)\ntail(visits_all %&gt;% select(id_text, visit, income, income_participant_mean), n = 12)\n\n# A tibble: 12 √ó 4\n   id_text              visit income income_participant_mean\n   &lt;chr&gt;                &lt;dbl&gt;  &lt;dbl&gt;                   &lt;dbl&gt;\n 1 Jimm|Doyl|2005-04-25     1 198522                  198522\n 2 Jimm|Doyl|2005-04-25     2     NA                  198022\n 3 Jimm|Doyl|2005-04-25     3 197522                  197522\n 4 Jimm|Doyl|2005-04-25     4     NA                  198022\n 5 Mari|Lind|1966-06-23     1 178323                  178323\n 6 Mari|Lind|1966-06-23     2     NA                  177823\n 7 Mari|Lind|1966-06-23     3     NA                  177823\n 8 Mari|Lind|1966-06-23     4 177323                  177323\n 9 Tamb|Bali|1953-05-10     1 140772                  140772\n10 Tamb|Bali|1953-05-10     2     NA                  140272\n11 Tamb|Bali|1953-05-10     3     NA                  140272\n12 Tamb|Bali|1953-05-10     4 139772                  139772\n\n# Multiple imputation for fips, zip, healthcare_coverage, and income\npatients_mice &lt;- visits_all %&gt;%\n  select(id_text, fips, zip, healthcare_coverage, income)\n\n# Apply mice\nimputed &lt;- mice(patients_mice %&gt;% select(-id_text), method = \"pmm\", m = 1, printFlag = FALSE)\n\nWarning: Number of logged events: 1\n\n# Retrieve completed dataset\nmice_result &lt;- complete(imputed)\ncolnames(mice_result) &lt;- paste0(colnames(mice_result), \"_imputed\")\n\n# Join ID and filter rows with original missing values\ndf_mice &lt;- bind_cols(patients_mice, mice_result) %&gt;%\n  filter(is.na(fips) | is.na(zip) | is.na(healthcare_coverage) | is.na(income)) %&gt;%\n  select(id_text,\n         fips, fips_imputed,\n         zip, zip_imputed,\n         healthcare_coverage, healthcare_coverage_imputed,\n         income, income_imputed)\n\nhead(df_mice, n = 12)\n\n# A tibble: 12 √ó 9\n   id_text               fips fips_imputed   zip zip_imputed healthcare_coverage\n   &lt;chr&gt;                &lt;int&gt;        &lt;int&gt; &lt;int&gt;       &lt;int&gt;               &lt;dbl&gt;\n 1 Anit|S√°nc|1960-05-07 25009        25009  1915        1915            1280070.\n 2 Anit|S√°nc|1960-05-07 25009        25009  1915        1915            1280070.\n 3 Aure|Weis|2003-11-12 25027        25027  1606        1606             253645.\n 4 Aure|Weis|2003-11-12 25027        25027  1606        1606             253645.\n 5 Cars|Litt|2012-09-02 44007        44007  2861        2861                 NA \n 6 Cars|Litt|2012-09-02 44007        44007  2861        2861                 NA \n 7 Cars|Litt|2012-09-02 44007        44007  2861        2861                 NA \n 8 Cars|Litt|2012-09-02 44007        44007  2861        2861                 NA \n 9 Doll|Fran|2008-10-04    NA        25013    NA        2468             422516.\n10 Doll|Fran|2008-10-04    NA        25027    NA        1030             422516.\n11 Doll|Fran|2008-10-04    NA        25017    NA        2861             422516.\n12 Doll|Fran|2008-10-04    NA        25017    NA        1606             422516.\n# ‚Ñπ 3 more variables: healthcare_coverage_imputed &lt;dbl&gt;, income &lt;dbl&gt;,\n#   income_imputed &lt;dbl&gt;\n\n# Optional: Inspect logged events from mice\nimputed$loggedEvents\n\n  it im                 dep meth\n1  3  1 healthcare_coverage  pmm\n                                                                                                                                                                                                                                                       out\n1 mice detected that your data are (nearly) multi-collinear.\\nIt applied a ridge penalty to continue calculations, but the results can be unstable.\\nDoes your dataset contain duplicates, linear transformation, or factors with unique respondent names?\n\n# Final summary: compare original and imputed values for rows with missingness\n\nfinal_impute_check &lt;- visits_all %&gt;%\n  filter(is.na(race) | is.na(income)) %&gt;%\n  select(id_text, visit,\n         race, race_forward, race_backward,\n         income, income_global_mean, income_participant_mean)\n\n# Preview top 12\nhead(final_impute_check, n = 12)\n\n# A tibble: 12 √ó 8\n   id_text      visit race  race_forward race_backward income income_global_mean\n   &lt;chr&gt;        &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt;        &lt;chr&gt;          &lt;dbl&gt;              &lt;dbl&gt;\n 1 Anit|S√°nc|1‚Ä¶     2 &lt;NA&gt;  white        white             NA             96123.\n 2 Anit|S√°nc|1‚Ä¶     3 white white        white             NA             96123.\n 3 Anit|S√°nc|1‚Ä¶     4 &lt;NA&gt;  white        &lt;NA&gt;           60016             60016 \n 4 Aure|Weis|2‚Ä¶     2 &lt;NA&gt;  white        white             NA             96123.\n 5 Aure|Weis|2‚Ä¶     3 white white        white             NA             96123.\n 6 Aure|Weis|2‚Ä¶     4 &lt;NA&gt;  white        &lt;NA&gt;            7752              7752 \n 7 Cars|Litt|2‚Ä¶     2 &lt;NA&gt;  white        white             NA             96123.\n 8 Cars|Litt|2‚Ä¶     3 &lt;NA&gt;  white        white          70169             70169 \n 9 Cars|Litt|2‚Ä¶     4 white white        white             NA             96123.\n10 Doll|Fran|2‚Ä¶     2 &lt;NA&gt;  white        white             NA             96123.\n11 Doll|Fran|2‚Ä¶     3 &lt;NA&gt;  white        white         187023            187023 \n12 Doll|Fran|2‚Ä¶     4 white white        white             NA             96123.\n# ‚Ñπ 1 more variable: income_participant_mean &lt;dbl&gt;\n\n# Preview bottom 12\ntail(final_impute_check, n = 12)\n\n# A tibble: 12 √ó 8\n   id_text      visit race  race_forward race_backward income income_global_mean\n   &lt;chr&gt;        &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt;        &lt;chr&gt;          &lt;dbl&gt;              &lt;dbl&gt;\n 1 Home|Qui√±|1‚Ä¶     2 &lt;NA&gt;  white        white             NA             96123.\n 2 Home|Qui√±|1‚Ä¶     3 &lt;NA&gt;  white        white           6361              6361 \n 3 Home|Qui√±|1‚Ä¶     4 white white        white             NA             96123.\n 4 Jimm|Doyl|2‚Ä¶     2 &lt;NA&gt;  white        white             NA             96123.\n 5 Jimm|Doyl|2‚Ä¶     3 &lt;NA&gt;  white        white         197522            197522 \n 6 Jimm|Doyl|2‚Ä¶     4 white white        white             NA             96123.\n 7 Mari|Lind|1‚Ä¶     2 &lt;NA&gt;  white        white             NA             96123.\n 8 Mari|Lind|1‚Ä¶     3 white white        white             NA             96123.\n 9 Mari|Lind|1‚Ä¶     4 &lt;NA&gt;  white        &lt;NA&gt;          177323            177323 \n10 Tamb|Bali|1‚Ä¶     2 &lt;NA&gt;  white        white             NA             96123.\n11 Tamb|Bali|1‚Ä¶     3 white white        white             NA             96123.\n12 Tamb|Bali|1‚Ä¶     4 &lt;NA&gt;  white        &lt;NA&gt;          139772            139772 \n# ‚Ñπ 1 more variable: income_participant_mean &lt;dbl&gt;\n\n# Clean up temporary objects \nrm( participant_mean_income, final_impute_check, global_mean_income, df_passport, df_mice,\n    patients_mice, imputed, mice_result, missing_summary, total_missing, n_missing_individuals, missing_rows\n)\n\n\n\n\n\n\nIn data analysis, summarising and tabulating variables is often the first step before conducting modelling or drawing conclusions. Descriptive statistics reveal the central tendency, variability, distribution shape, and frequency patterns in your dataset.\nThis section provides an overview of the most commonly used R functions for summarising both numeric and categorical variables. These tools help detect outliers, missing data, or skewed distributions and are essential for generating publication-ready summary tables.\nüìö Further are available via:\n\nYouTube: AnalyticsHub\n\nGithub: Summary Tools Repository\n\n\nSome of the contents essential for this section are presented below.\nBasic Summary Statistics\nsummary(), mean(), median(), min(), max(), sd(), var(), range(), quantile(), IQR()\nDistribution Shape / Skewness: skewness(), kurtosis() Extended Descriptive Summaries: describe() ,stat.desc(), skim() Tabulation (Frequencies and Proportions)\ntable(), prop.table(), addmargins(), xtabs()\nTidy Summary and Tabulations\ntabyl(), adorn_percentages(), adorn_totals() ‚Äì From janitor\ncount(), group_by() + summarise() ‚Äì From dplyr\npivot_wider(), pivot_longer() ‚Äì From tidyr\nCross Tabulations: CrossTable() ‚Äì From gmodels\n\n\nThese functions are useful for summarising continuous variables such as age, vaccine cost, or time intervals:\n\nsummary() ‚Äì 5-number summary + mean\n\nmean(), median() ‚Äì Measures of central tendency\n\nsd(), var() ‚Äì Measures of spread\n\nmin(), max() ‚Äì Extremes\n\nrange() ‚Äì Min and max in one\n\nquantile() ‚Äì Percentiles (e.g., 25th, 75th)\nIQR() ‚Äì Interquartile range\n\n\n\n\n  Childhood Respiratory       Other \n        472         955         126 \n\n\n\nFemale   Male \n   798    755 \n\n\n\n# ....................................................\n# Basic Summary Statistics Using Base R\n# ....................................................\n\n# Select key numeric variables\nsummary_vars &lt;- vacc_1524 %&gt;% \n  select(age, base_cost, healthcare_expenses)\n\n# View summary() for a quick five-number summary + mean\nsummary(summary_vars)\n\n      age          base_cost   healthcare_expenses\n Min.   : 1.00   Min.   :136   Min.   :    527.5  \n 1st Qu.:12.00   1st Qu.:136   1st Qu.:  14478.2  \n Median :25.00   Median :136   Median :  56729.2  \n Mean   :32.42   Mean   :136   Mean   : 156656.2  \n 3rd Qu.:52.00   3rd Qu.:136   3rd Qu.: 195830.8  \n Max.   :97.00   Max.   :136   Max.   :1157946.9  \n\n# Individual statistics for 'age'\nmean(vacc_1524$age, na.rm = TRUE)             # Mean age\n\n[1] 32.41661\n\nmedian(vacc_1524$age, na.rm = TRUE)           # Median age\n\n[1] 25\n\nmin(vacc_1524$age, na.rm = TRUE)              # Minimum age\n\n[1] 1\n\nmax(vacc_1524$age, na.rm = TRUE)              # Maximum age\n\n[1] 97\n\nsd(vacc_1524$age, na.rm = TRUE)               # Standard deviation of age\n\n[1] 23.76926\n\nvar(vacc_1524$age, na.rm = TRUE)              # Variance of age\n\n[1] 564.9777\n\nrange(vacc_1524$age, na.rm = TRUE)            # Range: min and max\n\n[1]  1 97\n\nquantile(vacc_1524$age, probs = c(0.25, 0.5, 0.75), na.rm = TRUE)  # Quartiles\n\n25% 50% 75% \n 12  25  52 \n\nIQR(vacc_1524$age, na.rm = TRUE)              # Interquartile range\n\n[1] 40\n\n# ....................................................\n# Clean up temporary object\n# ....................................................\nrm(summary_vars)\n\n\n\n\nThese indicators describe the shape of a numeric variable‚Äôs distribution. They help identify when a variable is:\n\nSkewed (not symmetric)\nHeavy-tailed (high kurtosis)\n\nDistribution Shape: Skewness and Kurtosis\n\n\n\n\n\n\n\n\nValue Range\nSkewness\nKurtosis (Excess)\n\n\n\n\n‚âà 0\nSymmetrical\nMesokurtic (normal-tailed)\n\n\n¬±0.5\nApproximately symmetrical\nSlight deviation\n\n\n¬±0.5 ‚Äì ¬±1\nModerate skew\nModerate peakedness or flatness\n\n\n&gt; ¬±1\nHigh skew (strong asymmetry)\nSubstantial deviation from normality\n\n\n&gt; 0 (kurtosis - 3 &gt; 0)\n‚Äì\nLeptokurtic (peaked, heavy tails)\n\n\n&lt; 0 (kurtosis - 3 &lt; 0)\n‚Äì\nPlatykurtic (flat, light tails)\n\n\n\n\n# Ensure the 'moments' package is installed\nif (!requireNamespace(\"moments\", quietly = TRUE)) {install.packages(\"moments\")}\nlibrary(moments)\n\n\n# Calculate distribution shape statistics\nskewness(vacc_1524$age, na.rm = TRUE)     # Skewness: +ve = right-skewed, -ve = left-skewed\n\n[1] 0.5301022\n\nkurtosis(vacc_1524$age, na.rm = TRUE)     # Kurtosis: &gt;3 = heavy tails, &lt;3 = flat distribution\n\n[1] 2.059686\n\nkurtosis(vacc_1524$age, na.rm = TRUE) - 3  # Excess kurtosis\n\n[1] -0.940314\n\n# ....................................................\n# Histogram to Visualize Distribution Shape\n# ....................................................\nhist(vacc_1524$age, \n     main = \"Histogram of Age\",\n     xlab = \"Age (Years)\", \n     col = \"#69b3a2\", \n     border = \"white\")\n\n\n\n\n\n\n\n\n\n\n\n\nTo produce a comprehensive summary of all variables (especially helpful in surveys or health system datasets), use:\n\ndescribe() ‚Äì From Hmisc: includes labels, missing %, and stats\n\nstat.desc() ‚Äì From pastecs: full statistical description with skew/kurtosis\n\nskim() ‚Äì From skimr: summary with inline histograms and types\n\n\n\n# Install required packages if missing\npackages &lt;- c(\"Hmisc\", \"pastecs\", \"skimr\")\nfor (p in packages) {if (!requireNamespace(p, quietly = TRUE)) install.packages(p)}\n\n# Explicitly load the packages\nlibrary(Hmisc)     # for describe()\nlibrary(pastecs)   # for stat.desc()\nlibrary(skimr)     # for skim()\n\nrm (packages)\n\n\n# ------------------------------\n# Extended Descriptive Summaries\n# ------------------------------\n\n# Hmisc::describe() ‚Äì Detailed variable summary\ndescribe(vacc_1524[, c(\"age\", \"gender\", \"race\")])\n\nvacc_1524[, c(\"age\", \"gender\", \"race\")] \n\n 3  Variables      1553  Observations\n--------------------------------------------------------------------------------\nage \n       n  missing distinct     Info     Mean  pMedian      Gmd      .05 \n    1553        0       62    0.999    32.42       32    26.76      5.0 \n     .10      .25      .50      .75      .90      .95 \n     6.0     12.0     25.0     52.0     68.8     73.0 \n\nlowest :  1  2  5  6  7, highest: 76 78 80 85 97\n--------------------------------------------------------------------------------\ngender \n       n  missing distinct \n    1553        0        2 \n                        \nValue      Female   Male\nFrequency     798    755\nProportion  0.514  0.486\n--------------------------------------------------------------------------------\nrace \n       n  missing distinct \n    1553        0        5 \n                                             \nValue       asian  black native  other  white\nFrequency     111     94     13     29   1306\nProportion  0.071  0.061  0.008  0.019  0.841\n--------------------------------------------------------------------------------\n\n# pastecs::stat.desc() ‚Äì Full statistics with skewness/kurtosis\nstat.desc(vacc_1524$age)\n\n     nbr.val     nbr.null       nbr.na          min          max        range \n1.553000e+03 0.000000e+00 0.000000e+00 1.000000e+00 9.700000e+01 9.600000e+01 \n         sum       median         mean      SE.mean CI.mean.0.95          var \n5.034300e+04 2.500000e+01 3.241661e+01 6.031564e-01 1.183087e+00 5.649777e+02 \n     std.dev     coef.var \n2.376926e+01 7.332432e-01 \n\n# skimr::skim() ‚Äì Tidy summary with histograms and data types\nskim(vacc_1524[, c(\"age\", \"gender\", \"income\")])\n\n\nData summary\n\n\nName\nvacc_1524[, c(‚Äúage‚Äù, ‚Äúgen‚Ä¶\n\n\nNumber of rows\n1553\n\n\nNumber of columns\n3\n\n\n_______________________\n\n\n\nColumn type frequency:\n\n\n\nfactor\n1\n\n\nnumeric\n2\n\n\n________________________\n\n\n\nGroup variables\nNone\n\n\n\nVariable type: factor\n\n\n\n\n\n\n\n\n\n\n\nskim_variable\nn_missing\ncomplete_rate\nordered\nn_unique\ntop_counts\n\n\n\n\ngender\n0\n1\nFALSE\n2\nFem: 798, Mal: 755\n\n\n\nVariable type: numeric\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nskim_variable\nn_missing\ncomplete_rate\nmean\nsd\np0\np25\np50\np75\np100\nhist\n\n\n\n\nage\n0\n1\n32.42\n23.77\n1\n12\n25\n52\n97\n‚ñá‚ñÉ‚ñÉ‚ñÉ‚ñÅ\n\n\nincome\n0\n1\n108887.58\n139702.07\n7361\n35860\n75767\n124775\n816851\n‚ñá‚ñÅ‚ñÅ‚ñÅ‚ñÅ\n\n\n\n\n\n\n\n\nUsed for categorical variables like gender, race, or vaccine group:\n\ntable() ‚Äì Basic frequency counts\n\nprop.table() ‚Äì Row/column proportions\n\naddmargins() ‚Äì Adds totals to tables\n\nxtabs() ‚Äì Cross-tabulation formula interface\n\n\n\n# --------------------------------------------\n# üîπ Categorical Variable Summary \n# --------------------------------------------\n\n# Basic frequency counts for individual vaccine types\ntable(vacc_1524$vaccine_group)\n\n\n          COVID-19          DTP group          Hepatitis                Hib \n               144                147                111                 32 \n               HPV          Influenza                IPV      Meningococcal \n                59                811                 47                 50 \n               MMR Pneumococcal PCV13 Pneumococcal PPV23          Rotavirus \n                26                 52                  8                 21 \n         Varicella             Zoster \n                26                 19 \n\n# Frequency counts for grouped vaccine categories\ntable(vacc_1524$vacc_group3)\n\n\n  Childhood Respiratory       Other \n        472         955         126 \n\n# Proportion of grouped vaccine categories\nprop.table(table(vacc_1524$vacc_group3))  # Overall proportions\n\n\n  Childhood Respiratory       Other \n 0.30392788  0.61493883  0.08113329 \n\n# Frequency table with row/column totals added\naddmargins(table(vacc_1524$vacc_group3))\n\n\n  Childhood Respiratory       Other         Sum \n        472         955         126        1553 \n\n# Cross-tabulation between vaccine group and gender\nxtabs(~ vacc_group3 + gender, data = vacc_1524)\n\n             gender\nvacc_group3   Female Male\n  Childhood      233  239\n  Respiratory    511  444\n  Other           54   72\n\n\n\n\n\nModern workflows prefer tidy-format summaries using:\n\ntabyl() ‚Äì From janitor: clean frequency tables\n\nadorn_totals(), adorn_percentages() ‚Äì Add percentages and totals\n\ncount() ‚Äì From dplyr: group-level counts\n\ngroup_by() + summarise() ‚Äì Group-wise summary\npivot_wider(), pivot_longer() ‚Äì Reshape tables\n\nThe section below demonstrates tabulations using janitor::tabyl() and tidyverse functions for grouped summaries and table reshaping.\n\n# --------------------------------------------\n# üîπ Tabulation and Table Reshaping \n# --------------------------------------------\n\n# 1. Basic clean frequency table with janitor::tabyl()\nvacc_1524 %&gt;%\n  tabyl(vacc_group3)\n\n vacc_group3   n    percent\n   Childhood 472 0.30392788\n Respiratory 955 0.61493883\n       Other 126 0.08113329\n\n# 2. Add column percentages and total row\nvacc_1524 %&gt;%\n  tabyl(vacc_group3, gender) %&gt;%\n  adorn_percentages(\"col\") %&gt;%\n  adorn_totals(\"row\") %&gt;%\n  adorn_title(\"combined\")  # Cleaner column names\n\n vacc_group3/gender     Female       Male\n          Childhood 0.29197995 0.31655629\n        Respiratory 0.64035088 0.58807947\n              Other 0.06766917 0.09536424\n              Total 1.00000000 1.00000000\n\n# 3. Group-level count using dplyr::count()\nvacc_1524 %&gt;%\n  count(vacc_group3, gender)\n\n  vacc_group3 gender   n\n1   Childhood Female 233\n2   Childhood   Male 239\n3 Respiratory Female 511\n4 Respiratory   Male 444\n5       Other Female  54\n6       Other   Male  72\n\n# 4. Group-wise summary using group_by + summarise\nvacc_1524 %&gt;%\n  group_by(vacc_group3) %&gt;%\n  summarise(n = n(), .groups = \"drop\") %&gt;%\n  mutate(prop = n / sum(n))\n\n# A tibble: 3 √ó 3\n  vacc_group3     n   prop\n  &lt;fct&gt;       &lt;int&gt;  &lt;dbl&gt;\n1 Childhood     472 0.304 \n2 Respiratory   955 0.615 \n3 Other         126 0.0811\n\n# 5. Pivot table to wide format (e.g., for display or reporting)\nvacc_1524 %&gt;%\n  count(vacc_group3, gender) %&gt;%\n  pivot_wider(names_from = gender, values_from = n, values_fill = 0)\n\n# A tibble: 3 √ó 3\n  vacc_group3 Female  Male\n  &lt;fct&gt;        &lt;int&gt; &lt;int&gt;\n1 Childhood      233   239\n2 Respiratory    511   444\n3 Other           54    72\n\n# 6. Optional: Pivot longer to return to tidy format\nvacc_1524 %&gt;%\n  count(vacc_group3, gender) %&gt;%\n  pivot_wider(names_from = gender, values_from = n, values_fill = 0) %&gt;%\n  pivot_longer(-vacc_group3, names_to = \"gender\", values_to = \"count\")\n\n# A tibble: 6 √ó 3\n  vacc_group3 gender count\n  &lt;fct&gt;       &lt;chr&gt;  &lt;int&gt;\n1 Childhood   Female   233\n2 Childhood   Male     239\n3 Respiratory Female   511\n4 Respiratory Male     444\n5 Other       Female    54\n6 Other       Male      72\n\n\n\n\n\nUsed to explore the relationship between two or more categorical variables.\n\nCrossTable() ‚Äì From gmodels: produces detailed cross-tabs with row %, column %, and counts\n\n\n# Install and load the gmodels package for cross-tabulation\nif (!requireNamespace(\"gmodels\", quietly = TRUE)) {\n  install.packages(\"gmodels\")\n}\nlibrary(gmodels)\n\n\n# ------------------------------\n# Cross Tabulation Example\n# ------------------------------\n\n# Generate a contingency table between gender and vaccine group\nCrossTable(vacc_1524$vacc_group3, vacc_1524$gender,\n           prop.r = FALSE,     # Row proportions\n           prop.c = TRUE,     # Column proportions\n           prop.t = FALSE,    # Overall proportion (optional)\n           chisq = TRUE)      # Include chi-square test for independence\n\n\n \n   Cell Contents\n|-------------------------|\n|                       N |\n| Chi-square contribution |\n|           N / Col Total |\n|-------------------------|\n\n \nTotal Observations in Table:  1553 \n\n \n                      | vacc_1524$gender \nvacc_1524$vacc_group3 |    Female |      Male | Row Total | \n----------------------|-----------|-----------|-----------|\n            Childhood |       233 |       239 |       472 | \n                      |     0.375 |     0.396 |           | \n                      |     0.292 |     0.317 |           | \n----------------------|-----------|-----------|-----------|\n          Respiratory |       511 |       444 |       955 | \n                      |     0.838 |     0.886 |           | \n                      |     0.640 |     0.588 |           | \n----------------------|-----------|-----------|-----------|\n                Other |        54 |        72 |       126 | \n                      |     1.783 |     1.885 |           | \n                      |     0.068 |     0.095 |           | \n----------------------|-----------|-----------|-----------|\n         Column Total |       798 |       755 |      1553 | \n                      |     0.514 |     0.486 |           | \n----------------------|-----------|-----------|-----------|\n\n \nStatistics for All Table Factors\n\n\nPearson's Chi-squared test \n------------------------------------------------------------\nChi^2 =  6.162349     d.f. =  2     p =  0.04590531 \n\n\n \n\n\n\nüîπ Summary Table: Descriptive Statistics and Tabulation Functions\n\n\n\n\n\n\n\n\nTask\nFunction\nPackage\n\n\n\n\nBasic numeric summaries\nsummary(), mean(), sd(), IQR()\nbase\n\n\nPercentiles and range\nquantile(), range()\nbase\n\n\nSkewness / Kurtosis\nskewness(), kurtosis()\ne1071, moments\n\n\nExtended profiling\ndescribe(), stat.desc(), skim()\nHmisc, pastecs, skimr\n\n\nFrequency tables\ntable(), xtabs(), prop.table()\nbase\n\n\nClean tables (tidy)\ntabyl(), adorn_*(), count()\njanitor, dplyr\n\n\nGroup summaries\ngroup_by() + summarise()\ndplyr\n\n\nReshape for tables\npivot_wider(), pivot_longer()\ntidyr\n\n\nRich cross-tabulation\nCrossTable()\ngmodels\n\n\n\n\n\n\n\n\nwrite.csv(), write_xlsx(), saveRDS(), write_tsv()\nExporting interactive tables with DT::datatable()\nSaving and loading the entire R workspace (save.image(), load())\n\n\n\n\n\n\nVisualization Contents and Types Overview\n\nLayers: Theme, Coordinates, Facets, Statistics, Geometries, Aesthetics, Data\nChart Types: line, histogram, boxplot, bar, area, density, violin, dotplot, ECDF, scatter, bubble, QQ plot\nComparative & Multivariate: faceted plot, pair plot, heatmap, treemap, radar chart, ridgeline plot, forest plot\nGeospatial Visualization: choropleth map, point map, heatmap overlay\nStatistical Overlays: error bars, confidence intervals, regression lines, smoothers\nInteractive Visualization: scatter/line/bar (Plotly), interactive tables (DT), interactive maps (Leaflet), dashboards (Shiny, flexdashboard)\n\nEffective visualizations help uncover patterns, trends, and insights in data. In R, we commonly use the ggplot2 package for static plots and tools like plotly, DT, and leaflet for interactive dashboards and graphics.\nThe sections below summarize different types of visualizations and how they fit into analysis workflows.\n\n\n\nEvery ggplot chart is built using multiple composable layers: - Data: The dataset to visualize. - Aesthetics (aes()): Mappings between variables and visual elements (e.g., x, y, color). - Geometries (geom_*): Plot types (e.g., geom_line(), geom_bar()). - Statistics (stat_*): Summaries or transformations (e.g., stat_smooth()). - Facets: Create multiple plots by group (facet_wrap(), facet_grid()). - Coordinates: Set axis and aspect ratio (coord_cartesian(), coord_flip()). - Themes: Control overall appearance (e.g., theme_minimal(), theme_bw()).\n\n\n\n\n\n\n\n\n\n\n\nChart Type\nFunction\nUsed For\n\n\n\n\nLine Chart\ngeom_line()\nTrends over time\n\n\nHistogram\ngeom_histogram()\nDistribution of continuous variables\n\n\nBoxplot\ngeom_boxplot()\nDistribution & outliers\n\n\nBar Plot\ngeom_bar()\nCounts or categorical comparison\n\n\nArea Plot\ngeom_area()\nCumulative trends\n\n\nDensity Plot\ngeom_density()\nSmoothed distribution\n\n\nViolin Plot\ngeom_violin()\nCombination of boxplot + density\n\n\nDot Plot\ngeom_dotplot()\nCount-based plots\n\n\nECDF Plot\nstat_ecdf()\nCumulative distribution\n\n\nScatter Plot\ngeom_point()\nBivariate relationships\n\n\nBubble Plot\ngeom_point(aes(size = ...))\n3-variable comparison using size\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nVisual Type\nPurpose\n\n\n\n\nFaceted Plot (facet_wrap)\nCompare subgroups in separate panels\n\n\nPair Plot (GGally::ggpairs)\nExplore all pairwise relationships\n\n\nHeatmap (geom_tile, heatmap())\nShow intensity using color\n\n\nTreemap (treemapify)\nHierarchical categories and values\n\n\nRadar Chart (fmsb)\nCompare multivariate profiles\n\n\nRidgeline Plot (ggridges)\nDistribution comparison across groups\n\n\nForest Plot (forestplot, ggforestplot)\nConfidence intervals and effect sizes\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nMap Type\nFunction/Use\n\n\n\n\nChoropleth Map\nShow values by region (e.g., geom_sf(), tmap)\n\n\nPoint Map\nLocations with coordinates (e.g., geom_point(), leaflet::addMarkers)\n\n\nHeatmap Overlay\nDensity of spatial events (e.g., leaflet::addHeatmap())\n\n\n\n\n\n\n\n\nError bars: geom_errorbar() for confidence or SD intervals\nRegression lines: geom_smooth(method = \"lm\")\nTrend smoothing: geom_smooth() with method = \"loess\"\nLabeling: geom_text(), geom_label() to annotate plots\n\n\nThis section demonstrates how to visualize breast cancer screening and vaccination data. We‚Äôll walk through common chart types such as line plots, bar charts, boxplots, and faceted views. Each example is designed with annotations and descriptions to aid understanding.\n\n\n\n\nEach chart demonstrates how different ggplot2 components come together using real health datasets.\n\n# Install if not already installed\nif (!requireNamespace(\"treemapify\", quietly = TRUE)) {install.packages(\"treemapify\")}\nif (!requireNamespace(\"ggridges\", quietly = TRUE)) {install.packages(\"ggridges\")}\nif (!requireNamespace(\"gganimate\", quietly = TRUE)) install.packages(\"gganimate\")\nif (!requireNamespace(\"gifski\", quietly = TRUE)) install.packages(\"gifski\")\n\nlibrary(gganimate)\nlibrary(gifski)\nlibrary(ggridges)\nlibrary(dplyr)\nlibrary(ggplot2)\nlibrary(plotly)\nlibrary(treemapify)\nlibrary(stringr)  # for str_to_title()\nlibrary(tidyr)\n\n\n\n Date[1:1553], format: \"1994-02-06\" \"1994-02-06\" \"1994-02-06\" \"1994-02-06\" \"1994-02-06\" ...\n\n\n\n  1   2   5   6   7  10  11  12  13  14  15  16  17  18  19  20  21  23  24  25 \n 46  24  64  66  34 100  38  59  21  21  34  81  18  36  18  34  40  13  12  47 \n 27  28  29  30  33  34  36  37  38  40  41  42  43  44  45  46  47  48  49  50 \n 17  30   9  35   4   7   6   8   6  20  37  16   9  17  15  13   9  21  30  15 \n 51  52  53  55  56  58  60  61  62  63  64  65  68  69  71  73  74  76  78  80 \n 13  30  16  30  26  14  12  24  36  13  25  14  14  47  14  19  15  14  12  13 \n 85  97 \n 12  10 \n\n\n\n  0‚Äì9 10‚Äì19 20‚Äì29 30‚Äì49   50+ \n  234   426   202   253   438 \n\n\n\n2016 2017 2018 2019 \n 341  341  341  341 \n\n\nLine Chart ‚Äì Breast Cancer Screening Trends by Region in Australia\nThe example below shows a line chart illustrating trends in breast cancer screening rates across Australian states from 2016 to 2019.\n\nBreast cancer screening rates across most Australian states appeared relatively consistent from 2016 to 2018, with minor year-to-year variations.\nA notable decline in screening rates is evident after 2018 and particularly in 2019, coinciding with the early stages of the COVID-19 pandemic\n\nState-specific Observations:\n\nTasmania (Tas) consistently had the highest screening rate, around 60%, but showed a clear decline post-2018.\nThe Northern Territory (NT) had the lowest rates, around 40%, also experiencing a slight decline during this period.\nOther states (ACT, NSW, Qld, SA, Vic, WA) maintained relatively stable rates (around 55%) until 2018, after which a distinct downturn is noticeable, particularly in Western Australia (WA) and Victoria (Vic).\n\nImpact of COVID-19:\n\nThe observed decline in breast cancer screening from 2019 onwards aligns with the emergence of the COVID-19 pandemic, which disrupted routine healthcare services globally.\n\nThis analysis underscores the importance of maintaining consistent access to healthcare services, particularly preventive screenings, even during periods of significant healthcare disruption.\n\n# Visualizing changes in screening rates (50‚Äì74 years) over time by state\n\nbreast_cancer_data %&gt;%\n  group_by(state, year_4digit) %&gt;%  # group by state and year\n  summarise(mean_rate = mean(rate50_74, na.rm = TRUE), .groups = \"drop\") %&gt;%\n  ggplot(aes(x = year_4digit, y = mean_rate, color = state)) +  # map axes and color\n  geom_line(size = 1.2) +  # trend lines\n  geom_point(size = 2) +   # points for each year\n  labs(\n    title = \"Breast Cancer Screening Rates (50‚Äì74 yrs)\",  \n    subtitle = \"Aggregated by State and Year\",           \n    x = \"Year\", y = \"Screening Rate (%)\",  # Axis labels\n    color = \"State\"   # Legend title\n  ) +\n  \n  theme_minimal()  \n\nWarning: Using `size` aesthetic for lines was deprecated in ggplot2 3.4.0.\n‚Ñπ Please use `linewidth` instead.\n\n\nWarning: Removed 4 rows containing missing values or values outside the scale range\n(`geom_line()`).\n\n\nWarning: Removed 4 rows containing missing values or values outside the scale range\n(`geom_point()`).\n\n\n\n\n\n\n\n\n\nHistogram ‚Äì Distribution of Age\nDisplays the frequency of vaccinated individuals by age, with a density line overlay to visualize the distribution shape.\nThe example below shows a histogram illustrating the age distribution within our studied population. The distribution highlights a clear bimodal pattern, indicating two main age groups. The largest group comprises younger adults, predominantly around 20‚Äì30 years old, suggesting a significant representation of young adults. A smaller secondary group emerges around 55‚Äì65 years old, reflecting a noticeable segment of older adults. This pattern may indicate specific target groups or demographic characteristics relevant to the population from which the data was collected. Understanding these age clusters can help tailor appropriate health strategies, services, or interventions accordingly.\n\nvacc_1524 %&gt;%\n  ggplot(aes(x = age)) +\n  geom_histogram(aes(y = ..density..), binwidth = 5, fill = \"darkblue\", color = \"white\", alpha = 0.7) +\n  geom_density(color = \"red\", size = 1.2) +\n  labs(title = \"Age Distribution with Density Curve\", x = \"Age\", y = \"Density\") +\n  theme_minimal()\n\nWarning: The dot-dot notation (`..density..`) was deprecated in ggplot2 3.4.0.\n‚Ñπ Please use `after_stat(density)` instead.\n\n\n\n\n\n\n\n\n\nPie Chart ‚Äì Proportion by Vaccine Group\nShows how vaccine groups are proportionally represented in the dataset. Useful for visualizing categorical outcomes.\nIn the example below, the pie chart represents the proportion of vaccinations grouped into three categories:\n\nRespiratory vaccines account for the largest proportion, comprising 61% of all vaccines administered.\nChildhood vaccines represent a significant portion as well, making up 30%.\nThe category labeled Other includes 8% of vaccines administered, indicating a smaller but notable group of vaccinations outside the respiratory and childhood classifications.\n\n\nvacc_1524 %&gt;%\n  count(vacc_group3) %&gt;%\n  mutate(perc = n / sum(n), label = scales::percent(perc)) %&gt;%\n  ggplot(aes(x = \"\", y = perc, fill = vacc_group3)) +\n  geom_col(width = 1) +\n  coord_polar(theta = \"y\") +\n  geom_text(aes(label = label), position = position_stack(vjust = 0.5)) +\n  labs(title = \"Vaccine Group Proportions\", fill = \"Vaccine Group\") +\n  theme_void()\n\n\n\n\n\n\n\n\nBar Plot ‚Äì Vaccination Count by Vaccine Group\nThis plot compares the absolute count of vaccinations across groups, with horizontal bars for better readability of long labels.\nThe example below shows a horizontal bar chart illustrating the total number of vaccinations administered, grouped into three distinct categories:\n\nRespiratory vaccines clearly represent the largest group, indicating that these vaccines were administered most frequently within the population.\nThe Other category accounts for the smallest number of vaccinations, suggesting a relatively minor proportion of miscellaneous or specialized vaccines.\n\n\nvacc_1524 %&gt;%\n  count(vacc_group3) %&gt;%\n  ggplot(aes(x = reorder(vacc_group3, n), y = n, fill = vacc_group3)) +\n  geom_bar(stat = \"identity\") +\n  coord_flip() +\n  labs(title = \"Vaccination Count by Group\", x = NULL, y = \"Count\") +\n  theme_minimal() +\n  theme(legend.position = \"none\")\n\n\n\n\n\n\n\n\nGrouped Bar Plot ‚Äì Vaccination by Race and Vaccine Group\nThe example below shows a stacked bar chart presenting the distribution of vaccinations by race and vaccine category.\n\nRespiratory vaccines (represented in blue) dominate across all racial groups, consistently making up the largest proportion of administered vaccines, especially noticeable among Black and White groups.\nChildhood vaccines (represented in red) form a significant proportion of vaccinations among the Asian and Native groups, highlighting targeted or population-specific vaccination programs for younger age groups within these communities.\nThe Other vaccines category (represented in green) comprises a relatively minor proportion and appears more prominent among the Asian and White populations.\n\n**Implications:**\n\nThese patterns may suggest varying public health strategies, demographic factors, or differing healthcare access across racial groups. Understanding these variations can guide targeted healthcare interventions and improve vaccine coverage equity.\n\n# Prepare data: count vaccinations by race and vaccine group\n\nvacc_1524$race &lt;- tools::toTitleCase(vacc_1524$race)\n\nvacc_summary &lt;- vacc_1524 %&gt;%\n  count(race, vacc_group3) %&gt;%\n  group_by(race) %&gt;%\n  mutate(prop = n / sum(n)) %&gt;%\n  ungroup()\n\nggplot(vacc_summary, aes(x = race, y = prop, fill = vacc_group3)) +\n  geom_col(position = \"dodge\") +\n  labs(\n    title = \"Vaccination Distribution by Race and Vaccine Group\",\n    x = \"Race\", y = \"Proportion\",\n    fill = \"Vaccine Group\"\n  ) +\n  scale_y_continuous(labels = scales::percent_format()) +\n  theme_minimal() +\n  theme(axis.text.x = element_text(angle = 45, hjust = 1))\n\n\n\n\n\n\n\nrm(vacc_summary)\n\nStacked Bar Chart ‚Äì Race by Vaccine Group\nThe example below shows a stacked bar chart illustrating the number of vaccinations administered, grouped by vaccine type and categorized by racial groups.\n\nThe White population received the highest number of vaccinations across all vaccine categories (Childhood, Other, and Respiratory vaccines).\nOther racial groups (Asian, Black, Native, and Other) also received vaccinations, though in smaller numbers across each vaccine type, indicating ongoing efforts to reach diverse communities.\nRespiratory vaccines had the highest total number of vaccinations administered, suggesting these vaccines were a primary focus within the vaccination program.\n\nThis data helps to illustrate which groups have higher vaccine coverage and highlights the importance of ensuring equitable access and distribution across all communities.\n\nvacc_1524 %&gt;%\n  mutate(race = stringr::str_to_title(race)) %&gt;%\n  count(vacc_group3, race) %&gt;%\n  ggplot(aes(x = vacc_group3, y = n, fill = race)) +\n  geom_bar(stat = \"identity\") +\n  labs(title = \"Stacked Bar Chart: Race by Vaccine Group\", x = \"Vaccine Group\", y = \"Count\") +\n  theme_minimal()\n\n\n\n\n\n\n\n\nBoxplot ‚Äì Age Distribution by Vaccine Group\nVisualizes how age varies across vaccine groups using standard boxplots.\nThe example below shows a box plot depicting age distribution for three vaccine categories (Childhood vaccines, Other vaccines, and Respiratory vaccines):\nKey Observations:\n\nChildhood vaccines primarily cover younger ages, with most recipients under 25 years old. Some individuals beyond this age range appear as outliers, suggesting occasional vaccinations in older groups.\nRespiratory vaccines generally target an older age group, with the median age around 50 years, and a broad range from younger adults to elderly populations.\nThe Other vaccines category has a wider age distribution overall, suggesting these vaccines serve diverse age groups, though with fewer individuals compared to the other two groups.\n\nImplications:\nThis visualization highlights clear age-based targeting for different vaccine categories. Childhood vaccines are expectedly administered primarily to younger populations, while respiratory vaccines predominantly reach older adults. Understanding these age patterns helps to plan targeted public health campaigns and resource allocation effectively.\n\nvacc_1524 %&gt;%\n  ggplot(aes(x = vacc_group3, y = age, fill = vacc_group3)) +\n  geom_boxplot() +\n  labs(title = \"Age Distribution by Vaccine Group\",\n       x = \"Vaccine Group\", y = \"Age (Years)\") +\n  theme_minimal() +\n  theme(legend.position = \"none\")\n\n\n\n\n\n\n\n\nBoxplot with Jittered (Individual Data) Points\nCombines summary and raw data by overlaying individual age points on the boxplot.\nThe example below shows a boxplot with individual data points (jittered), displaying the age distribution of individuals across three vaccine groups: Childhood vaccines, Other vaccines, and Respiratory vaccines.\n\nChildhood vaccines:\nMost individuals who received childhood vaccines are young, with a median age around 10 years.\nThe distribution is tightly concentrated, though some older individuals (outliers) also received these vaccines.\nThe data points clearly cluster in younger age ranges, which is expected for this vaccine group.\n\nRespiratory vaccines:\n\nThis group has the highest median age, around 40‚Äì50 years.\nThe data points are more evenly spread out across a wide age range, with many individuals above 60 years, indicating respiratory vaccines are frequently administered to older populations.\n\n\nOther vaccines:\n\nThis group shows a wide range of ages, from infants to older adults.\nWhile the median age is still relatively low, the spread is broader compared to childhood vaccines, suggesting this category includes various vaccines administered across different age groups.\n\nImplications:\nBy combining summary statistics (boxplot) with individual-level data (dots), this chart offers a clear view of both overall trends and variation in vaccination by age. It confirms that vaccine distribution aligns with age-specific health needs‚Äîyoung children for childhood vaccines, and older adults for respiratory vaccines‚Äîwhile also showing the diversity within each group.\n\n\nvacc_1524 %&gt;%\n  ggplot(aes(x = vacc_group3, y = age, fill = vacc_group3)) +\n  geom_boxplot(outlier.shape = NA, alpha = 0.6) +\n  geom_point(position = position_jitter(width = 0.2),\n             alpha = 0.3, color = \"black\", size = 1.2) +\n  labs(title = \"Boxplot with Individual Data Points\",\n       x = \"Vaccine Group\", y = \"Age\") +\n  theme_minimal() +\n  theme(legend.position = \"none\")\n\n\n\n\n\n\n\n\nBoxplot with Violin Overlay\nAdds a violin plot to visualize the full distribution of ages while preserving boxplot summary stats.\nThe plot below combines a boxplot and violin plot to display the age distribution across different vaccine groups: Childhood vaccines, Other vaccines, and Respiratory vaccines.\n\nChildhood vaccines:\nThe age distribution is heavily concentrated among younger individuals, with most recipients under 25 years. The violin shape is widest near the lower ages, tapering quickly, which indicates that childhood vaccines are rarely given to older individuals.\nRespiratory vaccines:\nThe distribution leans toward older age groups, with the median age higher than in other categories. The violin is widest in the 40‚Äì70 age range, suggesting respiratory vaccines are more commonly administered to older adults.\n\n\n\nOther vaccines:\nThis group shows a broader age range. The shape suggests two areas of concentration: one among younger children and another around age 60‚Äì70, indicating this group includes vaccine types used across diverse age groups.\nOverall, this combined plot provides both statistical summaries (via boxplot) and full distribution shapes (via violin plot), helping to clearly distinguish the age-related usage patterns across vaccine types.\n\n\nvacc_1524 %&gt;%\n  ggplot(aes(x = vacc_group3, y = age, fill = vacc_group3)) +\n  geom_violin(alpha = 0.4, color = NA) +\n  geom_boxplot(width = 0.2, outlier.shape = NA) +\n  labs(title = \"Boxplot with Violin Overlay\", x = NULL, y = \"Age\") +\n  theme_minimal() +\n  theme(legend.position = \"none\")\n\n\n\n\n\n\n\n\nNotched Boxplot ‚Äì Median Comparison\nNotches allow a rough comparison of medians across groups. Non-overlapping notches suggest a significant difference.\nThe plot below presents a notched boxplot showing the age distribution for each vaccine group‚ÄîChildhood vaccines, Other vaccines, and Respiratory vaccines.\n\nThe notches around the medians provide a visual guide for comparing the central values (medians) across groups. If the notches do not overlap, it suggests that the medians are likely different in a statistically meaningful way.\n\nKey insights:\n\nChildhood vaccines show a younger age distribution, with a median age around 10 years and a narrow spread. Outliers indicate a few older individuals also received these vaccines.\nRespiratory vaccines are mainly administered to older age groups, with the highest median age among the three categories.\nOther vaccines span a wider range of ages, but the median remains lower than that of respiratory vaccines.\n\nMedian Comparison:\n\nThe non-overlapping notches between childhood and respiratory vaccines suggest a clear difference in median ages.\nThe other vaccines group overlaps slightly with both, indicating a more mixed age distribution and less pronounced difference.\n\n\nvacc_1524 %&gt;%\n  ggplot(aes(x = vacc_group3, y = age, fill = vacc_group3)) +\n  geom_boxplot(notch = TRUE) +\n  labs(title = \"Notched Boxplot: Vaccine Group vs Age\", x = \"Group\", y = \"Age\") +\n  theme_minimal() +\n  theme(legend.position = \"none\")\n\nNotch went outside hinges\n‚Ñπ Do you want `notch = FALSE`?\n\n\n\n\n\n\n\n\n\nFaceted Boxplot by Gender\nBreaks down the age distribution by vaccine group and gender to compare across subgroups.\nThe plot below shows boxplots of age distribution by vaccine group (Childhood, Respiratory, and Other vaccines), separated into two panels by gender (Female and Male).\nKey Observations:\n\nChildhood vaccines:\n\n-    Age distributions are similar for both females and males, with most recipients being under 25 years.\n\n-    A few older outliers are present, especially among females, but the bulk of vaccine recipients are children and adolescents.\n\nRespiratory vaccines:\n\n-    This group shows a wide age range in both genders, with median ages around 40‚Äì45 years.\n\n-    The distribution is slightly more spread out among males, but the overall trend remains consistent across genders.\n\nOther vaccines:\n\n-    A notable gender difference is visible here:\n\n    -   Among **females**, recipients span a broad age range, including many older adults.\n\n    -    Among **males**, the age distribution is narrower and skewed toward younger adults.\nSummary:\nThis faceted view helps highlight how age patterns differ by both vaccine group and gender. While childhood and respiratory vaccine distributions are generally similar across genders, the ‚ÄúOther‚Äù vaccine group shows more variation, possibly reflecting differences in vaccine eligibility, access, or health needs.\n\nvacc_1524 %&gt;%\n  ggplot(aes(x = vacc_group3, y = age, fill = vacc_group3)) +\n  geom_boxplot() +\n  facet_wrap(~ gender) +\n  labs(title = \"Age by Vaccine Group, Faceted by Gender\", x = NULL, y = \"Age\") +\n  theme_minimal() +\n  theme(legend.position = \"none\")\n\n\n\n\n\n\n\n\nOrdered Boxplot ‚Äì by Median Age\nReorders vaccine groups by median age to emphasize differences in distribution centrality.\nThe plot below shows age distributions by vaccine group, with the groups reordered by median age to highlight differences in central tendency.\nKey Observations:\n\nChildhood vaccines have the lowest median age, with most recipients being under 20 years. A small number of older individuals appear as outliers.\nOther vaccines show a moderate median age, but with a wide spread across age groups‚Äîranging from infants to older adults. This suggests these vaccines are used in more varied contexts.\nRespiratory vaccines have the highest median age, with recipients typically ranging from their 30s to older adulthood, reflecting their common use among older populations.\n\nConclusion:\nBy ordering the boxplots by median age, this visual emphasizes the different age profiles targeted by each vaccine group. This approach helps communicate age-related trends in vaccine administration more clearly .\n\nvacc_1524 %&gt;%\n  mutate(vacc_group3 = fct_reorder(vacc_group3, age, median, na.rm = TRUE)) %&gt;%\n  ggplot(aes(x = vacc_group3, y = age, fill = vacc_group3)) +\n  geom_boxplot() +\n  labs(title = \"Boxplot Ordered by Median Age\", x = NULL, y = \"Age\") +\n  theme_minimal() +\n  theme(legend.position = \"none\")\n\n\n\n\n\n\n\n\nArea Plot ‚Äì Monthly Vaccination Trends Over Years\nUses an area chart to show monthly vaccination volumes over multiple years, stacked by year.\nThe area chart below displays monthly vaccination counts over multiple years (2015‚Äì2024), helping visualize seasonal and annual trends in vaccine uptake.\nKey Observations:\n\n2020 stands out with the highest overall vaccination counts, especially between April and June, likely reflecting a surge due to public health responses such as the COVID-19 pandemic.\nIn other years, vaccination numbers are more evenly distributed, with moderate peaks around March‚ÄìApril or August‚ÄìSeptember, possibly aligning with seasonal vaccination programs (e.g., flu campaigns).\n2023 and 2024 show a relatively steady pattern throughout the year, with less fluctuation month-to-month.\nEarlier years (2015‚Äì2017) have lower and more variable volumes compared to recent years.\n\nConclusion:\nThis chart highlights both seasonal vaccination patterns and the impact of specific public health events, such as the elevated activity in 2020. Monitoring these trends over time supports planning for future vaccination campaigns and resource allocation.\n\nvacc_1524 %&gt;%\n  count(vacc_year, vacc_month_name) %&gt;%\n  ggplot(aes(x = vacc_month_name, y = n, group = vacc_year, fill = factor(vacc_year))) +\n  geom_area(alpha = 0.7, position = \"identity\") +\n  labs(title = \"Monthly Vaccination Trends by Year\",\n       x = \"Month\", y = \"Number of Vaccinations\", fill = \"Year\") +\n  theme_minimal()\n\n\n\n\n\n\n\n\nFaceted Plot ‚Äì Proportional Vaccination Trends by Group and Race\nDisplays how the proportion of vaccinations among different races changed across years, separately for each vaccine group.\nThe faceted line plot below shows how the proportion of vaccinations among different racial groups has changed over time (2015‚Äì2024), presented separately for each vaccine group: Childhood, Respiratory, and Other.\nKey Observations:\n\nChildhood vaccines:\n\n-   Proportions vary notably year to year, especially for **Asian**, **Black**, and **Native** groups.\n\n-   The **\"Other\"** and **White** groups show a more consistent presence but with modest fluctuations.\n\n-    Some groups (e.g., Native) show a steady rise in recent years.\n\n**Respiratory vaccines**:\n\n-    Several racial groups (notably **Native**, **Black**, and **Other**) show periods of very high proportions, including years where proportions reached **100%**, likely due to small subgroup sample sizes or data dominance.\n\n-    The **White** and **Asian** groups tend to remain stable, though proportions fluctuate in certain years (e.g., 2020‚Äì2022).\n\nOther vaccines:\n\n-   Representation is generally lower and more variable across all racial groups.\n\n-    The **White** group maintains a small but steady share throughout most years.\n\n**Interpretation:**\nThis faceted view enables comparisons within and between vaccine types, highlighting potential shifts in vaccine access, uptake, or data coverage by racial group over time. It also suggests where disparities or changes in focus may have occurred, helping to inform more equitable vaccination strategies.\n\n# Prepare data: floor year, count by group, compute proportions within each group\n\n# Clean and count total per race/year (for denominator)\ntotal_by_race_year &lt;- vacc_1524 %&gt;%\n  mutate(\n    age = as.integer(round(age)),\n    vacc_year = as.integer(floor(vacc_year)),\n    race = str_to_title(as.character(race))\n  ) %&gt;%\n  count(vacc_year, race, name = \"total_race_year\")\n\n#  Count per vaccine group (for numerator), then join\nvacc_plot_data &lt;- vacc_1524 %&gt;%\n  mutate(\n    age = as.integer(round(age)),\n    vacc_year = as.integer(floor(vacc_year)),\n    race = str_to_title(as.character(race))\n  ) %&gt;%\n  count(vacc_year, race, vacc_group3, name = \"n\") %&gt;%\n  left_join(total_by_race_year, by = c(\"vacc_year\", \"race\")) %&gt;%\n  mutate(prop = n / total_race_year)\n\n# Plot proportion by race within group\nggplot(vacc_plot_data, aes(x = vacc_year, y = prop, color = race)) +\n  geom_line(size = 1) +\n  facet_wrap(~ vacc_group3) +\n  scale_y_continuous(labels = percent_format()) +\n  scale_x_continuous(breaks = pretty(unique(vacc_plot_data$vacc_year))) +\n  labs(\n    title = \"Proportion of Race Within Vaccine Groups by Year\",\n    x = \"Year\", y = \"Proportion\", color = \"Race\"\n  ) +\n  theme_minimal() +\n  theme(axis.text.x = element_text(angle = 45, hjust = 1))\n\n\n\n\n\n\n\nrm(vacc_plot_data, total_by_race_year)\n\nStatistical Overlay ‚Äì Regression Line on Vaccination Age\nAdds a linear regression to examine the relationship between income and age at vaccination.\nThe scatterplot below visualizes the relationship between income (horizontal axis) and age at vaccination (vertical axis), with a linear regression line and confidence band overlaid to summarize the trend.\nKey Observations:\n\nThe fitted regression line shows a slight negative slope, suggesting that as income increases, the age at which individuals receive vaccination tends to decrease modestly.\nThe confidence band (shaded region) around the line is relatively narrow, indicating a fair level of certainty in the trend across the central range of income.\nThe majority of data points are concentrated in the lower income ranges, while higher income values are more sparsely populated and show greater variability.\n\n**Interpretation:**\nThis trend suggests a possible inverse relationship between income and vaccination age‚Äîindividuals with higher income may be more likely to receive vaccines at younger ages. This could reflect differences in healthcare access, awareness, or proactive health behaviors associated with income level.\n\nvacc_1524 %&gt;%\n  ggplot(aes(x = income, y = age)) +\n  geom_point(alpha = 0.3, color = \"gray50\") +\n  geom_smooth(method = \"lm\", se = TRUE, color = \"blue\") +\n  labs(\n    title = \"Association Between Income and Age at Vaccination\",\n    x = \"Income\", y = \"Age\"\n  ) +\n  theme_minimal()\n\n`geom_smooth()` using formula = 'y ~ x'\n\n\n\n\n\n\n\n\n\nRegression Plot ‚Äì Age vs Income by Vaccine Group (Log Scale)\nAdds linear regression and facets by vaccine group. The x-axis is log-scaled to handle skewed income data.\nThe plot below shows scatterplots with linear regression lines, examining the relationship between income and age at vaccination. The plots are faceted by vaccine group: Childhood, Other, and Respiratory. The x-axis uses a logarithmic scale to better handle the skewed distribution of income.\nKey Observations:\n\nChildhood vaccines:\n\n-    A **slight negative trend** is observed, indicating that as income increases, age at vaccination tends to decrease slightly.\n\n-    This may reflect earlier or more timely vaccinations among higher-income individuals for childhood vaccines.\n\nOther vaccines:\n\n-   The regression line is nearly flat with a wide confidence interval, suggesting **no strong or consistent relationship** between income and age at vaccination in this group.\n\n-    This likely reflects diverse vaccine purposes and use across a broad age and income range.\n\nRespiratory vaccines:\n\n-   A **mild negative trend** is also seen here, where higher-income individuals may receive respiratory vaccines at slightly younger ages.\n\n-    However, the relationship is subtle and the confidence interval overlaps considerably with the regression line.\n\n**Interpretation:**\nWhile the strength of association varies across groups, both the childhood and respiratory vaccine panels suggest a small trend where higher income is associated with younger age at vaccination. This may be related to differences in access, preventive health behaviors, or healthcare utilization by income level.\n\nvacc_1524 %&gt;%\n  mutate(vacc_group3 = str_to_title(vacc_group3)) %&gt;%\n  ggplot(aes(x = income, y = age)) +\n  geom_point(alpha = 0.3, color = \"gray50\") +\n  geom_smooth(method = \"lm\", se = TRUE, color = \"blue\") +\n  scale_x_log10(labels = scales::comma_format()) +\n  facet_wrap(~ vacc_group3) +\n  labs(\n    title = \"Association Between Income and Age at Vaccination\",\n    x = \"Income (log scale)\", y = \"Age\"\n  ) +\n  theme_minimal()\n\n`geom_smooth()` using formula = 'y ~ x'\n\n\n\n\n\n\n\n\n\nECDF ‚Äì Age at Vaccination\nThe empirical cumulative distribution function (ECDF) shows the proportion of individuals vaccinated at or below each age. This helps visualize the age distribution in a cumulative way.\nThe plot below presents shows the cumulative proportion of individuals who received a vaccination at or below each age.\nKey Observations:\n\nThe curve rises steeply in the early age range, indicating that a large proportion of individuals were vaccinated at younger ages (e.g., before 30).\nBy around age 50, approximately 80% of individuals had been vaccinated.\nThe curve flattens out after age 75, suggesting fewer vaccinations occur at older ages.\n\nInterpretation:\nThe ECDF provides an intuitive way to understand the distribution of vaccination ages. It highlights that most vaccinations occur in childhood and early adulthood, with fewer individuals vaccinated later in life. This cumulative view complements histograms and boxplots by showing the proportion of individuals affected up to each age.\n\nvacc_1524 &lt;- vacc_1524 %&gt;% filter(income &gt; 0, !is.na(age))\n\nvacc_1524 %&gt;%\n  ggplot(aes(x = age)) +\n  stat_ecdf(geom = \"step\", color = \"steelblue\") +\n  labs(title = \"ECDF of Age at Vaccination\", x = \"Age\", y = \"Cumulative Proportion\") +\n  theme_minimal()\n\n\n\n\n\n\n\n\nTreemap ‚Äì Vaccination by Race and Vaccine Group\nThis treemap visualizes the distribution of vaccinations by race and vaccine group. Larger areas indicate more individuals within each combination.\nThe treemap below displays the distribution of vaccinations across racial groups, further categorized by vaccine group (Childhood, Respiratory, and Other). Each rectangle represents a combination of race and vaccine type, with area size corresponding to the number of individuals vaccinated.\nKey Observations:\n\nThe White population accounts for the largest share overall, with:\n\n-    **788 individuals (50.7%)** in the **Respiratory** vaccine group.\n\n-    **404 individuals (26.0%)** in the **Childhood** vaccine group.\n\n-    **114 individuals (7.3%)** in the **Other** vaccine group.\n\nOther racial groups have smaller shares:\n\n-    **Black** individuals make up a modest proportion across groups, particularly **4.5%** in the Respiratory group and **1.4%** in Childhood vaccines.\n\n-    **Asian** individuals represent **4.4%** of Respiratory vaccines and **2.1%** of Childhood vaccines.\n\n-    **Native** and **Other** groups have minimal representation overall.\n\n**Interpretation:**\nThis treemap visually emphasizes the dominant contribution of the White population across all vaccine types, especially for respiratory vaccines. It also illustrates disparities in representation among racial groups, which can be important for assessing equity in vaccine access, uptake, and program targeting.\n\n# Cross-platform ‚Äúnew device‚Äù:\ndev.new(width = 8, height = 6)  \n\np &lt;- vacc_1524 %&gt;%\n  count(race, vacc_group3) %&gt;%\n  mutate(race = str_to_title(race)) %&gt;%\n  ggplot(aes(area = n, fill = vacc_group3, label = race)) +\n  geom_treemap() +\n  geom_treemap_text(colour = \"white\", place = \"centre\", grow = TRUE) +\n  labs(\n    title = \"Treemap: Vaccination by Race and Vaccine Group\",\n    fill  = \"Vaccine Group\"\n  ) +\n  theme_minimal()\n\nprint(p)\n\nrm (p)\n\n\n#  Treemap - with Labels Showing Counts and Proportions by Race and vaccine Group\nvacc_1524 %&gt;%\n  count(race, vacc_group3) %&gt;%\n  mutate(\n    race = str_to_title(race),\n    total = sum(n),\n    proportion = n / total,\n    label_text = paste0(race, \"\\n\", n, \" (\", percent(proportion, accuracy = 0.1), \")\")\n  ) %&gt;%\n  ggplot(aes(area = n, fill = vacc_group3, label = label_text)) +\n  geom_treemap() +\n  geom_treemap_text(colour = \"white\", place = \"centre\", grow = TRUE, reflow = TRUE) +\n  labs(\n    title = \"Treemap: Vaccination by Race and Vaccine Group\",\n    fill = \"Vaccine Group\"\n  ) +\n  theme_minimal()\n\n\n\n\n\n\n\n\nCorrelation Heatmap ‚Äì Numeric Variables\nThis heatmap displays Pearson correlation coefficients between selected numeric variables. Strong positive or negative values help identify relationships worth further analysis.\nThe heatmap below displays Pearson correlation coefficients between selected numeric variables: age, income, healthcare expenses, and healthcare coverage. Correlation values range from -1 to 1, where values closer to ¬±1 indicate stronger relationships.\nKey Observations:\n\nAge and healthcare coverage show a strong positive correlation (0.65), suggesting that as individuals age, they are more likely to have greater healthcare coverage.\nAge and healthcare expenses are also positively correlated (0.66), indicating that older individuals tend to incur higher healthcare costs.\nHealthcare coverage and healthcare expenses show a moderate positive correlation (0.44), which may reflect that those with more coverage also utilize healthcare services more frequently or thoroughly.\nIncome is not strongly correlated with any other variable in this set, with the highest being a negligible 0.02 with healthcare coverage and a slightly negative value with age (-0.04) and expenses (-0.05).\n\n**Interpretation:**\nThis heatmap highlights potential relationships that may inform further analysis‚Äîespecially the connections between age, coverage, and expenses. In contrast, income appears relatively independent of the other variables in this dataset.\n\nnumeric_vars &lt;- vacc_1524 %&gt;%\n  select(age, income, healthcare_expenses, healthcare_coverage) %&gt;%\n  na.omit()\n\ncor_matrix &lt;- round(cor(numeric_vars), 2)\n\nas.data.frame(as.table(cor_matrix)) %&gt;%\n  rename(Var1 = Var1, Var2 = Var2, Correlation = Freq) %&gt;%\n  ggplot(aes(x = Var1, y = Var2, fill = Correlation)) +\n  geom_tile(color = \"white\") +\n  geom_text(aes(label = Correlation), color = \"black\") +\n  scale_fill_gradient2(low = \"red\", high = \"blue\", mid = \"white\", midpoint = 0) +\n  labs(title = \"Correlation Heatmap of Numeric Variables\", x = NULL, y = NULL) +\n  theme_minimal()\n\n\n\n\n\n\n\n\nRidgeline Plot ‚Äì Age by Vaccine Group\nThis ridgeline plot shows the age distribution for each vaccine group. It highlights where age densities differ across categories.\nThe ridgeline plot below shows age distributions for three vaccine groups: Childhood, Other, and Respiratory. Each layer represents the density of ages within a vaccine category, allowing for visual comparison of where individuals are most commonly vaccinated within each group.\nKey Observations:\n\nChildhood vaccines show a clear peak at very young ages, as expected. The density drops rapidly as age increases, with a small secondary bump around middle age, possibly reflecting catch-up vaccinations or data irregularities.\nOther vaccines have a bimodal distribution with one peak in younger adults and another in older adults (around 70+ years), suggesting they are used across multiple life stages.\nRespiratory vaccines have a broad distribution, with a peak density around 60‚Äì70 years, consistent with routine respiratory vaccinations for older adults (e.g., influenza or pneumococcal vaccines).\n\n**Interpretation:**\nThis visualization effectively highlights differences in age targeting across vaccine groups. It shows that:\n\nChildhood vaccines are concentrated in early life,\nOther vaccines are used more broadly across age ranges, and\nRespiratory vaccines are predominantly administered to older populations.\n\n\nvacc_1524 %&gt;%\n  mutate(vacc_group3 = stringr::str_to_title(vacc_group3)) %&gt;%\n  ggplot(aes(x = age, y = vacc_group3, fill = vacc_group3)) +\n  geom_density_ridges(scale = 1.5, alpha = 0.6, color = \"white\") +\n  labs(title = \"Ridgeline Plot: Age Distribution by Vaccine Group\", x = \"Age\", y = \"Vaccine Group\") +\n  theme_minimal() +\n  theme(legend.position = \"none\")\n\nPicking joint bandwidth of 5.93\n\n\n\n\n\n\n\n\n\nInteractive Plot ‚Äì Income vs Age by Race\nThis interactive scatter plot shows the relationship between income and age, colored by race. Hovering reveals more details including group and income.\n\np &lt;- vacc_1524 %&gt;%\n  mutate(race = stringr::str_to_title(race)) %&gt;%\n  ggplot(aes(x = income, y = age, color = race,\n             text = paste(\"Race:\", race,\n                          \"&lt;br&gt;Group:\", vacc_group3,\n                          \"&lt;br&gt;Income:\", income,\n                          \"&lt;br&gt;Age:\", age))) +\n  geom_point(alpha = 0.6) +\n  geom_smooth(method = \"loess\", se = FALSE, color = \"gray30\") +\n  labs(title = \"Interactive: Income vs Age by Race\",\n       x = \"Income\", y = \"Age\", color = \"Race\") +\n  theme_minimal() +\n  theme(legend.position = \"bottom\")\n\nggplotly(p, tooltip = \"text\")\n\n`geom_smooth()` using formula = 'y ~ x'\n\n\n\n\n\nrm(p)\n\nAnimation ‚Äì Vaccination Trends Over Years\nThis animation shows how vaccination counts across vaccine groups change over time. It helps spot temporal trends and emerging patterns.\n\nanim_plot &lt;- vacc_1524 %&gt;%\n  mutate(vacc_year = as.integer(floor(vacc_year))) %&gt;%\n  count(vacc_year, vacc_group3) %&gt;%\n  ggplot(aes(x = vacc_group3, y = n, fill = vacc_group3)) +\n  geom_col(show.legend = FALSE) +\n  labs(title = 'Year: {frame_time}', x = 'Vaccine Group', y = 'Count') +\n  theme_minimal() +\n  transition_time(vacc_year) +\n  ease_aes('linear')\n\nanim_file &lt;- tempfile(fileext = \".gif\")\nanim &lt;- animate(anim_plot, nframes = 100, fps = 10, renderer = gifski_renderer(anim_file))\nprint(anim)\n\nrm(anim_plot, anim_file, anim)\n\nAnimation ‚Äì Breast Cancer Screening Uptake by State\nThis animated bar chart shows breast cancer screening uptake over time for each Australian state. It uses faceting to compare regional trends.\n\nbreast_anim &lt;- breast_cancer_data %&gt;%\n  filter(!state %in% c(\"Other\", \"Unknown\")) %&gt;%\n  mutate(year_4digit = as.integer(year_4digit)) %&gt;%\n  group_by(state, year_4digit) %&gt;%\n  summarise(total_screened = sum(part50_74, na.rm = TRUE), .groups = \"drop\") %&gt;%\n  ggplot(aes(x = year_4digit, y = total_screened, fill = state)) +\n  geom_col(show.legend = FALSE) +\n  facet_wrap(~ state) +\n  labs(title = 'Year: {frame_time}', x = 'Year', y = 'Women Screened (50‚Äì74 yrs)') +\n  theme_minimal() +\n  transition_time(year_4digit) +\n  ease_aes('linear')\n\nscreening_gif &lt;- tempfile(fileext = \".gif\")\nanim_screen &lt;- animate(breast_anim, nframes = 100, fps = 10, renderer = gifski_renderer(screening_gif))\nprint(anim_screen)\n\nrm(breast_anim, screening_gif, anim_screen)\n\n\n\n\nHeatmap ‚Äì Number of Vaccinations by Month and Weekday Highlights vaccination activity patterns by day of week and month. Darker tiles represent higher counts.\nThe heatmap below demonstrates the number of vaccinations administered across each day of the week and each calendar month. Color intensity indicates the relative number of vaccinations, with darker red representing higher uptake and pale yellow representing lower activity.\nKey Observations:\n\nSaturday consistently shows high uptake, particularly in October, September, and July, suggesting that weekends may be more accessible or preferred for vaccination appointments.\nTuesday in May and Wednesday in August also show pronounced peaks, likely linked to specific campaign efforts or seasonal programs.\nThursday and Friday generally have moderate activity, while Sunday and Monday tend to have lower vaccination counts across most months.\nOverall, the summer and early fall months (July to October) show increased uptake across several weekdays, possibly aligning with back-to-school vaccination drives or respiratory vaccine rollouts.\n\n**Interpretation:**\nThe plot reveals both seasonal and weekly rhythms in vaccination behavior. Recognizing these patterns can guide better scheduling of clinics, resource planning, and public messaging to align with high-demand periods and improve overall vaccine accessibility.\n\n# ................Without  Adding the long Title ........................................................\n# ..............................................................................................\n\n# --- Order weekday and month factors for proper axis display ---\n# --- Convert original vaccination date to Eastern Time (Massachusetts local time) ---\n# Assumes vacc_date is POSIXct or character in UTC or local system time\nvacc_1524 &lt;- vacc_1524 %&gt;%\n  mutate(\n    vacc_datetime_et = with_tz(as.POSIXct(vacc_date, tz = \"UTC\"), tzone = \"America/New_York\"),  # Adjust timezone to Eastern Time\n    vacc_weekday = wday(vacc_datetime_et, label = TRUE, abbr = FALSE),                          # Extract weekday (e.g., Monday)\n    vacc_month_name = month(vacc_datetime_et, label = TRUE, abbr = FALSE)                       # Extract month (e.g., January)\n  )\n\n# --- Order weekday and month factors for proper axis display ---\nvacc_1524 &lt;- vacc_1524 %&gt;%\n  mutate(\n    vacc_month_name = factor(vacc_month_name, levels = month.name),  # Ensure months are in calendar order\n    vacc_weekday = factor(vacc_weekday, levels = c(\"Monday\", \"Tuesday\", \"Wednesday\", \"Thursday\", \"Friday\", \"Saturday\", \"Sunday\"))  # Ensure weekdays are in logical order\n  )\n\n# --- Create heatmap of vaccination counts by weekday and month ---\nvacc_1524 %&gt;%\n  count(vacc_weekday, vacc_month_name) %&gt;%  # Count number of vaccinations by weekday and month\n  ggplot(aes(x = vacc_weekday, y = vacc_month_name, fill = n)) +     # Map weekday to x-axis, month to y-axis, and fill by count\n  geom_tile(color = \"white\") +                                       # Draw heatmap tiles with white border for readability\n  scale_fill_gradientn(                                              # Use custom yellow-to-red color scale\n    colors = c(\"#ffffcc\", \"#ffeda0\", \"#feb24c\", \"#f03b20\", \"#bd0026\"),\n    breaks = scales::pretty_breaks(n = 5),                           # Auto-select 5 good breakpoints for legend\n    name = \"Vaccinated Number\"                                       # Legend title\n  ) +\n  labs(\n    title = \"Vaccination Uptake by Weekday and Month\",               # Plot title\n    subtitle = \"Timestamps interpreted as US Eastern Time (Massachusetts)\",  # Timezone context\n    x = \"Weekday\", y = \"Month\", fill = \"Vaccinated Number\",          # Axis and legend labels\n    caption = \"Note: Original timestamps converted from UTC to America/New_York\"\n  ) +\n  theme_minimal() +\n  theme(\n    text = element_text(family = \"Times New Roman\"),                 # Font style\n    legend.position = \"bottom\",                                      # Move legend below the plot\n    axis.text.x = element_text(angle = 45, hjust = 1, size = 10, face = \"bold\"),  # X-axis label formatting\n    axis.text.y = element_text(size = 10, face = \"bold\"),            # Y-axis label formatting\n    axis.title.x = element_text(face = \"bold\", size = 11),\n    axis.title.y = element_text(face = \"bold\", size = 11),\n    plot.title = element_text(size = 12, face = \"bold\"),\n    legend.title = element_text(size = 10),\n    legend.text = element_text(size = 8)\n  )\n\n\n\n\n\n\n\n# Use figure title below to render in Quarto or Rmarkdown \n#\"Figure XX: Vaccination uptake by weekday and month among individuals aged 15‚Äì24, 2016‚Äì2024.\"\n\n\n# ................Adding the long Title ........................................................\n# ..............................................................................................\n\n# --- Convert original vaccination date to Eastern Time (Massachusetts local time) ---\n# Assumes vacc_date is POSIXct or character in UTC or local system time\nvacc_1524 &lt;- vacc_1524 %&gt;%\n  mutate(\n    vacc_datetime_et = with_tz(as.POSIXct(vacc_date, tz = \"UTC\"), tzone = \"America/New_York\"),  # Adjust timezone to Eastern Time\n    vacc_weekday = wday(vacc_datetime_et, label = TRUE, abbr = FALSE),                          # Extract weekday (e.g., Monday)\n    vacc_month_name = month(vacc_datetime_et, label = TRUE, abbr = FALSE)                       # Extract month (e.g., January)\n  )\n\n# --- Order weekday and month factors for proper axis display ---\nvacc_1524 &lt;- vacc_1524 %&gt;%\n  mutate(\n    vacc_month_name = factor(vacc_month_name, levels = month.name),  # Ensure months are in calendar order\n    vacc_weekday = factor(vacc_weekday, levels = c(\"Monday\", \"Tuesday\", \"Wednesday\", \"Thursday\", \"Friday\", \"Saturday\", \"Sunday\"))  # Ensure weekdays are in logical order\n  )\n\n# --- Create heatmap of vaccination counts by weekday and month ---\np &lt;- vacc_1524 %&gt;%\n  count(vacc_weekday, vacc_month_name) %&gt;%  # Count number of vaccinations by weekday and month\n  ggplot(aes(x = vacc_weekday, y = vacc_month_name, fill = n)) +     # Map weekday to x-axis, month to y-axis, and fill by count\n  geom_tile(color = \"white\") +                                       # Draw heatmap tiles with white border for readability\n  scale_fill_gradientn(                                              # Use custom yellow-to-red color scale\n    colors = c(\"#ffffcc\", \"#ffeda0\", \"#feb24c\", \"#f03b20\", \"#bd0026\"),\n    breaks = scales::pretty_breaks(n = 5),                           # Auto-select 5 good breakpoints for legend\n    name = \"Vaccinated Number\"                                       # Legend title\n  ) +\n  labs(\n    title = \"Vaccination Uptake by Weekday and Month\",               # Plot title\n    x = \"Weekday\", y = \"Month\", fill = \"Vaccinated Number\"           # Axis and legend labels\n  ) +\n  theme_minimal() +\n  theme(\n    text = element_text(family = \"Times New Roman\"),                 # Font style\n    legend.position = \"bottom\",                                      # Move legend below the plot\n    axis.text.x = element_text(angle = 45, hjust = 1, size = 10, face = \"bold\"),  # X-axis label formatting\n    axis.text.y = element_text(size = 10, face = \"bold\"),            # Y-axis label formatting\n    axis.title.x = element_text(face = \"bold\", size = 11),\n    axis.title.y = element_text(face = \"bold\", size = 11),\n    plot.title = element_text(size = 12, face = \"bold\"),\n    legend.title = element_text(size = 10),\n    legend.text = element_text(size = 8)\n  )\n\n# --- Add descriptive figure caption using patchwork's plot_annotation() ---\nfinal_plot &lt;- p + plot_annotation(\n  caption = \"Figure XX: Vaccination uptake by weekday and month among individuals aged 15‚Äì24, 2016‚Äì2024.\",\n  theme = theme(\n    plot.caption = element_text(\n      size = 10, family = \"Times New Roman\", hjust = 0\n    )\n  )\n)\n\n# --- Display the final plot with caption ---\nfinal_plot\n\n\n\n\n\n\n\n# setwd (\"C:/Users/User/Desktop/Materials_ Course and proposals/VIP collection for Syntax code or project titles/R codes/Data Manipulation and Wrangling\")\n# \n# # Save plots\n# ggsave(\"Heatmap_vaccination_pattern by day and month.TIFF\", plot = last_plot(), device = \"tiff\", width = 10, height = 6, units = \"in\")\n# ggsave(\"Heatmap_vaccination_pattern by day and month.svg\", plot = last_plot(), device = \"svg\", width = 10, height = 6, units = \"in\")\n\nrm (p, final_plot)\n\n\n\n\n\n8.1 UI fluidPage(), sidebarLayout(), sidebarPanel(), mainPanel(), tabsetPanel(), tags$style()\n8.2 Server reactive(), observeEvent(), req(), renderPlotly(), renderDT(), modalDialog(), showModal()\n8.3 App Launch shinyApp(ui, server)\n8.4 Inputs sliderInput(), selectInput(), colourInput(), actionButton(), downloadButton()\n8.5 Outputs plotlyOutput(), DTOutput(), datatable(), formatStyle()\n8.6 DT Features extensions = 'Buttons', export options: copy, csv, excel, pdf, print\n8.7 Styling and Themes tags$style(), (shinythemes::shinytheme() ‚Äì loaded but not applied)\nShiny is a web application framework for R that allows analysts to build interactive dashboards and tools using familiar syntax. It provides a structured approach to turning R scripts into accessible apps for broader audiences.\nA typical Shiny app includes two core components:\n\nUI (User Interface): Defines layout, inputs, and outputs shown on the screen interface.\nServer: Contains the logic that processes data and responds to user interactions.\n\nShiny apps can include multiple views (tabs), export buttons, dynamic filtering, charts, and customized design themes.\n\n\n\n\nfluidPage(): Defines the page layout.\nsidebarLayout(), sidebarPanel(), mainPanel(): Organize inputs and outputs side-by-side.\ntabsetPanel(): Allows tab navigation for multi-page apps.\ntags$style(), shinythemes::shinytheme(): Add or apply custom styles/themes.\n\n\n\n\n\n\nreactive(): Creates reactive data or expressions.\nobserveEvent(): Executes code when a trigger changes.\nreq(): Validates necessary input before proceeding.\nOutput functions: renderPlotly(), renderDT(), renderText(), renderTable().\n\n\n\n\n\n\n\n\n\n\n\n\n\nType\nFunction\nPurpose\n\n\n\n\nInput\nsliderInput()\nSelect a numeric value or range\n\n\nInput\nselectInput()\nDropdown menu to choose a category\n\n\nInput\ncolourInput()\nSelect a color\n\n\nInput\nactionButton()\nTrigger processing on click\n\n\nInput\ndownloadButton()\nDownload output tables or data\n\n\nOutput\nplotlyOutput()\nRender interactive plots using Plotly\n\n\nOutput\nDTOutput(), datatable()\nRender interactive tables\n\n\nOutput\nformatStyle()\nApply styling (e.g., color, font) to tables\n\n\n\n\n\n\n\n\nAdd extensions = 'Buttons' to enable table exports.\nExport types: \"copy\", \"csv\", \"excel\", \"pdf\", \"print\".\n\n\n\n\n\n\nshinyApp(ui, server): Runs the Shiny app combining both UI and server logic.\nApps can be hosted on ShinyApps.io, internal servers, or embedded in R Markdown dashboards.\n\n\nThe Shiny app code below demonstrates how interactive visualizations can be built using R to present health data in an accessible and user-friendly format. Specifically, it explores breast cancer screening uptake across states, years, and age groups in Australia. The app enhances user engagement through customizable features and immediate feedback mechanisms.\nKey capabilities demonstrated include: - Dynamic UI generation using fluidPage(), sidebarLayout(), and interactive widgets - State selection using a dropdown (selectInput()), which scales better than radio buttons - Age group filtering with a multiple selection input - Quantile-based filtering with sliderInput() for rate grouping - Color customization of output using colourInput() for personalizing table aesthetics - A modal popup (modalDialog()) triggered by a help button to explain data sources - Export options via downloadButton() and DT export buttons for multiple file formats - Real-time data filtering using reactive() expressions to tailor output to user input - An interactive line plot rendered via plotly and ggplot2 for visualization - Fully styled, downloadable data table with DT::renderDT() and export capabilities\nSee the live app at the following platforms\n\nAnalyticsHub YouTube: https://studio.youtube.com/video/5V7SPBH-8BE/edit\nLive App: https://j9eu4e-habtamu-mellie0bizuayehu.shinyapps.io/Breast_Cancer_Screening_Shiny_App/\n\n\n# Install required packages if not already installed\nrequired_packages &lt;- c(\"shiny\", \"ggplot2\", \"plotly\", \"DT\", \"dplyr\", \"shinyjs\", \"shinyWidgets\", \"scales\", \"colourpicker\")\n\n# Install missing ones\nnew_packages &lt;- required_packages[!(required_packages %in% installed.packages()[,\"Package\"])]\nif(length(new_packages)) install.packages(new_packages)\n\n# Load packages\nlibrary(shiny)\nlibrary(ggplot2)\nlibrary(plotly)\nlibrary(DT)\nlibrary(dplyr)\nlibrary(shinyjs)\nlibrary(shinyWidgets)\nlibrary(scales)\nlibrary(colourpicker)\n\n\n# load the data\nload(\"C:/Users/User/Desktop/Materials_ Course and proposals/VIP collection for Syntax code or project titles/R codes/Shiny App BC Screening/Breast Cancer Screening.RData\")\n\n\n# -------------------Shiny Application for Breast Cancer Screening---------------------\n\n\n# ------------------- UI and Server Definition ---------------------\n\n# Define custom CSS for styling buttons and other UI elements\nui &lt;- fluidPage(\n  \n  # Application title displayed at the top of the app\n  h1(\"Breast Cancer Screening Uptake\"),\n\n  # Apply custom styling to the download button\n  tags$style(HTML(\"\n    #download_data {\n      background: orange;\n      font-size: 20px;\n    }\n  \")),  \n\n  # Layout structure: sidebar for inputs and main panel for outputs\n  sidebarLayout(\n    sidebarPanel(\n      \n      # Quantile-based slider to filter screening rate\n      sliderInput(\"rate_10_group\", \"Rate Group\", \n                  min = min(breast_cancer_long$rate_10_group, na.rm = TRUE), \n                  max = max(breast_cancer_long$rate_10_group, na.rm = TRUE), \n                  value = c(5, 7)),\n      \n      # Dropdown menu for state selection (simplifies and scales better than radio buttons)\n      selectInput(\"state\", \"Select State\",  \n                  choices = unique(breast_cancer_long$state), \n                  selected = \"WA\"),\n\n      # Multi-select dropdown for age groups (allows viewing multiple demographics)\n      selectInput(\"age_group\", \"Women's Age Group\", \n                  choices = unique(breast_cancer_long$age_group), \n                  multiple = TRUE,\n                  selected = unique(breast_cancer_long$age_group)[1]),\n\n      # Add colour input to allow users to control table font colour\n      colourInput(\"color\", \"Point color\", value = \"blue\"),\n\n      # Add a help button that triggers a modal popup for guidance\n      actionButton(\"show_help\", \"Help\"),\n\n      # Add a download button for exporting filtered dataset\n      downloadButton(\"download_data\", \"Download Data\")\n    ),\n\n    mainPanel(\n      # Render the interactive line chart\n      plotlyOutput(\"plot\"),\n\n      # Render the data table output\n      DTOutput(\"table\")\n    )\n  )\n)\n\n# Define server-side logic for rendering outputs and interactivity\nserver &lt;- function(input, output, session) {\n\n  # Show Help Modal: explains data source when help button is clicked\n  observeEvent(input$show_help, {\n    showModal(modalDialog(\n      title = \"Help\",\n      \"This data was compiled from the Australian Institute of Health and Welfare.\"\n    ))\n  })\n\n  # Reactive expression to filter and summarize the dataset based on inputs\n  filtered_data &lt;- reactive({\n    req(input$rate_10_group, input$state, input$age_group)  # Ensure all inputs are available\n\n    breast_cancer_long %&gt;%\n      filter(rate_10_group &gt;= input$rate_10_group[1] & \n               rate_10_group &lt;= input$rate_10_group[2],\n             state == input$state,\n             age_group %in% input$age_group) %&gt;%\n      group_by(year, state, age_group) %&gt;%\n      summarise(year = as.integer(year),  # Convert year to integer for plotting\n                rate = round(mean(rate, na.rm = TRUE), 1),  # Average screening rate\n                .groups = \"drop\") \n  })\n\n  # Render Table: displays filtered data in an interactive table with export options\n  output$table &lt;- renderDT({\n    datatable(filtered_data(), \n              options = list(\n                pageLength = 10,  # Show 10 rows per page\n                dom = 'Bfrtip',  # Include Buttons (copy, csv, pdf, etc.)\n                buttons = c('copy', 'csv', 'excel', 'pdf', 'print'),\n                class = \"display nowrap compact\"  # Responsive and compact table design\n              ),\n              extensions = 'Buttons',\n              style = \"bootstrap\", \n              class = \"table table-striped table-bordered\") %&gt;%\n      formatStyle(columns = names(filtered_data()), color = input$color)  # Use selected color\n  })\n\n  # Download Handler: enables users to download filtered data\n  output$download_data &lt;- downloadHandler(\n    filename = \"Breast_cancer_screening_data.csv\",\n    content = function(file) {\n      write.csv(filtered_data(), file, row.names = FALSE)\n    }\n  )\n\n  # Render Plot: displays line plot of screening rates over time by age group\n  output$plot &lt;- renderPlotly({\n    df &lt;- filtered_data()\n\n    p &lt;- ggplot(df, aes(x = year, y = rate, color = age_group, group = interaction(state, age_group))) +\n      geom_line(size = 1) +  # Draw lines to show trend\n      geom_point(size = 3) +  # Add points to emphasize data values\n      labs(title = \"Breast Cancer Screening Uptake\", \n           x = \"Year\", \n           y = \"Screening Rate\",\n           color = \"Age Group\") +\n      theme_minimal()\n\n    ggplotly(p)  # Convert ggplot to interactive plotly chart\n  })\n}\n\n# Launch the app\nshinyApp(ui, server)"
  },
  {
    "objectID": "Post_Blog/Visualisations/index_original.html#part-i-foundations-and-introduction",
    "href": "Post_Blog/Visualisations/index_original.html#part-i-foundations-and-introduction",
    "title": "Date Manipulation and Wrangling using R",
    "section": "",
    "text": "This section will cover the following contents\n- Installing R and RStudio\n- Setting working directories\n- Clearing environment and console\n- Installing and loading packages (eg tidyverse, janitor, etc.)\n\nInstalling R and RStudio\n\nWhen we begin working with R, the very first step we take is installing two important tools: R itself (the engine) and RStudio (the friendly interface we use every day). I recommend that we install R first and then RStudio immediately after.\nTo make this clear, I have prepared a complete video tutorial that you can watch step-by-step:\nWathc at AnalyticsHub YouTube\nThe video, shows:\n\nHow to Download R from the CRAN website.\nInstall RStudio, which gives us a powerful yet simple environment to work in.\nBriefly explore basic options like font size, theme (dark/light mode), and code editor settings to make RStudio comfortable for coding.\nSetting working directories\nWhen we work in R, it‚Äôs very important that we know where R is reading from and saving to.\nI often think of the working directory as the ‚Äúhome folder‚Äù where all my files live during an R session.\nWe can easily check our current working directory by typing:\n\ngetwd() \n\n[1] \"C:/Users/User/Desktop/Materials_ Course and proposals/VIP collection for Syntax code or project titles/R codes/Website profile Mod 2/Post_Blog/Visualisations\"\n\n\n\nThis command tells us exactly where R is currently looking for files.\nIf we want to change the working directory to a folder we are working on (for example, a project folder or a course material folder), we can use:\n\nsetwd(\"C:/Users/User/Desktop/Materials_ Course and proposals/\")\n\nAlways make sure the folder path is in quotation marks and I use forward slashes / or double backslashes \\\\ when typing the path.\nüìå We can also set the working directory easily by clicking:\n\nSession ‚ûî Set Working Directory ‚ûî Choose Directory‚Ä¶\n\nüìö Note about API tokens and special folders:\nIf you are using R for connecting to APIs, cloud storage, or services like GitHub, Dropbox, or Google Drive,\nsometimes you will need to set a working directory where your API token file is stored (for authentication).\n\nsetwd(\"C:/Users/YourName/.credentials/\") \n\n‚ö†Ô∏è Important: Always make sure API tokens and confidential files are in a secure private directory.\n\nClearing environment and console\n\n# Clear environment and console\nrm(list = ls()) # To clear the environment (remove all objects in memory)\ncat(\"\\014\") # To clear the console (like wiping a whiteboard)\n\n\nBefore starting fresh in any R session, I like to clear out everything‚Äîall variables, data, and even the clutter in the console.\nInstalling and loading packages\nWe rely on a range of packages in R for data wrangling, visualization, dashboards, and reporting.\nI typically create a vector of required packages and write a small loop to install any missing ones.\n\n\n# ------------------ Set CRAN Repository ------------------\n\noptions(repos = c(CRAN = \"https://cran.rstudio.com\"))\n\n# ------------------ List of required packages for Data Wrangling and Analysis ------------------\npackages &lt;- c(\n  \"lubridate\", \"dplyr\", \"stringr\", \"zoo\", \"tsibble\", \"ggplot2\", \"plotly\", \n  \"readr\", \"readxl\", \"haven\", \"openxlsx\", \"labelled\", \"forecast\",\n  \"prettydoc\", \"janitor\", \"knitr\", \"rmarkdown\", \"yaml\", \n  \"flextable\", \"scales\", \"gt\", \"reactable\", \"DT\", \"gmodels\", \"Hmisc\",\n  \"tidyverse\", \"tidyr\", \"officer\",\n  \"shiny\", \"shinydashboard\", \"shinythemes\", \"mice\", \"shinyWidgets\", \"bslib\", \"quarto\"\n)\n\n# ------------------ Install and load packages ------------------\nfor (pkg in packages) {\n  if (!require(pkg, character.only = TRUE)) {\n    install.packages(pkg)\n  }\n}\n\n# ------------------ Load required libraries with descriptions ------------------\nlibrary(lubridate)     # Simplifies the manipulation of dates and times in R (e.g., formatting, extracting components)\nlibrary(dplyr)         # Data manipulation: filtering, summarizing, and transforming data\nlibrary(stringr)       # Simplifies string manipulation\nlibrary(tidyr)         # Data tidying: reshaping with pivot_longer, pivot_wider, etc.\nlibrary(purrr)         # Functional programming: map functions over lists/vectors\nlibrary(forcats)       # Categorical data: reordering and labeling factor levels\n\nlibrary(zoo)           # Infrastructure for time series objects\nlibrary(tsibble)       # Tidy temporal data frames and time series modeling\nlibrary(forecast)      # Forecasting functions for time series models\n\nlibrary(readr)         # Read rectangular data like CSVs\nlibrary(readxl)        # Read Excel files (.xls and .xlsx)\nlibrary(haven)         # Import data from SAS, SPSS, and Stata\nlibrary(openxlsx)      # Write to Excel with more control\nlibrary(labelled)      # Attach and work with variable labels\n\nlibrary(ggplot2)       # Create elegant data visualizations using the grammar of graphics\nlibrary(plotly)        # Interactive visualizations using ggplot2 or standalone plotly\nlibrary(scales)        # Provides scale functions for ggplot2 (e.g., log, percent)\n\nlibrary(janitor)       # Clean data: make column names nice, tabulate, etc.\nlibrary(gmodels)       # CrossTables and other classic stats tools\nlibrary(Hmisc)         # Summarization and advanced table/label handling\nlibrary(mice)           # missing data imputation\n\nlibrary(knitr)         # Dynamic report generation in R\nlibrary(rmarkdown)     # Convert R scripts to reports in various formats\nlibrary(prettydoc)     # Beautiful HTML document templates\nlibrary(yaml)          # Read and write YAML files (used in R Markdown, Quarto)\nlibrary(officer)       # Export tables and reports to Word/PowerPoint\n\nlibrary(flextable)     # Create nicely formatted tables\nlibrary(gt)            # Grammar of tables for HTML and PDF output\nlibrary(reactable)     # Interactive data tables\nlibrary(DT)            # Wrapper of JavaScript DataTables for R\n\nlibrary(shiny)         # Build interactive web applications directly from R\nlibrary(shinydashboard)# Create dashboard layouts for Shiny apps\nlibrary(shinythemes)   # Prebuilt UI themes for Shiny apps\nlibrary(shinyWidgets)  # Enhanced UI widgets for Shiny\nlibrary(bslib)         # Bootstrap themes for Shiny and rmarkdown\n\nlibrary(quarto)        # Rendering Quarto documents\n\n\n\n\n\nOperators: &lt;-, %&gt;%, ==, &, |, ~\nAdditional Operators: %in%, ::, %&lt;&gt;%, |&gt;\nSymbols: (), [], {}, \"\", #\nCommenting, structure, and help functions (?function, args())\nUsing R scripts vs.¬†R Markdown vs.¬†Quarto\n\nIn this section, we walk through the fundamental syntax building blocks of R.\nMastering these basics helps write cleaner, more efficient, and more readable code.\nüîπ Operators\nIn R, operators are used to perform operations on objects and values:\n\nAssignment operators (&lt;-, =) store values into objects.\nPipe operators (%&gt;%, %&lt;&gt;%, |&gt;) allow chaining multiple commands together.\nComparison operators (==, !=, &lt;, &gt;) compare values for equality or relational logic.\nLogical operators (&, |, !) build logical expressions (AND, OR, NOT).\nFormula operator (~) defines models and formulas, e.g., y ~ x1 + x2.\nMembership operator (%in%) checks whether an element belongs to a set.\nPackage access operator (::) calls a function from a package without loading the full package.\n\nüîπ Symbols\nSymbols are special characters used in structuring R code:\n\n() : Used for function calls and setting arguments.\n[] : Indexing vectors, matrices, or data frames.\n{} : Grouping multiple expressions into a code block.\n\"\" or '' : Define character strings.\n# : Create comments that are ignored during code execution.\n\nüîπ Help Functions\n\n?function_name : Access the help documentation for any function.\nargs(function_name) : Display the arguments a function accepts.\nüîπ Scripting in .R, .Rmd, .qmd\n\n\n\n\n\n\n\n\nFormat\nDescription\nBest Use Case\n\n\n\n\n.R\nBasic R script. Contains code only, no formatting or output.\nExploratory coding, testing snippets\n\n\n.Rmd\nR Markdown file. Supports code + text + output in one file.\nReproducible reports, presentations, notebooks\n\n\n.qmd\nQuarto document. Successor to R Markdown with more flexible publishing.\nPolished reports, web publishing, multi-language\n\n\n\n\nüìä R Syntax Essentials Summary\n\n\n\n\n\n\n\n\nElement\nSymbol / Syntax\nWhat It Does\n\n\n\n\nAssignment\n&lt;-, =\nAssign a value to a variable (e.g., x &lt;- 5)\n\n\nPipe\n%&gt;%, %&lt;&gt;%, |&gt;\nPass or transform results between functions\n\n\nComparison\n==, !=, &lt;, &gt;\nCompare values (equal, not equal, less than, etc.)\n\n\nLogical\n&, |, !\nLogical conditions: AND, OR, NOT\n\n\nFormula\n~\nDefine model formulas (e.g., y ~ x1 + x2)\n\n\nMembership Test\n%in%\nCheck if an element exists within a vector\n\n\nPackage Function Access\n::\nCall a function from a specific package without loading it\n\n\nFunction Call\n()\nCall a function with arguments (e.g., mean(x))\n\n\nIndexing\n[]\nAccess parts of data structures (e.g., x[1], df[2,3])\n\n\nCode Block\n{}\nGroup multiple lines (loops, conditionals)\n\n\nStrings\n\"text\", 'text'\nDefine character strings\n\n\nCommenting\n#\nInsert a comment ignored by R\n\n\nHelp Functions\n?function, args(function)\nAccess help or check function arguments\n\n\nOutput Format\n.R, .Rmd, .qmd\nFile formats for scripting or reporting\n\n\n\n?mean # Opens the help page for the ‚Äòmean‚Äô function\nargs(mean) # Lists input arguments for ‚Äòmean‚Äô\n\n\n\nIn this section, I highlight essential RStudio shortcut keys that improve coding efficiency and simplify the workflow for scripting and reporting.\n\n\n\nShortcut\nAction\n\n\n\n\nCtrl + Z\nUndo the last action\n\n\nCtrl + Shift + Z\nRedo the undone action\n\n\nCtrl + Enter\nExecute the current line or selected block\n\n\nAlt + -\nInsert assignment operator &lt;-\n\n\nCtrl + Shift + M\nInsert pipe operator %&gt;%\n\n\nCtrl + L\nClear the console output\n\n\nCtrl + Shift + C\nComment or uncomment selected lines\n\n\nCtrl + Shift + S\nSource and run the entire script\n\n\nCtrl + Alt + I\nInsert a new R Markdown or Quarto code chunk\n\n\n\n\n\n\n\nElement | Vector | Matrix | |Data Frame | Data Table | List | Factor | Variable | Object\nThis section provides a brief overview of foundational R data structures.\nFor more detailed explanations and demonstrations, refer to:\n\nYouTube: AnalyticsHub\nGitHub: HabtamuBizuayehu Repositories\n\nUnderstanding these fundamental terms is essential for working effectively with R data analysis and wrangling.\nüîπ Brief Narration of Key Terms\n\nElement: A single piece of data, such as a number or a character.\nVector: An ordered collection of elements of the same type (numeric, character, logical).\nMatrix: A two-dimensional collection of elements arranged by rows and columns, all of the same type.\nData Frame: A two-dimensional table where each column can contain different types of data (numeric, character, factor).\nData Table: A high-performance extension from the data.table package ‚Äî for very large datasets and faster manipulation.\nList: A flexible container that can hold elements of different types and structures (vectors, data frames, even other lists).\nFactor: A special type of vector used for categorical data, storing levels internally.\nVariable: A named object that holds data (vectors, lists, data frames, etc.).\nObject: A general term for any data structure stored in R.\n\n\nüîç Summary Table: R Objects\n\n\n\n\n\n\n\nTerm\nDefinition\n\n\n\n\nElement\nA single unit of data (e.g., 5, \"apple\")\n\n\nVector\nA sequence of elements of the same type\n\n\nMatrix\nA two-dimensional collection of homogeneous elements\n\n\nData Frame\nA two-dimensional table with heterogeneous column types\n\n\nData Table\nA fast and memory-efficient data frame extension (data.table package)\n\n\nList\nA flexible container for different types of elements\n\n\nFactor\nA categorical variable with predefined levels\n\n\nVariable\nA named object that stores data\n\n\nObject\nAny entity stored in R (data, functions, models, etc.)\n\n\n\n\n\n\nThis section summarizes key chunk options and syntax used in Quarto and R Markdown.\nThese settings allow flexible control over code execution, output display, figure formatting, and reporting behavior."
  },
  {
    "objectID": "Post_Blog/Visualisations/index_original.html#summary-quarto-and-r-markdown-chunk-options",
    "href": "Post_Blog/Visualisations/index_original.html#summary-quarto-and-r-markdown-chunk-options",
    "title": "Date Manipulation and Wrangling using R",
    "section": "",
    "text": "Feature\nQuarto Syntax\nDescription\n\n\n\n\nCode Chunks\n{r}\nUsed to write and execute R code. You can specify options like echo, results.\n\n\nEchoing Code\necho: true\nDisplays the code in the output (default is true). Set to false to hide the code.\n\n\nInclude Code\ninclude: false\nExecutes code but does not show the code in the final output.\n\n\nEvaluating Code\neval: false\nPrevents the code from running but still displays the code in the output.\n\n\nResults Control\nresults: 'markup' or results: 'asis'\nControls how output results are displayed (formatted or raw).\n\n\nMessage and Warnings\nmessage: false, warning: false\nControls whether messages and warnings appear in the output.\n\n\nOutput File Format\noutput: html\nSpecifies output format (html, pdf, word). Default is html.\n\n\nTable Output\nresults: 'asis' or results: 'markup'\nEnsures clean table rendering for formatted output.\n\n\nChunk Labeling\n# Label\nLabels help organize and reference code chunks easily.\n\n\nInline Code\nYour value is 2 times.\nEmbeds live code inside text for dynamic reporting.\n\n\nCaching Results\ncache: true\nSaves chunk results to avoid rerunning unchanged code. It stores the output (like objects, plots, and printed results) in a cache directory\n\n\nFigure Options\nfig.width: 7, fig.height: 5, fig.align: 'center'\nAdjusts figure size and alignment in output documents.\n\n\nOutput as LaTeX\nlatex: true\nAllows LaTeX formatting (mainly for PDFs and math expressions).\n\n\nCommenting Code\n# (within chunks)\nStandard way to comment within R code chunks.\n\n\n\n‚û°Ô∏è Mastering these options ensures smoother report generation, cleaner outputs, and faster rendering when building professional documents in Quarto or R Markdown."
  },
  {
    "objectID": "Post_Blog/Visualisations/index_original.html#part-ii-data-loading-and-exploration",
    "href": "Post_Blog/Visualisations/index_original.html#part-ii-data-loading-and-exploration",
    "title": "Date Manipulation and Wrangling using R",
    "section": "",
    "text": "File path setup and working with getwd(), paste()\nread_csv(), read_excel(), read.delim(), readRDS()\nReading .tsv, .dta, and .sav files (foreign and haven packages)\nReading from ZIP Files\n\nBefore we begin analyzing data in R, we need to bring it in from where it‚Äôs stored‚Äîyour computer, the cloud, or an online source.\nThere are many formats we commonly work with in public health and analytics: CSV, Excel, text files, RDS, SPSS, and others.\nBelow is a summary table of functions used to read each data type.\nüìä Reading Common Data Types in R\n\n\n\n\n\n\n\n\n\nData Type\nFunction\nPackage\nExample\n\n\n\n\nCSV\nread_csv(), read.csv()\nreadr / base\nread_csv(\"file.csv\")\n\n\nExcel (.xls/.xlsx)\nread_excel()\nreadxl\nread_excel(\"file.xlsx\")\n\n\nTab-separated (.tsv)\nread_tsv()\nreadr\nread_tsv(\"file.tsv\")\n\n\nText (.txt)\nread.delim()\nbase\nread.delim(\"file.txt\")\n\n\nStata (.dta)\nread_dta()\nhaven\nread_dta(\"file.dta\")\n\n\nSPSS (.sav)\nread_sav()\nhaven\nread_sav(\"file.sav\")\n\n\nRDS (R object)\nreadRDS()\nbase\nreadRDS(\"object.rds\")\n\n\nZIP archives\nunzip()\nutils (base)\nunzip(\"data.zip\", exdir = \"folder\")\n\n\nOnline Excel/CSV\ndownload.file() + reader\nbase + readxl\nDownload file, then read_excel(temp_file)\n\n\n\nBefore reading files, I usually set the working directory to the folder where my files are saved. This avoids typing full file paths every time.\nTo combine folder names and filenames dynamically: paste(getwd(), ‚Äúmy_data.csv‚Äù, sep = ‚Äú/‚Äù)\nReading Local Files\nOnce you‚Äôre in the right working directory, you can read in your files like below:\n\nsetwd(\"C:/Users/User/Desktop/Materials_ Course and proposals/Course Related/DataCamp/Data/Synthetic_data\")\n\npatients &lt;- read.csv(\"patients.csv\")\nvaccination &lt;- read.csv(\"immunizations.csv\")\n\nmedications &lt;- read.csv (paste(getwd(), \"medications.csv\", sep = \"/\"))\n\nThese are standard CSVs and can be read using read.csv() from base R, or read_csv() from the readr package for cleaner output.\nReading from ZIP Files\nSometimes, especially when downloading from government databases or health systems, data is compressed into .zip files. In R, we can easily unzip these files and extract their contents.\nSet working directory to the folder where the zip file is located\n\n# --- Define base folder manually (safe way without setwd)\nbase_folder &lt;- \"C:/Users/User/Desktop/Materials_ Course and proposals/Course Related/DataCamp/Data/Synthetic_data\"\n\n# --- Extract ZIP file into 'procedures' folder inside base\nunzip(file.path(base_folder, \"procedures.zip\"), exdir = file.path(base_folder, \"procedures\"))\n\n# --- List extracted files\nlist.files(file.path(base_folder, \"procedures\"))\n\n[1] \"procedures\"     \"procedures.csv\"\n\n# --- Read extracted CSV\nprocedures &lt;- read.csv(file.path(base_folder, \"procedures\", \"procedures.csv\"))\n\nReading Online Files\nIf the file is online, we first download it, save it to a temporary file, and then read it:\nIt is useful when working with shared datasets, APIs, or GitHub repos.\n\n# Upload Online data\n\nurl &lt;- \"https://raw.githubusercontent.com/HabtamuBizuayehu/Data-sources/main/Breast_cancer_screening.xls\"\ntemp_file &lt;- tempfile(fileext = \".xls\")\ndownload.file(url, temp_file, mode = \"wb\")\n\nbreast_cancer_data &lt;- read_excel(temp_file)\n\n2.2 Exploring Data\n\nstr(), summary(), glimpse(), head(), tail(), count()\nViewing data: view(), nrow(), ncol()\nCleaning variable names: janitor::clean_names()\nCreating a data dictionary\nWorking with column names and types\n\nOnce we load data into R, it‚Äôs important to explore it properly before doing any analysis.\nThis step helps us understand:\n\nWhat variables we have\nHow the data is structured\nIf there are any issues (like missing values, wrong data types, weird names)\n\nIn this part, we‚Äôll look at some essential functions we often use at the very beginning of a project.\nüîç Key Tools for Exploring Data (with Important Details and Tips)\n1. str(), summary(), glimpse(), head(), tail(), count()\n\nstr(df) shows the structure of the entire dataset: number of observations (rows), number of variables (columns), and data types.\nstr(df$var) shows the structure of a specific variable (single column), useful to quickly check type and contents.\nsummary(df) gives basic descriptive statistics for all variables at once.\nsummary(df$var) gives a summary for one specific variable.\nglimpse(df) (from dplyr) provides a compact sideways overview showing each variable name, type, and preview of values.\nhead(df) shows the first 6 rows of the dataset by default.\nhead(df, n = 10) shows the first 10 rows (you can customize the number with n =).\ntail(df) shows the last 6 rows of the dataset.\ntail(df, n = 8) shows the last 8 rows.\ncount(df, var) (from dplyr) counts occurrences of each unique value in a variable.\n\n‚û°Ô∏è Using str(df$var) and summary(df$var) is a fast way to inspect just one column without needing the whole dataset.\n\n2. Viewing Data\n\nview(df) opens an Excel-like data viewer window inside RStudio for easy manual exploration.\nnrow(df) returns the number of rows.\nncol(df) returns the number of columns.\ndim(df) returns a two-number vector: (rows, columns).\n\n‚û°Ô∏è Use view(df) when you want to sort/filter manually without coding.\n\n3. Cleaning Variable Names\n\njanitor::clean_names(df) standardizes messy variable names:\n\nMakes all names lowercase\nReplaces spaces and special characters with underscores\nRemoves parentheses, punctuation, etc.\n\n\n‚û°Ô∏è Run clean_names() immediately after loading raw survey, registry, or administrative datasets.\nExample:\n\nnames(patients)\n\n [1] \"Id\"                  \"BIRTHDATE\"           \"DEATHDATE\"          \n [4] \"SSN\"                 \"DRIVERS\"             \"PASSPORT\"           \n [7] \"PREFIX\"              \"FIRST\"               \"MIDDLE\"             \n[10] \"LAST\"                \"SUFFIX\"              \"MAIDEN\"             \n[13] \"MARITAL\"             \"RACE\"                \"ETHNICITY\"          \n[16] \"GENDER\"              \"BIRTHPLACE\"          \"ADDRESS\"            \n[19] \"CITY\"                \"STATE\"               \"COUNTY\"             \n[22] \"FIPS\"                \"ZIP\"                 \"LAT\"                \n[25] \"LON\"                 \"HEALTHCARE_EXPENSES\" \"HEALTHCARE_COVERAGE\"\n[28] \"INCOME\"             \n\ntemp &lt;- janitor::clean_names(patients)\ncolnames(temp)\n\n [1] \"id\"                  \"birthdate\"           \"deathdate\"          \n [4] \"ssn\"                 \"drivers\"             \"passport\"           \n [7] \"prefix\"              \"first\"               \"middle\"             \n[10] \"last\"                \"suffix\"              \"maiden\"             \n[13] \"marital\"             \"race\"                \"ethnicity\"          \n[16] \"gender\"              \"birthplace\"          \"address\"            \n[19] \"city\"                \"state\"               \"county\"             \n[22] \"fips\"                \"zip\"                 \"lat\"                \n[25] \"lon\"                 \"healthcare_expenses\" \"healthcare_coverage\"\n[28] \"income\"             \n\nrm(temp)\n\nüîç Listing All Data Frames and Variables\nTo organize and review datasets loaded in the environment, the following workflow lists all data frames and their variables:\n\nrm (breast_cancer_data, patients)\n\n# 1. List all data frames in the environment\ndfs &lt;- ls(envir = .GlobalEnv)[sapply(ls(envir = .GlobalEnv), function(x) is.data.frame(get(x)))]\n\n# 2. For each data frame, list its variable (column) names\ndf_variables &lt;- lapply(dfs, function(df_name) {\n  vars &lt;- names(get(df_name))\n  data.frame(\n    DataFrame = df_name,\n    Variable = vars,\n    stringsAsFactors = FALSE\n  )\n})\n\n# 3. Combine into one clean table\ndf_variables_all &lt;- do.call(rbind, df_variables)\n\n# View the result\nprint(df_variables_all)\n\n     DataFrame          Variable\n1  medications             START\n2  medications              STOP\n3  medications           PATIENT\n4  medications             PAYER\n5  medications         ENCOUNTER\n6  medications              CODE\n7  medications       DESCRIPTION\n8  medications         BASE_COST\n9  medications    PAYER_COVERAGE\n10 medications         DISPENSES\n11 medications         TOTALCOST\n12 medications        REASONCODE\n13 medications REASONDESCRIPTION\n14  procedures             START\n15  procedures              STOP\n16  procedures           PATIENT\n17  procedures         ENCOUNTER\n18  procedures            SYSTEM\n19  procedures              CODE\n20  procedures       DESCRIPTION\n21  procedures         BASE_COST\n22  procedures        REASONCODE\n23  procedures REASONDESCRIPTION\n24 vaccination              DATE\n25 vaccination           PATIENT\n26 vaccination         ENCOUNTER\n27 vaccination              CODE\n28 vaccination       DESCRIPTION\n29 vaccination         BASE_COST\n\nrm (df_variables_all, df_variables) # clean working enviroment \n\n4. Creating a Data Dictionary\nA data dictionary is a simple but critical table that documents:\n\nVariable names (column names)\nDescriptions (what each variable represents)\nTypes (numeric, character, factor)\n\n‚û°Ô∏è We can automate building a basic data dictionary by combining names(), sapply(), and class() functions.\n\ndata_dictionary &lt;- data.frame(\n  Variable = names(patients),\n  Type = sapply(patients, class)\n)\n\nThe dictionary can be expanded by manually adding descriptions, coding instructions, or value mappings where necessary.\n5. Working with Column Names and Types\n\nnames(df) or colnames(df) retrieves a list of all column names.\nclass(df$var) reveals the data type of a specific variable.\nsapply(df, class) applies class() across all variables and summarizes their types.\nIf needed, variables can be recast to appropriate types.\n\nüìä Summary Table: Key Functions for Exploring Data\n\n\n\n\n\n\n\n\nTask\nFunction\nPurpose / What It Does\n\n\n\n\nView structure of dataset\nstr(df)\nShows structure: number of rows, columns, and variable types\n\n\nView structure of variable\nstr(df$var)\nShows structure/type of a specific variable\n\n\nSummarize statistics (dataset)\nsummary(df)\nProvides summary stats (min, max, mean, NA count) for all variables\n\n\nSummarize statistics (variable)\nsummary(df$var)\nSummary stats for a specific variable\n\n\nCompact structure overview\nglimpse(df)\nQuick, sideways compact view of dataset (from dplyr)\n\n\nPreview first rows\nhead(df), head(df, n = 10)\nDisplays first 6 or specified number of rows\n\n\nPreview last rows\ntail(df), tail(df, n = 8)\nDisplays last 6 or specified number of rows\n\n\nCount frequencies\ncount(df, var)\nCounts unique values and frequency of a specified variable\n\n\nOpen full viewer\nview(df)\nOpens Excel-style data viewer window (RStudio)\n\n\nCheck number of rows\nnrow(df)\nReturns number of rows (observations)\n\n\nCheck number of columns\nncol(df)\nReturns number of columns (variables)\n\n\nCheck both dimensions\ndim(df)\nReturns (rows, columns) as a two-number vector\n\n\nClean column names\njanitor::clean_names(df)\nConverts messy names into lowercase, underscore-separated names\n\n\nList variable names\nnames(df), colnames(df)\nLists all column names in a data frame\n\n\nCheck variable type\nclass(df$var)\nReturns data type of a specific variable\n\n\nCheck types for all variables\nsapply(df, class)\nReturns data types for every column in the dataset\n\n\nCreate basic data dictionary\ndata.frame(Variable = names(df), Type = sapply(df, class))\nTable summarizing variable names and types\n\n\nList all data frames in environment\ndfs &lt;- ls(...)[sapply(...)]\nIdentifies and lists all data frames currently loaded\n\n\nList all variables from all data frames\nlapply(dfs, function(x) names(get(x)))\nCreates table listing data frames and their variables\n\n\n\nNow I can apply some of the above to my datasets (df): such as breast_cancer_data, vaccination, patients\n\nbreast_cancer_data_demo &lt;- breast_cancer_data %&gt;%\n  select(sa3name, state, year, part50_74, rate50_74)\n\n# Structure of the demo dataset\nstr(breast_cancer_data_demo)\n\n'data.frame':   1364 obs. of  5 variables:\n $ sa3name  : chr  \"Queanbeyan\" \"Queanbeyan\" \"Queanbeyan\" \"Queanbeyan\" ...\n $ state    : chr  \"NSW\" \"NSW\" \"NSW\" \"NSW\" ...\n $ year     : int  201617 201718 201819 201920 201617 201718 201819 201920 201617 201718 ...\n $ part50_74: num  4875 5048 5276 5179 1850 ...\n $ rate50_74: num  60.5 60.8 61.4 58.2 59.7 ...\n\n# Summary statistics for rate50_74\nsummary(breast_cancer_data_demo$rate50_74)\n\n   Min. 1st Qu.  Median    Mean 3rd Qu.    Max.    NA's \n   5.40   50.07   54.50   53.63   57.88   80.20     135 \n\n# Display first 10 rows\nhead(breast_cancer_data_demo, 10)\n\n           sa3name state   year part50_74 rate50_74\n1       Queanbeyan   NSW 201617      4875  60.50000\n2       Queanbeyan   NSW 201718      5048  60.75961\n3       Queanbeyan   NSW 201819      5276  61.43839\n4       Queanbeyan   NSW 201920      5179  58.16834\n5  Snowy Mountains   NSW 201617      1850  59.70000\n6  Snowy Mountains   NSW 201718      1910  61.54862\n7  Snowy Mountains   NSW 201819      2039  65.12912\n8  Snowy Mountains   NSW 201920      1979  62.23419\n9      South Coast   NSW 201617      9469  62.80000\n10     South Coast   NSW 201718      9565  62.94230\n\n# Count number of records\ncount(breast_cancer_data_demo)\n\n     n\n1 1364\n\n# Show variable names\nnames(breast_cancer_data_demo)\n\n[1] \"sa3name\"   \"state\"     \"year\"      \"part50_74\" \"rate50_74\""
  },
  {
    "objectID": "Post_Blog/Visualisations/index_original.html#part-iii-wrangling-with-dplyr",
    "href": "Post_Blog/Visualisations/index_original.html#part-iii-wrangling-with-dplyr",
    "title": "Date Manipulation and Wrangling using R",
    "section": "",
    "text": "In this part, we focus on mastering core data wrangling skills using the dplyr package, one of the most powerful tools in R for data manipulation.\nWe will learn how to select, rename, create, modify, group, sort, slice, and reshape datasets.\nThese operations form the foundation for preparing clean, organized, and analysis-ready data.\nEach subsection introduces a set of essential verbs (select(), mutate(), group_by(), etc.) that allow for data transformation pipelines. Examples and practical applications will be provided throughout to demonstrate how to use dplyr.\n\n\n\n\nselect(), rename(), relocate()`\nColumn helpers: starts_with(), ends_with(), contains(), last_clos, matches\nAllow modifying entire groups of column names by adding prefixes or suffixes\nHandling null/missing column names\n\nSelecting, reordering, and renaming variables is often the first step when preparing a dataset for analysis.\nIn dplyr, we use functions such as select(), rename(), and relocate() to organize variables, clean up data, and prepare for transformations.\nDropping unnecessary columns or reordering variables can make the data cleaner, faster to work with, and easier to understand.\nAdditional tools allow modifying groups of column names by adding prefixes or suffixes, and safely handling missing columns during selection.\n\nüîπ Summary of Functions for Selecting, Reordering, Dropping, and Renaming\n\n\n\n\n\n\n\n\nTask\nFunction\nPurpose\n\n\n\n\nSelect specific columns\nselect()\nChoose a subset of columns based on name or condition\n\n\nRename columns\nrename()\nRename one or multiple columns\n\n\nRelocate columns\nrelocate()\nMove selected columns to a new position\n\n\nReorder manually\nselect(a, b, c, everything())\nExplicitly define column order\n\n\nFind columns by pattern\nstarts_with(), ends_with(), contains(), matches()\nSelect columns matching a pattern\n\n\nDrop single column\nselect(-col1)\nRemove one variable\n\n\nDrop multiple columns\nselect(-col1, -col2)\nRemove several variables\n\n\nDrop by pattern\nselect(-starts_with(\"temp\")), select(-contains(\"score\"))\nRemove variables based on naming patterns\n\n\nAdd prefix to column names\nrename_with(~ paste0(\"prefix_\", .x))\nAdd a prefix to selected columns\n\n\nAdd suffix to column names\nrename_with(~ paste0(.x, \"_suffix\"))\nAdd a suffix to selected columns\n\n\nHandle missing columns safely\nif(\"var\" %in% names(df)) {}\nAvoid errors when column does not exist\n\n\n\n\n‚û°Ô∏è These techniques allow quick restructuring of datasets, improving workflow efficiency and clarity.\n\nüîπ Examples Using the vaccination Dataset\n\n# Selecting specific columns manually\nbreast_selected &lt;- breast_cancer_data %&gt;%\n  select(sa3code, sa3name, year, part50_74, pop50_74)\n\nhead(breast_selected, n = 3)\n\n  sa3code    sa3name   year part50_74 pop50_74\n1   10102 Queanbeyan 201617      4875     8052\n2   10102 Queanbeyan 201718      5048     8309\n3   10102 Queanbeyan 201819      5276     8588\n\n# Reordering columns manually (bring year, sa3name, state first)\nbc_reorder_manual &lt;- breast_cancer_data %&gt;%\n  select(year, sa3name, state, everything())\n\nhead(bc_reorder_manual, n = 3)\n\n    year    sa3name state sa3code sa3coden part50_74 pop50_74 rate50_74\n1 201617 Queanbeyan   NSW   10102    10102      4875     8052  60.50000\n2 201718 Queanbeyan   NSW   10102    10102      5048     8309  60.75961\n3 201819 Queanbeyan   NSW   10102    10102      5276     8588  61.43839\n  agen50_74 expct50_74 part50_69 pop50_69 rate50_69 agen50_69 expct50_69\n1         3       4428      4309     7145  60.30000         2       3929\n2         3       4553      4448     7338  60.62238         2       4013\n3         3       4706      4629     7548  61.33203         2       4113\n  part50_54 pop50_54 rate50_54 agen50_54 expct50_54 part55_59 pop55_59\n1      1284     2251  57.00000         1       1118      1188     1970\n2      1285     2306  55.72035         1       1143      1260     2030\n3      1375     2342  58.70977         1       1166      1252     2093\n  rate55_59 agen55_59 expct55_59 part60_64 pop60_64 rate60_64 agen60_64\n1  60.30000         4       1046      1012     1625  62.30000         5\n2  62.09035         4       1069      1048     1646  63.69947         5\n3  59.81504         4       1098      1105     1689  65.43657         5\n  expct60_64 part65_69 pop65_69 rate65_69 agen65_69 expct65_69 part70_74\n1        950       826     1300  63.50000         6        781       566\n2        953       855     1357  63.02558         6        812       600\n3        967       898     1426  63.00429         6        849       647\n  pop70_74 rate70_74 agen70_74 expct70_74\n1      907  62.40000         7        498\n2      971  61.79725         7        541\n3     1040  62.21032         7        585\n\n# Relocating specific columns before another variable\nbc_relocate_before &lt;- breast_cancer_data %&gt;%\n  relocate(part50_74, pop50_74, .before = rate50_74)\n\nhead(bc_relocate_before, n = 3)\n\n  sa3code sa3coden    sa3name state   year part50_74 pop50_74 rate50_74\n1   10102    10102 Queanbeyan   NSW 201617      4875     8052  60.50000\n2   10102    10102 Queanbeyan   NSW 201718      5048     8309  60.75961\n3   10102    10102 Queanbeyan   NSW 201819      5276     8588  61.43839\n  agen50_74 expct50_74 part50_69 pop50_69 rate50_69 agen50_69 expct50_69\n1         3       4428      4309     7145  60.30000         2       3929\n2         3       4553      4448     7338  60.62238         2       4013\n3         3       4706      4629     7548  61.33203         2       4113\n  part50_54 pop50_54 rate50_54 agen50_54 expct50_54 part55_59 pop55_59\n1      1284     2251  57.00000         1       1118      1188     1970\n2      1285     2306  55.72035         1       1143      1260     2030\n3      1375     2342  58.70977         1       1166      1252     2093\n  rate55_59 agen55_59 expct55_59 part60_64 pop60_64 rate60_64 agen60_64\n1  60.30000         4       1046      1012     1625  62.30000         5\n2  62.09035         4       1069      1048     1646  63.69947         5\n3  59.81504         4       1098      1105     1689  65.43657         5\n  expct60_64 part65_69 pop65_69 rate65_69 agen65_69 expct65_69 part70_74\n1        950       826     1300  63.50000         6        781       566\n2        953       855     1357  63.02558         6        812       600\n3        967       898     1426  63.00429         6        849       647\n  pop70_74 rate70_74 agen70_74 expct70_74\n1      907  62.40000         7        498\n2      971  61.79725         7        541\n3     1040  62.21032         7        585\n\n# Relocating specific columns after another variable\nbc_relocate_after &lt;- breast_cancer_data %&gt;%\n  relocate(sa3name, state, .after = year)\n\nhead(bc_relocate_after, n = 3)\n\n  sa3code sa3coden   year    sa3name state part50_74 pop50_74 rate50_74\n1   10102    10102 201617 Queanbeyan   NSW      4875     8052  60.50000\n2   10102    10102 201718 Queanbeyan   NSW      5048     8309  60.75961\n3   10102    10102 201819 Queanbeyan   NSW      5276     8588  61.43839\n  agen50_74 expct50_74 part50_69 pop50_69 rate50_69 agen50_69 expct50_69\n1         3       4428      4309     7145  60.30000         2       3929\n2         3       4553      4448     7338  60.62238         2       4013\n3         3       4706      4629     7548  61.33203         2       4113\n  part50_54 pop50_54 rate50_54 agen50_54 expct50_54 part55_59 pop55_59\n1      1284     2251  57.00000         1       1118      1188     1970\n2      1285     2306  55.72035         1       1143      1260     2030\n3      1375     2342  58.70977         1       1166      1252     2093\n  rate55_59 agen55_59 expct55_59 part60_64 pop60_64 rate60_64 agen60_64\n1  60.30000         4       1046      1012     1625  62.30000         5\n2  62.09035         4       1069      1048     1646  63.69947         5\n3  59.81504         4       1098      1105     1689  65.43657         5\n  expct60_64 part65_69 pop65_69 rate65_69 agen65_69 expct65_69 part70_74\n1        950       826     1300  63.50000         6        781       566\n2        953       855     1357  63.02558         6        812       600\n3        967       898     1426  63.00429         6        849       647\n  pop70_74 rate70_74 agen70_74 expct70_74\n1      907  62.40000         7        498\n2      971  61.79725         7        541\n3     1040  62.21032         7        585\n\n# Dropping one variable\nbc_drop_one &lt;- breast_cancer_data %&gt;%\n  select(-expct50_74)\n\nhead(bc_drop_one, n = 3)\n\n  sa3code sa3coden    sa3name state   year part50_74 pop50_74 rate50_74\n1   10102    10102 Queanbeyan   NSW 201617      4875     8052  60.50000\n2   10102    10102 Queanbeyan   NSW 201718      5048     8309  60.75961\n3   10102    10102 Queanbeyan   NSW 201819      5276     8588  61.43839\n  agen50_74 part50_69 pop50_69 rate50_69 agen50_69 expct50_69 part50_54\n1         3      4309     7145  60.30000         2       3929      1284\n2         3      4448     7338  60.62238         2       4013      1285\n3         3      4629     7548  61.33203         2       4113      1375\n  pop50_54 rate50_54 agen50_54 expct50_54 part55_59 pop55_59 rate55_59\n1     2251  57.00000         1       1118      1188     1970  60.30000\n2     2306  55.72035         1       1143      1260     2030  62.09035\n3     2342  58.70977         1       1166      1252     2093  59.81504\n  agen55_59 expct55_59 part60_64 pop60_64 rate60_64 agen60_64 expct60_64\n1         4       1046      1012     1625  62.30000         5        950\n2         4       1069      1048     1646  63.69947         5        953\n3         4       1098      1105     1689  65.43657         5        967\n  part65_69 pop65_69 rate65_69 agen65_69 expct65_69 part70_74 pop70_74\n1       826     1300  63.50000         6        781       566      907\n2       855     1357  63.02558         6        812       600      971\n3       898     1426  63.00429         6        849       647     1040\n  rate70_74 agen70_74 expct70_74\n1  62.40000         7        498\n2  61.79725         7        541\n3  62.21032         7        585\n\n# Dropping multiple variables\nbc_drop_multiple &lt;- breast_cancer_data %&gt;%\n  select(-expct50_74, -expct50_69)\n\nhead(bc_drop_multiple, n = 3)\n\n  sa3code sa3coden    sa3name state   year part50_74 pop50_74 rate50_74\n1   10102    10102 Queanbeyan   NSW 201617      4875     8052  60.50000\n2   10102    10102 Queanbeyan   NSW 201718      5048     8309  60.75961\n3   10102    10102 Queanbeyan   NSW 201819      5276     8588  61.43839\n  agen50_74 part50_69 pop50_69 rate50_69 agen50_69 part50_54 pop50_54 rate50_54\n1         3      4309     7145  60.30000         2      1284     2251  57.00000\n2         3      4448     7338  60.62238         2      1285     2306  55.72035\n3         3      4629     7548  61.33203         2      1375     2342  58.70977\n  agen50_54 expct50_54 part55_59 pop55_59 rate55_59 agen55_59 expct55_59\n1         1       1118      1188     1970  60.30000         4       1046\n2         1       1143      1260     2030  62.09035         4       1069\n3         1       1166      1252     2093  59.81504         4       1098\n  part60_64 pop60_64 rate60_64 agen60_64 expct60_64 part65_69 pop65_69\n1      1012     1625  62.30000         5        950       826     1300\n2      1048     1646  63.69947         5        953       855     1357\n3      1105     1689  65.43657         5        967       898     1426\n  rate65_69 agen65_69 expct65_69 part70_74 pop70_74 rate70_74 agen70_74\n1  63.50000         6        781       566      907  62.40000         7\n2  63.02558         6        812       600      971  61.79725         7\n3  63.00429         6        849       647     1040  62.21032         7\n  expct70_74\n1        498\n2        541\n3        585\n\n# Dropping variables by pattern (e.g., columns ending with \"_69\")\nbc_drop_by_pattern &lt;- breast_cancer_data %&gt;%\n  select(-ends_with(\"_69\"))\n\nhead(bc_drop_by_pattern, n = 3)\n\n  sa3code sa3coden    sa3name state   year part50_74 pop50_74 rate50_74\n1   10102    10102 Queanbeyan   NSW 201617      4875     8052  60.50000\n2   10102    10102 Queanbeyan   NSW 201718      5048     8309  60.75961\n3   10102    10102 Queanbeyan   NSW 201819      5276     8588  61.43839\n  agen50_74 expct50_74 part50_54 pop50_54 rate50_54 agen50_54 expct50_54\n1         3       4428      1284     2251  57.00000         1       1118\n2         3       4553      1285     2306  55.72035         1       1143\n3         3       4706      1375     2342  58.70977         1       1166\n  part55_59 pop55_59 rate55_59 agen55_59 expct55_59 part60_64 pop60_64\n1      1188     1970  60.30000         4       1046      1012     1625\n2      1260     2030  62.09035         4       1069      1048     1646\n3      1252     2093  59.81504         4       1098      1105     1689\n  rate60_64 agen60_64 expct60_64 part70_74 pop70_74 rate70_74 agen70_74\n1  62.30000         5        950       566      907  62.40000         7\n2  63.69947         5        953       600      971  61.79725         7\n3  65.43657         5        967       647     1040  62.21032         7\n  expct70_74\n1        498\n2        541\n3        585\n\n# Renaming a column for clarity\nbreast_renamed &lt;- breast_selected %&gt;%\n  rename(SA3_Code = sa3code, SA3_Name = sa3name, Year = year)\n\nhead(breast_renamed, n = 3)\n\n  SA3_Code   SA3_Name   Year part50_74 pop50_74\n1    10102 Queanbeyan 201617      4875     8052\n2    10102 Queanbeyan 201718      5048     8309\n3    10102 Queanbeyan 201819      5276     8588\n\n# Adding a prefix to all column names\nbc_prefixed &lt;- breast_cancer_data %&gt;%\n  rename_with(~ paste0(\"bc_\", .x))\n\nhead(bc_prefixed, n = 3)\n\n  bc_sa3code bc_sa3coden bc_sa3name bc_state bc_year bc_part50_74 bc_pop50_74\n1      10102       10102 Queanbeyan      NSW  201617         4875        8052\n2      10102       10102 Queanbeyan      NSW  201718         5048        8309\n3      10102       10102 Queanbeyan      NSW  201819         5276        8588\n  bc_rate50_74 bc_agen50_74 bc_expct50_74 bc_part50_69 bc_pop50_69 bc_rate50_69\n1     60.50000            3          4428         4309        7145     60.30000\n2     60.75961            3          4553         4448        7338     60.62238\n3     61.43839            3          4706         4629        7548     61.33203\n  bc_agen50_69 bc_expct50_69 bc_part50_54 bc_pop50_54 bc_rate50_54 bc_agen50_54\n1            2          3929         1284        2251     57.00000            1\n2            2          4013         1285        2306     55.72035            1\n3            2          4113         1375        2342     58.70977            1\n  bc_expct50_54 bc_part55_59 bc_pop55_59 bc_rate55_59 bc_agen55_59\n1          1118         1188        1970     60.30000            4\n2          1143         1260        2030     62.09035            4\n3          1166         1252        2093     59.81504            4\n  bc_expct55_59 bc_part60_64 bc_pop60_64 bc_rate60_64 bc_agen60_64\n1          1046         1012        1625     62.30000            5\n2          1069         1048        1646     63.69947            5\n3          1098         1105        1689     65.43657            5\n  bc_expct60_64 bc_part65_69 bc_pop65_69 bc_rate65_69 bc_agen65_69\n1           950          826        1300     63.50000            6\n2           953          855        1357     63.02558            6\n3           967          898        1426     63.00429            6\n  bc_expct65_69 bc_part70_74 bc_pop70_74 bc_rate70_74 bc_agen70_74\n1           781          566         907     62.40000            7\n2           812          600         971     61.79725            7\n3           849          647        1040     62.21032            7\n  bc_expct70_74\n1           498\n2           541\n3           585\n\n# Adding a suffix to all column names\nbc_suffixed &lt;- breast_cancer_data %&gt;%\n  rename_with(~ paste0(.x, \"_info\"))\n\nhead(bc_suffixed, n = 3)\n\n  sa3code_info sa3coden_info sa3name_info state_info year_info part50_74_info\n1        10102         10102   Queanbeyan        NSW    201617           4875\n2        10102         10102   Queanbeyan        NSW    201718           5048\n3        10102         10102   Queanbeyan        NSW    201819           5276\n  pop50_74_info rate50_74_info agen50_74_info expct50_74_info part50_69_info\n1          8052       60.50000              3            4428           4309\n2          8309       60.75961              3            4553           4448\n3          8588       61.43839              3            4706           4629\n  pop50_69_info rate50_69_info agen50_69_info expct50_69_info part50_54_info\n1          7145       60.30000              2            3929           1284\n2          7338       60.62238              2            4013           1285\n3          7548       61.33203              2            4113           1375\n  pop50_54_info rate50_54_info agen50_54_info expct50_54_info part55_59_info\n1          2251       57.00000              1            1118           1188\n2          2306       55.72035              1            1143           1260\n3          2342       58.70977              1            1166           1252\n  pop55_59_info rate55_59_info agen55_59_info expct55_59_info part60_64_info\n1          1970       60.30000              4            1046           1012\n2          2030       62.09035              4            1069           1048\n3          2093       59.81504              4            1098           1105\n  pop60_64_info rate60_64_info agen60_64_info expct60_64_info part65_69_info\n1          1625       62.30000              5             950            826\n2          1646       63.69947              5             953            855\n3          1689       65.43657              5             967            898\n  pop65_69_info rate65_69_info agen65_69_info expct65_69_info part70_74_info\n1          1300       63.50000              6             781            566\n2          1357       63.02558              6             812            600\n3          1426       63.00429              6             849            647\n  pop70_74_info rate70_74_info agen70_74_info expct70_74_info\n1           907       62.40000              7             498\n2           971       61.79725              7             541\n3          1040       62.21032              7             585\n\n# Handling missing columns safely during selection\nif (\"non_existing_column\" %in% names(breast_cancer_data)) {\n  bc_safe_select &lt;- breast_cancer_data %&gt;%\n    select(non_existing_column)\n  head(bc_safe_select, n = 3)\n} else {\n  message(\"Column 'non_existing_column' not found in breast_cancer_data.\")\n}\n\nColumn 'non_existing_column' not found in breast_cancer_data.\n\n# ....................................................\n# Remove all temporary objects created in this chunk\n# ....................................................\nrm(breast_selected, breast_renamed, bc_drop_one, bc_drop_multiple, bc_drop_by_pattern,\n   bc_reorder_manual, bc_relocate_before, bc_relocate_after,\n   bc_prefixed, bc_suffixed)\n\n\n\n\n\nmutate(), transmute(), recoding, case_when(), if_else()\nstr_detect(), regex(), %in%\nCreating dummy/flag variables\nString manipulation: strsplit(), sub(), gsub(), tolower(), `janitor::clean_names()`\n\nCreating new variables or modifying existing ones is a key part of preparing data for analysis.\nIn dplyr, we use functions like mutate() and transmute() to add, transform, or recode variables.\nWe can also create conditional variables with case_when() or if_else(), and apply string operations such as splitting, replacing, or converting text.\nThese steps help structure the data more logically, highlight important features, or derive new indicators for analysis.\n\nüîπ Summary of Functions for Creating and Modifying Variables\n\n\n\n\n\n\n\n\nTask\nFunction\nPurpose\n\n\n\n\nCreate or modify variables\nmutate()\nAdd or transform variables, keeping all columns\n\n\nCreate new variables only\ntransmute()\nKeep only new variables created\n\n\nConditional variable creation\ncase_when()\nCreate new variables based on multiple conditions\n\n\nSimple conditional assignment\nif_else()\nAssign based on TRUE/FALSE logic\n\n\nSplit strings into parts\nstrsplit()\nSplit a string into components\n\n\nReplace text (first occurrence)\nsub()\nReplace first match of a pattern\n\n\nReplace text (all occurrences)\ngsub()\nReplace all matches of a pattern\n\n\nConvert text to lowercase\ntolower()\nStandardize text to lowercase\n\n\nDetect text patterns\nstr_detect()\nCheck if a pattern exists in text\n\n\nFlexible pattern matching\nregex()\nUse regular expressions for complex patterns\n\n\nMembership check\n%in%\nTest if a value is part of a group\n\n\n\n\n‚û°Ô∏è These functions allow transforming the dataset systematically to extract new features, categorize information, or clean fields.\n\n# Creating and Modifying Variables (patients dataset)\n\n# Creating a new age group variable\npatients_mutated &lt;- patients %&gt;%\n  mutate(age_group = if_else(BIRTHDATE &lt;= as.Date(\"1970-01-01\"), \"Below 70\", \"70+\")) %&gt;%\n  relocate(age_group, .after = BIRTHDATE) %&gt;%\n  select(-Id, -DEATHDATE, -SSN, -LAT, -LON, -SUFFIX, -ZIP)\n\nhead(patients_mutated, 10)\n\n    BIRTHDATE age_group   DRIVERS   PASSPORT PREFIX       FIRST       MIDDLE\n1  1994-02-06       70+ S99996852 X47758697X    Mr.   Joshua658      Alvin56\n2  1968-08-06  Below 70 S99993577 X28173268X    Mr.   Bennie663             \n3  2008-12-21       70+                               Hunter736  Mckinley734\n4  1994-01-27       70+ S99995100 X83694889X   Mrs.   Carlyn477 Florencia449\n5  2019-07-27       70+                                 Robin66    Jeramy610\n6  2019-04-18       70+                               Arthur650             \n7  2013-08-10       70+                                 Caryl47     Lelia627\n8  1968-08-06  Below 70 S99911538 X37637991X    Mr.  Willian804    Shelton25\n9  2006-07-02       70+ S99943171               Ms. Domenica436             \n10 1948-05-28  Below 70 S99941458 X59458953X    Mr.  Arnulfo253    Jordan900\n            LAST   MAIDEN MARITAL  RACE   ETHNICITY GENDER\n1       Kunde533                M white nonhispanic      M\n2       Ebert178                D white nonhispanic      M\n3     Gerlach374                  white nonhispanic      M\n4  Williamson769 Rogahn59       M asian nonhispanic      F\n5   Gleichner915                  white nonhispanic      M\n6     Roberts511                  white nonhispanic      M\n7    Kassulke119                  white nonhispanic      F\n8      Keeling57                M white nonhispanic      M\n9         Rau926                  white    hispanic      F\n10  Jaskolski867                D white nonhispanic      M\n                         BIRTHPLACE                     ADDRESS         CITY\n1         Boston  Massachusetts  US            811 Kihn Viaduct    Braintree\n2       Chicopee  Massachusetts  US 975 Pfannerstill Throughway    Braintree\n3        Spencer  Massachusetts  US             548 Heller Lane Mattapoisett\n4       Franklin  Massachusetts  US  160 Fadel Crossroad Apt 65      Wareham\n5       Brockton  Massachusetts  US      766 Grant Loaf Unit 15    Groveland\n6       Plymouth  Massachusetts  US            866 Kulas Harbor    Cambridge\n7  East Falmouth  Massachusetts  US            578 Dickens Camp    Arlington\n8        Methuen  Massachusetts  US      848 Ebert Knoll Unit 7    Braintree\n9        Maynard  Massachusetts  US             963 Senger Fort    Haverhill\n10        Boston  Massachusetts  US    757 Lockman Annex Apt 10   Georgetown\n           STATE           COUNTY  FIPS HEALTHCARE_EXPENSES HEALTHCARE_COVERAGE\n1  Massachusetts   Norfolk County 25021            56904.96            18019.99\n2  Massachusetts   Norfolk County 25021           124024.12             1075.06\n3  Massachusetts  Plymouth County    NA            45645.06             6154.94\n4  Massachusetts  Plymouth County    NA            12895.15           659951.61\n5  Massachusetts     Essex County    NA            18500.02             5493.57\n6  Massachusetts Middlesex County 25017            14478.23              693.39\n7  Massachusetts Middlesex County 25017             9821.14            27142.51\n8  Massachusetts   Norfolk County 25021           175817.63            55473.97\n9  Massachusetts     Essex County 25009            52933.16            11941.44\n10 Massachusetts     Essex County    NA           242013.44           322768.97\n   INCOME\n1  100511\n2   49737\n3  133816\n4   17382\n5   52159\n6   75767\n7   58294\n8   49737\n9   77756\n10  35255\n\n# extract month and year from date in form of date is YYYY-MM-DD HH:MM:SS\nstr (vaccination$DATE) # date is YYYY-MM-DD HH:MM:SS format.\n\n chr [1:1619] \"2016-04-10T09:04:48Z\" \"2016-04-10T09:04:48Z\" ...\n\nvaccination &lt;- vaccination %&gt;%\n  mutate(\n    vacc_date = as.Date(strptime(DATE, format = \"%Y-%m-%dT%H:%M:%SZ\")),  # First create vacc_date\n    year = format(vacc_date, \"%Y\"),         # Extract year\n    month = format(vacc_date, \"%B\")          # Extract full month name (January, February, etc.)\n  )\n\ncolnames(vaccination)\n\n[1] \"DATE\"        \"PATIENT\"     \"ENCOUNTER\"   \"CODE\"        \"DESCRIPTION\"\n[6] \"BASE_COST\"   \"vacc_date\"   \"year\"        \"month\"      \n\nhead(vaccination)\n\n                  DATE                              PATIENT\n1 2016-04-10T09:04:48Z 30a6452c-4297-a1ac-977a-6a23237c7b46\n2 2016-04-10T09:04:48Z 30a6452c-4297-a1ac-977a-6a23237c7b46\n3 2016-04-10T09:04:48Z 30a6452c-4297-a1ac-977a-6a23237c7b46\n4 2016-04-10T09:04:48Z 30a6452c-4297-a1ac-977a-6a23237c7b46\n5 2002-10-29T19:07:21Z 34a4dcc4-35fb-6ad5-ab98-be285c586a4f\n6 2005-11-01T19:07:21Z 34a4dcc4-35fb-6ad5-ab98-be285c586a4f\n                             ENCOUNTER CODE\n1 0b03e41b-06a6-66fa-b972-acc5a83b134a  140\n2 0b03e41b-06a6-66fa-b972-acc5a83b134a  113\n3 0b03e41b-06a6-66fa-b972-acc5a83b134a   43\n4 0b03e41b-06a6-66fa-b972-acc5a83b134a  114\n5 30ab48ec-35a7-7704-86e5-113ef6a90c03  140\n6 d00bda57-b134-0654-e152-831ef486da53  140\n                                                   DESCRIPTION BASE_COST\n1           Influenza  seasonal  injectable  preservative free       136\n2 Td (adult)  5 Lf tetanus toxoid  preservative free  adsorbed       136\n3                                                 Hep B  adult       136\n4                                          meningococcal MCV4P       136\n5           Influenza  seasonal  injectable  preservative free       136\n6           Influenza  seasonal  injectable  preservative free       136\n   vacc_date year    month\n1 2016-04-10 2016    April\n2 2016-04-10 2016    April\n3 2016-04-10 2016    April\n4 2016-04-10 2016    April\n5 2002-10-29 2002  October\n6 2005-11-01 2005 November\n\n# Creating a dataset keeping only new variables (transmute)\npatients_transmuted &lt;- patients %&gt;%\n  transmute(\n    full_name = paste(FIRST, LAST, sep = \" \"), \n    birth_year = format(as.Date(BIRTHDATE), \"%Y\")\n  )\n\nhead (patients_transmuted)\n\n                full_name birth_year\n1      Joshua658 Kunde533       1994\n2      Bennie663 Ebert178       1968\n3    Hunter736 Gerlach374       2008\n4 Carlyn477 Williamson769       1994\n5    Robin66 Gleichner915       2019\n6    Arthur650 Roberts511       2019\n\n# generate a birth_year_group variable based on birth_year values\n\npatients_transmuted &lt;- patients_transmuted %&gt;%\n  mutate(birth_year_group = case_when(\n    birth_year &lt; 1940 ~ \"Before 1940\",\n    birth_year &gt;= 1940 & birth_year &lt;= 1959 ~ \"1940‚Äì1959\",\n    birth_year &gt;= 1960 & birth_year &lt;= 1979 ~ \"1960‚Äì1979\",\n    birth_year &gt;= 1980 & birth_year &lt;= 1999 ~ \"1980‚Äì1999\",\n    birth_year &gt;= 2000 ~ \"2000 and later\",\n    TRUE ~ NA_character_\n  ))\n\nhead(patients_transmuted)\n\n                full_name birth_year birth_year_group\n1      Joshua658 Kunde533       1994        1980‚Äì1999\n2      Bennie663 Ebert178       1968        1960‚Äì1979\n3    Hunter736 Gerlach374       2008   2000 and later\n4 Carlyn477 Williamson769       1994        1980‚Äì1999\n5    Robin66 Gleichner915       2019   2000 and later\n6    Arthur650 Roberts511       2019   2000 and later\n\n# other option to achieve similar result for the above \n\npatients_transmuted &lt;- patients_transmuted %&gt;%\n  mutate(birth_year = as.numeric(birth_year),   # Convert to numeric\n         birth_year_group = cut(birth_year,     # Apply cut()\n                                breaks = c(0, 1939, 1959, 1979, 1999, Inf),\n                                labels = c(\"Before 1940\", \"1940‚Äì1959\", \"1960‚Äì1979\", \"1980‚Äì1999\", \"2000 and later\"),\n                                right = TRUE\n         ))\n\n\nhead(patients_transmuted)\n\n                full_name birth_year birth_year_group\n1      Joshua658 Kunde533       1994        1980‚Äì1999\n2      Bennie663 Ebert178       1968        1960‚Äì1979\n3    Hunter736 Gerlach374       2008   2000 and later\n4 Carlyn477 Williamson769       1994        1980‚Äì1999\n5    Robin66 Gleichner915       2019   2000 and later\n6    Arthur650 Roberts511       2019   2000 and later\n\n# Using case_when to assign marital status values\npatients_case_when &lt;- patients %&gt;%\n  mutate(marital_status_group = case_when(\n    MARITAL == \"M\" ~ \"Married\",\n    MARITAL == \"S\" ~ \"Single\",\n    MARITAL == \"D\" ~ \"Divorced\",\n    TRUE ~ \"Unknown\"\n  )) %&gt;% \n  select(MARITAL, marital_status_group, RACE)\n\nhead(patients_case_when, n = 10)\n\n   MARITAL marital_status_group  RACE\n1        M              Married white\n2        D             Divorced white\n3                       Unknown white\n4        M              Married asian\n5                       Unknown white\n6                       Unknown white\n7                       Unknown white\n8        M              Married white\n9                       Unknown white\n10       D             Divorced white\n\ntable(patients_case_when$marital_status, useNA = \"ifany\")  # Show missing values in the table\n\n\nDivorced  Married   Single  Unknown \n      15       33       12       46 \n\n# Recode marital status while leaving unknown values as missing\npatients_case_when &lt;- patients_case_when %&gt;%\n  mutate(marital_2group = case_when(\n    MARITAL == \"M\" ~ \"Partnered\",\n    MARITAL == \"D\" | MARITAL == \"S\" | MARITAL == \"W\" ~ \"Not partnered\",\n    TRUE ~ NA_character_  # Replaces unknown values with missing (NA)\n  )) \n\nhead(patients_case_when)\n\n  MARITAL marital_status_group  RACE marital_2group\n1       M              Married white      Partnered\n2       D             Divorced white  Not partnered\n3                      Unknown white           &lt;NA&gt;\n4       M              Married asian      Partnered\n5                      Unknown white           &lt;NA&gt;\n6                      Unknown white           &lt;NA&gt;\n\n# Recode race status while leaving unknown values as missing\npatients_case_when &lt;- patients_case_when %&gt;%\n  mutate(race_grouped = case_when(\n    RACE == 'white' ~ \"White\",\n    RACE == \"asian\" ~ \"Asian\",\n    RACE == \"native\" | RACE == \"other\" ~ \"Other\",\n    TRUE ~ NA_character_\n  )) %&gt;% \n  select(RACE, race_grouped)\n\nhead(patients_case_when, n=10)\n\n    RACE race_grouped\n1  white        White\n2  white        White\n3  white        White\n4  asian        Asian\n5  white        White\n6  white        White\n7  white        White\n8  white        White\n9  white        White\n10 white        White\n\n# Simple conditional assignment with if_else\npatients$PASSPORT[patients$PASSPORT == \"\"] &lt;- NA # formatting the variable to know missing values\nprint(sum(is.na(patients$PASSPORT))) #  31 missing value\n\n[1] 31\n\npatients_if_else &lt;- patients %&gt;%\n  mutate(has_passport = if_else(!is.na(PASSPORT), \"Yes\", \"No\")) %&gt;% \n  select(PASSPORT, has_passport)\n\nhead(patients_if_else, n = 10)\n\n     PASSPORT has_passport\n1  X47758697X          Yes\n2  X28173268X          Yes\n3        &lt;NA&gt;           No\n4  X83694889X          Yes\n5        &lt;NA&gt;           No\n6        &lt;NA&gt;           No\n7        &lt;NA&gt;           No\n8  X37637991X          Yes\n9        &lt;NA&gt;           No\n10 X59458953X          Yes\n\n# Replace the first occurrence (e.g., fix misspelled city name)\npatients_sub &lt;- patients %&gt;%\n  mutate(city_fixed = sub(\"Nwe York\", \"New York\", CITY)) %&gt;% \n  select(-Id, -DEATHDATE, -SSN, -LAT, -LON, -SUFFIX, -ZIP)\n\nhead(patients_sub, n = 3)\n\n   BIRTHDATE   DRIVERS   PASSPORT PREFIX     FIRST      MIDDLE       LAST\n1 1994-02-06 S99996852 X47758697X    Mr. Joshua658     Alvin56   Kunde533\n2 1968-08-06 S99993577 X28173268X    Mr. Bennie663               Ebert178\n3 2008-12-21                 &lt;NA&gt;        Hunter736 Mckinley734 Gerlach374\n  MAIDEN MARITAL  RACE   ETHNICITY GENDER                  BIRTHPLACE\n1              M white nonhispanic      M   Boston  Massachusetts  US\n2              D white nonhispanic      M Chicopee  Massachusetts  US\n3                white nonhispanic      M  Spencer  Massachusetts  US\n                      ADDRESS         CITY         STATE          COUNTY  FIPS\n1            811 Kihn Viaduct    Braintree Massachusetts  Norfolk County 25021\n2 975 Pfannerstill Throughway    Braintree Massachusetts  Norfolk County 25021\n3             548 Heller Lane Mattapoisett Massachusetts Plymouth County    NA\n  HEALTHCARE_EXPENSES HEALTHCARE_COVERAGE INCOME   city_fixed\n1            56904.96            18019.99 100511    Braintree\n2           124024.12             1075.06  49737    Braintree\n3            45645.06             6154.94 133816 Mattapoisett\n\n# Replace all occurrences (e.g., replace spaces with underscores)\npatients_gsub &lt;- patients %&gt;%\n  mutate(birthplace_clean = gsub(\" \", \"_\", BIRTHPLACE)) %&gt;% \n  select(BIRTHPLACE, birthplace_clean)\n\nhead(patients_gsub, n = 3)\n\n                   BIRTHPLACE            birthplace_clean\n1   Boston  Massachusetts  US   Boston__Massachusetts__US\n2 Chicopee  Massachusetts  US Chicopee__Massachusetts__US\n3  Spencer  Massachusetts  US  Spencer__Massachusetts__US\n\n# Convert last names to lowercase\ntemp &lt;- patients %&gt;% \n  select(-Id, -DEATHDATE, -SSN, -LAT, -LON, -SUFFIX, -ZIP)\n\npatients_tolower &lt;- temp \ncolnames(patients_tolower) &lt;- tolower(colnames(patients_tolower)) \n\nhead(patients_tolower, n = 3)\n\n   birthdate   drivers   passport prefix     first      middle       last\n1 1994-02-06 S99996852 X47758697X    Mr. Joshua658     Alvin56   Kunde533\n2 1968-08-06 S99993577 X28173268X    Mr. Bennie663               Ebert178\n3 2008-12-21                 &lt;NA&gt;        Hunter736 Mckinley734 Gerlach374\n  maiden marital  race   ethnicity gender                  birthplace\n1              M white nonhispanic      M   Boston  Massachusetts  US\n2              D white nonhispanic      M Chicopee  Massachusetts  US\n3                white nonhispanic      M  Spencer  Massachusetts  US\n                      address         city         state          county  fips\n1            811 Kihn Viaduct    Braintree Massachusetts  Norfolk County 25021\n2 975 Pfannerstill Throughway    Braintree Massachusetts  Norfolk County 25021\n3             548 Heller Lane Mattapoisett Massachusetts Plymouth County    NA\n  healthcare_expenses healthcare_coverage income\n1            56904.96            18019.99 100511\n2           124024.12             1075.06  49737\n3            45645.06             6154.94 133816\n\nrm(temp)\n\n#`janitor::clean_names(df)` standardizes variable names:\n\nnames(patients)\n\n [1] \"Id\"                  \"BIRTHDATE\"           \"DEATHDATE\"          \n [4] \"SSN\"                 \"DRIVERS\"             \"PASSPORT\"           \n [7] \"PREFIX\"              \"FIRST\"               \"MIDDLE\"             \n[10] \"LAST\"                \"SUFFIX\"              \"MAIDEN\"             \n[13] \"MARITAL\"             \"RACE\"                \"ETHNICITY\"          \n[16] \"GENDER\"              \"BIRTHPLACE\"          \"ADDRESS\"            \n[19] \"CITY\"                \"STATE\"               \"COUNTY\"             \n[22] \"FIPS\"                \"ZIP\"                 \"LAT\"                \n[25] \"LON\"                 \"HEALTHCARE_EXPENSES\" \"HEALTHCARE_COVERAGE\"\n[28] \"INCOME\"             \n\ntemp &lt;- janitor::clean_names(patients)\ncolnames(temp)\n\n [1] \"id\"                  \"birthdate\"           \"deathdate\"          \n [4] \"ssn\"                 \"drivers\"             \"passport\"           \n [7] \"prefix\"              \"first\"               \"middle\"             \n[10] \"last\"                \"suffix\"              \"maiden\"             \n[13] \"marital\"             \"race\"                \"ethnicity\"          \n[16] \"gender\"              \"birthplace\"          \"address\"            \n[19] \"city\"                \"state\"               \"county\"             \n[22] \"fips\"                \"zip\"                 \"lat\"                \n[25] \"lon\"                 \"healthcare_expenses\" \"healthcare_coverage\"\n[28] \"income\"             \n\n# Remove all temporary objects created in this chunk\nrm(patients_mutated, patients_transmuted, patients_case_when, patients_if_else,\n   patients_split, patients_sub, patients_gsub, patients_tolower, temp)\n\nWarning in rm(patients_mutated, patients_transmuted, patients_case_when, :\nobject 'patients_split' not found\n\n\n\n\nParsing Text Fields in R: Handling Multi-Word Names\nIn real-world datasets, it‚Äôs common to encounter text fields where multiple data elements‚Äîsuch as city, state, and country‚Äîare embedded within a single string. These entries often include inconsistent spacing, making them challenging to analyze directly.\nParsing refers to the process of systematically breaking down these complex text fields into structured, usable components.\nparsing involves\n\nDetecting patterns in spacing‚Äîfor instance, identifying how many spaces exist between different parts of a string.\nDeciding where to split the string. For example, a single space might separate words within a single name such as city name (e.g., \"East Falmouth\"), while two or more spaces might indicate the boundary between city, state, and country (e.g., \"East Falmouth  Massachusetts  US\").\nCreating new variables or columns such as city, state, and country for cleaner and more structured data representation.\n\nparsing is important\n\nMany administrative or imported datasets contain combined or messy fields that hinder direct analysis.\nProper parsing helps to standardize and clean these fields, which is a critical step for effective data management, visualization, and analysis.\nIt enables downstream tasks such as geographic grouping, mapping, and report generation.\n\nSummary Table\n\n\n\n\n\n\n\nStep\nPurpose\n\n\n\n\nstr_view()\nVisually inspect spacing patterns between components\n\n\nstr_extract_all(\" +\")\nExtract all space sequences\n\n\nmap_int(..., length)\nCount the number of space groups per entry\n\n\nstr_count(\"\\\\S+\")\nCount the number of words\n\n\nnchar() with map_chr()\nShow the length of each space between words\n\n\narrange(desc(word_count))\nIdentify rows with the most words (potential outliers)\n\n\n\nDetecting and Understanding Space Patterns\nTo begin, I used example data from the patients$BIRTHPLACE column to identify how different rows are structured and where inconsistencies might exist.\n1. Visual Inspection of Spacing We can use str_view() from the stringr package to highlight space sequences:\n\nstr_view(patients$BIRTHPLACE[1:15], pattern = \" +\", match = TRUE)\n\n [1] ‚îÇ Boston&lt;  &gt;Massachusetts&lt;  &gt;US\n [2] ‚îÇ Chicopee&lt;  &gt;Massachusetts&lt;  &gt;US\n [3] ‚îÇ Spencer&lt;  &gt;Massachusetts&lt;  &gt;US\n [4] ‚îÇ Franklin&lt;  &gt;Massachusetts&lt;  &gt;US\n [5] ‚îÇ Brockton&lt;  &gt;Massachusetts&lt;  &gt;US\n [6] ‚îÇ Plymouth&lt;  &gt;Massachusetts&lt;  &gt;US\n [7] ‚îÇ East&lt; &gt;Falmouth&lt;  &gt;Massachusetts&lt;  &gt;US\n [8] ‚îÇ Methuen&lt;  &gt;Massachusetts&lt;  &gt;US\n [9] ‚îÇ Maynard&lt;  &gt;Massachusetts&lt;  &gt;US\n[10] ‚îÇ Boston&lt;  &gt;Massachusetts&lt;  &gt;US\n[11] ‚îÇ Framingham&lt;  &gt;Massachusetts&lt;  &gt;US\n[12] ‚îÇ Wayland&lt;  &gt;Massachusetts&lt;  &gt;US\n[13] ‚îÇ Toulouse&lt;  &gt;Occitanie&lt;  &gt;FR\n[14] ‚îÇ Framingham&lt;  &gt;Massachusetts&lt;  &gt;US\n[15] ‚îÇ Lynn&lt;  &gt;Massachusetts&lt;  &gt;US\n\n\nThis shows, for example: East&lt; &gt;Falmouth&lt; &gt;Massachusetts&lt; &gt;US Where: - One space connects city words (‚ÄúEast Falmouth‚Äù) - Two spaces separate city, state, and country\n2. Extract and Inspect Space Sequences Each row shows the space segments between words. This helps us detect whether extra or inconsistent spacing is present.\n\npatients %&gt;%\n  mutate(space_groups = str_extract_all(BIRTHPLACE, \" +\")) %&gt;%\n  select(BIRTHPLACE, space_groups) %&gt;%\n  head()\n\n                   BIRTHPLACE space_groups\n1   Boston  Massachusetts  US         ,   \n2 Chicopee  Massachusetts  US         ,   \n3  Spencer  Massachusetts  US         ,   \n4 Franklin  Massachusetts  US         ,   \n5 Brockton  Massachusetts  US         ,   \n6 Plymouth  Massachusetts  US         ,   \n\n\n3. Count Number of Space Groups This gives a frequency table showing how many rows have 2, 3, 4, or more space groups. A row with more than 2 groups may have extra words or inconsistent formatting.\n\npatients %&gt;%\n  mutate(\n    space_groups = str_extract_all(BIRTHPLACE, \" +\"),\n    n_spaces = map_int(space_groups, length)\n  ) %&gt;%\n  count(n_spaces)\n\n  n_spaces  n\n1        2 84\n2        3 15\n3        4  4\n4        5  3\n\n\n4. Count the Number of Words This confirms how many ‚Äúword segments‚Äù are in each row and helps identify malformed entries.\n\npatients %&gt;%\n  mutate(space_count = str_count(BIRTHPLACE, \" +\")) %&gt;%\n  count(space_count)\n\n  space_count  n\n1           2 84\n2           3 15\n3           4  4\n4           5  3\n\n\n5. Combine Word Count and Space Width To fully understand the complexity of each row, I extracted the number of words and the exact space widths between them:\nThis helps in identifying patterns like:\n‚ÄúEast Falmouth Massachusetts US‚Äù ‚Üí 4 words, with spacing like 1 | 2 | 1\n‚ÄúBoston Massachusetts US‚Äù ‚Üí 3 words, spacing 2 | 2\n\npatients %&gt;%\n  mutate(\n    word_count = str_count(BIRTHPLACE, \"\\\\S+\"),  # count non-space words\n    space_groups = str_extract_all(BIRTHPLACE, \" +\"),\n    space_lengths = map_chr(space_groups, ~ paste(nchar(.x), collapse = \" | \"))  # lengths of spaces\n  ) %&gt;%\n  arrange(desc(word_count)) %&gt;%\n  select(BIRTHPLACE, word_count, space_lengths) %&gt;%\n  head(20)\n\n                                 BIRTHPLACE word_count     space_lengths\n1  Santiago de los Caballeros  Santiago  DO          6 1 | 1 | 1 | 2 | 2\n2  Santiago de los Caballeros  Santiago  DO          6 1 | 1 | 1 | 2 | 2\n3  Santiago de los Caballeros  Santiago  DO          6 1 | 1 | 1 | 2 | 2\n4             San Salvador  El Salvador  SV          5     1 | 2 | 1 | 2\n5      Santo Domingo  National District  DO          5     1 | 2 | 1 | 2\n6         Portsmouth  Saint John Parish  DM          5     2 | 1 | 1 | 2\n7           Wesley  Saint Andrew Parish  DM          5     2 | 1 | 1 | 2\n8          East Falmouth  Massachusetts  US          4         1 | 2 | 2\n9       West Springfield  Massachusetts  US          4         1 | 2 | 2\n10        North Pembroke  Massachusetts  US          4         1 | 2 | 2\n11    North Attleborough  Massachusetts  US          4         1 | 2 | 2\n12                   Ponce  Puerto Rico  PR          4         2 | 1 | 2\n13            Fall River  Massachusetts  US          4         1 | 2 | 2\n14       South Deerfield  Massachusetts  US          4         1 | 2 | 2\n15                 Bayamon  Puerto Rico  PR          4         2 | 1 | 2\n16            Oak Bluffs  Massachusetts  US          4         1 | 2 | 2\n17       North Lakeville  Massachusetts  US          4         1 | 2 | 2\n18            Guatemala City  Guatemala  GT          4         1 | 2 | 2\n19         North Andover  Massachusetts  US          4         1 | 2 | 2\n20         North Reading  Massachusetts  US          4         1 | 2 | 2\n\n\nFrom observations in the data, split BIRTHPLACE by 2+ spaces would be more appropriate. Those two words having one space are the names for a city, state or country\n\n# Clean and split birthplace into city, state/region, and country\npatients_clean &lt;- patients %&gt;%\n  mutate(\n    parts = str_split(BIRTHPLACE, \" {2,}\"),             # split BIRTHPLACE by 2+ spaces\n    # %||% is a shorthand from the rlang package (used implicitly here via purrr) that returns the left-hand side if it exists, otherwise returns the right-hand side.\n    # eg If .x[2] exists, use it; otherwise, use NA (missing character).\n    city = map_chr(parts, ~ .x[1] %||% NA_character_),  # city name (first part)\n    state = map_chr(parts, ~ .x[2] %||% NA_character_), # state or region (second part)\n    country = map_chr(parts, ~ .x[3] %||% NA_character_)# country code (third part)\n  ) %&gt;%\n  select(BIRTHPLACE, city, state, country)\nhead(patients_clean, 10)\n\n                         BIRTHPLACE          city         state country\n1         Boston  Massachusetts  US        Boston Massachusetts      US\n2       Chicopee  Massachusetts  US      Chicopee Massachusetts      US\n3        Spencer  Massachusetts  US       Spencer Massachusetts      US\n4       Franklin  Massachusetts  US      Franklin Massachusetts      US\n5       Brockton  Massachusetts  US      Brockton Massachusetts      US\n6       Plymouth  Massachusetts  US      Plymouth Massachusetts      US\n7  East Falmouth  Massachusetts  US East Falmouth Massachusetts      US\n8        Methuen  Massachusetts  US       Methuen Massachusetts      US\n9        Maynard  Massachusetts  US       Maynard Massachusetts      US\n10        Boston  Massachusetts  US        Boston Massachusetts      US\n\ntail(patients_clean, 10)\n\n                                  BIRTHPLACE                       city\n97                 Boston  Massachusetts  US                     Boston\n98     North Attleborough  Massachusetts  US         North Attleborough\n99                Taunton  Massachusetts  US                    Taunton\n100            Chelmsford  Massachusetts  US                 Chelmsford\n101                Boston  Massachusetts  US                     Boston\n102             Holliston  Massachusetts  US                  Holliston\n103 Santiago de los Caballeros  Santiago  DO Santiago de los Caballeros\n104           Springfield  Massachusetts  US                Springfield\n105             Fitchburg  Massachusetts  US                  Fitchburg\n106       Millis-Clicquot  Massachusetts  US            Millis-Clicquot\n            state country\n97  Massachusetts      US\n98  Massachusetts      US\n99  Massachusetts      US\n100 Massachusetts      US\n101 Massachusetts      US\n102 Massachusetts      US\n103      Santiago      DO\n104 Massachusetts      US\n105 Massachusetts      US\n106 Massachusetts      US\n\n\nConclusion From this exploration, we observe that:\n\nMost entries use single spaces within city names (e.g., ‚ÄúEast Falmouth‚Äù)\nTwo or more spaces are commonly used to separate city, state, and country names\nParsing using a split on ‚Äú{2,}‚Äù (two or more spaces) is a reliable strategy\n\n\n\n\nFree-text fields are common in public-health, administrative, and clinical datasets. While they are rich in information, the lack of structure and consistent vocabulary can limit their usefulness. In real-world datasets, especially in health, administration, and survey data, free-text fields often contain rich information hidden in inconsistent or varied language. A single concept (e.g., ‚ÄúCOVID-19 vaccine‚Äù) might appear in many forms such as ‚Äúcovid jab‚Äù, ‚Äúcovid-19 injection‚Äù, or ‚ÄúSARS-CoV-2 shot‚Äù. This presentation demonstrates how to transform unstructured text into structured, analyzable data using R. The workflow covers\n\ntokenization,\nword-frequency analysis,\nstop-word removal,\nTF‚ÄìIDF to highlight context-specific terms,\nword-cloud visualisation,\nbigram and trigram extraction, and\npattern detection with regular expressions to create categorical variables.\n\nBasic Tokenisation and Word-Frequency Table\nTokenisation splits long strings of text into individual words or terms (‚Äútokens‚Äù). This enables us to calculate how often each word appears, which is essential for understanding vocabulary patterns.\nWe begin by loading the necessary R packages. If a package is not already installed.\n\n# Install packages when they are not already available\nif (!require(\"tidytext\")) install.packages(\"tidytext\", dependencies = TRUE)\nif (!require(\"wordcloud\")) install.packages(\"wordcloud\", dependencies = TRUE)\nif (!require(\"tm\"))        install.packages(\"tm\",        dependencies = TRUE)\n\nlibrary(tidytext)   # text mining utilities\nlibrary(wordcloud)  # word-cloud plots\nlibrary(tm)         # text-mining helpers used by wordcloud\n\n\nword_freq &lt;- vaccination %&gt;%\n  unnest_tokens(word, DESCRIPTION) %&gt;%\n  count(word, sort = TRUE) %&gt;%\n  filter(!is.na(word) & word != \"\")\n\nhead(word_freq)\n\n          word   n\n1         free 929\n2 preservative 929\n3    influenza 859\n4   injectable 859\n5     seasonal 859\n6         dose 230\n\n\nRemove Stop Words\nStop words are common terms like ‚Äúand‚Äù, ‚Äúthe‚Äù, or ‚Äúin‚Äù that typically do not contribute meaningful information in analysis. Removing these helps us focus on content-rich terms.\n\ndata(\"stop_words\")          # built-in tidytext stop-word list\n\nword_freq_clean &lt;- vaccination %&gt;%\n  unnest_tokens(word, DESCRIPTION) %&gt;%\n  anti_join(stop_words, by = \"word\") %&gt;%\n  count(word, sort = TRUE)\n\nhead(word_freq_clean)\n\n          word   n\n1         free 929\n2 preservative 929\n3    influenza 859\n4   injectable 859\n5     seasonal 859\n6         dose 230\n\n\n\nVisualise Word Frequencies\nThis bar chart provides a visual overview of the most common meaningful words in the dataset after stop-word removal.\n\nword_freq_clean %&gt;%\n  filter(n &gt; 20) %&gt;%\n  ggplot(aes(x = reorder(word, n), y = n)) +\n  geom_col() +\n  coord_flip() +\n  labs(title = \"Most Frequent Words After Stop-Word Removal\",\n       x = \"Word\",\n       y = \"Count\")\n\n\n\n\n\n\n\n\n\nCreate a Word Cloud\nA word cloud presents word frequencies visually, with more frequent words appearing larger. It offers a quick snapshot of key terms in the dataset.\n\npar(mar = c(1, 1, 1, 1))  # reduce plot margins\nwordcloud(words = word_freq_clean$word,\n          freq = word_freq_clean$n,\n          min.freq = 1,\n          max.words = 100,\n          random.order = FALSE)\n\n\n\n\n\n\n\n\n\nTF‚ÄìIDF Analysis\nTF‚ÄìIDF (Term Frequency‚ÄìInverse Document Frequency) highlights words that are common within a group but rare across groups. This helps identify terms that are contextually important for specific subgroups.\n\n# Example assumes a column called 'source_id' identifies individual documents\n\ntfidf_result &lt;- vaccination %&gt;%\n  select(source_id, DESCRIPTION) %&gt;%\n  unnest_tokens(word, DESCRIPTION) %&gt;%\n  anti_join(stop_words, by = \"word\") %&gt;%\n  count(source_id, word, sort = TRUE) %&gt;%\n  bind_tf_idf(word, source_id, n) %&gt;%\n  arrange(desc(tf_idf))\n\nhead(tfidf_result)\n\n\nBigrams and Trigrams (n-grams)\nSometimes the context of words matters more than individual terms. N-grams (bigrams, trigrams, etc.) allow us to capture meaningful phrases instead of isolated words.\nBigrams ‚Äì two-word phrases\n\nbigrams &lt;- vaccination %&gt;%\n  unnest_tokens(bigram, DESCRIPTION, token = \"ngrams\", n = 2) %&gt;%\n  count(bigram, sort = TRUE)\n\nhead(bigrams)\n\n                   bigram   n\n1       preservative free 929\n2      influenza seasonal 859\n3 injectable preservative 859\n4     seasonal injectable 859\n5                    &lt;NA&gt; 185\n6                covid 19 144\n\n\nTrigrams ‚Äì three-word phrases\n\ntrigrams &lt;- vaccination %&gt;%\n  unnest_tokens(trigram, DESCRIPTION, token = \"ngrams\", n = 3) %&gt;%\n  count(trigram, sort = TRUE)\n\nhead(trigrams)\n\n                           trigram   n\n1    influenza seasonal injectable 859\n2     injectable preservative free 859\n3 seasonal injectable preservative 859\n4                             &lt;NA&gt; 319\n5                      19 mrna lnp 142\n6                    covid 19 mrna 142\n\n\n\nCreate Categorical Variables from free and unstructured Text\nWe use regular expressions to classify unstructured free-text values into consistent categories. This transformation is critical for summarising or modelling based on text. We can identify and map all words that contain a certain substring (like ‚Äúcovid‚Äù in ‚ÄúCOVID-19‚Äù, ‚Äúcovid_19‚Äù, or ‚Äúcovid‚Äù). You can use str_detect() with a case-insensitive regular expression to filter your word frequency table.\n\nvaccination &lt;- vaccination %&gt;%\n  mutate(vaccine_group = case_when(\n    str_detect(DESCRIPTION, regex(\"covid|sars-cov-2\", ignore_case = TRUE)) ~ \"COVID-19\",\n    str_detect(DESCRIPTION, regex(\"influenza\", ignore_case = TRUE)) ~ \"Influenza\",\n    str_detect(DESCRIPTION, regex(\"hepatitis|hep a|hep b\", ignore_case = TRUE)) ~ \"Hepatitis\",\n    str_detect(DESCRIPTION, regex(\"hpv\", ignore_case = TRUE)) ~ \"HPV\",\n    str_detect(DESCRIPTION, regex(\"mmr\", ignore_case = TRUE)) ~ \"MMR\",\n    str_detect(DESCRIPTION, regex(\"dtap|tdap|tetanus|td \\\\(?adult\\\\)?\", ignore_case = TRUE)) ~ \"DTP group\",\n    str_detect(DESCRIPTION, regex(\"ipv\", ignore_case = TRUE)) ~ \"IPV\",\n    str_detect(DESCRIPTION, regex(\"hib\", ignore_case = TRUE)) ~ \"Hib\",\n    str_detect(DESCRIPTION, regex(\"meningococcal|mcv4\", ignore_case = TRUE)) ~ \"Meningococcal\",\n    str_detect(DESCRIPTION, regex(\"pneumococcal.*13\", ignore_case = TRUE)) ~ \"Pneumococcal PCV13\",\n    str_detect(DESCRIPTION, regex(\"pneumococcal.*23\", ignore_case = TRUE)) ~ \"Pneumococcal PPV23\",\n    str_detect(DESCRIPTION, regex(\"rotavirus\", ignore_case = TRUE)) ~ \"Rotavirus\",\n    str_detect(DESCRIPTION, regex(\"varicella\", ignore_case = TRUE)) ~ \"Varicella\",\n    str_detect(DESCRIPTION, regex(\"zoster\", ignore_case = TRUE)) ~ \"Zoster\",\n    TRUE ~ \"Other\"\n  ))\n\n# Frequency check\n\ntable(vaccination$vaccine_group)\n\n\n          COVID-19          DTP group          Hepatitis                Hib \n               144                152                114                 32 \n               HPV          Influenza                IPV      Meningococcal \n                61                859                 51                 52 \n               MMR Pneumococcal PCV13 Pneumococcal PPV23          Rotavirus \n                26                 52                  8                 21 \n         Varicella             Zoster \n                26                 21 \n\n# Grouping Values Using %in% Inside case_when()\n\nvaccination &lt;- vaccination %&gt;%\n  mutate(vacc_group3 = case_when(\n    vaccine_group %in% c(\"COVID-19\", \"Influenza\") ~ \"Respiratory vaccines\",\n    vaccine_group %in% c(\"DTP group\", \"Hepatitis\", \"HPV\", \"Hib\", \"IPV\", \n                         \"Meningococcal\", \"MMR\") ~ \"Childhood vaccines\",\n    TRUE ~ \"Other\"\n  )) %&gt;% \n  select(-ENCOUNTER, -CODE)\n\nhead (vaccination)\n\n                  DATE                              PATIENT\n1 2016-04-10T09:04:48Z 30a6452c-4297-a1ac-977a-6a23237c7b46\n2 2016-04-10T09:04:48Z 30a6452c-4297-a1ac-977a-6a23237c7b46\n3 2016-04-10T09:04:48Z 30a6452c-4297-a1ac-977a-6a23237c7b46\n4 2016-04-10T09:04:48Z 30a6452c-4297-a1ac-977a-6a23237c7b46\n5 2002-10-29T19:07:21Z 34a4dcc4-35fb-6ad5-ab98-be285c586a4f\n6 2005-11-01T19:07:21Z 34a4dcc4-35fb-6ad5-ab98-be285c586a4f\n                                                   DESCRIPTION BASE_COST\n1           Influenza  seasonal  injectable  preservative free       136\n2 Td (adult)  5 Lf tetanus toxoid  preservative free  adsorbed       136\n3                                                 Hep B  adult       136\n4                                          meningococcal MCV4P       136\n5           Influenza  seasonal  injectable  preservative free       136\n6           Influenza  seasonal  injectable  preservative free       136\n   vacc_date year    month vaccine_group          vacc_group3\n1 2016-04-10 2016    April     Influenza Respiratory vaccines\n2 2016-04-10 2016    April     DTP group   Childhood vaccines\n3 2016-04-10 2016    April     Hepatitis   Childhood vaccines\n4 2016-04-10 2016    April Meningococcal   Childhood vaccines\n5 2002-10-29 2002  October     Influenza Respiratory vaccines\n6 2005-11-01 2005 November     Influenza Respiratory vaccines\n\n\nConclusion\nBy combining the tidytext, stringr, and dplyr packages we converted messy free-text into structured data ready for analysis. This approach supports reproducible work, clearer insights, and more robust statistical modelling.\n\n\n\n\n\nCreating factor levels and relabeling\n\nApplying labels with label() and val_labels()\n\nDescriptive summaries with describe()\n\nIn R, categorical variables can be represented as factors to support grouping, modeling, and formatting for reporting. Factor variables store both the value and its associated level label.\nThis section introduces key functions to:\n\nConvert variables into factors\n\nRename or reorder levels for clarity\n\nApply variable-level labels using label() or var_label()\n\nAssign value labels using val_labels() (e.g., 1 = Male)\n\nGenerate descriptive metadata summaries using Hmisc::describe()\n\nValue labels are especially useful when numeric codes represent categorical responses. These can be shown in summaries or retained for export and display.\nYou can choose to display or hide value labels:\noptions(labelled::val_labels_visible = TRUE) # Show values like ‚Äú1 = Male‚Äù options(labelled::val_labels_visible = FALSE) # Show only ‚ÄúMale‚Äù\nüîπ Summary of Functions for Working with Factors and Labels\n\n\n\n\n\n\n\n\nTask\nFunction\nDescription\n\n\n\n\nConvert to factor\nas.factor(x)\nConvert a character or numeric variable into a factor\n\n\nReorder levels\nfactor(x, levels = ...)\nDefine a specific order for levels\n\n\nRename factor levels\nlevels(x) &lt;- c(...)\nManually change the displayed names of factor levels\n\n\nRecode with forcats\nfct_recode(), fct_relevel()\nRelabel, reorder, or collapse factor levels using tidyverse tools\n\n\nApply variable label\nlabel(x) &lt;- \"...\" or var_label(x) &lt;- \"...\"\nAssign a description to a variable\n\n\nApply value labels\nval_labels(x) &lt;- c(\"Label\" = code)\nDefine how codes map to category names (e.g., 1 = Male)\n\n\nRetrieve labels\nlabel(x), val_labels(x)\nView current labels or mappings\n\n\nGenerate summary with labels\nHmisc::describe(df)\nReturn a summary including variable names, labels, types, and distributions\n\n\n\n\n# Select two categorical variables\nvacc_factor &lt;- vacc_pt_merged %&gt;%\n  select(gender, marital)\n\n# Convert character to factor\nvacc_factor &lt;- vacc_factor %&gt;%\n  mutate(\n    gender = factor(gender),\n    marital = factor(marital)\n  )\n\n# Relabel factor levels using fct_recode()\nvacc_factor &lt;- vacc_factor %&gt;%\n  mutate(\n    gender = fct_recode(gender, \"Male\" = \"M\", \"Female\" = \"F\"),\n    marital = fct_recode(marital,\n                         \"Married\" = \"M\",\n                         \"Divorced\" = \"D\",\n                         \"Single\" = \"S\",\n                         \"Widowed\" = \"W\")\n  )\n\ntail(vacc_factor)\n\n     gender marital\n1614 Female  Single\n1615 Female  Single\n1616 Female  Single\n1617 Female  Single\n1618 Female  Single\n1619 Female  Single\n\n# Assign variable labels\nvar_label(vacc_factor$gender) &lt;- \"Biological Sex\"\nvar_label(vacc_factor$marital) &lt;- \"Marital Status\"\n\n# Assign value labels\nvacc_factor$gender_chr &lt;- as.character(vacc_factor$gender) # Convert factor to character\nval_labels(vacc_factor$gender_chr) &lt;- c(\"1\" = \"Male\", \"2\" = \"Female\")\n\n\n# View internal structure and label info\nstr(vacc_factor)\n\n'data.frame':   1619 obs. of  3 variables:\n $ gender    : Factor w/ 2 levels \"Female\",\"Male\": 2 2 2 2 2 2 2 2 2 2 ...\n  ..- attr(*, \"label\")= chr \"Biological Sex\"\n $ marital   : Factor w/ 5 levels \"\",\"Divorced\",..: 3 3 3 3 3 3 2 2 2 2 ...\n  ..- attr(*, \"label\")= chr \"Marital Status\"\n $ gender_chr: chr+lbl [1:1619] Male  , Male  , Male  , Male  , Male  , Male  , Male ...\n   ..@ labels: Named chr  \"Male\" \"Female\"\n   .. ..- attr(*, \"names\")= chr [1:2] \"1\" \"2\"\n\n# Remove bad labels if needed:\nvar_label(vacc_factor$gender) &lt;- NULL\n\n# Remove temporary object\nrm(vacc_factor)\n\n\n\n\n\n# Select two categorical variables\nvacc_factor &lt;- vacc_pt_merged %&gt;%\n  select(gender, marital)\n\n# Convert character to factor\nvacc_factor &lt;- vacc_factor %&gt;%\n  mutate(\n    gender = factor(gender),\n    marital = factor(marital)\n  )\n\n# Relabel factor levels using fct_recode()\nvacc_factor &lt;- vacc_factor %&gt;%\n  mutate(\n    gender = fct_recode(gender, \"Male\" = \"M\", \"Female\" = \"F\"),\n    marital = fct_recode(marital,\n                         \"Married\" = \"M\",\n                         \"Divorced\" = \"D\",\n                         \"Single\" = \"S\",\n                         \"Widowed\" = \"W\")\n  )\n\ntail(vacc_factor)\n\n     gender marital\n1614 Female  Single\n1615 Female  Single\n1616 Female  Single\n1617 Female  Single\n1618 Female  Single\n1619 Female  Single\n\n# Assign variable labels\nvar_label(vacc_factor$gender) &lt;- \"Biological Sex\"\nvar_label(vacc_factor$marital) &lt;- \"Marital Status\"\n\n# Assign value labels\nvacc_factor$gender_chr &lt;- as.character(vacc_factor$gender) # Convert factor to character\nval_labels(vacc_factor$gender_chr) &lt;- c(\"1\" = \"Male\", \"2\" = \"Female\")\n\n\n# View internal structure and label info\nstr(vacc_factor)\n\n'data.frame':   1619 obs. of  3 variables:\n $ gender    : Factor w/ 2 levels \"Female\",\"Male\": 2 2 2 2 2 2 2 2 2 2 ...\n  ..- attr(*, \"label\")= chr \"Biological Sex\"\n $ marital   : Factor w/ 5 levels \"\",\"Divorced\",..: 3 3 3 3 3 3 2 2 2 2 ...\n  ..- attr(*, \"label\")= chr \"Marital Status\"\n $ gender_chr: chr+lbl [1:1619] Male  , Male  , Male  , Male  , Male  , Male  , Male ...\n   ..@ labels: Named chr  \"Male\" \"Female\"\n   .. ..- attr(*, \"names\")= chr [1:2] \"1\" \"2\"\n\n# Remove bad labels if needed:\nvar_label(vacc_factor$gender) &lt;- NULL\n\n# Remove temporary object\nrm(vacc_factor)\n\n\ngroup_by(), summarize(), ungroup()\nRow and column percentages: details presented in section 7.2 below\nWeighted summaries with wt =\n\nGrouping and summarizing data is fundamental for understanding patterns, distributions, and relationships within datasets.\nIn dplyr, the functions group_by() and summarize() are used together to calculate statistics across different groups.\nWe can also calculate proportions (row-wise or column-wise) and perform weighted summaries when necessary. The details regarding row and column percentages are presented in section 7.2 below.\nThese steps are critical for aggregating information into meaningful insights, especially when working with categorical, grouped, or longitudinal data.\n\nüîπ Summary of Functions for Grouping and Summarizing\n\n\n\n\n\n\n\n\nTask\nFunction\nPurpose\n\n\n\n\nGroup data by one or more variables\ngroup_by()\nDefine groups for aggregation\n\n\nSummarize grouped data\nsummarize()\nApply aggregation functions (e.g., mean, sum, count)\n\n\nRemove grouping structure\nungroup()\nReturn to ungrouped state after summary\n\n\nCalculate row-wise or column-wise proportions\nManual with mutate(), prop.table(), etc.\nUnderstand percentage distribution within/between groups\n\n\nWeighted summaries\nsummarize(wt = )\nCompute weighted means, sums, or percentages when different rows contribute differently\n\n\n\n\n‚û°Ô∏è Grouping and summarization allow efficient exploration of key relationships and preparation of clean summary tables.\n\n\n# ....................................................\n# Grouping and Summarizing Breast Cancer Data\n# ....................................................\n\n# Grouping by SA3 name, State, and Year, and summarizing participation\nbc_summary_year &lt;- breast_cancer_data %&gt;%\n  group_by(year) %&gt;%\n  summarise(\n    total_participants = sum(part50_74, na.rm = TRUE),\n    total_population = sum(pop50_74, na.rm = TRUE),\n    mean_screening_rate = mean(rate50_74, na.rm = TRUE),\n    .groups = \"drop\"\n  )\nhead(bc_summary_year, n = 3)\n\n# A tibble: 3 √ó 4\n    year total_participants total_population mean_screening_rate\n   &lt;int&gt;              &lt;dbl&gt;            &lt;dbl&gt;               &lt;dbl&gt;\n1 201617            1720463          3127749                54.9\n2 201718            1748606          3187574                54.7\n3 201819            1781484          3247470                54.6\n\n# --- Create Vaccination Pattern Dataset ---\ndf_vaccination_plot &lt;- vaccination %&gt;%\n  group_by(year, month, vaccine_group) %&gt;%\n  summarise(\n    count = n(),  # Number of records per year-month-vaccine_group combination\n    .groups = \"drop\"\n  ) %&gt;%\n  ungroup() %&gt;%\n  group_by(year, month) %&gt;%\n  mutate(\n    count_month = sum(count)  # Total vaccines in that year-month across all groups\n  ) %&gt;%\n  ungroup() %&gt;%\n  mutate(\n    proportion_month = round((count / count_month) * 100, 1)  # % per vaccine group within month\n  ) %&gt;%\n  group_by(year) %&gt;%\n  mutate(\n    total_year = sum(count)  # Total vaccines across the year\n  ) %&gt;%\n  mutate(\n    proportion_year = round((count / total_year) * 100, 1)  # % per vaccine group within year\n  ) %&gt;%\n  ungroup()\n\n# View first few rows\ntail(df_vaccination_plot)\n\n# A tibble: 6 √ó 8\n  year  month     vaccine_group count count_month proportion_month total_year\n  &lt;chr&gt; &lt;chr&gt;     &lt;chr&gt;         &lt;int&gt;       &lt;int&gt;            &lt;dbl&gt;      &lt;int&gt;\n1 2024  October   Zoster            1          15              6.7        122\n2 2024  September COVID-19          1          15              6.7        122\n3 2024  September DTP group         2          15             13.3        122\n4 2024  September HPV               2          15             13.3        122\n5 2024  September Influenza         9          15             60          122\n6 2024  September Meningococcal     1          15              6.7        122\n# ‚Ñπ 1 more variable: proportion_year &lt;dbl&gt;\n\n# Enhanced summary of breast cancer screening data with SA3, State, and National Year-level proportions\n# use na.rm = TRUE to remove (ignore) missing values (NA) when calculating\n\nbc_summary &lt;- breast_cancer_data %&gt;%\n  # Group by SA3 area, State, and Year\n  group_by(sa3name, state, year) %&gt;%\n  summarise(\n    total_participants = sum(part50_74, na.rm = TRUE),  # Sum of screened participants\n    total_population = sum(pop50_74, na.rm = TRUE),     # Sum of target population\n    .groups = \"drop\"\n  ) %&gt;%\n  # Calculate SA3-level screening rate and proportion\n  mutate(\n    screening_rate = round((total_participants / total_population) * 100, 1),  # % screened in that SA3\n    proportion_area = round((total_participants / sum(total_participants)) * 100, 1)  # % contribution to national participants\n  ) %&gt;%\n  # Add State-level aggregated summaries\n  group_by(state, year) %&gt;%\n  mutate(\n    state_sa3 = n(),  # Number of SA3 areas within each State-Year\n    state_total_participants = sum(total_participants, na.rm = TRUE),  # State-wide participants\n    state_total_population = sum(total_population, na.rm = TRUE),      # State-wide target population\n    state_screening_rate = round((state_total_participants / state_total_population) * 100, 1),  # % screened at State level\n    state_proportion = round((state_total_participants / sum(total_participants)) * 100, 1)  # State share of total participants\n  ) %&gt;%\n  ungroup() %&gt;%\n  # Add National Year-level aggregated summaries\n  group_by(year) %&gt;%\n  mutate(\n    year_sa3 = n(),  # Number of SA3 areas within each Year\n    year_total_participants = sum(total_participants, na.rm = TRUE),  # Australia-wide participants for that year\n    year_total_population = sum(total_population, na.rm = TRUE),      # Australia-wide target population for that year\n    year_screening_rate = round((year_total_participants / year_total_population) * 100, 1),  # National % screened\n    year_proportion = round((year_total_participants / sum(total_participants)) * 100, 1)  # National share\n  ) %&gt;%\n  ungroup() %&gt;%\n  arrange(year, state, sa3name)   # Final arrangement for neat viewing\n\n# View the last few rows\ntail(bc_summary)\n\n# A tibble: 6 √ó 17\n  sa3name        state   year total_participants total_population screening_rate\n  &lt;chr&gt;          &lt;chr&gt;  &lt;int&gt;              &lt;dbl&gt;            &lt;dbl&gt;          &lt;dbl&gt;\n1 Stirling       WA    201920              13878            27265           50.9\n2 Swan           WA    201920               8513            17274           49.3\n3 Wanneroo       WA    201920              12032            24345           49.4\n4 West Pilbara   WA    201920                828             2409           34.4\n5 Wheat Belt - ‚Ä¶ WA    201920               4947             9813           50.4\n6 Wheat Belt - ‚Ä¶ WA    201920               1446             3342           43.3\n# ‚Ñπ 11 more variables: proportion_area &lt;dbl&gt;, state_sa3 &lt;int&gt;,\n#   state_total_participants &lt;dbl&gt;, state_total_population &lt;dbl&gt;,\n#   state_screening_rate &lt;dbl&gt;, state_proportion &lt;dbl&gt;, year_sa3 &lt;int&gt;,\n#   year_total_participants &lt;dbl&gt;, year_total_population &lt;dbl&gt;,\n#   year_screening_rate &lt;dbl&gt;, year_proportion &lt;dbl&gt;\n\n# ....................................................\n# Calculating Proportions: details presented in section 7.2 below\n# ....................................................\n\n# Adding participation proportion within each SA3-year group\nbc_summary_with_prop &lt;- bc_summary %&gt;%\n  mutate(\n    participation_rate = (total_participants / total_population) * 100\n  ) %&gt;% \n  select(participation_rate)\n\nhead(bc_summary_with_prop)\n\n# A tibble: 6 √ó 1\n  participation_rate\n               &lt;dbl&gt;\n1               56.1\n2              NaN  \n3               53.8\n4              NaN  \n5               54.5\n6               55.1\n\n# ....................................................\n# Weighted Summarization (Weighted Average Screening Rate)\n# ....................................................\n\n# Calculate weighted mean screening rate by SA3\nbc_weighted_summary &lt;- breast_cancer_data %&gt;%\n  group_by(sa3name, state, year) %&gt;%\n  summarise(\n    total_participants = sum(part50_74, na.rm = TRUE),\n    total_population = sum(pop50_74, na.rm = TRUE),\n    weighted_screening_rate = round(sum(rate50_74 * pop50_74, na.rm = TRUE) / sum(pop50_74, na.rm = TRUE), 1),\n    .groups = \"drop\"\n  )\n\nhead(bc_weighted_summary)\n\n# A tibble: 6 √ó 6\n  sa3name        state   year total_participants total_population\n  &lt;chr&gt;          &lt;chr&gt;  &lt;int&gt;              &lt;dbl&gt;            &lt;dbl&gt;\n1 Adelaide City  SA    201617               1280             2537\n2 Adelaide City  SA    201718               1314             2608\n3 Adelaide City  SA    201819               1368             2642\n4 Adelaide City  SA    201920               1208             2707\n5 Adelaide Hills SA    201617               7010            11636\n6 Adelaide Hills SA    201718               7096            11876\n# ‚Ñπ 1 more variable: weighted_screening_rate &lt;dbl&gt;\n\n# ....................................................\n# Remove all temporary objects created in this chunk\n# ....................................................\nrm(bc_summary, bc_summary_with_prop, bc_weighted_summary)\n\n\n\n\n\narrange(), desc()\nslice_max(), slice_min(), top_n()\nRanking data and filtering top/bottom groups\n\nSorting and reordering data is important for finding trends, identifying extremes (top or bottom performers), and preparing tables for reporting or visualization.\nIn dplyr, the arrange() function sorts datasets by one or more variables, while desc() allows descending (reverse) order.\nFor selecting specific rows like top N or bottom N values, slice_max() and slice_min() are commonly used.\nThese techniques allow focusing on key records, comparing rankings across groups, and making datasets easier to review.\n\nüîπ Summary of Functions for Sorting and Reordering\n\n\n\n\n\n\n\n\nTask\nFunction\nPurpose\n\n\n\n\nSort ascending order\narrange()\nSort rows by one or more variables (lowest to highest)\n\n\nSort descending order\narrange(desc())\nSort rows highest to lowest\n\n\nSelect top N rows by a variable\nslice_max()\nKeep top N records based on a variable\n\n\nSelect bottom N rows by a variable\nslice_min()\nKeep bottom N records based on a variable\n\n\nSelect top N rows (old method)\ntop_n()\nDeprecated alternative to slice_max() (not recommended now)\n\n\nRank within groups\nmutate(rank = row_number())\nCreate custom ranking inside grouped data\n\n\n\n\n‚û°Ô∏è Sorting and slicing help prioritize key data points and create targeted outputs for decision-making or visualization.\n\n\n# ....................................................\n# Sorting, Reordering, Slicing, and Arranging (Breast Cancer Data)\n# ....................................................\n\n# Sorting by Screening Rate in Ascending Order\nbc_sorted_rate &lt;- breast_cancer_data %&gt;%\n  arrange(rate50_74) %&gt;%\n  select(sa3code, sa3coden, sa3name, state, year,\n         part50_74, pop50_74, rate50_74, agen50_74, expct50_74)\n\nhead(bc_sorted_rate)\n\n  sa3code sa3coden        sa3name state   year part50_74 pop50_74 rate50_74\n1   90104    90104 Norfolk Island Other 201920        24      441   5.40000\n2   90104    90104 Norfolk Island Other 201819        31      422   7.30000\n3   90104    90104 Norfolk Island Other 201718        39      401   9.70000\n4   70205    70205      Katherine    NT 201920       412     2011  20.51335\n5   51002    51002   East Pilbara    WA 201920       562     1987  28.26220\n6   51002    51002   East Pilbara    WA 201819       567     1918  29.55425\n  agen50_74 expct50_74\n1         3        220\n2         3        231\n3         3        219\n4         3       1003\n5         3        991\n6         3       1051\n\n# Sorting by Screening Rate in Descending Order\nbc_sorted_rate_desc &lt;- breast_cancer_data %&gt;%\n  arrange(desc(rate50_74)) %&gt;%\n  select(sa3code, sa3coden, sa3name, state, year,\n         part50_74, pop50_74, rate50_74, agen50_74, expct50_74)\n\nhead(bc_sorted_rate_desc)\n\n  sa3code sa3coden                        sa3name state   year part50_74\n1   90102    90102        Cocos (Keeling) Islands Other 201920        81\n2   31801    31801 Charters Towers - Ayr - Ingham   Qld 201617      4628\n3   60102    60102            Hobart - North East   Tas 201718      5856\n4   60104    60104        Hobart - South and West   Tas 201718      3643\n5   11004    11004            Tamworth - Gunnedah   NSW 201819      8426\n6   31801    31801 Charters Towers - Ayr - Ingham   Qld 201718      4612\n  pop50_74 rate50_74 agen50_74 expct50_74\n1      101  80.20000         3         50\n2     6713  68.90000         3       3692\n3     8566  68.36348         3       4694\n4     5331  68.34190         3       2921\n5    12333  68.32168         3       6758\n6     6759  68.23824         3       3703\n\n# Slicing Top 10 SA3s with Highest Screening Rates\nbc_top_screening &lt;- breast_cancer_data %&gt;%\n  slice_max(order_by = rate50_74, n = 10) %&gt;%\n  select(sa3code, sa3coden, sa3name, state, year,\n         part50_74, pop50_74, rate50_74, agen50_74, expct50_74)\n\nbc_top_screening\n\n   sa3code sa3coden                        sa3name state   year part50_74\n1    90102    90102        Cocos (Keeling) Islands Other 201920        81\n2    31801    31801 Charters Towers - Ayr - Ingham   Qld 201617      4628\n3    60102    60102            Hobart - North East   Tas 201718      5856\n4    60104    60104        Hobart - South and West   Tas 201718      3643\n5    11004    11004            Tamworth - Gunnedah   NSW 201819      8426\n6    31801    31801 Charters Towers - Ayr - Ingham   Qld 201718      4612\n7    11001    11001                       Armidale   NSW 201617      3810\n8    60102    60102            Hobart - North East   Tas 201819      5881\n9    31801    31801 Charters Towers - Ayr - Ingham   Qld 201819      4588\n10   31801    31801 Charters Towers - Ayr - Ingham   Qld 201920      4580\n   pop50_74 rate50_74 agen50_74 expct50_74\n1       101  80.20000         3         50\n2      6713  68.90000         3       3692\n3      8566  68.36348         3       4694\n4      5331  68.34190         3       2921\n5     12333  68.32168         3       6758\n6      6759  68.23824         3       3703\n7      5602  68.00000         3       3081\n8      8698  67.61016         3       4766\n9      6797  67.49974         3       3724\n10     6818  67.17431         3       3402\n\n# Slicing Bottom 5 SA3s with Lowest Screening Rates\nbc_bottom_screening &lt;- breast_cancer_data %&gt;%\n  slice_min(order_by = rate50_74, n = 5) %&gt;%\n  select(sa3code, sa3coden, sa3name, state, year,\n         part50_74, pop50_74, rate50_74, agen50_74, expct50_74)\n\nbc_bottom_screening\n\n  sa3code sa3coden        sa3name state   year part50_74 pop50_74 rate50_74\n1   90104    90104 Norfolk Island Other 201920        24      441   5.40000\n2   90104    90104 Norfolk Island Other 201819        31      422   7.30000\n3   90104    90104 Norfolk Island Other 201718        39      401   9.70000\n4   70205    70205      Katherine    NT 201920       412     2011  20.51335\n5   51002    51002   East Pilbara    WA 201920       562     1987  28.26220\n  agen50_74 expct50_74\n1         3        220\n2         3        231\n3         3        219\n4         3       1003\n5         3        991\n\n# Ranking Within Each State\nbc_ranked &lt;- breast_cancer_data %&gt;%\n  group_by(state) %&gt;%\n  arrange(desc(rate50_74), .by_group = TRUE) %&gt;%\n  mutate(screening_rank = row_number()) %&gt;%\n  select(screening_rank, rate50_74, state) %&gt;% \n  ungroup()\n\nhead(bc_ranked, n = 10)\n\n# A tibble: 10 √ó 3\n   screening_rank rate50_74 state\n            &lt;int&gt;     &lt;dbl&gt; &lt;chr&gt;\n 1              1      59.9 ACT  \n 2              2      58.8 ACT  \n 3              3      58.4 ACT  \n 4              4      58   ACT  \n 5              5      57.7 ACT  \n 6              6      57.4 ACT  \n 7              7      57.2 ACT  \n 8              8      57.1 ACT  \n 9              9      57.0 ACT  \n10             10      56.7 ACT  \n\n# ....................................................\n# Remove all temporary objects created in this chunk\n# ....................................................\nrm(bc_sorted_rate, bc_sorted_rate_desc, bc_top_screening, bc_bottom_screening, bc_ranked)\n\n\n\n\n\npivot_longer(), pivot_wider()\nWide-to-long and long-to-wide transformations\nSeparating and uniting columns with separate() and unite()\n\n\nIn data analysis, datasets often need to be reorganized ‚Äî from wide format to long format, or vice versa ‚Äî to suit different types of analysis or visualization.\nThe goal is to follow Tidy Data principles where: - Each variable forms a column - Each observation forms a row - Each type of observational unit forms a table\ndplyr and tidyr provide key functions for reshaping: - pivot_longer() turns many columns into two columns (variable name and value). - pivot_wider() spreads one column into multiple columns. - separate() splits one column into multiple columns based on a separator. - unite() combines multiple columns into one.\nThese tools help create clean, organized datasets ready for efficient analysis and plotting.\n\nüîπ Summary of Functions for Reshaping and Tidy Data\n\n\n\n\n\n\n\n\nTask\nFunction\nPurpose\n\n\n\n\nReshape wide to long\npivot_longer()\nCollapse multiple columns into key-value pairs\n\n\nReshape long to wide\npivot_wider()\nSpread key-value pairs across multiple columns\n\n\nSplit a column into multiple parts\nseparate()\nSeparate one column into several columns by a delimiter\n\n\nCombine multiple columns into one\nunite()\nMerge several columns into a single column\n\n\n\n\n‚û°Ô∏è These reshaping techniques make it easy to transform datasets into a tidy structure for summaries, modeling, or visualization.\n\n** üîé Regular Expression Tip for names_pattern**\n\n\nIn pivot_longer(), we use a regular expression to split the column names into two components: - part, pop, rate, or expct ‚Üí measure - 50_54, 55_59, etc. ‚Üí age group The pattern ([0-9]{2}_[0-9]{2}) works as follows:\n\n\n\n\n\nComponent\nMeaning\n\n\n\n\n[0-9]\nMatch any digit (0‚Äì9)\n\n\n{2}\nExactly two digits\n\n\n_\nAn underscore\n\n\n[0-9]{2}\nAnother two digits\n\n\n\n‚û°Ô∏è This captures typical age formats like 50_54, 60_64, etc.\n\nOriginal Column Name: rate50_54\nComponents: ‚îå‚îÄ‚îÄ‚îÄ‚îê ‚îå‚îÄ‚îÄ‚îÄ‚îê ‚Ä¶.&gt; ‚îÇrate ‚îÇ ‚îÇ50_54 ‚îÇ &gt; ‚îî‚îÄ‚îò ‚îî‚îÄ‚îÄ‚îò\n\n# ....................................................\n# Reshaping, Separate and Unite Columns: Breast Cancer Data\n# ....................................................\n\n# Pivot longer by extracting measure type and age group separately\nbreast_cancer_long &lt;- breast_cancer_data %&gt;%\n  pivot_longer(\n    cols = starts_with(\"part\") | starts_with(\"pop\") | starts_with(\"rate\") | starts_with(\"expct\"),\n    names_to = c(\"measure\", \"age_group\"),\n    names_pattern = \"(part|pop|rate|expct)([0-9]{2}_[0-9]{2})\",\n    values_to = \"value\"\n  ) %&gt;%\n  relocate(measure, age_group, .before = sa3code)\n\nhead(breast_cancer_long, n = 10)\n\n# A tibble: 10 √ó 15\n   measure age_group sa3code sa3coden sa3name   state   year agen50_74 agen50_69\n   &lt;chr&gt;   &lt;chr&gt;       &lt;int&gt;    &lt;int&gt; &lt;chr&gt;     &lt;chr&gt;  &lt;int&gt;     &lt;int&gt;     &lt;int&gt;\n 1 part    50_74       10102    10102 Queanbey‚Ä¶ NSW   201617         3         2\n 2 part    50_69       10102    10102 Queanbey‚Ä¶ NSW   201617         3         2\n 3 part    50_54       10102    10102 Queanbey‚Ä¶ NSW   201617         3         2\n 4 part    55_59       10102    10102 Queanbey‚Ä¶ NSW   201617         3         2\n 5 part    60_64       10102    10102 Queanbey‚Ä¶ NSW   201617         3         2\n 6 part    65_69       10102    10102 Queanbey‚Ä¶ NSW   201617         3         2\n 7 part    70_74       10102    10102 Queanbey‚Ä¶ NSW   201617         3         2\n 8 pop     50_74       10102    10102 Queanbey‚Ä¶ NSW   201617         3         2\n 9 pop     50_69       10102    10102 Queanbey‚Ä¶ NSW   201617         3         2\n10 pop     50_54       10102    10102 Queanbey‚Ä¶ NSW   201617         3         2\n# ‚Ñπ 6 more variables: agen50_54 &lt;int&gt;, agen55_59 &lt;int&gt;, agen60_64 &lt;int&gt;,\n#   agen65_69 &lt;int&gt;, agen70_74 &lt;int&gt;, value &lt;dbl&gt;\n\n# Pivot wider to spread measures into separate columns\nbreast_cancer_final &lt;- breast_cancer_long %&gt;%\n  pivot_wider(\n    names_from = measure,\n    values_from = value\n  ) %&gt;%\n  relocate(part, pop, rate, expct, .before = sa3code)\n\nhead(breast_cancer_final, n = 5)\n\n# A tibble: 5 √ó 17\n  age_group  part   pop  rate expct sa3code sa3coden sa3name    state   year\n  &lt;chr&gt;     &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;   &lt;int&gt;    &lt;int&gt; &lt;chr&gt;      &lt;chr&gt;  &lt;int&gt;\n1 50_74      4875  8052  60.5  4428   10102    10102 Queanbeyan NSW   201617\n2 50_69      4309  7145  60.3  3929   10102    10102 Queanbeyan NSW   201617\n3 50_54      1284  2251  57    1118   10102    10102 Queanbeyan NSW   201617\n4 55_59      1188  1970  60.3  1046   10102    10102 Queanbeyan NSW   201617\n5 60_64      1012  1625  62.3   950   10102    10102 Queanbeyan NSW   201617\n# ‚Ñπ 7 more variables: agen50_74 &lt;int&gt;, agen50_69 &lt;int&gt;, agen50_54 &lt;int&gt;,\n#   agen55_59 &lt;int&gt;, agen60_64 &lt;int&gt;, agen65_69 &lt;int&gt;, agen70_74 &lt;int&gt;\n\n# Separate 'age_group' into two new columns: start and end age\nbreast_cancer_separated &lt;- breast_cancer_long %&gt;%\n  separate(\n    col = age_group,\n    into = c(\"age_start\", \"age_end\"),\n    sep = \"_\",\n    convert = TRUE\n  ) %&gt;% \n  select(\"age_start\", \"age_end\", everything())\n\nhead(breast_cancer_separated, n = 3)\n\n# A tibble: 3 √ó 16\n  age_start age_end measure sa3code sa3coden sa3name    state   year agen50_74\n      &lt;int&gt;   &lt;int&gt; &lt;chr&gt;     &lt;int&gt;    &lt;int&gt; &lt;chr&gt;      &lt;chr&gt;  &lt;int&gt;     &lt;int&gt;\n1        50      74 part      10102    10102 Queanbeyan NSW   201617         3\n2        50      69 part      10102    10102 Queanbeyan NSW   201617         3\n3        50      54 part      10102    10102 Queanbeyan NSW   201617         3\n# ‚Ñπ 7 more variables: agen50_69 &lt;int&gt;, agen50_54 &lt;int&gt;, agen55_59 &lt;int&gt;,\n#   agen60_64 &lt;int&gt;, agen65_69 &lt;int&gt;, agen70_74 &lt;int&gt;, value &lt;dbl&gt;\n\n# Unite 'age_start' and 'age_end' into a single age group label\nbreast_cancer_united &lt;- breast_cancer_separated %&gt;%\n  unite(\n    col = age_group_combined,\n    age_start, age_end,\n    sep = \"-\",\n    remove = FALSE\n  )\n\nhead(breast_cancer_united, n = 3)\n\n# A tibble: 3 √ó 17\n  age_group_combined age_start age_end measure sa3code sa3coden sa3name    state\n  &lt;chr&gt;                  &lt;int&gt;   &lt;int&gt; &lt;chr&gt;     &lt;int&gt;    &lt;int&gt; &lt;chr&gt;      &lt;chr&gt;\n1 50-74                     50      74 part      10102    10102 Queanbeyan NSW  \n2 50-69                     50      69 part      10102    10102 Queanbeyan NSW  \n3 50-54                     50      54 part      10102    10102 Queanbeyan NSW  \n# ‚Ñπ 9 more variables: year &lt;int&gt;, agen50_74 &lt;int&gt;, agen50_69 &lt;int&gt;,\n#   agen50_54 &lt;int&gt;, agen55_59 &lt;int&gt;, agen60_64 &lt;int&gt;, agen65_69 &lt;int&gt;,\n#   agen70_74 &lt;int&gt;, value &lt;dbl&gt;\n\n# ....................................................\n# Remove temporary objects created in this chunk\n# ....................................................\nrm(breast_cancer_long, breast_cancer_separated, breast_cancer_united, breast_cancer_final)"
  },
  {
    "objectID": "Post_Blog/Visualisations/index_original.html#part-iv-advanced-wrangling-and-integration",
    "href": "Post_Blog/Visualisations/index_original.html#part-iv-advanced-wrangling-and-integration",
    "title": "Date Manipulation and Wrangling using R",
    "section": "",
    "text": "lubridate::ymd(), as_date(), format(), %p, weekdays()\nExtracting date components: year, month, quarter\n\nWorking with dates is essential in many datasets, particularly for time-based trends, age calculations, seasonal effects, and survival analysis.\nWe use the lubridate package to parse, extract, and manipulate dates efficiently. The details about time and date data has been presented separately.\n‚û°Ô∏è For full tutorials and videos: - YouTube (AnalyticsHub): Watch Full Video - GitHub: Access Here\nSummary of Functions for Date Handling\n\n\n\n\n\n\n\n\nTask\nFunction\nPurpose\n\n\n\n\nParse ISO dates\nas.Date(), strptime()\nRead and convert raw string timestamps\n\n\nFormat date output\nformat()\nCustomize how dates are displayed\n\n\nExtract components\nyear(), month(), day(), quarter(), week()\nPull year, month, day, quarter, week from dates\n\n\nWeekday labels\nwday(label = TRUE)\nGet day of week in text form\n\n\nDate arithmetic\ndifftime(), -\nCalculate differences between dates\n\n\nLogical operations\n&lt;, &gt;, between()\nFilter by date ranges\n\n\nFiscal/seasonal grouping\ncase_when()\nCategorize based on seasons or financial years\n\n\n\n\nDemonstration using Vaccination Dataset\n\n# Convert DATE into usable R date format\nvaccination &lt;- vaccination %&gt;%\n  mutate(\n    vacc_date = as.Date(strptime(date, format = \"%Y-%m-%dT%H:%M:%SZ\")),\n    vacc_year = year(vacc_date),\n    vacc_month = month(vacc_date, label = TRUE, abbr = FALSE)\n  ) %&gt;% \n  select(-description, base_cost)\n\nhead(vaccination)\n\n                  date                              patient base_cost\n1 2016-04-10T09:04:48Z 30a6452c-4297-a1ac-977a-6a23237c7b46       136\n2 2016-04-10T09:04:48Z 30a6452c-4297-a1ac-977a-6a23237c7b46       136\n3 2016-04-10T09:04:48Z 30a6452c-4297-a1ac-977a-6a23237c7b46       136\n4 2016-04-10T09:04:48Z 30a6452c-4297-a1ac-977a-6a23237c7b46       136\n5 2002-10-29T19:07:21Z 34a4dcc4-35fb-6ad5-ab98-be285c586a4f       136\n6 2005-11-01T19:07:21Z 34a4dcc4-35fb-6ad5-ab98-be285c586a4f       136\n   vacc_date year    month vaccine_group          vacc_group3 vacc_year\n1 2016-04-10 2016    April     Influenza Respiratory vaccines      2016\n2 2016-04-10 2016    April     DTP group   Childhood vaccines      2016\n3 2016-04-10 2016    April     Hepatitis   Childhood vaccines      2016\n4 2016-04-10 2016    April Meningococcal   Childhood vaccines      2016\n5 2002-10-29 2002  October     Influenza Respiratory vaccines      2002\n6 2005-11-01 2005 November     Influenza Respiratory vaccines      2005\n  vacc_month\n1      April\n2      April\n3      April\n4      April\n5    October\n6   November\n\n\nCalculating Time Differences\n\n# Calculating Time Differences\n\n# Convert column names to lowercase\ncolnames(patients) &lt;- tolower(colnames(patients))\ncolnames(vaccination) &lt;- tolower(colnames(vaccination))\n\n# vacc_pt_merged &lt;- left_join(patients, vaccination, by = \"id\" )\nvacc_pt_merged &lt;- left_join(patients, vaccination, by = c(\"id\" = \"patient\"))\n\nstr (vacc_pt_merged)\n\n'data.frame':   1619 obs. of  37 variables:\n $ id                 : chr  \"30a6452c-4297-a1ac-977a-6a23237c7b46\" \"30a6452c-4297-a1ac-977a-6a23237c7b46\" \"30a6452c-4297-a1ac-977a-6a23237c7b46\" \"30a6452c-4297-a1ac-977a-6a23237c7b46\" ...\n $ birthdate          : chr  \"1994-02-06\" \"1994-02-06\" \"1994-02-06\" \"1994-02-06\" ...\n $ deathdate          : chr  \"\" \"\" \"\" \"\" ...\n $ ssn                : chr  \"999-52-8591\" \"999-52-8591\" \"999-52-8591\" \"999-52-8591\" ...\n $ drivers            : chr  \"S99996852\" \"S99996852\" \"S99996852\" \"S99996852\" ...\n $ passport           : chr  \"X47758697X\" \"X47758697X\" \"X47758697X\" \"X47758697X\" ...\n $ prefix             : chr  \"Mr.\" \"Mr.\" \"Mr.\" \"Mr.\" ...\n $ first              : chr  \"Joshua658\" \"Joshua658\" \"Joshua658\" \"Joshua658\" ...\n $ middle             : chr  \"Alvin56\" \"Alvin56\" \"Alvin56\" \"Alvin56\" ...\n $ last               : chr  \"Kunde533\" \"Kunde533\" \"Kunde533\" \"Kunde533\" ...\n $ suffix             : logi  NA NA NA NA NA NA ...\n $ maiden             : chr  \"\" \"\" \"\" \"\" ...\n $ marital            : chr  \"M\" \"M\" \"M\" \"M\" ...\n $ race               : chr  \"white\" \"white\" \"white\" \"white\" ...\n $ ethnicity          : chr  \"nonhispanic\" \"nonhispanic\" \"nonhispanic\" \"nonhispanic\" ...\n $ gender             : chr  \"M\" \"M\" \"M\" \"M\" ...\n $ birthplace         : chr  \"Boston  Massachusetts  US\" \"Boston  Massachusetts  US\" \"Boston  Massachusetts  US\" \"Boston  Massachusetts  US\" ...\n $ address            : chr  \"811 Kihn Viaduct\" \"811 Kihn Viaduct\" \"811 Kihn Viaduct\" \"811 Kihn Viaduct\" ...\n $ city               : chr  \"Braintree\" \"Braintree\" \"Braintree\" \"Braintree\" ...\n $ state              : chr  \"Massachusetts\" \"Massachusetts\" \"Massachusetts\" \"Massachusetts\" ...\n $ county             : chr  \"Norfolk County\" \"Norfolk County\" \"Norfolk County\" \"Norfolk County\" ...\n $ fips               : int  25021 25021 25021 25021 25021 25021 25021 25021 25021 25021 ...\n $ zip                : int  2184 2184 2184 2184 2184 2184 2184 2184 2184 2184 ...\n $ lat                : num  42.2 42.2 42.2 42.2 42.2 ...\n $ lon                : num  -71 -71 -71 -71 -71 ...\n $ healthcare_expenses: num  56905 56905 56905 56905 56905 ...\n $ healthcare_coverage: num  18020 18020 18020 18020 18020 ...\n $ income             : int  100511 100511 100511 100511 100511 100511 49737 49737 49737 49737 ...\n $ date               : chr  \"2016-04-10T09:04:48Z\" \"2016-04-10T09:04:48Z\" \"2016-04-10T09:04:48Z\" \"2016-04-10T09:04:48Z\" ...\n $ base_cost          : num  136 136 136 136 136 136 136 136 136 136 ...\n $ vacc_date          : Date, format: \"2016-04-10\" \"2016-04-10\" ...\n $ year               : chr  \"2016\" \"2016\" \"2016\" \"2016\" ...\n $ month              : chr  \"April\" \"April\" \"April\" \"April\" ...\n $ vaccine_group      : chr  \"Influenza\" \"DTP group\" \"Hepatitis\" \"Meningococcal\" ...\n $ vacc_group3        : chr  \"Respiratory vaccines\" \"Childhood vaccines\" \"Childhood vaccines\" \"Childhood vaccines\" ...\n $ vacc_year          : num  2016 2016 2016 2016 2019 ...\n $ vacc_month         : Ord.factor w/ 12 levels \"January\"&lt;\"February\"&lt;..: 4 4 4 4 4 4 10 11 8 8 ...\n\nvacc_pt_merged %&gt;% \n  mutate(\n    vacc_date = as.Date(strptime(date, format = \"%Y-%m-%dT%H:%M:%SZ\")),\n    birthdate = as.Date(birthdate),\n    days_to_vax = as.numeric(difftime(vacc_date, birthdate, units = \"days\")),\n    weeks_to_vax = as.numeric(difftime(vacc_date, birthdate, units = \"weeks\")),\n    months_to_vax = as.numeric(difftime(vacc_date, birthdate, units = \"days\")) / 30.44,\n    years_to_vax = floor(as.numeric(difftime(vacc_date, birthdate, units = \"days\")) / 365.25)\n  ) -&gt; vacc_pt_merged\n\nsummary(vacc_pt_merged$days_to_vax)\n\n   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. \n      0    2548    7742   10375   18263   36813 \n\nsummary(vacc_pt_merged$years_to_vax)\n\n   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. \n   0.00    6.00   21.00   28.02   50.00  100.00 \n\n\nExtracting Date Components\n\nvacc_pt_merged &lt;- vacc_pt_merged %&gt;%\n  mutate(\n    vacc_day = day(vacc_date),\n    vacc_month_num = month(vacc_date),\n    vacc_month_name = month(vacc_date, label = TRUE, abbr = FALSE),\n    vacc_weekday = wday(vacc_date, label = TRUE, abbr = FALSE),\n    vacc_week = week(vacc_date),\n    vacc_quarter = quarter(vacc_date),\n    vacc_year = year(vacc_date),  # Define vacc_year first\n    vacc_fy = if_else(vacc_month_num &gt;= 7, vacc_year, vacc_year - 1),  # FY starts 1 July in Australia\n    vacc_season = case_when(\n      vacc_month_num %in% 12:2 ~ \"Summer\",\n      vacc_month_num %in% 3:5  ~ \"Autumn\",\n      vacc_month_num %in% 6:8  ~ \"Winter\",\n      vacc_month_num %in% 9:11 ~ \"Spring\"\n    ),\n    is_weekend = wday(vacc_date) %in% c(1, 7),\n    days_since_ref = floor(as.numeric(difftime(vacc_date, as.Date(\"2020-01-01\"), units = \"days\")))\n  )\n\ntemp &lt;- vacc_pt_merged %&gt;%\n  select(vacc_day, vacc_month_num, vacc_month_name, vacc_weekday, vacc_week,\n         vacc_quarter, vacc_year, vacc_fy, vacc_season, is_weekend, days_since_ref)\n\nhead(temp, n = 8)\n\n  vacc_day vacc_month_num vacc_month_name vacc_weekday vacc_week vacc_quarter\n1       10              4           April       Sunday        15            2\n2       10              4           April       Sunday        15            2\n3       10              4           April       Sunday        15            2\n4       10              4           April       Sunday        15            2\n5       14              4           April       Sunday        15            2\n6       17              4           April       Sunday        16            2\n7       29             10         October      Tuesday        44            4\n8        1             11        November      Tuesday        44            4\n  vacc_year vacc_fy vacc_season is_weekend days_since_ref\n1      2016    2015      Summer       TRUE          -1361\n2      2016    2015      Summer       TRUE          -1361\n3      2016    2015      Summer       TRUE          -1361\n4      2016    2015      Summer       TRUE          -1361\n5      2019    2018      Summer       TRUE           -262\n6      2022    2021      Summer       TRUE            837\n7      2002    2002      Summer      FALSE          -6273\n8      2005    2005      Summer      FALSE          -5174\n\nrm (temp)\n\nFiltering Between Date Ranges\n\n# Calculate Age as of 31 December 2024\n# str(vacc_pt_merged$birthdate) \n\nvacc_pt_merged &lt;- vacc_pt_merged %&gt;%\n  mutate(\n    age = floor(time_length(difftime(as.Date(\"2024-12-31\"), birthdate), unit = \"years\"))\n  )\n\ntable (vacc_pt_merged$age)\n\n\n  1   2   5   6   7  10  11  12  13  14  15  16  17  18  19  20  21  23  24  25 \n 46  24  64  66  34 102  38  59  21  21  34  83  18  36  18  34  48  13  12  47 \n 27  28  29  30  33  34  36  37  38  40  41  42  43  44  45  46  47  48  49  50 \n 17  30   9  38   4   7   6   8   6  20  37  16   9  17  15  13   9  21  30  15 \n 51  52  53  55  56  58  60  61  62  63  64  65  68  69  71  73  74  76  78  80 \n 13  30  16  30  30  14  12  27  49  13  26  14  14  57  15  27  15  14  12  13 \n 85  97 110 \n 12  20   1 \n\n# Categorize into Age Groups\nvacc_pt_merged &lt;- vacc_pt_merged %&gt;%\n  mutate(\n    age_group = cut(\n      age,\n      breaks = c(0, 9, 19, 29, 49, 100),\n      labels = c(\"0‚Äì9\", \"10‚Äì19\", \"20‚Äì29\", \"30‚Äì49\", \"50+\"),\n      right = TRUE\n    )\n  )\n\ntable (vacc_pt_merged$age_group)\n\n\n  0‚Äì9 10‚Äì19 20‚Äì29 30‚Äì49   50+ \n  234   430   210   256   488 \n\n# Vaccinations only in 2022\nvacc_2022 &lt;- vacc_pt_merged %&gt;%\n  filter(vacc_date &gt;= ymd(\"2022-01-01\") & vacc_date &lt;= ymd(\"2022-12-31\"))\n\n# Vaccinations between 2015 and 2024\nvacc_1524 &lt;- vacc_pt_merged %&gt;%\n  filter(vacc_year &gt;= 2015 & vacc_year &lt;= 2024)\n\ntable(vacc_1524$vacc_year)\n\n\n2015 2016 2017 2018 2019 2020 2021 2022 2023 2024 \n 153  139  137  151  161  137  263  120  170  122 \n\nrm(vacc_2022)\n\n\n\n\n\nID Creation (if missing): paste(), substr(), as.Date(), unite()\nDetecting Duplicates: duplicated(), distinct(), n_distinct(), row_number(), count(distinct(‚Ä¶))\nTagging Duplicates: row_number(), duplicated(), mutate(dup = row_number())\nValidating Duplicates: group_by() + filter(n() &gt; 1), arrange(), subset()\nRemoving Duplicates: filter(dup == 1), distinct(), summarise()\nOptional Filtering Rules: Keep first/last by date, non-missing only, domain-specific logic\n\nDuplicate records in health or survey data can compromise the integrity of analyses. A critical first step is ensuring each individual has a consistent and unique identifier (ID). When explicit IDs are missing or unreliable, they can be constructed using combinations of variables such as names, dates of birth, and location (e.g., using paste(), substr(), or unite()). Once IDs are established, duplicates can be detected, reviewed, and resolved systematically through tagging (row_number()), visual inspection, and appropriate retention or removal strategies.\n\nüîπ Key Aspects of Duplicate Management\n\n\n\n\n\n\n\n\nAspect\nWhat to Address\nWhy It Matters\n\n\n\n\nDetection Methods\nUse duplicated(), distinct(), n_distinct(), row_number() by ID or keys\nHelps quantify and locate potential duplicates\n\n\nValidation\nVisual/manual review using arrange(), group_by() + filter()\nPrevents removal of legitimate but similar entries\n\n\nTagging Duplicates\nLabel using row_number() or duplicated()\nAllows flexible filtering or analysis of repeats\n\n\nDeciding What to Keep\nKeep first, latest (by date), or non-missing based on rules\nAvoids loss of useful or most complete records\n\n\nRemoval or Aggregation\nDrop with filter(), or use summarise() to collapse duplicates\nDepends on context: reporting vs.¬†recordkeeping\n\n\nID Creation / Fixing\nUse mutate() to create or correct IDs\nEnables future joins and tracking\n\n\n\n\nThe following table shows the summary with some data manipulation options\n\n\n\n\n\n\n\n\nTask\nFunction / Code\nPurpose\n\n\n\n\nIdentify blank IDs or fields\nx[x == \"\"] &lt;- NA\nConvert empty strings to NA for proper detection\n\n\nCount missing values\nsum(is.na(x))\nCheck how many values are missing\n\n\nCount unique observations\ncount(distinct(df, id))\nDetermine the number of unique records\n\n\nGenerate row numbers per group\ngroup_by(id) %&gt;% mutate(dup = row_number())\nLabel duplicates within each ID\n\n\nCheck duplication status\ntable(df$dup) or sum(dup &gt;= 2)\nSummarise duplication pattern\n\n\nSubset for review\nsubset(df, dup == 2)\nView specific duplicates for manual inspection\n\n\nFilter duplicated individuals\nfilter(n() &gt; 1)\nExtract only duplicated IDs\n\n\nRemove duplicates\nfilter(!(dup &gt;= 2))\nKeep only the first instance per group (if needed)\n\n\nClean temporary object\nrm()\nRemove intermediate datasets from environment\n\n\n\nThis setup ensures duplicates are clearly identified, reviewed, and removed where appropriate.\n\npatients &lt;- patients %&gt;%\n  mutate(\n    birthdate = as.Date(birthdate),\n    id_text = paste0(substr(first, 1, 4), \"|\", substr(last, 1, 4), \"|\", birthdate)\n  )\n# Preview new ID\nhead(patients$id_text, n = 3)\n\n[1] \"Josh|Kund|1994-02-06\" \"Benn|Eber|1968-08-06\" \"Hunt|Gerl|2008-12-21\"\n\n# --- Step 2: Create random numeric ID per individual ---\nset.seed(1234)  # for reproducibility\npatients &lt;- patients %&gt;%\n  mutate(id_num = sample(100000:999999, n(), replace = FALSE))\n\n# Preview both ID columns\npatients %&gt;%\n  select(first, last, birthdate, id_text, id_num) %&gt;%\n  head(5)\n\n      first          last  birthdate              id_text id_num\n1 Joshua658      Kunde533 1994-02-06 Josh|Kund|1994-02-06 861679\n2 Bennie663      Ebert178 1968-08-06 Benn|Eber|1968-08-06 730677\n3 Hunter736    Gerlach374 2008-12-21 Hunt|Gerl|2008-12-21 404107\n4 Carlyn477 Williamson769 1994-01-27 Carl|Will|1994-01-27 395845\n5   Robin66  Gleichner915 2019-07-27 Robi|Glei|2019-07-27 226054\n\n# ....................................................\n# Clean-up if needed\n# ....................................................\n# rm(id_text, id_num) # optional if you store externally\n\ntable (patients$race)\n\n\n asian  black native  other  white \n     8      6      1      3     88 \n\notherrace &lt;- patients %&gt;%\n  filter(race != \"white\")\n\npatients &lt;- rbind(patients, otherrace)\n\n# Count total and unique records\nn_total &lt;- nrow(patients)\nn_unique &lt;- n_distinct(patients$id_text)\nmessage(glue::glue(\"Total records: {n_total}, Unique IDs: {n_unique}\"))\n\nTotal records: 124, Unique IDs: 106\n\n# Tag duplicates using row_number()\npatients &lt;- patients %&gt;%\n  arrange(id_text) %&gt;%\n  group_by(id_text) %&gt;%\n  mutate(dup = row_number()) %&gt;%\n  ungroup()\n# Count number of true duplicates\ntable(patients$dup)\n\n\n  1   2 \n106  18 \n\nprint(sum(patients$dup &gt;= 2))\n\n[1] 18\n\n# Keep only records from individuals who have duplicates\nduplicates &lt;- patients %&gt;%\n  group_by(id_text) %&gt;%\n  filter(n() &gt;= 2) %&gt;%\n  select(id_text, id_num, race, marital, gender, birthdate) %&gt;%\n  ungroup()\n\n# Preview records from duplicated individuals\nhead(duplicates)\n\n# A tibble: 6 √ó 6\n  id_text              id_num race  marital gender birthdate \n  &lt;chr&gt;                 &lt;int&gt; &lt;chr&gt; &lt;chr&gt;   &lt;chr&gt;  &lt;date&gt;    \n1 Alen|Gusi|1927-03-20 361202 other M       F      1927-03-20\n2 Alen|Gusi|1927-03-20 361202 other M       F      1927-03-20\n3 Bert|Alem|1983-05-07 513589 black M       F      1983-05-07\n4 Bert|Alem|1983-05-07 513589 black M       F      1983-05-07\n5 Blan|Rein|1951-11-22 465318 asian S       F      1951-11-22\n6 Blan|Rein|1951-11-22 465318 asian S       F      1951-11-22\n\nrm(duplicates, n_total, n_unique)\n\n\n\n\n\nleft_join(), right_join(), inner_join(), full_join()\nsemi_join() and anti_join()\nbind_rows(), rbind() , bind_cols() and cbind()\n\nWhen analyzing real-world datasets, it‚Äôs often necessary to merge or append multiple datasets.\nThis could involve matching rows based on common identifiers, appending additional cases, or combining variables side-by-side.\nWe can join, bind, or filter datasets efficiently using dplyr and base R techniques.\nBrief Descriptions\n\nleft_join(): Keep all records from the left (main) table; bring matching records from the right table.\nright_join(): Keep all records from the right table; bring matching records from the left.\ninner_join(): Keep only rows where keys match in both tables.\nfull_join(): Keep all records from both tables; missing matches filled with NA.\nsemi_join(): Keep rows from the left table where a match exists in the right.\nanti_join(): Keep only rows from the left table that don‚Äôt match the right.\n\n‚û°Ô∏è bind_rows() and rbind() are used for stacking datasets.\n‚û°Ô∏è bind_cols() and cbind() are used for attaching new columns horizontally.\nSummary Table: Key Functions for Joining and Appending\n\n\n\n\n\n\n\n\nTask\nFunction\nPurpose\n\n\n\n\nMerge by common key\nleft_join(), right_join(), inner_join(), full_join()\nMerge datasets using common variables\n\n\nFilter matching rows\nsemi_join()\nKeep rows from left table that have matches in right table\n\n\nFilter non-matching rows\nanti_join()\nKeep rows from left table with no match in right table\n\n\nRow-wise append\nbind_rows()\nStack two datasets vertically (must have same columns)\n\n\nColumn-wise append\nbind_cols()\nAdd columns side-by-side (matching by row position)\n\n\nBasic base R row bind\nrbind()\nAppend rows (base R equivalent to bind_rows)\n\n\nBasic base R column bind\ncbind()\nAppend columns (base R equivalent to bind_cols)\n\n\nJoin a table to itself\nSelf-join\nAnalyze relationships within a single dataset (e.g., hierarchy)\n\n\n\n\nImportant Reminders - Joins (left_join, etc.) match based on a key (column/s). - bind_rows() assumes same column names and types. - bind_cols() assumes same number of rows. - rbind() and cbind() are base R methods but dplyr::bind_*() are more flexible. ‚Äî\nDemonstrating Different Types of Joins with Brief Descriptions\nStandardizing variable Names\nBefore performing joins, it is essential to ensure column names match in both datasets.\nThis avoids errors caused by case differences or inconsistent naming.\n\n# ......................................\n# Full Join: Keep everything from both datasets\n# ......................................\nvacc_full_join &lt;- full_join(\n  patients,\n  vaccination,\n  by = c(\"id\" = \"patient\")\n)\n\nhead(vacc_full_join, n = 3)\n\n                                    id  birthdate deathdate         ssn\n1 30a6452c-4297-a1ac-977a-6a23237c7b46 1994-02-06           999-52-8591\n2 30a6452c-4297-a1ac-977a-6a23237c7b46 1994-02-06           999-52-8591\n3 30a6452c-4297-a1ac-977a-6a23237c7b46 1994-02-06           999-52-8591\n    drivers   passport prefix     first  middle     last suffix maiden marital\n1 S99996852 X47758697X    Mr. Joshua658 Alvin56 Kunde533     NA              M\n2 S99996852 X47758697X    Mr. Joshua658 Alvin56 Kunde533     NA              M\n3 S99996852 X47758697X    Mr. Joshua658 Alvin56 Kunde533     NA              M\n   race   ethnicity gender                birthplace          address      city\n1 white nonhispanic      M Boston  Massachusetts  US 811 Kihn Viaduct Braintree\n2 white nonhispanic      M Boston  Massachusetts  US 811 Kihn Viaduct Braintree\n3 white nonhispanic      M Boston  Massachusetts  US 811 Kihn Viaduct Braintree\n          state         county  fips  zip      lat      lon healthcare_expenses\n1 Massachusetts Norfolk County 25021 2184 42.21114 -71.0458            56904.96\n2 Massachusetts Norfolk County 25021 2184 42.21114 -71.0458            56904.96\n3 Massachusetts Norfolk County 25021 2184 42.21114 -71.0458            56904.96\n  healthcare_coverage income                 date\n1            18019.99 100511 2016-04-10T09:04:48Z\n2            18019.99 100511 2016-04-10T09:04:48Z\n3            18019.99 100511 2016-04-10T09:04:48Z\n                             encounter code\n1 0b03e41b-06a6-66fa-b972-acc5a83b134a  140\n2 0b03e41b-06a6-66fa-b972-acc5a83b134a  113\n3 0b03e41b-06a6-66fa-b972-acc5a83b134a   43\n                                                   description base_cost\n1           Influenza  seasonal  injectable  preservative free       136\n2 Td (adult)  5 Lf tetanus toxoid  preservative free  adsorbed       136\n3                                                 Hep B  adult       136\n\n# ......................................\n# Left Join: Keep all patients, add vaccination if available\n# ......................................\nvacc_left_join &lt;- left_join(\n  patients,\n  vaccination,\n  by = c(\"id\" = \"patient\")\n)\n\nhead(vacc_left_join, n = 3)\n\n                                    id  birthdate deathdate         ssn\n1 30a6452c-4297-a1ac-977a-6a23237c7b46 1994-02-06           999-52-8591\n2 30a6452c-4297-a1ac-977a-6a23237c7b46 1994-02-06           999-52-8591\n3 30a6452c-4297-a1ac-977a-6a23237c7b46 1994-02-06           999-52-8591\n    drivers   passport prefix     first  middle     last suffix maiden marital\n1 S99996852 X47758697X    Mr. Joshua658 Alvin56 Kunde533     NA              M\n2 S99996852 X47758697X    Mr. Joshua658 Alvin56 Kunde533     NA              M\n3 S99996852 X47758697X    Mr. Joshua658 Alvin56 Kunde533     NA              M\n   race   ethnicity gender                birthplace          address      city\n1 white nonhispanic      M Boston  Massachusetts  US 811 Kihn Viaduct Braintree\n2 white nonhispanic      M Boston  Massachusetts  US 811 Kihn Viaduct Braintree\n3 white nonhispanic      M Boston  Massachusetts  US 811 Kihn Viaduct Braintree\n          state         county  fips  zip      lat      lon healthcare_expenses\n1 Massachusetts Norfolk County 25021 2184 42.21114 -71.0458            56904.96\n2 Massachusetts Norfolk County 25021 2184 42.21114 -71.0458            56904.96\n3 Massachusetts Norfolk County 25021 2184 42.21114 -71.0458            56904.96\n  healthcare_coverage income                 date\n1            18019.99 100511 2016-04-10T09:04:48Z\n2            18019.99 100511 2016-04-10T09:04:48Z\n3            18019.99 100511 2016-04-10T09:04:48Z\n                             encounter code\n1 0b03e41b-06a6-66fa-b972-acc5a83b134a  140\n2 0b03e41b-06a6-66fa-b972-acc5a83b134a  113\n3 0b03e41b-06a6-66fa-b972-acc5a83b134a   43\n                                                   description base_cost\n1           Influenza  seasonal  injectable  preservative free       136\n2 Td (adult)  5 Lf tetanus toxoid  preservative free  adsorbed       136\n3                                                 Hep B  adult       136\n\n# ......................................\n# Right Join: Keep all vaccinations, add patients if available\n# ......................................\nvacc_right_join &lt;- right_join(\n  patients,\n  vaccination,\n  by = c(\"id\" = \"patient\")\n)\n\nhead(vacc_right_join, n = 3)\n\n                                    id  birthdate deathdate         ssn\n1 30a6452c-4297-a1ac-977a-6a23237c7b46 1994-02-06           999-52-8591\n2 30a6452c-4297-a1ac-977a-6a23237c7b46 1994-02-06           999-52-8591\n3 30a6452c-4297-a1ac-977a-6a23237c7b46 1994-02-06           999-52-8591\n    drivers   passport prefix     first  middle     last suffix maiden marital\n1 S99996852 X47758697X    Mr. Joshua658 Alvin56 Kunde533     NA              M\n2 S99996852 X47758697X    Mr. Joshua658 Alvin56 Kunde533     NA              M\n3 S99996852 X47758697X    Mr. Joshua658 Alvin56 Kunde533     NA              M\n   race   ethnicity gender                birthplace          address      city\n1 white nonhispanic      M Boston  Massachusetts  US 811 Kihn Viaduct Braintree\n2 white nonhispanic      M Boston  Massachusetts  US 811 Kihn Viaduct Braintree\n3 white nonhispanic      M Boston  Massachusetts  US 811 Kihn Viaduct Braintree\n          state         county  fips  zip      lat      lon healthcare_expenses\n1 Massachusetts Norfolk County 25021 2184 42.21114 -71.0458            56904.96\n2 Massachusetts Norfolk County 25021 2184 42.21114 -71.0458            56904.96\n3 Massachusetts Norfolk County 25021 2184 42.21114 -71.0458            56904.96\n  healthcare_coverage income                 date\n1            18019.99 100511 2016-04-10T09:04:48Z\n2            18019.99 100511 2016-04-10T09:04:48Z\n3            18019.99 100511 2016-04-10T09:04:48Z\n                             encounter code\n1 0b03e41b-06a6-66fa-b972-acc5a83b134a  140\n2 0b03e41b-06a6-66fa-b972-acc5a83b134a  113\n3 0b03e41b-06a6-66fa-b972-acc5a83b134a   43\n                                                   description base_cost\n1           Influenza  seasonal  injectable  preservative free       136\n2 Td (adult)  5 Lf tetanus toxoid  preservative free  adsorbed       136\n3                                                 Hep B  adult       136\n\n# ......................................\n# Inner Join: Keep only matched patients and vaccinations\n# ......................................\nvacc_inner_join &lt;- inner_join(\n  patients,\n  vaccination,\n  by = c(\"id\" = \"patient\"))\n\nhead(vacc_inner_join, n = 3)\n\n                                    id  birthdate deathdate         ssn\n1 30a6452c-4297-a1ac-977a-6a23237c7b46 1994-02-06           999-52-8591\n2 30a6452c-4297-a1ac-977a-6a23237c7b46 1994-02-06           999-52-8591\n3 30a6452c-4297-a1ac-977a-6a23237c7b46 1994-02-06           999-52-8591\n    drivers   passport prefix     first  middle     last suffix maiden marital\n1 S99996852 X47758697X    Mr. Joshua658 Alvin56 Kunde533     NA              M\n2 S99996852 X47758697X    Mr. Joshua658 Alvin56 Kunde533     NA              M\n3 S99996852 X47758697X    Mr. Joshua658 Alvin56 Kunde533     NA              M\n   race   ethnicity gender                birthplace          address      city\n1 white nonhispanic      M Boston  Massachusetts  US 811 Kihn Viaduct Braintree\n2 white nonhispanic      M Boston  Massachusetts  US 811 Kihn Viaduct Braintree\n3 white nonhispanic      M Boston  Massachusetts  US 811 Kihn Viaduct Braintree\n          state         county  fips  zip      lat      lon healthcare_expenses\n1 Massachusetts Norfolk County 25021 2184 42.21114 -71.0458            56904.96\n2 Massachusetts Norfolk County 25021 2184 42.21114 -71.0458            56904.96\n3 Massachusetts Norfolk County 25021 2184 42.21114 -71.0458            56904.96\n  healthcare_coverage income                 date\n1            18019.99 100511 2016-04-10T09:04:48Z\n2            18019.99 100511 2016-04-10T09:04:48Z\n3            18019.99 100511 2016-04-10T09:04:48Z\n                             encounter code\n1 0b03e41b-06a6-66fa-b972-acc5a83b134a  140\n2 0b03e41b-06a6-66fa-b972-acc5a83b134a  113\n3 0b03e41b-06a6-66fa-b972-acc5a83b134a   43\n                                                   description base_cost\n1           Influenza  seasonal  injectable  preservative free       136\n2 Td (adult)  5 Lf tetanus toxoid  preservative free  adsorbed       136\n3                                                 Hep B  adult       136\n\n# ......................................\n# Semi Join: Keep only patients that have a vaccination match\n# (Only patient columns are kept)\n# ......................................\n\nvacc_semi_join &lt;- semi_join(\n  patients,\n  vaccination,\n  by = c(\"id\" = \"patient\"))\n\nhead(vacc_semi_join, n = 3)\n\n                                    id  birthdate  deathdate         ssn\n1 30a6452c-4297-a1ac-977a-6a23237c7b46 1994-02-06            999-52-8591\n2 34a4dcc4-35fb-6ad5-ab98-be285c586a4f 1968-08-06 2009-12-11 999-75-3953\n3 7179458e-d6e3-c723-2530-d4acfe1c2668 2008-12-21            999-70-1925\n    drivers   passport prefix     first      middle       last suffix maiden\n1 S99996852 X47758697X    Mr. Joshua658     Alvin56   Kunde533     NA       \n2 S99993577 X28173268X    Mr. Bennie663               Ebert178     NA       \n3                             Hunter736 Mckinley734 Gerlach374     NA       \n  marital  race   ethnicity gender                  birthplace\n1       M white nonhispanic      M   Boston  Massachusetts  US\n2       D white nonhispanic      M Chicopee  Massachusetts  US\n3         white nonhispanic      M  Spencer  Massachusetts  US\n                      address         city         state          county  fips\n1            811 Kihn Viaduct    Braintree Massachusetts  Norfolk County 25021\n2 975 Pfannerstill Throughway    Braintree Massachusetts  Norfolk County 25021\n3             548 Heller Lane Mattapoisett Massachusetts Plymouth County    NA\n   zip      lat       lon healthcare_expenses healthcare_coverage income\n1 2184 42.21114 -71.04580            56904.96            18019.99 100511\n2 2184 42.25542 -70.97102           124024.12             1075.06  49737\n3    0 41.64829 -70.85062            45645.06             6154.94 133816\n\n# ......................................\n# Anti Join: Keep only patients that do not have a vaccination match\n# ......................................\nvacc_anti_join &lt;- anti_join(\n  patients,\n  vaccination,\n  by = c(\"id\" = \"patient\"))\n\nhead(vacc_anti_join, n = 3)\n\n [1] id                  birthdate           deathdate          \n [4] ssn                 drivers             passport           \n [7] prefix              first               middle             \n[10] last                suffix              maiden             \n[13] marital             race                ethnicity          \n[16] gender              birthplace          address            \n[19] city                state               county             \n[22] fips                zip                 lat                \n[25] lon                 healthcare_expenses healthcare_coverage\n[28] income             \n&lt;0 rows&gt; (or 0-length row.names)\n\n# ......................................\n# Remove temporary datasets\n# ......................................\nrm(vacc_left_join, vacc_right_join, vacc_inner_join, vacc_full_join, vacc_semi_join, vacc_anti_join)\n\nAppending (Binding) DataFrames: Rows and Columns\n\n# Binding Rows Together (bind_rows): Combine NSW, WA, and Others into one dataset\n\nbc_combined_rows &lt;- bind_rows(\n  breast_cancer_NSW,\n  breast_cancer_WA,\n  breast_cancer_others\n)\n\n# Check result\nhead(bc_combined_rows, n = 3)\n\n  sa3code sa3coden    sa3name state   year part50_74 pop50_74 rate50_74\n1   10102    10102 Queanbeyan   NSW 201617      4875     8052  60.50000\n2   10102    10102 Queanbeyan   NSW 201718      5048     8309  60.75961\n3   10102    10102 Queanbeyan   NSW 201819      5276     8588  61.43839\n  agen50_74 expct50_74 part50_69 pop50_69 rate50_69 agen50_69 expct50_69\n1         3       4428      4309     7145  60.30000         2       3929\n2         3       4553      4448     7338  60.62238         2       4013\n3         3       4706      4629     7548  61.33203         2       4113\n  part50_54 pop50_54 rate50_54 agen50_54 expct50_54 part55_59 pop55_59\n1      1284     2251  57.00000         1       1118      1188     1970\n2      1285     2306  55.72035         1       1143      1260     2030\n3      1375     2342  58.70977         1       1166      1252     2093\n  rate55_59 agen55_59 expct55_59 part60_64 pop60_64 rate60_64 agen60_64\n1  60.30000         4       1046      1012     1625  62.30000         5\n2  62.09035         4       1069      1048     1646  63.69947         5\n3  59.81504         4       1098      1105     1689  65.43657         5\n  expct60_64 part65_69 pop65_69 rate65_69 agen65_69 expct65_69 part70_74\n1        950       826     1300  63.50000         6        781       566\n2        953       855     1357  63.02558         6        812       600\n3        967       898     1426  63.00429         6        849       647\n  pop70_74 rate70_74 agen70_74 expct70_74\n1      907  62.40000         7        498\n2      971  61.79725         7        541\n3     1040  62.21032         7        585\n\n# Confirm number of rows\nnrow(bc_combined_rows)\n\n[1] 1364\n\n# Binding Columns Together (bind_cols): Combine Participation Data with SA3 metadata\n# (needs same number of rows)\n\nbc_combined_cols &lt;- bind_cols(\n  participation,\n  breast_cancer_SA3_info )\n# Check result\nhead(bc_combined_cols, n = 3)\n\n    year part50_74 pop50_74 rate50_74 agen50_74 expct50_74 part50_69 pop50_69\n1 201617      4875     8052  60.50000         3       4428      4309     7145\n2 201718      5048     8309  60.75961         3       4553      4448     7338\n3 201819      5276     8588  61.43839         3       4706      4629     7548\n  rate50_69 agen50_69 expct50_69 part50_54 pop50_54 rate50_54 agen50_54\n1  60.30000         2       3929      1284     2251  57.00000         1\n2  60.62238         2       4013      1285     2306  55.72035         1\n3  61.33203         2       4113      1375     2342  58.70977         1\n  expct50_54 part55_59 pop55_59 rate55_59 agen55_59 expct55_59 part60_64\n1       1118      1188     1970  60.30000         4       1046      1012\n2       1143      1260     2030  62.09035         4       1069      1048\n3       1166      1252     2093  59.81504         4       1098      1105\n  pop60_64 rate60_64 agen60_64 expct60_64 part65_69 pop65_69 rate65_69\n1     1625  62.30000         5        950       826     1300  63.50000\n2     1646  63.69947         5        953       855     1357  63.02558\n3     1689  65.43657         5        967       898     1426  63.00429\n  agen65_69 expct65_69 part70_74 pop70_74 rate70_74 agen70_74 expct70_74\n1         6        781       566      907  62.40000         7        498\n2         6        812       600      971  61.79725         7        541\n3         6        849       647     1040  62.21032         7        585\n  sa3code sa3coden    sa3name state\n1   10102    10102 Queanbeyan   NSW\n2   10102    10102 Queanbeyan   NSW\n3   10102    10102 Queanbeyan   NSW\n\n# Appending Rows Using Base R rbind()\n# (Equivalent to bind_rows but simpler cases, needs identical columns)\nbc_combined_rbind &lt;- rbind(\n  breast_cancer_NSW,\n  breast_cancer_WA\n)\n\n# Check result\nhead(bc_combined_rbind, n = 3)\n\n  sa3code sa3coden    sa3name state   year part50_74 pop50_74 rate50_74\n1   10102    10102 Queanbeyan   NSW 201617      4875     8052  60.50000\n2   10102    10102 Queanbeyan   NSW 201718      5048     8309  60.75961\n3   10102    10102 Queanbeyan   NSW 201819      5276     8588  61.43839\n  agen50_74 expct50_74 part50_69 pop50_69 rate50_69 agen50_69 expct50_69\n1         3       4428      4309     7145  60.30000         2       3929\n2         3       4553      4448     7338  60.62238         2       4013\n3         3       4706      4629     7548  61.33203         2       4113\n  part50_54 pop50_54 rate50_54 agen50_54 expct50_54 part55_59 pop55_59\n1      1284     2251  57.00000         1       1118      1188     1970\n2      1285     2306  55.72035         1       1143      1260     2030\n3      1375     2342  58.70977         1       1166      1252     2093\n  rate55_59 agen55_59 expct55_59 part60_64 pop60_64 rate60_64 agen60_64\n1  60.30000         4       1046      1012     1625  62.30000         5\n2  62.09035         4       1069      1048     1646  63.69947         5\n3  59.81504         4       1098      1105     1689  65.43657         5\n  expct60_64 part65_69 pop65_69 rate65_69 agen65_69 expct65_69 part70_74\n1        950       826     1300  63.50000         6        781       566\n2        953       855     1357  63.02558         6        812       600\n3        967       898     1426  63.00429         6        849       647\n  pop70_74 rate70_74 agen70_74 expct70_74\n1      907  62.40000         7        498\n2      971  61.79725         7        541\n3     1040  62.21032         7        585\n\n# Appending Columns Using Base R cbind()\n# (Simple column binding, assumes same number of rows)\n\nbc_combined_cbind &lt;- cbind(\n  participation,\n  breast_cancer_SA3_info)\n\n# Check result\nhead(bc_combined_cbind, n = 3)\n\n    year part50_74 pop50_74 rate50_74 agen50_74 expct50_74 part50_69 pop50_69\n1 201617      4875     8052  60.50000         3       4428      4309     7145\n2 201718      5048     8309  60.75961         3       4553      4448     7338\n3 201819      5276     8588  61.43839         3       4706      4629     7548\n  rate50_69 agen50_69 expct50_69 part50_54 pop50_54 rate50_54 agen50_54\n1  60.30000         2       3929      1284     2251  57.00000         1\n2  60.62238         2       4013      1285     2306  55.72035         1\n3  61.33203         2       4113      1375     2342  58.70977         1\n  expct50_54 part55_59 pop55_59 rate55_59 agen55_59 expct55_59 part60_64\n1       1118      1188     1970  60.30000         4       1046      1012\n2       1143      1260     2030  62.09035         4       1069      1048\n3       1166      1252     2093  59.81504         4       1098      1105\n  pop60_64 rate60_64 agen60_64 expct60_64 part65_69 pop65_69 rate65_69\n1     1625  62.30000         5        950       826     1300  63.50000\n2     1646  63.69947         5        953       855     1357  63.02558\n3     1689  65.43657         5        967       898     1426  63.00429\n  agen65_69 expct65_69 part70_74 pop70_74 rate70_74 agen70_74 expct70_74\n1         6        781       566      907  62.40000         7        498\n2         6        812       600      971  61.79725         7        541\n3         6        849       647     1040  62.21032         7        585\n  sa3code sa3coden    sa3name state\n1   10102    10102 Queanbeyan   NSW\n2   10102    10102 Queanbeyan   NSW\n3   10102    10102 Queanbeyan   NSW\n\n# Important Notes:\n# - bind_rows() can handle different column orders safely\n# - rbind() requires identical column names and order\n# - bind_cols() simply pastes side-by-side, no matching by keys\n# - cbind() assumes same number of rows\n\n# ....................................................\n# Remove all temporary objects created in this chunk\n# ....................................................\nrm(\n  breast_cancer_NSW, breast_cancer_WA, breast_cancer_others, participation, breast_cancer_SA3_info,\n  bc_combined_rows, bc_combined_cols, bc_combined_rbind, bc_combined_cbind\n)\n\n\n\n\nA. Identifying Missing Values\n\nis.na(), anyNA(), sum(is.na(x)), colSums() ‚Äì detect/count missing values\ncomplete.cases() ‚Äì filter complete rows\nConvert blanks to NA: x[x == ‚Äú‚Äú] &lt;- NA\n\nB. Handling Missing Values\n\nBasic Removal/Replacement: na.omit(), replace_na() (tidyr), ifelse()\nForward/Backward Fill: fill() (tidyr) with .direction = ‚Äúdown‚Äù / ‚Äúup‚Äù\nStatistical Imputation:\n\n-Simple: mean/median imputation\n-Multiple: mice::mice()()\n-Advanced: Hmisc::aregImpute, missForest, Amelia, zoo::na.fill\nMissing data is a common issue in real-world datasets. In R, handling missing values properly is essential to ensure the integrity of analyses and avoid misleading results.\nThis section covers how to identify, clean, and impute missing values using base R and tidyverse tools. Techniques range from basic filtering to advanced imputation models.\n‚û°Ô∏è Missing values are typically represented as NA in R. Empty strings (e.g., \"\") or special codes (e.g., -99, \"missing\") may also indicate missingness and need conversion before analysis.\nüîπ Summary of Functions for Handling Missing Values\n\n\n\n\n\n\n\n\nTask\nFunction / Code\nPurpose\n\n\n\n\nDetect missing values\nis.na(x), anyNA(x), sum(is.na(x))\nIdentify/count missing values\n\n\nMissing per column\ncolSums(is.na(df))\nCount NAs per column\n\n\nFilter complete rows\ncomplete.cases(df)\nKeep only rows without any missing values\n\n\nConvert blanks to NA\nx[x == \"\"] &lt;- NA\nConvert empty strings to missing values\n\n\nRemove missing rows\nna.omit(df)\nRemove rows with any missing value\n\n\nReplace missing values\nreplace_na(df, list(...)), ifelse(is.na(x), ...)\nImpute or replace NA with custom logic\n\n\nForward/backward fill\nfill(df, .direction = \"down\" / \"up\")\nFill NA using nearby values\n\n\nMean/median imputation\nx[is.na(x)] &lt;- mean(x, na.rm = TRUE)\nReplace NA with summary statistic\n\n\nMultiple imputation\nmice::mice(df)\nCreate multiple imputed datasets using chained equations\n\n\nAdvanced imputation\nHmisc::aregImpute, missForest, Amelia, zoo::na.fill()\nSpecialized techniques for complex imputations\n\n\n\nüìö Further Learning and Resources\nAdditional tutorials, demonstrations, and datasets are available on:\n\nYouTube Channel ‚Äì AnalyticsHub\nhttps://studio.youtube.com/channel/UCLVKP0g8GvHhOh0kn20T8eg/videos/upload?filter=%5B%5D&sort=%7B%22columnType%22%3A%22date%22%2C%22sortOrder%22%3A%22DESCENDING%22%7D\nGitHub Repository\nhttps://github.com/HabtamuBizuayehu?tab=repositories\n\n\n\n\n                                    id  birthdate deathdate         ssn\n1 898a6256-7ffb-dbe2-e24d-12fda2fedcfd 1966-06-23           999-98-5513\n2 5e0a6984-38d7-c604-f55f-f1de5e933768 1986-07-04           999-58-5560\n3 e335de09-0994-4111-3c15-6edcc17ae4bc 2005-04-25           999-48-3846\n4 45b89342-dc05-8e57-8eee-9ed68ec42378 1984-08-24           999-40-3433\n5 916b1ac8-56c8-ec1b-3b9a-721336a74912 1953-05-10           999-16-3735\n6 dc323bce-e583-d903-303e-9c865bc87e67 2012-09-02           999-90-3605\n    drivers   passport prefix     first     middle          last suffix\n1 S99971131 X62454905X   Mrs.  Maris768              Lindgren255     NA\n2 S99931679 X61479569X   Mrs. Hattie299  Reatha769      Nader710     NA\n3 S99958413               Ms.  Jimmie93 Towanda270      Doyle959     NA\n4 S99985178 X27670495X    Mr. Dwight645  Marlin805      Hilll811     NA\n5 S99968840 X83646024X    Ms.  Tambra47 Brittni468 Balistreri607     NA\n6                             Carson894 Raphael767     Littel644     NA\n     maiden marital  race   ethnicity gender                       birthplace\n1   Dach178       D white nonhispanic      F        Oxford  Massachusetts  US\n2 Harber290       M white nonhispanic      F North Reading  Massachusetts  US\n3                   white nonhispanic      F        Boston  Massachusetts  US\n4                 M white nonhispanic      M    Framingham  Massachusetts  US\n5                 S white nonhispanic      F     Lexington  Massachusetts  US\n6                   white nonhispanic      M      Plymouth  Massachusetts  US\n                        address        city         state           county\n1          962 Stiedemann Vista    Aquinnah Massachusetts     Dukes County\n2            720 O'Keefe Arcade      Newton Massachusetts Middlesex County\n3       493 Cruickshank Mission   Holliston Massachusetts Middlesex County\n4              810 Wolf Pathway      Malden Massachusetts Middlesex County\n5      146 Rowe Village Suite 3 New Bedford Massachusetts   Bristol County\n6 467 Collier Stravenue Unit 12   Attleboro Massachusetts   Bristol County\n   fips  zip      lat       lon healthcare_expenses healthcare_coverage income\n1    NA    0 41.29618 -70.77458           343608.18           884243.46 178323\n2 25017 2468 42.29180 -71.14930           169293.06           801407.90  86384\n3    NA    0 42.24196 -71.46440            64178.99             5906.14 198522\n4 25017 2148 42.43610 -71.14328            36010.63           472861.90  25909\n5 25005 2743 41.69576 -71.01391           281198.90           310261.21 140772\n6 44007 2861 41.94870 -71.30420            45972.75                0.00  71169\n  visit\n1     1\n2     1\n3     1\n4     1\n5     1\n6     1\n\n\n\n# Summarise missing values across all columns\nmissing_summary &lt;- colSums(is.na(visits_all))\nprint(missing_summary[missing_summary &gt; 0])\n\n          deathdate             drivers            passport              prefix \n                 40                   4                  12                   8 \n             middle              suffix              maiden             marital \n                  4                  40                  28                  16 \n               race                fips                 zip healthcare_coverage \n                 20                  12                  12                   4 \n             income \n                 20 \n\n# Total number of missing cells\ntotal_missing &lt;- sum(is.na(visits_all))\ncat(\"Total missing values in dataset:\", total_missing, \"\\n\")\n\nTotal missing values in dataset: 220 \n\n# Count of individuals with at least one missing value\nn_missing_individuals &lt;- sum(!complete.cases(visits_all))\ncat(\"Number of individuals with at least one missing value:\", n_missing_individuals, \"\\n\")\n\nNumber of individuals with at least one missing value: 40 \n\n# Sort records by patient ID and visit number\nvisits_all &lt;- visits_all %&gt;%\n  arrange(id_text, visit)\n\n# View rows with any missing values\nmissing_rows &lt;- visits_all %&gt;%\n  filter(!complete.cases(.))\nhead(missing_rows, n = 12) %&gt;% select(id_text, race, income, passport)\n\n                id_text  race income   passport\n1  Anit|S√°nc|1960-05-07 white  61016  X9157439X\n2  Anit|S√°nc|1960-05-07  &lt;NA&gt;     NA  X9157439X\n3  Anit|S√°nc|1960-05-07 white     NA  X9157439X\n4  Anit|S√°nc|1960-05-07  &lt;NA&gt;  60016  X9157439X\n5  Aure|Weis|2003-11-12 white   8752 X17586296X\n6  Aure|Weis|2003-11-12  &lt;NA&gt;     NA X17586296X\n7  Aure|Weis|2003-11-12 white     NA X17586296X\n8  Aure|Weis|2003-11-12  &lt;NA&gt;   7752 X17586296X\n9  Cars|Litt|2012-09-02 white  71169       &lt;NA&gt;\n10 Cars|Litt|2012-09-02  &lt;NA&gt;     NA       &lt;NA&gt;\n11 Cars|Litt|2012-09-02  &lt;NA&gt;  70169       &lt;NA&gt;\n12 Cars|Litt|2012-09-02 white     NA       &lt;NA&gt;\n\n# Impute passport with \"UNKNOWN\"\ndf_passport &lt;- visits_all %&gt;%\n  mutate(passport_imputed = replace_na(passport, \"UNKNOWN\")) %&gt;%\n  filter(is.na(passport)) %&gt;%\n  select(id, id_text, visit, passport, passport_imputed)\n\nhead(df_passport, n = 12)\n\n                                     id              id_text visit passport\n1  dc323bce-e583-d903-303e-9c865bc87e67 Cars|Litt|2012-09-02     1     &lt;NA&gt;\n2  dc323bce-e583-d903-303e-9c865bc87e67 Cars|Litt|2012-09-02     2     &lt;NA&gt;\n3  dc323bce-e583-d903-303e-9c865bc87e67 Cars|Litt|2012-09-02     3     &lt;NA&gt;\n4  dc323bce-e583-d903-303e-9c865bc87e67 Cars|Litt|2012-09-02     4     &lt;NA&gt;\n5  da7b1f55-c782-544f-ba8c-fe69d519dc85 Doll|Fran|2008-10-04     1     &lt;NA&gt;\n6  da7b1f55-c782-544f-ba8c-fe69d519dc85 Doll|Fran|2008-10-04     2     &lt;NA&gt;\n7  da7b1f55-c782-544f-ba8c-fe69d519dc85 Doll|Fran|2008-10-04     3     &lt;NA&gt;\n8  da7b1f55-c782-544f-ba8c-fe69d519dc85 Doll|Fran|2008-10-04     4     &lt;NA&gt;\n9  e335de09-0994-4111-3c15-6edcc17ae4bc Jimm|Doyl|2005-04-25     1     &lt;NA&gt;\n10 e335de09-0994-4111-3c15-6edcc17ae4bc Jimm|Doyl|2005-04-25     2     &lt;NA&gt;\n11 e335de09-0994-4111-3c15-6edcc17ae4bc Jimm|Doyl|2005-04-25     3     &lt;NA&gt;\n12 e335de09-0994-4111-3c15-6edcc17ae4bc Jimm|Doyl|2005-04-25     4     &lt;NA&gt;\n   passport_imputed\n1           UNKNOWN\n2           UNKNOWN\n3           UNKNOWN\n4           UNKNOWN\n5           UNKNOWN\n6           UNKNOWN\n7           UNKNOWN\n8           UNKNOWN\n9           UNKNOWN\n10          UNKNOWN\n11          UNKNOWN\n12          UNKNOWN\n\n# Sort records by patient ID and visit number (to prepare for forward/backward fill)\nvisits_all &lt;- visits_all %&gt;%\n  arrange(id_text, visit)\n\n# Preview sorted data (tail)\ntail(visits_all %&gt;% select(id_text, visit, race, income), n = 12)\n\n                id_text visit  race income\n29 Jimm|Doyl|2005-04-25     1 white 198522\n30 Jimm|Doyl|2005-04-25     2  &lt;NA&gt;     NA\n31 Jimm|Doyl|2005-04-25     3  &lt;NA&gt; 197522\n32 Jimm|Doyl|2005-04-25     4 white     NA\n33 Mari|Lind|1966-06-23     1 white 178323\n34 Mari|Lind|1966-06-23     2  &lt;NA&gt;     NA\n35 Mari|Lind|1966-06-23     3 white     NA\n36 Mari|Lind|1966-06-23     4  &lt;NA&gt; 177323\n37 Tamb|Bali|1953-05-10     1 white 140772\n38 Tamb|Bali|1953-05-10     2  &lt;NA&gt;     NA\n39 Tamb|Bali|1953-05-10     3 white     NA\n40 Tamb|Bali|1953-05-10     4  &lt;NA&gt; 139772\n\n# Forward fill missing race values within each patient (downward)\nvisits_all &lt;- visits_all %&gt;%\n  group_by(id_text) %&gt;%\n  mutate(race_forward = race) %&gt;%\n  fill(race_forward, .direction = \"down\") %&gt;%\n  ungroup()\n\n# Preview forward-filled race values (head)\nhead(visits_all %&gt;% select(id_text, visit, race, race_forward), n = 12)\n\n# A tibble: 12 √ó 4\n   id_text              visit race  race_forward\n   &lt;chr&gt;                &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt;       \n 1 Anit|S√°nc|1960-05-07     1 white white       \n 2 Anit|S√°nc|1960-05-07     2 &lt;NA&gt;  white       \n 3 Anit|S√°nc|1960-05-07     3 white white       \n 4 Anit|S√°nc|1960-05-07     4 &lt;NA&gt;  white       \n 5 Aure|Weis|2003-11-12     1 white white       \n 6 Aure|Weis|2003-11-12     2 &lt;NA&gt;  white       \n 7 Aure|Weis|2003-11-12     3 white white       \n 8 Aure|Weis|2003-11-12     4 &lt;NA&gt;  white       \n 9 Cars|Litt|2012-09-02     1 white white       \n10 Cars|Litt|2012-09-02     2 &lt;NA&gt;  white       \n11 Cars|Litt|2012-09-02     3 &lt;NA&gt;  white       \n12 Cars|Litt|2012-09-02     4 white white       \n\n# Backward fill missing race values within each patient (upward)\nvisits_all &lt;- visits_all %&gt;%\n  group_by(id_text) %&gt;%\n  mutate(race_backward = race) %&gt;%\n  fill(race_backward, .direction = \"up\") %&gt;%\n  ungroup()\n\n# Preview backward-filled race values (tail)\ntail(visits_all %&gt;% select(id_text, visit, race, race_backward), n = 12)\n\n# A tibble: 12 √ó 4\n   id_text              visit race  race_backward\n   &lt;chr&gt;                &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt;        \n 1 Jimm|Doyl|2005-04-25     1 white white        \n 2 Jimm|Doyl|2005-04-25     2 &lt;NA&gt;  white        \n 3 Jimm|Doyl|2005-04-25     3 &lt;NA&gt;  white        \n 4 Jimm|Doyl|2005-04-25     4 white white        \n 5 Mari|Lind|1966-06-23     1 white white        \n 6 Mari|Lind|1966-06-23     2 &lt;NA&gt;  white        \n 7 Mari|Lind|1966-06-23     3 white white        \n 8 Mari|Lind|1966-06-23     4 &lt;NA&gt;  &lt;NA&gt;         \n 9 Tamb|Bali|1953-05-10     1 white white        \n10 Tamb|Bali|1953-05-10     2 &lt;NA&gt;  white        \n11 Tamb|Bali|1953-05-10     3 white white        \n12 Tamb|Bali|1953-05-10     4 &lt;NA&gt;  &lt;NA&gt;         \n\n# Calculate the global (overall) mean income\nglobal_mean_income &lt;- mean(visits_all$income, na.rm = TRUE)\n\n# Use global mean to impute missing income values\nvisits_all &lt;- visits_all %&gt;%\n  mutate(income_global_mean = ifelse(is.na(income), global_mean_income, income))\n\n# Preview global mean-imputed income (head)\nhead(visits_all %&gt;% select(id_text, visit, income, income_global_mean), n = 12)\n\n# A tibble: 12 √ó 4\n   id_text              visit income income_global_mean\n   &lt;chr&gt;                &lt;dbl&gt;  &lt;dbl&gt;              &lt;dbl&gt;\n 1 Anit|S√°nc|1960-05-07     1  61016             61016 \n 2 Anit|S√°nc|1960-05-07     2     NA             96123.\n 3 Anit|S√°nc|1960-05-07     3     NA             96123.\n 4 Anit|S√°nc|1960-05-07     4  60016             60016 \n 5 Aure|Weis|2003-11-12     1   8752              8752 \n 6 Aure|Weis|2003-11-12     2     NA             96123.\n 7 Aure|Weis|2003-11-12     3     NA             96123.\n 8 Aure|Weis|2003-11-12     4   7752              7752 \n 9 Cars|Litt|2012-09-02     1  71169             71169 \n10 Cars|Litt|2012-09-02     2     NA             96123.\n11 Cars|Litt|2012-09-02     3  70169             70169 \n12 Cars|Litt|2012-09-02     4     NA             96123.\n\n# Calculate mean income per participant (id_text)\nparticipant_mean_income &lt;- visits_all %&gt;%\n  group_by(id_text) %&gt;%\n  summarise(mean_income_id = mean(income, na.rm = TRUE), .groups = \"drop\")\n\n# Use participant-level mean to impute missing income values\nvisits_all &lt;- visits_all %&gt;%\n  left_join(participant_mean_income, by = \"id_text\") %&gt;%\n  mutate(income_participant_mean = ifelse(is.na(income), mean_income_id, income))\n\n# Preview participant mean-imputed income (tail)\ntail(visits_all %&gt;% select(id_text, visit, income, income_participant_mean), n = 12)\n\n# A tibble: 12 √ó 4\n   id_text              visit income income_participant_mean\n   &lt;chr&gt;                &lt;dbl&gt;  &lt;dbl&gt;                   &lt;dbl&gt;\n 1 Jimm|Doyl|2005-04-25     1 198522                  198522\n 2 Jimm|Doyl|2005-04-25     2     NA                  198022\n 3 Jimm|Doyl|2005-04-25     3 197522                  197522\n 4 Jimm|Doyl|2005-04-25     4     NA                  198022\n 5 Mari|Lind|1966-06-23     1 178323                  178323\n 6 Mari|Lind|1966-06-23     2     NA                  177823\n 7 Mari|Lind|1966-06-23     3     NA                  177823\n 8 Mari|Lind|1966-06-23     4 177323                  177323\n 9 Tamb|Bali|1953-05-10     1 140772                  140772\n10 Tamb|Bali|1953-05-10     2     NA                  140272\n11 Tamb|Bali|1953-05-10     3     NA                  140272\n12 Tamb|Bali|1953-05-10     4 139772                  139772\n\n# Multiple imputation for fips, zip, healthcare_coverage, and income\npatients_mice &lt;- visits_all %&gt;%\n  select(id_text, fips, zip, healthcare_coverage, income)\n\n# Apply mice\nimputed &lt;- mice(patients_mice %&gt;% select(-id_text), method = \"pmm\", m = 1, printFlag = FALSE)\n\nWarning: Number of logged events: 1\n\n# Retrieve completed dataset\nmice_result &lt;- complete(imputed)\ncolnames(mice_result) &lt;- paste0(colnames(mice_result), \"_imputed\")\n\n# Join ID and filter rows with original missing values\ndf_mice &lt;- bind_cols(patients_mice, mice_result) %&gt;%\n  filter(is.na(fips) | is.na(zip) | is.na(healthcare_coverage) | is.na(income)) %&gt;%\n  select(id_text,\n         fips, fips_imputed,\n         zip, zip_imputed,\n         healthcare_coverage, healthcare_coverage_imputed,\n         income, income_imputed)\n\nhead(df_mice, n = 12)\n\n# A tibble: 12 √ó 9\n   id_text               fips fips_imputed   zip zip_imputed healthcare_coverage\n   &lt;chr&gt;                &lt;int&gt;        &lt;int&gt; &lt;int&gt;       &lt;int&gt;               &lt;dbl&gt;\n 1 Anit|S√°nc|1960-05-07 25009        25009  1915        1915            1280070.\n 2 Anit|S√°nc|1960-05-07 25009        25009  1915        1915            1280070.\n 3 Aure|Weis|2003-11-12 25027        25027  1606        1606             253645.\n 4 Aure|Weis|2003-11-12 25027        25027  1606        1606             253645.\n 5 Cars|Litt|2012-09-02 44007        44007  2861        2861                 NA \n 6 Cars|Litt|2012-09-02 44007        44007  2861        2861                 NA \n 7 Cars|Litt|2012-09-02 44007        44007  2861        2861                 NA \n 8 Cars|Litt|2012-09-02 44007        44007  2861        2861                 NA \n 9 Doll|Fran|2008-10-04    NA        25013    NA        2468             422516.\n10 Doll|Fran|2008-10-04    NA        25027    NA        1030             422516.\n11 Doll|Fran|2008-10-04    NA        25017    NA        2861             422516.\n12 Doll|Fran|2008-10-04    NA        25017    NA        1606             422516.\n# ‚Ñπ 3 more variables: healthcare_coverage_imputed &lt;dbl&gt;, income &lt;dbl&gt;,\n#   income_imputed &lt;dbl&gt;\n\n# Optional: Inspect logged events from mice\nimputed$loggedEvents\n\n  it im                 dep meth\n1  3  1 healthcare_coverage  pmm\n                                                                                                                                                                                                                                                       out\n1 mice detected that your data are (nearly) multi-collinear.\\nIt applied a ridge penalty to continue calculations, but the results can be unstable.\\nDoes your dataset contain duplicates, linear transformation, or factors with unique respondent names?\n\n# Final summary: compare original and imputed values for rows with missingness\n\nfinal_impute_check &lt;- visits_all %&gt;%\n  filter(is.na(race) | is.na(income)) %&gt;%\n  select(id_text, visit,\n         race, race_forward, race_backward,\n         income, income_global_mean, income_participant_mean)\n\n# Preview top 12\nhead(final_impute_check, n = 12)\n\n# A tibble: 12 √ó 8\n   id_text      visit race  race_forward race_backward income income_global_mean\n   &lt;chr&gt;        &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt;        &lt;chr&gt;          &lt;dbl&gt;              &lt;dbl&gt;\n 1 Anit|S√°nc|1‚Ä¶     2 &lt;NA&gt;  white        white             NA             96123.\n 2 Anit|S√°nc|1‚Ä¶     3 white white        white             NA             96123.\n 3 Anit|S√°nc|1‚Ä¶     4 &lt;NA&gt;  white        &lt;NA&gt;           60016             60016 \n 4 Aure|Weis|2‚Ä¶     2 &lt;NA&gt;  white        white             NA             96123.\n 5 Aure|Weis|2‚Ä¶     3 white white        white             NA             96123.\n 6 Aure|Weis|2‚Ä¶     4 &lt;NA&gt;  white        &lt;NA&gt;            7752              7752 \n 7 Cars|Litt|2‚Ä¶     2 &lt;NA&gt;  white        white             NA             96123.\n 8 Cars|Litt|2‚Ä¶     3 &lt;NA&gt;  white        white          70169             70169 \n 9 Cars|Litt|2‚Ä¶     4 white white        white             NA             96123.\n10 Doll|Fran|2‚Ä¶     2 &lt;NA&gt;  white        white             NA             96123.\n11 Doll|Fran|2‚Ä¶     3 &lt;NA&gt;  white        white         187023            187023 \n12 Doll|Fran|2‚Ä¶     4 white white        white             NA             96123.\n# ‚Ñπ 1 more variable: income_participant_mean &lt;dbl&gt;\n\n# Preview bottom 12\ntail(final_impute_check, n = 12)\n\n# A tibble: 12 √ó 8\n   id_text      visit race  race_forward race_backward income income_global_mean\n   &lt;chr&gt;        &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt;        &lt;chr&gt;          &lt;dbl&gt;              &lt;dbl&gt;\n 1 Home|Qui√±|1‚Ä¶     2 &lt;NA&gt;  white        white             NA             96123.\n 2 Home|Qui√±|1‚Ä¶     3 &lt;NA&gt;  white        white           6361              6361 \n 3 Home|Qui√±|1‚Ä¶     4 white white        white             NA             96123.\n 4 Jimm|Doyl|2‚Ä¶     2 &lt;NA&gt;  white        white             NA             96123.\n 5 Jimm|Doyl|2‚Ä¶     3 &lt;NA&gt;  white        white         197522            197522 \n 6 Jimm|Doyl|2‚Ä¶     4 white white        white             NA             96123.\n 7 Mari|Lind|1‚Ä¶     2 &lt;NA&gt;  white        white             NA             96123.\n 8 Mari|Lind|1‚Ä¶     3 white white        white             NA             96123.\n 9 Mari|Lind|1‚Ä¶     4 &lt;NA&gt;  white        &lt;NA&gt;          177323            177323 \n10 Tamb|Bali|1‚Ä¶     2 &lt;NA&gt;  white        white             NA             96123.\n11 Tamb|Bali|1‚Ä¶     3 white white        white             NA             96123.\n12 Tamb|Bali|1‚Ä¶     4 &lt;NA&gt;  white        &lt;NA&gt;          139772            139772 \n# ‚Ñπ 1 more variable: income_participant_mean &lt;dbl&gt;\n\n# Clean up temporary objects \nrm( participant_mean_income, final_impute_check, global_mean_income, df_passport, df_mice,\n    patients_mice, imputed, mice_result, missing_summary, total_missing, n_missing_individuals, missing_rows\n)"
  },
  {
    "objectID": "Post_Blog/Visualisations/index_original.html#part-v-descriptive-statistics-and-tabulation",
    "href": "Post_Blog/Visualisations/index_original.html#part-v-descriptive-statistics-and-tabulation",
    "title": "Date Manipulation and Wrangling using R",
    "section": "",
    "text": "In data analysis, summarising and tabulating variables is often the first step before conducting modelling or drawing conclusions. Descriptive statistics reveal the central tendency, variability, distribution shape, and frequency patterns in your dataset.\nThis section provides an overview of the most commonly used R functions for summarising both numeric and categorical variables. These tools help detect outliers, missing data, or skewed distributions and are essential for generating publication-ready summary tables.\nüìö Further are available via:\n\nYouTube: AnalyticsHub\n\nGithub: Summary Tools Repository\n\n\nSome of the contents essential for this section are presented below.\nBasic Summary Statistics\nsummary(), mean(), median(), min(), max(), sd(), var(), range(), quantile(), IQR()\nDistribution Shape / Skewness: skewness(), kurtosis() Extended Descriptive Summaries: describe() ,stat.desc(), skim() Tabulation (Frequencies and Proportions)\ntable(), prop.table(), addmargins(), xtabs()\nTidy Summary and Tabulations\ntabyl(), adorn_percentages(), adorn_totals() ‚Äì From janitor\ncount(), group_by() + summarise() ‚Äì From dplyr\npivot_wider(), pivot_longer() ‚Äì From tidyr\nCross Tabulations: CrossTable() ‚Äì From gmodels\n\n\nThese functions are useful for summarising continuous variables such as age, vaccine cost, or time intervals:\n\nsummary() ‚Äì 5-number summary + mean\n\nmean(), median() ‚Äì Measures of central tendency\n\nsd(), var() ‚Äì Measures of spread\n\nmin(), max() ‚Äì Extremes\n\nrange() ‚Äì Min and max in one\n\nquantile() ‚Äì Percentiles (e.g., 25th, 75th)\nIQR() ‚Äì Interquartile range\n\n\n\n\n  Childhood Respiratory       Other \n        472         955         126 \n\n\n\nFemale   Male \n   798    755 \n\n\n\n# ....................................................\n# Basic Summary Statistics Using Base R\n# ....................................................\n\n# Select key numeric variables\nsummary_vars &lt;- vacc_1524 %&gt;% \n  select(age, base_cost, healthcare_expenses)\n\n# View summary() for a quick five-number summary + mean\nsummary(summary_vars)\n\n      age          base_cost   healthcare_expenses\n Min.   : 1.00   Min.   :136   Min.   :    527.5  \n 1st Qu.:12.00   1st Qu.:136   1st Qu.:  14478.2  \n Median :25.00   Median :136   Median :  56729.2  \n Mean   :32.42   Mean   :136   Mean   : 156656.2  \n 3rd Qu.:52.00   3rd Qu.:136   3rd Qu.: 195830.8  \n Max.   :97.00   Max.   :136   Max.   :1157946.9  \n\n# Individual statistics for 'age'\nmean(vacc_1524$age, na.rm = TRUE)             # Mean age\n\n[1] 32.41661\n\nmedian(vacc_1524$age, na.rm = TRUE)           # Median age\n\n[1] 25\n\nmin(vacc_1524$age, na.rm = TRUE)              # Minimum age\n\n[1] 1\n\nmax(vacc_1524$age, na.rm = TRUE)              # Maximum age\n\n[1] 97\n\nsd(vacc_1524$age, na.rm = TRUE)               # Standard deviation of age\n\n[1] 23.76926\n\nvar(vacc_1524$age, na.rm = TRUE)              # Variance of age\n\n[1] 564.9777\n\nrange(vacc_1524$age, na.rm = TRUE)            # Range: min and max\n\n[1]  1 97\n\nquantile(vacc_1524$age, probs = c(0.25, 0.5, 0.75), na.rm = TRUE)  # Quartiles\n\n25% 50% 75% \n 12  25  52 \n\nIQR(vacc_1524$age, na.rm = TRUE)              # Interquartile range\n\n[1] 40\n\n# ....................................................\n# Clean up temporary object\n# ....................................................\nrm(summary_vars)\n\n\n\n\nThese indicators describe the shape of a numeric variable‚Äôs distribution. They help identify when a variable is:\n\nSkewed (not symmetric)\nHeavy-tailed (high kurtosis)\n\nDistribution Shape: Skewness and Kurtosis\n\n\n\n\n\n\n\n\nValue Range\nSkewness\nKurtosis (Excess)\n\n\n\n\n‚âà 0\nSymmetrical\nMesokurtic (normal-tailed)\n\n\n¬±0.5\nApproximately symmetrical\nSlight deviation\n\n\n¬±0.5 ‚Äì ¬±1\nModerate skew\nModerate peakedness or flatness\n\n\n&gt; ¬±1\nHigh skew (strong asymmetry)\nSubstantial deviation from normality\n\n\n&gt; 0 (kurtosis - 3 &gt; 0)\n‚Äì\nLeptokurtic (peaked, heavy tails)\n\n\n&lt; 0 (kurtosis - 3 &lt; 0)\n‚Äì\nPlatykurtic (flat, light tails)\n\n\n\n\n# Ensure the 'moments' package is installed\nif (!requireNamespace(\"moments\", quietly = TRUE)) {install.packages(\"moments\")}\nlibrary(moments)\n\n\n# Calculate distribution shape statistics\nskewness(vacc_1524$age, na.rm = TRUE)     # Skewness: +ve = right-skewed, -ve = left-skewed\n\n[1] 0.5301022\n\nkurtosis(vacc_1524$age, na.rm = TRUE)     # Kurtosis: &gt;3 = heavy tails, &lt;3 = flat distribution\n\n[1] 2.059686\n\nkurtosis(vacc_1524$age, na.rm = TRUE) - 3  # Excess kurtosis\n\n[1] -0.940314\n\n# ....................................................\n# Histogram to Visualize Distribution Shape\n# ....................................................\nhist(vacc_1524$age, \n     main = \"Histogram of Age\",\n     xlab = \"Age (Years)\", \n     col = \"#69b3a2\", \n     border = \"white\")\n\n\n\n\n\n\n\n\n\n\n\n\nTo produce a comprehensive summary of all variables (especially helpful in surveys or health system datasets), use:\n\ndescribe() ‚Äì From Hmisc: includes labels, missing %, and stats\n\nstat.desc() ‚Äì From pastecs: full statistical description with skew/kurtosis\n\nskim() ‚Äì From skimr: summary with inline histograms and types\n\n\n\n# Install required packages if missing\npackages &lt;- c(\"Hmisc\", \"pastecs\", \"skimr\")\nfor (p in packages) {if (!requireNamespace(p, quietly = TRUE)) install.packages(p)}\n\n# Explicitly load the packages\nlibrary(Hmisc)     # for describe()\nlibrary(pastecs)   # for stat.desc()\nlibrary(skimr)     # for skim()\n\nrm (packages)\n\n\n# ------------------------------\n# Extended Descriptive Summaries\n# ------------------------------\n\n# Hmisc::describe() ‚Äì Detailed variable summary\ndescribe(vacc_1524[, c(\"age\", \"gender\", \"race\")])\n\nvacc_1524[, c(\"age\", \"gender\", \"race\")] \n\n 3  Variables      1553  Observations\n--------------------------------------------------------------------------------\nage \n       n  missing distinct     Info     Mean  pMedian      Gmd      .05 \n    1553        0       62    0.999    32.42       32    26.76      5.0 \n     .10      .25      .50      .75      .90      .95 \n     6.0     12.0     25.0     52.0     68.8     73.0 \n\nlowest :  1  2  5  6  7, highest: 76 78 80 85 97\n--------------------------------------------------------------------------------\ngender \n       n  missing distinct \n    1553        0        2 \n                        \nValue      Female   Male\nFrequency     798    755\nProportion  0.514  0.486\n--------------------------------------------------------------------------------\nrace \n       n  missing distinct \n    1553        0        5 \n                                             \nValue       asian  black native  other  white\nFrequency     111     94     13     29   1306\nProportion  0.071  0.061  0.008  0.019  0.841\n--------------------------------------------------------------------------------\n\n# pastecs::stat.desc() ‚Äì Full statistics with skewness/kurtosis\nstat.desc(vacc_1524$age)\n\n     nbr.val     nbr.null       nbr.na          min          max        range \n1.553000e+03 0.000000e+00 0.000000e+00 1.000000e+00 9.700000e+01 9.600000e+01 \n         sum       median         mean      SE.mean CI.mean.0.95          var \n5.034300e+04 2.500000e+01 3.241661e+01 6.031564e-01 1.183087e+00 5.649777e+02 \n     std.dev     coef.var \n2.376926e+01 7.332432e-01 \n\n# skimr::skim() ‚Äì Tidy summary with histograms and data types\nskim(vacc_1524[, c(\"age\", \"gender\", \"income\")])\n\n\nData summary\n\n\nName\nvacc_1524[, c(‚Äúage‚Äù, ‚Äúgen‚Ä¶\n\n\nNumber of rows\n1553\n\n\nNumber of columns\n3\n\n\n_______________________\n\n\n\nColumn type frequency:\n\n\n\nfactor\n1\n\n\nnumeric\n2\n\n\n________________________\n\n\n\nGroup variables\nNone\n\n\n\nVariable type: factor\n\n\n\n\n\n\n\n\n\n\n\nskim_variable\nn_missing\ncomplete_rate\nordered\nn_unique\ntop_counts\n\n\n\n\ngender\n0\n1\nFALSE\n2\nFem: 798, Mal: 755\n\n\n\nVariable type: numeric\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nskim_variable\nn_missing\ncomplete_rate\nmean\nsd\np0\np25\np50\np75\np100\nhist\n\n\n\n\nage\n0\n1\n32.42\n23.77\n1\n12\n25\n52\n97\n‚ñá‚ñÉ‚ñÉ‚ñÉ‚ñÅ\n\n\nincome\n0\n1\n108887.58\n139702.07\n7361\n35860\n75767\n124775\n816851\n‚ñá‚ñÅ‚ñÅ‚ñÅ‚ñÅ\n\n\n\n\n\n\n\n\nUsed for categorical variables like gender, race, or vaccine group:\n\ntable() ‚Äì Basic frequency counts\n\nprop.table() ‚Äì Row/column proportions\n\naddmargins() ‚Äì Adds totals to tables\n\nxtabs() ‚Äì Cross-tabulation formula interface\n\n\n\n# --------------------------------------------\n# üîπ Categorical Variable Summary \n# --------------------------------------------\n\n# Basic frequency counts for individual vaccine types\ntable(vacc_1524$vaccine_group)\n\n\n          COVID-19          DTP group          Hepatitis                Hib \n               144                147                111                 32 \n               HPV          Influenza                IPV      Meningococcal \n                59                811                 47                 50 \n               MMR Pneumococcal PCV13 Pneumococcal PPV23          Rotavirus \n                26                 52                  8                 21 \n         Varicella             Zoster \n                26                 19 \n\n# Frequency counts for grouped vaccine categories\ntable(vacc_1524$vacc_group3)\n\n\n  Childhood Respiratory       Other \n        472         955         126 \n\n# Proportion of grouped vaccine categories\nprop.table(table(vacc_1524$vacc_group3))  # Overall proportions\n\n\n  Childhood Respiratory       Other \n 0.30392788  0.61493883  0.08113329 \n\n# Frequency table with row/column totals added\naddmargins(table(vacc_1524$vacc_group3))\n\n\n  Childhood Respiratory       Other         Sum \n        472         955         126        1553 \n\n# Cross-tabulation between vaccine group and gender\nxtabs(~ vacc_group3 + gender, data = vacc_1524)\n\n             gender\nvacc_group3   Female Male\n  Childhood      233  239\n  Respiratory    511  444\n  Other           54   72\n\n\n\n\n\nModern workflows prefer tidy-format summaries using:\n\ntabyl() ‚Äì From janitor: clean frequency tables\n\nadorn_totals(), adorn_percentages() ‚Äì Add percentages and totals\n\ncount() ‚Äì From dplyr: group-level counts\n\ngroup_by() + summarise() ‚Äì Group-wise summary\npivot_wider(), pivot_longer() ‚Äì Reshape tables\n\nThe section below demonstrates tabulations using janitor::tabyl() and tidyverse functions for grouped summaries and table reshaping.\n\n# --------------------------------------------\n# üîπ Tabulation and Table Reshaping \n# --------------------------------------------\n\n# 1. Basic clean frequency table with janitor::tabyl()\nvacc_1524 %&gt;%\n  tabyl(vacc_group3)\n\n vacc_group3   n    percent\n   Childhood 472 0.30392788\n Respiratory 955 0.61493883\n       Other 126 0.08113329\n\n# 2. Add column percentages and total row\nvacc_1524 %&gt;%\n  tabyl(vacc_group3, gender) %&gt;%\n  adorn_percentages(\"col\") %&gt;%\n  adorn_totals(\"row\") %&gt;%\n  adorn_title(\"combined\")  # Cleaner column names\n\n vacc_group3/gender     Female       Male\n          Childhood 0.29197995 0.31655629\n        Respiratory 0.64035088 0.58807947\n              Other 0.06766917 0.09536424\n              Total 1.00000000 1.00000000\n\n# 3. Group-level count using dplyr::count()\nvacc_1524 %&gt;%\n  count(vacc_group3, gender)\n\n  vacc_group3 gender   n\n1   Childhood Female 233\n2   Childhood   Male 239\n3 Respiratory Female 511\n4 Respiratory   Male 444\n5       Other Female  54\n6       Other   Male  72\n\n# 4. Group-wise summary using group_by + summarise\nvacc_1524 %&gt;%\n  group_by(vacc_group3) %&gt;%\n  summarise(n = n(), .groups = \"drop\") %&gt;%\n  mutate(prop = n / sum(n))\n\n# A tibble: 3 √ó 3\n  vacc_group3     n   prop\n  &lt;fct&gt;       &lt;int&gt;  &lt;dbl&gt;\n1 Childhood     472 0.304 \n2 Respiratory   955 0.615 \n3 Other         126 0.0811\n\n# 5. Pivot table to wide format (e.g., for display or reporting)\nvacc_1524 %&gt;%\n  count(vacc_group3, gender) %&gt;%\n  pivot_wider(names_from = gender, values_from = n, values_fill = 0)\n\n# A tibble: 3 √ó 3\n  vacc_group3 Female  Male\n  &lt;fct&gt;        &lt;int&gt; &lt;int&gt;\n1 Childhood      233   239\n2 Respiratory    511   444\n3 Other           54    72\n\n# 6. Optional: Pivot longer to return to tidy format\nvacc_1524 %&gt;%\n  count(vacc_group3, gender) %&gt;%\n  pivot_wider(names_from = gender, values_from = n, values_fill = 0) %&gt;%\n  pivot_longer(-vacc_group3, names_to = \"gender\", values_to = \"count\")\n\n# A tibble: 6 √ó 3\n  vacc_group3 gender count\n  &lt;fct&gt;       &lt;chr&gt;  &lt;int&gt;\n1 Childhood   Female   233\n2 Childhood   Male     239\n3 Respiratory Female   511\n4 Respiratory Male     444\n5 Other       Female    54\n6 Other       Male      72\n\n\n\n\n\nUsed to explore the relationship between two or more categorical variables.\n\nCrossTable() ‚Äì From gmodels: produces detailed cross-tabs with row %, column %, and counts\n\n\n# Install and load the gmodels package for cross-tabulation\nif (!requireNamespace(\"gmodels\", quietly = TRUE)) {\n  install.packages(\"gmodels\")\n}\nlibrary(gmodels)\n\n\n# ------------------------------\n# Cross Tabulation Example\n# ------------------------------\n\n# Generate a contingency table between gender and vaccine group\nCrossTable(vacc_1524$vacc_group3, vacc_1524$gender,\n           prop.r = FALSE,     # Row proportions\n           prop.c = TRUE,     # Column proportions\n           prop.t = FALSE,    # Overall proportion (optional)\n           chisq = TRUE)      # Include chi-square test for independence\n\n\n \n   Cell Contents\n|-------------------------|\n|                       N |\n| Chi-square contribution |\n|           N / Col Total |\n|-------------------------|\n\n \nTotal Observations in Table:  1553 \n\n \n                      | vacc_1524$gender \nvacc_1524$vacc_group3 |    Female |      Male | Row Total | \n----------------------|-----------|-----------|-----------|\n            Childhood |       233 |       239 |       472 | \n                      |     0.375 |     0.396 |           | \n                      |     0.292 |     0.317 |           | \n----------------------|-----------|-----------|-----------|\n          Respiratory |       511 |       444 |       955 | \n                      |     0.838 |     0.886 |           | \n                      |     0.640 |     0.588 |           | \n----------------------|-----------|-----------|-----------|\n                Other |        54 |        72 |       126 | \n                      |     1.783 |     1.885 |           | \n                      |     0.068 |     0.095 |           | \n----------------------|-----------|-----------|-----------|\n         Column Total |       798 |       755 |      1553 | \n                      |     0.514 |     0.486 |           | \n----------------------|-----------|-----------|-----------|\n\n \nStatistics for All Table Factors\n\n\nPearson's Chi-squared test \n------------------------------------------------------------\nChi^2 =  6.162349     d.f. =  2     p =  0.04590531 \n\n\n \n\n\n\nüîπ Summary Table: Descriptive Statistics and Tabulation Functions\n\n\n\n\n\n\n\n\nTask\nFunction\nPackage\n\n\n\n\nBasic numeric summaries\nsummary(), mean(), sd(), IQR()\nbase\n\n\nPercentiles and range\nquantile(), range()\nbase\n\n\nSkewness / Kurtosis\nskewness(), kurtosis()\ne1071, moments\n\n\nExtended profiling\ndescribe(), stat.desc(), skim()\nHmisc, pastecs, skimr\n\n\nFrequency tables\ntable(), xtabs(), prop.table()\nbase\n\n\nClean tables (tidy)\ntabyl(), adorn_*(), count()\njanitor, dplyr\n\n\nGroup summaries\ngroup_by() + summarise()\ndplyr\n\n\nReshape for tables\npivot_wider(), pivot_longer()\ntidyr\n\n\nRich cross-tabulation\nCrossTable()\ngmodels\n\n\n\n\n\n\n\n\nwrite.csv(), write_xlsx(), saveRDS(), write_tsv()\nExporting interactive tables with DT::datatable()\nSaving and loading the entire R workspace (save.image(), load())"
  },
  {
    "objectID": "Post_Blog/Visualisations/index_original.html#part-vi-data-visualization-with-ggplot2",
    "href": "Post_Blog/Visualisations/index_original.html#part-vi-data-visualization-with-ggplot2",
    "title": "Date Manipulation and Wrangling using R",
    "section": "",
    "text": "Visualization Contents and Types Overview\n\nLayers: Theme, Coordinates, Facets, Statistics, Geometries, Aesthetics, Data\nChart Types: line, histogram, boxplot, bar, area, density, violin, dotplot, ECDF, scatter, bubble, QQ plot\nComparative & Multivariate: faceted plot, pair plot, heatmap, treemap, radar chart, ridgeline plot, forest plot\nGeospatial Visualization: choropleth map, point map, heatmap overlay\nStatistical Overlays: error bars, confidence intervals, regression lines, smoothers\nInteractive Visualization: scatter/line/bar (Plotly), interactive tables (DT), interactive maps (Leaflet), dashboards (Shiny, flexdashboard)\n\nEffective visualizations help uncover patterns, trends, and insights in data. In R, we commonly use the ggplot2 package for static plots and tools like plotly, DT, and leaflet for interactive dashboards and graphics.\nThe sections below summarize different types of visualizations and how they fit into analysis workflows.\n\n\n\nEvery ggplot chart is built using multiple composable layers: - Data: The dataset to visualize. - Aesthetics (aes()): Mappings between variables and visual elements (e.g., x, y, color). - Geometries (geom_*): Plot types (e.g., geom_line(), geom_bar()). - Statistics (stat_*): Summaries or transformations (e.g., stat_smooth()). - Facets: Create multiple plots by group (facet_wrap(), facet_grid()). - Coordinates: Set axis and aspect ratio (coord_cartesian(), coord_flip()). - Themes: Control overall appearance (e.g., theme_minimal(), theme_bw()).\n\n\n\n\n\n\n\n\n\n\n\nChart Type\nFunction\nUsed For\n\n\n\n\nLine Chart\ngeom_line()\nTrends over time\n\n\nHistogram\ngeom_histogram()\nDistribution of continuous variables\n\n\nBoxplot\ngeom_boxplot()\nDistribution & outliers\n\n\nBar Plot\ngeom_bar()\nCounts or categorical comparison\n\n\nArea Plot\ngeom_area()\nCumulative trends\n\n\nDensity Plot\ngeom_density()\nSmoothed distribution\n\n\nViolin Plot\ngeom_violin()\nCombination of boxplot + density\n\n\nDot Plot\ngeom_dotplot()\nCount-based plots\n\n\nECDF Plot\nstat_ecdf()\nCumulative distribution\n\n\nScatter Plot\ngeom_point()\nBivariate relationships\n\n\nBubble Plot\ngeom_point(aes(size = ...))\n3-variable comparison using size\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nVisual Type\nPurpose\n\n\n\n\nFaceted Plot (facet_wrap)\nCompare subgroups in separate panels\n\n\nPair Plot (GGally::ggpairs)\nExplore all pairwise relationships\n\n\nHeatmap (geom_tile, heatmap())\nShow intensity using color\n\n\nTreemap (treemapify)\nHierarchical categories and values\n\n\nRadar Chart (fmsb)\nCompare multivariate profiles\n\n\nRidgeline Plot (ggridges)\nDistribution comparison across groups\n\n\nForest Plot (forestplot, ggforestplot)\nConfidence intervals and effect sizes\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nMap Type\nFunction/Use\n\n\n\n\nChoropleth Map\nShow values by region (e.g., geom_sf(), tmap)\n\n\nPoint Map\nLocations with coordinates (e.g., geom_point(), leaflet::addMarkers)\n\n\nHeatmap Overlay\nDensity of spatial events (e.g., leaflet::addHeatmap())\n\n\n\n\n\n\n\n\nError bars: geom_errorbar() for confidence or SD intervals\nRegression lines: geom_smooth(method = \"lm\")\nTrend smoothing: geom_smooth() with method = \"loess\"\nLabeling: geom_text(), geom_label() to annotate plots\n\n\nThis section demonstrates how to visualize breast cancer screening and vaccination data. We‚Äôll walk through common chart types such as line plots, bar charts, boxplots, and faceted views. Each example is designed with annotations and descriptions to aid understanding.\n\n\n\n\nEach chart demonstrates how different ggplot2 components come together using real health datasets.\n\n# Install if not already installed\nif (!requireNamespace(\"treemapify\", quietly = TRUE)) {install.packages(\"treemapify\")}\nif (!requireNamespace(\"ggridges\", quietly = TRUE)) {install.packages(\"ggridges\")}\nif (!requireNamespace(\"gganimate\", quietly = TRUE)) install.packages(\"gganimate\")\nif (!requireNamespace(\"gifski\", quietly = TRUE)) install.packages(\"gifski\")\n\nlibrary(gganimate)\nlibrary(gifski)\nlibrary(ggridges)\nlibrary(dplyr)\nlibrary(ggplot2)\nlibrary(plotly)\nlibrary(treemapify)\nlibrary(stringr)  # for str_to_title()\nlibrary(tidyr)\n\n\n\n Date[1:1553], format: \"1994-02-06\" \"1994-02-06\" \"1994-02-06\" \"1994-02-06\" \"1994-02-06\" ...\n\n\n\n  1   2   5   6   7  10  11  12  13  14  15  16  17  18  19  20  21  23  24  25 \n 46  24  64  66  34 100  38  59  21  21  34  81  18  36  18  34  40  13  12  47 \n 27  28  29  30  33  34  36  37  38  40  41  42  43  44  45  46  47  48  49  50 \n 17  30   9  35   4   7   6   8   6  20  37  16   9  17  15  13   9  21  30  15 \n 51  52  53  55  56  58  60  61  62  63  64  65  68  69  71  73  74  76  78  80 \n 13  30  16  30  26  14  12  24  36  13  25  14  14  47  14  19  15  14  12  13 \n 85  97 \n 12  10 \n\n\n\n  0‚Äì9 10‚Äì19 20‚Äì29 30‚Äì49   50+ \n  234   426   202   253   438 \n\n\n\n2016 2017 2018 2019 \n 341  341  341  341 \n\n\nLine Chart ‚Äì Breast Cancer Screening Trends by Region in Australia\nThe example below shows a line chart illustrating trends in breast cancer screening rates across Australian states from 2016 to 2019.\n\nBreast cancer screening rates across most Australian states appeared relatively consistent from 2016 to 2018, with minor year-to-year variations.\nA notable decline in screening rates is evident after 2018 and particularly in 2019, coinciding with the early stages of the COVID-19 pandemic\n\nState-specific Observations:\n\nTasmania (Tas) consistently had the highest screening rate, around 60%, but showed a clear decline post-2018.\nThe Northern Territory (NT) had the lowest rates, around 40%, also experiencing a slight decline during this period.\nOther states (ACT, NSW, Qld, SA, Vic, WA) maintained relatively stable rates (around 55%) until 2018, after which a distinct downturn is noticeable, particularly in Western Australia (WA) and Victoria (Vic).\n\nImpact of COVID-19:\n\nThe observed decline in breast cancer screening from 2019 onwards aligns with the emergence of the COVID-19 pandemic, which disrupted routine healthcare services globally.\n\nThis analysis underscores the importance of maintaining consistent access to healthcare services, particularly preventive screenings, even during periods of significant healthcare disruption.\n\n# Visualizing changes in screening rates (50‚Äì74 years) over time by state\n\nbreast_cancer_data %&gt;%\n  group_by(state, year_4digit) %&gt;%  # group by state and year\n  summarise(mean_rate = mean(rate50_74, na.rm = TRUE), .groups = \"drop\") %&gt;%\n  ggplot(aes(x = year_4digit, y = mean_rate, color = state)) +  # map axes and color\n  geom_line(size = 1.2) +  # trend lines\n  geom_point(size = 2) +   # points for each year\n  labs(\n    title = \"Breast Cancer Screening Rates (50‚Äì74 yrs)\",  \n    subtitle = \"Aggregated by State and Year\",           \n    x = \"Year\", y = \"Screening Rate (%)\",  # Axis labels\n    color = \"State\"   # Legend title\n  ) +\n  \n  theme_minimal()  \n\nWarning: Using `size` aesthetic for lines was deprecated in ggplot2 3.4.0.\n‚Ñπ Please use `linewidth` instead.\n\n\nWarning: Removed 4 rows containing missing values or values outside the scale range\n(`geom_line()`).\n\n\nWarning: Removed 4 rows containing missing values or values outside the scale range\n(`geom_point()`).\n\n\n\n\n\n\n\n\n\nHistogram ‚Äì Distribution of Age\nDisplays the frequency of vaccinated individuals by age, with a density line overlay to visualize the distribution shape.\nThe example below shows a histogram illustrating the age distribution within our studied population. The distribution highlights a clear bimodal pattern, indicating two main age groups. The largest group comprises younger adults, predominantly around 20‚Äì30 years old, suggesting a significant representation of young adults. A smaller secondary group emerges around 55‚Äì65 years old, reflecting a noticeable segment of older adults. This pattern may indicate specific target groups or demographic characteristics relevant to the population from which the data was collected. Understanding these age clusters can help tailor appropriate health strategies, services, or interventions accordingly.\n\nvacc_1524 %&gt;%\n  ggplot(aes(x = age)) +\n  geom_histogram(aes(y = ..density..), binwidth = 5, fill = \"darkblue\", color = \"white\", alpha = 0.7) +\n  geom_density(color = \"red\", size = 1.2) +\n  labs(title = \"Age Distribution with Density Curve\", x = \"Age\", y = \"Density\") +\n  theme_minimal()\n\nWarning: The dot-dot notation (`..density..`) was deprecated in ggplot2 3.4.0.\n‚Ñπ Please use `after_stat(density)` instead.\n\n\n\n\n\n\n\n\n\nPie Chart ‚Äì Proportion by Vaccine Group\nShows how vaccine groups are proportionally represented in the dataset. Useful for visualizing categorical outcomes.\nIn the example below, the pie chart represents the proportion of vaccinations grouped into three categories:\n\nRespiratory vaccines account for the largest proportion, comprising 61% of all vaccines administered.\nChildhood vaccines represent a significant portion as well, making up 30%.\nThe category labeled Other includes 8% of vaccines administered, indicating a smaller but notable group of vaccinations outside the respiratory and childhood classifications.\n\n\nvacc_1524 %&gt;%\n  count(vacc_group3) %&gt;%\n  mutate(perc = n / sum(n), label = scales::percent(perc)) %&gt;%\n  ggplot(aes(x = \"\", y = perc, fill = vacc_group3)) +\n  geom_col(width = 1) +\n  coord_polar(theta = \"y\") +\n  geom_text(aes(label = label), position = position_stack(vjust = 0.5)) +\n  labs(title = \"Vaccine Group Proportions\", fill = \"Vaccine Group\") +\n  theme_void()\n\n\n\n\n\n\n\n\nBar Plot ‚Äì Vaccination Count by Vaccine Group\nThis plot compares the absolute count of vaccinations across groups, with horizontal bars for better readability of long labels.\nThe example below shows a horizontal bar chart illustrating the total number of vaccinations administered, grouped into three distinct categories:\n\nRespiratory vaccines clearly represent the largest group, indicating that these vaccines were administered most frequently within the population.\nThe Other category accounts for the smallest number of vaccinations, suggesting a relatively minor proportion of miscellaneous or specialized vaccines.\n\n\nvacc_1524 %&gt;%\n  count(vacc_group3) %&gt;%\n  ggplot(aes(x = reorder(vacc_group3, n), y = n, fill = vacc_group3)) +\n  geom_bar(stat = \"identity\") +\n  coord_flip() +\n  labs(title = \"Vaccination Count by Group\", x = NULL, y = \"Count\") +\n  theme_minimal() +\n  theme(legend.position = \"none\")\n\n\n\n\n\n\n\n\nGrouped Bar Plot ‚Äì Vaccination by Race and Vaccine Group\nThe example below shows a stacked bar chart presenting the distribution of vaccinations by race and vaccine category.\n\nRespiratory vaccines (represented in blue) dominate across all racial groups, consistently making up the largest proportion of administered vaccines, especially noticeable among Black and White groups.\nChildhood vaccines (represented in red) form a significant proportion of vaccinations among the Asian and Native groups, highlighting targeted or population-specific vaccination programs for younger age groups within these communities.\nThe Other vaccines category (represented in green) comprises a relatively minor proportion and appears more prominent among the Asian and White populations.\n\n**Implications:**\n\nThese patterns may suggest varying public health strategies, demographic factors, or differing healthcare access across racial groups. Understanding these variations can guide targeted healthcare interventions and improve vaccine coverage equity.\n\n# Prepare data: count vaccinations by race and vaccine group\n\nvacc_1524$race &lt;- tools::toTitleCase(vacc_1524$race)\n\nvacc_summary &lt;- vacc_1524 %&gt;%\n  count(race, vacc_group3) %&gt;%\n  group_by(race) %&gt;%\n  mutate(prop = n / sum(n)) %&gt;%\n  ungroup()\n\nggplot(vacc_summary, aes(x = race, y = prop, fill = vacc_group3)) +\n  geom_col(position = \"dodge\") +\n  labs(\n    title = \"Vaccination Distribution by Race and Vaccine Group\",\n    x = \"Race\", y = \"Proportion\",\n    fill = \"Vaccine Group\"\n  ) +\n  scale_y_continuous(labels = scales::percent_format()) +\n  theme_minimal() +\n  theme(axis.text.x = element_text(angle = 45, hjust = 1))\n\n\n\n\n\n\n\nrm(vacc_summary)\n\nStacked Bar Chart ‚Äì Race by Vaccine Group\nThe example below shows a stacked bar chart illustrating the number of vaccinations administered, grouped by vaccine type and categorized by racial groups.\n\nThe White population received the highest number of vaccinations across all vaccine categories (Childhood, Other, and Respiratory vaccines).\nOther racial groups (Asian, Black, Native, and Other) also received vaccinations, though in smaller numbers across each vaccine type, indicating ongoing efforts to reach diverse communities.\nRespiratory vaccines had the highest total number of vaccinations administered, suggesting these vaccines were a primary focus within the vaccination program.\n\nThis data helps to illustrate which groups have higher vaccine coverage and highlights the importance of ensuring equitable access and distribution across all communities.\n\nvacc_1524 %&gt;%\n  mutate(race = stringr::str_to_title(race)) %&gt;%\n  count(vacc_group3, race) %&gt;%\n  ggplot(aes(x = vacc_group3, y = n, fill = race)) +\n  geom_bar(stat = \"identity\") +\n  labs(title = \"Stacked Bar Chart: Race by Vaccine Group\", x = \"Vaccine Group\", y = \"Count\") +\n  theme_minimal()\n\n\n\n\n\n\n\n\nBoxplot ‚Äì Age Distribution by Vaccine Group\nVisualizes how age varies across vaccine groups using standard boxplots.\nThe example below shows a box plot depicting age distribution for three vaccine categories (Childhood vaccines, Other vaccines, and Respiratory vaccines):\nKey Observations:\n\nChildhood vaccines primarily cover younger ages, with most recipients under 25 years old. Some individuals beyond this age range appear as outliers, suggesting occasional vaccinations in older groups.\nRespiratory vaccines generally target an older age group, with the median age around 50 years, and a broad range from younger adults to elderly populations.\nThe Other vaccines category has a wider age distribution overall, suggesting these vaccines serve diverse age groups, though with fewer individuals compared to the other two groups.\n\nImplications:\nThis visualization highlights clear age-based targeting for different vaccine categories. Childhood vaccines are expectedly administered primarily to younger populations, while respiratory vaccines predominantly reach older adults. Understanding these age patterns helps to plan targeted public health campaigns and resource allocation effectively.\n\nvacc_1524 %&gt;%\n  ggplot(aes(x = vacc_group3, y = age, fill = vacc_group3)) +\n  geom_boxplot() +\n  labs(title = \"Age Distribution by Vaccine Group\",\n       x = \"Vaccine Group\", y = \"Age (Years)\") +\n  theme_minimal() +\n  theme(legend.position = \"none\")\n\n\n\n\n\n\n\n\nBoxplot with Jittered (Individual Data) Points\nCombines summary and raw data by overlaying individual age points on the boxplot.\nThe example below shows a boxplot with individual data points (jittered), displaying the age distribution of individuals across three vaccine groups: Childhood vaccines, Other vaccines, and Respiratory vaccines.\n\nChildhood vaccines:\nMost individuals who received childhood vaccines are young, with a median age around 10 years.\nThe distribution is tightly concentrated, though some older individuals (outliers) also received these vaccines.\nThe data points clearly cluster in younger age ranges, which is expected for this vaccine group.\n\nRespiratory vaccines:\n\nThis group has the highest median age, around 40‚Äì50 years.\nThe data points are more evenly spread out across a wide age range, with many individuals above 60 years, indicating respiratory vaccines are frequently administered to older populations.\n\n\nOther vaccines:\n\nThis group shows a wide range of ages, from infants to older adults.\nWhile the median age is still relatively low, the spread is broader compared to childhood vaccines, suggesting this category includes various vaccines administered across different age groups.\n\nImplications:\nBy combining summary statistics (boxplot) with individual-level data (dots), this chart offers a clear view of both overall trends and variation in vaccination by age. It confirms that vaccine distribution aligns with age-specific health needs‚Äîyoung children for childhood vaccines, and older adults for respiratory vaccines‚Äîwhile also showing the diversity within each group.\n\n\nvacc_1524 %&gt;%\n  ggplot(aes(x = vacc_group3, y = age, fill = vacc_group3)) +\n  geom_boxplot(outlier.shape = NA, alpha = 0.6) +\n  geom_point(position = position_jitter(width = 0.2),\n             alpha = 0.3, color = \"black\", size = 1.2) +\n  labs(title = \"Boxplot with Individual Data Points\",\n       x = \"Vaccine Group\", y = \"Age\") +\n  theme_minimal() +\n  theme(legend.position = \"none\")\n\n\n\n\n\n\n\n\nBoxplot with Violin Overlay\nAdds a violin plot to visualize the full distribution of ages while preserving boxplot summary stats.\nThe plot below combines a boxplot and violin plot to display the age distribution across different vaccine groups: Childhood vaccines, Other vaccines, and Respiratory vaccines.\n\nChildhood vaccines:\nThe age distribution is heavily concentrated among younger individuals, with most recipients under 25 years. The violin shape is widest near the lower ages, tapering quickly, which indicates that childhood vaccines are rarely given to older individuals.\nRespiratory vaccines:\nThe distribution leans toward older age groups, with the median age higher than in other categories. The violin is widest in the 40‚Äì70 age range, suggesting respiratory vaccines are more commonly administered to older adults.\n\n\n\nOther vaccines:\nThis group shows a broader age range. The shape suggests two areas of concentration: one among younger children and another around age 60‚Äì70, indicating this group includes vaccine types used across diverse age groups.\nOverall, this combined plot provides both statistical summaries (via boxplot) and full distribution shapes (via violin plot), helping to clearly distinguish the age-related usage patterns across vaccine types.\n\n\nvacc_1524 %&gt;%\n  ggplot(aes(x = vacc_group3, y = age, fill = vacc_group3)) +\n  geom_violin(alpha = 0.4, color = NA) +\n  geom_boxplot(width = 0.2, outlier.shape = NA) +\n  labs(title = \"Boxplot with Violin Overlay\", x = NULL, y = \"Age\") +\n  theme_minimal() +\n  theme(legend.position = \"none\")\n\n\n\n\n\n\n\n\nNotched Boxplot ‚Äì Median Comparison\nNotches allow a rough comparison of medians across groups. Non-overlapping notches suggest a significant difference.\nThe plot below presents a notched boxplot showing the age distribution for each vaccine group‚ÄîChildhood vaccines, Other vaccines, and Respiratory vaccines.\n\nThe notches around the medians provide a visual guide for comparing the central values (medians) across groups. If the notches do not overlap, it suggests that the medians are likely different in a statistically meaningful way.\n\nKey insights:\n\nChildhood vaccines show a younger age distribution, with a median age around 10 years and a narrow spread. Outliers indicate a few older individuals also received these vaccines.\nRespiratory vaccines are mainly administered to older age groups, with the highest median age among the three categories.\nOther vaccines span a wider range of ages, but the median remains lower than that of respiratory vaccines.\n\nMedian Comparison:\n\nThe non-overlapping notches between childhood and respiratory vaccines suggest a clear difference in median ages.\nThe other vaccines group overlaps slightly with both, indicating a more mixed age distribution and less pronounced difference.\n\n\nvacc_1524 %&gt;%\n  ggplot(aes(x = vacc_group3, y = age, fill = vacc_group3)) +\n  geom_boxplot(notch = TRUE) +\n  labs(title = \"Notched Boxplot: Vaccine Group vs Age\", x = \"Group\", y = \"Age\") +\n  theme_minimal() +\n  theme(legend.position = \"none\")\n\nNotch went outside hinges\n‚Ñπ Do you want `notch = FALSE`?\n\n\n\n\n\n\n\n\n\nFaceted Boxplot by Gender\nBreaks down the age distribution by vaccine group and gender to compare across subgroups.\nThe plot below shows boxplots of age distribution by vaccine group (Childhood, Respiratory, and Other vaccines), separated into two panels by gender (Female and Male).\nKey Observations:\n\nChildhood vaccines:\n\n-    Age distributions are similar for both females and males, with most recipients being under 25 years.\n\n-    A few older outliers are present, especially among females, but the bulk of vaccine recipients are children and adolescents.\n\nRespiratory vaccines:\n\n-    This group shows a wide age range in both genders, with median ages around 40‚Äì45 years.\n\n-    The distribution is slightly more spread out among males, but the overall trend remains consistent across genders.\n\nOther vaccines:\n\n-    A notable gender difference is visible here:\n\n    -   Among **females**, recipients span a broad age range, including many older adults.\n\n    -    Among **males**, the age distribution is narrower and skewed toward younger adults.\nSummary:\nThis faceted view helps highlight how age patterns differ by both vaccine group and gender. While childhood and respiratory vaccine distributions are generally similar across genders, the ‚ÄúOther‚Äù vaccine group shows more variation, possibly reflecting differences in vaccine eligibility, access, or health needs.\n\nvacc_1524 %&gt;%\n  ggplot(aes(x = vacc_group3, y = age, fill = vacc_group3)) +\n  geom_boxplot() +\n  facet_wrap(~ gender) +\n  labs(title = \"Age by Vaccine Group, Faceted by Gender\", x = NULL, y = \"Age\") +\n  theme_minimal() +\n  theme(legend.position = \"none\")\n\n\n\n\n\n\n\n\nOrdered Boxplot ‚Äì by Median Age\nReorders vaccine groups by median age to emphasize differences in distribution centrality.\nThe plot below shows age distributions by vaccine group, with the groups reordered by median age to highlight differences in central tendency.\nKey Observations:\n\nChildhood vaccines have the lowest median age, with most recipients being under 20 years. A small number of older individuals appear as outliers.\nOther vaccines show a moderate median age, but with a wide spread across age groups‚Äîranging from infants to older adults. This suggests these vaccines are used in more varied contexts.\nRespiratory vaccines have the highest median age, with recipients typically ranging from their 30s to older adulthood, reflecting their common use among older populations.\n\nConclusion:\nBy ordering the boxplots by median age, this visual emphasizes the different age profiles targeted by each vaccine group. This approach helps communicate age-related trends in vaccine administration more clearly .\n\nvacc_1524 %&gt;%\n  mutate(vacc_group3 = fct_reorder(vacc_group3, age, median, na.rm = TRUE)) %&gt;%\n  ggplot(aes(x = vacc_group3, y = age, fill = vacc_group3)) +\n  geom_boxplot() +\n  labs(title = \"Boxplot Ordered by Median Age\", x = NULL, y = \"Age\") +\n  theme_minimal() +\n  theme(legend.position = \"none\")\n\n\n\n\n\n\n\n\nArea Plot ‚Äì Monthly Vaccination Trends Over Years\nUses an area chart to show monthly vaccination volumes over multiple years, stacked by year.\nThe area chart below displays monthly vaccination counts over multiple years (2015‚Äì2024), helping visualize seasonal and annual trends in vaccine uptake.\nKey Observations:\n\n2020 stands out with the highest overall vaccination counts, especially between April and June, likely reflecting a surge due to public health responses such as the COVID-19 pandemic.\nIn other years, vaccination numbers are more evenly distributed, with moderate peaks around March‚ÄìApril or August‚ÄìSeptember, possibly aligning with seasonal vaccination programs (e.g., flu campaigns).\n2023 and 2024 show a relatively steady pattern throughout the year, with less fluctuation month-to-month.\nEarlier years (2015‚Äì2017) have lower and more variable volumes compared to recent years.\n\nConclusion:\nThis chart highlights both seasonal vaccination patterns and the impact of specific public health events, such as the elevated activity in 2020. Monitoring these trends over time supports planning for future vaccination campaigns and resource allocation.\n\nvacc_1524 %&gt;%\n  count(vacc_year, vacc_month_name) %&gt;%\n  ggplot(aes(x = vacc_month_name, y = n, group = vacc_year, fill = factor(vacc_year))) +\n  geom_area(alpha = 0.7, position = \"identity\") +\n  labs(title = \"Monthly Vaccination Trends by Year\",\n       x = \"Month\", y = \"Number of Vaccinations\", fill = \"Year\") +\n  theme_minimal()\n\n\n\n\n\n\n\n\nFaceted Plot ‚Äì Proportional Vaccination Trends by Group and Race\nDisplays how the proportion of vaccinations among different races changed across years, separately for each vaccine group.\nThe faceted line plot below shows how the proportion of vaccinations among different racial groups has changed over time (2015‚Äì2024), presented separately for each vaccine group: Childhood, Respiratory, and Other.\nKey Observations:\n\nChildhood vaccines:\n\n-   Proportions vary notably year to year, especially for **Asian**, **Black**, and **Native** groups.\n\n-   The **\"Other\"** and **White** groups show a more consistent presence but with modest fluctuations.\n\n-    Some groups (e.g., Native) show a steady rise in recent years.\n\n**Respiratory vaccines**:\n\n-    Several racial groups (notably **Native**, **Black**, and **Other**) show periods of very high proportions, including years where proportions reached **100%**, likely due to small subgroup sample sizes or data dominance.\n\n-    The **White** and **Asian** groups tend to remain stable, though proportions fluctuate in certain years (e.g., 2020‚Äì2022).\n\nOther vaccines:\n\n-   Representation is generally lower and more variable across all racial groups.\n\n-    The **White** group maintains a small but steady share throughout most years.\n\n**Interpretation:**\nThis faceted view enables comparisons within and between vaccine types, highlighting potential shifts in vaccine access, uptake, or data coverage by racial group over time. It also suggests where disparities or changes in focus may have occurred, helping to inform more equitable vaccination strategies.\n\n# Prepare data: floor year, count by group, compute proportions within each group\n\n# Clean and count total per race/year (for denominator)\ntotal_by_race_year &lt;- vacc_1524 %&gt;%\n  mutate(\n    age = as.integer(round(age)),\n    vacc_year = as.integer(floor(vacc_year)),\n    race = str_to_title(as.character(race))\n  ) %&gt;%\n  count(vacc_year, race, name = \"total_race_year\")\n\n#  Count per vaccine group (for numerator), then join\nvacc_plot_data &lt;- vacc_1524 %&gt;%\n  mutate(\n    age = as.integer(round(age)),\n    vacc_year = as.integer(floor(vacc_year)),\n    race = str_to_title(as.character(race))\n  ) %&gt;%\n  count(vacc_year, race, vacc_group3, name = \"n\") %&gt;%\n  left_join(total_by_race_year, by = c(\"vacc_year\", \"race\")) %&gt;%\n  mutate(prop = n / total_race_year)\n\n# Plot proportion by race within group\nggplot(vacc_plot_data, aes(x = vacc_year, y = prop, color = race)) +\n  geom_line(size = 1) +\n  facet_wrap(~ vacc_group3) +\n  scale_y_continuous(labels = percent_format()) +\n  scale_x_continuous(breaks = pretty(unique(vacc_plot_data$vacc_year))) +\n  labs(\n    title = \"Proportion of Race Within Vaccine Groups by Year\",\n    x = \"Year\", y = \"Proportion\", color = \"Race\"\n  ) +\n  theme_minimal() +\n  theme(axis.text.x = element_text(angle = 45, hjust = 1))\n\n\n\n\n\n\n\nrm(vacc_plot_data, total_by_race_year)\n\nStatistical Overlay ‚Äì Regression Line on Vaccination Age\nAdds a linear regression to examine the relationship between income and age at vaccination.\nThe scatterplot below visualizes the relationship between income (horizontal axis) and age at vaccination (vertical axis), with a linear regression line and confidence band overlaid to summarize the trend.\nKey Observations:\n\nThe fitted regression line shows a slight negative slope, suggesting that as income increases, the age at which individuals receive vaccination tends to decrease modestly.\nThe confidence band (shaded region) around the line is relatively narrow, indicating a fair level of certainty in the trend across the central range of income.\nThe majority of data points are concentrated in the lower income ranges, while higher income values are more sparsely populated and show greater variability.\n\n**Interpretation:**\nThis trend suggests a possible inverse relationship between income and vaccination age‚Äîindividuals with higher income may be more likely to receive vaccines at younger ages. This could reflect differences in healthcare access, awareness, or proactive health behaviors associated with income level.\n\nvacc_1524 %&gt;%\n  ggplot(aes(x = income, y = age)) +\n  geom_point(alpha = 0.3, color = \"gray50\") +\n  geom_smooth(method = \"lm\", se = TRUE, color = \"blue\") +\n  labs(\n    title = \"Association Between Income and Age at Vaccination\",\n    x = \"Income\", y = \"Age\"\n  ) +\n  theme_minimal()\n\n`geom_smooth()` using formula = 'y ~ x'\n\n\n\n\n\n\n\n\n\nRegression Plot ‚Äì Age vs Income by Vaccine Group (Log Scale)\nAdds linear regression and facets by vaccine group. The x-axis is log-scaled to handle skewed income data.\nThe plot below shows scatterplots with linear regression lines, examining the relationship between income and age at vaccination. The plots are faceted by vaccine group: Childhood, Other, and Respiratory. The x-axis uses a logarithmic scale to better handle the skewed distribution of income.\nKey Observations:\n\nChildhood vaccines:\n\n-    A **slight negative trend** is observed, indicating that as income increases, age at vaccination tends to decrease slightly.\n\n-    This may reflect earlier or more timely vaccinations among higher-income individuals for childhood vaccines.\n\nOther vaccines:\n\n-   The regression line is nearly flat with a wide confidence interval, suggesting **no strong or consistent relationship** between income and age at vaccination in this group.\n\n-    This likely reflects diverse vaccine purposes and use across a broad age and income range.\n\nRespiratory vaccines:\n\n-   A **mild negative trend** is also seen here, where higher-income individuals may receive respiratory vaccines at slightly younger ages.\n\n-    However, the relationship is subtle and the confidence interval overlaps considerably with the regression line.\n\n**Interpretation:**\nWhile the strength of association varies across groups, both the childhood and respiratory vaccine panels suggest a small trend where higher income is associated with younger age at vaccination. This may be related to differences in access, preventive health behaviors, or healthcare utilization by income level.\n\nvacc_1524 %&gt;%\n  mutate(vacc_group3 = str_to_title(vacc_group3)) %&gt;%\n  ggplot(aes(x = income, y = age)) +\n  geom_point(alpha = 0.3, color = \"gray50\") +\n  geom_smooth(method = \"lm\", se = TRUE, color = \"blue\") +\n  scale_x_log10(labels = scales::comma_format()) +\n  facet_wrap(~ vacc_group3) +\n  labs(\n    title = \"Association Between Income and Age at Vaccination\",\n    x = \"Income (log scale)\", y = \"Age\"\n  ) +\n  theme_minimal()\n\n`geom_smooth()` using formula = 'y ~ x'\n\n\n\n\n\n\n\n\n\nECDF ‚Äì Age at Vaccination\nThe empirical cumulative distribution function (ECDF) shows the proportion of individuals vaccinated at or below each age. This helps visualize the age distribution in a cumulative way.\nThe plot below presents shows the cumulative proportion of individuals who received a vaccination at or below each age.\nKey Observations:\n\nThe curve rises steeply in the early age range, indicating that a large proportion of individuals were vaccinated at younger ages (e.g., before 30).\nBy around age 50, approximately 80% of individuals had been vaccinated.\nThe curve flattens out after age 75, suggesting fewer vaccinations occur at older ages.\n\nInterpretation:\nThe ECDF provides an intuitive way to understand the distribution of vaccination ages. It highlights that most vaccinations occur in childhood and early adulthood, with fewer individuals vaccinated later in life. This cumulative view complements histograms and boxplots by showing the proportion of individuals affected up to each age.\n\nvacc_1524 &lt;- vacc_1524 %&gt;% filter(income &gt; 0, !is.na(age))\n\nvacc_1524 %&gt;%\n  ggplot(aes(x = age)) +\n  stat_ecdf(geom = \"step\", color = \"steelblue\") +\n  labs(title = \"ECDF of Age at Vaccination\", x = \"Age\", y = \"Cumulative Proportion\") +\n  theme_minimal()\n\n\n\n\n\n\n\n\nTreemap ‚Äì Vaccination by Race and Vaccine Group\nThis treemap visualizes the distribution of vaccinations by race and vaccine group. Larger areas indicate more individuals within each combination.\nThe treemap below displays the distribution of vaccinations across racial groups, further categorized by vaccine group (Childhood, Respiratory, and Other). Each rectangle represents a combination of race and vaccine type, with area size corresponding to the number of individuals vaccinated.\nKey Observations:\n\nThe White population accounts for the largest share overall, with:\n\n-    **788 individuals (50.7%)** in the **Respiratory** vaccine group.\n\n-    **404 individuals (26.0%)** in the **Childhood** vaccine group.\n\n-    **114 individuals (7.3%)** in the **Other** vaccine group.\n\nOther racial groups have smaller shares:\n\n-    **Black** individuals make up a modest proportion across groups, particularly **4.5%** in the Respiratory group and **1.4%** in Childhood vaccines.\n\n-    **Asian** individuals represent **4.4%** of Respiratory vaccines and **2.1%** of Childhood vaccines.\n\n-    **Native** and **Other** groups have minimal representation overall.\n\n**Interpretation:**\nThis treemap visually emphasizes the dominant contribution of the White population across all vaccine types, especially for respiratory vaccines. It also illustrates disparities in representation among racial groups, which can be important for assessing equity in vaccine access, uptake, and program targeting.\n\n# Cross-platform ‚Äúnew device‚Äù:\ndev.new(width = 8, height = 6)  \n\np &lt;- vacc_1524 %&gt;%\n  count(race, vacc_group3) %&gt;%\n  mutate(race = str_to_title(race)) %&gt;%\n  ggplot(aes(area = n, fill = vacc_group3, label = race)) +\n  geom_treemap() +\n  geom_treemap_text(colour = \"white\", place = \"centre\", grow = TRUE) +\n  labs(\n    title = \"Treemap: Vaccination by Race and Vaccine Group\",\n    fill  = \"Vaccine Group\"\n  ) +\n  theme_minimal()\n\nprint(p)\n\nrm (p)\n\n\n#  Treemap - with Labels Showing Counts and Proportions by Race and vaccine Group\nvacc_1524 %&gt;%\n  count(race, vacc_group3) %&gt;%\n  mutate(\n    race = str_to_title(race),\n    total = sum(n),\n    proportion = n / total,\n    label_text = paste0(race, \"\\n\", n, \" (\", percent(proportion, accuracy = 0.1), \")\")\n  ) %&gt;%\n  ggplot(aes(area = n, fill = vacc_group3, label = label_text)) +\n  geom_treemap() +\n  geom_treemap_text(colour = \"white\", place = \"centre\", grow = TRUE, reflow = TRUE) +\n  labs(\n    title = \"Treemap: Vaccination by Race and Vaccine Group\",\n    fill = \"Vaccine Group\"\n  ) +\n  theme_minimal()\n\n\n\n\n\n\n\n\nCorrelation Heatmap ‚Äì Numeric Variables\nThis heatmap displays Pearson correlation coefficients between selected numeric variables. Strong positive or negative values help identify relationships worth further analysis.\nThe heatmap below displays Pearson correlation coefficients between selected numeric variables: age, income, healthcare expenses, and healthcare coverage. Correlation values range from -1 to 1, where values closer to ¬±1 indicate stronger relationships.\nKey Observations:\n\nAge and healthcare coverage show a strong positive correlation (0.65), suggesting that as individuals age, they are more likely to have greater healthcare coverage.\nAge and healthcare expenses are also positively correlated (0.66), indicating that older individuals tend to incur higher healthcare costs.\nHealthcare coverage and healthcare expenses show a moderate positive correlation (0.44), which may reflect that those with more coverage also utilize healthcare services more frequently or thoroughly.\nIncome is not strongly correlated with any other variable in this set, with the highest being a negligible 0.02 with healthcare coverage and a slightly negative value with age (-0.04) and expenses (-0.05).\n\n**Interpretation:**\nThis heatmap highlights potential relationships that may inform further analysis‚Äîespecially the connections between age, coverage, and expenses. In contrast, income appears relatively independent of the other variables in this dataset.\n\nnumeric_vars &lt;- vacc_1524 %&gt;%\n  select(age, income, healthcare_expenses, healthcare_coverage) %&gt;%\n  na.omit()\n\ncor_matrix &lt;- round(cor(numeric_vars), 2)\n\nas.data.frame(as.table(cor_matrix)) %&gt;%\n  rename(Var1 = Var1, Var2 = Var2, Correlation = Freq) %&gt;%\n  ggplot(aes(x = Var1, y = Var2, fill = Correlation)) +\n  geom_tile(color = \"white\") +\n  geom_text(aes(label = Correlation), color = \"black\") +\n  scale_fill_gradient2(low = \"red\", high = \"blue\", mid = \"white\", midpoint = 0) +\n  labs(title = \"Correlation Heatmap of Numeric Variables\", x = NULL, y = NULL) +\n  theme_minimal()\n\n\n\n\n\n\n\n\nRidgeline Plot ‚Äì Age by Vaccine Group\nThis ridgeline plot shows the age distribution for each vaccine group. It highlights where age densities differ across categories.\nThe ridgeline plot below shows age distributions for three vaccine groups: Childhood, Other, and Respiratory. Each layer represents the density of ages within a vaccine category, allowing for visual comparison of where individuals are most commonly vaccinated within each group.\nKey Observations:\n\nChildhood vaccines show a clear peak at very young ages, as expected. The density drops rapidly as age increases, with a small secondary bump around middle age, possibly reflecting catch-up vaccinations or data irregularities.\nOther vaccines have a bimodal distribution with one peak in younger adults and another in older adults (around 70+ years), suggesting they are used across multiple life stages.\nRespiratory vaccines have a broad distribution, with a peak density around 60‚Äì70 years, consistent with routine respiratory vaccinations for older adults (e.g., influenza or pneumococcal vaccines).\n\n**Interpretation:**\nThis visualization effectively highlights differences in age targeting across vaccine groups. It shows that:\n\nChildhood vaccines are concentrated in early life,\nOther vaccines are used more broadly across age ranges, and\nRespiratory vaccines are predominantly administered to older populations.\n\n\nvacc_1524 %&gt;%\n  mutate(vacc_group3 = stringr::str_to_title(vacc_group3)) %&gt;%\n  ggplot(aes(x = age, y = vacc_group3, fill = vacc_group3)) +\n  geom_density_ridges(scale = 1.5, alpha = 0.6, color = \"white\") +\n  labs(title = \"Ridgeline Plot: Age Distribution by Vaccine Group\", x = \"Age\", y = \"Vaccine Group\") +\n  theme_minimal() +\n  theme(legend.position = \"none\")\n\nPicking joint bandwidth of 5.93\n\n\n\n\n\n\n\n\n\nInteractive Plot ‚Äì Income vs Age by Race\nThis interactive scatter plot shows the relationship between income and age, colored by race. Hovering reveals more details including group and income.\n\np &lt;- vacc_1524 %&gt;%\n  mutate(race = stringr::str_to_title(race)) %&gt;%\n  ggplot(aes(x = income, y = age, color = race,\n             text = paste(\"Race:\", race,\n                          \"&lt;br&gt;Group:\", vacc_group3,\n                          \"&lt;br&gt;Income:\", income,\n                          \"&lt;br&gt;Age:\", age))) +\n  geom_point(alpha = 0.6) +\n  geom_smooth(method = \"loess\", se = FALSE, color = \"gray30\") +\n  labs(title = \"Interactive: Income vs Age by Race\",\n       x = \"Income\", y = \"Age\", color = \"Race\") +\n  theme_minimal() +\n  theme(legend.position = \"bottom\")\n\nggplotly(p, tooltip = \"text\")\n\n`geom_smooth()` using formula = 'y ~ x'\n\n\n\n\n\nrm(p)\n\nAnimation ‚Äì Vaccination Trends Over Years\nThis animation shows how vaccination counts across vaccine groups change over time. It helps spot temporal trends and emerging patterns.\n\nanim_plot &lt;- vacc_1524 %&gt;%\n  mutate(vacc_year = as.integer(floor(vacc_year))) %&gt;%\n  count(vacc_year, vacc_group3) %&gt;%\n  ggplot(aes(x = vacc_group3, y = n, fill = vacc_group3)) +\n  geom_col(show.legend = FALSE) +\n  labs(title = 'Year: {frame_time}', x = 'Vaccine Group', y = 'Count') +\n  theme_minimal() +\n  transition_time(vacc_year) +\n  ease_aes('linear')\n\nanim_file &lt;- tempfile(fileext = \".gif\")\nanim &lt;- animate(anim_plot, nframes = 100, fps = 10, renderer = gifski_renderer(anim_file))\nprint(anim)\n\nrm(anim_plot, anim_file, anim)\n\nAnimation ‚Äì Breast Cancer Screening Uptake by State\nThis animated bar chart shows breast cancer screening uptake over time for each Australian state. It uses faceting to compare regional trends.\n\nbreast_anim &lt;- breast_cancer_data %&gt;%\n  filter(!state %in% c(\"Other\", \"Unknown\")) %&gt;%\n  mutate(year_4digit = as.integer(year_4digit)) %&gt;%\n  group_by(state, year_4digit) %&gt;%\n  summarise(total_screened = sum(part50_74, na.rm = TRUE), .groups = \"drop\") %&gt;%\n  ggplot(aes(x = year_4digit, y = total_screened, fill = state)) +\n  geom_col(show.legend = FALSE) +\n  facet_wrap(~ state) +\n  labs(title = 'Year: {frame_time}', x = 'Year', y = 'Women Screened (50‚Äì74 yrs)') +\n  theme_minimal() +\n  transition_time(year_4digit) +\n  ease_aes('linear')\n\nscreening_gif &lt;- tempfile(fileext = \".gif\")\nanim_screen &lt;- animate(breast_anim, nframes = 100, fps = 10, renderer = gifski_renderer(screening_gif))\nprint(anim_screen)\n\nrm(breast_anim, screening_gif, anim_screen)\n\n\n\n\nHeatmap ‚Äì Number of Vaccinations by Month and Weekday Highlights vaccination activity patterns by day of week and month. Darker tiles represent higher counts.\nThe heatmap below demonstrates the number of vaccinations administered across each day of the week and each calendar month. Color intensity indicates the relative number of vaccinations, with darker red representing higher uptake and pale yellow representing lower activity.\nKey Observations:\n\nSaturday consistently shows high uptake, particularly in October, September, and July, suggesting that weekends may be more accessible or preferred for vaccination appointments.\nTuesday in May and Wednesday in August also show pronounced peaks, likely linked to specific campaign efforts or seasonal programs.\nThursday and Friday generally have moderate activity, while Sunday and Monday tend to have lower vaccination counts across most months.\nOverall, the summer and early fall months (July to October) show increased uptake across several weekdays, possibly aligning with back-to-school vaccination drives or respiratory vaccine rollouts.\n\n**Interpretation:**\nThe plot reveals both seasonal and weekly rhythms in vaccination behavior. Recognizing these patterns can guide better scheduling of clinics, resource planning, and public messaging to align with high-demand periods and improve overall vaccine accessibility.\n\n# ................Without  Adding the long Title ........................................................\n# ..............................................................................................\n\n# --- Order weekday and month factors for proper axis display ---\n# --- Convert original vaccination date to Eastern Time (Massachusetts local time) ---\n# Assumes vacc_date is POSIXct or character in UTC or local system time\nvacc_1524 &lt;- vacc_1524 %&gt;%\n  mutate(\n    vacc_datetime_et = with_tz(as.POSIXct(vacc_date, tz = \"UTC\"), tzone = \"America/New_York\"),  # Adjust timezone to Eastern Time\n    vacc_weekday = wday(vacc_datetime_et, label = TRUE, abbr = FALSE),                          # Extract weekday (e.g., Monday)\n    vacc_month_name = month(vacc_datetime_et, label = TRUE, abbr = FALSE)                       # Extract month (e.g., January)\n  )\n\n# --- Order weekday and month factors for proper axis display ---\nvacc_1524 &lt;- vacc_1524 %&gt;%\n  mutate(\n    vacc_month_name = factor(vacc_month_name, levels = month.name),  # Ensure months are in calendar order\n    vacc_weekday = factor(vacc_weekday, levels = c(\"Monday\", \"Tuesday\", \"Wednesday\", \"Thursday\", \"Friday\", \"Saturday\", \"Sunday\"))  # Ensure weekdays are in logical order\n  )\n\n# --- Create heatmap of vaccination counts by weekday and month ---\nvacc_1524 %&gt;%\n  count(vacc_weekday, vacc_month_name) %&gt;%  # Count number of vaccinations by weekday and month\n  ggplot(aes(x = vacc_weekday, y = vacc_month_name, fill = n)) +     # Map weekday to x-axis, month to y-axis, and fill by count\n  geom_tile(color = \"white\") +                                       # Draw heatmap tiles with white border for readability\n  scale_fill_gradientn(                                              # Use custom yellow-to-red color scale\n    colors = c(\"#ffffcc\", \"#ffeda0\", \"#feb24c\", \"#f03b20\", \"#bd0026\"),\n    breaks = scales::pretty_breaks(n = 5),                           # Auto-select 5 good breakpoints for legend\n    name = \"Vaccinated Number\"                                       # Legend title\n  ) +\n  labs(\n    title = \"Vaccination Uptake by Weekday and Month\",               # Plot title\n    subtitle = \"Timestamps interpreted as US Eastern Time (Massachusetts)\",  # Timezone context\n    x = \"Weekday\", y = \"Month\", fill = \"Vaccinated Number\",          # Axis and legend labels\n    caption = \"Note: Original timestamps converted from UTC to America/New_York\"\n  ) +\n  theme_minimal() +\n  theme(\n    text = element_text(family = \"Times New Roman\"),                 # Font style\n    legend.position = \"bottom\",                                      # Move legend below the plot\n    axis.text.x = element_text(angle = 45, hjust = 1, size = 10, face = \"bold\"),  # X-axis label formatting\n    axis.text.y = element_text(size = 10, face = \"bold\"),            # Y-axis label formatting\n    axis.title.x = element_text(face = \"bold\", size = 11),\n    axis.title.y = element_text(face = \"bold\", size = 11),\n    plot.title = element_text(size = 12, face = \"bold\"),\n    legend.title = element_text(size = 10),\n    legend.text = element_text(size = 8)\n  )\n\n\n\n\n\n\n\n# Use figure title below to render in Quarto or Rmarkdown \n#\"Figure XX: Vaccination uptake by weekday and month among individuals aged 15‚Äì24, 2016‚Äì2024.\"\n\n\n# ................Adding the long Title ........................................................\n# ..............................................................................................\n\n# --- Convert original vaccination date to Eastern Time (Massachusetts local time) ---\n# Assumes vacc_date is POSIXct or character in UTC or local system time\nvacc_1524 &lt;- vacc_1524 %&gt;%\n  mutate(\n    vacc_datetime_et = with_tz(as.POSIXct(vacc_date, tz = \"UTC\"), tzone = \"America/New_York\"),  # Adjust timezone to Eastern Time\n    vacc_weekday = wday(vacc_datetime_et, label = TRUE, abbr = FALSE),                          # Extract weekday (e.g., Monday)\n    vacc_month_name = month(vacc_datetime_et, label = TRUE, abbr = FALSE)                       # Extract month (e.g., January)\n  )\n\n# --- Order weekday and month factors for proper axis display ---\nvacc_1524 &lt;- vacc_1524 %&gt;%\n  mutate(\n    vacc_month_name = factor(vacc_month_name, levels = month.name),  # Ensure months are in calendar order\n    vacc_weekday = factor(vacc_weekday, levels = c(\"Monday\", \"Tuesday\", \"Wednesday\", \"Thursday\", \"Friday\", \"Saturday\", \"Sunday\"))  # Ensure weekdays are in logical order\n  )\n\n# --- Create heatmap of vaccination counts by weekday and month ---\np &lt;- vacc_1524 %&gt;%\n  count(vacc_weekday, vacc_month_name) %&gt;%  # Count number of vaccinations by weekday and month\n  ggplot(aes(x = vacc_weekday, y = vacc_month_name, fill = n)) +     # Map weekday to x-axis, month to y-axis, and fill by count\n  geom_tile(color = \"white\") +                                       # Draw heatmap tiles with white border for readability\n  scale_fill_gradientn(                                              # Use custom yellow-to-red color scale\n    colors = c(\"#ffffcc\", \"#ffeda0\", \"#feb24c\", \"#f03b20\", \"#bd0026\"),\n    breaks = scales::pretty_breaks(n = 5),                           # Auto-select 5 good breakpoints for legend\n    name = \"Vaccinated Number\"                                       # Legend title\n  ) +\n  labs(\n    title = \"Vaccination Uptake by Weekday and Month\",               # Plot title\n    x = \"Weekday\", y = \"Month\", fill = \"Vaccinated Number\"           # Axis and legend labels\n  ) +\n  theme_minimal() +\n  theme(\n    text = element_text(family = \"Times New Roman\"),                 # Font style\n    legend.position = \"bottom\",                                      # Move legend below the plot\n    axis.text.x = element_text(angle = 45, hjust = 1, size = 10, face = \"bold\"),  # X-axis label formatting\n    axis.text.y = element_text(size = 10, face = \"bold\"),            # Y-axis label formatting\n    axis.title.x = element_text(face = \"bold\", size = 11),\n    axis.title.y = element_text(face = \"bold\", size = 11),\n    plot.title = element_text(size = 12, face = \"bold\"),\n    legend.title = element_text(size = 10),\n    legend.text = element_text(size = 8)\n  )\n\n# --- Add descriptive figure caption using patchwork's plot_annotation() ---\nfinal_plot &lt;- p + plot_annotation(\n  caption = \"Figure XX: Vaccination uptake by weekday and month among individuals aged 15‚Äì24, 2016‚Äì2024.\",\n  theme = theme(\n    plot.caption = element_text(\n      size = 10, family = \"Times New Roman\", hjust = 0\n    )\n  )\n)\n\n# --- Display the final plot with caption ---\nfinal_plot\n\n\n\n\n\n\n\n# setwd (\"C:/Users/User/Desktop/Materials_ Course and proposals/VIP collection for Syntax code or project titles/R codes/Data Manipulation and Wrangling\")\n# \n# # Save plots\n# ggsave(\"Heatmap_vaccination_pattern by day and month.TIFF\", plot = last_plot(), device = \"tiff\", width = 10, height = 6, units = \"in\")\n# ggsave(\"Heatmap_vaccination_pattern by day and month.svg\", plot = last_plot(), device = \"svg\", width = 10, height = 6, units = \"in\")\n\nrm (p, final_plot)"
  },
  {
    "objectID": "Post_Blog/Visualisations/index_original.html#part-vii-shiny-app-building-web-apps",
    "href": "Post_Blog/Visualisations/index_original.html#part-vii-shiny-app-building-web-apps",
    "title": "Date Manipulation and Wrangling using R",
    "section": "",
    "text": "8.1 UI fluidPage(), sidebarLayout(), sidebarPanel(), mainPanel(), tabsetPanel(), tags$style()\n8.2 Server reactive(), observeEvent(), req(), renderPlotly(), renderDT(), modalDialog(), showModal()\n8.3 App Launch shinyApp(ui, server)\n8.4 Inputs sliderInput(), selectInput(), colourInput(), actionButton(), downloadButton()\n8.5 Outputs plotlyOutput(), DTOutput(), datatable(), formatStyle()\n8.6 DT Features extensions = 'Buttons', export options: copy, csv, excel, pdf, print\n8.7 Styling and Themes tags$style(), (shinythemes::shinytheme() ‚Äì loaded but not applied)\nShiny is a web application framework for R that allows analysts to build interactive dashboards and tools using familiar syntax. It provides a structured approach to turning R scripts into accessible apps for broader audiences.\nA typical Shiny app includes two core components:\n\nUI (User Interface): Defines layout, inputs, and outputs shown on the screen interface.\nServer: Contains the logic that processes data and responds to user interactions.\n\nShiny apps can include multiple views (tabs), export buttons, dynamic filtering, charts, and customized design themes.\n\n\n\n\nfluidPage(): Defines the page layout.\nsidebarLayout(), sidebarPanel(), mainPanel(): Organize inputs and outputs side-by-side.\ntabsetPanel(): Allows tab navigation for multi-page apps.\ntags$style(), shinythemes::shinytheme(): Add or apply custom styles/themes.\n\n\n\n\n\n\nreactive(): Creates reactive data or expressions.\nobserveEvent(): Executes code when a trigger changes.\nreq(): Validates necessary input before proceeding.\nOutput functions: renderPlotly(), renderDT(), renderText(), renderTable().\n\n\n\n\n\n\n\n\n\n\n\n\n\nType\nFunction\nPurpose\n\n\n\n\nInput\nsliderInput()\nSelect a numeric value or range\n\n\nInput\nselectInput()\nDropdown menu to choose a category\n\n\nInput\ncolourInput()\nSelect a color\n\n\nInput\nactionButton()\nTrigger processing on click\n\n\nInput\ndownloadButton()\nDownload output tables or data\n\n\nOutput\nplotlyOutput()\nRender interactive plots using Plotly\n\n\nOutput\nDTOutput(), datatable()\nRender interactive tables\n\n\nOutput\nformatStyle()\nApply styling (e.g., color, font) to tables\n\n\n\n\n\n\n\n\nAdd extensions = 'Buttons' to enable table exports.\nExport types: \"copy\", \"csv\", \"excel\", \"pdf\", \"print\".\n\n\n\n\n\n\nshinyApp(ui, server): Runs the Shiny app combining both UI and server logic.\nApps can be hosted on ShinyApps.io, internal servers, or embedded in R Markdown dashboards.\n\n\nThe Shiny app code below demonstrates how interactive visualizations can be built using R to present health data in an accessible and user-friendly format. Specifically, it explores breast cancer screening uptake across states, years, and age groups in Australia. The app enhances user engagement through customizable features and immediate feedback mechanisms.\nKey capabilities demonstrated include: - Dynamic UI generation using fluidPage(), sidebarLayout(), and interactive widgets - State selection using a dropdown (selectInput()), which scales better than radio buttons - Age group filtering with a multiple selection input - Quantile-based filtering with sliderInput() for rate grouping - Color customization of output using colourInput() for personalizing table aesthetics - A modal popup (modalDialog()) triggered by a help button to explain data sources - Export options via downloadButton() and DT export buttons for multiple file formats - Real-time data filtering using reactive() expressions to tailor output to user input - An interactive line plot rendered via plotly and ggplot2 for visualization - Fully styled, downloadable data table with DT::renderDT() and export capabilities\nSee the live app at the following platforms\n\nAnalyticsHub YouTube: https://studio.youtube.com/video/5V7SPBH-8BE/edit\nLive App: https://j9eu4e-habtamu-mellie0bizuayehu.shinyapps.io/Breast_Cancer_Screening_Shiny_App/\n\n\n# Install required packages if not already installed\nrequired_packages &lt;- c(\"shiny\", \"ggplot2\", \"plotly\", \"DT\", \"dplyr\", \"shinyjs\", \"shinyWidgets\", \"scales\", \"colourpicker\")\n\n# Install missing ones\nnew_packages &lt;- required_packages[!(required_packages %in% installed.packages()[,\"Package\"])]\nif(length(new_packages)) install.packages(new_packages)\n\n# Load packages\nlibrary(shiny)\nlibrary(ggplot2)\nlibrary(plotly)\nlibrary(DT)\nlibrary(dplyr)\nlibrary(shinyjs)\nlibrary(shinyWidgets)\nlibrary(scales)\nlibrary(colourpicker)\n\n\n# load the data\nload(\"C:/Users/User/Desktop/Materials_ Course and proposals/VIP collection for Syntax code or project titles/R codes/Shiny App BC Screening/Breast Cancer Screening.RData\")\n\n\n# -------------------Shiny Application for Breast Cancer Screening---------------------\n\n\n# ------------------- UI and Server Definition ---------------------\n\n# Define custom CSS for styling buttons and other UI elements\nui &lt;- fluidPage(\n  \n  # Application title displayed at the top of the app\n  h1(\"Breast Cancer Screening Uptake\"),\n\n  # Apply custom styling to the download button\n  tags$style(HTML(\"\n    #download_data {\n      background: orange;\n      font-size: 20px;\n    }\n  \")),  \n\n  # Layout structure: sidebar for inputs and main panel for outputs\n  sidebarLayout(\n    sidebarPanel(\n      \n      # Quantile-based slider to filter screening rate\n      sliderInput(\"rate_10_group\", \"Rate Group\", \n                  min = min(breast_cancer_long$rate_10_group, na.rm = TRUE), \n                  max = max(breast_cancer_long$rate_10_group, na.rm = TRUE), \n                  value = c(5, 7)),\n      \n      # Dropdown menu for state selection (simplifies and scales better than radio buttons)\n      selectInput(\"state\", \"Select State\",  \n                  choices = unique(breast_cancer_long$state), \n                  selected = \"WA\"),\n\n      # Multi-select dropdown for age groups (allows viewing multiple demographics)\n      selectInput(\"age_group\", \"Women's Age Group\", \n                  choices = unique(breast_cancer_long$age_group), \n                  multiple = TRUE,\n                  selected = unique(breast_cancer_long$age_group)[1]),\n\n      # Add colour input to allow users to control table font colour\n      colourInput(\"color\", \"Point color\", value = \"blue\"),\n\n      # Add a help button that triggers a modal popup for guidance\n      actionButton(\"show_help\", \"Help\"),\n\n      # Add a download button for exporting filtered dataset\n      downloadButton(\"download_data\", \"Download Data\")\n    ),\n\n    mainPanel(\n      # Render the interactive line chart\n      plotlyOutput(\"plot\"),\n\n      # Render the data table output\n      DTOutput(\"table\")\n    )\n  )\n)\n\n# Define server-side logic for rendering outputs and interactivity\nserver &lt;- function(input, output, session) {\n\n  # Show Help Modal: explains data source when help button is clicked\n  observeEvent(input$show_help, {\n    showModal(modalDialog(\n      title = \"Help\",\n      \"This data was compiled from the Australian Institute of Health and Welfare.\"\n    ))\n  })\n\n  # Reactive expression to filter and summarize the dataset based on inputs\n  filtered_data &lt;- reactive({\n    req(input$rate_10_group, input$state, input$age_group)  # Ensure all inputs are available\n\n    breast_cancer_long %&gt;%\n      filter(rate_10_group &gt;= input$rate_10_group[1] & \n               rate_10_group &lt;= input$rate_10_group[2],\n             state == input$state,\n             age_group %in% input$age_group) %&gt;%\n      group_by(year, state, age_group) %&gt;%\n      summarise(year = as.integer(year),  # Convert year to integer for plotting\n                rate = round(mean(rate, na.rm = TRUE), 1),  # Average screening rate\n                .groups = \"drop\") \n  })\n\n  # Render Table: displays filtered data in an interactive table with export options\n  output$table &lt;- renderDT({\n    datatable(filtered_data(), \n              options = list(\n                pageLength = 10,  # Show 10 rows per page\n                dom = 'Bfrtip',  # Include Buttons (copy, csv, pdf, etc.)\n                buttons = c('copy', 'csv', 'excel', 'pdf', 'print'),\n                class = \"display nowrap compact\"  # Responsive and compact table design\n              ),\n              extensions = 'Buttons',\n              style = \"bootstrap\", \n              class = \"table table-striped table-bordered\") %&gt;%\n      formatStyle(columns = names(filtered_data()), color = input$color)  # Use selected color\n  })\n\n  # Download Handler: enables users to download filtered data\n  output$download_data &lt;- downloadHandler(\n    filename = \"Breast_cancer_screening_data.csv\",\n    content = function(file) {\n      write.csv(filtered_data(), file, row.names = FALSE)\n    }\n  )\n\n  # Render Plot: displays line plot of screening rates over time by age group\n  output$plot &lt;- renderPlotly({\n    df &lt;- filtered_data()\n\n    p &lt;- ggplot(df, aes(x = year, y = rate, color = age_group, group = interaction(state, age_group))) +\n      geom_line(size = 1) +  # Draw lines to show trend\n      geom_point(size = 3) +  # Add points to emphasize data values\n      labs(title = \"Breast Cancer Screening Uptake\", \n           x = \"Year\", \n           y = \"Screening Rate\",\n           color = \"Age Group\") +\n      theme_minimal()\n\n    ggplotly(p)  # Convert ggplot to interactive plotly chart\n  })\n}\n\n# Launch the app\nshinyApp(ui, server)"
  }
]