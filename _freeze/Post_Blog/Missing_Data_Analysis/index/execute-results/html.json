{
  "hash": "4fd891cbbd844f4a9e3371c0ec9eeeed",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Missing Data Management and Analysis\"\ndescription: |\n  Missing data diagnostics and imputation strategies, R and STATA. Mechanism classification (MCAR/MAR/MNAR), multiple imputation, mean Imputation and LOCF/NOCB.\nauthor: \"**Habtamu Bizuayehu**\"\nwebsite: \"https://habtamubizuayehu.com/\"\norcid: \"https://orcid.org/0000-0002-1360-4909\"\ndate: 2024-05-20\nimage: \"missing_data.png\"\nhighlight-style: github\nproject:\n  type: website\n  output-dir: docs\ncategories: [Missing Data, Data Imputation, Missing Data Identification]\nformat:\n  html:\n    toc: true\n    toc-depth: 3\n    number-sections: false\n    code-fold: false\n    code-tools: true\n    code-summary: \"Show the code\"\n    theme: united\n    self-contained: true\nexecute:\n  echo: true\n  warning: false\n  message: false\nknitr:\n  opts_chunk:\n    warning: false\n    message: false\neditor: visual\n---\n\n## **Introduction**\n\nMissing data is a common challenge in **survey, clinical, and population-based datasets**.\\\nIt can arise from participant dropout, skipped responses, changes in study design, or inconsistencies in data collection.\\\nIf not addressed appropriately, missingness can introduce **bias**, reduce **statistical power**, and undermine the reliability of results.\\\n\nI also prepared Missing Data Management and Analysis via PowerPoint: Visit the [Missing data presentation](missing_data_presentation.pdf){target=\"_blank\"}.\n\nThis work showcases two complementary **missing data management projects**, developed across different datasets and research contexts:\n\n1.  **Stata-based missing data diagnostics and imputation**\n    -   Used structured diagnostic tools to quantify and visualise missingness, and identify patterns.\\\n    -   Applied targeted imputation methods, including **Multiple Imputation (MI)**, **Last Observation Carried Forward (LOCF)**, **Next Observation Carried Backward (NOCB)**, and hybrid approaches depending on variable type and study design.\n2.  **R-based reproducible workflows for missing data**\n    -   Designed flexible pipelines for detecting, cleaning, and imputing missing values.Â \n    -   Demonstrated simple (mean/median) and advanced methods (*MICE*, model-based imputation), as well as forward/backward filling and participant-level imputation.\n\nBy combining **statistical rigour**, **methodological adaptability**, and **transparent documentation**, these approaches ensure that findings remain **robust, reproducible, and comparable** across studies, regardless of the data source.\n\n## STATA-Based Missing Data management and Analysis Project\n\nSome outputs are not presented here, as certain variables had small cell counts that could potentially compromise participant confidentiality.\\\nWhere the number of observations fell below accepted thresholds, they were withheld to remain in line with the minimum data reporting standards for sensitive datasets.\n\nThe overall and aggregated results, however, have been published and are available in the following peer-reviewed journal articles:\n\nMy work has resulted in three peer-reviewed Q1 publications:\\\n- [Preterm Birth](https://doi.org/10.1016/j.midw.2022.103334): https://doi.org/10.1016/j.midw.2022.103334\\\n- [Low Birthweight](https://doi.org/10.1093/eurpub/ckab033): https://doi.org/10.1093/eurpub/ckab033\\\n- [Caesarean Section and Labour Intervention](https://doi.org/10.1007/s43032-023-01219-7): https://doi.org/10.1007/s43032-023-01219-7\n\n------------------------------------------------------------------------\n\nIn large-scale and longitudinal data, missing data is almost inevitable. It can arise from participant attrition, skipped responses, evolving survey designs, or inconsistencies in measurement over time.\\\nIf not addressed appropriately, missingness can reduce statistical power, bias estimates, and compromise the validity of conclusions.\n\n### 1.1 Scientific Context\n\nLongitudinal studies, such as ALSWH, collect data from the same participants repeatedly over long periods. While this design allows for rich analysis of change over time, it is also prone to *loss to follow-up* and intermittent missingness.\n\nInternational best practice suggests that when missingness exceeds **5â€“10%** for a variable, imputation should be considered to improve precision and reduce bias (Rubin, 1987; Sterne et al., 2009). In this project:\\\n- *Maternal pre-pregnancy BMI* and *age at menarche* had missingness above 10%.\\\n- Missingness was often non-monotone, requiring tailored imputation strategies for different variable types.\n\n------------------------------------------------------------------------\n\n### 1.2 Diagnostic Approaches\n\nI began by systematically assessing the **extent and structure of missingness**:\n\n-   Used STATA packages `misschk`, `mdesc`, and `xtpatternvar` to quantify missing values per variable and identify patterns.\n-   Classified patterns into **monotone** (e.g., dropout) and **intermittent** (e.g., missed responses but later re-entry).\n-   Inspected missingness by **birth order** and survey wave to account for pregnancy-specific variables.\n-   Flagged variables with \\>5% missingness for potential imputation.\n\n------------------------------------------------------------------------\n\n### 1.3 Missing Data Mechanisms\n\nBefore selecting imputation methods, I classified variables according to the statistical mechanism of missingness:\n\n-   **MCAR â€“ Missing Completely at Random**: The probability of a value being missing is unrelated to either the observed or unobserved data.\n-   **MAR â€“ Missing at Random**: The probability of missingness depends only on observed data, not the missing values themselves.\n-   **MNAR â€“ Missing Not at Random**: The probability of missingness depends on the unobserved data itself.\n\n------------------------------------------------------------------------\n\n### 1.4 Criteria for Imputation\n\nA **rule of thumb** from the literature recommends initiating imputation when the missing proportion exceeds **5â€“10%** of the variableâ€™s observations. In this study:\\\n- **Maternal BMI** and **age at menarche** exceeded 10% missingness.\\\n- Time-varying health conditions (e.g., hypertension) had intermittent missingness between waves.\n\n### 1.5 Imputation Methods Applied Using STATA\n\nThis Project has been completed using ALSWH data source\n\n**a) Mean Imputation (Row Mean)**\\\n- Applied to *pre-pregnancy BMI* (\\<15% missingness).\\\n- Used the participantâ€™s own available BMI values from other waves to calculate a personalised row mean.\\\n- Observed mean: 24.46 kg/mÂ²; Imputed mean: 24.63 kg/mÂ² â€” indicating close alignment.\n\n**b) Multiple Imputation (MI)**\\\n- Applied to *age at menarche* (\\>10% missingness), a static variable recorded only once (Survey 2).\\\n- Used **Multivariate Imputation by Chained Equations (MICE)** with 20 imputations, following guidelines to reduce sampling error.\\\n- Incorporated auxiliary variables predictive of missingness.\\\n- Conducted diagnostics: density plots, distribution overlays, and observed vs. imputed comparison.\n\n**c) Last Observation Carried Forward (LOCF)**\\\n- Used for chronic conditions (e.g., hypertension, diabetes) that persist after diagnosis.\\\n- Ensured stability in prevalence estimates over time.\n\n**d) Next Observation Carried Backward (NOCB)**\\\n- Applied to lifetime exposure variables (e.g., partner violence). If reported in later waves, status was carried backward.\n\n**e) Combined LOCF + NOCB**\\\n- Applied to variables requiring lifetime ascertainment, maximising completeness in both time directions; for example, country of birth.\n\n------------------------------------------------------------------------\n\n### 1.6 Sensitivity Analyses\n\nTo ensure the robustness of results: - Conducted **complete-case analysis** alongside imputed datasets. - Compared distributions of observed vs. imputed data to detect anomalies. - Re-estimated models with alternative imputation strategies to check stability of effect estimates.\n\n------------------------------------------------------------------------\n\n**Table: Summary of Missing Data Handling Techniques**\n\n| Variable Type | Example Variable | Method Applied | Rationale |\n|------------------|------------------|------------------|-------------------|\n| **Static, continuous** | Age at menarche | Multiple Imputation (20 datasets, chained equations) | Single-time measurement; high missingness; categorical imputation adjusted for predictors |\n| **Time-varying, continuous** | BMI prior to birth | Row mean imputation using available values from same participant | Preserves within-person trajectory; missing at intermittent waves |\n| **Chronic binary condition** | Hypertension, diabetes | Last Observation Carried Forward (LOCF) | Lifetime conditions assumed persistent once reported |\n| **Lifetime event binary** | Ever violated by partner | LOCF + Next Observation Carried Backward (NOCB) | Ensures capture of lifetime exposure regardless of reporting wave |\n\n------------------------------------------------------------------------\n\n**In summary**, the combination of diagnostic mapping, mechanism classification, tailored imputation, and sensitivity analyses allowed me to address missingness in a scientifically sound manner, maximising the analytic value of this 20-year longitudinal dataset.\n\n------------------------------------------------------------------------\n\n> **Final Reflection:**\\\n> I have had the privilege of contributing to one of Australiaâ€™s most significant longitudinal studies, producing results that are both methodologically robust and policy-relevant.\\\n> The lessons I have gained â€” about rigour, adaptability, and the potential of data to drive meaningful change â€” will remain central to my work and collaborations. I will apply these skills in future projects that connects advanced analytics with real-world health outcomes, both in Australia and internationally.\n\n**If you are interested in exploring each paper in greater depth, including the methods applied, please read the links below**. I hope you find them insightful.\n\n-   [Preterm Birth](https://doi.org/10.1016/j.midw.2022.103334): https://doi.org/10.1016/j.midw.2022.103334\\\n-   [Low Birthweight](https://doi.org/10.1093/eurpub/ckab033): https://doi.org/10.1093/eurpub/ckab033\\\n-   [Caesarean Section and Labour Intervention](https://doi.org/10.1007/s43032-023-01219-7): https://doi.org/10.1007/s43032-023-01219-7\n\n## R-Based Missing Data management and Analysis Project\n\n### **Missing Value Identification and Imputations**\n\n**A. Identifying Missing Values**\n\n-   is.na(), anyNA(), sum(is.na(x)), colSums() â€“ detect/count missing values\n\n-   complete.cases() â€“ filter complete rows\n\n-   Convert blanks to NA: x\\[x == \"\"\\] \\<- NA\n\n**B. Handling Missing Values**\n\n-   Basic Removal/Replacement: na.omit(), replace_na() (tidyr), ifelse()\n\n-   Forward/Backward Fill: fill() (tidyr) with .direction = \"down\" / \"up\"\n\n-   Statistical Imputation:\n\n-Simple: mean/median imputation\n\n-Multiple: mice::mice()()\n\n\\-**Advanced**: Hmisc::aregImpute, missForest, Amelia, zoo::na.fill\n\nMissing data is a common issue in real-world datasets. In R, handling missing values properly is essential to ensure the integrity of analyses and avoid misleading results.\n\nThis section covers how to **identify**, **clean**, and **impute** missing values using base R and tidyverse tools. Techniques range from basic filtering to advanced imputation models.\n\nâž¡ï¸ Missing values are typically represented as `NA` in R. Empty strings (e.g., `\"\"`) or special codes (e.g., `-99`, `\"missing\"`) may also indicate missingness and need conversion before analysis.\n\nðŸ”¹ Summary of Functions for Handling Missing Values\n\n| **Task** | **Function** / **Code** | **Purpose** |\n|-------------------|------------------------|-----------------------------|\n| Detect missing values | `is.na(x)`, `anyNA(x)`, `sum(is.na(x))` | Identify/count missing values |\n| Missing per column | `colSums(is.na(df))` | Count NAs per column |\n| Filter complete rows | `complete.cases(df)` | Keep only rows without any missing values |\n| Convert blanks to `NA` | `x[x == \"\"] <- NA` | Convert empty strings to missing values |\n| Remove missing rows | `na.omit(df)` | Remove rows with any missing value |\n| Replace missing values | `replace_na(df, list(...))`, `ifelse(is.na(x), ...)` | Impute or replace NA with custom logic |\n| Forward/backward fill | `fill(df, .direction = \"down\" / \"up\")` | Fill NA using nearby values |\n| Mean/median imputation | `x[is.na(x)] <- mean(x, na.rm = TRUE)` | Replace NA with summary statistic |\n| Multiple imputation | `mice::mice(df)` | Create multiple imputed datasets using chained equations |\n| Advanced imputation | `Hmisc::aregImpute`, `missForest`, `Amelia`, `zoo::na.fill()` | Specialized techniques for complex imputations |\n\nðŸ“š **Further Learning and Resources**\n\nAdditional tutorials, demonstrations, and datasets are available on:\n\n-   **YouTube Channel â€“ AnalyticsHub**\\\n    <https://studio.youtube.com/channel/UCLVKP0g8GvHhOh0kn20T8eg/videos/upload?filter=%5B%5D&sort=%7B%22columnType%22%3A%22date%22%2C%22sortOrder%22%3A%22DESCENDING%22%7D>\n\n-   **GitHub Repository**\\\n    <https://github.com/HabtamuBizuayehu?tab=repositories>\n\n------------------------------------------------------------------------\n\n\n\n\n::: {.cell}\n::: {.cell-output .cell-output-stdout}\n\n```\n                                    id  birthdate deathdate         ssn\n1 898a6256-7ffb-dbe2-e24d-12fda2fedcfd 1966-06-23           999-98-5513\n2 5e0a6984-38d7-c604-f55f-f1de5e933768 1986-07-04           999-58-5560\n3 e335de09-0994-4111-3c15-6edcc17ae4bc 2005-04-25           999-48-3846\n4 45b89342-dc05-8e57-8eee-9ed68ec42378 1984-08-24           999-40-3433\n5 916b1ac8-56c8-ec1b-3b9a-721336a74912 1953-05-10           999-16-3735\n6 dc323bce-e583-d903-303e-9c865bc87e67 2012-09-02           999-90-3605\n    drivers   passport prefix     first     middle          last suffix\n1 S99971131 X62454905X   Mrs.  Maris768              Lindgren255     NA\n2 S99931679 X61479569X   Mrs. Hattie299  Reatha769      Nader710     NA\n3 S99958413               Ms.  Jimmie93 Towanda270      Doyle959     NA\n4 S99985178 X27670495X    Mr. Dwight645  Marlin805      Hilll811     NA\n5 S99968840 X83646024X    Ms.  Tambra47 Brittni468 Balistreri607     NA\n6                             Carson894 Raphael767     Littel644     NA\n     maiden marital  race   ethnicity gender                       birthplace\n1   Dach178       D white nonhispanic      F        Oxford  Massachusetts  US\n2 Harber290       M white nonhispanic      F North Reading  Massachusetts  US\n3                   white nonhispanic      F        Boston  Massachusetts  US\n4                 M white nonhispanic      M    Framingham  Massachusetts  US\n5                 S white nonhispanic      F     Lexington  Massachusetts  US\n6                   white nonhispanic      M      Plymouth  Massachusetts  US\n                        address        city         state           county\n1          962 Stiedemann Vista    Aquinnah Massachusetts     Dukes County\n2            720 O'Keefe Arcade      Newton Massachusetts Middlesex County\n3       493 Cruickshank Mission   Holliston Massachusetts Middlesex County\n4              810 Wolf Pathway      Malden Massachusetts Middlesex County\n5      146 Rowe Village Suite 3 New Bedford Massachusetts   Bristol County\n6 467 Collier Stravenue Unit 12   Attleboro Massachusetts   Bristol County\n   fips  zip      lat       lon healthcare_expenses healthcare_coverage income\n1    NA    0 41.29618 -70.77458           343608.18           884243.46 178323\n2 25017 2468 42.29180 -71.14930           169293.06           801407.90  86384\n3    NA    0 42.24196 -71.46440            64178.99             5906.14 198522\n4 25017 2148 42.43610 -71.14328            36010.63           472861.90  25909\n5 25005 2743 41.69576 -71.01391           281198.90           310261.21 140772\n6 44007 2861 41.94870 -71.30420            45972.75                0.00  71169\n  visit\n1     1\n2     1\n3     1\n4     1\n5     1\n6     1\n```\n\n\n:::\n:::\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Summarise missing values across all columns\nmissing_summary <- colSums(is.na(visits_all))\nprint(missing_summary[missing_summary > 0])\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n          deathdate             drivers            passport              prefix \n                 40                   4                  12                   8 \n             middle              suffix              maiden             marital \n                  4                  40                  28                  16 \n               race                fips                 zip healthcare_coverage \n                 20                  12                  12                   4 \n             income \n                 20 \n```\n\n\n:::\n\n```{.r .cell-code}\n# Total number of missing cells\ntotal_missing <- sum(is.na(visits_all))\ncat(\"Total missing values in dataset:\", total_missing, \"\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nTotal missing values in dataset: 220 \n```\n\n\n:::\n\n```{.r .cell-code}\n# Count of individuals with at least one missing value\nn_missing_individuals <- sum(!complete.cases(visits_all))\ncat(\"Number of individuals with at least one missing value:\", n_missing_individuals, \"\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nNumber of individuals with at least one missing value: 40 \n```\n\n\n:::\n\n```{.r .cell-code}\n# Sort records by patient ID and visit number\nvisits_all <- visits_all %>%\n  arrange(id_text, visit)\n\n# View rows with any missing values\nmissing_rows <- visits_all %>%\n  filter(!complete.cases(.))\nhead(missing_rows, n = 12) %>% select(id_text, race, income, passport)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n                id_text  race income   passport\n1  Anit|SÃ¡nc|1960-05-07 white  61016  X9157439X\n2  Anit|SÃ¡nc|1960-05-07  <NA>     NA  X9157439X\n3  Anit|SÃ¡nc|1960-05-07 white     NA  X9157439X\n4  Anit|SÃ¡nc|1960-05-07  <NA>  60016  X9157439X\n5  Aure|Weis|2003-11-12 white   8752 X17586296X\n6  Aure|Weis|2003-11-12  <NA>     NA X17586296X\n7  Aure|Weis|2003-11-12 white     NA X17586296X\n8  Aure|Weis|2003-11-12  <NA>   7752 X17586296X\n9  Cars|Litt|2012-09-02 white  71169       <NA>\n10 Cars|Litt|2012-09-02  <NA>     NA       <NA>\n11 Cars|Litt|2012-09-02  <NA>  70169       <NA>\n12 Cars|Litt|2012-09-02 white     NA       <NA>\n```\n\n\n:::\n\n```{.r .cell-code}\n# Impute passport with \"UNKNOWN\"\ndf_passport <- visits_all %>%\n  mutate(passport_imputed = replace_na(passport, \"UNKNOWN\")) %>%\n  filter(is.na(passport)) %>%\n  select(id, id_text, visit, passport, passport_imputed)\n\nhead(df_passport, n = 12)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n                                     id              id_text visit passport\n1  dc323bce-e583-d903-303e-9c865bc87e67 Cars|Litt|2012-09-02     1     <NA>\n2  dc323bce-e583-d903-303e-9c865bc87e67 Cars|Litt|2012-09-02     2     <NA>\n3  dc323bce-e583-d903-303e-9c865bc87e67 Cars|Litt|2012-09-02     3     <NA>\n4  dc323bce-e583-d903-303e-9c865bc87e67 Cars|Litt|2012-09-02     4     <NA>\n5  da7b1f55-c782-544f-ba8c-fe69d519dc85 Doll|Fran|2008-10-04     1     <NA>\n6  da7b1f55-c782-544f-ba8c-fe69d519dc85 Doll|Fran|2008-10-04     2     <NA>\n7  da7b1f55-c782-544f-ba8c-fe69d519dc85 Doll|Fran|2008-10-04     3     <NA>\n8  da7b1f55-c782-544f-ba8c-fe69d519dc85 Doll|Fran|2008-10-04     4     <NA>\n9  e335de09-0994-4111-3c15-6edcc17ae4bc Jimm|Doyl|2005-04-25     1     <NA>\n10 e335de09-0994-4111-3c15-6edcc17ae4bc Jimm|Doyl|2005-04-25     2     <NA>\n11 e335de09-0994-4111-3c15-6edcc17ae4bc Jimm|Doyl|2005-04-25     3     <NA>\n12 e335de09-0994-4111-3c15-6edcc17ae4bc Jimm|Doyl|2005-04-25     4     <NA>\n   passport_imputed\n1           UNKNOWN\n2           UNKNOWN\n3           UNKNOWN\n4           UNKNOWN\n5           UNKNOWN\n6           UNKNOWN\n7           UNKNOWN\n8           UNKNOWN\n9           UNKNOWN\n10          UNKNOWN\n11          UNKNOWN\n12          UNKNOWN\n```\n\n\n:::\n\n```{.r .cell-code}\n# Sort records by patient ID and visit number (to prepare for forward/backward fill)\nvisits_all <- visits_all %>%\n  arrange(id_text, visit)\n\n# Preview sorted data (tail)\ntail(visits_all %>% select(id_text, visit, race, income), n = 12)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n                id_text visit  race income\n29 Jimm|Doyl|2005-04-25     1 white 198522\n30 Jimm|Doyl|2005-04-25     2  <NA>     NA\n31 Jimm|Doyl|2005-04-25     3  <NA> 197522\n32 Jimm|Doyl|2005-04-25     4 white     NA\n33 Mari|Lind|1966-06-23     1 white 178323\n34 Mari|Lind|1966-06-23     2  <NA>     NA\n35 Mari|Lind|1966-06-23     3 white     NA\n36 Mari|Lind|1966-06-23     4  <NA> 177323\n37 Tamb|Bali|1953-05-10     1 white 140772\n38 Tamb|Bali|1953-05-10     2  <NA>     NA\n39 Tamb|Bali|1953-05-10     3 white     NA\n40 Tamb|Bali|1953-05-10     4  <NA> 139772\n```\n\n\n:::\n\n```{.r .cell-code}\n# Forward fill missing race values within each patient (downward)\nvisits_all <- visits_all %>%\n  group_by(id_text) %>%\n  mutate(race_forward = race) %>%\n  fill(race_forward, .direction = \"down\") %>%\n  ungroup()\n\n# Preview forward-filled race values (head)\nhead(visits_all %>% select(id_text, visit, race, race_forward), n = 12)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 12 Ã— 4\n   id_text              visit race  race_forward\n   <chr>                <dbl> <chr> <chr>       \n 1 Anit|SÃ¡nc|1960-05-07     1 white white       \n 2 Anit|SÃ¡nc|1960-05-07     2 <NA>  white       \n 3 Anit|SÃ¡nc|1960-05-07     3 white white       \n 4 Anit|SÃ¡nc|1960-05-07     4 <NA>  white       \n 5 Aure|Weis|2003-11-12     1 white white       \n 6 Aure|Weis|2003-11-12     2 <NA>  white       \n 7 Aure|Weis|2003-11-12     3 white white       \n 8 Aure|Weis|2003-11-12     4 <NA>  white       \n 9 Cars|Litt|2012-09-02     1 white white       \n10 Cars|Litt|2012-09-02     2 <NA>  white       \n11 Cars|Litt|2012-09-02     3 <NA>  white       \n12 Cars|Litt|2012-09-02     4 white white       \n```\n\n\n:::\n\n```{.r .cell-code}\n# Backward fill missing race values within each patient (upward)\nvisits_all <- visits_all %>%\n  group_by(id_text) %>%\n  mutate(race_backward = race) %>%\n  fill(race_backward, .direction = \"up\") %>%\n  ungroup()\n\n# Preview backward-filled race values (tail)\ntail(visits_all %>% select(id_text, visit, race, race_backward), n = 12)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 12 Ã— 4\n   id_text              visit race  race_backward\n   <chr>                <dbl> <chr> <chr>        \n 1 Jimm|Doyl|2005-04-25     1 white white        \n 2 Jimm|Doyl|2005-04-25     2 <NA>  white        \n 3 Jimm|Doyl|2005-04-25     3 <NA>  white        \n 4 Jimm|Doyl|2005-04-25     4 white white        \n 5 Mari|Lind|1966-06-23     1 white white        \n 6 Mari|Lind|1966-06-23     2 <NA>  white        \n 7 Mari|Lind|1966-06-23     3 white white        \n 8 Mari|Lind|1966-06-23     4 <NA>  <NA>         \n 9 Tamb|Bali|1953-05-10     1 white white        \n10 Tamb|Bali|1953-05-10     2 <NA>  white        \n11 Tamb|Bali|1953-05-10     3 white white        \n12 Tamb|Bali|1953-05-10     4 <NA>  <NA>         \n```\n\n\n:::\n\n```{.r .cell-code}\n# Calculate the global (overall) mean income\nglobal_mean_income <- mean(visits_all$income, na.rm = TRUE)\n\n# Use global mean to impute missing income values\nvisits_all <- visits_all %>%\n  mutate(income_global_mean = ifelse(is.na(income), global_mean_income, income))\n\n# Preview global mean-imputed income (head)\nhead(visits_all %>% select(id_text, visit, income, income_global_mean), n = 12)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 12 Ã— 4\n   id_text              visit income income_global_mean\n   <chr>                <dbl>  <dbl>              <dbl>\n 1 Anit|SÃ¡nc|1960-05-07     1  61016             61016 \n 2 Anit|SÃ¡nc|1960-05-07     2     NA             96123.\n 3 Anit|SÃ¡nc|1960-05-07     3     NA             96123.\n 4 Anit|SÃ¡nc|1960-05-07     4  60016             60016 \n 5 Aure|Weis|2003-11-12     1   8752              8752 \n 6 Aure|Weis|2003-11-12     2     NA             96123.\n 7 Aure|Weis|2003-11-12     3     NA             96123.\n 8 Aure|Weis|2003-11-12     4   7752              7752 \n 9 Cars|Litt|2012-09-02     1  71169             71169 \n10 Cars|Litt|2012-09-02     2     NA             96123.\n11 Cars|Litt|2012-09-02     3  70169             70169 \n12 Cars|Litt|2012-09-02     4     NA             96123.\n```\n\n\n:::\n\n```{.r .cell-code}\n# Calculate mean income per participant (id_text)\nparticipant_mean_income <- visits_all %>%\n  group_by(id_text) %>%\n  summarise(mean_income_id = mean(income, na.rm = TRUE), .groups = \"drop\")\n\n# Use participant-level mean to impute missing income values\nvisits_all <- visits_all %>%\n  left_join(participant_mean_income, by = \"id_text\") %>%\n  mutate(income_participant_mean = ifelse(is.na(income), mean_income_id, income))\n\n# Preview participant mean-imputed income (tail)\ntail(visits_all %>% select(id_text, visit, income, income_participant_mean), n = 12)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 12 Ã— 4\n   id_text              visit income income_participant_mean\n   <chr>                <dbl>  <dbl>                   <dbl>\n 1 Jimm|Doyl|2005-04-25     1 198522                  198522\n 2 Jimm|Doyl|2005-04-25     2     NA                  198022\n 3 Jimm|Doyl|2005-04-25     3 197522                  197522\n 4 Jimm|Doyl|2005-04-25     4     NA                  198022\n 5 Mari|Lind|1966-06-23     1 178323                  178323\n 6 Mari|Lind|1966-06-23     2     NA                  177823\n 7 Mari|Lind|1966-06-23     3     NA                  177823\n 8 Mari|Lind|1966-06-23     4 177323                  177323\n 9 Tamb|Bali|1953-05-10     1 140772                  140772\n10 Tamb|Bali|1953-05-10     2     NA                  140272\n11 Tamb|Bali|1953-05-10     3     NA                  140272\n12 Tamb|Bali|1953-05-10     4 139772                  139772\n```\n\n\n:::\n\n```{.r .cell-code}\n# Multiple imputation for fips, zip, healthcare_coverage, and income\npatients_mice <- visits_all %>%\n  select(id_text, fips, zip, healthcare_coverage, income)\n\n# Apply mice\nimputed <- mice(patients_mice %>% select(-id_text), method = \"pmm\", m = 1, printFlag = FALSE)\n\n# Retrieve completed dataset\nmice_result <- complete(imputed)\ncolnames(mice_result) <- paste0(colnames(mice_result), \"_imputed\")\n\n# Join ID and filter rows with original missing values\ndf_mice <- bind_cols(patients_mice, mice_result) %>%\n  filter(is.na(fips) | is.na(zip) | is.na(healthcare_coverage) | is.na(income)) %>%\n  select(id_text,\n         fips, fips_imputed,\n         zip, zip_imputed,\n         healthcare_coverage, healthcare_coverage_imputed,\n         income, income_imputed)\n\nhead(df_mice, n = 12)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 12 Ã— 9\n   id_text               fips fips_imputed   zip zip_imputed healthcare_coverage\n   <chr>                <int>        <int> <int>       <int>               <dbl>\n 1 Anit|SÃ¡nc|1960-05-07 25009        25009  1915        1915            1280070.\n 2 Anit|SÃ¡nc|1960-05-07 25009        25009  1915        1915            1280070.\n 3 Aure|Weis|2003-11-12 25027        25027  1606        1606             253645.\n 4 Aure|Weis|2003-11-12 25027        25027  1606        1606             253645.\n 5 Cars|Litt|2012-09-02 44007        44007  2861        2861                 NA \n 6 Cars|Litt|2012-09-02 44007        44007  2861        2861                 NA \n 7 Cars|Litt|2012-09-02 44007        44007  2861        2861                 NA \n 8 Cars|Litt|2012-09-02 44007        44007  2861        2861                 NA \n 9 Doll|Fran|2008-10-04    NA        25013    NA        2468             422516.\n10 Doll|Fran|2008-10-04    NA        25027    NA        1030             422516.\n11 Doll|Fran|2008-10-04    NA        25017    NA        2861             422516.\n12 Doll|Fran|2008-10-04    NA        25017    NA        1606             422516.\n# â„¹ 3 more variables: healthcare_coverage_imputed <dbl>, income <dbl>,\n#   income_imputed <dbl>\n```\n\n\n:::\n\n```{.r .cell-code}\n# Optional: Inspect logged events from mice\nimputed$loggedEvents\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n  it im                 dep meth\n1  3  1 healthcare_coverage  pmm\n                                                                                                                                                                                                                                                       out\n1 mice detected that your data are (nearly) multi-collinear.\\nIt applied a ridge penalty to continue calculations, but the results can be unstable.\\nDoes your dataset contain duplicates, linear transformation, or factors with unique respondent names?\n```\n\n\n:::\n\n```{.r .cell-code}\n# Final summary: compare original and imputed values for rows with missingness\n\nfinal_impute_check <- visits_all %>%\n  filter(is.na(race) | is.na(income)) %>%\n  select(id_text, visit,\n         race, race_forward, race_backward,\n         income, income_global_mean, income_participant_mean)\n\n# Preview top 12\nhead(final_impute_check, n = 12)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 12 Ã— 8\n   id_text      visit race  race_forward race_backward income income_global_mean\n   <chr>        <dbl> <chr> <chr>        <chr>          <dbl>              <dbl>\n 1 Anit|SÃ¡nc|1â€¦     2 <NA>  white        white             NA             96123.\n 2 Anit|SÃ¡nc|1â€¦     3 white white        white             NA             96123.\n 3 Anit|SÃ¡nc|1â€¦     4 <NA>  white        <NA>           60016             60016 \n 4 Aure|Weis|2â€¦     2 <NA>  white        white             NA             96123.\n 5 Aure|Weis|2â€¦     3 white white        white             NA             96123.\n 6 Aure|Weis|2â€¦     4 <NA>  white        <NA>            7752              7752 \n 7 Cars|Litt|2â€¦     2 <NA>  white        white             NA             96123.\n 8 Cars|Litt|2â€¦     3 <NA>  white        white          70169             70169 \n 9 Cars|Litt|2â€¦     4 white white        white             NA             96123.\n10 Doll|Fran|2â€¦     2 <NA>  white        white             NA             96123.\n11 Doll|Fran|2â€¦     3 <NA>  white        white         187023            187023 \n12 Doll|Fran|2â€¦     4 white white        white             NA             96123.\n# â„¹ 1 more variable: income_participant_mean <dbl>\n```\n\n\n:::\n\n```{.r .cell-code}\n# Preview bottom 12\ntail(final_impute_check, n = 12)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 12 Ã— 8\n   id_text      visit race  race_forward race_backward income income_global_mean\n   <chr>        <dbl> <chr> <chr>        <chr>          <dbl>              <dbl>\n 1 Home|QuiÃ±|1â€¦     2 <NA>  white        white             NA             96123.\n 2 Home|QuiÃ±|1â€¦     3 <NA>  white        white           6361              6361 \n 3 Home|QuiÃ±|1â€¦     4 white white        white             NA             96123.\n 4 Jimm|Doyl|2â€¦     2 <NA>  white        white             NA             96123.\n 5 Jimm|Doyl|2â€¦     3 <NA>  white        white         197522            197522 \n 6 Jimm|Doyl|2â€¦     4 white white        white             NA             96123.\n 7 Mari|Lind|1â€¦     2 <NA>  white        white             NA             96123.\n 8 Mari|Lind|1â€¦     3 white white        white             NA             96123.\n 9 Mari|Lind|1â€¦     4 <NA>  white        <NA>          177323            177323 \n10 Tamb|Bali|1â€¦     2 <NA>  white        white             NA             96123.\n11 Tamb|Bali|1â€¦     3 white white        white             NA             96123.\n12 Tamb|Bali|1â€¦     4 <NA>  white        <NA>          139772            139772 \n# â„¹ 1 more variable: income_participant_mean <dbl>\n```\n\n\n:::\n\n```{.r .cell-code}\n# Clean up temporary objects \nrm( participant_mean_income, final_impute_check, global_mean_income, df_passport, df_mice,\n    patients_mice, imputed, mice_result, missing_summary, total_missing, n_missing_individuals, missing_rows\n)\n```\n:::\n\n\n## **Conclusion**\n\nManaging missing data is a core part of ensuring the **validity, reproducibility, and interpretability** of findings. Missingness can arise from a variety of sources, including participant attrition, evolving survey designs, and structural inconsistencies, and each requires a tailored approach. In multi-decade datasets, missingness arises from participant attrition, evolving survey designs, and changes in data collection priorities. Without a structured approach, these gaps can bias results, reduce statistical power, and undermine the credibility of findings.\n\nAn effective missing data strategy should:\n\n-   Begin with **comprehensive diagnostics** to assess the extent, patterns, and potential mechanisms of missingness -whether MCAR (Missing Completely at Random), MAR (Missing at Random), or MNAR (Missing Not at Random)â€”as this classification guides the choice of analytical remedies.\n-   Use **appropriate imputation techniques**â€”from simple methods like mean substitution to advanced approaches such as multiple imputation, mean imputation, last observation carried forward (LOCF), or combined strategiesâ€”selected according to the type of variable and nature of missingness.\n-   Incorporate **sensitivity analyses** to evaluate the robustness of results under different assumptions.\n-   Maintain **transparent documentation** of all decisions, code, and outputs, ensuring reproducibility and facilitating peer review.\n\nUltimately, the goal is not to replace missing values simply to achieve a complete dataset, but to apply appropriate methods that preserve the validity, reliability, and interpretability of the analysis. A structured, documented, and flexible approach allows data analysts to maximise the value of data while minimising bias and loss of precisionâ€”ensuring that findings can confidently and precisely inform both science and policy.\\\n\nI also prepared Missing Data Management and Analysis via PowerPoint: Visit the [Missing data presentation](missing_data_presentation.pdf){target=\"_blank\"}.\n\n------------------------------------------------------------------------\n\n## **References**\n\nA. Book and Articles\n\n1.  Dong Y, Peng C-YJ. Principled missing data methods for researchers. SpringerPlus. 2013;2(1):222.\n2.  Bennett DA. How can I deal with missing data in my study? Australian and New Zealand journal of public health. 2001;25(5):464-9.\n3.  StataCorp L. Stata statistical software: Release 13.(2013). College Station, TX: StataCorp LP. 2013.\n4.  White IR, Royston P, Wood AM. Multiple imputation using chained equations: Issues and guidance for practice. Stat Med. 2011;30(4):377-99. https://www.sagepub.com/sites/default/files/upm-binaries/45664_6.pdf\n\nB. Useful websites:\\\nhttps://missingdata.org/\\\nhttps://www.missingdata.nl/missing-data/missing-data-methods/\n\n------------------------------------------------------------------------\n",
    "supporting": [
      "index_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}